function BM(e,t){for(var i=0;i<t.length;i++){const a=t[i];if(typeof a!="string"&&!Array.isArray(a)){for(const h in a)if(h!=="default"&&!(h in e)){const g=Object.getOwnPropertyDescriptor(a,h);g&&Object.defineProperty(e,h,g.get?g:{enumerable:!0,get:()=>a[h]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))a(h);new MutationObserver(h=>{for(const g of h)if(g.type==="childList")for(const p of g.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function i(h){const g={};return h.integrity&&(g.integrity=h.integrity),h.referrerPolicy&&(g.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?g.credentials="include":h.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function a(h){if(h.ep)return;h.ep=!0;const g=i(h);fetch(h.href,g)}})();var FM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function p0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ZS={exports:{}},Um={},XS={exports:{}},ln={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xd=Symbol.for("react.element"),NM=Symbol.for("react.portal"),OM=Symbol.for("react.fragment"),jM=Symbol.for("react.strict_mode"),VM=Symbol.for("react.profiler"),UM=Symbol.for("react.provider"),$M=Symbol.for("react.context"),HM=Symbol.for("react.forward_ref"),GM=Symbol.for("react.suspense"),WM=Symbol.for("react.memo"),qM=Symbol.for("react.lazy"),$w=Symbol.iterator;function ZM(e){return e===null||typeof e!="object"?null:(e=$w&&e[$w]||e["@@iterator"],typeof e=="function"?e:null)}var KS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},YS=Object.assign,JS={};function Tu(e,t,i){this.props=e,this.context=t,this.refs=JS,this.updater=i||KS}Tu.prototype.isReactComponent={};Tu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Tu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function QS(){}QS.prototype=Tu.prototype;function m0(e,t,i){this.props=e,this.context=t,this.refs=JS,this.updater=i||KS}var g0=m0.prototype=new QS;g0.constructor=m0;YS(g0,Tu.prototype);g0.isPureReactComponent=!0;var Hw=Array.isArray,ek=Object.prototype.hasOwnProperty,y0={current:null},tk={key:!0,ref:!0,__self:!0,__source:!0};function nk(e,t,i){var a,h={},g=null,p=null;if(t!=null)for(a in t.ref!==void 0&&(p=t.ref),t.key!==void 0&&(g=""+t.key),t)ek.call(t,a)&&!tk.hasOwnProperty(a)&&(h[a]=t[a]);var c=arguments.length-2;if(c===1)h.children=i;else if(1<c){for(var S=Array(c),E=0;E<c;E++)S[E]=arguments[E+2];h.children=S}if(e&&e.defaultProps)for(a in c=e.defaultProps,c)h[a]===void 0&&(h[a]=c[a]);return{$$typeof:Xd,type:e,key:g,ref:p,props:h,_owner:y0.current}}function XM(e,t){return{$$typeof:Xd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function v0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Xd}function KM(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var Gw=/\/+/g;function Ly(e,t){return typeof e=="object"&&e!==null&&e.key!=null?KM(""+e.key):t.toString(36)}function $p(e,t,i,a,h){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var p=!1;if(e===null)p=!0;else switch(g){case"string":case"number":p=!0;break;case"object":switch(e.$$typeof){case Xd:case NM:p=!0}}if(p)return p=e,h=h(p),e=a===""?"."+Ly(p,0):a,Hw(h)?(i="",e!=null&&(i=e.replace(Gw,"$&/")+"/"),$p(h,t,i,"",function(E){return E})):h!=null&&(v0(h)&&(h=XM(h,i+(!h.key||p&&p.key===h.key?"":(""+h.key).replace(Gw,"$&/")+"/")+e)),t.push(h)),1;if(p=0,a=a===""?".":a+":",Hw(e))for(var c=0;c<e.length;c++){g=e[c];var S=a+Ly(g,c);p+=$p(g,t,i,S,h)}else if(S=ZM(e),typeof S=="function")for(e=S.call(e),c=0;!(g=e.next()).done;)g=g.value,S=a+Ly(g,c++),p+=$p(g,t,i,S,h);else if(g==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return p}function up(e,t,i){if(e==null)return e;var a=[],h=0;return $p(e,a,"","",function(g){return t.call(i,g,h++)}),a}function YM(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Si={current:null},Hp={transition:null},JM={ReactCurrentDispatcher:Si,ReactCurrentBatchConfig:Hp,ReactCurrentOwner:y0};function rk(){throw Error("act(...) is not supported in production builds of React.")}ln.Children={map:up,forEach:function(e,t,i){up(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return up(e,function(){t++}),t},toArray:function(e){return up(e,function(t){return t})||[]},only:function(e){if(!v0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ln.Component=Tu;ln.Fragment=OM;ln.Profiler=VM;ln.PureComponent=m0;ln.StrictMode=jM;ln.Suspense=GM;ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JM;ln.act=rk;ln.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=YS({},e.props),h=e.key,g=e.ref,p=e._owner;if(t!=null){if(t.ref!==void 0&&(g=t.ref,p=y0.current),t.key!==void 0&&(h=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(S in t)ek.call(t,S)&&!tk.hasOwnProperty(S)&&(a[S]=t[S]===void 0&&c!==void 0?c[S]:t[S])}var S=arguments.length-2;if(S===1)a.children=i;else if(1<S){c=Array(S);for(var E=0;E<S;E++)c[E]=arguments[E+2];a.children=c}return{$$typeof:Xd,type:e.type,key:h,ref:g,props:a,_owner:p}};ln.createContext=function(e){return e={$$typeof:$M,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:UM,_context:e},e.Consumer=e};ln.createElement=nk;ln.createFactory=function(e){var t=nk.bind(null,e);return t.type=e,t};ln.createRef=function(){return{current:null}};ln.forwardRef=function(e){return{$$typeof:HM,render:e}};ln.isValidElement=v0;ln.lazy=function(e){return{$$typeof:qM,_payload:{_status:-1,_result:e},_init:YM}};ln.memo=function(e,t){return{$$typeof:WM,type:e,compare:t===void 0?null:t}};ln.startTransition=function(e){var t=Hp.transition;Hp.transition={};try{e()}finally{Hp.transition=t}};ln.unstable_act=rk;ln.useCallback=function(e,t){return Si.current.useCallback(e,t)};ln.useContext=function(e){return Si.current.useContext(e)};ln.useDebugValue=function(){};ln.useDeferredValue=function(e){return Si.current.useDeferredValue(e)};ln.useEffect=function(e,t){return Si.current.useEffect(e,t)};ln.useId=function(){return Si.current.useId()};ln.useImperativeHandle=function(e,t,i){return Si.current.useImperativeHandle(e,t,i)};ln.useInsertionEffect=function(e,t){return Si.current.useInsertionEffect(e,t)};ln.useLayoutEffect=function(e,t){return Si.current.useLayoutEffect(e,t)};ln.useMemo=function(e,t){return Si.current.useMemo(e,t)};ln.useReducer=function(e,t,i){return Si.current.useReducer(e,t,i)};ln.useRef=function(e){return Si.current.useRef(e)};ln.useState=function(e){return Si.current.useState(e)};ln.useSyncExternalStore=function(e,t,i){return Si.current.useSyncExternalStore(e,t,i)};ln.useTransition=function(){return Si.current.useTransition()};ln.version="18.3.1";XS.exports=ln;var $=XS.exports;const Me=p0($),ik=BM({__proto__:null,default:Me},[$]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QM=$,eD=Symbol.for("react.element"),tD=Symbol.for("react.fragment"),nD=Object.prototype.hasOwnProperty,rD=QM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iD={key:!0,ref:!0,__self:!0,__source:!0};function sk(e,t,i){var a,h={},g=null,p=null;i!==void 0&&(g=""+i),t.key!==void 0&&(g=""+t.key),t.ref!==void 0&&(p=t.ref);for(a in t)nD.call(t,a)&&!iD.hasOwnProperty(a)&&(h[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)h[a]===void 0&&(h[a]=t[a]);return{$$typeof:eD,type:e,key:g,ref:p,props:h,_owner:rD.current}}Um.Fragment=tD;Um.jsx=sk;Um.jsxs=sk;ZS.exports=Um;var Q=ZS.exports,ok={exports:{}},ss={},ak={exports:{}},lk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ke,Ue){var et=ke.length;ke.push(Ue);e:for(;0<et;){var pt=et-1>>>1,Le=ke[pt];if(0<h(Le,Ue))ke[pt]=Ue,ke[et]=Le,et=pt;else break e}}function i(ke){return ke.length===0?null:ke[0]}function a(ke){if(ke.length===0)return null;var Ue=ke[0],et=ke.pop();if(et!==Ue){ke[0]=et;e:for(var pt=0,Le=ke.length,Ve=Le>>>1;pt<Ve;){var We=2*(pt+1)-1,He=ke[We],_t=We+1,tt=ke[_t];if(0>h(He,et))_t<Le&&0>h(tt,He)?(ke[pt]=tt,ke[_t]=et,pt=_t):(ke[pt]=He,ke[We]=et,pt=We);else if(_t<Le&&0>h(tt,et))ke[pt]=tt,ke[_t]=et,pt=_t;else break e}}return Ue}function h(ke,Ue){var et=ke.sortIndex-Ue.sortIndex;return et!==0?et:ke.id-Ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var p=Date,c=p.now();e.unstable_now=function(){return p.now()-c}}var S=[],E=[],P=1,k=null,I=3,G=!1,Z=!1,H=!1,te=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function W(ke){for(var Ue=i(E);Ue!==null;){if(Ue.callback===null)a(E);else if(Ue.startTime<=ke)a(E),Ue.sortIndex=Ue.expirationTime,t(S,Ue);else break;Ue=i(E)}}function re(ke){if(H=!1,W(ke),!Z)if(i(S)!==null)Z=!0,Je(pe);else{var Ue=i(E);Ue!==null&&$e(re,Ue.startTime-ke)}}function pe(ke,Ue){Z=!1,H&&(H=!1,L(ce),ce=-1),G=!0;var et=I;try{for(W(Ue),k=i(S);k!==null&&(!(k.expirationTime>Ue)||ke&&!Ce());){var pt=k.callback;if(typeof pt=="function"){k.callback=null,I=k.priorityLevel;var Le=pt(k.expirationTime<=Ue);Ue=e.unstable_now(),typeof Le=="function"?k.callback=Le:k===i(S)&&a(S),W(Ue)}else a(S);k=i(S)}if(k!==null)var Ve=!0;else{var We=i(E);We!==null&&$e(re,We.startTime-Ue),Ve=!1}return Ve}finally{k=null,I=et,G=!1}}var _e=!1,le=null,ce=-1,De=5,Be=-1;function Ce(){return!(e.unstable_now()-Be<De)}function Fe(){if(le!==null){var ke=e.unstable_now();Be=ke;var Ue=!0;try{Ue=le(!0,ke)}finally{Ue?ze():(_e=!1,le=null)}}else _e=!1}var ze;if(typeof V=="function")ze=function(){V(Fe)};else if(typeof MessageChannel<"u"){var Qe=new MessageChannel,Ze=Qe.port2;Qe.port1.onmessage=Fe,ze=function(){Ze.postMessage(null)}}else ze=function(){te(Fe,0)};function Je(ke){le=ke,_e||(_e=!0,ze())}function $e(ke,Ue){ce=te(function(){ke(e.unstable_now())},Ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ke){ke.callback=null},e.unstable_continueExecution=function(){Z||G||(Z=!0,Je(pe))},e.unstable_forceFrameRate=function(ke){0>ke||125<ke?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):De=0<ke?Math.floor(1e3/ke):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return i(S)},e.unstable_next=function(ke){switch(I){case 1:case 2:case 3:var Ue=3;break;default:Ue=I}var et=I;I=Ue;try{return ke()}finally{I=et}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ke,Ue){switch(ke){case 1:case 2:case 3:case 4:case 5:break;default:ke=3}var et=I;I=ke;try{return Ue()}finally{I=et}},e.unstable_scheduleCallback=function(ke,Ue,et){var pt=e.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?pt+et:pt):et=pt,ke){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=et+Le,ke={id:P++,callback:Ue,priorityLevel:ke,startTime:et,expirationTime:Le,sortIndex:-1},et>pt?(ke.sortIndex=et,t(E,ke),i(S)===null&&ke===i(E)&&(H?(L(ce),ce=-1):H=!0,$e(re,et-pt))):(ke.sortIndex=Le,t(S,ke),Z||G||(Z=!0,Je(pe))),ke},e.unstable_shouldYield=Ce,e.unstable_wrapCallback=function(ke){var Ue=I;return function(){var et=I;I=Ue;try{return ke.apply(this,arguments)}finally{I=et}}}})(lk);ak.exports=lk;var sD=ak.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oD=$,is=sD;function nt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ck=new Set,Sd={};function jl(e,t){pu(e,t),pu(e+"Capture",t)}function pu(e,t){for(Sd[e]=t,e=0;e<t.length;e++)ck.add(t[e])}var Ao=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ov=Object.prototype.hasOwnProperty,aD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ww={},qw={};function lD(e){return Ov.call(qw,e)?!0:Ov.call(Ww,e)?!1:aD.test(e)?qw[e]=!0:(Ww[e]=!0,!1)}function cD(e,t,i,a){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function uD(e,t,i,a){if(t===null||typeof t>"u"||cD(e,t,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ki(e,t,i,a,h,g,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=h,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=g,this.removeEmptyString=p}var Zr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zr[e]=new ki(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Zr[t]=new ki(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zr[e]=new ki(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zr[e]=new ki(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zr[e]=new ki(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zr[e]=new ki(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zr[e]=new ki(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zr[e]=new ki(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zr[e]=new ki(e,5,!1,e.toLowerCase(),null,!1,!1)});var _0=/[\-:]([a-z])/g;function x0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(_0,x0);Zr[t]=new ki(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(_0,x0);Zr[t]=new ki(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(_0,x0);Zr[t]=new ki(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zr[e]=new ki(e,1,!1,e.toLowerCase(),null,!1,!1)});Zr.xlinkHref=new ki("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zr[e]=new ki(e,1,!1,e.toLowerCase(),null,!0,!0)});function b0(e,t,i,a){var h=Zr.hasOwnProperty(t)?Zr[t]:null;(h!==null?h.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(uD(t,i,h,a)&&(i=null),a||h===null?lD(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):h.mustUseProperty?e[h.propertyName]=i===null?h.type===3?!1:"":i:(t=h.attributeName,a=h.attributeNamespace,i===null?e.removeAttribute(t):(h=h.type,i=h===3||h===4&&i===!0?"":""+i,a?e.setAttributeNS(a,t,i):e.setAttribute(t,i))))}var Lo=oD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hp=Symbol.for("react.element"),Hc=Symbol.for("react.portal"),Gc=Symbol.for("react.fragment"),w0=Symbol.for("react.strict_mode"),jv=Symbol.for("react.profiler"),uk=Symbol.for("react.provider"),hk=Symbol.for("react.context"),S0=Symbol.for("react.forward_ref"),Vv=Symbol.for("react.suspense"),Uv=Symbol.for("react.suspense_list"),k0=Symbol.for("react.memo"),xa=Symbol.for("react.lazy"),dk=Symbol.for("react.offscreen"),Zw=Symbol.iterator;function Uh(e){return e===null||typeof e!="object"?null:(e=Zw&&e[Zw]||e["@@iterator"],typeof e=="function"?e:null)}var Qn=Object.assign,By;function td(e){if(By===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);By=t&&t[1]||""}return`
`+By+e}var Fy=!1;function Ny(e,t){if(!e||Fy)return"";Fy=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(E){var a=E}Reflect.construct(e,[],t)}else{try{t.call()}catch(E){a=E}e.call(t.prototype)}else{try{throw Error()}catch(E){a=E}e()}}catch(E){if(E&&a&&typeof E.stack=="string"){for(var h=E.stack.split(`
`),g=a.stack.split(`
`),p=h.length-1,c=g.length-1;1<=p&&0<=c&&h[p]!==g[c];)c--;for(;1<=p&&0<=c;p--,c--)if(h[p]!==g[c]){if(p!==1||c!==1)do if(p--,c--,0>c||h[p]!==g[c]){var S=`
`+h[p].replace(" at new "," at ");return e.displayName&&S.includes("<anonymous>")&&(S=S.replace("<anonymous>",e.displayName)),S}while(1<=p&&0<=c);break}}}finally{Fy=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?td(e):""}function hD(e){switch(e.tag){case 5:return td(e.type);case 16:return td("Lazy");case 13:return td("Suspense");case 19:return td("SuspenseList");case 0:case 2:case 15:return e=Ny(e.type,!1),e;case 11:return e=Ny(e.type.render,!1),e;case 1:return e=Ny(e.type,!0),e;default:return""}}function $v(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Gc:return"Fragment";case Hc:return"Portal";case jv:return"Profiler";case w0:return"StrictMode";case Vv:return"Suspense";case Uv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case hk:return(e.displayName||"Context")+".Consumer";case uk:return(e._context.displayName||"Context")+".Provider";case S0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case k0:return t=e.displayName||null,t!==null?t:$v(e.type)||"Memo";case xa:t=e._payload,e=e._init;try{return $v(e(t))}catch{}}return null}function dD(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $v(t);case 8:return t===w0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function La(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fD(e){var t=fk(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var h=i.get,g=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(p){a=""+p,g.call(this,p)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(p){a=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function dp(e){e._valueTracker||(e._valueTracker=fD(e))}function pk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),a="";return e&&(a=fk(e)?e.checked?"true":"false":e.value),e=a,e!==i?(t.setValue(e),!0):!1}function lm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Hv(e,t){var i=t.checked;return Qn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Xw(e,t){var i=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;i=La(t.value!=null?t.value:i),e._wrapperState={initialChecked:a,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mk(e,t){t=t.checked,t!=null&&b0(e,"checked",t,!1)}function Gv(e,t){mk(e,t);var i=La(t.value),a=t.type;if(i!=null)a==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wv(e,t.type,i):t.hasOwnProperty("defaultValue")&&Wv(e,t.type,La(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Kw(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Wv(e,t,i){(t!=="number"||lm(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var nd=Array.isArray;function ou(e,t,i,a){if(e=e.options,t){t={};for(var h=0;h<i.length;h++)t["$"+i[h]]=!0;for(i=0;i<e.length;i++)h=t.hasOwnProperty("$"+e[i].value),e[i].selected!==h&&(e[i].selected=h),h&&a&&(e[i].defaultSelected=!0)}else{for(i=""+La(i),t=null,h=0;h<e.length;h++){if(e[h].value===i){e[h].selected=!0,a&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function qv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(nt(91));return Qn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Yw(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(nt(92));if(nd(i)){if(1<i.length)throw Error(nt(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:La(i)}}function gk(e,t){var i=La(t.value),a=La(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),a!=null&&(e.defaultValue=""+a)}function Jw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function yk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?yk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fp,vk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,a,h){MSApp.execUnsafeLocalFunction(function(){return e(t,i,a,h)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(fp=fp||document.createElement("div"),fp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function kd(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var ld={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pD=["Webkit","ms","Moz","O"];Object.keys(ld).forEach(function(e){pD.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ld[t]=ld[e]})});function _k(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||ld.hasOwnProperty(e)&&ld[e]?(""+t).trim():t+"px"}function xk(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var a=i.indexOf("--")===0,h=_k(i,t[i],a);i==="float"&&(i="cssFloat"),a?e.setProperty(i,h):e[i]=h}}var mD=Qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xv(e,t){if(t){if(mD[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(nt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(nt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(nt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(nt(62))}}function Kv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yv=null;function T0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Jv=null,au=null,lu=null;function Qw(e){if(e=Jd(e)){if(typeof Jv!="function")throw Error(nt(280));var t=e.stateNode;t&&(t=qm(t),Jv(e.stateNode,e.type,t))}}function bk(e){au?lu?lu.push(e):lu=[e]:au=e}function wk(){if(au){var e=au,t=lu;if(lu=au=null,Qw(e),t)for(e=0;e<t.length;e++)Qw(t[e])}}function Sk(e,t){return e(t)}function kk(){}var Oy=!1;function Tk(e,t,i){if(Oy)return e(t,i);Oy=!0;try{return Sk(e,t,i)}finally{Oy=!1,(au!==null||lu!==null)&&(kk(),wk())}}function Td(e,t){var i=e.stateNode;if(i===null)return null;var a=qm(i);if(a===null)return null;i=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(nt(231,t,typeof i));return i}var Qv=!1;if(Ao)try{var $h={};Object.defineProperty($h,"passive",{get:function(){Qv=!0}}),window.addEventListener("test",$h,$h),window.removeEventListener("test",$h,$h)}catch{Qv=!1}function gD(e,t,i,a,h,g,p,c,S){var E=Array.prototype.slice.call(arguments,3);try{t.apply(i,E)}catch(P){this.onError(P)}}var cd=!1,cm=null,um=!1,e_=null,yD={onError:function(e){cd=!0,cm=e}};function vD(e,t,i,a,h,g,p,c,S){cd=!1,cm=null,gD.apply(yD,arguments)}function _D(e,t,i,a,h,g,p,c,S){if(vD.apply(this,arguments),cd){if(cd){var E=cm;cd=!1,cm=null}else throw Error(nt(198));um||(um=!0,e_=E)}}function Vl(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function Ck(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function e1(e){if(Vl(e)!==e)throw Error(nt(188))}function xD(e){var t=e.alternate;if(!t){if(t=Vl(e),t===null)throw Error(nt(188));return t!==e?null:e}for(var i=e,a=t;;){var h=i.return;if(h===null)break;var g=h.alternate;if(g===null){if(a=h.return,a!==null){i=a;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===i)return e1(h),e;if(g===a)return e1(h),t;g=g.sibling}throw Error(nt(188))}if(i.return!==a.return)i=h,a=g;else{for(var p=!1,c=h.child;c;){if(c===i){p=!0,i=h,a=g;break}if(c===a){p=!0,a=h,i=g;break}c=c.sibling}if(!p){for(c=g.child;c;){if(c===i){p=!0,i=g,a=h;break}if(c===a){p=!0,a=g,i=h;break}c=c.sibling}if(!p)throw Error(nt(189))}}if(i.alternate!==a)throw Error(nt(190))}if(i.tag!==3)throw Error(nt(188));return i.stateNode.current===i?e:t}function Ek(e){return e=xD(e),e!==null?Pk(e):null}function Pk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Pk(e);if(t!==null)return t;e=e.sibling}return null}var Ik=is.unstable_scheduleCallback,t1=is.unstable_cancelCallback,bD=is.unstable_shouldYield,wD=is.unstable_requestPaint,hr=is.unstable_now,SD=is.unstable_getCurrentPriorityLevel,C0=is.unstable_ImmediatePriority,Ak=is.unstable_UserBlockingPriority,hm=is.unstable_NormalPriority,kD=is.unstable_LowPriority,Mk=is.unstable_IdlePriority,$m=null,Qs=null;function TD(e){if(Qs&&typeof Qs.onCommitFiberRoot=="function")try{Qs.onCommitFiberRoot($m,e,void 0,(e.current.flags&128)===128)}catch{}}var Ls=Math.clz32?Math.clz32:PD,CD=Math.log,ED=Math.LN2;function PD(e){return e>>>=0,e===0?32:31-(CD(e)/ED|0)|0}var pp=64,mp=4194304;function rd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dm(e,t){var i=e.pendingLanes;if(i===0)return 0;var a=0,h=e.suspendedLanes,g=e.pingedLanes,p=i&268435455;if(p!==0){var c=p&~h;c!==0?a=rd(c):(g&=p,g!==0&&(a=rd(g)))}else p=i&~h,p!==0?a=rd(p):g!==0&&(a=rd(g));if(a===0)return 0;if(t!==0&&t!==a&&!(t&h)&&(h=a&-a,g=t&-t,h>=g||h===16&&(g&4194240)!==0))return t;if(a&4&&(a|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)i=31-Ls(t),h=1<<i,a|=e[i],t&=~h;return a}function ID(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AD(e,t){for(var i=e.suspendedLanes,a=e.pingedLanes,h=e.expirationTimes,g=e.pendingLanes;0<g;){var p=31-Ls(g),c=1<<p,S=h[p];S===-1?(!(c&i)||c&a)&&(h[p]=ID(c,t)):S<=t&&(e.expiredLanes|=c),g&=~c}}function t_(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Dk(){var e=pp;return pp<<=1,!(pp&4194240)&&(pp=64),e}function jy(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Kd(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ls(t),e[t]=i}function MD(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<i;){var h=31-Ls(i),g=1<<h;t[h]=0,a[h]=-1,e[h]=-1,i&=~g}}function E0(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var a=31-Ls(i),h=1<<a;h&t|e[a]&t&&(e[a]|=t),i&=~h}}var Cn=0;function zk(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Rk,P0,Lk,Bk,Fk,n_=!1,gp=[],Ea=null,Pa=null,Ia=null,Cd=new Map,Ed=new Map,wa=[],DD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function n1(e,t){switch(e){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":Pa=null;break;case"mouseover":case"mouseout":Ia=null;break;case"pointerover":case"pointerout":Cd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ed.delete(t.pointerId)}}function Hh(e,t,i,a,h,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:i,eventSystemFlags:a,nativeEvent:g,targetContainers:[h]},t!==null&&(t=Jd(t),t!==null&&P0(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function zD(e,t,i,a,h){switch(t){case"focusin":return Ea=Hh(Ea,e,t,i,a,h),!0;case"dragenter":return Pa=Hh(Pa,e,t,i,a,h),!0;case"mouseover":return Ia=Hh(Ia,e,t,i,a,h),!0;case"pointerover":var g=h.pointerId;return Cd.set(g,Hh(Cd.get(g)||null,e,t,i,a,h)),!0;case"gotpointercapture":return g=h.pointerId,Ed.set(g,Hh(Ed.get(g)||null,e,t,i,a,h)),!0}return!1}function Nk(e){var t=Sl(e.target);if(t!==null){var i=Vl(t);if(i!==null){if(t=i.tag,t===13){if(t=Ck(i),t!==null){e.blockedOn=t,Fk(e.priority,function(){Lk(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Gp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=r_(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var a=new i.constructor(i.type,i);Yv=a,i.target.dispatchEvent(a),Yv=null}else return t=Jd(i),t!==null&&P0(t),e.blockedOn=i,!1;t.shift()}return!0}function r1(e,t,i){Gp(e)&&i.delete(t)}function RD(){n_=!1,Ea!==null&&Gp(Ea)&&(Ea=null),Pa!==null&&Gp(Pa)&&(Pa=null),Ia!==null&&Gp(Ia)&&(Ia=null),Cd.forEach(r1),Ed.forEach(r1)}function Gh(e,t){e.blockedOn===t&&(e.blockedOn=null,n_||(n_=!0,is.unstable_scheduleCallback(is.unstable_NormalPriority,RD)))}function Pd(e){function t(h){return Gh(h,e)}if(0<gp.length){Gh(gp[0],e);for(var i=1;i<gp.length;i++){var a=gp[i];a.blockedOn===e&&(a.blockedOn=null)}}for(Ea!==null&&Gh(Ea,e),Pa!==null&&Gh(Pa,e),Ia!==null&&Gh(Ia,e),Cd.forEach(t),Ed.forEach(t),i=0;i<wa.length;i++)a=wa[i],a.blockedOn===e&&(a.blockedOn=null);for(;0<wa.length&&(i=wa[0],i.blockedOn===null);)Nk(i),i.blockedOn===null&&wa.shift()}var cu=Lo.ReactCurrentBatchConfig,fm=!0;function LD(e,t,i,a){var h=Cn,g=cu.transition;cu.transition=null;try{Cn=1,I0(e,t,i,a)}finally{Cn=h,cu.transition=g}}function BD(e,t,i,a){var h=Cn,g=cu.transition;cu.transition=null;try{Cn=4,I0(e,t,i,a)}finally{Cn=h,cu.transition=g}}function I0(e,t,i,a){if(fm){var h=r_(e,t,i,a);if(h===null)Ky(e,t,a,pm,i),n1(e,a);else if(zD(h,e,t,i,a))a.stopPropagation();else if(n1(e,a),t&4&&-1<DD.indexOf(e)){for(;h!==null;){var g=Jd(h);if(g!==null&&Rk(g),g=r_(e,t,i,a),g===null&&Ky(e,t,a,pm,i),g===h)break;h=g}h!==null&&a.stopPropagation()}else Ky(e,t,a,null,i)}}var pm=null;function r_(e,t,i,a){if(pm=null,e=T0(a),e=Sl(e),e!==null)if(t=Vl(e),t===null)e=null;else if(i=t.tag,i===13){if(e=Ck(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return pm=e,null}function Ok(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(SD()){case C0:return 1;case Ak:return 4;case hm:case kD:return 16;case Mk:return 536870912;default:return 16}default:return 16}}var ka=null,A0=null,Wp=null;function jk(){if(Wp)return Wp;var e,t=A0,i=t.length,a,h="value"in ka?ka.value:ka.textContent,g=h.length;for(e=0;e<i&&t[e]===h[e];e++);var p=i-e;for(a=1;a<=p&&t[i-a]===h[g-a];a++);return Wp=h.slice(e,1<a?1-a:void 0)}function qp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function yp(){return!0}function i1(){return!1}function os(e){function t(i,a,h,g,p){this._reactName=i,this._targetInst=h,this.type=a,this.nativeEvent=g,this.target=p,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(i=e[c],this[c]=i?i(g):g[c]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?yp:i1,this.isPropagationStopped=i1,this}return Qn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=yp)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=yp)},persist:function(){},isPersistent:yp}),t}var Cu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},M0=os(Cu),Yd=Qn({},Cu,{view:0,detail:0}),FD=os(Yd),Vy,Uy,Wh,Hm=Qn({},Yd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:D0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Wh&&(Wh&&e.type==="mousemove"?(Vy=e.screenX-Wh.screenX,Uy=e.screenY-Wh.screenY):Uy=Vy=0,Wh=e),Vy)},movementY:function(e){return"movementY"in e?e.movementY:Uy}}),s1=os(Hm),ND=Qn({},Hm,{dataTransfer:0}),OD=os(ND),jD=Qn({},Yd,{relatedTarget:0}),$y=os(jD),VD=Qn({},Cu,{animationName:0,elapsedTime:0,pseudoElement:0}),UD=os(VD),$D=Qn({},Cu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),HD=os($D),GD=Qn({},Cu,{data:0}),o1=os(GD),WD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XD(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ZD[e])?!!t[e]:!1}function D0(){return XD}var KD=Qn({},Yd,{key:function(e){if(e.key){var t=WD[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qD[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:D0,charCode:function(e){return e.type==="keypress"?qp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),YD=os(KD),JD=Qn({},Hm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),a1=os(JD),QD=Qn({},Yd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:D0}),ez=os(QD),tz=Qn({},Cu,{propertyName:0,elapsedTime:0,pseudoElement:0}),nz=os(tz),rz=Qn({},Hm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),iz=os(rz),sz=[9,13,27,32],z0=Ao&&"CompositionEvent"in window,ud=null;Ao&&"documentMode"in document&&(ud=document.documentMode);var oz=Ao&&"TextEvent"in window&&!ud,Vk=Ao&&(!z0||ud&&8<ud&&11>=ud),l1=" ",c1=!1;function Uk(e,t){switch(e){case"keyup":return sz.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $k(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wc=!1;function az(e,t){switch(e){case"compositionend":return $k(t);case"keypress":return t.which!==32?null:(c1=!0,l1);case"textInput":return e=t.data,e===l1&&c1?null:e;default:return null}}function lz(e,t){if(Wc)return e==="compositionend"||!z0&&Uk(e,t)?(e=jk(),Wp=A0=ka=null,Wc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Vk&&t.locale!=="ko"?null:t.data;default:return null}}var cz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!cz[e.type]:t==="textarea"}function Hk(e,t,i,a){bk(a),t=mm(t,"onChange"),0<t.length&&(i=new M0("onChange","change",null,i,a),e.push({event:i,listeners:t}))}var hd=null,Id=null;function uz(e){tT(e,0)}function Gm(e){var t=Xc(e);if(pk(t))return e}function hz(e,t){if(e==="change")return t}var Gk=!1;if(Ao){var Hy;if(Ao){var Gy="oninput"in document;if(!Gy){var h1=document.createElement("div");h1.setAttribute("oninput","return;"),Gy=typeof h1.oninput=="function"}Hy=Gy}else Hy=!1;Gk=Hy&&(!document.documentMode||9<document.documentMode)}function d1(){hd&&(hd.detachEvent("onpropertychange",Wk),Id=hd=null)}function Wk(e){if(e.propertyName==="value"&&Gm(Id)){var t=[];Hk(t,Id,e,T0(e)),Tk(uz,t)}}function dz(e,t,i){e==="focusin"?(d1(),hd=t,Id=i,hd.attachEvent("onpropertychange",Wk)):e==="focusout"&&d1()}function fz(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Gm(Id)}function pz(e,t){if(e==="click")return Gm(t)}function mz(e,t){if(e==="input"||e==="change")return Gm(t)}function gz(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ns=typeof Object.is=="function"?Object.is:gz;function Ad(e,t){if(Ns(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var h=i[a];if(!Ov.call(t,h)||!Ns(e[h],t[h]))return!1}return!0}function f1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function p1(e,t){var i=f1(e);e=0;for(var a;i;){if(i.nodeType===3){if(a=e+i.textContent.length,e<=t&&a>=t)return{node:i,offset:t-e};e=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=f1(i)}}function qk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?qk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Zk(){for(var e=window,t=lm();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=lm(e.document)}return t}function R0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yz(e){var t=Zk(),i=e.focusedElem,a=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&qk(i.ownerDocument.documentElement,i)){if(a!==null&&R0(i)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var h=i.textContent.length,g=Math.min(a.start,h);a=a.end===void 0?g:Math.min(a.end,h),!e.extend&&g>a&&(h=a,a=g,g=h),h=p1(i,g);var p=p1(i,a);h&&p&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(h.node,h.offset),e.removeAllRanges(),g>a?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vz=Ao&&"documentMode"in document&&11>=document.documentMode,qc=null,i_=null,dd=null,s_=!1;function m1(e,t,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;s_||qc==null||qc!==lm(a)||(a=qc,"selectionStart"in a&&R0(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),dd&&Ad(dd,a)||(dd=a,a=mm(i_,"onSelect"),0<a.length&&(t=new M0("onSelect","select",null,t,i),e.push({event:t,listeners:a}),t.target=qc)))}function vp(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Zc={animationend:vp("Animation","AnimationEnd"),animationiteration:vp("Animation","AnimationIteration"),animationstart:vp("Animation","AnimationStart"),transitionend:vp("Transition","TransitionEnd")},Wy={},Xk={};Ao&&(Xk=document.createElement("div").style,"AnimationEvent"in window||(delete Zc.animationend.animation,delete Zc.animationiteration.animation,delete Zc.animationstart.animation),"TransitionEvent"in window||delete Zc.transitionend.transition);function Wm(e){if(Wy[e])return Wy[e];if(!Zc[e])return e;var t=Zc[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in Xk)return Wy[e]=t[i];return e}var Kk=Wm("animationend"),Yk=Wm("animationiteration"),Jk=Wm("animationstart"),Qk=Wm("transitionend"),eT=new Map,g1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ja(e,t){eT.set(e,t),jl(t,[e])}for(var qy=0;qy<g1.length;qy++){var Zy=g1[qy],_z=Zy.toLowerCase(),xz=Zy[0].toUpperCase()+Zy.slice(1);ja(_z,"on"+xz)}ja(Kk,"onAnimationEnd");ja(Yk,"onAnimationIteration");ja(Jk,"onAnimationStart");ja("dblclick","onDoubleClick");ja("focusin","onFocus");ja("focusout","onBlur");ja(Qk,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);jl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jl("onBeforeInput",["compositionend","keypress","textInput","paste"]);jl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var id="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bz=new Set("cancel close invalid load scroll toggle".split(" ").concat(id));function y1(e,t,i){var a=e.type||"unknown-event";e.currentTarget=i,_D(a,t,void 0,e),e.currentTarget=null}function tT(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var a=e[i],h=a.event;a=a.listeners;e:{var g=void 0;if(t)for(var p=a.length-1;0<=p;p--){var c=a[p],S=c.instance,E=c.currentTarget;if(c=c.listener,S!==g&&h.isPropagationStopped())break e;y1(h,c,E),g=S}else for(p=0;p<a.length;p++){if(c=a[p],S=c.instance,E=c.currentTarget,c=c.listener,S!==g&&h.isPropagationStopped())break e;y1(h,c,E),g=S}}}if(um)throw e=e_,um=!1,e_=null,e}function Nn(e,t){var i=t[u_];i===void 0&&(i=t[u_]=new Set);var a=e+"__bubble";i.has(a)||(nT(t,e,2,!1),i.add(a))}function Xy(e,t,i){var a=0;t&&(a|=4),nT(i,e,a,t)}var _p="_reactListening"+Math.random().toString(36).slice(2);function Md(e){if(!e[_p]){e[_p]=!0,ck.forEach(function(i){i!=="selectionchange"&&(bz.has(i)||Xy(i,!1,e),Xy(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_p]||(t[_p]=!0,Xy("selectionchange",!1,t))}}function nT(e,t,i,a){switch(Ok(t)){case 1:var h=LD;break;case 4:h=BD;break;default:h=I0}i=h.bind(null,t,i,e),h=void 0,!Qv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),a?h!==void 0?e.addEventListener(t,i,{capture:!0,passive:h}):e.addEventListener(t,i,!0):h!==void 0?e.addEventListener(t,i,{passive:h}):e.addEventListener(t,i,!1)}function Ky(e,t,i,a,h){var g=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var p=a.tag;if(p===3||p===4){var c=a.stateNode.containerInfo;if(c===h||c.nodeType===8&&c.parentNode===h)break;if(p===4)for(p=a.return;p!==null;){var S=p.tag;if((S===3||S===4)&&(S=p.stateNode.containerInfo,S===h||S.nodeType===8&&S.parentNode===h))return;p=p.return}for(;c!==null;){if(p=Sl(c),p===null)return;if(S=p.tag,S===5||S===6){a=g=p;continue e}c=c.parentNode}}a=a.return}Tk(function(){var E=g,P=T0(i),k=[];e:{var I=eT.get(e);if(I!==void 0){var G=M0,Z=e;switch(e){case"keypress":if(qp(i)===0)break e;case"keydown":case"keyup":G=YD;break;case"focusin":Z="focus",G=$y;break;case"focusout":Z="blur",G=$y;break;case"beforeblur":case"afterblur":G=$y;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=s1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=OD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=ez;break;case Kk:case Yk:case Jk:G=UD;break;case Qk:G=nz;break;case"scroll":G=FD;break;case"wheel":G=iz;break;case"copy":case"cut":case"paste":G=HD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=a1}var H=(t&4)!==0,te=!H&&e==="scroll",L=H?I!==null?I+"Capture":null:I;H=[];for(var V=E,W;V!==null;){W=V;var re=W.stateNode;if(W.tag===5&&re!==null&&(W=re,L!==null&&(re=Td(V,L),re!=null&&H.push(Dd(V,re,W)))),te)break;V=V.return}0<H.length&&(I=new G(I,Z,null,i,P),k.push({event:I,listeners:H}))}}if(!(t&7)){e:{if(I=e==="mouseover"||e==="pointerover",G=e==="mouseout"||e==="pointerout",I&&i!==Yv&&(Z=i.relatedTarget||i.fromElement)&&(Sl(Z)||Z[Mo]))break e;if((G||I)&&(I=P.window===P?P:(I=P.ownerDocument)?I.defaultView||I.parentWindow:window,G?(Z=i.relatedTarget||i.toElement,G=E,Z=Z?Sl(Z):null,Z!==null&&(te=Vl(Z),Z!==te||Z.tag!==5&&Z.tag!==6)&&(Z=null)):(G=null,Z=E),G!==Z)){if(H=s1,re="onMouseLeave",L="onMouseEnter",V="mouse",(e==="pointerout"||e==="pointerover")&&(H=a1,re="onPointerLeave",L="onPointerEnter",V="pointer"),te=G==null?I:Xc(G),W=Z==null?I:Xc(Z),I=new H(re,V+"leave",G,i,P),I.target=te,I.relatedTarget=W,re=null,Sl(P)===E&&(H=new H(L,V+"enter",Z,i,P),H.target=W,H.relatedTarget=te,re=H),te=re,G&&Z)t:{for(H=G,L=Z,V=0,W=H;W;W=Bc(W))V++;for(W=0,re=L;re;re=Bc(re))W++;for(;0<V-W;)H=Bc(H),V--;for(;0<W-V;)L=Bc(L),W--;for(;V--;){if(H===L||L!==null&&H===L.alternate)break t;H=Bc(H),L=Bc(L)}H=null}else H=null;G!==null&&v1(k,I,G,H,!1),Z!==null&&te!==null&&v1(k,te,Z,H,!0)}}e:{if(I=E?Xc(E):window,G=I.nodeName&&I.nodeName.toLowerCase(),G==="select"||G==="input"&&I.type==="file")var pe=hz;else if(u1(I))if(Gk)pe=mz;else{pe=fz;var _e=dz}else(G=I.nodeName)&&G.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(pe=pz);if(pe&&(pe=pe(e,E))){Hk(k,pe,i,P);break e}_e&&_e(e,I,E),e==="focusout"&&(_e=I._wrapperState)&&_e.controlled&&I.type==="number"&&Wv(I,"number",I.value)}switch(_e=E?Xc(E):window,e){case"focusin":(u1(_e)||_e.contentEditable==="true")&&(qc=_e,i_=E,dd=null);break;case"focusout":dd=i_=qc=null;break;case"mousedown":s_=!0;break;case"contextmenu":case"mouseup":case"dragend":s_=!1,m1(k,i,P);break;case"selectionchange":if(vz)break;case"keydown":case"keyup":m1(k,i,P)}var le;if(z0)e:{switch(e){case"compositionstart":var ce="onCompositionStart";break e;case"compositionend":ce="onCompositionEnd";break e;case"compositionupdate":ce="onCompositionUpdate";break e}ce=void 0}else Wc?Uk(e,i)&&(ce="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(ce="onCompositionStart");ce&&(Vk&&i.locale!=="ko"&&(Wc||ce!=="onCompositionStart"?ce==="onCompositionEnd"&&Wc&&(le=jk()):(ka=P,A0="value"in ka?ka.value:ka.textContent,Wc=!0)),_e=mm(E,ce),0<_e.length&&(ce=new o1(ce,e,null,i,P),k.push({event:ce,listeners:_e}),le?ce.data=le:(le=$k(i),le!==null&&(ce.data=le)))),(le=oz?az(e,i):lz(e,i))&&(E=mm(E,"onBeforeInput"),0<E.length&&(P=new o1("onBeforeInput","beforeinput",null,i,P),k.push({event:P,listeners:E}),P.data=le))}tT(k,t)})}function Dd(e,t,i){return{instance:e,listener:t,currentTarget:i}}function mm(e,t){for(var i=t+"Capture",a=[];e!==null;){var h=e,g=h.stateNode;h.tag===5&&g!==null&&(h=g,g=Td(e,i),g!=null&&a.unshift(Dd(e,g,h)),g=Td(e,t),g!=null&&a.push(Dd(e,g,h))),e=e.return}return a}function Bc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function v1(e,t,i,a,h){for(var g=t._reactName,p=[];i!==null&&i!==a;){var c=i,S=c.alternate,E=c.stateNode;if(S!==null&&S===a)break;c.tag===5&&E!==null&&(c=E,h?(S=Td(i,g),S!=null&&p.unshift(Dd(i,S,c))):h||(S=Td(i,g),S!=null&&p.push(Dd(i,S,c)))),i=i.return}p.length!==0&&e.push({event:t,listeners:p})}var wz=/\r\n?/g,Sz=/\u0000|\uFFFD/g;function _1(e){return(typeof e=="string"?e:""+e).replace(wz,`
`).replace(Sz,"")}function xp(e,t,i){if(t=_1(t),_1(e)!==t&&i)throw Error(nt(425))}function gm(){}var o_=null,a_=null;function l_(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var c_=typeof setTimeout=="function"?setTimeout:void 0,kz=typeof clearTimeout=="function"?clearTimeout:void 0,x1=typeof Promise=="function"?Promise:void 0,Tz=typeof queueMicrotask=="function"?queueMicrotask:typeof x1<"u"?function(e){return x1.resolve(null).then(e).catch(Cz)}:c_;function Cz(e){setTimeout(function(){throw e})}function Yy(e,t){var i=t,a=0;do{var h=i.nextSibling;if(e.removeChild(i),h&&h.nodeType===8)if(i=h.data,i==="/$"){if(a===0){e.removeChild(h),Pd(t);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=h}while(i);Pd(t)}function Aa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function b1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Eu=Math.random().toString(36).slice(2),Ys="__reactFiber$"+Eu,zd="__reactProps$"+Eu,Mo="__reactContainer$"+Eu,u_="__reactEvents$"+Eu,Ez="__reactListeners$"+Eu,Pz="__reactHandles$"+Eu;function Sl(e){var t=e[Ys];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Mo]||i[Ys]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=b1(e);e!==null;){if(i=e[Ys])return i;e=b1(e)}return t}e=i,i=e.parentNode}return null}function Jd(e){return e=e[Ys]||e[Mo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Xc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(nt(33))}function qm(e){return e[zd]||null}var h_=[],Kc=-1;function Va(e){return{current:e}}function On(e){0>Kc||(e.current=h_[Kc],h_[Kc]=null,Kc--)}function Ln(e,t){Kc++,h_[Kc]=e.current,e.current=t}var Ba={},li=Va(Ba),Ni=Va(!1),Ml=Ba;function mu(e,t){var i=e.type.contextTypes;if(!i)return Ba;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var h={},g;for(g in i)h[g]=t[g];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=h),h}function Oi(e){return e=e.childContextTypes,e!=null}function ym(){On(Ni),On(li)}function w1(e,t,i){if(li.current!==Ba)throw Error(nt(168));Ln(li,t),Ln(Ni,i)}function rT(e,t,i){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var h in a)if(!(h in t))throw Error(nt(108,dD(e)||"Unknown",h));return Qn({},i,a)}function vm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ba,Ml=li.current,Ln(li,e),Ln(Ni,Ni.current),!0}function S1(e,t,i){var a=e.stateNode;if(!a)throw Error(nt(169));i?(e=rT(e,t,Ml),a.__reactInternalMemoizedMergedChildContext=e,On(Ni),On(li),Ln(li,e)):On(Ni),Ln(Ni,i)}var ko=null,Zm=!1,Jy=!1;function iT(e){ko===null?ko=[e]:ko.push(e)}function Iz(e){Zm=!0,iT(e)}function Ua(){if(!Jy&&ko!==null){Jy=!0;var e=0,t=Cn;try{var i=ko;for(Cn=1;e<i.length;e++){var a=i[e];do a=a(!0);while(a!==null)}ko=null,Zm=!1}catch(h){throw ko!==null&&(ko=ko.slice(e+1)),Ik(C0,Ua),h}finally{Cn=t,Jy=!1}}return null}var Yc=[],Jc=0,_m=null,xm=0,ms=[],gs=0,Dl=null,To=1,Co="";function xl(e,t){Yc[Jc++]=xm,Yc[Jc++]=_m,_m=e,xm=t}function sT(e,t,i){ms[gs++]=To,ms[gs++]=Co,ms[gs++]=Dl,Dl=e;var a=To;e=Co;var h=32-Ls(a)-1;a&=~(1<<h),i+=1;var g=32-Ls(t)+h;if(30<g){var p=h-h%5;g=(a&(1<<p)-1).toString(32),a>>=p,h-=p,To=1<<32-Ls(t)+h|i<<h|a,Co=g+e}else To=1<<g|i<<h|a,Co=e}function L0(e){e.return!==null&&(xl(e,1),sT(e,1,0))}function B0(e){for(;e===_m;)_m=Yc[--Jc],Yc[Jc]=null,xm=Yc[--Jc],Yc[Jc]=null;for(;e===Dl;)Dl=ms[--gs],ms[gs]=null,Co=ms[--gs],ms[gs]=null,To=ms[--gs],ms[gs]=null}var ns=null,ts=null,Hn=!1,zs=null;function oT(e,t){var i=ys(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function k1(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ns=e,ts=Aa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ns=e,ts=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Dl!==null?{id:To,overflow:Co}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=ys(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,ns=e,ts=null,!0):!1;default:return!1}}function d_(e){return(e.mode&1)!==0&&(e.flags&128)===0}function f_(e){if(Hn){var t=ts;if(t){var i=t;if(!k1(e,t)){if(d_(e))throw Error(nt(418));t=Aa(i.nextSibling);var a=ns;t&&k1(e,t)?oT(a,i):(e.flags=e.flags&-4097|2,Hn=!1,ns=e)}}else{if(d_(e))throw Error(nt(418));e.flags=e.flags&-4097|2,Hn=!1,ns=e}}}function T1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ns=e}function bp(e){if(e!==ns)return!1;if(!Hn)return T1(e),Hn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!l_(e.type,e.memoizedProps)),t&&(t=ts)){if(d_(e))throw aT(),Error(nt(418));for(;t;)oT(e,t),t=Aa(t.nextSibling)}if(T1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(nt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){ts=Aa(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}ts=null}}else ts=ns?Aa(e.stateNode.nextSibling):null;return!0}function aT(){for(var e=ts;e;)e=Aa(e.nextSibling)}function gu(){ts=ns=null,Hn=!1}function F0(e){zs===null?zs=[e]:zs.push(e)}var Az=Lo.ReactCurrentBatchConfig;function qh(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(nt(309));var a=i.stateNode}if(!a)throw Error(nt(147,e));var h=a,g=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===g?t.ref:(t=function(p){var c=h.refs;p===null?delete c[g]:c[g]=p},t._stringRef=g,t)}if(typeof e!="string")throw Error(nt(284));if(!i._owner)throw Error(nt(290,e))}return e}function wp(e,t){throw e=Object.prototype.toString.call(t),Error(nt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function C1(e){var t=e._init;return t(e._payload)}function lT(e){function t(L,V){if(e){var W=L.deletions;W===null?(L.deletions=[V],L.flags|=16):W.push(V)}}function i(L,V){if(!e)return null;for(;V!==null;)t(L,V),V=V.sibling;return null}function a(L,V){for(L=new Map;V!==null;)V.key!==null?L.set(V.key,V):L.set(V.index,V),V=V.sibling;return L}function h(L,V){return L=Ra(L,V),L.index=0,L.sibling=null,L}function g(L,V,W){return L.index=W,e?(W=L.alternate,W!==null?(W=W.index,W<V?(L.flags|=2,V):W):(L.flags|=2,V)):(L.flags|=1048576,V)}function p(L){return e&&L.alternate===null&&(L.flags|=2),L}function c(L,V,W,re){return V===null||V.tag!==6?(V=sv(W,L.mode,re),V.return=L,V):(V=h(V,W),V.return=L,V)}function S(L,V,W,re){var pe=W.type;return pe===Gc?P(L,V,W.props.children,re,W.key):V!==null&&(V.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===xa&&C1(pe)===V.type)?(re=h(V,W.props),re.ref=qh(L,V,W),re.return=L,re):(re=em(W.type,W.key,W.props,null,L.mode,re),re.ref=qh(L,V,W),re.return=L,re)}function E(L,V,W,re){return V===null||V.tag!==4||V.stateNode.containerInfo!==W.containerInfo||V.stateNode.implementation!==W.implementation?(V=ov(W,L.mode,re),V.return=L,V):(V=h(V,W.children||[]),V.return=L,V)}function P(L,V,W,re,pe){return V===null||V.tag!==7?(V=Il(W,L.mode,re,pe),V.return=L,V):(V=h(V,W),V.return=L,V)}function k(L,V,W){if(typeof V=="string"&&V!==""||typeof V=="number")return V=sv(""+V,L.mode,W),V.return=L,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case hp:return W=em(V.type,V.key,V.props,null,L.mode,W),W.ref=qh(L,null,V),W.return=L,W;case Hc:return V=ov(V,L.mode,W),V.return=L,V;case xa:var re=V._init;return k(L,re(V._payload),W)}if(nd(V)||Uh(V))return V=Il(V,L.mode,W,null),V.return=L,V;wp(L,V)}return null}function I(L,V,W,re){var pe=V!==null?V.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return pe!==null?null:c(L,V,""+W,re);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case hp:return W.key===pe?S(L,V,W,re):null;case Hc:return W.key===pe?E(L,V,W,re):null;case xa:return pe=W._init,I(L,V,pe(W._payload),re)}if(nd(W)||Uh(W))return pe!==null?null:P(L,V,W,re,null);wp(L,W)}return null}function G(L,V,W,re,pe){if(typeof re=="string"&&re!==""||typeof re=="number")return L=L.get(W)||null,c(V,L,""+re,pe);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case hp:return L=L.get(re.key===null?W:re.key)||null,S(V,L,re,pe);case Hc:return L=L.get(re.key===null?W:re.key)||null,E(V,L,re,pe);case xa:var _e=re._init;return G(L,V,W,_e(re._payload),pe)}if(nd(re)||Uh(re))return L=L.get(W)||null,P(V,L,re,pe,null);wp(V,re)}return null}function Z(L,V,W,re){for(var pe=null,_e=null,le=V,ce=V=0,De=null;le!==null&&ce<W.length;ce++){le.index>ce?(De=le,le=null):De=le.sibling;var Be=I(L,le,W[ce],re);if(Be===null){le===null&&(le=De);break}e&&le&&Be.alternate===null&&t(L,le),V=g(Be,V,ce),_e===null?pe=Be:_e.sibling=Be,_e=Be,le=De}if(ce===W.length)return i(L,le),Hn&&xl(L,ce),pe;if(le===null){for(;ce<W.length;ce++)le=k(L,W[ce],re),le!==null&&(V=g(le,V,ce),_e===null?pe=le:_e.sibling=le,_e=le);return Hn&&xl(L,ce),pe}for(le=a(L,le);ce<W.length;ce++)De=G(le,L,ce,W[ce],re),De!==null&&(e&&De.alternate!==null&&le.delete(De.key===null?ce:De.key),V=g(De,V,ce),_e===null?pe=De:_e.sibling=De,_e=De);return e&&le.forEach(function(Ce){return t(L,Ce)}),Hn&&xl(L,ce),pe}function H(L,V,W,re){var pe=Uh(W);if(typeof pe!="function")throw Error(nt(150));if(W=pe.call(W),W==null)throw Error(nt(151));for(var _e=pe=null,le=V,ce=V=0,De=null,Be=W.next();le!==null&&!Be.done;ce++,Be=W.next()){le.index>ce?(De=le,le=null):De=le.sibling;var Ce=I(L,le,Be.value,re);if(Ce===null){le===null&&(le=De);break}e&&le&&Ce.alternate===null&&t(L,le),V=g(Ce,V,ce),_e===null?pe=Ce:_e.sibling=Ce,_e=Ce,le=De}if(Be.done)return i(L,le),Hn&&xl(L,ce),pe;if(le===null){for(;!Be.done;ce++,Be=W.next())Be=k(L,Be.value,re),Be!==null&&(V=g(Be,V,ce),_e===null?pe=Be:_e.sibling=Be,_e=Be);return Hn&&xl(L,ce),pe}for(le=a(L,le);!Be.done;ce++,Be=W.next())Be=G(le,L,ce,Be.value,re),Be!==null&&(e&&Be.alternate!==null&&le.delete(Be.key===null?ce:Be.key),V=g(Be,V,ce),_e===null?pe=Be:_e.sibling=Be,_e=Be);return e&&le.forEach(function(Fe){return t(L,Fe)}),Hn&&xl(L,ce),pe}function te(L,V,W,re){if(typeof W=="object"&&W!==null&&W.type===Gc&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case hp:e:{for(var pe=W.key,_e=V;_e!==null;){if(_e.key===pe){if(pe=W.type,pe===Gc){if(_e.tag===7){i(L,_e.sibling),V=h(_e,W.props.children),V.return=L,L=V;break e}}else if(_e.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===xa&&C1(pe)===_e.type){i(L,_e.sibling),V=h(_e,W.props),V.ref=qh(L,_e,W),V.return=L,L=V;break e}i(L,_e);break}else t(L,_e);_e=_e.sibling}W.type===Gc?(V=Il(W.props.children,L.mode,re,W.key),V.return=L,L=V):(re=em(W.type,W.key,W.props,null,L.mode,re),re.ref=qh(L,V,W),re.return=L,L=re)}return p(L);case Hc:e:{for(_e=W.key;V!==null;){if(V.key===_e)if(V.tag===4&&V.stateNode.containerInfo===W.containerInfo&&V.stateNode.implementation===W.implementation){i(L,V.sibling),V=h(V,W.children||[]),V.return=L,L=V;break e}else{i(L,V);break}else t(L,V);V=V.sibling}V=ov(W,L.mode,re),V.return=L,L=V}return p(L);case xa:return _e=W._init,te(L,V,_e(W._payload),re)}if(nd(W))return Z(L,V,W,re);if(Uh(W))return H(L,V,W,re);wp(L,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,V!==null&&V.tag===6?(i(L,V.sibling),V=h(V,W),V.return=L,L=V):(i(L,V),V=sv(W,L.mode,re),V.return=L,L=V),p(L)):i(L,V)}return te}var yu=lT(!0),cT=lT(!1),bm=Va(null),wm=null,Qc=null,N0=null;function O0(){N0=Qc=wm=null}function j0(e){var t=bm.current;On(bm),e._currentValue=t}function p_(e,t,i){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===i)break;e=e.return}}function uu(e,t){wm=e,N0=Qc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bi=!0),e.firstContext=null)}function bs(e){var t=e._currentValue;if(N0!==e)if(e={context:e,memoizedValue:t,next:null},Qc===null){if(wm===null)throw Error(nt(308));Qc=e,wm.dependencies={lanes:0,firstContext:e}}else Qc=Qc.next=e;return t}var kl=null;function V0(e){kl===null?kl=[e]:kl.push(e)}function uT(e,t,i,a){var h=t.interleaved;return h===null?(i.next=i,V0(t)):(i.next=h.next,h.next=i),t.interleaved=i,Do(e,a)}function Do(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var ba=!1;function U0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hT(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Eo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ma(e,t,i){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,pn&2){var h=a.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),a.pending=t,Do(e,i)}return h=a.interleaved,h===null?(t.next=t,V0(a)):(t.next=h.next,h.next=t),a.interleaved=t,Do(e,i)}function Zp(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,E0(e,i)}}function E1(e,t){var i=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var h=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var p={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};g===null?h=g=p:g=g.next=p,i=i.next}while(i!==null);g===null?h=g=t:g=g.next=t}else h=g=t;i={baseState:a.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:a.shared,effects:a.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Sm(e,t,i,a){var h=e.updateQueue;ba=!1;var g=h.firstBaseUpdate,p=h.lastBaseUpdate,c=h.shared.pending;if(c!==null){h.shared.pending=null;var S=c,E=S.next;S.next=null,p===null?g=E:p.next=E,p=S;var P=e.alternate;P!==null&&(P=P.updateQueue,c=P.lastBaseUpdate,c!==p&&(c===null?P.firstBaseUpdate=E:c.next=E,P.lastBaseUpdate=S))}if(g!==null){var k=h.baseState;p=0,P=E=S=null,c=g;do{var I=c.lane,G=c.eventTime;if((a&I)===I){P!==null&&(P=P.next={eventTime:G,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var Z=e,H=c;switch(I=t,G=i,H.tag){case 1:if(Z=H.payload,typeof Z=="function"){k=Z.call(G,k,I);break e}k=Z;break e;case 3:Z.flags=Z.flags&-65537|128;case 0:if(Z=H.payload,I=typeof Z=="function"?Z.call(G,k,I):Z,I==null)break e;k=Qn({},k,I);break e;case 2:ba=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,I=h.effects,I===null?h.effects=[c]:I.push(c))}else G={eventTime:G,lane:I,tag:c.tag,payload:c.payload,callback:c.callback,next:null},P===null?(E=P=G,S=k):P=P.next=G,p|=I;if(c=c.next,c===null){if(c=h.shared.pending,c===null)break;I=c,c=I.next,I.next=null,h.lastBaseUpdate=I,h.shared.pending=null}}while(!0);if(P===null&&(S=k),h.baseState=S,h.firstBaseUpdate=E,h.lastBaseUpdate=P,t=h.shared.interleaved,t!==null){h=t;do p|=h.lane,h=h.next;while(h!==t)}else g===null&&(h.shared.lanes=0);Rl|=p,e.lanes=p,e.memoizedState=k}}function P1(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],h=a.callback;if(h!==null){if(a.callback=null,a=i,typeof h!="function")throw Error(nt(191,h));h.call(a)}}}var Qd={},eo=Va(Qd),Rd=Va(Qd),Ld=Va(Qd);function Tl(e){if(e===Qd)throw Error(nt(174));return e}function $0(e,t){switch(Ln(Ld,t),Ln(Rd,e),Ln(eo,Qd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zv(t,e)}On(eo),Ln(eo,t)}function vu(){On(eo),On(Rd),On(Ld)}function dT(e){Tl(Ld.current);var t=Tl(eo.current),i=Zv(t,e.type);t!==i&&(Ln(Rd,e),Ln(eo,i))}function H0(e){Rd.current===e&&(On(eo),On(Rd))}var Xn=Va(0);function km(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qy=[];function G0(){for(var e=0;e<Qy.length;e++)Qy[e]._workInProgressVersionPrimary=null;Qy.length=0}var Xp=Lo.ReactCurrentDispatcher,ev=Lo.ReactCurrentBatchConfig,zl=0,Jn=null,Er=null,Nr=null,Tm=!1,fd=!1,Bd=0,Mz=0;function ii(){throw Error(nt(321))}function W0(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Ns(e[i],t[i]))return!1;return!0}function q0(e,t,i,a,h,g){if(zl=g,Jn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Xp.current=e===null||e.memoizedState===null?Lz:Bz,e=i(a,h),fd){g=0;do{if(fd=!1,Bd=0,25<=g)throw Error(nt(301));g+=1,Nr=Er=null,t.updateQueue=null,Xp.current=Fz,e=i(a,h)}while(fd)}if(Xp.current=Cm,t=Er!==null&&Er.next!==null,zl=0,Nr=Er=Jn=null,Tm=!1,t)throw Error(nt(300));return e}function Z0(){var e=Bd!==0;return Bd=0,e}function Ks(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nr===null?Jn.memoizedState=Nr=e:Nr=Nr.next=e,Nr}function ws(){if(Er===null){var e=Jn.alternate;e=e!==null?e.memoizedState:null}else e=Er.next;var t=Nr===null?Jn.memoizedState:Nr.next;if(t!==null)Nr=t,Er=e;else{if(e===null)throw Error(nt(310));Er=e,e={memoizedState:Er.memoizedState,baseState:Er.baseState,baseQueue:Er.baseQueue,queue:Er.queue,next:null},Nr===null?Jn.memoizedState=Nr=e:Nr=Nr.next=e}return Nr}function Fd(e,t){return typeof t=="function"?t(e):t}function tv(e){var t=ws(),i=t.queue;if(i===null)throw Error(nt(311));i.lastRenderedReducer=e;var a=Er,h=a.baseQueue,g=i.pending;if(g!==null){if(h!==null){var p=h.next;h.next=g.next,g.next=p}a.baseQueue=h=g,i.pending=null}if(h!==null){g=h.next,a=a.baseState;var c=p=null,S=null,E=g;do{var P=E.lane;if((zl&P)===P)S!==null&&(S=S.next={lane:0,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null}),a=E.hasEagerState?E.eagerState:e(a,E.action);else{var k={lane:P,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null};S===null?(c=S=k,p=a):S=S.next=k,Jn.lanes|=P,Rl|=P}E=E.next}while(E!==null&&E!==g);S===null?p=a:S.next=c,Ns(a,t.memoizedState)||(Bi=!0),t.memoizedState=a,t.baseState=p,t.baseQueue=S,i.lastRenderedState=a}if(e=i.interleaved,e!==null){h=e;do g=h.lane,Jn.lanes|=g,Rl|=g,h=h.next;while(h!==e)}else h===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function nv(e){var t=ws(),i=t.queue;if(i===null)throw Error(nt(311));i.lastRenderedReducer=e;var a=i.dispatch,h=i.pending,g=t.memoizedState;if(h!==null){i.pending=null;var p=h=h.next;do g=e(g,p.action),p=p.next;while(p!==h);Ns(g,t.memoizedState)||(Bi=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),i.lastRenderedState=g}return[g,a]}function fT(){}function pT(e,t){var i=Jn,a=ws(),h=t(),g=!Ns(a.memoizedState,h);if(g&&(a.memoizedState=h,Bi=!0),a=a.queue,X0(yT.bind(null,i,a,e),[e]),a.getSnapshot!==t||g||Nr!==null&&Nr.memoizedState.tag&1){if(i.flags|=2048,Nd(9,gT.bind(null,i,a,h,t),void 0,null),Or===null)throw Error(nt(349));zl&30||mT(i,t,h)}return h}function mT(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=Jn.updateQueue,t===null?(t={lastEffect:null,stores:null},Jn.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function gT(e,t,i,a){t.value=i,t.getSnapshot=a,vT(t)&&_T(e)}function yT(e,t,i){return i(function(){vT(t)&&_T(e)})}function vT(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Ns(e,i)}catch{return!0}}function _T(e){var t=Do(e,1);t!==null&&Bs(t,e,1,-1)}function I1(e){var t=Ks();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fd,lastRenderedState:e},t.queue=e,e=e.dispatch=Rz.bind(null,Jn,e),[t.memoizedState,e]}function Nd(e,t,i,a){return e={tag:e,create:t,destroy:i,deps:a,next:null},t=Jn.updateQueue,t===null?(t={lastEffect:null,stores:null},Jn.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(a=i.next,i.next=e,e.next=a,t.lastEffect=e)),e}function xT(){return ws().memoizedState}function Kp(e,t,i,a){var h=Ks();Jn.flags|=e,h.memoizedState=Nd(1|t,i,void 0,a===void 0?null:a)}function Xm(e,t,i,a){var h=ws();a=a===void 0?null:a;var g=void 0;if(Er!==null){var p=Er.memoizedState;if(g=p.destroy,a!==null&&W0(a,p.deps)){h.memoizedState=Nd(t,i,g,a);return}}Jn.flags|=e,h.memoizedState=Nd(1|t,i,g,a)}function A1(e,t){return Kp(8390656,8,e,t)}function X0(e,t){return Xm(2048,8,e,t)}function bT(e,t){return Xm(4,2,e,t)}function wT(e,t){return Xm(4,4,e,t)}function ST(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function kT(e,t,i){return i=i!=null?i.concat([e]):null,Xm(4,4,ST.bind(null,t,e),i)}function K0(){}function TT(e,t){var i=ws();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&W0(t,a[1])?a[0]:(i.memoizedState=[e,t],e)}function CT(e,t){var i=ws();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&W0(t,a[1])?a[0]:(e=e(),i.memoizedState=[e,t],e)}function ET(e,t,i){return zl&21?(Ns(i,t)||(i=Dk(),Jn.lanes|=i,Rl|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bi=!0),e.memoizedState=i)}function Dz(e,t){var i=Cn;Cn=i!==0&&4>i?i:4,e(!0);var a=ev.transition;ev.transition={};try{e(!1),t()}finally{Cn=i,ev.transition=a}}function PT(){return ws().memoizedState}function zz(e,t,i){var a=za(e);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},IT(e))AT(t,i);else if(i=uT(e,t,i,a),i!==null){var h=bi();Bs(i,e,a,h),MT(i,t,a)}}function Rz(e,t,i){var a=za(e),h={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(IT(e))AT(t,h);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var p=t.lastRenderedState,c=g(p,i);if(h.hasEagerState=!0,h.eagerState=c,Ns(c,p)){var S=t.interleaved;S===null?(h.next=h,V0(t)):(h.next=S.next,S.next=h),t.interleaved=h;return}}catch{}finally{}i=uT(e,t,h,a),i!==null&&(h=bi(),Bs(i,e,a,h),MT(i,t,a))}}function IT(e){var t=e.alternate;return e===Jn||t!==null&&t===Jn}function AT(e,t){fd=Tm=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function MT(e,t,i){if(i&4194240){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,E0(e,i)}}var Cm={readContext:bs,useCallback:ii,useContext:ii,useEffect:ii,useImperativeHandle:ii,useInsertionEffect:ii,useLayoutEffect:ii,useMemo:ii,useReducer:ii,useRef:ii,useState:ii,useDebugValue:ii,useDeferredValue:ii,useTransition:ii,useMutableSource:ii,useSyncExternalStore:ii,useId:ii,unstable_isNewReconciler:!1},Lz={readContext:bs,useCallback:function(e,t){return Ks().memoizedState=[e,t===void 0?null:t],e},useContext:bs,useEffect:A1,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,Kp(4194308,4,ST.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Kp(4194308,4,e,t)},useInsertionEffect:function(e,t){return Kp(4,2,e,t)},useMemo:function(e,t){var i=Ks();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var a=Ks();return t=i!==void 0?i(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=zz.bind(null,Jn,e),[a.memoizedState,e]},useRef:function(e){var t=Ks();return e={current:e},t.memoizedState=e},useState:I1,useDebugValue:K0,useDeferredValue:function(e){return Ks().memoizedState=e},useTransition:function(){var e=I1(!1),t=e[0];return e=Dz.bind(null,e[1]),Ks().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var a=Jn,h=Ks();if(Hn){if(i===void 0)throw Error(nt(407));i=i()}else{if(i=t(),Or===null)throw Error(nt(349));zl&30||mT(a,t,i)}h.memoizedState=i;var g={value:i,getSnapshot:t};return h.queue=g,A1(yT.bind(null,a,g,e),[e]),a.flags|=2048,Nd(9,gT.bind(null,a,g,i,t),void 0,null),i},useId:function(){var e=Ks(),t=Or.identifierPrefix;if(Hn){var i=Co,a=To;i=(a&~(1<<32-Ls(a)-1)).toString(32)+i,t=":"+t+"R"+i,i=Bd++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=Mz++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Bz={readContext:bs,useCallback:TT,useContext:bs,useEffect:X0,useImperativeHandle:kT,useInsertionEffect:bT,useLayoutEffect:wT,useMemo:CT,useReducer:tv,useRef:xT,useState:function(){return tv(Fd)},useDebugValue:K0,useDeferredValue:function(e){var t=ws();return ET(t,Er.memoizedState,e)},useTransition:function(){var e=tv(Fd)[0],t=ws().memoizedState;return[e,t]},useMutableSource:fT,useSyncExternalStore:pT,useId:PT,unstable_isNewReconciler:!1},Fz={readContext:bs,useCallback:TT,useContext:bs,useEffect:X0,useImperativeHandle:kT,useInsertionEffect:bT,useLayoutEffect:wT,useMemo:CT,useReducer:nv,useRef:xT,useState:function(){return nv(Fd)},useDebugValue:K0,useDeferredValue:function(e){var t=ws();return Er===null?t.memoizedState=e:ET(t,Er.memoizedState,e)},useTransition:function(){var e=nv(Fd)[0],t=ws().memoizedState;return[e,t]},useMutableSource:fT,useSyncExternalStore:pT,useId:PT,unstable_isNewReconciler:!1};function Ms(e,t){if(e&&e.defaultProps){t=Qn({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function m_(e,t,i,a){t=e.memoizedState,i=i(a,t),i=i==null?t:Qn({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Km={isMounted:function(e){return(e=e._reactInternals)?Vl(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var a=bi(),h=za(e),g=Eo(a,h);g.payload=t,i!=null&&(g.callback=i),t=Ma(e,g,h),t!==null&&(Bs(t,e,h,a),Zp(t,e,h))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var a=bi(),h=za(e),g=Eo(a,h);g.tag=1,g.payload=t,i!=null&&(g.callback=i),t=Ma(e,g,h),t!==null&&(Bs(t,e,h,a),Zp(t,e,h))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=bi(),a=za(e),h=Eo(i,a);h.tag=2,t!=null&&(h.callback=t),t=Ma(e,h,a),t!==null&&(Bs(t,e,a,i),Zp(t,e,a))}};function M1(e,t,i,a,h,g,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,g,p):t.prototype&&t.prototype.isPureReactComponent?!Ad(i,a)||!Ad(h,g):!0}function DT(e,t,i){var a=!1,h=Ba,g=t.contextType;return typeof g=="object"&&g!==null?g=bs(g):(h=Oi(t)?Ml:li.current,a=t.contextTypes,g=(a=a!=null)?mu(e,h):Ba),t=new t(i,g),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Km,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=g),t}function D1(e,t,i,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,a),t.state!==e&&Km.enqueueReplaceState(t,t.state,null)}function g_(e,t,i,a){var h=e.stateNode;h.props=i,h.state=e.memoizedState,h.refs={},U0(e);var g=t.contextType;typeof g=="object"&&g!==null?h.context=bs(g):(g=Oi(t)?Ml:li.current,h.context=mu(e,g)),h.state=e.memoizedState,g=t.getDerivedStateFromProps,typeof g=="function"&&(m_(e,t,g,i),h.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(t=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),t!==h.state&&Km.enqueueReplaceState(h,h.state,null),Sm(e,i,h,a),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function _u(e,t){try{var i="",a=t;do i+=hD(a),a=a.return;while(a);var h=i}catch(g){h=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:t,stack:h,digest:null}}function rv(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function y_(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var Nz=typeof WeakMap=="function"?WeakMap:Map;function zT(e,t,i){i=Eo(-1,i),i.tag=3,i.payload={element:null};var a=t.value;return i.callback=function(){Pm||(Pm=!0,E_=a),y_(e,t)},i}function RT(e,t,i){i=Eo(-1,i),i.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var h=t.value;i.payload=function(){return a(h)},i.callback=function(){y_(e,t)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(i.callback=function(){y_(e,t),typeof a!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),i}function z1(e,t,i){var a=e.pingCache;if(a===null){a=e.pingCache=new Nz;var h=new Set;a.set(t,h)}else h=a.get(t),h===void 0&&(h=new Set,a.set(t,h));h.has(i)||(h.add(i),e=Jz.bind(null,e,t,i),t.then(e,e))}function R1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function L1(e,t,i,a,h){return e.mode&1?(e.flags|=65536,e.lanes=h,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=Eo(-1,1),t.tag=2,Ma(i,t,1))),i.lanes|=1),e)}var Oz=Lo.ReactCurrentOwner,Bi=!1;function vi(e,t,i,a){t.child=e===null?cT(t,null,i,a):yu(t,e.child,i,a)}function B1(e,t,i,a,h){i=i.render;var g=t.ref;return uu(t,h),a=q0(e,t,i,a,g,h),i=Z0(),e!==null&&!Bi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,zo(e,t,h)):(Hn&&i&&L0(t),t.flags|=1,vi(e,t,a,h),t.child)}function F1(e,t,i,a,h){if(e===null){var g=i.type;return typeof g=="function"&&!ix(g)&&g.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=g,LT(e,t,g,a,h)):(e=em(i.type,null,a,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!(e.lanes&h)){var p=g.memoizedProps;if(i=i.compare,i=i!==null?i:Ad,i(p,a)&&e.ref===t.ref)return zo(e,t,h)}return t.flags|=1,e=Ra(g,a),e.ref=t.ref,e.return=t,t.child=e}function LT(e,t,i,a,h){if(e!==null){var g=e.memoizedProps;if(Ad(g,a)&&e.ref===t.ref)if(Bi=!1,t.pendingProps=a=g,(e.lanes&h)!==0)e.flags&131072&&(Bi=!0);else return t.lanes=e.lanes,zo(e,t,h)}return v_(e,t,i,a,h)}function BT(e,t,i){var a=t.pendingProps,h=a.children,g=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ln(tu,es),es|=i;else{if(!(i&1073741824))return e=g!==null?g.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ln(tu,es),es|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=g!==null?g.baseLanes:i,Ln(tu,es),es|=a}else g!==null?(a=g.baseLanes|i,t.memoizedState=null):a=i,Ln(tu,es),es|=a;return vi(e,t,h,i),t.child}function FT(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function v_(e,t,i,a,h){var g=Oi(i)?Ml:li.current;return g=mu(t,g),uu(t,h),i=q0(e,t,i,a,g,h),a=Z0(),e!==null&&!Bi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,zo(e,t,h)):(Hn&&a&&L0(t),t.flags|=1,vi(e,t,i,h),t.child)}function N1(e,t,i,a,h){if(Oi(i)){var g=!0;vm(t)}else g=!1;if(uu(t,h),t.stateNode===null)Yp(e,t),DT(t,i,a),g_(t,i,a,h),a=!0;else if(e===null){var p=t.stateNode,c=t.memoizedProps;p.props=c;var S=p.context,E=i.contextType;typeof E=="object"&&E!==null?E=bs(E):(E=Oi(i)?Ml:li.current,E=mu(t,E));var P=i.getDerivedStateFromProps,k=typeof P=="function"||typeof p.getSnapshotBeforeUpdate=="function";k||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(c!==a||S!==E)&&D1(t,p,a,E),ba=!1;var I=t.memoizedState;p.state=I,Sm(t,a,p,h),S=t.memoizedState,c!==a||I!==S||Ni.current||ba?(typeof P=="function"&&(m_(t,i,P,a),S=t.memoizedState),(c=ba||M1(t,i,c,a,I,S,E))?(k||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=S),p.props=a,p.state=S,p.context=E,a=c):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{p=t.stateNode,hT(e,t),c=t.memoizedProps,E=t.type===t.elementType?c:Ms(t.type,c),p.props=E,k=t.pendingProps,I=p.context,S=i.contextType,typeof S=="object"&&S!==null?S=bs(S):(S=Oi(i)?Ml:li.current,S=mu(t,S));var G=i.getDerivedStateFromProps;(P=typeof G=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(c!==k||I!==S)&&D1(t,p,a,S),ba=!1,I=t.memoizedState,p.state=I,Sm(t,a,p,h);var Z=t.memoizedState;c!==k||I!==Z||Ni.current||ba?(typeof G=="function"&&(m_(t,i,G,a),Z=t.memoizedState),(E=ba||M1(t,i,E,a,I,Z,S)||!1)?(P||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(a,Z,S),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(a,Z,S)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||c===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=Z),p.props=a,p.state=Z,p.context=S,a=E):(typeof p.componentDidUpdate!="function"||c===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),a=!1)}return __(e,t,i,a,g,h)}function __(e,t,i,a,h,g){FT(e,t);var p=(t.flags&128)!==0;if(!a&&!p)return h&&S1(t,i,!1),zo(e,t,g);a=t.stateNode,Oz.current=t;var c=p&&typeof i.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&p?(t.child=yu(t,e.child,null,g),t.child=yu(t,null,c,g)):vi(e,t,c,g),t.memoizedState=a.state,h&&S1(t,i,!0),t.child}function NT(e){var t=e.stateNode;t.pendingContext?w1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&w1(e,t.context,!1),$0(e,t.containerInfo)}function O1(e,t,i,a,h){return gu(),F0(h),t.flags|=256,vi(e,t,i,a),t.child}var x_={dehydrated:null,treeContext:null,retryLane:0};function b_(e){return{baseLanes:e,cachePool:null,transitions:null}}function OT(e,t,i){var a=t.pendingProps,h=Xn.current,g=!1,p=(t.flags&128)!==0,c;if((c=p)||(c=e!==null&&e.memoizedState===null?!1:(h&2)!==0),c?(g=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),Ln(Xn,h&1),e===null)return f_(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(p=a.children,e=a.fallback,g?(a=t.mode,g=t.child,p={mode:"hidden",children:p},!(a&1)&&g!==null?(g.childLanes=0,g.pendingProps=p):g=Qm(p,a,0,null),e=Il(e,a,i,null),g.return=t,e.return=t,g.sibling=e,t.child=g,t.child.memoizedState=b_(i),t.memoizedState=x_,e):Y0(t,p));if(h=e.memoizedState,h!==null&&(c=h.dehydrated,c!==null))return jz(e,t,p,a,c,h,i);if(g){g=a.fallback,p=t.mode,h=e.child,c=h.sibling;var S={mode:"hidden",children:a.children};return!(p&1)&&t.child!==h?(a=t.child,a.childLanes=0,a.pendingProps=S,t.deletions=null):(a=Ra(h,S),a.subtreeFlags=h.subtreeFlags&14680064),c!==null?g=Ra(c,g):(g=Il(g,p,i,null),g.flags|=2),g.return=t,a.return=t,a.sibling=g,t.child=a,a=g,g=t.child,p=e.child.memoizedState,p=p===null?b_(i):{baseLanes:p.baseLanes|i,cachePool:null,transitions:p.transitions},g.memoizedState=p,g.childLanes=e.childLanes&~i,t.memoizedState=x_,a}return g=e.child,e=g.sibling,a=Ra(g,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=i),a.return=t,a.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=a,t.memoizedState=null,a}function Y0(e,t){return t=Qm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Sp(e,t,i,a){return a!==null&&F0(a),yu(t,e.child,null,i),e=Y0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function jz(e,t,i,a,h,g,p){if(i)return t.flags&256?(t.flags&=-257,a=rv(Error(nt(422))),Sp(e,t,p,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(g=a.fallback,h=t.mode,a=Qm({mode:"visible",children:a.children},h,0,null),g=Il(g,h,p,null),g.flags|=2,a.return=t,g.return=t,a.sibling=g,t.child=a,t.mode&1&&yu(t,e.child,null,p),t.child.memoizedState=b_(p),t.memoizedState=x_,g);if(!(t.mode&1))return Sp(e,t,p,null);if(h.data==="$!"){if(a=h.nextSibling&&h.nextSibling.dataset,a)var c=a.dgst;return a=c,g=Error(nt(419)),a=rv(g,a,void 0),Sp(e,t,p,a)}if(c=(p&e.childLanes)!==0,Bi||c){if(a=Or,a!==null){switch(p&-p){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=h&(a.suspendedLanes|p)?0:h,h!==0&&h!==g.retryLane&&(g.retryLane=h,Do(e,h),Bs(a,e,h,-1))}return rx(),a=rv(Error(nt(421))),Sp(e,t,p,a)}return h.data==="$?"?(t.flags|=128,t.child=e.child,t=Qz.bind(null,e),h._reactRetry=t,null):(e=g.treeContext,ts=Aa(h.nextSibling),ns=t,Hn=!0,zs=null,e!==null&&(ms[gs++]=To,ms[gs++]=Co,ms[gs++]=Dl,To=e.id,Co=e.overflow,Dl=t),t=Y0(t,a.children),t.flags|=4096,t)}function j1(e,t,i){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),p_(e.return,t,i)}function iv(e,t,i,a,h){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:h}:(g.isBackwards=t,g.rendering=null,g.renderingStartTime=0,g.last=a,g.tail=i,g.tailMode=h)}function jT(e,t,i){var a=t.pendingProps,h=a.revealOrder,g=a.tail;if(vi(e,t,a.children,i),a=Xn.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&j1(e,i,t);else if(e.tag===19)j1(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Ln(Xn,a),!(t.mode&1))t.memoizedState=null;else switch(h){case"forwards":for(i=t.child,h=null;i!==null;)e=i.alternate,e!==null&&km(e)===null&&(h=i),i=i.sibling;i=h,i===null?(h=t.child,t.child=null):(h=i.sibling,i.sibling=null),iv(t,!1,h,i,g);break;case"backwards":for(i=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&km(e)===null){t.child=h;break}e=h.sibling,h.sibling=i,i=h,h=e}iv(t,!0,i,null,g);break;case"together":iv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yp(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zo(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Rl|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(nt(153));if(t.child!==null){for(e=t.child,i=Ra(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Ra(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function Vz(e,t,i){switch(t.tag){case 3:NT(t),gu();break;case 5:dT(t);break;case 1:Oi(t.type)&&vm(t);break;case 4:$0(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,h=t.memoizedProps.value;Ln(bm,a._currentValue),a._currentValue=h;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(Ln(Xn,Xn.current&1),t.flags|=128,null):i&t.child.childLanes?OT(e,t,i):(Ln(Xn,Xn.current&1),e=zo(e,t,i),e!==null?e.sibling:null);Ln(Xn,Xn.current&1);break;case 19:if(a=(i&t.childLanes)!==0,e.flags&128){if(a)return jT(e,t,i);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Ln(Xn,Xn.current),a)break;return null;case 22:case 23:return t.lanes=0,BT(e,t,i)}return zo(e,t,i)}var VT,w_,UT,$T;VT=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};w_=function(){};UT=function(e,t,i,a){var h=e.memoizedProps;if(h!==a){e=t.stateNode,Tl(eo.current);var g=null;switch(i){case"input":h=Hv(e,h),a=Hv(e,a),g=[];break;case"select":h=Qn({},h,{value:void 0}),a=Qn({},a,{value:void 0}),g=[];break;case"textarea":h=qv(e,h),a=qv(e,a),g=[];break;default:typeof h.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=gm)}Xv(i,a);var p;i=null;for(E in h)if(!a.hasOwnProperty(E)&&h.hasOwnProperty(E)&&h[E]!=null)if(E==="style"){var c=h[E];for(p in c)c.hasOwnProperty(p)&&(i||(i={}),i[p]="")}else E!=="dangerouslySetInnerHTML"&&E!=="children"&&E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(Sd.hasOwnProperty(E)?g||(g=[]):(g=g||[]).push(E,null));for(E in a){var S=a[E];if(c=h!=null?h[E]:void 0,a.hasOwnProperty(E)&&S!==c&&(S!=null||c!=null))if(E==="style")if(c){for(p in c)!c.hasOwnProperty(p)||S&&S.hasOwnProperty(p)||(i||(i={}),i[p]="");for(p in S)S.hasOwnProperty(p)&&c[p]!==S[p]&&(i||(i={}),i[p]=S[p])}else i||(g||(g=[]),g.push(E,i)),i=S;else E==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,c=c?c.__html:void 0,S!=null&&c!==S&&(g=g||[]).push(E,S)):E==="children"?typeof S!="string"&&typeof S!="number"||(g=g||[]).push(E,""+S):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&(Sd.hasOwnProperty(E)?(S!=null&&E==="onScroll"&&Nn("scroll",e),g||c===S||(g=[])):(g=g||[]).push(E,S))}i&&(g=g||[]).push("style",i);var E=g;(t.updateQueue=E)&&(t.flags|=4)}};$T=function(e,t,i,a){i!==a&&(t.flags|=4)};function Zh(e,t){if(!Hn)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function si(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,a=0;if(t)for(var h=e.child;h!==null;)i|=h.lanes|h.childLanes,a|=h.subtreeFlags&14680064,a|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)i|=h.lanes|h.childLanes,a|=h.subtreeFlags,a|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=a,e.childLanes=i,t}function Uz(e,t,i){var a=t.pendingProps;switch(B0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return si(t),null;case 1:return Oi(t.type)&&ym(),si(t),null;case 3:return a=t.stateNode,vu(),On(Ni),On(li),G0(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(bp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zs!==null&&(A_(zs),zs=null))),w_(e,t),si(t),null;case 5:H0(t);var h=Tl(Ld.current);if(i=t.type,e!==null&&t.stateNode!=null)UT(e,t,i,a,h),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(nt(166));return si(t),null}if(e=Tl(eo.current),bp(t)){a=t.stateNode,i=t.type;var g=t.memoizedProps;switch(a[Ys]=t,a[zd]=g,e=(t.mode&1)!==0,i){case"dialog":Nn("cancel",a),Nn("close",a);break;case"iframe":case"object":case"embed":Nn("load",a);break;case"video":case"audio":for(h=0;h<id.length;h++)Nn(id[h],a);break;case"source":Nn("error",a);break;case"img":case"image":case"link":Nn("error",a),Nn("load",a);break;case"details":Nn("toggle",a);break;case"input":Xw(a,g),Nn("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!g.multiple},Nn("invalid",a);break;case"textarea":Yw(a,g),Nn("invalid",a)}Xv(i,g),h=null;for(var p in g)if(g.hasOwnProperty(p)){var c=g[p];p==="children"?typeof c=="string"?a.textContent!==c&&(g.suppressHydrationWarning!==!0&&xp(a.textContent,c,e),h=["children",c]):typeof c=="number"&&a.textContent!==""+c&&(g.suppressHydrationWarning!==!0&&xp(a.textContent,c,e),h=["children",""+c]):Sd.hasOwnProperty(p)&&c!=null&&p==="onScroll"&&Nn("scroll",a)}switch(i){case"input":dp(a),Kw(a,g,!0);break;case"textarea":dp(a),Jw(a);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(a.onclick=gm)}a=h,t.updateQueue=a,a!==null&&(t.flags|=4)}else{p=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=yk(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=p.createElement(i,{is:a.is}):(e=p.createElement(i),i==="select"&&(p=e,a.multiple?p.multiple=!0:a.size&&(p.size=a.size))):e=p.createElementNS(e,i),e[Ys]=t,e[zd]=a,VT(e,t,!1,!1),t.stateNode=e;e:{switch(p=Kv(i,a),i){case"dialog":Nn("cancel",e),Nn("close",e),h=a;break;case"iframe":case"object":case"embed":Nn("load",e),h=a;break;case"video":case"audio":for(h=0;h<id.length;h++)Nn(id[h],e);h=a;break;case"source":Nn("error",e),h=a;break;case"img":case"image":case"link":Nn("error",e),Nn("load",e),h=a;break;case"details":Nn("toggle",e),h=a;break;case"input":Xw(e,a),h=Hv(e,a),Nn("invalid",e);break;case"option":h=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},h=Qn({},a,{value:void 0}),Nn("invalid",e);break;case"textarea":Yw(e,a),h=qv(e,a),Nn("invalid",e);break;default:h=a}Xv(i,h),c=h;for(g in c)if(c.hasOwnProperty(g)){var S=c[g];g==="style"?xk(e,S):g==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,S!=null&&vk(e,S)):g==="children"?typeof S=="string"?(i!=="textarea"||S!=="")&&kd(e,S):typeof S=="number"&&kd(e,""+S):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Sd.hasOwnProperty(g)?S!=null&&g==="onScroll"&&Nn("scroll",e):S!=null&&b0(e,g,S,p))}switch(i){case"input":dp(e),Kw(e,a,!1);break;case"textarea":dp(e),Jw(e);break;case"option":a.value!=null&&e.setAttribute("value",""+La(a.value));break;case"select":e.multiple=!!a.multiple,g=a.value,g!=null?ou(e,!!a.multiple,g,!1):a.defaultValue!=null&&ou(e,!!a.multiple,a.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=gm)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return si(t),null;case 6:if(e&&t.stateNode!=null)$T(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(nt(166));if(i=Tl(Ld.current),Tl(eo.current),bp(t)){if(a=t.stateNode,i=t.memoizedProps,a[Ys]=t,(g=a.nodeValue!==i)&&(e=ns,e!==null))switch(e.tag){case 3:xp(a.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xp(a.nodeValue,i,(e.mode&1)!==0)}g&&(t.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[Ys]=t,t.stateNode=a}return si(t),null;case 13:if(On(Xn),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Hn&&ts!==null&&t.mode&1&&!(t.flags&128))aT(),gu(),t.flags|=98560,g=!1;else if(g=bp(t),a!==null&&a.dehydrated!==null){if(e===null){if(!g)throw Error(nt(318));if(g=t.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(nt(317));g[Ys]=t}else gu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;si(t),g=!1}else zs!==null&&(A_(zs),zs=null),g=!0;if(!g)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||Xn.current&1?Pr===0&&(Pr=3):rx())),t.updateQueue!==null&&(t.flags|=4),si(t),null);case 4:return vu(),w_(e,t),e===null&&Md(t.stateNode.containerInfo),si(t),null;case 10:return j0(t.type._context),si(t),null;case 17:return Oi(t.type)&&ym(),si(t),null;case 19:if(On(Xn),g=t.memoizedState,g===null)return si(t),null;if(a=(t.flags&128)!==0,p=g.rendering,p===null)if(a)Zh(g,!1);else{if(Pr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(p=km(e),p!==null){for(t.flags|=128,Zh(g,!1),a=p.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=i,i=t.child;i!==null;)g=i,e=a,g.flags&=14680066,p=g.alternate,p===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=p.childLanes,g.lanes=p.lanes,g.child=p.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=p.memoizedProps,g.memoizedState=p.memoizedState,g.updateQueue=p.updateQueue,g.type=p.type,e=p.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Ln(Xn,Xn.current&1|2),t.child}e=e.sibling}g.tail!==null&&hr()>xu&&(t.flags|=128,a=!0,Zh(g,!1),t.lanes=4194304)}else{if(!a)if(e=km(p),e!==null){if(t.flags|=128,a=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),Zh(g,!0),g.tail===null&&g.tailMode==="hidden"&&!p.alternate&&!Hn)return si(t),null}else 2*hr()-g.renderingStartTime>xu&&i!==1073741824&&(t.flags|=128,a=!0,Zh(g,!1),t.lanes=4194304);g.isBackwards?(p.sibling=t.child,t.child=p):(i=g.last,i!==null?i.sibling=p:t.child=p,g.last=p)}return g.tail!==null?(t=g.tail,g.rendering=t,g.tail=t.sibling,g.renderingStartTime=hr(),t.sibling=null,i=Xn.current,Ln(Xn,a?i&1|2:i&1),t):(si(t),null);case 22:case 23:return nx(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?es&1073741824&&(si(t),t.subtreeFlags&6&&(t.flags|=8192)):si(t),null;case 24:return null;case 25:return null}throw Error(nt(156,t.tag))}function $z(e,t){switch(B0(t),t.tag){case 1:return Oi(t.type)&&ym(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return vu(),On(Ni),On(li),G0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return H0(t),null;case 13:if(On(Xn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(nt(340));gu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return On(Xn),null;case 4:return vu(),null;case 10:return j0(t.type._context),null;case 22:case 23:return nx(),null;case 24:return null;default:return null}}var kp=!1,oi=!1,Hz=typeof WeakSet=="function"?WeakSet:Set,It=null;function eu(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){ar(e,t,a)}else i.current=null}function S_(e,t,i){try{i()}catch(a){ar(e,t,a)}}var V1=!1;function Gz(e,t){if(o_=fm,e=Zk(),R0(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var h=a.anchorOffset,g=a.focusNode;a=a.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var p=0,c=-1,S=-1,E=0,P=0,k=e,I=null;t:for(;;){for(var G;k!==i||h!==0&&k.nodeType!==3||(c=p+h),k!==g||a!==0&&k.nodeType!==3||(S=p+a),k.nodeType===3&&(p+=k.nodeValue.length),(G=k.firstChild)!==null;)I=k,k=G;for(;;){if(k===e)break t;if(I===i&&++E===h&&(c=p),I===g&&++P===a&&(S=p),(G=k.nextSibling)!==null)break;k=I,I=k.parentNode}k=G}i=c===-1||S===-1?null:{start:c,end:S}}else i=null}i=i||{start:0,end:0}}else i=null;for(a_={focusedElem:e,selectionRange:i},fm=!1,It=t;It!==null;)if(t=It,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,It=e;else for(;It!==null;){t=It;try{var Z=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Z!==null){var H=Z.memoizedProps,te=Z.memoizedState,L=t.stateNode,V=L.getSnapshotBeforeUpdate(t.elementType===t.type?H:Ms(t.type,H),te);L.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var W=t.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(nt(163))}}catch(re){ar(t,t.return,re)}if(e=t.sibling,e!==null){e.return=t.return,It=e;break}It=t.return}return Z=V1,V1=!1,Z}function pd(e,t,i){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&e)===e){var g=h.destroy;h.destroy=void 0,g!==void 0&&S_(t,i,g)}h=h.next}while(h!==a)}}function Ym(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var a=i.create;i.destroy=a()}i=i.next}while(i!==t)}}function k_(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function HT(e){var t=e.alternate;t!==null&&(e.alternate=null,HT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ys],delete t[zd],delete t[u_],delete t[Ez],delete t[Pz])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function GT(e){return e.tag===5||e.tag===3||e.tag===4}function U1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||GT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function T_(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=gm));else if(a!==4&&(e=e.child,e!==null))for(T_(e,t,i),e=e.sibling;e!==null;)T_(e,t,i),e=e.sibling}function C_(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(C_(e,t,i),e=e.sibling;e!==null;)C_(e,t,i),e=e.sibling}var Gr=null,Ds=!1;function ga(e,t,i){for(i=i.child;i!==null;)WT(e,t,i),i=i.sibling}function WT(e,t,i){if(Qs&&typeof Qs.onCommitFiberUnmount=="function")try{Qs.onCommitFiberUnmount($m,i)}catch{}switch(i.tag){case 5:oi||eu(i,t);case 6:var a=Gr,h=Ds;Gr=null,ga(e,t,i),Gr=a,Ds=h,Gr!==null&&(Ds?(e=Gr,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Gr.removeChild(i.stateNode));break;case 18:Gr!==null&&(Ds?(e=Gr,i=i.stateNode,e.nodeType===8?Yy(e.parentNode,i):e.nodeType===1&&Yy(e,i),Pd(e)):Yy(Gr,i.stateNode));break;case 4:a=Gr,h=Ds,Gr=i.stateNode.containerInfo,Ds=!0,ga(e,t,i),Gr=a,Ds=h;break;case 0:case 11:case 14:case 15:if(!oi&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){h=a=a.next;do{var g=h,p=g.destroy;g=g.tag,p!==void 0&&(g&2||g&4)&&S_(i,t,p),h=h.next}while(h!==a)}ga(e,t,i);break;case 1:if(!oi&&(eu(i,t),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(c){ar(i,t,c)}ga(e,t,i);break;case 21:ga(e,t,i);break;case 22:i.mode&1?(oi=(a=oi)||i.memoizedState!==null,ga(e,t,i),oi=a):ga(e,t,i);break;default:ga(e,t,i)}}function $1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Hz),t.forEach(function(a){var h=eR.bind(null,e,a);i.has(a)||(i.add(a),a.then(h,h))})}}function Ps(e,t){var i=t.deletions;if(i!==null)for(var a=0;a<i.length;a++){var h=i[a];try{var g=e,p=t,c=p;e:for(;c!==null;){switch(c.tag){case 5:Gr=c.stateNode,Ds=!1;break e;case 3:Gr=c.stateNode.containerInfo,Ds=!0;break e;case 4:Gr=c.stateNode.containerInfo,Ds=!0;break e}c=c.return}if(Gr===null)throw Error(nt(160));WT(g,p,h),Gr=null,Ds=!1;var S=h.alternate;S!==null&&(S.return=null),h.return=null}catch(E){ar(h,t,E)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)qT(t,e),t=t.sibling}function qT(e,t){var i=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ps(t,e),Zs(e),a&4){try{pd(3,e,e.return),Ym(3,e)}catch(H){ar(e,e.return,H)}try{pd(5,e,e.return)}catch(H){ar(e,e.return,H)}}break;case 1:Ps(t,e),Zs(e),a&512&&i!==null&&eu(i,i.return);break;case 5:if(Ps(t,e),Zs(e),a&512&&i!==null&&eu(i,i.return),e.flags&32){var h=e.stateNode;try{kd(h,"")}catch(H){ar(e,e.return,H)}}if(a&4&&(h=e.stateNode,h!=null)){var g=e.memoizedProps,p=i!==null?i.memoizedProps:g,c=e.type,S=e.updateQueue;if(e.updateQueue=null,S!==null)try{c==="input"&&g.type==="radio"&&g.name!=null&&mk(h,g),Kv(c,p);var E=Kv(c,g);for(p=0;p<S.length;p+=2){var P=S[p],k=S[p+1];P==="style"?xk(h,k):P==="dangerouslySetInnerHTML"?vk(h,k):P==="children"?kd(h,k):b0(h,P,k,E)}switch(c){case"input":Gv(h,g);break;case"textarea":gk(h,g);break;case"select":var I=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!g.multiple;var G=g.value;G!=null?ou(h,!!g.multiple,G,!1):I!==!!g.multiple&&(g.defaultValue!=null?ou(h,!!g.multiple,g.defaultValue,!0):ou(h,!!g.multiple,g.multiple?[]:"",!1))}h[zd]=g}catch(H){ar(e,e.return,H)}}break;case 6:if(Ps(t,e),Zs(e),a&4){if(e.stateNode===null)throw Error(nt(162));h=e.stateNode,g=e.memoizedProps;try{h.nodeValue=g}catch(H){ar(e,e.return,H)}}break;case 3:if(Ps(t,e),Zs(e),a&4&&i!==null&&i.memoizedState.isDehydrated)try{Pd(t.containerInfo)}catch(H){ar(e,e.return,H)}break;case 4:Ps(t,e),Zs(e);break;case 13:Ps(t,e),Zs(e),h=e.child,h.flags&8192&&(g=h.memoizedState!==null,h.stateNode.isHidden=g,!g||h.alternate!==null&&h.alternate.memoizedState!==null||(ex=hr())),a&4&&$1(e);break;case 22:if(P=i!==null&&i.memoizedState!==null,e.mode&1?(oi=(E=oi)||P,Ps(t,e),oi=E):Ps(t,e),Zs(e),a&8192){if(E=e.memoizedState!==null,(e.stateNode.isHidden=E)&&!P&&e.mode&1)for(It=e,P=e.child;P!==null;){for(k=It=P;It!==null;){switch(I=It,G=I.child,I.tag){case 0:case 11:case 14:case 15:pd(4,I,I.return);break;case 1:eu(I,I.return);var Z=I.stateNode;if(typeof Z.componentWillUnmount=="function"){a=I,i=I.return;try{t=a,Z.props=t.memoizedProps,Z.state=t.memoizedState,Z.componentWillUnmount()}catch(H){ar(a,i,H)}}break;case 5:eu(I,I.return);break;case 22:if(I.memoizedState!==null){G1(k);continue}}G!==null?(G.return=I,It=G):G1(k)}P=P.sibling}e:for(P=null,k=e;;){if(k.tag===5){if(P===null){P=k;try{h=k.stateNode,E?(g=h.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(c=k.stateNode,S=k.memoizedProps.style,p=S!=null&&S.hasOwnProperty("display")?S.display:null,c.style.display=_k("display",p))}catch(H){ar(e,e.return,H)}}}else if(k.tag===6){if(P===null)try{k.stateNode.nodeValue=E?"":k.memoizedProps}catch(H){ar(e,e.return,H)}}else if((k.tag!==22&&k.tag!==23||k.memoizedState===null||k===e)&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===e)break e;for(;k.sibling===null;){if(k.return===null||k.return===e)break e;P===k&&(P=null),k=k.return}P===k&&(P=null),k.sibling.return=k.return,k=k.sibling}}break;case 19:Ps(t,e),Zs(e),a&4&&$1(e);break;case 21:break;default:Ps(t,e),Zs(e)}}function Zs(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(GT(i)){var a=i;break e}i=i.return}throw Error(nt(160))}switch(a.tag){case 5:var h=a.stateNode;a.flags&32&&(kd(h,""),a.flags&=-33);var g=U1(e);C_(e,g,h);break;case 3:case 4:var p=a.stateNode.containerInfo,c=U1(e);T_(e,c,p);break;default:throw Error(nt(161))}}catch(S){ar(e,e.return,S)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Wz(e,t,i){It=e,ZT(e)}function ZT(e,t,i){for(var a=(e.mode&1)!==0;It!==null;){var h=It,g=h.child;if(h.tag===22&&a){var p=h.memoizedState!==null||kp;if(!p){var c=h.alternate,S=c!==null&&c.memoizedState!==null||oi;c=kp;var E=oi;if(kp=p,(oi=S)&&!E)for(It=h;It!==null;)p=It,S=p.child,p.tag===22&&p.memoizedState!==null?W1(h):S!==null?(S.return=p,It=S):W1(h);for(;g!==null;)It=g,ZT(g),g=g.sibling;It=h,kp=c,oi=E}H1(e)}else h.subtreeFlags&8772&&g!==null?(g.return=h,It=g):H1(e)}}function H1(e){for(;It!==null;){var t=It;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:oi||Ym(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!oi)if(i===null)a.componentDidMount();else{var h=t.elementType===t.type?i.memoizedProps:Ms(t.type,i.memoizedProps);a.componentDidUpdate(h,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var g=t.updateQueue;g!==null&&P1(t,g,a);break;case 3:var p=t.updateQueue;if(p!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}P1(t,p,i)}break;case 5:var c=t.stateNode;if(i===null&&t.flags&4){i=c;var S=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":S.autoFocus&&i.focus();break;case"img":S.src&&(i.src=S.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var E=t.alternate;if(E!==null){var P=E.memoizedState;if(P!==null){var k=P.dehydrated;k!==null&&Pd(k)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(nt(163))}oi||t.flags&512&&k_(t)}catch(I){ar(t,t.return,I)}}if(t===e){It=null;break}if(i=t.sibling,i!==null){i.return=t.return,It=i;break}It=t.return}}function G1(e){for(;It!==null;){var t=It;if(t===e){It=null;break}var i=t.sibling;if(i!==null){i.return=t.return,It=i;break}It=t.return}}function W1(e){for(;It!==null;){var t=It;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{Ym(4,t)}catch(S){ar(t,i,S)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var h=t.return;try{a.componentDidMount()}catch(S){ar(t,h,S)}}var g=t.return;try{k_(t)}catch(S){ar(t,g,S)}break;case 5:var p=t.return;try{k_(t)}catch(S){ar(t,p,S)}}}catch(S){ar(t,t.return,S)}if(t===e){It=null;break}var c=t.sibling;if(c!==null){c.return=t.return,It=c;break}It=t.return}}var qz=Math.ceil,Em=Lo.ReactCurrentDispatcher,J0=Lo.ReactCurrentOwner,_s=Lo.ReactCurrentBatchConfig,pn=0,Or=null,_r=null,qr=0,es=0,tu=Va(0),Pr=0,Od=null,Rl=0,Jm=0,Q0=0,md=null,Li=null,ex=0,xu=1/0,So=null,Pm=!1,E_=null,Da=null,Tp=!1,Ta=null,Im=0,gd=0,P_=null,Jp=-1,Qp=0;function bi(){return pn&6?hr():Jp!==-1?Jp:Jp=hr()}function za(e){return e.mode&1?pn&2&&qr!==0?qr&-qr:Az.transition!==null?(Qp===0&&(Qp=Dk()),Qp):(e=Cn,e!==0||(e=window.event,e=e===void 0?16:Ok(e.type)),e):1}function Bs(e,t,i,a){if(50<gd)throw gd=0,P_=null,Error(nt(185));Kd(e,i,a),(!(pn&2)||e!==Or)&&(e===Or&&(!(pn&2)&&(Jm|=i),Pr===4&&Sa(e,qr)),ji(e,a),i===1&&pn===0&&!(t.mode&1)&&(xu=hr()+500,Zm&&Ua()))}function ji(e,t){var i=e.callbackNode;AD(e,t);var a=dm(e,e===Or?qr:0);if(a===0)i!==null&&t1(i),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(i!=null&&t1(i),t===1)e.tag===0?Iz(q1.bind(null,e)):iT(q1.bind(null,e)),Tz(function(){!(pn&6)&&Ua()}),i=null;else{switch(zk(a)){case 1:i=C0;break;case 4:i=Ak;break;case 16:i=hm;break;case 536870912:i=Mk;break;default:i=hm}i=nC(i,XT.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function XT(e,t){if(Jp=-1,Qp=0,pn&6)throw Error(nt(327));var i=e.callbackNode;if(hu()&&e.callbackNode!==i)return null;var a=dm(e,e===Or?qr:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Am(e,a);else{t=a;var h=pn;pn|=2;var g=YT();(Or!==e||qr!==t)&&(So=null,xu=hr()+500,Pl(e,t));do try{Kz();break}catch(c){KT(e,c)}while(!0);O0(),Em.current=g,pn=h,_r!==null?t=0:(Or=null,qr=0,t=Pr)}if(t!==0){if(t===2&&(h=t_(e),h!==0&&(a=h,t=I_(e,h))),t===1)throw i=Od,Pl(e,0),Sa(e,a),ji(e,hr()),i;if(t===6)Sa(e,a);else{if(h=e.current.alternate,!(a&30)&&!Zz(h)&&(t=Am(e,a),t===2&&(g=t_(e),g!==0&&(a=g,t=I_(e,g))),t===1))throw i=Od,Pl(e,0),Sa(e,a),ji(e,hr()),i;switch(e.finishedWork=h,e.finishedLanes=a,t){case 0:case 1:throw Error(nt(345));case 2:bl(e,Li,So);break;case 3:if(Sa(e,a),(a&130023424)===a&&(t=ex+500-hr(),10<t)){if(dm(e,0)!==0)break;if(h=e.suspendedLanes,(h&a)!==a){bi(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=c_(bl.bind(null,e,Li,So),t);break}bl(e,Li,So);break;case 4:if(Sa(e,a),(a&4194240)===a)break;for(t=e.eventTimes,h=-1;0<a;){var p=31-Ls(a);g=1<<p,p=t[p],p>h&&(h=p),a&=~g}if(a=h,a=hr()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*qz(a/1960))-a,10<a){e.timeoutHandle=c_(bl.bind(null,e,Li,So),a);break}bl(e,Li,So);break;case 5:bl(e,Li,So);break;default:throw Error(nt(329))}}}return ji(e,hr()),e.callbackNode===i?XT.bind(null,e):null}function I_(e,t){var i=md;return e.current.memoizedState.isDehydrated&&(Pl(e,t).flags|=256),e=Am(e,t),e!==2&&(t=Li,Li=i,t!==null&&A_(t)),e}function A_(e){Li===null?Li=e:Li.push.apply(Li,e)}function Zz(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var h=i[a],g=h.getSnapshot;h=h.value;try{if(!Ns(g(),h))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Sa(e,t){for(t&=~Q0,t&=~Jm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Ls(t),a=1<<i;e[i]=-1,t&=~a}}function q1(e){if(pn&6)throw Error(nt(327));hu();var t=dm(e,0);if(!(t&1))return ji(e,hr()),null;var i=Am(e,t);if(e.tag!==0&&i===2){var a=t_(e);a!==0&&(t=a,i=I_(e,a))}if(i===1)throw i=Od,Pl(e,0),Sa(e,t),ji(e,hr()),i;if(i===6)throw Error(nt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bl(e,Li,So),ji(e,hr()),null}function tx(e,t){var i=pn;pn|=1;try{return e(t)}finally{pn=i,pn===0&&(xu=hr()+500,Zm&&Ua())}}function Ll(e){Ta!==null&&Ta.tag===0&&!(pn&6)&&hu();var t=pn;pn|=1;var i=_s.transition,a=Cn;try{if(_s.transition=null,Cn=1,e)return e()}finally{Cn=a,_s.transition=i,pn=t,!(pn&6)&&Ua()}}function nx(){es=tu.current,On(tu)}function Pl(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,kz(i)),_r!==null)for(i=_r.return;i!==null;){var a=i;switch(B0(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&ym();break;case 3:vu(),On(Ni),On(li),G0();break;case 5:H0(a);break;case 4:vu();break;case 13:On(Xn);break;case 19:On(Xn);break;case 10:j0(a.type._context);break;case 22:case 23:nx()}i=i.return}if(Or=e,_r=e=Ra(e.current,null),qr=es=t,Pr=0,Od=null,Q0=Jm=Rl=0,Li=md=null,kl!==null){for(t=0;t<kl.length;t++)if(i=kl[t],a=i.interleaved,a!==null){i.interleaved=null;var h=a.next,g=i.pending;if(g!==null){var p=g.next;g.next=h,a.next=p}i.pending=a}kl=null}return e}function KT(e,t){do{var i=_r;try{if(O0(),Xp.current=Cm,Tm){for(var a=Jn.memoizedState;a!==null;){var h=a.queue;h!==null&&(h.pending=null),a=a.next}Tm=!1}if(zl=0,Nr=Er=Jn=null,fd=!1,Bd=0,J0.current=null,i===null||i.return===null){Pr=1,Od=t,_r=null;break}e:{var g=e,p=i.return,c=i,S=t;if(t=qr,c.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){var E=S,P=c,k=P.tag;if(!(P.mode&1)&&(k===0||k===11||k===15)){var I=P.alternate;I?(P.updateQueue=I.updateQueue,P.memoizedState=I.memoizedState,P.lanes=I.lanes):(P.updateQueue=null,P.memoizedState=null)}var G=R1(p);if(G!==null){G.flags&=-257,L1(G,p,c,g,t),G.mode&1&&z1(g,E,t),t=G,S=E;var Z=t.updateQueue;if(Z===null){var H=new Set;H.add(S),t.updateQueue=H}else Z.add(S);break e}else{if(!(t&1)){z1(g,E,t),rx();break e}S=Error(nt(426))}}else if(Hn&&c.mode&1){var te=R1(p);if(te!==null){!(te.flags&65536)&&(te.flags|=256),L1(te,p,c,g,t),F0(_u(S,c));break e}}g=S=_u(S,c),Pr!==4&&(Pr=2),md===null?md=[g]:md.push(g),g=p;do{switch(g.tag){case 3:g.flags|=65536,t&=-t,g.lanes|=t;var L=zT(g,S,t);E1(g,L);break e;case 1:c=S;var V=g.type,W=g.stateNode;if(!(g.flags&128)&&(typeof V.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(Da===null||!Da.has(W)))){g.flags|=65536,t&=-t,g.lanes|=t;var re=RT(g,c,t);E1(g,re);break e}}g=g.return}while(g!==null)}QT(i)}catch(pe){t=pe,_r===i&&i!==null&&(_r=i=i.return);continue}break}while(!0)}function YT(){var e=Em.current;return Em.current=Cm,e===null?Cm:e}function rx(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),Or===null||!(Rl&268435455)&&!(Jm&268435455)||Sa(Or,qr)}function Am(e,t){var i=pn;pn|=2;var a=YT();(Or!==e||qr!==t)&&(So=null,Pl(e,t));do try{Xz();break}catch(h){KT(e,h)}while(!0);if(O0(),pn=i,Em.current=a,_r!==null)throw Error(nt(261));return Or=null,qr=0,Pr}function Xz(){for(;_r!==null;)JT(_r)}function Kz(){for(;_r!==null&&!bD();)JT(_r)}function JT(e){var t=tC(e.alternate,e,es);e.memoizedProps=e.pendingProps,t===null?QT(e):_r=t,J0.current=null}function QT(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=$z(i,t),i!==null){i.flags&=32767,_r=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Pr=6,_r=null;return}}else if(i=Uz(i,t,es),i!==null){_r=i;return}if(t=t.sibling,t!==null){_r=t;return}_r=t=e}while(t!==null);Pr===0&&(Pr=5)}function bl(e,t,i){var a=Cn,h=_s.transition;try{_s.transition=null,Cn=1,Yz(e,t,i,a)}finally{_s.transition=h,Cn=a}return null}function Yz(e,t,i,a){do hu();while(Ta!==null);if(pn&6)throw Error(nt(327));i=e.finishedWork;var h=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(nt(177));e.callbackNode=null,e.callbackPriority=0;var g=i.lanes|i.childLanes;if(MD(e,g),e===Or&&(_r=Or=null,qr=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Tp||(Tp=!0,nC(hm,function(){return hu(),null})),g=(i.flags&15990)!==0,i.subtreeFlags&15990||g){g=_s.transition,_s.transition=null;var p=Cn;Cn=1;var c=pn;pn|=4,J0.current=null,Gz(e,i),qT(i,e),yz(a_),fm=!!o_,a_=o_=null,e.current=i,Wz(i),wD(),pn=c,Cn=p,_s.transition=g}else e.current=i;if(Tp&&(Tp=!1,Ta=e,Im=h),g=e.pendingLanes,g===0&&(Da=null),TD(i.stateNode),ji(e,hr()),t!==null)for(a=e.onRecoverableError,i=0;i<t.length;i++)h=t[i],a(h.value,{componentStack:h.stack,digest:h.digest});if(Pm)throw Pm=!1,e=E_,E_=null,e;return Im&1&&e.tag!==0&&hu(),g=e.pendingLanes,g&1?e===P_?gd++:(gd=0,P_=e):gd=0,Ua(),null}function hu(){if(Ta!==null){var e=zk(Im),t=_s.transition,i=Cn;try{if(_s.transition=null,Cn=16>e?16:e,Ta===null)var a=!1;else{if(e=Ta,Ta=null,Im=0,pn&6)throw Error(nt(331));var h=pn;for(pn|=4,It=e.current;It!==null;){var g=It,p=g.child;if(It.flags&16){var c=g.deletions;if(c!==null){for(var S=0;S<c.length;S++){var E=c[S];for(It=E;It!==null;){var P=It;switch(P.tag){case 0:case 11:case 15:pd(8,P,g)}var k=P.child;if(k!==null)k.return=P,It=k;else for(;It!==null;){P=It;var I=P.sibling,G=P.return;if(HT(P),P===E){It=null;break}if(I!==null){I.return=G,It=I;break}It=G}}}var Z=g.alternate;if(Z!==null){var H=Z.child;if(H!==null){Z.child=null;do{var te=H.sibling;H.sibling=null,H=te}while(H!==null)}}It=g}}if(g.subtreeFlags&2064&&p!==null)p.return=g,It=p;else e:for(;It!==null;){if(g=It,g.flags&2048)switch(g.tag){case 0:case 11:case 15:pd(9,g,g.return)}var L=g.sibling;if(L!==null){L.return=g.return,It=L;break e}It=g.return}}var V=e.current;for(It=V;It!==null;){p=It;var W=p.child;if(p.subtreeFlags&2064&&W!==null)W.return=p,It=W;else e:for(p=V;It!==null;){if(c=It,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Ym(9,c)}}catch(pe){ar(c,c.return,pe)}if(c===p){It=null;break e}var re=c.sibling;if(re!==null){re.return=c.return,It=re;break e}It=c.return}}if(pn=h,Ua(),Qs&&typeof Qs.onPostCommitFiberRoot=="function")try{Qs.onPostCommitFiberRoot($m,e)}catch{}a=!0}return a}finally{Cn=i,_s.transition=t}}return!1}function Z1(e,t,i){t=_u(i,t),t=zT(e,t,1),e=Ma(e,t,1),t=bi(),e!==null&&(Kd(e,1,t),ji(e,t))}function ar(e,t,i){if(e.tag===3)Z1(e,e,i);else for(;t!==null;){if(t.tag===3){Z1(t,e,i);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Da===null||!Da.has(a))){e=_u(i,e),e=RT(t,e,1),t=Ma(t,e,1),e=bi(),t!==null&&(Kd(t,1,e),ji(t,e));break}}t=t.return}}function Jz(e,t,i){var a=e.pingCache;a!==null&&a.delete(t),t=bi(),e.pingedLanes|=e.suspendedLanes&i,Or===e&&(qr&i)===i&&(Pr===4||Pr===3&&(qr&130023424)===qr&&500>hr()-ex?Pl(e,0):Q0|=i),ji(e,t)}function eC(e,t){t===0&&(e.mode&1?(t=mp,mp<<=1,!(mp&130023424)&&(mp=4194304)):t=1);var i=bi();e=Do(e,t),e!==null&&(Kd(e,t,i),ji(e,i))}function Qz(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),eC(e,i)}function eR(e,t){var i=0;switch(e.tag){case 13:var a=e.stateNode,h=e.memoizedState;h!==null&&(i=h.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(nt(314))}a!==null&&a.delete(t),eC(e,i)}var tC;tC=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ni.current)Bi=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return Bi=!1,Vz(e,t,i);Bi=!!(e.flags&131072)}else Bi=!1,Hn&&t.flags&1048576&&sT(t,xm,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Yp(e,t),e=t.pendingProps;var h=mu(t,li.current);uu(t,i),h=q0(null,t,a,e,h,i);var g=Z0();return t.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oi(a)?(g=!0,vm(t)):g=!1,t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,U0(t),h.updater=Km,t.stateNode=h,h._reactInternals=t,g_(t,a,e,i),t=__(null,t,a,!0,g,i)):(t.tag=0,Hn&&g&&L0(t),vi(null,t,h,i),t=t.child),t;case 16:a=t.elementType;e:{switch(Yp(e,t),e=t.pendingProps,h=a._init,a=h(a._payload),t.type=a,h=t.tag=nR(a),e=Ms(a,e),h){case 0:t=v_(null,t,a,e,i);break e;case 1:t=N1(null,t,a,e,i);break e;case 11:t=B1(null,t,a,e,i);break e;case 14:t=F1(null,t,a,Ms(a.type,e),i);break e}throw Error(nt(306,a,""))}return t;case 0:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),v_(e,t,a,h,i);case 1:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),N1(e,t,a,h,i);case 3:e:{if(NT(t),e===null)throw Error(nt(387));a=t.pendingProps,g=t.memoizedState,h=g.element,hT(e,t),Sm(t,a,null,i);var p=t.memoizedState;if(a=p.element,g.isDehydrated)if(g={element:a,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){h=_u(Error(nt(423)),t),t=O1(e,t,a,i,h);break e}else if(a!==h){h=_u(Error(nt(424)),t),t=O1(e,t,a,i,h);break e}else for(ts=Aa(t.stateNode.containerInfo.firstChild),ns=t,Hn=!0,zs=null,i=cT(t,null,a,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(gu(),a===h){t=zo(e,t,i);break e}vi(e,t,a,i)}t=t.child}return t;case 5:return dT(t),e===null&&f_(t),a=t.type,h=t.pendingProps,g=e!==null?e.memoizedProps:null,p=h.children,l_(a,h)?p=null:g!==null&&l_(a,g)&&(t.flags|=32),FT(e,t),vi(e,t,p,i),t.child;case 6:return e===null&&f_(t),null;case 13:return OT(e,t,i);case 4:return $0(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=yu(t,null,a,i):vi(e,t,a,i),t.child;case 11:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),B1(e,t,a,h,i);case 7:return vi(e,t,t.pendingProps,i),t.child;case 8:return vi(e,t,t.pendingProps.children,i),t.child;case 12:return vi(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(a=t.type._context,h=t.pendingProps,g=t.memoizedProps,p=h.value,Ln(bm,a._currentValue),a._currentValue=p,g!==null)if(Ns(g.value,p)){if(g.children===h.children&&!Ni.current){t=zo(e,t,i);break e}}else for(g=t.child,g!==null&&(g.return=t);g!==null;){var c=g.dependencies;if(c!==null){p=g.child;for(var S=c.firstContext;S!==null;){if(S.context===a){if(g.tag===1){S=Eo(-1,i&-i),S.tag=2;var E=g.updateQueue;if(E!==null){E=E.shared;var P=E.pending;P===null?S.next=S:(S.next=P.next,P.next=S),E.pending=S}}g.lanes|=i,S=g.alternate,S!==null&&(S.lanes|=i),p_(g.return,i,t),c.lanes|=i;break}S=S.next}}else if(g.tag===10)p=g.type===t.type?null:g.child;else if(g.tag===18){if(p=g.return,p===null)throw Error(nt(341));p.lanes|=i,c=p.alternate,c!==null&&(c.lanes|=i),p_(p,i,t),p=g.sibling}else p=g.child;if(p!==null)p.return=g;else for(p=g;p!==null;){if(p===t){p=null;break}if(g=p.sibling,g!==null){g.return=p.return,p=g;break}p=p.return}g=p}vi(e,t,h.children,i),t=t.child}return t;case 9:return h=t.type,a=t.pendingProps.children,uu(t,i),h=bs(h),a=a(h),t.flags|=1,vi(e,t,a,i),t.child;case 14:return a=t.type,h=Ms(a,t.pendingProps),h=Ms(a.type,h),F1(e,t,a,h,i);case 15:return LT(e,t,t.type,t.pendingProps,i);case 17:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),Yp(e,t),t.tag=1,Oi(a)?(e=!0,vm(t)):e=!1,uu(t,i),DT(t,a,h),g_(t,a,h,i),__(null,t,a,!0,e,i);case 19:return jT(e,t,i);case 22:return BT(e,t,i)}throw Error(nt(156,t.tag))};function nC(e,t){return Ik(e,t)}function tR(e,t,i,a){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ys(e,t,i,a){return new tR(e,t,i,a)}function ix(e){return e=e.prototype,!(!e||!e.isReactComponent)}function nR(e){if(typeof e=="function")return ix(e)?1:0;if(e!=null){if(e=e.$$typeof,e===S0)return 11;if(e===k0)return 14}return 2}function Ra(e,t){var i=e.alternate;return i===null?(i=ys(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function em(e,t,i,a,h,g){var p=2;if(a=e,typeof e=="function")ix(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case Gc:return Il(i.children,h,g,t);case w0:p=8,h|=8;break;case jv:return e=ys(12,i,t,h|2),e.elementType=jv,e.lanes=g,e;case Vv:return e=ys(13,i,t,h),e.elementType=Vv,e.lanes=g,e;case Uv:return e=ys(19,i,t,h),e.elementType=Uv,e.lanes=g,e;case dk:return Qm(i,h,g,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case uk:p=10;break e;case hk:p=9;break e;case S0:p=11;break e;case k0:p=14;break e;case xa:p=16,a=null;break e}throw Error(nt(130,e==null?e:typeof e,""))}return t=ys(p,i,t,h),t.elementType=e,t.type=a,t.lanes=g,t}function Il(e,t,i,a){return e=ys(7,e,a,t),e.lanes=i,e}function Qm(e,t,i,a){return e=ys(22,e,a,t),e.elementType=dk,e.lanes=i,e.stateNode={isHidden:!1},e}function sv(e,t,i){return e=ys(6,e,null,t),e.lanes=i,e}function ov(e,t,i){return t=ys(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function rR(e,t,i,a,h){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jy(0),this.expirationTimes=jy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jy(0),this.identifierPrefix=a,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function sx(e,t,i,a,h,g,p,c,S){return e=new rR(e,t,i,c,S),t===1?(t=1,g===!0&&(t|=8)):t=0,g=ys(3,null,null,t),e.current=g,g.stateNode=e,g.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},U0(g),e}function iR(e,t,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hc,key:a==null?null:""+a,children:e,containerInfo:t,implementation:i}}function rC(e){if(!e)return Ba;e=e._reactInternals;e:{if(Vl(e)!==e||e.tag!==1)throw Error(nt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(nt(171))}if(e.tag===1){var i=e.type;if(Oi(i))return rT(e,i,t)}return t}function iC(e,t,i,a,h,g,p,c,S){return e=sx(i,a,!0,e,h,g,p,c,S),e.context=rC(null),i=e.current,a=bi(),h=za(i),g=Eo(a,h),g.callback=t??null,Ma(i,g,h),e.current.lanes=h,Kd(e,h,a),ji(e,a),e}function eg(e,t,i,a){var h=t.current,g=bi(),p=za(h);return i=rC(i),t.context===null?t.context=i:t.pendingContext=i,t=Eo(g,p),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=Ma(h,t,p),e!==null&&(Bs(e,h,p,g),Zp(e,h,p)),p}function Mm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function X1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function ox(e,t){X1(e,t),(e=e.alternate)&&X1(e,t)}function sR(){return null}var sC=typeof reportError=="function"?reportError:function(e){console.error(e)};function ax(e){this._internalRoot=e}tg.prototype.render=ax.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(nt(409));eg(e,t,null,null)};tg.prototype.unmount=ax.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ll(function(){eg(null,e,null,null)}),t[Mo]=null}};function tg(e){this._internalRoot=e}tg.prototype.unstable_scheduleHydration=function(e){if(e){var t=Bk();e={blockedOn:null,target:e,priority:t};for(var i=0;i<wa.length&&t!==0&&t<wa[i].priority;i++);wa.splice(i,0,e),i===0&&Nk(e)}};function lx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ng(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function K1(){}function oR(e,t,i,a,h){if(h){if(typeof a=="function"){var g=a;a=function(){var E=Mm(p);g.call(E)}}var p=iC(t,a,e,0,null,!1,!1,"",K1);return e._reactRootContainer=p,e[Mo]=p.current,Md(e.nodeType===8?e.parentNode:e),Ll(),p}for(;h=e.lastChild;)e.removeChild(h);if(typeof a=="function"){var c=a;a=function(){var E=Mm(S);c.call(E)}}var S=sx(e,0,!1,null,null,!1,!1,"",K1);return e._reactRootContainer=S,e[Mo]=S.current,Md(e.nodeType===8?e.parentNode:e),Ll(function(){eg(t,S,i,a)}),S}function rg(e,t,i,a,h){var g=i._reactRootContainer;if(g){var p=g;if(typeof h=="function"){var c=h;h=function(){var S=Mm(p);c.call(S)}}eg(t,p,e,h)}else p=oR(i,t,e,h,a);return Mm(p)}Rk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=rd(t.pendingLanes);i!==0&&(E0(t,i|1),ji(t,hr()),!(pn&6)&&(xu=hr()+500,Ua()))}break;case 13:Ll(function(){var a=Do(e,1);if(a!==null){var h=bi();Bs(a,e,1,h)}}),ox(e,1)}};P0=function(e){if(e.tag===13){var t=Do(e,134217728);if(t!==null){var i=bi();Bs(t,e,134217728,i)}ox(e,134217728)}};Lk=function(e){if(e.tag===13){var t=za(e),i=Do(e,t);if(i!==null){var a=bi();Bs(i,e,t,a)}ox(e,t)}};Bk=function(){return Cn};Fk=function(e,t){var i=Cn;try{return Cn=e,t()}finally{Cn=i}};Jv=function(e,t,i){switch(t){case"input":if(Gv(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var a=i[t];if(a!==e&&a.form===e.form){var h=qm(a);if(!h)throw Error(nt(90));pk(a),Gv(a,h)}}}break;case"textarea":gk(e,i);break;case"select":t=i.value,t!=null&&ou(e,!!i.multiple,t,!1)}};Sk=tx;kk=Ll;var aR={usingClientEntryPoint:!1,Events:[Jd,Xc,qm,bk,wk,tx]},Xh={findFiberByHostInstance:Sl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lR={bundleType:Xh.bundleType,version:Xh.version,rendererPackageName:Xh.rendererPackageName,rendererConfig:Xh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ek(e),e===null?null:e.stateNode},findFiberByHostInstance:Xh.findFiberByHostInstance||sR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cp.isDisabled&&Cp.supportsFiber)try{$m=Cp.inject(lR),Qs=Cp}catch{}}ss.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aR;ss.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lx(t))throw Error(nt(200));return iR(e,t,null,i)};ss.createRoot=function(e,t){if(!lx(e))throw Error(nt(299));var i=!1,a="",h=sC;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=sx(e,1,!1,null,null,i,!1,a,h),e[Mo]=t.current,Md(e.nodeType===8?e.parentNode:e),new ax(t)};ss.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(nt(188)):(e=Object.keys(e).join(","),Error(nt(268,e)));return e=Ek(t),e=e===null?null:e.stateNode,e};ss.flushSync=function(e){return Ll(e)};ss.hydrate=function(e,t,i){if(!ng(t))throw Error(nt(200));return rg(null,e,t,!0,i)};ss.hydrateRoot=function(e,t,i){if(!lx(e))throw Error(nt(405));var a=i!=null&&i.hydratedSources||null,h=!1,g="",p=sC;if(i!=null&&(i.unstable_strictMode===!0&&(h=!0),i.identifierPrefix!==void 0&&(g=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),t=iC(t,null,e,1,i??null,h,!1,g,p),e[Mo]=t.current,Md(e),a)for(e=0;e<a.length;e++)i=a[e],h=i._getVersion,h=h(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,h]:t.mutableSourceEagerHydrationData.push(i,h);return new tg(t)};ss.render=function(e,t,i){if(!ng(t))throw Error(nt(200));return rg(null,e,t,!1,i)};ss.unmountComponentAtNode=function(e){if(!ng(e))throw Error(nt(40));return e._reactRootContainer?(Ll(function(){rg(null,null,e,!1,function(){e._reactRootContainer=null,e[Mo]=null})}),!0):!1};ss.unstable_batchedUpdates=tx;ss.unstable_renderSubtreeIntoContainer=function(e,t,i,a){if(!ng(i))throw Error(nt(200));if(e==null||e._reactInternals===void 0)throw Error(nt(38));return rg(e,t,i,!1,a)};ss.version="18.3.1-next-f1338f8080-20240426";function oC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oC)}catch(e){console.error(e)}}oC(),ok.exports=ss;var cx=ok.exports;const aC=p0(cx);var lC,Y1=cx;lC=Y1.createRoot,Y1.hydrateRoot;const ux=$.createContext({});function hx(e){const t=$.useRef(null);return t.current===null&&(t.current=e()),t.current}const dx=typeof window<"u",cC=dx?$.useLayoutEffect:$.useEffect,ig=$.createContext(null);function fx(e,t){e.indexOf(t)===-1&&e.push(t)}function px(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}const no=(e,t,i)=>i>t?t:i<e?e:i;let mx=()=>{};const Ro={},uC=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function hC(e){return typeof e=="object"&&e!==null}const dC=e=>/^0[^.\s]+$/u.test(e);function gx(e){let t;return()=>(t===void 0&&(t=e()),t)}const xs=e=>e,cR=(e,t)=>i=>t(e(i)),ef=(...e)=>e.reduce(cR),jd=(e,t,i)=>{const a=t-e;return a===0?1:(i-e)/a};class yx{constructor(){this.subscriptions=[]}add(t){return fx(this.subscriptions,t),()=>px(this.subscriptions,t)}notify(t,i,a){const h=this.subscriptions.length;if(h)if(h===1)this.subscriptions[0](t,i,a);else for(let g=0;g<h;g++){const p=this.subscriptions[g];p&&p(t,i,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Po=e=>e*1e3,vs=e=>e/1e3;function fC(e,t){return t?e*(1e3/t):0}const pC=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,uR=1e-7,hR=12;function dR(e,t,i,a,h){let g,p,c=0;do p=t+(i-t)/2,g=pC(p,a,h)-e,g>0?i=p:t=p;while(Math.abs(g)>uR&&++c<hR);return p}function tf(e,t,i,a){if(e===t&&i===a)return xs;const h=g=>dR(g,0,1,e,i);return g=>g===0||g===1?g:pC(h(g),t,a)}const mC=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,gC=e=>t=>1-e(1-t),yC=tf(.33,1.53,.69,.99),vx=gC(yC),vC=mC(vx),_C=e=>(e*=2)<1?.5*vx(e):.5*(2-Math.pow(2,-10*(e-1))),_x=e=>1-Math.sin(Math.acos(e)),xC=gC(_x),bC=mC(_x),fR=tf(.42,0,1,1),pR=tf(0,0,.58,1),wC=tf(.42,0,.58,1),mR=e=>Array.isArray(e)&&typeof e[0]!="number",SC=e=>Array.isArray(e)&&typeof e[0]=="number",gR={linear:xs,easeIn:fR,easeInOut:wC,easeOut:pR,circIn:_x,circInOut:bC,circOut:xC,backIn:vx,backInOut:vC,backOut:yC,anticipate:_C},yR=e=>typeof e=="string",J1=e=>{if(SC(e)){mx(e.length===4);const[t,i,a,h]=e;return tf(t,i,a,h)}else if(yR(e))return gR[e];return e},Ep=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function vR(e,t){let i=new Set,a=new Set,h=!1,g=!1;const p=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function S(P){p.has(P)&&(E.schedule(P),e()),P(c)}const E={schedule:(P,k=!1,I=!1)=>{const Z=I&&h?i:a;return k&&p.add(P),Z.has(P)||Z.add(P),P},cancel:P=>{a.delete(P),p.delete(P)},process:P=>{if(c=P,h){g=!0;return}h=!0,[i,a]=[a,i],i.forEach(S),i.clear(),h=!1,g&&(g=!1,E.process(P))}};return E}const _R=40;function kC(e,t){let i=!1,a=!0;const h={delta:0,timestamp:0,isProcessing:!1},g=()=>i=!0,p=Ep.reduce((W,re)=>(W[re]=vR(g),W),{}),{setup:c,read:S,resolveKeyframes:E,preUpdate:P,update:k,preRender:I,render:G,postRender:Z}=p,H=()=>{const W=Ro.useManualTiming?h.timestamp:performance.now();i=!1,Ro.useManualTiming||(h.delta=a?1e3/60:Math.max(Math.min(W-h.timestamp,_R),1)),h.timestamp=W,h.isProcessing=!0,c.process(h),S.process(h),E.process(h),P.process(h),k.process(h),I.process(h),G.process(h),Z.process(h),h.isProcessing=!1,i&&t&&(a=!1,e(H))},te=()=>{i=!0,a=!0,h.isProcessing||e(H)};return{schedule:Ep.reduce((W,re)=>{const pe=p[re];return W[re]=(_e,le=!1,ce=!1)=>(i||te(),pe.schedule(_e,le,ce)),W},{}),cancel:W=>{for(let re=0;re<Ep.length;re++)p[Ep[re]].cancel(W)},state:h,steps:p}}const{schedule:jn,cancel:Fa,state:Wr,steps:av}=kC(typeof requestAnimationFrame<"u"?requestAnimationFrame:xs,!0);let tm;function xR(){tm=void 0}const _i={now:()=>(tm===void 0&&_i.set(Wr.isProcessing||Ro.useManualTiming?Wr.timestamp:performance.now()),tm),set:e=>{tm=e,queueMicrotask(xR)}},TC=e=>t=>typeof t=="string"&&t.startsWith(e),CC=TC("--"),bR=TC("var(--"),xx=e=>bR(e)?wR.test(e.split("/*")[0].trim()):!1,wR=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Q1(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const Pu={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Vd={...Pu,transform:e=>no(0,1,e)},Pp={...Pu,default:1},yd=e=>Math.round(e*1e5)/1e5,bx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function SR(e){return e==null}const kR=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,wx=(e,t)=>i=>!!(typeof i=="string"&&kR.test(i)&&i.startsWith(e)||t&&!SR(i)&&Object.prototype.hasOwnProperty.call(i,t)),EC=(e,t,i)=>a=>{if(typeof a!="string")return a;const[h,g,p,c]=a.match(bx);return{[e]:parseFloat(h),[t]:parseFloat(g),[i]:parseFloat(p),alpha:c!==void 0?parseFloat(c):1}},TR=e=>no(0,255,e),lv={...Pu,transform:e=>Math.round(TR(e))},Cl={test:wx("rgb","red"),parse:EC("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:a=1})=>"rgba("+lv.transform(e)+", "+lv.transform(t)+", "+lv.transform(i)+", "+yd(Vd.transform(a))+")"};function CR(e){let t="",i="",a="",h="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),a=e.substring(5,7),h=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),a=e.substring(3,4),h=e.substring(4,5),t+=t,i+=i,a+=a,h+=h),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(a,16),alpha:h?parseInt(h,16)/255:1}}const M_={test:wx("#"),parse:CR,transform:Cl.transform},nf=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),va=nf("deg"),to=nf("%"),Et=nf("px"),ER=nf("vh"),PR=nf("vw"),e2={...to,parse:e=>to.parse(e)/100,transform:e=>to.transform(e*100)},nu={test:wx("hsl","hue"),parse:EC("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:a=1})=>"hsla("+Math.round(e)+", "+to.transform(yd(t))+", "+to.transform(yd(i))+", "+yd(Vd.transform(a))+")"},vr={test:e=>Cl.test(e)||M_.test(e)||nu.test(e),parse:e=>Cl.test(e)?Cl.parse(e):nu.test(e)?nu.parse(e):M_.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Cl.transform(e):nu.transform(e),getAnimatableNone:e=>{const t=vr.parse(e);return t.alpha=0,vr.transform(t)}},IR=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function AR(e){var t,i;return isNaN(e)&&typeof e=="string"&&(((t=e.match(bx))==null?void 0:t.length)||0)+(((i=e.match(IR))==null?void 0:i.length)||0)>0}const PC="number",IC="color",MR="var",DR="var(",t2="${}",zR=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ud(e){const t=e.toString(),i=[],a={color:[],number:[],var:[]},h=[];let g=0;const c=t.replace(zR,S=>(vr.test(S)?(a.color.push(g),h.push(IC),i.push(vr.parse(S))):S.startsWith(DR)?(a.var.push(g),h.push(MR),i.push(S)):(a.number.push(g),h.push(PC),i.push(parseFloat(S))),++g,t2)).split(t2);return{values:i,split:c,indexes:a,types:h}}function AC(e){return Ud(e).values}function MC(e){const{split:t,types:i}=Ud(e),a=t.length;return h=>{let g="";for(let p=0;p<a;p++)if(g+=t[p],h[p]!==void 0){const c=i[p];c===PC?g+=yd(h[p]):c===IC?g+=vr.transform(h[p]):g+=h[p]}return g}}const RR=e=>typeof e=="number"?0:vr.test(e)?vr.getAnimatableNone(e):e;function LR(e){const t=AC(e);return MC(e)(t.map(RR))}const Na={test:AR,parse:AC,createTransformer:MC,getAnimatableNone:LR};function cv(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function BR({hue:e,saturation:t,lightness:i,alpha:a}){e/=360,t/=100,i/=100;let h=0,g=0,p=0;if(!t)h=g=p=i;else{const c=i<.5?i*(1+t):i+t-i*t,S=2*i-c;h=cv(S,c,e+1/3),g=cv(S,c,e),p=cv(S,c,e-1/3)}return{red:Math.round(h*255),green:Math.round(g*255),blue:Math.round(p*255),alpha:a}}function Dm(e,t){return i=>i>0?t:e}const Kn=(e,t,i)=>e+(t-e)*i,uv=(e,t,i)=>{const a=e*e,h=i*(t*t-a)+a;return h<0?0:Math.sqrt(h)},FR=[M_,Cl,nu],NR=e=>FR.find(t=>t.test(e));function n2(e){const t=NR(e);if(!t)return!1;let i=t.parse(e);return t===nu&&(i=BR(i)),i}const r2=(e,t)=>{const i=n2(e),a=n2(t);if(!i||!a)return Dm(e,t);const h={...i};return g=>(h.red=uv(i.red,a.red,g),h.green=uv(i.green,a.green,g),h.blue=uv(i.blue,a.blue,g),h.alpha=Kn(i.alpha,a.alpha,g),Cl.transform(h))},D_=new Set(["none","hidden"]);function OR(e,t){return D_.has(e)?i=>i<=0?e:t:i=>i>=1?t:e}function jR(e,t){return i=>Kn(e,t,i)}function Sx(e){return typeof e=="number"?jR:typeof e=="string"?xx(e)?Dm:vr.test(e)?r2:$R:Array.isArray(e)?DC:typeof e=="object"?vr.test(e)?r2:VR:Dm}function DC(e,t){const i=[...e],a=i.length,h=e.map((g,p)=>Sx(g)(g,t[p]));return g=>{for(let p=0;p<a;p++)i[p]=h[p](g);return i}}function VR(e,t){const i={...e,...t},a={};for(const h in i)e[h]!==void 0&&t[h]!==void 0&&(a[h]=Sx(e[h])(e[h],t[h]));return h=>{for(const g in a)i[g]=a[g](h);return i}}function UR(e,t){const i=[],a={color:0,var:0,number:0};for(let h=0;h<t.values.length;h++){const g=t.types[h],p=e.indexes[g][a[g]],c=e.values[p]??0;i[h]=c,a[g]++}return i}const $R=(e,t)=>{const i=Na.createTransformer(t),a=Ud(e),h=Ud(t);return a.indexes.var.length===h.indexes.var.length&&a.indexes.color.length===h.indexes.color.length&&a.indexes.number.length>=h.indexes.number.length?D_.has(e)&&!h.values.length||D_.has(t)&&!a.values.length?OR(e,t):ef(DC(UR(a,h),h.values),i):Dm(e,t)};function zC(e,t,i){return typeof e=="number"&&typeof t=="number"&&typeof i=="number"?Kn(e,t,i):Sx(e)(e,t)}const HR=e=>{const t=({timestamp:i})=>e(i);return{start:(i=!0)=>jn.update(t,i),stop:()=>Fa(t),now:()=>Wr.isProcessing?Wr.timestamp:_i.now()}},RC=(e,t,i=10)=>{let a="";const h=Math.max(Math.round(t/i),2);for(let g=0;g<h;g++)a+=Math.round(e(g/(h-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},zm=2e4;function kx(e){let t=0;const i=50;let a=e.next(t);for(;!a.done&&t<zm;)t+=i,a=e.next(t);return t>=zm?1/0:t}function GR(e,t=100,i){const a=i({...e,keyframes:[0,t]}),h=Math.min(kx(a),zm);return{type:"keyframes",ease:g=>a.next(h*g).value/t,duration:vs(h)}}const WR=5;function LC(e,t,i){const a=Math.max(t-WR,0);return fC(i-e(a),t-a)}const or={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},hv=.001;function qR({duration:e=or.duration,bounce:t=or.bounce,velocity:i=or.velocity,mass:a=or.mass}){let h,g,p=1-t;p=no(or.minDamping,or.maxDamping,p),e=no(or.minDuration,or.maxDuration,vs(e)),p<1?(h=E=>{const P=E*p,k=P*e,I=P-i,G=z_(E,p),Z=Math.exp(-k);return hv-I/G*Z},g=E=>{const k=E*p*e,I=k*i+i,G=Math.pow(p,2)*Math.pow(E,2)*e,Z=Math.exp(-k),H=z_(Math.pow(E,2),p);return(-h(E)+hv>0?-1:1)*((I-G)*Z)/H}):(h=E=>{const P=Math.exp(-E*e),k=(E-i)*e+1;return-hv+P*k},g=E=>{const P=Math.exp(-E*e),k=(i-E)*(e*e);return P*k});const c=5/e,S=XR(h,g,c);if(e=Po(e),isNaN(S))return{stiffness:or.stiffness,damping:or.damping,duration:e};{const E=Math.pow(S,2)*a;return{stiffness:E,damping:p*2*Math.sqrt(a*E),duration:e}}}const ZR=12;function XR(e,t,i){let a=i;for(let h=1;h<ZR;h++)a=a-e(a)/t(a);return a}function z_(e,t){return e*Math.sqrt(1-t*t)}const KR=["duration","bounce"],YR=["stiffness","damping","mass"];function i2(e,t){return t.some(i=>e[i]!==void 0)}function JR(e){let t={velocity:or.velocity,stiffness:or.stiffness,damping:or.damping,mass:or.mass,isResolvedFromDuration:!1,...e};if(!i2(e,YR)&&i2(e,KR))if(e.visualDuration){const i=e.visualDuration,a=2*Math.PI/(i*1.2),h=a*a,g=2*no(.05,1,1-(e.bounce||0))*Math.sqrt(h);t={...t,mass:or.mass,stiffness:h,damping:g}}else{const i=qR(e);t={...t,...i,mass:or.mass},t.isResolvedFromDuration=!0}return t}function Rm(e=or.visualDuration,t=or.bounce){const i=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:h}=i;const g=i.keyframes[0],p=i.keyframes[i.keyframes.length-1],c={done:!1,value:g},{stiffness:S,damping:E,mass:P,duration:k,velocity:I,isResolvedFromDuration:G}=JR({...i,velocity:-vs(i.velocity||0)}),Z=I||0,H=E/(2*Math.sqrt(S*P)),te=p-g,L=vs(Math.sqrt(S/P)),V=Math.abs(te)<5;a||(a=V?or.restSpeed.granular:or.restSpeed.default),h||(h=V?or.restDelta.granular:or.restDelta.default);let W;if(H<1){const pe=z_(L,H);W=_e=>{const le=Math.exp(-H*L*_e);return p-le*((Z+H*L*te)/pe*Math.sin(pe*_e)+te*Math.cos(pe*_e))}}else if(H===1)W=pe=>p-Math.exp(-L*pe)*(te+(Z+L*te)*pe);else{const pe=L*Math.sqrt(H*H-1);W=_e=>{const le=Math.exp(-H*L*_e),ce=Math.min(pe*_e,300);return p-le*((Z+H*L*te)*Math.sinh(ce)+pe*te*Math.cosh(ce))/pe}}const re={calculatedDuration:G&&k||null,next:pe=>{const _e=W(pe);if(G)c.done=pe>=k;else{let le=pe===0?Z:0;H<1&&(le=pe===0?Po(Z):LC(W,pe,_e));const ce=Math.abs(le)<=a,De=Math.abs(p-_e)<=h;c.done=ce&&De}return c.value=c.done?p:_e,c},toString:()=>{const pe=Math.min(kx(re),zm),_e=RC(le=>re.next(pe*le).value,pe,30);return pe+"ms "+_e},toTransition:()=>{}};return re}Rm.applyToOptions=e=>{const t=GR(e,100,Rm);return e.ease=t.ease,e.duration=Po(t.duration),e.type="keyframes",e};function R_({keyframes:e,velocity:t=0,power:i=.8,timeConstant:a=325,bounceDamping:h=10,bounceStiffness:g=500,modifyTarget:p,min:c,max:S,restDelta:E=.5,restSpeed:P}){const k=e[0],I={done:!1,value:k},G=ce=>c!==void 0&&ce<c||S!==void 0&&ce>S,Z=ce=>c===void 0?S:S===void 0||Math.abs(c-ce)<Math.abs(S-ce)?c:S;let H=i*t;const te=k+H,L=p===void 0?te:p(te);L!==te&&(H=L-k);const V=ce=>-H*Math.exp(-ce/a),W=ce=>L+V(ce),re=ce=>{const De=V(ce),Be=W(ce);I.done=Math.abs(De)<=E,I.value=I.done?L:Be};let pe,_e;const le=ce=>{G(I.value)&&(pe=ce,_e=Rm({keyframes:[I.value,Z(I.value)],velocity:LC(W,ce,I.value),damping:h,stiffness:g,restDelta:E,restSpeed:P}))};return le(0),{calculatedDuration:null,next:ce=>{let De=!1;return!_e&&pe===void 0&&(De=!0,re(ce),le(ce)),pe!==void 0&&ce>=pe?_e.next(ce-pe):(!De&&re(ce),I)}}}function QR(e,t,i){const a=[],h=i||Ro.mix||zC,g=e.length-1;for(let p=0;p<g;p++){let c=h(e[p],e[p+1]);if(t){const S=Array.isArray(t)?t[p]||xs:t;c=ef(S,c)}a.push(c)}return a}function eL(e,t,{clamp:i=!0,ease:a,mixer:h}={}){const g=e.length;if(mx(g===t.length),g===1)return()=>t[0];if(g===2&&t[0]===t[1])return()=>t[1];const p=e[0]===e[1];e[0]>e[g-1]&&(e=[...e].reverse(),t=[...t].reverse());const c=QR(t,a,h),S=c.length,E=P=>{if(p&&P<e[0])return t[0];let k=0;if(S>1)for(;k<e.length-2&&!(P<e[k+1]);k++);const I=jd(e[k],e[k+1],P);return c[k](I)};return i?P=>E(no(e[0],e[g-1],P)):E}function tL(e,t){const i=e[e.length-1];for(let a=1;a<=t;a++){const h=jd(0,t,a);e.push(Kn(i,1,h))}}function nL(e){const t=[0];return tL(t,e.length-1),t}function rL(e,t){return e.map(i=>i*t)}function iL(e,t){return e.map(()=>t||wC).splice(0,e.length-1)}function vd({duration:e=300,keyframes:t,times:i,ease:a="easeInOut"}){const h=mR(a)?a.map(J1):J1(a),g={done:!1,value:t[0]},p=rL(i&&i.length===t.length?i:nL(t),e),c=eL(p,t,{ease:Array.isArray(h)?h:iL(t,h)});return{calculatedDuration:e,next:S=>(g.value=c(S),g.done=S>=e,g)}}const sL=e=>e!==null;function Tx(e,{repeat:t,repeatType:i="loop"},a,h=1){const g=e.filter(sL),c=h<0||t&&i!=="loop"&&t%2===1?0:g.length-1;return!c||a===void 0?g[c]:a}const oL={decay:R_,inertia:R_,tween:vd,keyframes:vd,spring:Rm};function BC(e){typeof e.type=="string"&&(e.type=oL[e.type])}class Cx{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,i){return this.finished.then(t,i)}}const aL=e=>e/100;class Ex extends Cx{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,h;const{motionValue:i}=this.options;i&&i.updatedAt!==_i.now()&&this.tick(_i.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(h=(a=this.options).onStop)==null||h.call(a))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;BC(t);const{type:i=vd,repeat:a=0,repeatDelay:h=0,repeatType:g,velocity:p=0}=t;let{keyframes:c}=t;const S=i||vd;S!==vd&&typeof c[0]!="number"&&(this.mixKeyframes=ef(aL,zC(c[0],c[1])),c=[0,100]);const E=S({...t,keyframes:c});g==="mirror"&&(this.mirroredGenerator=S({...t,keyframes:[...c].reverse(),velocity:-p})),E.calculatedDuration===null&&(E.calculatedDuration=kx(E));const{calculatedDuration:P}=E;this.calculatedDuration=P,this.resolvedDuration=P+h,this.totalDuration=this.resolvedDuration*(a+1)-h,this.generator=E}updateTime(t){const i=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=i}tick(t,i=!1){const{generator:a,totalDuration:h,mixKeyframes:g,mirroredGenerator:p,resolvedDuration:c,calculatedDuration:S}=this;if(this.startTime===null)return a.next(0);const{delay:E=0,keyframes:P,repeat:k,repeatType:I,repeatDelay:G,type:Z,onUpdate:H,finalKeyframe:te}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-h/this.speed,this.startTime)),i?this.currentTime=t:this.updateTime(t);const L=this.currentTime-E*(this.playbackSpeed>=0?1:-1),V=this.playbackSpeed>=0?L<0:L>h;this.currentTime=Math.max(L,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let W=this.currentTime,re=a;if(k){const ce=Math.min(this.currentTime,h)/c;let De=Math.floor(ce),Be=ce%1;!Be&&ce>=1&&(Be=1),Be===1&&De--,De=Math.min(De,k+1),!!(De%2)&&(I==="reverse"?(Be=1-Be,G&&(Be-=G/c)):I==="mirror"&&(re=p)),W=no(0,1,Be)*c}const pe=V?{done:!1,value:P[0]}:re.next(W);g&&(pe.value=g(pe.value));let{done:_e}=pe;!V&&S!==null&&(_e=this.playbackSpeed>=0?this.currentTime>=h:this.currentTime<=0);const le=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&_e);return le&&Z!==R_&&(pe.value=Tx(P,this.options,te,this.speed)),H&&H(pe.value),le&&this.finish(),pe}then(t,i){return this.finished.then(t,i)}get duration(){return vs(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+vs(t)}get time(){return vs(this.currentTime)}set time(t){var i;t=Po(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(i=this.driver)==null||i.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(_i.now());const i=this.playbackSpeed!==t;this.playbackSpeed=t,i&&(this.time=vs(this.currentTime))}play(){var h,g;if(this.isStopped)return;const{driver:t=HR,startTime:i}=this.options;this.driver||(this.driver=t(p=>this.tick(p))),(g=(h=this.options).onPlay)==null||g.call(h);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=i??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(_i.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,i;this.notifyFinished(),this.teardown(),this.state="finished",(i=(t=this.options).onComplete)==null||i.call(t)}cancel(){var t,i;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(i=(t=this.options).onCancel)==null||i.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var i;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(i=this.driver)==null||i.stop(),t.observe(this)}}function lL(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const El=e=>e*180/Math.PI,L_=e=>{const t=El(Math.atan2(e[1],e[0]));return B_(t)},cL={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:L_,rotateZ:L_,skewX:e=>El(Math.atan(e[1])),skewY:e=>El(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},B_=e=>(e=e%360,e<0&&(e+=360),e),s2=L_,o2=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),a2=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),uL={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:o2,scaleY:a2,scale:e=>(o2(e)+a2(e))/2,rotateX:e=>B_(El(Math.atan2(e[6],e[5]))),rotateY:e=>B_(El(Math.atan2(-e[2],e[0]))),rotateZ:s2,rotate:s2,skewX:e=>El(Math.atan(e[4])),skewY:e=>El(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function F_(e){return e.includes("scale")?1:0}function N_(e,t){if(!e||e==="none")return F_(t);const i=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,h;if(i)a=uL,h=i;else{const c=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=cL,h=c}if(!h)return F_(t);const g=a[t],p=h[1].split(",").map(dL);return typeof g=="function"?g(p):p[g]}const hL=(e,t)=>{const{transform:i="none"}=getComputedStyle(e);return N_(i,t)};function dL(e){return parseFloat(e.trim())}const Iu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Au=new Set(Iu),l2=e=>e===Pu||e===Et,fL=new Set(["x","y","z"]),pL=Iu.filter(e=>!fL.has(e));function mL(e){const t=[];return pL.forEach(i=>{const a=e.getValue(i);a!==void 0&&(t.push([i,a.get()]),a.set(i.startsWith("scale")?1:0))}),t}const Ca={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>N_(t,"x"),y:(e,{transform:t})=>N_(t,"y")};Ca.translateX=Ca.x;Ca.translateY=Ca.y;const Al=new Set;let O_=!1,j_=!1,V_=!1;function FC(){if(j_){const e=Array.from(Al).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),i=new Map;t.forEach(a=>{const h=mL(a);h.length&&(i.set(a,h),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const h=i.get(a);h&&h.forEach(([g,p])=>{var c;(c=a.getValue(g))==null||c.set(p)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}j_=!1,O_=!1,Al.forEach(e=>e.complete(V_)),Al.clear()}function NC(){Al.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(j_=!0)})}function gL(){V_=!0,NC(),FC(),V_=!1}class Px{constructor(t,i,a,h,g,p=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=i,this.name=a,this.motionValue=h,this.element=g,this.isAsync=p}scheduleResolve(){this.state="scheduled",this.isAsync?(Al.add(this),O_||(O_=!0,jn.read(NC),jn.resolveKeyframes(FC))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:i,element:a,motionValue:h}=this;if(t[0]===null){const g=h==null?void 0:h.get(),p=t[t.length-1];if(g!==void 0)t[0]=g;else if(a&&i){const c=a.readValue(i,p);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=p),h&&g===void 0&&h.set(t[0])}lL(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Al.delete(this)}cancel(){this.state==="scheduled"&&(Al.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const yL=e=>e.startsWith("--");function vL(e,t,i){yL(t)?e.style.setProperty(t,i):e.style[t]=i}const _L=gx(()=>window.ScrollTimeline!==void 0),xL={};function bL(e,t){const i=gx(e);return()=>xL[t]??i()}const OC=bL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),sd=([e,t,i,a])=>`cubic-bezier(${e}, ${t}, ${i}, ${a})`,c2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:sd([0,.65,.55,1]),circOut:sd([.55,0,1,.45]),backIn:sd([.31,.01,.66,-.59]),backOut:sd([.33,1.53,.69,.99])};function jC(e,t){if(e)return typeof e=="function"?OC()?RC(e,t):"ease-out":SC(e)?sd(e):Array.isArray(e)?e.map(i=>jC(i,t)||c2.easeOut):c2[e]}function wL(e,t,i,{delay:a=0,duration:h=300,repeat:g=0,repeatType:p="loop",ease:c="easeOut",times:S}={},E=void 0){const P={[t]:i};S&&(P.offset=S);const k=jC(c,h);Array.isArray(k)&&(P.easing=k);const I={delay:a,duration:h,easing:Array.isArray(k)?"linear":k,fill:"both",iterations:g+1,direction:p==="reverse"?"alternate":"normal"};return E&&(I.pseudoElement=E),e.animate(P,I)}function VC(e){return typeof e=="function"&&"applyToOptions"in e}function SL({type:e,...t}){return VC(e)&&OC()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class kL extends Cx{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:i,name:a,keyframes:h,pseudoElement:g,allowFlatten:p=!1,finalKeyframe:c,onComplete:S}=t;this.isPseudoElement=!!g,this.allowFlatten=p,this.options=t,mx(typeof t.type!="string");const E=SL(t);this.animation=wL(i,a,h,E,g),E.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!g){const P=Tx(h,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(P):vL(i,a,P),this.animation.cancel()}S==null||S(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,i;(i=(t=this.animation).finish)==null||i.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,i;this.isPseudoElement||(i=(t=this.animation).commitStyles)==null||i.call(t)}get duration(){var i,a;const t=((a=(i=this.animation.effect)==null?void 0:i.getComputedTiming)==null?void 0:a.call(i).duration)||0;return vs(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+vs(t)}get time(){return vs(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Po(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:i}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&_L()?(this.animation.timeline=t,xs):i(this)}}const UC={anticipate:_C,backInOut:vC,circInOut:bC};function TL(e){return e in UC}function CL(e){typeof e.ease=="string"&&TL(e.ease)&&(e.ease=UC[e.ease])}const dv=10;class EL extends kL{constructor(t){CL(t),BC(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:i,onUpdate:a,onComplete:h,element:g,...p}=this.options;if(!i)return;if(t!==void 0){i.set(t);return}const c=new Ex({...p,autoplay:!1}),S=Math.max(dv,_i.now()-this.startTime),E=no(0,dv,S-dv);i.setWithVelocity(c.sample(Math.max(0,S-E)).value,c.sample(S).value,E),c.stop()}}const u2=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Na.test(e)||e==="0")&&!e.startsWith("url("));function PL(e){const t=e[0];if(e.length===1)return!0;for(let i=0;i<e.length;i++)if(e[i]!==t)return!0}function IL(e,t,i,a){const h=e[0];if(h===null)return!1;if(t==="display"||t==="visibility")return!0;const g=e[e.length-1],p=u2(h,t),c=u2(g,t);return!p||!c?!1:PL(e)||(i==="spring"||VC(i))&&a}function U_(e){e.duration=0,e.type="keyframes"}const AL=new Set(["opacity","clipPath","filter","transform"]),ML=gx(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function DL(e){var P;const{motionValue:t,name:i,repeatDelay:a,repeatType:h,damping:g,type:p}=e;if(!(((P=t==null?void 0:t.owner)==null?void 0:P.current)instanceof HTMLElement))return!1;const{onUpdate:S,transformTemplate:E}=t.owner.getProps();return ML()&&i&&AL.has(i)&&(i!=="transform"||!E)&&!S&&!a&&h!=="mirror"&&g!==0&&p!=="inertia"}const zL=40;class RL extends Cx{constructor({autoplay:t=!0,delay:i=0,type:a="keyframes",repeat:h=0,repeatDelay:g=0,repeatType:p="loop",keyframes:c,name:S,motionValue:E,element:P,...k}){var Z;super(),this.stop=()=>{var H,te;this._animation&&(this._animation.stop(),(H=this.stopTimeline)==null||H.call(this)),(te=this.keyframeResolver)==null||te.cancel()},this.createdAt=_i.now();const I={autoplay:t,delay:i,type:a,repeat:h,repeatDelay:g,repeatType:p,name:S,motionValue:E,element:P,...k},G=(P==null?void 0:P.KeyframeResolver)||Px;this.keyframeResolver=new G(c,(H,te,L)=>this.onKeyframesResolved(H,te,I,!L),S,E,P),(Z=this.keyframeResolver)==null||Z.scheduleResolve()}onKeyframesResolved(t,i,a,h){this.keyframeResolver=void 0;const{name:g,type:p,velocity:c,delay:S,isHandoff:E,onUpdate:P}=a;this.resolvedAt=_i.now(),IL(t,g,p,c)||((Ro.instantAnimations||!S)&&(P==null||P(Tx(t,a,i))),t[0]=t[t.length-1],U_(a),a.repeat=0);const I={startTime:h?this.resolvedAt?this.resolvedAt-this.createdAt>zL?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:i,...a,keyframes:t},G=!E&&DL(I)?new EL({...I,element:I.motionValue.owner.current}):new Ex(I);G.finished.then(()=>this.notifyFinished()).catch(xs),this.pendingTimeline&&(this.stopTimeline=G.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=G}get finished(){return this._animation?this.animation.finished:this._finished}then(t,i){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),gL()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const LL=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function BL(e){const t=LL.exec(e);if(!t)return[,];const[,i,a,h]=t;return[`--${i??a}`,h]}function $C(e,t,i=1){const[a,h]=BL(e);if(!a)return;const g=window.getComputedStyle(t).getPropertyValue(a);if(g){const p=g.trim();return uC(p)?parseFloat(p):p}return xx(h)?$C(h,t,i+1):h}function Ix(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const HC=new Set(["width","height","top","left","right","bottom",...Iu]),FL={test:e=>e==="auto",parse:e=>e},GC=e=>t=>t.test(e),WC=[Pu,Et,to,va,PR,ER,FL],h2=e=>WC.find(GC(e));function NL(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||dC(e):!0}const OL=new Set(["brightness","contrast","saturate","opacity"]);function jL(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=i.match(bx)||[];if(!a)return e;const h=i.replace(a,"");let g=OL.has(t)?1:0;return a!==i&&(g*=100),t+"("+g+h+")"}const VL=/\b([a-z-]*)\(.*?\)/gu,$_={...Na,getAnimatableNone:e=>{const t=e.match(VL);return t?t.map(jL).join(" "):e}},d2={...Pu,transform:Math.round},UL={rotate:va,rotateX:va,rotateY:va,rotateZ:va,scale:Pp,scaleX:Pp,scaleY:Pp,scaleZ:Pp,skew:va,skewX:va,skewY:va,distance:Et,translateX:Et,translateY:Et,translateZ:Et,x:Et,y:Et,z:Et,perspective:Et,transformPerspective:Et,opacity:Vd,originX:e2,originY:e2,originZ:Et},Ax={borderWidth:Et,borderTopWidth:Et,borderRightWidth:Et,borderBottomWidth:Et,borderLeftWidth:Et,borderRadius:Et,radius:Et,borderTopLeftRadius:Et,borderTopRightRadius:Et,borderBottomRightRadius:Et,borderBottomLeftRadius:Et,width:Et,maxWidth:Et,height:Et,maxHeight:Et,top:Et,right:Et,bottom:Et,left:Et,inset:Et,insetBlock:Et,insetBlockStart:Et,insetBlockEnd:Et,insetInline:Et,insetInlineStart:Et,insetInlineEnd:Et,padding:Et,paddingTop:Et,paddingRight:Et,paddingBottom:Et,paddingLeft:Et,paddingBlock:Et,paddingBlockStart:Et,paddingBlockEnd:Et,paddingInline:Et,paddingInlineStart:Et,paddingInlineEnd:Et,margin:Et,marginTop:Et,marginRight:Et,marginBottom:Et,marginLeft:Et,marginBlock:Et,marginBlockStart:Et,marginBlockEnd:Et,marginInline:Et,marginInlineStart:Et,marginInlineEnd:Et,backgroundPositionX:Et,backgroundPositionY:Et,...UL,zIndex:d2,fillOpacity:Vd,strokeOpacity:Vd,numOctaves:d2},$L={...Ax,color:vr,backgroundColor:vr,outlineColor:vr,fill:vr,stroke:vr,borderColor:vr,borderTopColor:vr,borderRightColor:vr,borderBottomColor:vr,borderLeftColor:vr,filter:$_,WebkitFilter:$_},qC=e=>$L[e];function ZC(e,t){let i=qC(e);return i!==$_&&(i=Na),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const HL=new Set(["auto","none","0"]);function GL(e,t,i){let a=0,h;for(;a<e.length&&!h;){const g=e[a];typeof g=="string"&&!HL.has(g)&&Ud(g).values.length&&(h=e[a]),a++}if(h&&i)for(const g of t)e[g]=ZC(i,h)}class WL extends Px{constructor(t,i,a,h,g){super(t,i,a,h,g,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:i,name:a}=this;if(!i||!i.current)return;super.readKeyframes();for(let P=0;P<t.length;P++){let k=t[P];if(typeof k=="string"&&(k=k.trim(),xx(k))){const I=$C(k,i.current);I!==void 0&&(t[P]=I),P===t.length-1&&(this.finalKeyframe=k)}}if(this.resolveNoneKeyframes(),!HC.has(a)||t.length!==2)return;const[h,g]=t,p=h2(h),c=h2(g),S=Q1(h),E=Q1(g);if(S!==E&&Ca[a]){this.needsMeasurement=!0;return}if(p!==c)if(l2(p)&&l2(c))for(let P=0;P<t.length;P++){const k=t[P];typeof k=="string"&&(t[P]=parseFloat(k))}else Ca[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:i}=this,a=[];for(let h=0;h<t.length;h++)(t[h]===null||NL(t[h]))&&a.push(h);a.length&&GL(t,a,i)}measureInitialState(){const{element:t,unresolvedKeyframes:i,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ca[a](t.measureViewportBox(),window.getComputedStyle(t.current)),i[0]=this.measuredOrigin;const h=i[i.length-1];h!==void 0&&t.getValue(a,h).jump(h,!1)}measureEndState(){var c;const{element:t,name:i,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const h=t.getValue(i);h&&h.jump(this.measuredOrigin,!1);const g=a.length-1,p=a[g];a[g]=Ca[i](t.measureViewportBox(),window.getComputedStyle(t.current)),p!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=p),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([S,E])=>{t.getValue(S).set(E)}),this.resolveNoneKeyframes()}}function qL(e,t,i){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const h=(i==null?void 0:i[e])??a.querySelectorAll(e);return h?Array.from(h):[]}return Array.from(e)}const XC=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function KC(e){return hC(e)&&"offsetHeight"in e}const f2=30,ZL=e=>!isNaN(parseFloat(e));class XL{constructor(t,i={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var g;const h=_i.now();if(this.updatedAt!==h&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((g=this.events.change)==null||g.notify(this.current),this.dependents))for(const p of this.dependents)p.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=i.owner}setCurrent(t){this.current=t,this.updatedAt=_i.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=ZL(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new yx);const a=this.events[t].add(i);return t==="change"?()=>{a(),jn.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,i,a){this.set(i),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,i=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=_i.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>f2)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,f2);return fC(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,i;(t=this.dependents)==null||t.clear(),(i=this.events.destroy)==null||i.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function bu(e,t){return new XL(e,t)}const{schedule:Mx}=kC(queueMicrotask,!1),As={x:!1,y:!1};function YC(){return As.x||As.y}function KL(e){return e==="x"||e==="y"?As[e]?null:(As[e]=!0,()=>{As[e]=!1}):As.x||As.y?null:(As.x=As.y=!0,()=>{As.x=As.y=!1})}function JC(e,t){const i=qL(e),a=new AbortController,h={passive:!0,...t,signal:a.signal};return[i,h,()=>a.abort()]}function p2(e){return!(e.pointerType==="touch"||YC())}function YL(e,t,i={}){const[a,h,g]=JC(e,i),p=c=>{if(!p2(c))return;const{target:S}=c,E=t(S,c);if(typeof E!="function"||!S)return;const P=k=>{p2(k)&&(E(k),S.removeEventListener("pointerleave",P))};S.addEventListener("pointerleave",P,h)};return a.forEach(c=>{c.addEventListener("pointerenter",p,h)}),g}const QC=(e,t)=>t?e===t?!0:QC(e,t.parentElement):!1,Dx=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,JL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function eE(e){return JL.has(e.tagName)||e.isContentEditable===!0}const nm=new WeakSet;function m2(e){return t=>{t.key==="Enter"&&e(t)}}function fv(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const QL=(e,t)=>{const i=e.currentTarget;if(!i)return;const a=m2(()=>{if(nm.has(i))return;fv(i,"down");const h=m2(()=>{fv(i,"up")}),g=()=>fv(i,"cancel");i.addEventListener("keyup",h,t),i.addEventListener("blur",g,t)});i.addEventListener("keydown",a,t),i.addEventListener("blur",()=>i.removeEventListener("keydown",a),t)};function g2(e){return Dx(e)&&!YC()}function e3(e,t,i={}){const[a,h,g]=JC(e,i),p=c=>{const S=c.currentTarget;if(!g2(c))return;nm.add(S);const E=t(S,c),P=(G,Z)=>{window.removeEventListener("pointerup",k),window.removeEventListener("pointercancel",I),nm.has(S)&&nm.delete(S),g2(G)&&typeof E=="function"&&E(G,{success:Z})},k=G=>{P(G,S===window||S===document||i.useGlobalTarget||QC(S,G.target))},I=G=>{P(G,!1)};window.addEventListener("pointerup",k,h),window.addEventListener("pointercancel",I,h)};return a.forEach(c=>{(i.useGlobalTarget?window:c).addEventListener("pointerdown",p,h),KC(c)&&(c.addEventListener("focus",E=>QL(E,h)),!eE(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),g}function tE(e){return hC(e)&&"ownerSVGElement"in e}function t3(e){return tE(e)&&e.tagName==="svg"}const ai=e=>!!(e&&e.getVelocity),n3=[...WC,vr,Na],r3=e=>n3.find(GC(e)),zx=$.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function y2(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function i3(...e){return t=>{let i=!1;const a=e.map(h=>{const g=y2(h,t);return!i&&typeof g=="function"&&(i=!0),g});if(i)return()=>{for(let h=0;h<a.length;h++){const g=a[h];typeof g=="function"?g():y2(e[h],null)}}}}function s3(...e){return $.useCallback(i3(...e),e)}class o3 extends $.Component{getSnapshotBeforeUpdate(t){const i=this.props.childRef.current;if(i&&t.isPresent&&!this.props.isPresent){const a=i.offsetParent,h=KC(a)&&a.offsetWidth||0,g=this.props.sizeRef.current;g.height=i.offsetHeight||0,g.width=i.offsetWidth||0,g.top=i.offsetTop,g.left=i.offsetLeft,g.right=h-g.width-g.left}return null}componentDidUpdate(){}render(){return this.props.children}}function a3({children:e,isPresent:t,anchorX:i,root:a}){var P;const h=$.useId(),g=$.useRef(null),p=$.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=$.useContext(zx),S=((P=e.props)==null?void 0:P.ref)??(e==null?void 0:e.ref),E=s3(g,S);return $.useInsertionEffect(()=>{const{width:k,height:I,top:G,left:Z,right:H}=p.current;if(t||!g.current||!k||!I)return;const te=i==="left"?`left: ${Z}`:`right: ${H}`;g.current.dataset.motionPopId=h;const L=document.createElement("style");c&&(L.nonce=c);const V=a??document.head;return V.appendChild(L),L.sheet&&L.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${k}px !important;
            height: ${I}px !important;
            ${te}px !important;
            top: ${G}px !important;
          }
        `),()=>{V.contains(L)&&V.removeChild(L)}},[t]),Q.jsx(o3,{isPresent:t,childRef:g,sizeRef:p,children:$.cloneElement(e,{ref:E})})}const l3=({children:e,initial:t,isPresent:i,onExitComplete:a,custom:h,presenceAffectsLayout:g,mode:p,anchorX:c,root:S})=>{const E=hx(c3),P=$.useId();let k=!0,I=$.useMemo(()=>(k=!1,{id:P,initial:t,isPresent:i,custom:h,onExitComplete:G=>{E.set(G,!0);for(const Z of E.values())if(!Z)return;a&&a()},register:G=>(E.set(G,!1),()=>E.delete(G))}),[i,E,a]);return g&&k&&(I={...I}),$.useMemo(()=>{E.forEach((G,Z)=>E.set(Z,!1))},[i]),$.useEffect(()=>{!i&&!E.size&&a&&a()},[i]),p==="popLayout"&&(e=Q.jsx(a3,{isPresent:i,anchorX:c,root:S,children:e})),Q.jsx(ig.Provider,{value:I,children:e})};function c3(){return new Map}function nE(e=!0){const t=$.useContext(ig);if(t===null)return[!0,null];const{isPresent:i,onExitComplete:a,register:h}=t,g=$.useId();$.useEffect(()=>{if(e)return h(g)},[e]);const p=$.useCallback(()=>e&&a&&a(g),[g,a,e]);return!i&&a?[!1,p]:[!0]}const Ip=e=>e.key||"";function v2(e){const t=[];return $.Children.forEach(e,i=>{$.isValidElement(i)&&t.push(i)}),t}const wu=({children:e,custom:t,initial:i=!0,onExitComplete:a,presenceAffectsLayout:h=!0,mode:g="sync",propagate:p=!1,anchorX:c="left",root:S})=>{const[E,P]=nE(p),k=$.useMemo(()=>v2(e),[e]),I=p&&!E?[]:k.map(Ip),G=$.useRef(!0),Z=$.useRef(k),H=hx(()=>new Map),te=$.useRef(new Set),[L,V]=$.useState(k),[W,re]=$.useState(k);cC(()=>{G.current=!1,Z.current=k;for(let le=0;le<W.length;le++){const ce=Ip(W[le]);I.includes(ce)?(H.delete(ce),te.current.delete(ce)):H.get(ce)!==!0&&H.set(ce,!1)}},[W,I.length,I.join("-")]);const pe=[];if(k!==L){let le=[...k];for(let ce=0;ce<W.length;ce++){const De=W[ce],Be=Ip(De);I.includes(Be)||(le.splice(ce,0,De),pe.push(De))}return g==="wait"&&pe.length&&(le=pe),re(v2(le)),V(k),null}const{forceRender:_e}=$.useContext(ux);return Q.jsx(Q.Fragment,{children:W.map(le=>{const ce=Ip(le),De=p&&!E?!1:k===W||I.includes(ce),Be=()=>{if(te.current.has(ce))return;if(te.current.add(ce),H.has(ce))H.set(ce,!0);else return;let Ce=!0;H.forEach(Fe=>{Fe||(Ce=!1)}),Ce&&(_e==null||_e(),re(Z.current),p&&(P==null||P()),a&&a())};return Q.jsx(l3,{isPresent:De,initial:!G.current||i?void 0:!1,custom:t,presenceAffectsLayout:h,mode:g,root:S,onExitComplete:De?void 0:Be,anchorX:c,children:le},ce)})})},rE=$.createContext({strict:!1}),_2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Su={};for(const e in _2)Su[e]={isEnabled:t=>_2[e].some(i=>!!t[i])};function u3(e){for(const t in e)Su[t]={...Su[t],...e[t]}}const h3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Lm(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||h3.has(e)}let iE=e=>!Lm(e);function d3(e){typeof e=="function"&&(iE=t=>t.startsWith("on")?!Lm(t):e(t))}try{d3(require("@emotion/is-prop-valid").default)}catch{}function f3(e,t,i){const a={};for(const h in e)h==="values"&&typeof e.values=="object"||(iE(h)||i===!0&&Lm(h)||!t&&!Lm(h)||e.draggable&&h.startsWith("onDrag"))&&(a[h]=e[h]);return a}const sg=$.createContext({});function og(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function $d(e){return typeof e=="string"||Array.isArray(e)}const Rx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Lx=["initial",...Rx];function ag(e){return og(e.animate)||Lx.some(t=>$d(e[t]))}function sE(e){return!!(ag(e)||e.variants)}function p3(e,t){if(ag(e)){const{initial:i,animate:a}=e;return{initial:i===!1||$d(i)?i:void 0,animate:$d(a)?a:void 0}}return e.inherit!==!1?t:{}}function m3(e){const{initial:t,animate:i}=p3(e,$.useContext(sg));return $.useMemo(()=>({initial:t,animate:i}),[x2(t),x2(i)])}function x2(e){return Array.isArray(e)?e.join(" "):e}function b2(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Kh={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Et.test(e))e=parseFloat(e);else return e;const i=b2(e,t.target.x),a=b2(e,t.target.y);return`${i}% ${a}%`}},g3={correct:(e,{treeScale:t,projectionDelta:i})=>{const a=e,h=Na.parse(e);if(h.length>5)return a;const g=Na.createTransformer(e),p=typeof h[0]!="number"?1:0,c=i.x.scale*t.x,S=i.y.scale*t.y;h[0+p]/=c,h[1+p]/=S;const E=Kn(c,S,.5);return typeof h[2+p]=="number"&&(h[2+p]/=E),typeof h[3+p]=="number"&&(h[3+p]/=E),g(h)}},H_={borderRadius:{...Kh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Kh,borderTopRightRadius:Kh,borderBottomLeftRadius:Kh,borderBottomRightRadius:Kh,boxShadow:g3};function oE(e,{layout:t,layoutId:i}){return Au.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!H_[e]||e==="opacity")}const y3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},v3=Iu.length;function _3(e,t,i){let a="",h=!0;for(let g=0;g<v3;g++){const p=Iu[g],c=e[p];if(c===void 0)continue;let S=!0;if(typeof c=="number"?S=c===(p.startsWith("scale")?1:0):S=parseFloat(c)===0,!S||i){const E=XC(c,Ax[p]);if(!S){h=!1;const P=y3[p]||p;a+=`${P}(${E}) `}i&&(t[p]=E)}}return a=a.trim(),i?a=i(t,h?"":a):h&&(a="none"),a}function Bx(e,t,i){const{style:a,vars:h,transformOrigin:g}=e;let p=!1,c=!1;for(const S in t){const E=t[S];if(Au.has(S)){p=!0;continue}else if(CC(S)){h[S]=E;continue}else{const P=XC(E,Ax[S]);S.startsWith("origin")?(c=!0,g[S]=P):a[S]=P}}if(t.transform||(p||i?a.transform=_3(t,e.transform,i):a.transform&&(a.transform="none")),c){const{originX:S="50%",originY:E="50%",originZ:P=0}=g;a.transformOrigin=`${S} ${E} ${P}`}}const Fx=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function aE(e,t,i){for(const a in t)!ai(t[a])&&!oE(a,i)&&(e[a]=t[a])}function x3({transformTemplate:e},t){return $.useMemo(()=>{const i=Fx();return Bx(i,t,e),Object.assign({},i.vars,i.style)},[t])}function b3(e,t){const i=e.style||{},a={};return aE(a,i,e),Object.assign(a,x3(e,t)),a}function w3(e,t){const i={},a=b3(e,t);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=a,i}const S3={offset:"stroke-dashoffset",array:"stroke-dasharray"},k3={offset:"strokeDashoffset",array:"strokeDasharray"};function T3(e,t,i=1,a=0,h=!0){e.pathLength=1;const g=h?S3:k3;e[g.offset]=Et.transform(-a);const p=Et.transform(t),c=Et.transform(i);e[g.array]=`${p} ${c}`}const C3=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function lE(e,{attrX:t,attrY:i,attrScale:a,pathLength:h,pathSpacing:g=1,pathOffset:p=0,...c},S,E,P){if(Bx(e,c,E),S){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:k,style:I}=e;k.transform&&(I.transform=k.transform,delete k.transform),(I.transform||k.transformOrigin)&&(I.transformOrigin=k.transformOrigin??"50% 50%",delete k.transformOrigin),I.transform&&(I.transformBox=(P==null?void 0:P.transformBox)??"fill-box",delete k.transformBox);for(const G of C3)k[G]!==void 0&&(I[G]=k[G],delete k[G]);t!==void 0&&(k.x=t),i!==void 0&&(k.y=i),a!==void 0&&(k.scale=a),h!==void 0&&T3(k,h,g,p,!1)}const cE=()=>({...Fx(),attrs:{}}),uE=e=>typeof e=="string"&&e.toLowerCase()==="svg";function E3(e,t,i,a){const h=$.useMemo(()=>{const g=cE();return lE(g,t,uE(a),e.transformTemplate,e.style),{...g.attrs,style:{...g.style}}},[t]);if(e.style){const g={};aE(g,e.style,e),h.style={...g,...h.style}}return h}const P3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Nx(e){return typeof e!="string"||e.includes("-")?!1:!!(P3.indexOf(e)>-1||/[A-Z]/u.test(e))}function I3(e,t,i,{latestValues:a},h,g=!1,p){const S=(p??Nx(e)?E3:w3)(t,a,h,e),E=f3(t,typeof e=="string",g),P=e!==$.Fragment?{...E,...S,ref:i}:{},{children:k}=t,I=$.useMemo(()=>ai(k)?k.get():k,[k]);return $.createElement(e,{...P,children:I})}function w2(e){const t=[{},{}];return e==null||e.values.forEach((i,a)=>{t[0][a]=i.get(),t[1][a]=i.getVelocity()}),t}function Ox(e,t,i,a){if(typeof t=="function"){const[h,g]=w2(a);t=t(i!==void 0?i:e.custom,h,g)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[h,g]=w2(a);t=t(i!==void 0?i:e.custom,h,g)}return t}function rm(e){return ai(e)?e.get():e}function A3({scrapeMotionValuesFromProps:e,createRenderState:t},i,a,h){return{latestValues:M3(i,a,h,e),renderState:t()}}function M3(e,t,i,a){const h={},g=a(e,{});for(const I in g)h[I]=rm(g[I]);let{initial:p,animate:c}=e;const S=ag(e),E=sE(e);t&&E&&!S&&e.inherit!==!1&&(p===void 0&&(p=t.initial),c===void 0&&(c=t.animate));let P=i?i.initial===!1:!1;P=P||p===!1;const k=P?c:p;if(k&&typeof k!="boolean"&&!og(k)){const I=Array.isArray(k)?k:[k];for(let G=0;G<I.length;G++){const Z=Ox(e,I[G]);if(Z){const{transitionEnd:H,transition:te,...L}=Z;for(const V in L){let W=L[V];if(Array.isArray(W)){const re=P?W.length-1:0;W=W[re]}W!==null&&(h[V]=W)}for(const V in H)h[V]=H[V]}}}return h}const hE=e=>(t,i)=>{const a=$.useContext(sg),h=$.useContext(ig),g=()=>A3(e,t,a,h);return i?g():hx(g)};function jx(e,t,i){var g;const{style:a}=e,h={};for(const p in a)(ai(a[p])||t.style&&ai(t.style[p])||oE(p,e)||((g=i==null?void 0:i.getValue(p))==null?void 0:g.liveStyle)!==void 0)&&(h[p]=a[p]);return h}const D3=hE({scrapeMotionValuesFromProps:jx,createRenderState:Fx});function dE(e,t,i){const a=jx(e,t,i);for(const h in e)if(ai(e[h])||ai(t[h])){const g=Iu.indexOf(h)!==-1?"attr"+h.charAt(0).toUpperCase()+h.substring(1):h;a[g]=e[h]}return a}const z3=hE({scrapeMotionValuesFromProps:dE,createRenderState:cE}),R3=Symbol.for("motionComponentSymbol");function L3(e,t,i){const a=$.useRef(i);$.useInsertionEffect(()=>{a.current=i});const h=$.useRef(null);return $.useCallback(g=>{var c;g&&((c=e.onMount)==null||c.call(e,g)),t&&(g?t.mount(g):t.unmount());const p=a.current;if(typeof p=="function")if(g){const S=p(g);typeof S=="function"&&(h.current=S)}else h.current?(h.current(),h.current=null):p(g);else p&&(p.current=g)},[t])}const Vx=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),B3="framerAppearId",fE="data-"+Vx(B3),pE=$.createContext({});function od(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function F3(e,t,i,a,h,g){var te,L;const{visualElement:p}=$.useContext(sg),c=$.useContext(rE),S=$.useContext(ig),E=$.useContext(zx).reducedMotion,P=$.useRef(null);a=a||c.renderer,!P.current&&a&&(P.current=a(e,{visualState:t,parent:p,props:i,presenceContext:S,blockInitialAnimation:S?S.initial===!1:!1,reducedMotionConfig:E,isSVG:g}));const k=P.current,I=$.useContext(pE);k&&!k.projection&&h&&(k.type==="html"||k.type==="svg")&&N3(P.current,i,h,I);const G=$.useRef(!1);$.useInsertionEffect(()=>{k&&G.current&&k.update(i,S)});const Z=i[fE],H=$.useRef(!!Z&&!((te=window.MotionHandoffIsComplete)!=null&&te.call(window,Z))&&((L=window.MotionHasOptimisedAnimation)==null?void 0:L.call(window,Z)));return cC(()=>{k&&(G.current=!0,window.MotionIsMounted=!0,k.updateFeatures(),k.scheduleRenderMicrotask(),H.current&&k.animationState&&k.animationState.animateChanges())}),$.useEffect(()=>{k&&(!H.current&&k.animationState&&k.animationState.animateChanges(),H.current&&(queueMicrotask(()=>{var V;(V=window.MotionHandoffMarkAsComplete)==null||V.call(window,Z)}),H.current=!1),k.enteringChildren=void 0)}),k}function N3(e,t,i,a){const{layoutId:h,layout:g,drag:p,dragConstraints:c,layoutScroll:S,layoutRoot:E,layoutCrossfade:P}=t;e.projection=new i(e.latestValues,t["data-framer-portal-id"]?void 0:mE(e.parent)),e.projection.setOptions({layoutId:h,layout:g,alwaysMeasureLayout:!!p||c&&od(c),visualElement:e,animationType:typeof g=="string"?g:"both",initialPromotionConfig:a,crossfade:P,layoutScroll:S,layoutRoot:E})}function mE(e){if(e)return e.options.allowProjection!==!1?e.projection:mE(e.parent)}function pv(e,{forwardMotionProps:t=!1,type:i}={},a,h){a&&u3(a);const g=i?i==="svg":Nx(e),p=g?z3:D3;function c(E,P){let k;const I={...$.useContext(zx),...E,layoutId:O3(E)},{isStatic:G}=I,Z=m3(E),H=p(E,G);if(!G&&dx){j3();const te=V3(I);k=te.MeasureLayout,Z.visualElement=F3(e,H,I,h,te.ProjectionNode,g)}return Q.jsxs(sg.Provider,{value:Z,children:[k&&Z.visualElement?Q.jsx(k,{visualElement:Z.visualElement,...I}):null,I3(e,E,L3(H,Z.visualElement,P),H,G,t,g)]})}c.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const S=$.forwardRef(c);return S[R3]=e,S}function O3({layoutId:e}){const t=$.useContext(ux).id;return t&&e!==void 0?t+"-"+e:e}function j3(e,t){$.useContext(rE).strict}function V3(e){const{drag:t,layout:i}=Su;if(!t&&!i)return{};const a={...t,...i};return{MeasureLayout:t!=null&&t.isEnabled(e)||i!=null&&i.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function U3(e,t){if(typeof Proxy>"u")return pv;const i=new Map,a=(g,p)=>pv(g,p,e,t),h=(g,p)=>a(g,p);return new Proxy(h,{get:(g,p)=>p==="create"?a:(i.has(p)||i.set(p,pv(p,void 0,e,t)),i.get(p))})}function gE({top:e,left:t,right:i,bottom:a}){return{x:{min:t,max:i},y:{min:e,max:a}}}function $3({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function H3(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:a.y,right:a.x}}function mv(e){return e===void 0||e===1}function G_({scale:e,scaleX:t,scaleY:i}){return!mv(e)||!mv(t)||!mv(i)}function wl(e){return G_(e)||yE(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function yE(e){return S2(e.x)||S2(e.y)}function S2(e){return e&&e!=="0%"}function Bm(e,t,i){const a=e-i,h=t*a;return i+h}function k2(e,t,i,a,h){return h!==void 0&&(e=Bm(e,h,a)),Bm(e,i,a)+t}function W_(e,t=0,i=1,a,h){e.min=k2(e.min,t,i,a,h),e.max=k2(e.max,t,i,a,h)}function vE(e,{x:t,y:i}){W_(e.x,t.translate,t.scale,t.originPoint),W_(e.y,i.translate,i.scale,i.originPoint)}const T2=.999999999999,C2=1.0000000000001;function G3(e,t,i,a=!1){const h=i.length;if(!h)return;t.x=t.y=1;let g,p;for(let c=0;c<h;c++){g=i[c],p=g.projectionDelta;const{visualElement:S}=g.options;S&&S.props.style&&S.props.style.display==="contents"||(a&&g.options.layoutScroll&&g.scroll&&g!==g.root&&iu(e,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),p&&(t.x*=p.x.scale,t.y*=p.y.scale,vE(e,p)),a&&wl(g.latestValues)&&iu(e,g.latestValues))}t.x<C2&&t.x>T2&&(t.x=1),t.y<C2&&t.y>T2&&(t.y=1)}function ru(e,t){e.min=e.min+t,e.max=e.max+t}function E2(e,t,i,a,h=.5){const g=Kn(e.min,e.max,h);W_(e,t,i,g,a)}function iu(e,t){E2(e.x,t.x,t.scaleX,t.scale,t.originX),E2(e.y,t.y,t.scaleY,t.scale,t.originY)}function _E(e,t){return gE(H3(e.getBoundingClientRect(),t))}function W3(e,t,i){const a=_E(e,i),{scroll:h}=t;return h&&(ru(a.x,h.offset.x),ru(a.y,h.offset.y)),a}const P2=()=>({translate:0,scale:1,origin:0,originPoint:0}),su=()=>({x:P2(),y:P2()}),I2=()=>({min:0,max:0}),Tr=()=>({x:I2(),y:I2()}),q_={current:null},xE={current:!1};function q3(){if(xE.current=!0,!!dx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>q_.current=e.matches;e.addEventListener("change",t),t()}else q_.current=!1}const Z3=new WeakMap;function X3(e,t,i){for(const a in t){const h=t[a],g=i[a];if(ai(h))e.addValue(a,h);else if(ai(g))e.addValue(a,bu(h,{owner:e}));else if(g!==h)if(e.hasValue(a)){const p=e.getValue(a);p.liveStyle===!0?p.jump(h):p.hasAnimated||p.set(h)}else{const p=e.getStaticValue(a);e.addValue(a,bu(p!==void 0?p:h,{owner:e}))}}for(const a in i)t[a]===void 0&&e.removeValue(a);return t}const A2=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class K3{scrapeMotionValuesFromProps(t,i,a){return{}}constructor({parent:t,props:i,presenceContext:a,reducedMotionConfig:h,blockInitialAnimation:g,visualState:p},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Px,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const I=_i.now();this.renderScheduledAt<I&&(this.renderScheduledAt=I,jn.render(this.render,!1,!0))};const{latestValues:S,renderState:E}=p;this.latestValues=S,this.baseTarget={...S},this.initialValues=i.initial?{...S}:{},this.renderState=E,this.parent=t,this.props=i,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=h,this.options=c,this.blockInitialAnimation=!!g,this.isControllingVariants=ag(i),this.isVariantNode=sE(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:P,...k}=this.scrapeMotionValuesFromProps(i,{},this);for(const I in k){const G=k[I];S[I]!==void 0&&ai(G)&&G.set(S[I])}}mount(t){var i;this.current=t,Z3.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,h)=>this.bindToMotionValue(h,a)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(xE.current||q3(),this.shouldReduceMotion=q_.current),(i=this.parent)==null||i.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),Fa(this.notifyUpdate),Fa(this.render),this.valueSubscriptions.forEach(i=>i()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const i in this.events)this.events[i].clear();for(const i in this.features){const a=this.features[i];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,i){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=Au.has(t);a&&this.onBindTransform&&this.onBindTransform();const h=i.on("change",p=>{this.latestValues[t]=p,this.props.onUpdate&&jn.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let g;window.MotionCheckAppearSync&&(g=window.MotionCheckAppearSync(this,t,i)),this.valueSubscriptions.set(t,()=>{h(),g&&g(),i.owner&&i.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Su){const i=Su[t];if(!i)continue;const{isEnabled:a,Feature:h}=i;if(!this.features[t]&&h&&a(this.props)&&(this.features[t]=new h(this)),this.features[t]){const g=this.features[t];g.isMounted?g.update():(g.mount(),g.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let a=0;a<A2.length;a++){const h=A2[a];this.propEventSubscriptions[h]&&(this.propEventSubscriptions[h](),delete this.propEventSubscriptions[h]);const g="on"+h,p=t[g];p&&(this.propEventSubscriptions[h]=this.on(h,p))}this.prevMotionValues=X3(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){const a=this.values.get(t);i!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,i),this.values.set(t,i),this.latestValues[t]=i.get())}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&i!==void 0&&(a=bu(i===null?void 0:i,{owner:this}),this.addValue(t,a)),a}readValue(t,i){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(uC(a)||dC(a))?a=parseFloat(a):!r3(a)&&Na.test(i)&&(a=ZC(t,i)),this.setBaseTarget(t,ai(a)?a.get():a)),ai(a)?a.get():a}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){var g;const{initial:i}=this.props;let a;if(typeof i=="string"||typeof i=="object"){const p=Ox(this.props,i,(g=this.presenceContext)==null?void 0:g.custom);p&&(a=p[t])}if(i&&a!==void 0)return a;const h=this.getBaseTargetFromProps(this.props,t);return h!==void 0&&!ai(h)?h:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new yx),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}scheduleRenderMicrotask(){Mx.render(this.render)}}class bE extends K3{constructor(){super(...arguments),this.KeyframeResolver=WL}sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:a}){delete i[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ai(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function wE(e,{style:t,vars:i},a,h){const g=e.style;let p;for(p in t)g[p]=t[p];h==null||h.applyProjectionStyles(g,a);for(p in i)g.setProperty(p,i[p])}function Y3(e){return window.getComputedStyle(e)}class J3 extends bE{constructor(){super(...arguments),this.type="html",this.renderInstance=wE}readValueFromInstance(t,i){var a;if(Au.has(i))return(a=this.projection)!=null&&a.isProjecting?F_(i):hL(t,i);{const h=Y3(t),g=(CC(i)?h.getPropertyValue(i):h[i])||0;return typeof g=="string"?g.trim():g}}measureInstanceViewportBox(t,{transformPagePoint:i}){return _E(t,i)}build(t,i,a){Bx(t,i,a.transformTemplate)}scrapeMotionValuesFromProps(t,i,a){return jx(t,i,a)}}const SE=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Q3(e,t,i,a){wE(e,t,void 0,a);for(const h in t.attrs)e.setAttribute(SE.has(h)?h:Vx(h),t.attrs[h])}class e5 extends bE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Tr}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(Au.has(i)){const a=qC(i);return a&&a.default||0}return i=SE.has(i)?i:Vx(i),t.getAttribute(i)}scrapeMotionValuesFromProps(t,i,a){return dE(t,i,a)}build(t,i,a){lE(t,i,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(t,i,a,h){Q3(t,i,a,h)}mount(t){this.isSVGTag=uE(t.tagName),super.mount(t)}}const t5=(e,t)=>t.isSVG??Nx(e)?new e5(t):new J3(t,{allowProjection:e!==$.Fragment});function du(e,t,i){const a=e.getProps();return Ox(a,t,i!==void 0?i:a.custom,e)}const Z_=e=>Array.isArray(e);function n5(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,bu(i))}function r5(e){return Z_(e)?e[e.length-1]||0:e}function i5(e,t){const i=du(e,t);let{transitionEnd:a={},transition:h={},...g}=i||{};g={...g,...a};for(const p in g){const c=r5(g[p]);n5(e,p,c)}}function s5(e){return!!(ai(e)&&e.add)}function X_(e,t){const i=e.getValue("willChange");if(s5(i))return i.add(t);if(!i&&Ro.WillChange){const a=new Ro.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function kE(e){return e.props[fE]}const o5=e=>e!==null;function a5(e,{repeat:t,repeatType:i="loop"},a){const h=e.filter(o5),g=t&&i!=="loop"&&t%2===1?0:h.length-1;return h[g]}const l5={type:"spring",stiffness:500,damping:25,restSpeed:10},c5=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),u5={type:"keyframes",duration:.8},h5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},d5=(e,{keyframes:t})=>t.length>2?u5:Au.has(e)?e.startsWith("scale")?c5(t[1]):l5:h5;function f5({when:e,delay:t,delayChildren:i,staggerChildren:a,staggerDirection:h,repeat:g,repeatType:p,repeatDelay:c,from:S,elapsed:E,...P}){return!!Object.keys(P).length}const Ux=(e,t,i,a={},h,g)=>p=>{const c=Ix(a,e)||{},S=c.delay||a.delay||0;let{elapsed:E=0}=a;E=E-Po(S);const P={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-E,onUpdate:I=>{t.set(I),c.onUpdate&&c.onUpdate(I)},onComplete:()=>{p(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:g?void 0:h};f5(c)||Object.assign(P,d5(e,P)),P.duration&&(P.duration=Po(P.duration)),P.repeatDelay&&(P.repeatDelay=Po(P.repeatDelay)),P.from!==void 0&&(P.keyframes[0]=P.from);let k=!1;if((P.type===!1||P.duration===0&&!P.repeatDelay)&&(U_(P),P.delay===0&&(k=!0)),(Ro.instantAnimations||Ro.skipAnimations)&&(k=!0,U_(P),P.delay=0),P.allowFlatten=!c.type&&!c.ease,k&&!g&&t.get()!==void 0){const I=a5(P.keyframes,c);if(I!==void 0){jn.update(()=>{P.onUpdate(I),P.onComplete()});return}}return c.isSync?new Ex(P):new RL(P)};function p5({protectedKeys:e,needsAnimating:t},i){const a=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,a}function TE(e,t,{delay:i=0,transitionOverride:a,type:h}={}){let{transition:g=e.getDefaultTransition(),transitionEnd:p,...c}=t;a&&(g=a);const S=[],E=h&&e.animationState&&e.animationState.getState()[h];for(const P in c){const k=e.getValue(P,e.latestValues[P]??null),I=c[P];if(I===void 0||E&&p5(E,P))continue;const G={delay:i,...Ix(g||{},P)},Z=k.get();if(Z!==void 0&&!k.isAnimating&&!Array.isArray(I)&&I===Z&&!G.velocity)continue;let H=!1;if(window.MotionHandoffAnimation){const L=kE(e);if(L){const V=window.MotionHandoffAnimation(L,P,jn);V!==null&&(G.startTime=V,H=!0)}}X_(e,P),k.start(Ux(P,k,I,e.shouldReduceMotion&&HC.has(P)?{type:!1}:G,e,H));const te=k.animation;te&&S.push(te)}return p&&Promise.all(S).then(()=>{jn.update(()=>{p&&i5(e,p)})}),S}function CE(e,t,i,a=0,h=1){const g=Array.from(e).sort((E,P)=>E.sortNodePosition(P)).indexOf(t),p=e.size,c=(p-1)*a;return typeof i=="function"?i(g,p):h===1?g*a:c-g*a}function K_(e,t,i={}){var S;const a=du(e,t,i.type==="exit"?(S=e.presenceContext)==null?void 0:S.custom:void 0);let{transition:h=e.getDefaultTransition()||{}}=a||{};i.transitionOverride&&(h=i.transitionOverride);const g=a?()=>Promise.all(TE(e,a,i)):()=>Promise.resolve(),p=e.variantChildren&&e.variantChildren.size?(E=0)=>{const{delayChildren:P=0,staggerChildren:k,staggerDirection:I}=h;return m5(e,t,E,P,k,I,i)}:()=>Promise.resolve(),{when:c}=h;if(c){const[E,P]=c==="beforeChildren"?[g,p]:[p,g];return E().then(()=>P())}else return Promise.all([g(),p(i.delay)])}function m5(e,t,i=0,a=0,h=0,g=1,p){const c=[];for(const S of e.variantChildren)S.notify("AnimationStart",t),c.push(K_(S,t,{...p,delay:i+(typeof a=="function"?0:a)+CE(e.variantChildren,S,a,h,g)}).then(()=>S.notify("AnimationComplete",t)));return Promise.all(c)}function g5(e,t,i={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const h=t.map(g=>K_(e,g,i));a=Promise.all(h)}else if(typeof t=="string")a=K_(e,t,i);else{const h=typeof t=="function"?du(e,t,i.custom):t;a=Promise.all(TE(e,h,i))}return a.then(()=>{e.notify("AnimationComplete",t)})}function EE(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let a=0;a<i;a++)if(t[a]!==e[a])return!1;return!0}const y5=Lx.length;function PE(e){if(!e)return;if(!e.isControllingVariants){const i=e.parent?PE(e.parent)||{}:{};return e.props.initial!==void 0&&(i.initial=e.props.initial),i}const t={};for(let i=0;i<y5;i++){const a=Lx[i],h=e.props[a];($d(h)||h===!1)&&(t[a]=h)}return t}const v5=[...Rx].reverse(),_5=Rx.length;function x5(e){return t=>Promise.all(t.map(({animation:i,options:a})=>g5(e,i,a)))}function b5(e){let t=x5(e),i=M2(),a=!0;const h=S=>(E,P)=>{var I;const k=du(e,P,S==="exit"?(I=e.presenceContext)==null?void 0:I.custom:void 0);if(k){const{transition:G,transitionEnd:Z,...H}=k;E={...E,...H,...Z}}return E};function g(S){t=S(e)}function p(S){const{props:E}=e,P=PE(e.parent)||{},k=[],I=new Set;let G={},Z=1/0;for(let te=0;te<_5;te++){const L=v5[te],V=i[L],W=E[L]!==void 0?E[L]:P[L],re=$d(W),pe=L===S?V.isActive:null;pe===!1&&(Z=te);let _e=W===P[L]&&W!==E[L]&&re;if(_e&&a&&e.manuallyAnimateOnMount&&(_e=!1),V.protectedKeys={...G},!V.isActive&&pe===null||!W&&!V.prevProp||og(W)||typeof W=="boolean")continue;const le=w5(V.prevProp,W);let ce=le||L===S&&V.isActive&&!_e&&re||te>Z&&re,De=!1;const Be=Array.isArray(W)?W:[W];let Ce=Be.reduce(h(L),{});pe===!1&&(Ce={});const{prevResolvedValues:Fe={}}=V,ze={...Fe,...Ce},Qe=$e=>{ce=!0,I.has($e)&&(De=!0,I.delete($e)),V.needsAnimating[$e]=!0;const ke=e.getValue($e);ke&&(ke.liveStyle=!1)};for(const $e in ze){const ke=Ce[$e],Ue=Fe[$e];if(G.hasOwnProperty($e))continue;let et=!1;Z_(ke)&&Z_(Ue)?et=!EE(ke,Ue):et=ke!==Ue,et?ke!=null?Qe($e):I.add($e):ke!==void 0&&I.has($e)?Qe($e):V.protectedKeys[$e]=!0}V.prevProp=W,V.prevResolvedValues=Ce,V.isActive&&(G={...G,...Ce}),a&&e.blockInitialAnimation&&(ce=!1);const Ze=_e&&le;ce&&(!Ze||De)&&k.push(...Be.map($e=>{const ke={type:L};if(typeof $e=="string"&&a&&!Ze&&e.manuallyAnimateOnMount&&e.parent){const{parent:Ue}=e,et=du(Ue,$e);if(Ue.enteringChildren&&et){const{delayChildren:pt}=et.transition||{};ke.delay=CE(Ue.enteringChildren,e,pt)}}return{animation:$e,options:ke}}))}if(I.size){const te={};if(typeof E.initial!="boolean"){const L=du(e,Array.isArray(E.initial)?E.initial[0]:E.initial);L&&L.transition&&(te.transition=L.transition)}I.forEach(L=>{const V=e.getBaseTarget(L),W=e.getValue(L);W&&(W.liveStyle=!0),te[L]=V??null}),k.push({animation:te})}let H=!!k.length;return a&&(E.initial===!1||E.initial===E.animate)&&!e.manuallyAnimateOnMount&&(H=!1),a=!1,H?t(k):Promise.resolve()}function c(S,E){var k;if(i[S].isActive===E)return Promise.resolve();(k=e.variantChildren)==null||k.forEach(I=>{var G;return(G=I.animationState)==null?void 0:G.setActive(S,E)}),i[S].isActive=E;const P=p(S);for(const I in i)i[I].protectedKeys={};return P}return{animateChanges:p,setActive:c,setAnimateFunction:g,getState:()=>i,reset:()=>{i=M2()}}}function w5(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!EE(t,e):!1}function yl(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function M2(){return{animate:yl(!0),whileInView:yl(),whileHover:yl(),whileTap:yl(),whileDrag:yl(),whileFocus:yl(),exit:yl()}}class $a{constructor(t){this.isMounted=!1,this.node=t}update(){}}class S5 extends $a{constructor(t){super(t),t.animationState||(t.animationState=b5(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();og(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let k5=0;class T5 extends $a{constructor(){super(...arguments),this.id=k5++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const h=this.node.animationState.setActive("exit",!t);i&&!t&&h.then(()=>{i(this.id)})}mount(){const{register:t,onExitComplete:i}=this.node.presenceContext||{};i&&i(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const C5={animation:{Feature:S5},exit:{Feature:T5}};function Hd(e,t,i,a={passive:!0}){return e.addEventListener(t,i,a),()=>e.removeEventListener(t,i)}function rf(e){return{point:{x:e.pageX,y:e.pageY}}}const E5=e=>t=>Dx(t)&&e(t,rf(t));function _d(e,t,i,a){return Hd(e,t,E5(i),a)}const IE=1e-4,P5=1-IE,I5=1+IE,AE=.01,A5=0-AE,M5=0+AE;function xi(e){return e.max-e.min}function D5(e,t,i){return Math.abs(e-t)<=i}function D2(e,t,i,a=.5){e.origin=a,e.originPoint=Kn(t.min,t.max,e.origin),e.scale=xi(i)/xi(t),e.translate=Kn(i.min,i.max,e.origin)-e.originPoint,(e.scale>=P5&&e.scale<=I5||isNaN(e.scale))&&(e.scale=1),(e.translate>=A5&&e.translate<=M5||isNaN(e.translate))&&(e.translate=0)}function xd(e,t,i,a){D2(e.x,t.x,i.x,a?a.originX:void 0),D2(e.y,t.y,i.y,a?a.originY:void 0)}function z2(e,t,i){e.min=i.min+t.min,e.max=e.min+xi(t)}function z5(e,t,i){z2(e.x,t.x,i.x),z2(e.y,t.y,i.y)}function R2(e,t,i){e.min=t.min-i.min,e.max=e.min+xi(t)}function Fm(e,t,i){R2(e.x,t.x,i.x),R2(e.y,t.y,i.y)}function fs(e){return[e("x"),e("y")]}const ME=({current:e})=>e?e.ownerDocument.defaultView:null,L2=(e,t)=>Math.abs(e-t);function R5(e,t){const i=L2(e.x,t.x),a=L2(e.y,t.y);return Math.sqrt(i**2+a**2)}const B2=new Set(["auto","scroll"]);class DE{constructor(t,i,{transformPagePoint:a,contextWindow:h=window,dragSnapToOrigin:g=!1,distanceThreshold:p=3,element:c}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=G=>{this.handleScroll(G.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const G=yv(this.lastMoveEventInfo,this.history),Z=this.startEvent!==null,H=R5(G.offset,{x:0,y:0})>=this.distanceThreshold;if(!Z&&!H)return;const{point:te}=G,{timestamp:L}=Wr;this.history.push({...te,timestamp:L});const{onStart:V,onMove:W}=this.handlers;Z||(V&&V(this.lastMoveEvent,G),this.startEvent=this.lastMoveEvent),W&&W(this.lastMoveEvent,G)},this.handlePointerMove=(G,Z)=>{this.lastMoveEvent=G,this.lastMoveEventInfo=gv(Z,this.transformPagePoint),jn.update(this.updatePoint,!0)},this.handlePointerUp=(G,Z)=>{this.end();const{onEnd:H,onSessionEnd:te,resumeAnimation:L}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&L&&L(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const V=yv(G.type==="pointercancel"?this.lastMoveEventInfo:gv(Z,this.transformPagePoint),this.history);this.startEvent&&H&&H(G,V),te&&te(G,V)},!Dx(t))return;this.dragSnapToOrigin=g,this.handlers=i,this.transformPagePoint=a,this.distanceThreshold=p,this.contextWindow=h||window;const S=rf(t),E=gv(S,this.transformPagePoint),{point:P}=E,{timestamp:k}=Wr;this.history=[{...P,timestamp:k}];const{onSessionStart:I}=i;I&&I(t,yv(E,this.history)),this.removeListeners=ef(_d(this.contextWindow,"pointermove",this.handlePointerMove),_d(this.contextWindow,"pointerup",this.handlePointerUp),_d(this.contextWindow,"pointercancel",this.handlePointerUp)),c&&this.startScrollTracking(c)}startScrollTracking(t){let i=t.parentElement;for(;i;){const a=getComputedStyle(i);(B2.has(a.overflowX)||B2.has(a.overflowY))&&this.scrollPositions.set(i,{x:i.scrollLeft,y:i.scrollTop}),i=i.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const i=this.scrollPositions.get(t);if(!i)return;const a=t===window,h=a?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},g={x:h.x-i.x,y:h.y-i.y};g.x===0&&g.y===0||(a?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=g.x,this.lastMoveEventInfo.point.y+=g.y):this.history.length>0&&(this.history[0].x-=g.x,this.history[0].y-=g.y),this.scrollPositions.set(t,h),jn.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Fa(this.updatePoint)}}function gv(e,t){return t?{point:t(e.point)}:e}function F2(e,t){return{x:e.x-t.x,y:e.y-t.y}}function yv({point:e},t){return{point:e,delta:F2(e,zE(t)),offset:F2(e,L5(t)),velocity:B5(t,.1)}}function L5(e){return e[0]}function zE(e){return e[e.length-1]}function B5(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,a=null;const h=zE(e);for(;i>=0&&(a=e[i],!(h.timestamp-a.timestamp>Po(t)));)i--;if(!a)return{x:0,y:0};const g=vs(h.timestamp-a.timestamp);if(g===0)return{x:0,y:0};const p={x:(h.x-a.x)/g,y:(h.y-a.y)/g};return p.x===1/0&&(p.x=0),p.y===1/0&&(p.y=0),p}function F5(e,{min:t,max:i},a){return t!==void 0&&e<t?e=a?Kn(t,e,a.min):Math.max(e,t):i!==void 0&&e>i&&(e=a?Kn(i,e,a.max):Math.min(e,i)),e}function N2(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function N5(e,{top:t,left:i,bottom:a,right:h}){return{x:N2(e.x,i,h),y:N2(e.y,t,a)}}function O2(e,t){let i=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,a]=[a,i]),{min:i,max:a}}function O5(e,t){return{x:O2(e.x,t.x),y:O2(e.y,t.y)}}function j5(e,t){let i=.5;const a=xi(e),h=xi(t);return h>a?i=jd(t.min,t.max-a,e.min):a>h&&(i=jd(e.min,e.max-h,t.min)),no(0,1,i)}function V5(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const Y_=.35;function U5(e=Y_){return e===!1?e=0:e===!0&&(e=Y_),{x:j2(e,"left","right"),y:j2(e,"top","bottom")}}function j2(e,t,i){return{min:V2(e,t),max:V2(e,i)}}function V2(e,t){return typeof e=="number"?e:e[t]||0}const $5=new WeakMap;class H5{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:i=!1,distanceThreshold:a}={}){const{presenceContext:h}=this.visualElement;if(h&&h.isPresent===!1)return;const g=k=>{i?(this.stopAnimation(),this.snapToCursor(rf(k).point)):this.pauseAnimation()},p=(k,I)=>{this.stopAnimation();const{drag:G,dragPropagation:Z,onDragStart:H}=this.getProps();if(G&&!Z&&(this.openDragLock&&this.openDragLock(),this.openDragLock=KL(G),!this.openDragLock))return;this.latestPointerEvent=k,this.latestPanInfo=I,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fs(L=>{let V=this.getAxisMotionValue(L).get()||0;if(to.test(V)){const{projection:W}=this.visualElement;if(W&&W.layout){const re=W.layout.layoutBox[L];re&&(V=xi(re)*(parseFloat(V)/100))}}this.originPoint[L]=V}),H&&jn.postRender(()=>H(k,I)),X_(this.visualElement,"transform");const{animationState:te}=this.visualElement;te&&te.setActive("whileDrag",!0)},c=(k,I)=>{this.latestPointerEvent=k,this.latestPanInfo=I;const{dragPropagation:G,dragDirectionLock:Z,onDirectionLock:H,onDrag:te}=this.getProps();if(!G&&!this.openDragLock)return;const{offset:L}=I;if(Z&&this.currentDirection===null){this.currentDirection=G5(L),this.currentDirection!==null&&H&&H(this.currentDirection);return}this.updateAxis("x",I.point,L),this.updateAxis("y",I.point,L),this.visualElement.render(),te&&te(k,I)},S=(k,I)=>{this.latestPointerEvent=k,this.latestPanInfo=I,this.stop(k,I),this.latestPointerEvent=null,this.latestPanInfo=null},E=()=>fs(k=>{var I;return this.getAnimationState(k)==="paused"&&((I=this.getAxisMotionValue(k).animation)==null?void 0:I.play())}),{dragSnapToOrigin:P}=this.getProps();this.panSession=new DE(t,{onSessionStart:g,onStart:p,onMove:c,onSessionEnd:S,resumeAnimation:E},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:P,distanceThreshold:a,contextWindow:ME(this.visualElement),element:this.visualElement.current})}stop(t,i){const a=t||this.latestPointerEvent,h=i||this.latestPanInfo,g=this.isDragging;if(this.cancel(),!g||!h||!a)return;const{velocity:p}=h;this.startAnimation(p);const{onDragEnd:c}=this.getProps();c&&jn.postRender(()=>c(a,h))}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,a){const{drag:h}=this.getProps();if(!a||!Ap(t,h,this.currentDirection))return;const g=this.getAxisMotionValue(t);let p=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(p=F5(p,this.constraints[t],this.elastic[t])),g.set(p)}resolveConstraints(){var g;const{dragConstraints:t,dragElastic:i}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(g=this.visualElement.projection)==null?void 0:g.layout,h=this.constraints;t&&od(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=N5(a.layoutBox,t):this.constraints=!1,this.elastic=U5(i),h!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&fs(p=>{this.constraints!==!1&&this.getAxisMotionValue(p)&&(this.constraints[p]=V5(a.layoutBox[p],this.constraints[p]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!od(t))return!1;const a=t.current,{projection:h}=this.visualElement;if(!h||!h.layout)return!1;const g=W3(a,h.root,this.visualElement.getTransformPagePoint());let p=O5(h.layout.layoutBox,g);if(i){const c=i($3(p));this.hasMutatedConstraints=!!c,c&&(p=gE(c))}return p}startAnimation(t){const{drag:i,dragMomentum:a,dragElastic:h,dragTransition:g,dragSnapToOrigin:p,onDragTransitionEnd:c}=this.getProps(),S=this.constraints||{},E=fs(P=>{if(!Ap(P,i,this.currentDirection))return;let k=S&&S[P]||{};p&&(k={min:0,max:0});const I=h?200:1e6,G=h?40:1e7,Z={type:"inertia",velocity:a?t[P]:0,bounceStiffness:I,bounceDamping:G,timeConstant:750,restDelta:1,restSpeed:10,...g,...k};return this.startAxisValueAnimation(P,Z)});return Promise.all(E).then(c)}startAxisValueAnimation(t,i){const a=this.getAxisMotionValue(t);return X_(this.visualElement,t),a.start(Ux(t,a,0,i,this.visualElement,!1))}stopAnimation(){fs(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){fs(t=>{var i;return(i=this.getAxisMotionValue(t).animation)==null?void 0:i.pause()})}getAnimationState(t){var i;return(i=this.getAxisMotionValue(t).animation)==null?void 0:i.state}getAxisMotionValue(t){const i=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),h=a[i];return h||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){fs(i=>{const{drag:a}=this.getProps();if(!Ap(i,a,this.currentDirection))return;const{projection:h}=this.visualElement,g=this.getAxisMotionValue(i);if(h&&h.layout){const{min:p,max:c}=h.layout.layoutBox[i],S=g.get()||0;g.set(t[i]-Kn(p,c,.5)+S)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:a}=this.visualElement;if(!od(i)||!a||!this.constraints)return;this.stopAnimation();const h={x:0,y:0};fs(p=>{const c=this.getAxisMotionValue(p);if(c&&this.constraints!==!1){const S=c.get();h[p]=j5({min:S,max:S},this.constraints[p])}});const{transformTemplate:g}=this.visualElement.getProps();this.visualElement.current.style.transform=g?g({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),fs(p=>{if(!Ap(p,t,null))return;const c=this.getAxisMotionValue(p),{min:S,max:E}=this.constraints[p];c.set(Kn(S,E,h[p]))})}addListeners(){if(!this.visualElement.current)return;$5.set(this.visualElement,this);const t=this.visualElement.current,i=_d(t,"pointerdown",S=>{const{drag:E,dragListener:P=!0}=this.getProps();E&&P&&!eE(S.target)&&this.start(S)}),a=()=>{const{dragConstraints:S}=this.getProps();od(S)&&S.current&&(this.constraints=this.resolveRefConstraints())},{projection:h}=this.visualElement,g=h.addEventListener("measure",a);h&&!h.layout&&(h.root&&h.root.updateScroll(),h.updateLayout()),jn.read(a);const p=Hd(window,"resize",()=>this.scalePositionWithinConstraints()),c=h.addEventListener("didUpdate",({delta:S,hasLayoutChanged:E})=>{this.isDragging&&E&&(fs(P=>{const k=this.getAxisMotionValue(P);k&&(this.originPoint[P]+=S[P].translate,k.set(k.get()+S[P].translate))}),this.visualElement.render())});return()=>{p(),i(),g(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:a=!1,dragPropagation:h=!1,dragConstraints:g=!1,dragElastic:p=Y_,dragMomentum:c=!0}=t;return{...t,drag:i,dragDirectionLock:a,dragPropagation:h,dragConstraints:g,dragElastic:p,dragMomentum:c}}}function Ap(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function G5(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class W5 extends $a{constructor(t){super(t),this.removeGroupControls=xs,this.removeListeners=xs,this.controls=new H5(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||xs}update(){const{dragControls:t}=this.node.getProps(),{dragControls:i}=this.node.prevProps||{};t!==i&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const U2=e=>(t,i)=>{e&&jn.postRender(()=>e(t,i))};class q5 extends $a{constructor(){super(...arguments),this.removePointerDownListener=xs}onPointerDown(t){this.session=new DE(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:ME(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:a,onPanEnd:h}=this.node.getProps();return{onSessionStart:U2(t),onStart:U2(i),onMove:a,onEnd:(g,p)=>{delete this.session,h&&jn.postRender(()=>h(g,p))}}}mount(){this.removePointerDownListener=_d(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const im={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let vv=!1;class Z5 extends $.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:a,layoutId:h}=this.props,{projection:g}=t;g&&(i.group&&i.group.add(g),a&&a.register&&h&&a.register(g),vv&&g.root.didUpdate(),g.addEventListener("animationComplete",()=>{this.safeToRemove()}),g.setOptions({...g.options,onExitComplete:()=>this.safeToRemove()})),im.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:a,drag:h,isPresent:g}=this.props,{projection:p}=a;return p&&(p.isPresent=g,vv=!0,h||t.layoutDependency!==i||i===void 0||t.isPresent!==g?p.willUpdate():this.safeToRemove(),t.isPresent!==g&&(g?p.promote():p.relegate()||jn.postRender(()=>{const c=p.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Mx.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:a}=this.props,{projection:h}=t;vv=!0,h&&(h.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(h),a&&a.deregister&&a.deregister(h))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function RE(e){const[t,i]=nE(),a=$.useContext(ux);return Q.jsx(Z5,{...e,layoutGroup:a,switchLayoutGroup:$.useContext(pE),isPresent:t,safeToRemove:i})}function X5(e,t,i){const a=ai(e)?e:bu(e);return a.start(Ux("",a,t,i)),a.animation}const K5=(e,t)=>e.depth-t.depth;class Y5{constructor(){this.children=[],this.isDirty=!1}add(t){fx(this.children,t),this.isDirty=!0}remove(t){px(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(K5),this.isDirty=!1,this.children.forEach(t)}}function J5(e,t){const i=_i.now(),a=({timestamp:h})=>{const g=h-i;g>=t&&(Fa(a),e(g-t))};return jn.setup(a,!0),()=>Fa(a)}const LE=["TopLeft","TopRight","BottomLeft","BottomRight"],Q5=LE.length,$2=e=>typeof e=="string"?parseFloat(e):e,H2=e=>typeof e=="number"||Et.test(e);function eB(e,t,i,a,h,g){h?(e.opacity=Kn(0,i.opacity??1,tB(a)),e.opacityExit=Kn(t.opacity??1,0,nB(a))):g&&(e.opacity=Kn(t.opacity??1,i.opacity??1,a));for(let p=0;p<Q5;p++){const c=`border${LE[p]}Radius`;let S=G2(t,c),E=G2(i,c);if(S===void 0&&E===void 0)continue;S||(S=0),E||(E=0),S===0||E===0||H2(S)===H2(E)?(e[c]=Math.max(Kn($2(S),$2(E),a),0),(to.test(E)||to.test(S))&&(e[c]+="%")):e[c]=E}(t.rotate||i.rotate)&&(e.rotate=Kn(t.rotate||0,i.rotate||0,a))}function G2(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const tB=BE(0,.5,xC),nB=BE(.5,.95,xs);function BE(e,t,i){return a=>a<e?0:a>t?1:i(jd(e,t,a))}function W2(e,t){e.min=t.min,e.max=t.max}function Is(e,t){W2(e.x,t.x),W2(e.y,t.y)}function q2(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Z2(e,t,i,a,h){return e-=t,e=Bm(e,1/i,a),h!==void 0&&(e=Bm(e,1/h,a)),e}function rB(e,t=0,i=1,a=.5,h,g=e,p=e){if(to.test(t)&&(t=parseFloat(t),t=Kn(p.min,p.max,t/100)-p.min),typeof t!="number")return;let c=Kn(g.min,g.max,a);e===g&&(c-=t),e.min=Z2(e.min,t,i,c,h),e.max=Z2(e.max,t,i,c,h)}function X2(e,t,[i,a,h],g,p){rB(e,t[i],t[a],t[h],t.scale,g,p)}const iB=["x","scaleX","originX"],sB=["y","scaleY","originY"];function K2(e,t,i,a){X2(e.x,t,iB,i?i.x:void 0,a?a.x:void 0),X2(e.y,t,sB,i?i.y:void 0,a?a.y:void 0)}function Y2(e){return e.translate===0&&e.scale===1}function FE(e){return Y2(e.x)&&Y2(e.y)}function J2(e,t){return e.min===t.min&&e.max===t.max}function oB(e,t){return J2(e.x,t.x)&&J2(e.y,t.y)}function Q2(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function NE(e,t){return Q2(e.x,t.x)&&Q2(e.y,t.y)}function eS(e){return xi(e.x)/xi(e.y)}function tS(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class aB{constructor(){this.members=[]}add(t){fx(this.members,t),t.scheduleRender()}remove(t){if(px(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(h=>t===h);if(i===0)return!1;let a;for(let h=i;h>=0;h--){const g=this.members[h];if(g.isPresent!==!1){a=g;break}}return a?(this.promote(a),!0):!1}promote(t,i){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,i&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:h}=t.options;h===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:a}=t;i.onExitComplete&&i.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function lB(e,t,i){let a="";const h=e.x.translate/t.x,g=e.y.translate/t.y,p=(i==null?void 0:i.z)||0;if((h||g||p)&&(a=`translate3d(${h}px, ${g}px, ${p}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),i){const{transformPerspective:E,rotate:P,rotateX:k,rotateY:I,skewX:G,skewY:Z}=i;E&&(a=`perspective(${E}px) ${a}`),P&&(a+=`rotate(${P}deg) `),k&&(a+=`rotateX(${k}deg) `),I&&(a+=`rotateY(${I}deg) `),G&&(a+=`skewX(${G}deg) `),Z&&(a+=`skewY(${Z}deg) `)}const c=e.x.scale*t.x,S=e.y.scale*t.y;return(c!==1||S!==1)&&(a+=`scale(${c}, ${S})`),a||"none"}const _v=["","X","Y","Z"],cB=1e3;let uB=0;function xv(e,t,i,a){const{latestValues:h}=t;h[e]&&(i[e]=h[e],t.setStaticValue(e,0),a&&(a[e]=0))}function OE(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const i=kE(t);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:h,layoutId:g}=e.options;window.MotionCancelOptimisedAnimation(i,"transform",jn,!(h||g))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&OE(a)}function jE({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:a,resetTransform:h}){return class{constructor(p={},c=t==null?void 0:t()){this.id=uB++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(fB),this.nodes.forEach(yB),this.nodes.forEach(vB),this.nodes.forEach(pB)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=p,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let S=0;S<this.path.length;S++)this.path[S].shouldResetTransform=!0;this.root===this&&(this.nodes=new Y5)}addEventListener(p,c){return this.eventHandlers.has(p)||this.eventHandlers.set(p,new yx),this.eventHandlers.get(p).add(c)}notifyListeners(p,...c){const S=this.eventHandlers.get(p);S&&S.notify(...c)}hasListeners(p){return this.eventHandlers.has(p)}mount(p){if(this.instance)return;this.isSVG=tE(p)&&!t3(p),this.instance=p;const{layoutId:c,layout:S,visualElement:E}=this.options;if(E&&!E.current&&E.mount(p),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(S||c)&&(this.isLayoutDirty=!0),e){let P,k=0;const I=()=>this.root.updateBlockedByResize=!1;jn.read(()=>{k=window.innerWidth}),e(p,()=>{const G=window.innerWidth;G!==k&&(k=G,this.root.updateBlockedByResize=!0,P&&P(),P=J5(I,250),im.hasAnimatedSinceResize&&(im.hasAnimatedSinceResize=!1,this.nodes.forEach(iS)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&E&&(c||S)&&this.addEventListener("didUpdate",({delta:P,hasLayoutChanged:k,hasRelativeLayoutChanged:I,layout:G})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Z=this.options.transition||E.getDefaultTransition()||SB,{onLayoutAnimationStart:H,onLayoutAnimationComplete:te}=E.getProps(),L=!this.targetLayout||!NE(this.targetLayout,G),V=!k&&I;if(this.options.layoutRoot||this.resumeFrom||V||k&&(L||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const W={...Ix(Z,"layout"),onPlay:H,onComplete:te};(E.shouldReduceMotion||this.options.layoutRoot)&&(W.delay=0,W.type=!1),this.startAnimation(W),this.setAnimationOrigin(P,V)}else k||iS(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=G})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const p=this.getStack();p&&p.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Fa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(_B),this.animationId++)}getTransformTemplate(){const{visualElement:p}=this.options;return p&&p.getProps().transformTemplate}willUpdate(p=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&OE(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let P=0;P<this.path.length;P++){const k=this.path[P];k.shouldResetTransform=!0,k.updateScroll("snapshot"),k.options.layoutRoot&&k.willUpdate(!1)}const{layoutId:c,layout:S}=this.options;if(c===void 0&&!S)return;const E=this.getTransformTemplate();this.prevTransformTemplateValue=E?E(this.latestValues,""):void 0,this.updateSnapshot(),p&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(nS);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(rS);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(gB),this.nodes.forEach(hB),this.nodes.forEach(dB)):this.nodes.forEach(rS),this.clearAllSnapshots();const c=_i.now();Wr.delta=no(0,1e3/60,c-Wr.timestamp),Wr.timestamp=c,Wr.isProcessing=!0,av.update.process(Wr),av.preRender.process(Wr),av.render.process(Wr),Wr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Mx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(mB),this.sharedNodes.forEach(xB)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,jn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){jn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!xi(this.snapshot.measuredBox.x)&&!xi(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let S=0;S<this.path.length;S++)this.path[S].updateScroll();const p=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Tr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,p?p.layoutBox:void 0)}updateScroll(p="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===p&&(c=!1),c&&this.instance){const S=a(this.instance);this.scroll={animationId:this.root.animationId,phase:p,isRoot:S,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:S}}}resetTransform(){if(!h)return;const p=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!FE(this.projectionDelta),S=this.getTransformTemplate(),E=S?S(this.latestValues,""):void 0,P=E!==this.prevTransformTemplateValue;p&&this.instance&&(c||wl(this.latestValues)||P)&&(h(this.instance,E),this.shouldResetTransform=!1,this.scheduleRender())}measure(p=!0){const c=this.measurePageBox();let S=this.removeElementScroll(c);return p&&(S=this.removeTransform(S)),kB(S),{animationId:this.root.animationId,measuredBox:c,layoutBox:S,latestValues:{},source:this.id}}measurePageBox(){var E;const{visualElement:p}=this.options;if(!p)return Tr();const c=p.measureViewportBox();if(!(((E=this.scroll)==null?void 0:E.wasRoot)||this.path.some(TB))){const{scroll:P}=this.root;P&&(ru(c.x,P.offset.x),ru(c.y,P.offset.y))}return c}removeElementScroll(p){var S;const c=Tr();if(Is(c,p),(S=this.scroll)!=null&&S.wasRoot)return c;for(let E=0;E<this.path.length;E++){const P=this.path[E],{scroll:k,options:I}=P;P!==this.root&&k&&I.layoutScroll&&(k.wasRoot&&Is(c,p),ru(c.x,k.offset.x),ru(c.y,k.offset.y))}return c}applyTransform(p,c=!1){const S=Tr();Is(S,p);for(let E=0;E<this.path.length;E++){const P=this.path[E];!c&&P.options.layoutScroll&&P.scroll&&P!==P.root&&iu(S,{x:-P.scroll.offset.x,y:-P.scroll.offset.y}),wl(P.latestValues)&&iu(S,P.latestValues)}return wl(this.latestValues)&&iu(S,this.latestValues),S}removeTransform(p){const c=Tr();Is(c,p);for(let S=0;S<this.path.length;S++){const E=this.path[S];if(!E.instance||!wl(E.latestValues))continue;G_(E.latestValues)&&E.updateSnapshot();const P=Tr(),k=E.measurePageBox();Is(P,k),K2(c,E.latestValues,E.snapshot?E.snapshot.layoutBox:void 0,P)}return wl(this.latestValues)&&K2(c,this.latestValues),c}setTargetDelta(p){this.targetDelta=p,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(p){this.options={...this.options,...p,crossfade:p.crossfade!==void 0?p.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Wr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(p=!1){var G;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const S=!!this.resumingFrom||this!==c;if(!(p||S&&this.isSharedProjectionDirty||this.isProjectionDirty||(G=this.parent)!=null&&G.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:P,layoutId:k}=this.options;if(!this.layout||!(P||k))return;this.resolvedRelativeTargetAt=Wr.timestamp;const I=this.getClosestProjectingParent();I&&this.linkedParentVersion!==I.layoutVersion&&!I.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(I&&I.layout?this.createRelativeTarget(I,this.layout.layoutBox,I.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Tr(),this.targetWithTransforms=Tr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),z5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Is(this.target,this.layout.layoutBox),vE(this.target,this.targetDelta)):Is(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,I&&!!I.resumingFrom==!!this.resumingFrom&&!I.options.layoutScroll&&I.target&&this.animationProgress!==1?this.createRelativeTarget(I,this.target,I.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||G_(this.parent.latestValues)||yE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(p,c,S){this.relativeParent=p,this.linkedParentVersion=p.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tr(),this.relativeTargetOrigin=Tr(),Fm(this.relativeTargetOrigin,c,S),Is(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var Z;const p=this.getLead(),c=!!this.resumingFrom||this!==p;let S=!0;if((this.isProjectionDirty||(Z=this.parent)!=null&&Z.isProjectionDirty)&&(S=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(S=!1),this.resolvedRelativeTargetAt===Wr.timestamp&&(S=!1),S)return;const{layout:E,layoutId:P}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(E||P))return;Is(this.layoutCorrected,this.layout.layoutBox);const k=this.treeScale.x,I=this.treeScale.y;G3(this.layoutCorrected,this.treeScale,this.path,c),p.layout&&!p.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(p.target=p.layout.layoutBox,p.targetWithTransforms=Tr());const{target:G}=p;if(!G){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(q2(this.prevProjectionDelta.x,this.projectionDelta.x),q2(this.prevProjectionDelta.y,this.projectionDelta.y)),xd(this.projectionDelta,this.layoutCorrected,G,this.latestValues),(this.treeScale.x!==k||this.treeScale.y!==I||!tS(this.projectionDelta.x,this.prevProjectionDelta.x)||!tS(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",G))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(p=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),p){const S=this.getStack();S&&S.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=su(),this.projectionDelta=su(),this.projectionDeltaWithTransform=su()}setAnimationOrigin(p,c=!1){const S=this.snapshot,E=S?S.latestValues:{},P={...this.latestValues},k=su();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const I=Tr(),G=S?S.source:void 0,Z=this.layout?this.layout.source:void 0,H=G!==Z,te=this.getStack(),L=!te||te.members.length<=1,V=!!(H&&!L&&this.options.crossfade===!0&&!this.path.some(wB));this.animationProgress=0;let W;this.mixTargetDelta=re=>{const pe=re/1e3;sS(k.x,p.x,pe),sS(k.y,p.y,pe),this.setTargetDelta(k),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Fm(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),bB(this.relativeTarget,this.relativeTargetOrigin,I,pe),W&&oB(this.relativeTarget,W)&&(this.isProjectionDirty=!1),W||(W=Tr()),Is(W,this.relativeTarget)),H&&(this.animationValues=P,eB(P,E,this.latestValues,pe,V,L)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=pe},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(p){var c,S,E;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(E=(S=this.resumingFrom)==null?void 0:S.currentAnimation)==null||E.stop(),this.pendingAnimation&&(Fa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=jn.update(()=>{im.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=bu(0)),this.currentAnimation=X5(this.motionValue,[0,1e3],{...p,velocity:0,isSync:!0,onUpdate:P=>{this.mixTargetDelta(P),p.onUpdate&&p.onUpdate(P)},onStop:()=>{},onComplete:()=>{p.onComplete&&p.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const p=this.getStack();p&&p.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(cB),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const p=this.getLead();let{targetWithTransforms:c,target:S,layout:E,latestValues:P}=p;if(!(!c||!S||!E)){if(this!==p&&this.layout&&E&&VE(this.options.animationType,this.layout.layoutBox,E.layoutBox)){S=this.target||Tr();const k=xi(this.layout.layoutBox.x);S.x.min=p.target.x.min,S.x.max=S.x.min+k;const I=xi(this.layout.layoutBox.y);S.y.min=p.target.y.min,S.y.max=S.y.min+I}Is(c,S),iu(c,P),xd(this.projectionDeltaWithTransform,this.layoutCorrected,c,P)}}registerSharedNode(p,c){this.sharedNodes.has(p)||this.sharedNodes.set(p,new aB),this.sharedNodes.get(p).add(c);const E=c.options.initialPromotionConfig;c.promote({transition:E?E.transition:void 0,preserveFollowOpacity:E&&E.shouldPreserveFollowOpacity?E.shouldPreserveFollowOpacity(c):void 0})}isLead(){const p=this.getStack();return p?p.lead===this:!0}getLead(){var c;const{layoutId:p}=this.options;return p?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:p}=this.options;return p?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:p}=this.options;if(p)return this.root.sharedNodes.get(p)}promote({needsReset:p,transition:c,preserveFollowOpacity:S}={}){const E=this.getStack();E&&E.promote(this,S),p&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const p=this.getStack();return p?p.relegate(this):!1}resetSkewAndRotation(){const{visualElement:p}=this.options;if(!p)return;let c=!1;const{latestValues:S}=p;if((S.z||S.rotate||S.rotateX||S.rotateY||S.rotateZ||S.skewX||S.skewY)&&(c=!0),!c)return;const E={};S.z&&xv("z",p,E,this.animationValues);for(let P=0;P<_v.length;P++)xv(`rotate${_v[P]}`,p,E,this.animationValues),xv(`skew${_v[P]}`,p,E,this.animationValues);p.render();for(const P in E)p.setStaticValue(P,E[P]),this.animationValues&&(this.animationValues[P]=E[P]);p.scheduleRender()}applyProjectionStyles(p,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){p.visibility="hidden";return}const S=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,p.visibility="",p.opacity="",p.pointerEvents=rm(c==null?void 0:c.pointerEvents)||"",p.transform=S?S(this.latestValues,""):"none";return}const E=this.getLead();if(!this.projectionDelta||!this.layout||!E.target){this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=rm(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!wl(this.latestValues)&&(p.transform=S?S({},""):"none",this.hasProjected=!1);return}p.visibility="";const P=E.animationValues||E.latestValues;this.applyTransformsToTarget();let k=lB(this.projectionDeltaWithTransform,this.treeScale,P);S&&(k=S(P,k)),p.transform=k;const{x:I,y:G}=this.projectionDelta;p.transformOrigin=`${I.origin*100}% ${G.origin*100}% 0`,E.animationValues?p.opacity=E===this?P.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:P.opacityExit:p.opacity=E===this?P.opacity!==void 0?P.opacity:"":P.opacityExit!==void 0?P.opacityExit:0;for(const Z in H_){if(P[Z]===void 0)continue;const{correct:H,applyTo:te,isCSSVariable:L}=H_[Z],V=k==="none"?P[Z]:H(P[Z],E);if(te){const W=te.length;for(let re=0;re<W;re++)p[te[re]]=V}else L?this.options.visualElement.renderState.vars[Z]=V:p[Z]=V}this.options.layoutId&&(p.pointerEvents=E===this?rm(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(p=>{var c;return(c=p.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(nS),this.root.sharedNodes.clear()}}}function hB(e){e.updateLayout()}function dB(e){var i;const t=((i=e.resumeFrom)==null?void 0:i.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:h}=e.layout,{animationType:g}=e.options,p=t.source!==e.layout.source;g==="size"?fs(k=>{const I=p?t.measuredBox[k]:t.layoutBox[k],G=xi(I);I.min=a[k].min,I.max=I.min+G}):VE(g,t.layoutBox,a)&&fs(k=>{const I=p?t.measuredBox[k]:t.layoutBox[k],G=xi(a[k]);I.max=I.min+G,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[k].max=e.relativeTarget[k].min+G)});const c=su();xd(c,a,t.layoutBox);const S=su();p?xd(S,e.applyTransform(h,!0),t.measuredBox):xd(S,a,t.layoutBox);const E=!FE(c);let P=!1;if(!e.resumeFrom){const k=e.getClosestProjectingParent();if(k&&!k.resumeFrom){const{snapshot:I,layout:G}=k;if(I&&G){const Z=Tr();Fm(Z,t.layoutBox,I.layoutBox);const H=Tr();Fm(H,a,G.layoutBox),NE(Z,H)||(P=!0),k.options.layoutRoot&&(e.relativeTarget=H,e.relativeTargetOrigin=Z,e.relativeParent=k)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:S,layoutDelta:c,hasLayoutChanged:E,hasRelativeLayoutChanged:P})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function fB(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function pB(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function mB(e){e.clearSnapshot()}function nS(e){e.clearMeasurements()}function rS(e){e.isLayoutDirty=!1}function gB(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function iS(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function yB(e){e.resolveTargetDelta()}function vB(e){e.calcProjection()}function _B(e){e.resetSkewAndRotation()}function xB(e){e.removeLeadSnapshot()}function sS(e,t,i){e.translate=Kn(t.translate,0,i),e.scale=Kn(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function oS(e,t,i,a){e.min=Kn(t.min,i.min,a),e.max=Kn(t.max,i.max,a)}function bB(e,t,i,a){oS(e.x,t.x,i.x,a),oS(e.y,t.y,i.y,a)}function wB(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const SB={duration:.45,ease:[.4,0,.1,1]},aS=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),lS=aS("applewebkit/")&&!aS("chrome/")?Math.round:xs;function cS(e){e.min=lS(e.min),e.max=lS(e.max)}function kB(e){cS(e.x),cS(e.y)}function VE(e,t,i){return e==="position"||e==="preserve-aspect"&&!D5(eS(t),eS(i),.2)}function TB(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const CB=jE({attachResizeListener:(e,t)=>Hd(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),bv={current:void 0},UE=jE({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!bv.current){const e=new CB({});e.mount(window),e.setOptions({layoutScroll:!0}),bv.current=e}return bv.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),EB={pan:{Feature:q5},drag:{Feature:W5,ProjectionNode:UE,MeasureLayout:RE}};function uS(e,t,i){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",i==="Start");const h="onHover"+i,g=a[h];g&&jn.postRender(()=>g(t,rf(t)))}class PB extends $a{mount(){const{current:t}=this.node;t&&(this.unmount=YL(t,(i,a)=>(uS(this.node,a,"Start"),h=>uS(this.node,h,"End"))))}unmount(){}}class IB extends $a{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ef(Hd(this.node.current,"focus",()=>this.onFocus()),Hd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function hS(e,t,i){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",i==="Start");const h="onTap"+(i==="End"?"":i),g=a[h];g&&jn.postRender(()=>g(t,rf(t)))}class AB extends $a{mount(){const{current:t}=this.node;t&&(this.unmount=e3(t,(i,a)=>(hS(this.node,a,"Start"),(h,{success:g})=>hS(this.node,h,g?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const J_=new WeakMap,wv=new WeakMap,MB=e=>{const t=J_.get(e.target);t&&t(e)},DB=e=>{e.forEach(MB)};function zB({root:e,...t}){const i=e||document;wv.has(i)||wv.set(i,{});const a=wv.get(i),h=JSON.stringify(t);return a[h]||(a[h]=new IntersectionObserver(DB,{root:e,...t})),a[h]}function RB(e,t,i){const a=zB(t);return J_.set(e,i),a.observe(e),()=>{J_.delete(e),a.unobserve(e)}}const LB={some:0,all:1};class BB extends $a{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:a,amount:h="some",once:g}=t,p={root:i?i.current:void 0,rootMargin:a,threshold:typeof h=="number"?h:LB[h]},c=S=>{const{isIntersecting:E}=S;if(this.isInView===E||(this.isInView=E,g&&!E&&this.hasEnteredView))return;E&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",E);const{onViewportEnter:P,onViewportLeave:k}=this.node.getProps(),I=E?P:k;I&&I(S)};return RB(this.node.current,p,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(FB(t,i))&&this.startObserver()}unmount(){}}function FB({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const NB={inView:{Feature:BB},tap:{Feature:AB},focus:{Feature:IB},hover:{Feature:PB}},OB={layout:{ProjectionNode:UE,MeasureLayout:RE}},jB={...C5,...NB,...EB,...OB},rs=U3(jB,t5);function Mp(e){if(!e)return 2025;e=e.toString().toLowerCase();const t=e.match(/(\d{4})/);return t?parseInt(t[0]):e.includes("late 19th")?1890:e.includes("mid 19th")?1850:e.includes("early 19th")?1810:e.includes("19th century")?1850:e.includes("early 20th")?1910:e.includes("mid 20th")?1950:e.includes("late 20th")?1990:e.includes("20th century")?1950:2025}function ps(e){return e.categories&&Array.isArray(e.categories)?e.categories:e.category?[e.category]:[]}function VB(e){if(!e)return e;if(e.startsWith("/"))return"/kalaghoda/"+e.substring(1);if(e.indexOf("upload.wikimedia.org")===-1||e.indexOf("/thumb/")!==-1)return e;try{const t=e.split("/"),i=t.indexOf("commons");if(i!==-1){const a=t[t.length-1];return t.splice(i+1,0,"thumb"),t.push("800px-"+a),t.join("/")}}catch{console.warn("Failed to optimize wiki image:",e)}return e}const dS={light:"https://api.maptiler.com/maps/019b6fe6-78c4-7dcb-b6eb-fed1b18171df/style.json?key=f0f0aibL2C05fTzSrqHq",dark:"https://api.maptiler.com/maps/019b9cbc-2b55-70b4-b89b-4b390bcfb112/style.json?key=f0f0aibL2C05fTzSrqHq"},sr={initialZoom:16.5,startCenter:[72.8322,18.927],style:dS.light,darkStyle:dS.dark,colors:{"Art Deco":"#2a9d8f",Victorian:"#e76f51",Modern:"#00cec9","Indo-Saracenic":"#b33939",Neoclassical:"#8e44ad","Public Space":"#27ae60",Lettering:"#e84393","Ghost Site":"#95a5a6","Street Furniture":"#57606f","Living Heritage":"#f39c12","Street Sign":"#3742fa",Vernacular:"#d35400","Urban Texture":"#8d6e63"},icons:{"Art Deco":"fa-building",Victorian:"fa-landmark",Modern:"fa-square","Indo-Saracenic":"fa-gopuram",Neoclassical:"fa-columns","Public Space":"fa-tree",Lettering:"fa-font","Ghost Site":"fa-ghost","Street Furniture":"fa-road","Living Heritage":"fa-users","Street Sign":"fa-sign-hanging",Vernacular:"fa-home","Urban Texture":"fa-cubes"}},bd=[{id:"wellington",category:"Neoclassical",title:"Wellington Fountain",image:"https://upload.wikimedia.org/wikipedia/commons/0/0b/Wellington_fountain_with_the_MH_Police_HQ_in_background%2C_Mumbai.jpg",description:"Built to commemorate the Duke of Wellingtons visits to Bombay. It is the only fountain in the city built in the Neoclassical style.",year:"1865",architect:"Gen. Barr / Sir George Gilbert Scott",builder:"Public Subscription",location:{center:[72.832344,18.925439]}},{id:"ins-vikrant",category:"Street Furniture",title:"INS Vikrant Memorial",image:"./images/ins-vikrant.jpg",description:"A detailed scale model of India's first aircraft carrier, INS Vikrant (R11), installed at Regal Circle as a tribute to the Indian Navy.",year:"2022",architect:"Indian Navy",builder:"Public Installation",location:{center:[72.832673,18.9258]}},{id:"vbgandhi-sign",category:"Street Sign",title:"V.B. Gandhi Marg Sign",image:"./images/vb-gandhi-marg.jpg",description:"A classic blue enamel hanging street sign marking the entrance to V.B. Gandhi Marg (formerly Forbes Street).",year:"1990",architect:"BMC",builder:"Municipal Corp",location:{center:[72.831972,18.92825]}},{id:"forbes-sign",category:"Street Sign",title:"Forbes Street Sign",image:"./images/forbes-street.jpg",description:'A rare bilingual street sign bearing the colonial name "Forbes Street" (now V.B. Gandhi Marg).',year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.832056,18.92825]}},{id:"regal",category:"Art Deco",title:"Regal Cinema",image:"./images/regal.jpg",description:"One of the earliest Art Deco cinemas in India.",year:"1933",architect:"Charles Stevens",builder:"Framji Sidhwa",location:{center:[72.83245,18.92455]}},{id:"police-hq",category:"Victorian",title:"Police Headquarters",image:"https://upload.wikimedia.org/wikipedia/commons/0/0e/Maharashtra_Police_Headquarters.jpg",description:"Formerly the Royal Alfred Sailors Home. A masterpiece of Gothic architecture.",year:"1876",architect:"F.W. Stevens",builder:"Govt. of Bombay",location:{center:[72.83334037487425,18.92524244911638]}},{id:"majestic",category:"Indo-Saracenic",title:"Majestic Aamdar Niwas",image:"https://upload.wikimedia.org/wikipedia/commons/c/cb/Majestic_MLA_Hostel_Mumbai_by_Dr._Raju_Kasambe_DSCN0428_(28).jpg",description:"Formerly the Majestic Hotel. An Indo-Saracenic gem now used as a hostel for legislators.",year:"1909",architect:"W.A. Chambers",builder:"Private",location:{center:[72.8318474719337,18.9246768777787]}},{id:"mercantile",category:"Indo-Saracenic",title:"Indian Mercantile Mansion",image:"https://upload.wikimedia.org/wikipedia/commons/4/48/Indian_Mercantile_Mansion%2C_Colaba%2C_Mumbai_as_seen_from_Madame_Cama_Road.jpg",description:"Also known as Waterloo Mansions. A grand residential building with Gothic arches.",year:"1900",architect:"Unknown",builder:"Private",location:{center:[72.83188959451451,18.924916574206417]}},{id:"science",category:"Indo-Saracenic",title:"Institute of Science",image:"https://upload.wikimedia.org/wikipedia/commons/b/bb/Entrance_of_the_Institute_of_Science%2C_Fort%2C_Mumbai.jpg",description:"A majestic Indo-Saracenic building built using yellow Kharodi basalt.",year:"1920",architect:"George Wittet",builder:"Govt. of Bombay",location:{center:[72.83025908124948,18.926175121968605]}},{id:"ngma",category:"Indo-Saracenic",title:"NGMA (Cowasji Jehangir Hall)",image:"https://upload.wikimedia.org/wikipedia/commons/6/6c/Sir_Cowasji_Jehangir_Hall_Front.jpg",description:"Originally the Cowasji Jehangir Public Hall, now the National Gallery of Modern Art.",year:"1911",architect:"George Wittet",builder:"Sir Cowasji Jehangir",location:{center:[72.83156173339212,18.925786832066194]}},{id:"museum",category:"Indo-Saracenic",title:"CSMVS Museum",image:"./images/csmvs.jpg",description:"Indo Saracenic landmark constructed using grey Kurla basalt. Formerly the Prince of Wales Museum.",year:"1914",architect:"George Wittet",builder:"Govt. of Bombay",location:{center:[72.83222,18.92666]}},{id:"buddha-sculpture",category:"Street Furniture",title:"The Buddhas Within",image:"./images/buddha-head.jpg",description:"A monumental copper sculpture by Satish Gupta. The serene head reveals a hollow cave-like interior housing a sleeping Buddha and 1,500 miniature figures.",year:"2016",architect:"Satish Gupta",builder:"CSMVS/Private",location:{center:[72.831722,18.926611]}},{id:"cama",categories:["Indo-Saracenic","Lettering"],title:"K.R. Cama Oriental Institute",images:["https://upload.wikimedia.org/wikipedia/commons/b/b8/The_K.R._Cama_Oriental_Institute_in_Fort%2C_Mumbai.jpg","./images/camal.jpg"],description:"A premier institute for Indology and Persian studies, inaugurated in 1916. The building features elegant Indo-Saracenic arches and a distinctive stone-carved nameplate above the entrance.",year:"1916",architect:"Unknown",builder:"Sukhadwala Family",location:{center:[72.833709,18.927298]}},{id:"lions-gate",category:"Victorian",title:"Lions Gate",image:"https://upload.wikimedia.org/wikipedia/commons/5/5d/Naval_Dockyard_Mumbai.jpg",description:"The main entrance to the Naval Dockyard, guarded by two stone lions.",year:"1890",architect:"Royal Navy",builder:"Bombay Dockyard",location:{center:[72.83421608761844,18.926268371527307]}},{id:"dockyard-vane",category:"Urban Texture",title:"Naval Weather Vane",image:"./images/dockyard-weather-vane.png",description:"A classic rooster weather vane perched atop a red-domed cupola within the Naval Dockyard complex, a functional and decorative maritime detail.",year:"Unknown",architect:"Royal Navy",builder:"Bombay Dockyard",location:{center:[72.833861,18.927833]}},{id:"vikrant-sculpture",category:"Street Furniture",title:"INS Vikrant Sculpture",image:"./images/naval-artifact.jpg",description:"A modern sculpture created from the metal scraps of the dismantled INS Vikrant (1961), serving as a memorial to Indias first aircraft carrier.",year:"2016",architect:"Arzan Khambatta",builder:"Indian Navy",location:{center:[72.83355,18.92666]}},{id:"bnhs",category:"Lettering",title:"BNHS (Hornbill House)",image:"https://upload.wikimedia.org/wikipedia/commons/7/73/BNHS_Office_by_Raju_KasambeDSCN7078_(7)_05.jpg",description:"Headquarters of the Bombay Natural History Society.",year:"1965",architect:"Unknown",builder:"BNHS",location:{center:[72.8332718521053,18.92623514458551]}},{id:"standrews",category:"Neoclassical",title:"St. Andrews Cathedral",image:"https://upload.wikimedia.org/wikipedia/commons/8/81/A_heritage_structure_of_early_19th_century.jpg",description:"A Scottish Presbyterian church with a classic steeple.",year:"1819",architect:"Thomas Dadford",builder:"Scottish Community",location:{center:[72.83370123061556,18.92693820553702]}},{id:"elphinstone",category:"Victorian",title:"Elphinstone College",image:"./images/elphinstone.jpg",description:"Victorian Gothic Revival building with pointed arches.",year:"1871",architect:"James Trubshawe",builder:"Sir Cowasji Jehangir",location:{center:[72.83083411935105,18.92497448499293]}},{id:"rhythm",categories:["Ghost Site","Lettering"],title:"Rhythm House",images:["https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Rhythm_House_(14427838921).jpg/1024px-Rhythm_House_(14427838921).jpg","./images/rhythm-house-lettering.jpg"],description:"Formerly the city's premier music store. The iconic Art Deco typography was synonymous with Mumbai's music culture for decades.",year:"1940s",architect:"Unknown",builder:"Mehmood Curmally",location:{center:[72.832123,18.928066]}},{id:"jehangir",category:"Modern",title:"Jehangir Art Gallery",image:"./images/jehangir.jpg",description:"Modernist concrete structure with a distinctive cantilevered entrance.",year:"1952",architect:"G. M. Bhuta",builder:"Sir Cowasji Jehangir",location:{center:[72.83185,18.92745]}},{id:"ador",categories:["Art Deco","Lettering"],title:"Ador House",images:["./images/ador-house-building.jpg","./images/ador-house-lettering.jpg"],description:'A mid-20th century structure blending commercial utility with Art Deco, featuring a stone facade and bracketed wooden eaves. The "ADOR HOUSE" lettering is rendered in clean, sans-serif metal relief above the entrance arcade.',year:"1940",architect:"Unknown",builder:"JB Advani Group",location:{center:[72.833167,18.927]}},{id:"mmb",category:"Modern",title:"Max Mueller Bhavan",image:"./images/max-mueller-bhavan.jpg",description:"The Goethe-Institut hub for Indo-German cultural exchange.",year:"1970",architect:"N/A",builder:"Goethe Institut",location:{center:[72.8325,18.92725]}},{id:"pavement",category:"Living Heritage",title:"The Pavement Gallery",image:"./images/pavement-gallery.jpg",description:"An informal exhibition space where aspiring artists display their work.",year:"2025",architect:"The People",builder:"Informal Usage",location:{center:[72.8315,18.927028]}},{id:"sassoon",category:"Victorian",title:"David Sassoon Library",image:"./images/sassoon.jpg",description:"Victorian Gothic architecture defined by pointed arches and a tranquil garden.",year:"1870",architect:"Campbell & Gosling",builder:"Scott McClelland",location:{center:[72.83116,18.92772]}},{id:"statue",category:"Street Furniture",title:"Kala Ghoda Statue",image:"./images/placeholder.jpg",description:"Bronze statue installed to mark the historic site.",year:"2017",architect:"Commissioned artwork",builder:"Kala Ghoda Association",location:{center:[72.8318,18.9278]}},{id:"ropewalk-paving",category:"Urban Texture",title:"Rope Walk Lane Paving",image:"./images/ropewalk-paving.jpg",description:"New basalt stone paving installed in 2025, transforming Rope Walk Lane into a dedicated pedestrian path on weekends.",year:"2025",architect:"Unknown",builder:"BMC",location:{center:[72.832306,18.928583]}},{id:"heritage-paving",category:"Urban Texture",title:"Historic Basalt Paving",image:"./images/stone-paving.jpg",description:"Remnants of the original heavy rectangular basalt stone paving that once lined many of the Fort precinct's streets, providing a durable surface for carriages and trams.",year:"Unknown",architect:"City Engineers",builder:"Public Works",location:{center:[72.832333,18.928806]}},{id:"synagogue",categories:["Victorian","Lettering"],title:"Keneseth Eliyahoo",images:["./images/synagogue.jpg","./images/synagogue-lettering.jpg"],description:'Victorian era synagogue with a distinctive blue facade. The Hebrew inscription above the entrance reads: "This is the gate of the Lord; the righteous shall enter through it" (Psalm 118:20).',year:"1884",architect:"Gostling & Morris",builder:"Jacob Elias Sassoon",location:{center:[72.83257,18.92811]}},{id:"numbered-sign",category:"Lettering",title:"52-54-56 Signage",image:"./images/numbered-sign.jpg",description:'A distinctive metal building number sign "52-54-56" mounted against a backdrop of contemporary street art featuring a stylized bird.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832556,18.928222]}},{id:"homji-street",category:"Street Sign",title:"Homji Street Sign",image:"./images/homji-street-sign.jpg",description:"Weathered bilingual street sign in English and Hindi, mounted on stone steps. A classic example of Mumbai's historic street signage.",year:"Unknown",architect:"BMC",builder:"BMC",location:{center:[72.835056,18.932722]}},{id:"rk-laxman",category:"Street Furniture",title:"R.K. Laxman's Common Man Sculpture",image:"./images/rk-laxman-sculpture.jpg",description:`Bronze sculpture depicting cartoonist R.K. Laxman's iconic "Common Man" character facing a bull, installed as a tribute to the legendary artist and his satirical commentary on Indian society.`,year:"2014",architect:"Ram V. Sutar",builder:"Kala Ghoda Association",location:{center:[72.834194,18.931778]}},{id:"oricon",categories:["Modern","Lettering"],title:"Oricon House",image:"./images/bhogilal-lettering.jpg",description:'A mid-century modern commercial high-rise. The ground floor houses the heritage Bhogilal Hargovindas store, featuring colonial stonework and an ornate wrought iron entrance grille with the monogram "FSP".',year:"1960",architect:"Unknown",builder:"Oricon Enterprises",location:{center:[72.83266334046198,18.927526423678376]}},{id:"civil-court",category:"Victorian",title:"Old Secretariat (City Court)",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Mumbai_City_Civil_and_Sessions_Court_as_seen_from_Oval_Maidan.jpg/1280px-Mumbai_City_Civil_and_Sessions_Court_as_seen_from_Oval_Maidan.jpg",description:"One of the earliest Venetian Gothic buildings in the city.",year:"1874",architect:"Col. H. St. Clair Wilkins",builder:"Public Works Dept",location:{center:[72.8302,18.9275]}},{id:"university",category:"Victorian",title:"University of Mumbai",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/Mumbai_University_Buildings_04.jpg/1280px-Mumbai_University_Buildings_04.jpg",description:"The Fort campus features Venetian Gothic architecture including the Convocation Hall.",year:"1874",architect:"Sir Gilbert Scott",builder:"Cowasji Jehangir",location:{center:[72.8305,18.9284]}},{id:"university-facade",category:"Victorian",title:"University Library Turret",image:"./images/university-turret.jpg",description:"A close-up view of the Venetian Gothic stonework on the University Library. Designed by Sir George Gilbert Scott, the structure uses local Kurla basalt and Malad stone.",year:"1878",architect:"Sir Gilbert Scott",builder:"Premchand Roychand",location:{center:[72.831194,18.928833]}},{id:"jehangir-building",categories:["Victorian","Lettering"],title:"Jehangir Building",images:["./images/jehangir-building.jpg","./images/jehangir-lettering.jpg"],description:'A handsome stone facade building on Mahatma Gandhi Road featuring arched windows and decorative iron balconies. The name "JEHANGIR BUILDING" is rendered in bold relief lettering across the facade.',year:"1890",architect:"Unknown",builder:"Private",location:{center:[72.83125,18.928833]}},{id:"rajabai",category:"Victorian",title:"Rajabai Clock Tower",image:"./images/rajabai.jpg",description:"Modeled on Big Ben, this 85m tower dominates the skyline.",year:"1878",architect:"Sir Gilbert Scott",builder:"Premchand Roychand",location:{center:[72.8302,18.9288]}},{id:"new-india",category:"Art Deco",title:"New India Assurance Building",image:"./images/new-india-assurance.jpg",description:'A monumental Art Deco structure designed by Master, Sathe & Bhuta. The facade features colossal relief sculptures by N.G. Pansare representing "Protection" and "Prosperity".',year:"1937",architect:"Master, Sathe & Bhuta",builder:"Sir Dorabji Tata",location:{center:[72.831167,18.930111]}},{id:"oval",category:"Public Space",title:"Oval Maidan",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Oval_Maidan%2C_Mumbai.jpg/1024px-Oval_Maidan%2C_Mumbai.jpg",description:"A Grade I heritage open precinct.",year:"1860",architect:"N/A",builder:"City Planner",location:{center:[72.8295,18.928]}},{id:"army",categories:["Victorian","Lettering"],title:"Army and Navy Building",images:["./images/army-navy.jpg","./images/army-lettering.jpg"],description:'Late nineteenth century Neo-Classical/Victorian commercial building. The iconic "ARMY & NAVY BUILDING" serif lettering is rendered in silver against the dark stone facade.',year:"1890",architect:"Frederick William Stevens",builder:"British Military",location:{center:[72.8313,18.9282]}},{id:"esplanade",categories:["Victorian","Ghost Site"],title:"Esplanade Mansion (Watson's Hotel)",images:["./images/esplanade.jpg","https://hindi.cdn.zeenews.com/hindi/sites/default/files/2025/10/24/4204878-cinema.png?im=FitAndFill=(616,462)"],description:"Formerly Watson's Hotel, this is India's oldest cast-iron building. On July 7, 1896, the Lumire Brothers showcased the first-ever motion pictures in India here.",year:"1865 / 1896",architect:"Rowland Mason Ordish",builder:"British Engineers",location:{center:[72.8316,18.9283]}},{id:"sassoon-bldg",category:"Lettering",title:"Sassoon Building No. 3",image:"./images/sassoon-bldg.jpg",description:"Classic hand-painted building signage located at 27 Burjorji Bharucha Marg. Currently houses the Government of Maharashtra Gazetteers Department.",year:"Unknown",architect:"Unknown",builder:"David Sassoon & Co.",location:{center:[72.831778,18.928638]}},{id:"gazetteer-sign",category:"Lettering",title:"Gazetteer Dept Sign",image:"./images/gazetteer-sign.jpg",description:'A weathered black and white wooden signboard for the "Gazetteers Department of Govt. of Maharashtra", located at the entrance of the historic Sassoon Building.',year:"Unknown",architect:"Govt of Maharashtra",builder:"PWD",location:{center:[72.831795,18.928655]}},{id:"best-sign",category:"Street Sign",title:"BEST Sub-Station Sign",image:"./images/best-sign.jpg",description:"A standard red enamel sign marking the local electrical sub-station for B. Bharucha Marg (formerly Dean Lane).",year:"Unknown",architect:"BEST Undertaking",builder:"Municipal Corp",location:{center:[72.831833,18.928611]}},{id:"heritage-corner",category:"Vernacular",title:"Heritage Corner Facade",image:"./images/bombay-shirt-co.jpg",description:"A striking corner building with a weathered grey facade, recurrent arched windows, and wooden shutters. A classic example of the precinct's unpolished heritage texture.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832306,18.928583]}},{id:"vardhan-chowk",category:"Street Sign",title:"Shri. Kishorchandra M. Vardhan Chowk",image:"./images/vardhan-chowk.jpg",description:'A municipal street sign designating the junction as "Shri. Kishorchandra M. Vardhan Chowk", honoring a local figure.',year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.832972,18.928361]}},{id:"alkesh-mody",category:"Street Sign",title:"Alkesh Dinesh Mody Marg",image:"./images/alkesh-mody.jpg",description:"A prominent street sign named after the dynamic stockbroker Alkesh Dinesh Mody. The street was historically a key business lane in the Fort area.",year:"1994",architect:"BMC",builder:"Municipal Corp",location:{center:[72.834139,18.929611]}},{id:"techno-heritage",category:"Vernacular",title:"Techno Heritage",image:"./images/techno-heritage.jpg",description:"A distinctively geometric building with Art Deco influences, featuring symmetrical bays, louvred shutters, and patterned balcony railings. Originally a residential structure adapted for commercial use.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832167,18.929778]}},{id:"cercle-litteraire",category:"Ghost Site",title:"Cercle Littraire (Jatia Chambers)",image:"./images/jatia-chambers.jpg",description:'Housed the French library "Cercle Littraire" on the third floor, opened in 1886 by Sir Dinshaw Petit. A cultural landmark for over a century, it closed around 2022/23.',year:"1886",architect:"Unknown",builder:"Sir Dinshaw Petit",location:{center:[72.832194,18.928278]}},{id:"botawala-sign",category:"Lettering",title:"Botawala Building Sign",image:"./images/botawala-bldg.jpg",description:"Old hand-painted wooden signage for 71/73 Botawala Building.",year:"Unknown",architect:"Unknown",builder:"HIMS Botawala Charities Trust",location:{center:[72.834194,18.929556]}},{id:"rural-relief",category:"Urban Texture",title:"Stone Relief of Rural Life",image:"./images/rural-relief-pillar.jpg",description:"A detailed stone relief carving on a building pillar depicting stylized figures engaged in rural agricultural tasks.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.831417,18.930917]}},{id:"wayside",category:"Ghost Site",title:"Wayside Inn",image:"./images/wayside.jpg",description:"Now the Khyber restaurant. Famous quaint tea room.",year:"1920",architect:"N/A",builder:"Historic Site",location:{center:[72.8317,18.9286]}},{id:"kgc",category:"Living Heritage",title:"Kala Ghoda Caf",image:"./images/kgcafe.png",description:"A modern institution in a heritage shell, known for its sustainable architecture.",year:"2009",architect:"N/A",builder:"Private",location:{center:[72.83220844167671,18.928537127462914]}},{id:"horse-mural",category:"Living Heritage",title:"Street Art Mural",image:"./images/horse-mural.jpg",description:'A contemporary street art mural featuring a galloping horse and the word "HEAL", painted on a compound wall.',year:"Unknown",architect:"Unknown",builder:"Street Artist",location:{center:[72.833083,18.927639]}},{id:"commerce-house",category:"Lettering",title:"Commerce House Gate",image:"./images/commerce-house.jpg",description:"Art Deco style lettering integrated directly into the wrought iron gate design.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832833,18.928472]}},{id:"sibambai-engg",categories:["Living Heritage","Lettering"],title:"Si Bambai & British Engineering Co.",images:["./images/sibambai-mural.jpg","./images/british-engg.jpg"],description:`A large mural on the facade of Si Bambai, a performance art space supporting emerging artists, situated above the faded "British Engineering Co." signagea relic of the area's industrial trading history.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833944,18.9285]}},{id:"great-western",category:"Neoclassical",title:"Great Western Building",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/Entrance_view_of_Great_Western_Building%2C_Fort%2C_Mumbai.jpg/960px-Entrance_view_of_Great_Western_Building%2C_Fort%2C_Mumbai.jpg",description:"Originally the Admiralty House (1770s).",year:"1770",architect:"Unknown",builder:"British Admiralty",location:{center:[72.8329,18.9285]}},{id:"new-era",category:"Lettering",title:"New Era Engineering Co.",image:"./images/new-era.jpg",description:"A specialized engineering supply store established in 1981, known for its distinctive red block lettering signage featuring heritage industrial logos.",year:"1981",architect:"N/A",builder:"New Era Engineering Co.",location:{center:[72.83262,18.9289]}},{id:"sheraton-co",category:"Lettering",title:"Sheraton & Co.",image:"./images/sheraton-co.jpg",description:'Faded vintage signage for "Sheraton & Co. - The Accepted Name for Quality Furniture Fittings". A relic of the old made-to-order furniture trade.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832667,18.928833]}},{id:"modern-machines",category:"Lettering",title:"Modern Machines (India)",image:"./images/modern-machines.jpg",description:"Hand-painted commercial signage at 129 Nagindas Master Road, featuring detailed technical illustrations of industrial lathe machines, drills, and presses.",year:"Unknown",architect:"N/A",builder:"Private",location:{center:[72.83271,18.92876]}},{id:"jaydeep-engg",category:"Lettering",title:"Jaydeep Engg. Co.",image:"./images/jaydeep-engg.jpg",description:"Hand-painted industrial signage featuring detailed technical illustrations of pumps, motors, and generators, reflecting the engineering trade history of the street.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832528,18.929056]}},{id:"other-horse",category:"Street Furniture",title:'The "Other" Black Horse',image:"./images/black-horse-small.jpg",description:'A lesser-known, smaller black horse statue located in a garden patch near the British Engineering Company buildings. Distinct from the famous "Spirit of Kala Ghoda" in the main precinct.',year:"Unknown",architect:"Unknown",builder:"Private Installation",location:{center:[72.833944,18.928361]}},{id:"bandukwala",category:"Vernacular",title:"Bandukwala Building",image:"./images/bandukwala.jpg",description:'A handsome heritage building featuring arched windows with decorative keystones and intricate pilasters, now housing legal chambers. Home to the "CS Legal" offices.',year:"Unknown",architect:"Unknown",builder:"Bandukwala Family",location:{center:[72.833583,18.928917]}},{id:"sewing-mural",category:"Living Heritage",title:"Sewing Machine Mural",image:"./images/sewing-mural.jpg",description:"A whimsical large-scale mural by artist Shashi, depicting a vintage sewing machine intertwining with nature (#stitchinglivestogether). Located above a fashion boutique.",year:"Unknown",architect:"Shashi",builder:"Private",location:{center:[72.833861,18.928972]}},{id:"ice-cream-mural",category:"Living Heritage",title:"Ice Cream Mural",image:"./images/ice-cream-mural.jpg",description:"A vibrant, retro-styled street art mural featuring a pin-up figure and colorful ice cream motifs, located near Valliyan. A popular backdrop that adds to the artistic pulse of the Kala Ghoda precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832389,18.92825]}},{id:"artisans-mural",category:"Living Heritage",title:"Artisans Gallery Facade",image:"./images/artisans-mural.jpg",description:"A striking monochromatic mural with yellow accents covering the facade of Artisans Gallery. The artwork celebrates craftsmanship, depicting hands engaged in pottery, painting, and other traditional arts.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.83242,18.92828]}},{id:"jatin-malik-mural",category:"Living Heritage",title:"Spirit of Kala Ghoda Mural",image:"./images/jatin-malik-mural.jpg",description:'A vibrant mural on the yellow facade of the Jatin Malik store, featuring a stylized, colorful horse in motiona direct artistic homage to the "Kala Ghoda" (Black Horse) identity of the precinct.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832139,18.928278]}},{id:"sopara-mural",category:"Living Heritage",title:"Ancient Trade Route Mural",image:"./images/sopara-mural.jpg",description:'A detailed vertical tile mural titled "Berenike - Anchored in Ancient Trade - Sopara", illustrating the historic maritime connection between Egypt (Berenike) and the ancient port of Sopara near Mumbai.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.8338,18.927283]}},{id:"mehta-house",category:"Lettering",title:"Mehta House Signage",image:"./images/mehta-house.jpg",description:"Features striking 3D shadow-effect lettering typical of the mid-20th century commercial art style.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833833,18.929194]}},{id:"east-west",categories:["Lettering","Ghost Site"],title:"East & West Building",images:["./images/east-west.jpg","./images/ring-co.jpg"],description:'Heritage stone inscription on the facade of the East & West Insurance Building. A fragmented sign reading "...RING CO." is also visible above the Bhaveshwar Copy Center, hinting at a former industrial or engineering tenant.',year:"Unknown",architect:"Unknown",builder:"East & West Insurance Co.",location:{center:[72.833583,18.929972]}},{id:"vernacular-facade",category:"Vernacular",title:"Late 19th Century Vernacular Facade",image:"./images/wooden-facade.jpg",description:"A rare partially-preserved example of the vernacular architectural style once common in Fort. Features intricate wooden jali balconies and corbelled brackets.",year:"Unknown",architect:"Unknown",builder:"Local Craftsmen",location:{center:[72.8325,18.929194]}},{id:"wooden-terraces",category:"Vernacular",title:"Vernacular Wooden Terraces",image:"./images/wooden-terraces.jpg",description:"A striking multi-story wooden facade featuring deep cantilevered balconies, decorative railings, and support brackets, housing the Kalamkari Design Studio.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.834,18.931278]}},{id:"ornate-window",category:"Urban Texture",title:"Ornate Window Grille",image:"./images/ornate-window.jpg",description:"A beautifully preserved window featuring complex geometric metal or wood work, representing the residential architectural fabric of the precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833111,18.928417]}},{id:"marine-diesel",category:"Lettering",title:"Marine Diesel Signage",image:"./images/marine-diesel.jpg",description:'Comprehensive hand-painted trade signage for "Marine Diesel Engines & Spares" at Kirti Building, listing heritage mechanical brands like Lister, Ruston, and Kirloskar.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833194,18.928417]}},{id:"gujerat-mill",category:"Lettering",title:"The Gujerat Mill Store",image:"./images/gujerat-mill.jpg",description:'Distinctive mid-century corporate signage featuring a stylized "G" logo and metal lettering on a textured plaster facade.',year:"Unknown",architect:"N/A",builder:"Private",location:{center:[72.833139,18.928389]}},{id:"rampart-chowky",category:"Victorian",title:"Rampart Beat Chowky",image:"./images/rampart-chowky.jpg",description:"A small stone police outpost with heritage architectural details, including a cornice and stone brackets, guarding the entrance to Rampart Row.",year:"Unknown",architect:"Public Works Dept",builder:"Govt. of Bombay",location:{center:[72.832361,18.9275]}},{id:"allahabad-bank",category:"Neoclassical",title:"Allahabad Bank Building",image:"./images/allahabad-bank.jpg",description:"A grand Neo-Classical banking hall (now Indian Bank) featuring a prominent corner entrance, Corinthian pilasters, and heavy stone detailing.",year:"Unknown",architect:"Unknown",builder:"Allahabad Bank",location:{center:[72.834,18.93125]}},{id:"sbi-fort",category:"Neoclassical",title:"SBI Main Branch (Fort)",image:"./images/sbi-fort-branch.jpg",description:"A massive colonial-era banking structure with colossal Ionic columns and a pedimented entrance, originally the Imperial Bank of India.",year:"1924",architect:"Unknown",builder:"Imperial Bank",location:{center:[72.834,18.931306]}},{id:"sbi-roman",category:"Lettering",title:"MCMXXIV Date Plaque",image:"./images/sbi-mcmxxiv.jpg",description:"The Roman numeral MCMXXIV (1924) carved in bold relief gold-painted serif lettering on the stone entablature, marking the buildings completion year.",year:"1924",architect:"Unknown",builder:"Imperial Bank",location:{center:[72.834028,18.931333]}},{id:"a-doshi",categories:["Lettering"],title:"A. Doshi & Co.",images:["./images/a-doshi-sign.jpg"],description:'Classic commercial signage with bold relief lettering, accompanied by a diamond-shaped plaque reading "ESTD 1940".',year:"1940",architect:"Unknown",builder:"Private",location:{center:[72.83375,18.931333]}},{id:"ewart-house",categories:["Lettering","Ghost Site"],title:"Ewart House Lettering",image:"./images/ewart-house.jpg",description:`Carved "EWART HOUSE" lettering on the stone facade above the Central Bank of India. A subtle reminder of the building's identity.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833083,18.931361]}},{id:"bruce-street",categories:["Street Sign","Ghost Site"],title:"Old Bruce Street Sign",images:["./images/bruce-street-sign.jpg"],description:'A rare painted sign for "10, BRUCE STREET" (now Homi Modi Street) preserved on a building facade, a tangible reminder of the areas colonial nomenclature.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833556,18.931417]}},{id:"bse",category:"Modern",title:"Bombay Stock Exchange",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/BSE_-_Bombay_Stock_Exchange_Building.jpg/960px-BSE_-_Bombay_Stock_Exchange_Building.jpg",description:"The Phiroze Jeejeebhoy Towers.",year:"1980",architect:"Chandrakant Patel",builder:"BSE",location:{center:[72.8336,18.9297]}},{id:"dalal-signs",category:"Street Sign",title:"Dalal Street Signs",images:["./images/dalal-street-black.jpg","./images/dalal-street-blue.jpg"],description:"Dalal Street is marked by distinctive municipal signage from different eras: a classic black cast-iron sign and a vintage blue enamel design, both serving as markers for the financial heart of Mumbai.",year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.833722,18.929722]}},{id:"darda-statue",category:"Street Furniture",title:"Jawaharlal Darda Statue",image:"./images/jawaharlal-darda.jpg",description:'A bronze bust honoring the freedom fighter and journalist Jawaharlal Darda, affectionately known as "Babuji".',year:"Unknown",architect:"Unknown",builder:"Public",location:{center:[72.833778,18.929889]}},{id:"carved-balconies",category:"Vernacular",title:"Ornate Stone Facade",image:"./images/carved-balconies.jpg",description:"A fine example of vernacular architecture featuring intricate stone jaali (lattice) work, heavy masonry brackets, and projecting balconies, characteristic of the mixed-use buildings in old Fort.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833778,18.929972]}},{id:"stone-arches",category:"Vernacular",title:"Stone Arched Facade",image:"./images/islamic-stone-arches.jpg",description:"Distinctive vernacular building featuring scalloped (cusped) stone arches and geometric perforated stone railings.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833833,18.93025]}},{id:"flora",category:"Street Furniture",title:"Flora Fountain",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/dd/Mumbai_03-2016_72_Flora_Fountain.jpg/960px-Mumbai_03-2016_72_Flora_Fountain.jpg",description:"An ornamental fountain at Hutatma Chowk.",year:"1864",architect:"R. Norman Shaw",builder:"Agri-Horticultural Soc",location:{center:[72.8317,18.9323]}},{id:"hutatma",categories:["Public Space","Street Furniture"],title:"Hutatma Smarak (Martyrs Memorial)",images:["./images/hutatma-statue.jpg","https://upload.wikimedia.org/wikipedia/commons/thumb/6/62/Hutatma_Chowk%2C_Mumbai_-_panoramio_(2).jpg/1280px-Hutatma_Chowk%2C_Mumbai_-_panoramio_(2).jpg"],description:"A memorial with a bronze statue of a laborer and a farmer, honoring the 106 martyrs of the Samyukta Maharashtra Samiti who died for the creation of the state.",year:"1961",architect:"Harish Talim",builder:"Govt. of Maharashtra",location:{center:[72.8316,18.93245]}},{id:"tram-tracks",category:"Ghost Site",title:"Tram Tracks",image:"./images/tram-tracks.jpg",description:"The tram tracks, hidden for more than six decades, were discovered during excavation in 2018. Mumbai's tram service began in 1874 and stopped in 1964. While horses were used to pull the trams earlier, they were replaced by electric engines in 1907. The network functioned from Colaba to Pydhonie via Crawford Market. The original tracks have been preserved at their original position.",year:"1874",architect:"BEC",builder:"Bombay Tramway Co.",location:{center:[72.831667,18.932583]}},{id:"central-bank",categories:["Neoclassical","Lettering"],title:"Central Bank of India",images:["./images/central-bank.jpg","./images/central-bank-lettering.jpg"],description:'A grand heritage building established in 1911 as one of the first truly Indian owned banks. The facade features prominent "CENTRAL BANK BUILDING" carved lettering curving around the corner.',year:"1911",architect:"Unknown",builder:"Sir Sorabji Pochkhanawala",location:{center:[72.83175,18.931722]}},{id:"bombay-house",categories:["Neoclassical","Lettering"],title:"Bombay House",images:["./images/bombay-house.jpg","./images/bombay-house-lettering.jpg"],description:'The global headquarters of the Tata Group since 1924. This colonial-era stone building is renowned for its understated elegance and the "BOMBAY HOUSE" gold lettering above the entrance arcade.',year:"1924",architect:"George Wittet",builder:"Tata Group",location:{center:[72.83268,18.931847]}},{id:"fire-hydrant",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/british-fire-hydrant.jpg",description:"A rare cast-iron fire hydrant from the British colonial era, painted bright red. These sturdy relics of civic infrastructure are disappearing but occasionally found on Forts sidewalks.",year:"Unknown",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.832944,18.9315]}},{id:"siddharth-college",category:"Victorian",title:"Siddharth College (Anand Bhavan)",image:"./images/siddharth-college.jpg",description:"A Grade II heritage structure (formerly Albert Building), acquired by Dr. B.R. Ambedkar in 1951 to house the first college of the People's Education Society.",year:"1900",architect:"Unknown",builder:"People's Education Society",location:{center:[72.832389,18.933889]}},{id:"davar-building",category:"Lettering",title:"Davar Building Lettering",image:"./images/davar-building.jpg",description:"Carved stone lettering above an arched entrance passage, exemplifying the bold typography of early 20th century commercial buildings in the Fort area.",year:"1900",architect:"Unknown",builder:"Private",location:{center:[72.831694,18.932222]}},{id:"sunder-woodwork",category:"Lettering",title:"Sunder Woodwork Signage",image:"./images/sunder-woodwork.jpg",description:'Art Deco style signage reading "WOOD SUNDER WORK" with dimensional lettering and a distinctive red outline, located above an arched stone entrance.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.831667,18.93225]}},{id:"cip-building",category:"Neoclassical",title:"ICP Fort Heritage (CIP Building)",image:"./images/cip-building.jpg",description:'A grand heritage building on Nagindas Master Road, originally constructed in 1913. The facade features a prominent pediment with the year "1913" carved in relief, along with decorative cornices and Corinthian-style pilasters. It currently houses the flagship store of fashion designer Sabyasachi.',year:"1913",architect:"Unknown",builder:"Private",location:{center:[72.833428,18.932456]}},{id:"standard-building",category:"Neoclassical",title:"Standard Building",image:"./images/standard-building.jpg",description:"Designed by F.W. Stevens and completed by his son Charles Stevens. A prime example of the Neo-Classical style on D.N. Road, featuring buff-coloured basalt and intricate carvings.",year:"1902",architect:"F.W. Stevens / Charles Stevens",builder:"Standard Life Assurance",location:{center:[72.8321,18.9339]}},{id:"un-pursram",category:"Living Heritage",title:"U.N. Pursram",image:"./images/un-pursram.jpg",description:"A historic department store housed within the Standard Building arcade, serving Mumbai since the mid-20th century.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832556,18.934111]}},{id:"un-pursram-lettering",category:"Lettering",title:"U.N. Pursram Signage",image:"./images/un-pursram.jpg",description:"The distinctive oval signage of U.N. Pursram, a classic example of commercial typography on D.N. Road.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.83258,18.93414]}},{id:"thomas-cook",category:"Neoclassical",title:"Thomas Cook Building",image:"./images/thomas-cook-building.jpg",description:"A distinguished Grade II-A heritage structure featuring Classical elements like Corinthian columns and arched windows. Originally the Indian headquarters for Eastman Kodak.",year:"1900",architect:"Unknown",builder:"Eastman Kodak",location:{center:[72.832611,18.934167]}},{id:"jn-petit",category:"Victorian",title:"J.N. Petit Institute",image:"./images/jn-petit.jpg",description:"A magnificent Neo-Gothic library and reading room built in 1898. Its facade features polychromatic stone, stained glass, and pointed arches. Recipient of a UNESCO Heritage Award.",year:"1898",architect:"Merwanjee Bana",builder:"Petit Family",location:{center:[72.832639,18.934194]}},{id:"fort-gate",category:"Victorian",title:"Fort Gate Remnant",image:"./images/fort-gate-remnant.jpg",description:"A surviving basalt stone archway, likely a remnant from the original Fort walls demolished in the 1860s. Now integrated into the urban fabric near DN Road.",year:"1860",architect:"British Military Engineers",builder:"Public Works",location:{center:[72.832361,18.933667]}},{id:"booksellers",category:"Living Heritage",title:"Secondhand Book Sellers",image:"./images/books.jpg",description:"The lineage of street book vendors near Flora Fountain.",year:"1950",architect:"N/A",builder:"Vendor Collective",location:{center:[72.8315,18.9325]}},{id:"rbi-rupee",category:"Street Furniture",title:"RBI Rupee Installation",image:"./images/rbi-rupee.jpg",description:"A large golden installation of the Indian Rupee symbol () accompanied by coin motifs, located outside the Reserve Bank of India.",year:"2010",architect:"RBI",builder:"RBI",location:{center:[72.83709,18.932943]}},{id:"rbi-building",categories:["Modern","Street Furniture"],title:"Reserve Bank of India (Main Building)",images:["./images/rbi-building.jpg","./images/rbi-tiger.jpg"],description:"The headquarters of India's central bank. Completed in 1939, the building is a transition between Art Deco and Modernism. A prominent golden statue of the RBI tiger under a palm tree (based on the East India Company's Mohur) stands at the entrance.",year:"1939",architect:"J.A. Ritchie",builder:"Shapoorji Pallonji",location:{center:[72.83685,18.93285]}},{id:"mumbai-mint",category:"Neoclassical",title:"India Government Mint",image:"./images/mumbai-mint.jpg",description:"Established in 1829, the Mumbai Mint is one of the oldest in India. The building is a fine example of Neoclassical architecture, featuring a grand basalt stone facade.",year:"1829",architect:"Major John Hawkins",builder:"British Government",location:{center:[72.836556,18.933361]}},{id:"bhagatsingh-road-sign",category:"Street Sign",title:"Shahid Bhagat Singh Road Sign",image:"./images/bhagatsingh-road-sign.jpg",description:"A classic blue municipal street sign marking Shahid Bhagat Singh Road (formerly Colaba Causeway). The decorative ironwork scroll on the post is a characteristic feature of Mumbai's heritage street signage.",year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.836139,18.932889]}},{id:"fire-hydrant-sbs",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/hydrant-sbs.jpg",description:"A weathered cast-iron fire hydrant from the British colonial era, located along Shahid Bhagat Singh Road. These hexagonal pillars remain as silent sentinels of the city's 19th-century water infrastructure.",year:"1890",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.835806,18.932583]}},{id:"fire-hydrant-dn",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/hydrant-dn-road.jpg",description:"A tall, cylindrical cast-iron fire hydrant with a rounded cap, located within the heritage arcade on Dadabhai Naoroji Road. This red-oxide painted relic is part of Mumbai's historic fire-fighting infrastructure.",year:"1890",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.834306,18.93225]}},{id:"standard-monograms",category:"Lettering",title:"Heritage Monograms",images:["./images/monogram-hb.jpg","./images/monogram-mb.jpg"],description:'Intricate monograms carved into the stone balconies of the Standard Building on D.N. Road. These stylized "HB" and "MB" initials are a testament to the craftsmanship and personal branding of the early 20th-century architects and builders.',year:"1902",architect:"F.W. Stevens",builder:"Standard Life Assurance",location:{center:[72.834417,18.932056]}},{id:"gungadass-piyav",categories:["Street Furniture","Lettering"],title:"Gungadass Vizbhoocundass Piyav",images:["./images/gungadass-piyav.jpg","./images/gungadass-plaque-1841.jpg","./images/gungadass-plaque-1873.jpg"],description:"A historic water fountain (piyav) decorated with red jaali work. The inscriptions in multiple scripts (English, Gujarati, Marathi, Urdu) commemorate its erection in 1841 by Gungadass Vizbhoocundass and a subsequent addition in 1873 by his widow, Bai Manchooverbai.",year:"1841",architect:"Unknown",builder:"Gungadass Vizbhoocundass",location:{center:[72.834389,18.932028]}},{id:"ryrie-building",categories:["Neoclassical","Lettering"],title:"Ryrie's Building (Galeries Lafayette)",images:["./images/ryrie-building.jpg","./images/ryrie-monogram.jpg"],description:`A grand heritage building on D.N. Road, recently restored to house Galeries Lafayette. The stone facade features intricate Neoclassical details, including the original "RY" monogram carved into the masonry, signifying its history as the Ryrie's building.`,year:"1900",architect:"Unknown",builder:"Ryrie & Co.",location:{center:[72.834693,18.930883]}},{id:"sbi-directory",category:"Lettering",title:"State Bank Building Directory",image:"./images/crawford-bayley-board.jpg",description:"A classic black directory board located at the entrance of the State Bank Building (formerly State Bank of India Commercial Branch). It features the names of historic tenants like Crawford Bayley & Co. and The Oriental Fire & General Insurance, rendered in crisp white lettering.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.834972,18.931083]}},{id:"keystone-heads",category:"Urban Texture",title:"Keystone Sculptures",image:"./images/keystone-heads.jpg",description:"Intricate sculpted heads (mascarons) adorning the keystones of the arches on this heritage faade. These bearded faces, possibly depicting European or mythological figures, watch over the street from above the shopfronts (currently Bademiya).",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835194,18.931444]}},{id:"oriental-building",category:"Victorian",title:"Oriental Building",image:"./images/oriental-building.jpg",description:`A magnificent Venetian Gothic structure completed in 1885. Its facade is a masterpiece of stone carving, featuring prominent arches, decorative balconies, and the signature "mascaron" heads on its keystones. Originally built for the Oriental Life Assurance Company, it is now an iconic part of the Fort district's architectural fabric.`,year:"1885",architect:"Frederick William Stevens",builder:"Oriental Life Assurance",location:{center:[72.835194,18.931444]}},{id:"bmc-plaque-horniman",category:"Street Sign",title:"BMC Garden Plaque",image:"./images/bmc-plaque-horniman.jpg",description:"The official colorful seal of the Brihanmumbai Municipal Corporation (BMC) mounted on the historic iron railings of Horniman Circle Garden. The seal features iconic Mumbai landmarks like the Gateway of India and a factory, representing the citys heritage and industry.",year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.835556,18.932167]}},{id:"asiatic-society",category:"Neoclassical",title:"Asiatic Society of Mumbai (Town Hall)",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/9/94/The_Asiatic_Society_of_Mumbai_in_May_2025.jpg/1024px-The_Asiatic_Society_of_Mumbai_in_May_2025.jpg",description:"Completed in 1833, the Town Hall is one of the most magnificent Neoclassical buildings in Mumbai. Inspired by Greek and Roman architecture, it features a grand portico with eight Doric columns and a famous flight of steps that serves as a popular public space.",year:"1833",architect:"Colonel Thomas Cowper",builder:"Government of Bombay",location:{center:[72.836155,18.931813]}},{id:"horniman-garden",category:"Public Space",title:"Horniman Circle Garden",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Mumbai%2C_giardini_di_horniman_circle%2C_03.jpg/1024px-Mumbai%2C_giardini_di_horniman_circle%2C_03.jpg",description:"A historic park at the center of Horniman Circle, originally known as Elphinstone Circle. Laid out in 1872, the garden is a rare example of circular urban planning in Mumbai, surrounded by palm trees and grand Victorian buildings. It remains a tranquil green lung in the heart of the business district.",year:"1872",architect:"Unknown",builder:"Govt. of Bombay",location:{center:[72.835007,18.931907]}},{id:"bharat-insurance",categories:["Neoclassical","Lettering"],title:"Bharat Insurance Building",images:["./images/bharat-insurance.jpg","./images/bharat-insurance-lettering.jpg"],description:'A stately Neoclassical building on Horniman Circle. The facade features a graceful curve, recurring arched windows with decorative "mascaron" keystone heads, and prominent raised lettering for the "BHARAT INSURANCE BUILDING". It currently houses the flagship Hermes store, blending historic grandeur with modern luxury.',year:"Unknown",architect:"Unknown",builder:"Bharat Insurance Co.",location:{center:[72.835815,18.933329]}},{id:"hc-dinshaw-building",categories:["Neoclassical","Lettering"],title:"Sir H.C. Dinshaw Building",images:["./images/hc-dinshaw-building.jpg","./images/hc-dinshaw-lettering.jpg"],description:`A grand heritage building on Horniman Circle, part of the precinct's iconic curved architecture. The facade is adorned with intricate stone carvings, including "mascaron" heads on the window keystones. Notable gold-engraved lettering above the entrance and within the archways bears the name "SIR H. C. DINSHAW BUILDING".`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835373,18.932915]}},{id:"mumbai-samachar",categories:["Victorian","Lettering","Living Heritage"],title:"Mumbai Samachar Building",images:["./images/mumbai-samachar.jpg","./images/mumbai-samachar-lettering.jpg"],description:"The home of Asia's oldest continuously published newspaper (est. 1822). This striking red-brick building is a landmark of Mumbai's journalism history. The facade is a fine example of Victorian commercial architecture, featuring multilingual signage and elegant arched windows.",year:"1822",architect:"Unknown",builder:"Cama Family",location:{center:[72.834456,18.93282]}},{id:"elphinstone-building",categories:["Victorian","Lettering"],title:"Elphinstone Building",images:["./images/elphinstone-building.jpg","./images/elphinstone-lettering.jpg"],description:'A stately Victorian Gothic building with prominent arched windows and intricate stone ornamentation. The facade features the "ELPHINSTONE BUILDING" nameplate carved into the masonry. Today, it stands as a prime example of the 19th-century commercial grandness of the Fort district, housing modern retail like Starbucks.',year:"1870",architect:"James Trubshawe",builder:"Unknown",location:{center:[72.834229,18.933358]}},{id:"brady-house",categories:["Neoclassical","Lettering"],title:"Brady House",images:["./images/brady-house.jpg","./images/brady-house-lettering.jpg"],description:`An elegant heritage building featuring a distinctive shield-shaped pediment with the "BRADY HOUSE" nameplate. The structure displays refined architectural detailing with arched windows and a symmetrical facade, characteristic of early 20th-century commercial buildings in Mumbai's business district.`,year:"Unknown",architect:"Unknown",builder:"W.H. Brady & Co.",location:{center:[72.833778,18.932474]}},{id:"pardiwala-sign",categories:["Lettering","Ghost Site"],title:"Pardiwala Paper Mart Sign",image:"./images/pardiwala-paper.jpg",description:`A weathered wooden sign with bold relief lettering for "PARDIWALA PAPER MART", hanging under a stone Gothic arch. A classic example of Mumbai's historic commercial signage and a "ghost site" of a former paper trading business.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.834335,18.932354]}},{id:"1923-lettering",category:"Lettering",title:"1923 Lettering",image:"./images/lettering-north-fort.jpg",description:'Carved stone lettering displaying the year "1923" adorned with decorative floral motifs.',year:"1923",architect:"Unknown",builder:"Private",location:{center:[72.833889,18.935944]}},{id:"readymoney-mansion",categories:["Vernacular","Lettering"],title:"Readymoney Mansion",images:["./images/readymoney-mansion-building.jpg","./images/readymoney-mansion-lettering.jpg"],description:'A striking heritage building featuring a stone facade and intricate wooden balconies. The name "READYMONEY MANSION" is carved in bold relief above the entrance.',year:"Unknown",architect:"Unknown",builder:"Readymoney Family",location:{center:[72.830534,18.931944]}},{id:"churchgate-house",categories:["Lettering","Victorian"],title:"Churchgate House Lettering",image:"./images/churchgate-house-lettering.jpg",description:'Classic serif lettering for "CHURCHGATE HOUSE" mounted on the stone facade of a heritage building, now housing a modern bank branch.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832911,18.932546]}},{id:"elite-shopping-centre",category:"Lettering",title:"Elite Shopping Centre Signage",image:"./images/elite-shopping-centre-lettering.jpg",description:'A vibrant arched blue sign for the "ELITE SHOPPING CENTRE" marking a busy commercial passage on Nariman Road.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832917,18.93225]}},{id:"rustom-building",categories:["Lettering","Victorian"],title:"Rustom Building Lettering",image:"./images/rustom-building-lettering.jpg",description:`Bold relief lettering for "RUSTOM BUILDING" set against a stone facade. The building features decorative iron balconies and classic stone detailing, characteristic of the district's commercial heritage.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833245,18.932614]}},{id:"st-thomas-cathedral",categories:["Victorian","Lettering"],title:"St. Thomas Cathedral",images:["./images/st-thomas-building.jpg","./images/st-thomas-lettering.jpg"],description:"The first Anglican church in Mumbai, consecrated in 1718. A landmark of colonial architecture, it gave its name to the nearby Churchgate station. The cathedral features a blend of Gothic and Neoclassical styles with a distinctive white tower.",year:"1718",architect:"Unknown",builder:"East India Company",location:{center:[72.833599,18.932995]}},{id:"fish-relief-wall",category:"Urban Texture",title:"Fish & Star Reliefs",image:"./images/fish-relief-wall.jpg",description:"A unique vernacular detail featuring red-painted relief sculptures of stars and two fish meeting head-to-head on the gable wall of a building in the Fort precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.8335,18.932972]}},{id:"heritage-balconies-fort",category:"Vernacular",title:"Heritage Balconies",image:"./images/heritage-balconies-fort.jpg",description:"A striking example of early 20th-century residential architecture in Fort, featuring ornate wrought-iron balconies, a Greek-key pattern frieze, and classic stone facing.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833389,18.932889]}},{id:"fire-hydrant-mcgb",category:"Street Furniture",title:"MCGB Fire Hydrant",image:"./images/fire-hydrant-mcgb.jpg",description:`A classic cylindrical cast-iron fire hydrant with the inscription "MCGB" (Municipal Corporation of Greater Bombay) and "IS 908", reflecting the city's municipal infrastructure history.`,year:"Unknown",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.833333,18.932694]}},{id:"yazdani-bakery",categories:["Living Heritage","Lettering","Vernacular"],title:"Yazdani Restaurant & Bakery",images:["./images/yazdani-bakery-facade.jpg","./images/yazdani-bakery-sign.jpg","./images/yazdani-la-boulangerie.jpg"],description:"An iconic Iranian bakery and restaurant established in 1953, housed in a charming colonial-era structure with a distinctive red-trim gabled roof. Famous for its ginger biscuits, brun maska, and wood-fired ovens.",year:"1953",architect:"Unknown",builder:"Zend Meherwan Abadan",location:{center:[72.833699,18.933451]}},{id:"french-bank-building",categories:["Lettering","Ghost Site"],title:"French Bank Building Signage",image:"./images/french-bank-building.jpg",description:`Prominent sans-serif lettering for the "FRENCH BANK BUILDING" above the entrance. To the right, a faint "BNP" ghost sign is visible on the facade, a relic of the building's former life as the Mumbai headquarters for the French bank BNP Paribas.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835043,18.933314]}},{id:"gool-mansion",category:"Lettering",title:"Gool Mansion Lettering",image:"./images/gool-mansion-lettering.jpg",description:'Art Deco style gold lettering on a red granite plaque marking "GOOL MANSION", integrated into the facade of this heritage residential building on Nariman Road.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835087,18.934023]}},{id:"fluted-facade-plant",categories:["Neoclassical","Urban Texture"],title:"Fluted Heritage Facade",image:"./images/baroda-facade-plant.jpg",description:"A grand heritage facade featuring monumental fluted pilasters. A young Ficus tree has taken root in the decorative iron balcony, a common sight where nature reclaims the masonry joints of the Fort precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.83525,18.933417]}},{id:"hydrant",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/hydrant.jpg",description:"A hexagonal cast-iron fire hydrant, a sturdy relic of the colonial municipal water infrastructure.",year:"1895",architect:"BMC",builder:"Foundry Cast",location:{center:[72.831917,18.928139]}},{id:"kerbstones",category:"Urban Texture",title:"Kurla Basalt Kerbstones",image:"./images/kurla-basalt.jpg",description:"Original massive blocks of grey Kurla basalt lining the pavement.",year:"1880",architect:"City Engineers",builder:"Public Works",location:{center:[72.832,18.9275]}}];function $E(e){var t,i,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(i=$E(e[t]))&&(a&&(a+=" "),a+=i)}else for(i in e)e[i]&&(a&&(a+=" "),a+=i);return a}function HE(){for(var e,t,i=0,a="",h=arguments.length;i<h;i++)(e=arguments[i])&&(t=$E(e))&&(a&&(a+=" "),a+=t);return a}const UB=(e,t)=>{const i=new Array(e.length+t.length);for(let a=0;a<e.length;a++)i[a]=e[a];for(let a=0;a<t.length;a++)i[e.length+a]=t[a];return i},$B=(e,t)=>({classGroupId:e,validator:t}),GE=(e=new Map,t=null,i)=>({nextPart:e,validators:t,classGroupId:i}),Nm="-",fS=[],HB="arbitrary..",GB=e=>{const t=qB(e),{conflictingClassGroups:i,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:p=>{if(p.startsWith("[")&&p.endsWith("]"))return WB(p);const c=p.split(Nm),S=c[0]===""&&c.length>1?1:0;return WE(c,S,t)},getConflictingClassGroupIds:(p,c)=>{if(c){const S=a[p],E=i[p];return S?E?UB(E,S):S:E||fS}return i[p]||fS}}},WE=(e,t,i)=>{if(e.length-t===0)return i.classGroupId;const h=e[t],g=i.nextPart.get(h);if(g){const E=WE(e,t+1,g);if(E)return E}const p=i.validators;if(p===null)return;const c=t===0?e.join(Nm):e.slice(t).join(Nm),S=p.length;for(let E=0;E<S;E++){const P=p[E];if(P.validator(c))return P.classGroupId}},WB=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const t=e.slice(1,-1),i=t.indexOf(":"),a=t.slice(0,i);return a?HB+a:void 0})(),qB=e=>{const{theme:t,classGroups:i}=e;return ZB(i,t)},ZB=(e,t)=>{const i=GE();for(const a in e){const h=e[a];$x(h,i,a,t)}return i},$x=(e,t,i,a)=>{const h=e.length;for(let g=0;g<h;g++){const p=e[g];XB(p,t,i,a)}},XB=(e,t,i,a)=>{if(typeof e=="string"){KB(e,t,i);return}if(typeof e=="function"){YB(e,t,i,a);return}JB(e,t,i,a)},KB=(e,t,i)=>{const a=e===""?t:qE(t,e);a.classGroupId=i},YB=(e,t,i,a)=>{if(QB(e)){$x(e(a),t,i,a);return}t.validators===null&&(t.validators=[]),t.validators.push($B(i,e))},JB=(e,t,i,a)=>{const h=Object.entries(e),g=h.length;for(let p=0;p<g;p++){const[c,S]=h[p];$x(S,qE(t,c),i,a)}},qE=(e,t)=>{let i=e;const a=t.split(Nm),h=a.length;for(let g=0;g<h;g++){const p=a[g];let c=i.nextPart.get(p);c||(c=GE(),i.nextPart.set(p,c)),i=c}return i},QB=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,e4=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,i=Object.create(null),a=Object.create(null);const h=(g,p)=>{i[g]=p,t++,t>e&&(t=0,a=i,i=Object.create(null))};return{get(g){let p=i[g];if(p!==void 0)return p;if((p=a[g])!==void 0)return h(g,p),p},set(g,p){g in i?i[g]=p:h(g,p)}}},Q_="!",pS=":",t4=[],mS=(e,t,i,a,h)=>({modifiers:e,hasImportantModifier:t,baseClassName:i,maybePostfixModifierPosition:a,isExternal:h}),n4=e=>{const{prefix:t,experimentalParseClassName:i}=e;let a=h=>{const g=[];let p=0,c=0,S=0,E;const P=h.length;for(let H=0;H<P;H++){const te=h[H];if(p===0&&c===0){if(te===pS){g.push(h.slice(S,H)),S=H+1;continue}if(te==="/"){E=H;continue}}te==="["?p++:te==="]"?p--:te==="("?c++:te===")"&&c--}const k=g.length===0?h:h.slice(S);let I=k,G=!1;k.endsWith(Q_)?(I=k.slice(0,-1),G=!0):k.startsWith(Q_)&&(I=k.slice(1),G=!0);const Z=E&&E>S?E-S:void 0;return mS(g,G,I,Z)};if(t){const h=t+pS,g=a;a=p=>p.startsWith(h)?g(p.slice(h.length)):mS(t4,!1,p,void 0,!0)}if(i){const h=a;a=g=>i({className:g,parseClassName:h})}return a},r4=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((i,a)=>{t.set(i,1e6+a)}),i=>{const a=[];let h=[];for(let g=0;g<i.length;g++){const p=i[g],c=p[0]==="[",S=t.has(p);c||S?(h.length>0&&(h.sort(),a.push(...h),h=[]),a.push(p)):h.push(p)}return h.length>0&&(h.sort(),a.push(...h)),a}},i4=e=>({cache:e4(e.cacheSize),parseClassName:n4(e),sortModifiers:r4(e),...GB(e)}),s4=/\s+/,o4=(e,t)=>{const{parseClassName:i,getClassGroupId:a,getConflictingClassGroupIds:h,sortModifiers:g}=t,p=[],c=e.trim().split(s4);let S="";for(let E=c.length-1;E>=0;E-=1){const P=c[E],{isExternal:k,modifiers:I,hasImportantModifier:G,baseClassName:Z,maybePostfixModifierPosition:H}=i(P);if(k){S=P+(S.length>0?" "+S:S);continue}let te=!!H,L=a(te?Z.substring(0,H):Z);if(!L){if(!te){S=P+(S.length>0?" "+S:S);continue}if(L=a(Z),!L){S=P+(S.length>0?" "+S:S);continue}te=!1}const V=I.length===0?"":I.length===1?I[0]:g(I).join(":"),W=G?V+Q_:V,re=W+L;if(p.indexOf(re)>-1)continue;p.push(re);const pe=h(L,te);for(let _e=0;_e<pe.length;++_e){const le=pe[_e];p.push(W+le)}S=P+(S.length>0?" "+S:S)}return S},a4=(...e)=>{let t=0,i,a,h="";for(;t<e.length;)(i=e[t++])&&(a=ZE(i))&&(h&&(h+=" "),h+=a);return h},ZE=e=>{if(typeof e=="string")return e;let t,i="";for(let a=0;a<e.length;a++)e[a]&&(t=ZE(e[a]))&&(i&&(i+=" "),i+=t);return i},l4=(e,...t)=>{let i,a,h,g;const p=S=>{const E=t.reduce((P,k)=>k(P),e());return i=i4(E),a=i.cache.get,h=i.cache.set,g=c,c(S)},c=S=>{const E=a(S);if(E)return E;const P=o4(S,i);return h(S,P),P};return g=p,(...S)=>g(a4(...S))},c4=[],kr=e=>{const t=i=>i[e]||c4;return t.isThemeGetter=!0,t},XE=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,KE=/^\((?:(\w[\w-]*):)?(.+)\)$/i,u4=/^\d+\/\d+$/,h4=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,d4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,f4=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,p4=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,m4=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Fc=e=>u4.test(e),sn=e=>!!e&&!Number.isNaN(Number(e)),ya=e=>!!e&&Number.isInteger(Number(e)),Sv=e=>e.endsWith("%")&&sn(e.slice(0,-1)),wo=e=>h4.test(e),g4=()=>!0,y4=e=>d4.test(e)&&!f4.test(e),YE=()=>!1,v4=e=>p4.test(e),_4=e=>m4.test(e),x4=e=>!At(e)&&!Mt(e),b4=e=>Mu(e,eP,YE),At=e=>XE.test(e),vl=e=>Mu(e,tP,y4),kv=e=>Mu(e,C4,sn),gS=e=>Mu(e,JE,YE),w4=e=>Mu(e,QE,_4),Dp=e=>Mu(e,nP,v4),Mt=e=>KE.test(e),Yh=e=>Du(e,tP),S4=e=>Du(e,E4),yS=e=>Du(e,JE),k4=e=>Du(e,eP),T4=e=>Du(e,QE),zp=e=>Du(e,nP,!0),Mu=(e,t,i)=>{const a=XE.exec(e);return a?a[1]?t(a[1]):i(a[2]):!1},Du=(e,t,i=!1)=>{const a=KE.exec(e);return a?a[1]?t(a[1]):i:!1},JE=e=>e==="position"||e==="percentage",QE=e=>e==="image"||e==="url",eP=e=>e==="length"||e==="size"||e==="bg-size",tP=e=>e==="length",C4=e=>e==="number",E4=e=>e==="family-name",nP=e=>e==="shadow",P4=()=>{const e=kr("color"),t=kr("font"),i=kr("text"),a=kr("font-weight"),h=kr("tracking"),g=kr("leading"),p=kr("breakpoint"),c=kr("container"),S=kr("spacing"),E=kr("radius"),P=kr("shadow"),k=kr("inset-shadow"),I=kr("text-shadow"),G=kr("drop-shadow"),Z=kr("blur"),H=kr("perspective"),te=kr("aspect"),L=kr("ease"),V=kr("animate"),W=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],pe=()=>[...re(),Mt,At],_e=()=>["auto","hidden","clip","visible","scroll"],le=()=>["auto","contain","none"],ce=()=>[Mt,At,S],De=()=>[Fc,"full","auto",...ce()],Be=()=>[ya,"none","subgrid",Mt,At],Ce=()=>["auto",{span:["full",ya,Mt,At]},ya,Mt,At],Fe=()=>[ya,"auto",Mt,At],ze=()=>["auto","min","max","fr",Mt,At],Qe=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Ze=()=>["start","end","center","stretch","center-safe","end-safe"],Je=()=>["auto",...ce()],$e=()=>[Fc,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...ce()],ke=()=>[e,Mt,At],Ue=()=>[...re(),yS,gS,{position:[Mt,At]}],et=()=>["no-repeat",{repeat:["","x","y","space","round"]}],pt=()=>["auto","cover","contain",k4,b4,{size:[Mt,At]}],Le=()=>[Sv,Yh,vl],Ve=()=>["","none","full",E,Mt,At],We=()=>["",sn,Yh,vl],He=()=>["solid","dashed","dotted","double"],_t=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],tt=()=>[sn,Sv,yS,gS],dt=()=>["","none",Z,Mt,At],Pt=()=>["none",sn,Mt,At],Ut=()=>["none",sn,Mt,At],Ft=()=>[sn,Mt,At],at=()=>[Fc,"full",...ce()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[wo],breakpoint:[wo],color:[g4],container:[wo],"drop-shadow":[wo],ease:["in","out","in-out"],font:[x4],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[wo],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[wo],shadow:[wo],spacing:["px",sn],text:[wo],"text-shadow":[wo],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Fc,At,Mt,te]}],container:["container"],columns:[{columns:[sn,At,Mt,c]}],"break-after":[{"break-after":W()}],"break-before":[{"break-before":W()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:pe()}],overflow:[{overflow:_e()}],"overflow-x":[{"overflow-x":_e()}],"overflow-y":[{"overflow-y":_e()}],overscroll:[{overscroll:le()}],"overscroll-x":[{"overscroll-x":le()}],"overscroll-y":[{"overscroll-y":le()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:De()}],"inset-x":[{"inset-x":De()}],"inset-y":[{"inset-y":De()}],start:[{start:De()}],end:[{end:De()}],top:[{top:De()}],right:[{right:De()}],bottom:[{bottom:De()}],left:[{left:De()}],visibility:["visible","invisible","collapse"],z:[{z:[ya,"auto",Mt,At]}],basis:[{basis:[Fc,"full","auto",c,...ce()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[sn,Fc,"auto","initial","none",At]}],grow:[{grow:["",sn,Mt,At]}],shrink:[{shrink:["",sn,Mt,At]}],order:[{order:[ya,"first","last","none",Mt,At]}],"grid-cols":[{"grid-cols":Be()}],"col-start-end":[{col:Ce()}],"col-start":[{"col-start":Fe()}],"col-end":[{"col-end":Fe()}],"grid-rows":[{"grid-rows":Be()}],"row-start-end":[{row:Ce()}],"row-start":[{"row-start":Fe()}],"row-end":[{"row-end":Fe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ze()}],"auto-rows":[{"auto-rows":ze()}],gap:[{gap:ce()}],"gap-x":[{"gap-x":ce()}],"gap-y":[{"gap-y":ce()}],"justify-content":[{justify:[...Qe(),"normal"]}],"justify-items":[{"justify-items":[...Ze(),"normal"]}],"justify-self":[{"justify-self":["auto",...Ze()]}],"align-content":[{content:["normal",...Qe()]}],"align-items":[{items:[...Ze(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Ze(),{baseline:["","last"]}]}],"place-content":[{"place-content":Qe()}],"place-items":[{"place-items":[...Ze(),"baseline"]}],"place-self":[{"place-self":["auto",...Ze()]}],p:[{p:ce()}],px:[{px:ce()}],py:[{py:ce()}],ps:[{ps:ce()}],pe:[{pe:ce()}],pt:[{pt:ce()}],pr:[{pr:ce()}],pb:[{pb:ce()}],pl:[{pl:ce()}],m:[{m:Je()}],mx:[{mx:Je()}],my:[{my:Je()}],ms:[{ms:Je()}],me:[{me:Je()}],mt:[{mt:Je()}],mr:[{mr:Je()}],mb:[{mb:Je()}],ml:[{ml:Je()}],"space-x":[{"space-x":ce()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":ce()}],"space-y-reverse":["space-y-reverse"],size:[{size:$e()}],w:[{w:[c,"screen",...$e()]}],"min-w":[{"min-w":[c,"screen","none",...$e()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[p]},...$e()]}],h:[{h:["screen","lh",...$e()]}],"min-h":[{"min-h":["screen","lh","none",...$e()]}],"max-h":[{"max-h":["screen","lh",...$e()]}],"font-size":[{text:["base",i,Yh,vl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[a,Mt,kv]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Sv,At]}],"font-family":[{font:[S4,At,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[h,Mt,At]}],"line-clamp":[{"line-clamp":[sn,"none",Mt,kv]}],leading:[{leading:[g,...ce()]}],"list-image":[{"list-image":["none",Mt,At]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Mt,At]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:ke()}],"text-color":[{text:ke()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...He(),"wavy"]}],"text-decoration-thickness":[{decoration:[sn,"from-font","auto",Mt,vl]}],"text-decoration-color":[{decoration:ke()}],"underline-offset":[{"underline-offset":[sn,"auto",Mt,At]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ce()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Mt,At]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Mt,At]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Ue()}],"bg-repeat":[{bg:et()}],"bg-size":[{bg:pt()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ya,Mt,At],radial:["",Mt,At],conic:[ya,Mt,At]},T4,w4]}],"bg-color":[{bg:ke()}],"gradient-from-pos":[{from:Le()}],"gradient-via-pos":[{via:Le()}],"gradient-to-pos":[{to:Le()}],"gradient-from":[{from:ke()}],"gradient-via":[{via:ke()}],"gradient-to":[{to:ke()}],rounded:[{rounded:Ve()}],"rounded-s":[{"rounded-s":Ve()}],"rounded-e":[{"rounded-e":Ve()}],"rounded-t":[{"rounded-t":Ve()}],"rounded-r":[{"rounded-r":Ve()}],"rounded-b":[{"rounded-b":Ve()}],"rounded-l":[{"rounded-l":Ve()}],"rounded-ss":[{"rounded-ss":Ve()}],"rounded-se":[{"rounded-se":Ve()}],"rounded-ee":[{"rounded-ee":Ve()}],"rounded-es":[{"rounded-es":Ve()}],"rounded-tl":[{"rounded-tl":Ve()}],"rounded-tr":[{"rounded-tr":Ve()}],"rounded-br":[{"rounded-br":Ve()}],"rounded-bl":[{"rounded-bl":Ve()}],"border-w":[{border:We()}],"border-w-x":[{"border-x":We()}],"border-w-y":[{"border-y":We()}],"border-w-s":[{"border-s":We()}],"border-w-e":[{"border-e":We()}],"border-w-t":[{"border-t":We()}],"border-w-r":[{"border-r":We()}],"border-w-b":[{"border-b":We()}],"border-w-l":[{"border-l":We()}],"divide-x":[{"divide-x":We()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":We()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...He(),"hidden","none"]}],"divide-style":[{divide:[...He(),"hidden","none"]}],"border-color":[{border:ke()}],"border-color-x":[{"border-x":ke()}],"border-color-y":[{"border-y":ke()}],"border-color-s":[{"border-s":ke()}],"border-color-e":[{"border-e":ke()}],"border-color-t":[{"border-t":ke()}],"border-color-r":[{"border-r":ke()}],"border-color-b":[{"border-b":ke()}],"border-color-l":[{"border-l":ke()}],"divide-color":[{divide:ke()}],"outline-style":[{outline:[...He(),"none","hidden"]}],"outline-offset":[{"outline-offset":[sn,Mt,At]}],"outline-w":[{outline:["",sn,Yh,vl]}],"outline-color":[{outline:ke()}],shadow:[{shadow:["","none",P,zp,Dp]}],"shadow-color":[{shadow:ke()}],"inset-shadow":[{"inset-shadow":["none",k,zp,Dp]}],"inset-shadow-color":[{"inset-shadow":ke()}],"ring-w":[{ring:We()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:ke()}],"ring-offset-w":[{"ring-offset":[sn,vl]}],"ring-offset-color":[{"ring-offset":ke()}],"inset-ring-w":[{"inset-ring":We()}],"inset-ring-color":[{"inset-ring":ke()}],"text-shadow":[{"text-shadow":["none",I,zp,Dp]}],"text-shadow-color":[{"text-shadow":ke()}],opacity:[{opacity:[sn,Mt,At]}],"mix-blend":[{"mix-blend":[..._t(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":_t()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[sn]}],"mask-image-linear-from-pos":[{"mask-linear-from":tt()}],"mask-image-linear-to-pos":[{"mask-linear-to":tt()}],"mask-image-linear-from-color":[{"mask-linear-from":ke()}],"mask-image-linear-to-color":[{"mask-linear-to":ke()}],"mask-image-t-from-pos":[{"mask-t-from":tt()}],"mask-image-t-to-pos":[{"mask-t-to":tt()}],"mask-image-t-from-color":[{"mask-t-from":ke()}],"mask-image-t-to-color":[{"mask-t-to":ke()}],"mask-image-r-from-pos":[{"mask-r-from":tt()}],"mask-image-r-to-pos":[{"mask-r-to":tt()}],"mask-image-r-from-color":[{"mask-r-from":ke()}],"mask-image-r-to-color":[{"mask-r-to":ke()}],"mask-image-b-from-pos":[{"mask-b-from":tt()}],"mask-image-b-to-pos":[{"mask-b-to":tt()}],"mask-image-b-from-color":[{"mask-b-from":ke()}],"mask-image-b-to-color":[{"mask-b-to":ke()}],"mask-image-l-from-pos":[{"mask-l-from":tt()}],"mask-image-l-to-pos":[{"mask-l-to":tt()}],"mask-image-l-from-color":[{"mask-l-from":ke()}],"mask-image-l-to-color":[{"mask-l-to":ke()}],"mask-image-x-from-pos":[{"mask-x-from":tt()}],"mask-image-x-to-pos":[{"mask-x-to":tt()}],"mask-image-x-from-color":[{"mask-x-from":ke()}],"mask-image-x-to-color":[{"mask-x-to":ke()}],"mask-image-y-from-pos":[{"mask-y-from":tt()}],"mask-image-y-to-pos":[{"mask-y-to":tt()}],"mask-image-y-from-color":[{"mask-y-from":ke()}],"mask-image-y-to-color":[{"mask-y-to":ke()}],"mask-image-radial":[{"mask-radial":[Mt,At]}],"mask-image-radial-from-pos":[{"mask-radial-from":tt()}],"mask-image-radial-to-pos":[{"mask-radial-to":tt()}],"mask-image-radial-from-color":[{"mask-radial-from":ke()}],"mask-image-radial-to-color":[{"mask-radial-to":ke()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":re()}],"mask-image-conic-pos":[{"mask-conic":[sn]}],"mask-image-conic-from-pos":[{"mask-conic-from":tt()}],"mask-image-conic-to-pos":[{"mask-conic-to":tt()}],"mask-image-conic-from-color":[{"mask-conic-from":ke()}],"mask-image-conic-to-color":[{"mask-conic-to":ke()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Ue()}],"mask-repeat":[{mask:et()}],"mask-size":[{mask:pt()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Mt,At]}],filter:[{filter:["","none",Mt,At]}],blur:[{blur:dt()}],brightness:[{brightness:[sn,Mt,At]}],contrast:[{contrast:[sn,Mt,At]}],"drop-shadow":[{"drop-shadow":["","none",G,zp,Dp]}],"drop-shadow-color":[{"drop-shadow":ke()}],grayscale:[{grayscale:["",sn,Mt,At]}],"hue-rotate":[{"hue-rotate":[sn,Mt,At]}],invert:[{invert:["",sn,Mt,At]}],saturate:[{saturate:[sn,Mt,At]}],sepia:[{sepia:["",sn,Mt,At]}],"backdrop-filter":[{"backdrop-filter":["","none",Mt,At]}],"backdrop-blur":[{"backdrop-blur":dt()}],"backdrop-brightness":[{"backdrop-brightness":[sn,Mt,At]}],"backdrop-contrast":[{"backdrop-contrast":[sn,Mt,At]}],"backdrop-grayscale":[{"backdrop-grayscale":["",sn,Mt,At]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[sn,Mt,At]}],"backdrop-invert":[{"backdrop-invert":["",sn,Mt,At]}],"backdrop-opacity":[{"backdrop-opacity":[sn,Mt,At]}],"backdrop-saturate":[{"backdrop-saturate":[sn,Mt,At]}],"backdrop-sepia":[{"backdrop-sepia":["",sn,Mt,At]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":ce()}],"border-spacing-x":[{"border-spacing-x":ce()}],"border-spacing-y":[{"border-spacing-y":ce()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Mt,At]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[sn,"initial",Mt,At]}],ease:[{ease:["linear","initial",L,Mt,At]}],delay:[{delay:[sn,Mt,At]}],animate:[{animate:["none",V,Mt,At]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[H,Mt,At]}],"perspective-origin":[{"perspective-origin":pe()}],rotate:[{rotate:Pt()}],"rotate-x":[{"rotate-x":Pt()}],"rotate-y":[{"rotate-y":Pt()}],"rotate-z":[{"rotate-z":Pt()}],scale:[{scale:Ut()}],"scale-x":[{"scale-x":Ut()}],"scale-y":[{"scale-y":Ut()}],"scale-z":[{"scale-z":Ut()}],"scale-3d":["scale-3d"],skew:[{skew:Ft()}],"skew-x":[{"skew-x":Ft()}],"skew-y":[{"skew-y":Ft()}],transform:[{transform:[Mt,At,"","none","gpu","cpu"]}],"transform-origin":[{origin:pe()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:at()}],"translate-x":[{"translate-x":at()}],"translate-y":[{"translate-y":at()}],"translate-z":[{"translate-z":at()}],"translate-none":["translate-none"],accent:[{accent:ke()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:ke()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Mt,At]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ce()}],"scroll-mx":[{"scroll-mx":ce()}],"scroll-my":[{"scroll-my":ce()}],"scroll-ms":[{"scroll-ms":ce()}],"scroll-me":[{"scroll-me":ce()}],"scroll-mt":[{"scroll-mt":ce()}],"scroll-mr":[{"scroll-mr":ce()}],"scroll-mb":[{"scroll-mb":ce()}],"scroll-ml":[{"scroll-ml":ce()}],"scroll-p":[{"scroll-p":ce()}],"scroll-px":[{"scroll-px":ce()}],"scroll-py":[{"scroll-py":ce()}],"scroll-ps":[{"scroll-ps":ce()}],"scroll-pe":[{"scroll-pe":ce()}],"scroll-pt":[{"scroll-pt":ce()}],"scroll-pr":[{"scroll-pr":ce()}],"scroll-pb":[{"scroll-pb":ce()}],"scroll-pl":[{"scroll-pl":ce()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Mt,At]}],fill:[{fill:["none",...ke()]}],"stroke-w":[{stroke:[sn,Yh,vl,kv]}],stroke:[{stroke:["none",...ke()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},I4=l4(P4);function Yt(...e){return I4(HE(e))}const lg=$.forwardRef(({className:e,...t},i)=>Q.jsx("div",{ref:i,className:Yt("rounded-xl border border-border bg-card text-card-foreground shadow",e),...t}));lg.displayName="Card";const rP=$.forwardRef(({className:e,...t},i)=>Q.jsx("div",{ref:i,className:Yt("flex flex-col space-y-1.5 p-6",e),...t}));rP.displayName="CardHeader";const iP=$.forwardRef(({className:e,...t},i)=>Q.jsx("h3",{ref:i,className:Yt("font-semibold leading-none tracking-tight",e),...t}));iP.displayName="CardTitle";const A4=$.forwardRef(({className:e,...t},i)=>Q.jsx("p",{ref:i,className:Yt("text-sm text-neutral-500",e),...t}));A4.displayName="CardDescription";const cg=$.forwardRef(({className:e,...t},i)=>Q.jsx("div",{ref:i,className:Yt("p-6 pt-0",e),...t}));cg.displayName="CardContent";const M4=$.forwardRef(({className:e,...t},i)=>Q.jsx("div",{ref:i,className:Yt("flex items-center p-6 pt-0",e),...t}));M4.displayName="CardFooter";const vS=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,_S=HE,sP=(e,t)=>i=>{var a;if((t==null?void 0:t.variants)==null)return _S(e,i==null?void 0:i.class,i==null?void 0:i.className);const{variants:h,defaultVariants:g}=t,p=Object.keys(h).map(E=>{const P=i==null?void 0:i[E],k=g==null?void 0:g[E];if(P===null)return null;const I=vS(P)||vS(k);return h[E][I]}),c=i&&Object.entries(i).reduce((E,P)=>{let[k,I]=P;return I===void 0||(E[k]=I),E},{}),S=t==null||(a=t.compoundVariants)===null||a===void 0?void 0:a.reduce((E,P)=>{let{class:k,className:I,...G}=P;return Object.entries(G).every(Z=>{let[H,te]=Z;return Array.isArray(te)?te.includes({...g,...c}[H]):{...g,...c}[H]===te})?[...E,k,I]:E},[]);return _S(e,p,S,i==null?void 0:i.class,i==null?void 0:i.className)},oP=sP("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-neutral-950 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-neutral-900 text-neutral-50 shadow hover:bg-neutral-900/90",destructive:"bg-red-500 text-neutral-50 shadow-sm hover:bg-red-500/90",outline:"border border-neutral-200 bg-white shadow-sm hover:bg-neutral-100 hover:text-neutral-900",secondary:"bg-neutral-100 text-neutral-900 shadow-sm hover:bg-neutral-100/80",ghost:"hover:bg-neutral-100 hover:text-neutral-900",link:"text-neutral-900 underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Rs=$.forwardRef(({className:e,variant:t,size:i,...a},h)=>Q.jsx("button",{className:Yt(oP({variant:t,size:i,className:e})),ref:h,...a}));Rs.displayName="Button";const D4=sP("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-neutral-950 focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function sm({className:e,variant:t,...i}){return Q.jsx("div",{className:Yt(D4({variant:t}),e),...i})}function Fi(e,t,{checkForDefaultPrevented:i=!0}={}){return function(h){if(e==null||e(h),i===!1||!h.defaultPrevented)return t==null?void 0:t(h)}}function xS(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Bl(...e){return t=>{let i=!1;const a=e.map(h=>{const g=xS(h,t);return!i&&typeof g=="function"&&(i=!0),g});if(i)return()=>{for(let h=0;h<a.length;h++){const g=a[h];typeof g=="function"?g():xS(e[h],null)}}}}function wi(...e){return $.useCallback(Bl(...e),e)}function z4(e,t){const i=$.createContext(t),a=g=>{const{children:p,...c}=g,S=$.useMemo(()=>c,Object.values(c));return Q.jsx(i.Provider,{value:S,children:p})};a.displayName=e+"Provider";function h(g){const p=$.useContext(i);if(p)return p;if(t!==void 0)return t;throw new Error(`\`${g}\` must be used within \`${e}\``)}return[a,h]}function Hx(e,t=[]){let i=[];function a(g,p){const c=$.createContext(p),S=i.length;i=[...i,p];const E=k=>{var L;const{scope:I,children:G,...Z}=k,H=((L=I==null?void 0:I[e])==null?void 0:L[S])||c,te=$.useMemo(()=>Z,Object.values(Z));return Q.jsx(H.Provider,{value:te,children:G})};E.displayName=g+"Provider";function P(k,I){var H;const G=((H=I==null?void 0:I[e])==null?void 0:H[S])||c,Z=$.useContext(G);if(Z)return Z;if(p!==void 0)return p;throw new Error(`\`${k}\` must be used within \`${g}\``)}return[E,P]}const h=()=>{const g=i.map(p=>$.createContext(p));return function(c){const S=(c==null?void 0:c[e])||g;return $.useMemo(()=>({[`__scope${e}`]:{...c,[e]:S}}),[c,S])}};return h.scopeName=e,[a,R4(h,...t)]}function R4(...e){const t=e[0];if(e.length===1)return t;const i=()=>{const a=e.map(h=>({useScope:h(),scopeName:h.scopeName}));return function(g){const p=a.reduce((c,{useScope:S,scopeName:E})=>{const k=S(g)[`__scope${E}`];return{...c,...k}},{});return $.useMemo(()=>({[`__scope${t.scopeName}`]:p}),[p])}};return i.scopeName=t.scopeName,i}var ku=globalThis!=null&&globalThis.document?$.useLayoutEffect:()=>{},L4=ik[" useId ".trim().toString()]||(()=>{}),B4=0;function Io(e){const[t,i]=$.useState(L4());return ku(()=>{i(a=>a??String(B4++))},[e]),t?`radix-${t}`:""}var F4=ik[" useInsertionEffect ".trim().toString()]||ku;function aP({prop:e,defaultProp:t,onChange:i=()=>{},caller:a}){const[h,g,p]=N4({defaultProp:t,onChange:i}),c=e!==void 0,S=c?e:h;{const P=$.useRef(e!==void 0);$.useEffect(()=>{const k=P.current;k!==c&&console.warn(`${a} is changing from ${k?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),P.current=c},[c,a])}const E=$.useCallback(P=>{var k;if(c){const I=O4(P)?P(e):P;I!==e&&((k=p.current)==null||k.call(p,I))}else g(P)},[c,e,g,p]);return[S,E]}function N4({defaultProp:e,onChange:t}){const[i,a]=$.useState(e),h=$.useRef(i),g=$.useRef(t);return F4(()=>{g.current=t},[t]),$.useEffect(()=>{var p;h.current!==i&&((p=g.current)==null||p.call(g,i),h.current=i)},[i,h]),[i,a,g]}function O4(e){return typeof e=="function"}function Om(e){const t=j4(e),i=$.forwardRef((a,h)=>{const{children:g,...p}=a,c=$.Children.toArray(g),S=c.find(U4);if(S){const E=S.props.children,P=c.map(k=>k===S?$.Children.count(E)>1?$.Children.only(null):$.isValidElement(E)?E.props.children:null:k);return Q.jsx(t,{...p,ref:h,children:$.isValidElement(E)?$.cloneElement(E,void 0,P):null})}return Q.jsx(t,{...p,ref:h,children:g})});return i.displayName=`${e}.Slot`,i}function j4(e){const t=$.forwardRef((i,a)=>{const{children:h,...g}=i;if($.isValidElement(h)){const p=H4(h),c=$4(g,h.props);return h.type!==$.Fragment&&(c.ref=a?Bl(a,p):p),$.cloneElement(h,c)}return $.Children.count(h)>1?$.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var V4=Symbol("radix.slottable");function U4(e){return $.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===V4}function $4(e,t){const i={...t};for(const a in t){const h=e[a],g=t[a];/^on[A-Z]/.test(a)?h&&g?i[a]=(...c)=>{const S=g(...c);return h(...c),S}:h&&(i[a]=h):a==="style"?i[a]={...h,...g}:a==="className"&&(i[a]=[h,g].filter(Boolean).join(" "))}return{...e,...i}}function H4(e){var a,h;let t=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,i=t&&"isReactWarning"in t&&t.isReactWarning;return i?e.ref:(t=(h=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:h.get,i=t&&"isReactWarning"in t&&t.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}var G4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],lr=G4.reduce((e,t)=>{const i=Om(`Primitive.${t}`),a=$.forwardRef((h,g)=>{const{asChild:p,...c}=h,S=p?i:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Q.jsx(S,{...c,ref:g})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{});function W4(e,t){e&&cx.flushSync(()=>e.dispatchEvent(t))}function Gd(e){const t=$.useRef(e);return $.useEffect(()=>{t.current=e}),$.useMemo(()=>(...i)=>{var a;return(a=t.current)==null?void 0:a.call(t,...i)},[])}function q4(e,t=globalThis==null?void 0:globalThis.document){const i=Gd(e);$.useEffect(()=>{const a=h=>{h.key==="Escape"&&i(h)};return t.addEventListener("keydown",a,{capture:!0}),()=>t.removeEventListener("keydown",a,{capture:!0})},[i,t])}var Z4="DismissableLayer",e0="dismissableLayer.update",X4="dismissableLayer.pointerDownOutside",K4="dismissableLayer.focusOutside",bS,lP=$.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),cP=$.forwardRef((e,t)=>{const{disableOutsidePointerEvents:i=!1,onEscapeKeyDown:a,onPointerDownOutside:h,onFocusOutside:g,onInteractOutside:p,onDismiss:c,...S}=e,E=$.useContext(lP),[P,k]=$.useState(null),I=(P==null?void 0:P.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,G]=$.useState({}),Z=wi(t,le=>k(le)),H=Array.from(E.layers),[te]=[...E.layersWithOutsidePointerEventsDisabled].slice(-1),L=H.indexOf(te),V=P?H.indexOf(P):-1,W=E.layersWithOutsidePointerEventsDisabled.size>0,re=V>=L,pe=Q4(le=>{const ce=le.target,De=[...E.branches].some(Be=>Be.contains(ce));!re||De||(h==null||h(le),p==null||p(le),le.defaultPrevented||c==null||c())},I),_e=eF(le=>{const ce=le.target;[...E.branches].some(Be=>Be.contains(ce))||(g==null||g(le),p==null||p(le),le.defaultPrevented||c==null||c())},I);return q4(le=>{V===E.layers.size-1&&(a==null||a(le),!le.defaultPrevented&&c&&(le.preventDefault(),c()))},I),$.useEffect(()=>{if(P)return i&&(E.layersWithOutsidePointerEventsDisabled.size===0&&(bS=I.body.style.pointerEvents,I.body.style.pointerEvents="none"),E.layersWithOutsidePointerEventsDisabled.add(P)),E.layers.add(P),wS(),()=>{i&&E.layersWithOutsidePointerEventsDisabled.size===1&&(I.body.style.pointerEvents=bS)}},[P,I,i,E]),$.useEffect(()=>()=>{P&&(E.layers.delete(P),E.layersWithOutsidePointerEventsDisabled.delete(P),wS())},[P,E]),$.useEffect(()=>{const le=()=>G({});return document.addEventListener(e0,le),()=>document.removeEventListener(e0,le)},[]),Q.jsx(lr.div,{...S,ref:Z,style:{pointerEvents:W?re?"auto":"none":void 0,...e.style},onFocusCapture:Fi(e.onFocusCapture,_e.onFocusCapture),onBlurCapture:Fi(e.onBlurCapture,_e.onBlurCapture),onPointerDownCapture:Fi(e.onPointerDownCapture,pe.onPointerDownCapture)})});cP.displayName=Z4;var Y4="DismissableLayerBranch",J4=$.forwardRef((e,t)=>{const i=$.useContext(lP),a=$.useRef(null),h=wi(t,a);return $.useEffect(()=>{const g=a.current;if(g)return i.branches.add(g),()=>{i.branches.delete(g)}},[i.branches]),Q.jsx(lr.div,{...e,ref:h})});J4.displayName=Y4;function Q4(e,t=globalThis==null?void 0:globalThis.document){const i=Gd(e),a=$.useRef(!1),h=$.useRef(()=>{});return $.useEffect(()=>{const g=c=>{if(c.target&&!a.current){let S=function(){uP(X4,i,E,{discrete:!0})};const E={originalEvent:c};c.pointerType==="touch"?(t.removeEventListener("click",h.current),h.current=S,t.addEventListener("click",h.current,{once:!0})):S()}else t.removeEventListener("click",h.current);a.current=!1},p=window.setTimeout(()=>{t.addEventListener("pointerdown",g)},0);return()=>{window.clearTimeout(p),t.removeEventListener("pointerdown",g),t.removeEventListener("click",h.current)}},[t,i]),{onPointerDownCapture:()=>a.current=!0}}function eF(e,t=globalThis==null?void 0:globalThis.document){const i=Gd(e),a=$.useRef(!1);return $.useEffect(()=>{const h=g=>{g.target&&!a.current&&uP(K4,i,{originalEvent:g},{discrete:!1})};return t.addEventListener("focusin",h),()=>t.removeEventListener("focusin",h)},[t,i]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function wS(){const e=new CustomEvent(e0);document.dispatchEvent(e)}function uP(e,t,i,{discrete:a}){const h=i.originalEvent.target,g=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:i});t&&h.addEventListener(e,t,{once:!0}),a?W4(h,g):h.dispatchEvent(g)}var Tv="focusScope.autoFocusOnMount",Cv="focusScope.autoFocusOnUnmount",SS={bubbles:!1,cancelable:!0},tF="FocusScope",hP=$.forwardRef((e,t)=>{const{loop:i=!1,trapped:a=!1,onMountAutoFocus:h,onUnmountAutoFocus:g,...p}=e,[c,S]=$.useState(null),E=Gd(h),P=Gd(g),k=$.useRef(null),I=wi(t,H=>S(H)),G=$.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;$.useEffect(()=>{if(a){let H=function(W){if(G.paused||!c)return;const re=W.target;c.contains(re)?k.current=re:_a(k.current,{select:!0})},te=function(W){if(G.paused||!c)return;const re=W.relatedTarget;re!==null&&(c.contains(re)||_a(k.current,{select:!0}))},L=function(W){if(document.activeElement===document.body)for(const pe of W)pe.removedNodes.length>0&&_a(c)};document.addEventListener("focusin",H),document.addEventListener("focusout",te);const V=new MutationObserver(L);return c&&V.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",H),document.removeEventListener("focusout",te),V.disconnect()}}},[a,c,G.paused]),$.useEffect(()=>{if(c){TS.add(G);const H=document.activeElement;if(!c.contains(H)){const L=new CustomEvent(Tv,SS);c.addEventListener(Tv,E),c.dispatchEvent(L),L.defaultPrevented||(nF(aF(dP(c)),{select:!0}),document.activeElement===H&&_a(c))}return()=>{c.removeEventListener(Tv,E),setTimeout(()=>{const L=new CustomEvent(Cv,SS);c.addEventListener(Cv,P),c.dispatchEvent(L),L.defaultPrevented||_a(H??document.body,{select:!0}),c.removeEventListener(Cv,P),TS.remove(G)},0)}}},[c,E,P,G]);const Z=$.useCallback(H=>{if(!i&&!a||G.paused)return;const te=H.key==="Tab"&&!H.altKey&&!H.ctrlKey&&!H.metaKey,L=document.activeElement;if(te&&L){const V=H.currentTarget,[W,re]=rF(V);W&&re?!H.shiftKey&&L===re?(H.preventDefault(),i&&_a(W,{select:!0})):H.shiftKey&&L===W&&(H.preventDefault(),i&&_a(re,{select:!0})):L===V&&H.preventDefault()}},[i,a,G.paused]);return Q.jsx(lr.div,{tabIndex:-1,...p,ref:I,onKeyDown:Z})});hP.displayName=tF;function nF(e,{select:t=!1}={}){const i=document.activeElement;for(const a of e)if(_a(a,{select:t}),document.activeElement!==i)return}function rF(e){const t=dP(e),i=kS(t,e),a=kS(t.reverse(),e);return[i,a]}function dP(e){const t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const h=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||h?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t}function kS(e,t){for(const i of e)if(!iF(i,{upTo:t}))return i}function iF(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function sF(e){return e instanceof HTMLInputElement&&"select"in e}function _a(e,{select:t=!1}={}){if(e&&e.focus){const i=document.activeElement;e.focus({preventScroll:!0}),e!==i&&sF(e)&&t&&e.select()}}var TS=oF();function oF(){let e=[];return{add(t){const i=e[0];t!==i&&(i==null||i.pause()),e=CS(e,t),e.unshift(t)},remove(t){var i;e=CS(e,t),(i=e[0])==null||i.resume()}}}function CS(e,t){const i=[...e],a=i.indexOf(t);return a!==-1&&i.splice(a,1),i}function aF(e){return e.filter(t=>t.tagName!=="A")}var lF="Portal",fP=$.forwardRef((e,t)=>{var c;const{container:i,...a}=e,[h,g]=$.useState(!1);ku(()=>g(!0),[]);const p=i||h&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return p?aC.createPortal(Q.jsx(lr.div,{...a,ref:t}),p):null});fP.displayName=lF;function cF(e,t){return $.useReducer((i,a)=>t[i][a]??i,e)}var ug=e=>{const{present:t,children:i}=e,a=uF(t),h=typeof i=="function"?i({present:a.isPresent}):$.Children.only(i),g=wi(a.ref,hF(h));return typeof i=="function"||a.isPresent?$.cloneElement(h,{ref:g}):null};ug.displayName="Presence";function uF(e){const[t,i]=$.useState(),a=$.useRef(null),h=$.useRef(e),g=$.useRef("none"),p=e?"mounted":"unmounted",[c,S]=cF(p,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return $.useEffect(()=>{const E=Rp(a.current);g.current=c==="mounted"?E:"none"},[c]),ku(()=>{const E=a.current,P=h.current;if(P!==e){const I=g.current,G=Rp(E);e?S("MOUNT"):G==="none"||(E==null?void 0:E.display)==="none"?S("UNMOUNT"):S(P&&I!==G?"ANIMATION_OUT":"UNMOUNT"),h.current=e}},[e,S]),ku(()=>{if(t){let E;const P=t.ownerDocument.defaultView??window,k=G=>{const H=Rp(a.current).includes(CSS.escape(G.animationName));if(G.target===t&&H&&(S("ANIMATION_END"),!h.current)){const te=t.style.animationFillMode;t.style.animationFillMode="forwards",E=P.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=te)})}},I=G=>{G.target===t&&(g.current=Rp(a.current))};return t.addEventListener("animationstart",I),t.addEventListener("animationcancel",k),t.addEventListener("animationend",k),()=>{P.clearTimeout(E),t.removeEventListener("animationstart",I),t.removeEventListener("animationcancel",k),t.removeEventListener("animationend",k)}}else S("ANIMATION_END")},[t,S]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:$.useCallback(E=>{a.current=E?getComputedStyle(E):null,i(E)},[])}}function Rp(e){return(e==null?void 0:e.animationName)||"none"}function hF(e){var a,h;let t=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,i=t&&"isReactWarning"in t&&t.isReactWarning;return i?e.ref:(t=(h=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:h.get,i=t&&"isReactWarning"in t&&t.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}var Ev=0;function dF(){$.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??ES()),document.body.insertAdjacentElement("beforeend",e[1]??ES()),Ev++,()=>{Ev===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Ev--}},[])}function ES(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Js=function(){return Js=Object.assign||function(t){for(var i,a=1,h=arguments.length;a<h;a++){i=arguments[a];for(var g in i)Object.prototype.hasOwnProperty.call(i,g)&&(t[g]=i[g])}return t},Js.apply(this,arguments)};function pP(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,a=Object.getOwnPropertySymbols(e);h<a.length;h++)t.indexOf(a[h])<0&&Object.prototype.propertyIsEnumerable.call(e,a[h])&&(i[a[h]]=e[a[h]]);return i}function fF(e,t,i){if(i||arguments.length===2)for(var a=0,h=t.length,g;a<h;a++)(g||!(a in t))&&(g||(g=Array.prototype.slice.call(t,0,a)),g[a]=t[a]);return e.concat(g||Array.prototype.slice.call(t))}var om="right-scroll-bar-position",am="width-before-scroll-bar",pF="with-scroll-bars-hidden",mF="--removed-body-scroll-bar-size";function Pv(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function gF(e,t){var i=$.useState(function(){return{value:e,callback:t,facade:{get current(){return i.value},set current(a){var h=i.value;h!==a&&(i.value=a,i.callback(a,h))}}}})[0];return i.callback=t,i.facade}var yF=typeof window<"u"?$.useLayoutEffect:$.useEffect,PS=new WeakMap;function vF(e,t){var i=gF(null,function(a){return e.forEach(function(h){return Pv(h,a)})});return yF(function(){var a=PS.get(i);if(a){var h=new Set(a),g=new Set(e),p=i.current;h.forEach(function(c){g.has(c)||Pv(c,null)}),g.forEach(function(c){h.has(c)||Pv(c,p)})}PS.set(i,e)},[e]),i}function _F(e){return e}function xF(e,t){t===void 0&&(t=_F);var i=[],a=!1,h={read:function(){if(a)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return i.length?i[i.length-1]:e},useMedium:function(g){var p=t(g,a);return i.push(p),function(){i=i.filter(function(c){return c!==p})}},assignSyncMedium:function(g){for(a=!0;i.length;){var p=i;i=[],p.forEach(g)}i={push:function(c){return g(c)},filter:function(){return i}}},assignMedium:function(g){a=!0;var p=[];if(i.length){var c=i;i=[],c.forEach(g),p=i}var S=function(){var P=p;p=[],P.forEach(g)},E=function(){return Promise.resolve().then(S)};E(),i={push:function(P){p.push(P),E()},filter:function(P){return p=p.filter(P),i}}}};return h}function bF(e){e===void 0&&(e={});var t=xF(null);return t.options=Js({async:!0,ssr:!1},e),t}var mP=function(e){var t=e.sideCar,i=pP(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var a=t.read();if(!a)throw new Error("Sidecar medium not found");return $.createElement(a,Js({},i))};mP.isSideCarExport=!0;function wF(e,t){return e.useMedium(t),mP}var gP=bF(),Iv=function(){},hg=$.forwardRef(function(e,t){var i=$.useRef(null),a=$.useState({onScrollCapture:Iv,onWheelCapture:Iv,onTouchMoveCapture:Iv}),h=a[0],g=a[1],p=e.forwardProps,c=e.children,S=e.className,E=e.removeScrollBar,P=e.enabled,k=e.shards,I=e.sideCar,G=e.noRelative,Z=e.noIsolation,H=e.inert,te=e.allowPinchZoom,L=e.as,V=L===void 0?"div":L,W=e.gapMode,re=pP(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),pe=I,_e=vF([i,t]),le=Js(Js({},re),h);return $.createElement($.Fragment,null,P&&$.createElement(pe,{sideCar:gP,removeScrollBar:E,shards:k,noRelative:G,noIsolation:Z,inert:H,setCallbacks:g,allowPinchZoom:!!te,lockRef:i,gapMode:W}),p?$.cloneElement($.Children.only(c),Js(Js({},le),{ref:_e})):$.createElement(V,Js({},le,{className:S,ref:_e}),c))});hg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};hg.classNames={fullWidth:am,zeroRight:om};var SF=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function kF(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=SF();return t&&e.setAttribute("nonce",t),e}function TF(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function CF(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var EF=function(){var e=0,t=null;return{add:function(i){e==0&&(t=kF())&&(TF(t,i),CF(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},PF=function(){var e=EF();return function(t,i){$.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&i])}},yP=function(){var e=PF(),t=function(i){var a=i.styles,h=i.dynamic;return e(a,h),null};return t},IF={left:0,top:0,right:0,gap:0},Av=function(e){return parseInt(e||"",10)||0},AF=function(e){var t=window.getComputedStyle(document.body),i=t[e==="padding"?"paddingLeft":"marginLeft"],a=t[e==="padding"?"paddingTop":"marginTop"],h=t[e==="padding"?"paddingRight":"marginRight"];return[Av(i),Av(a),Av(h)]},MF=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return IF;var t=AF(e),i=document.documentElement.clientWidth,a=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,a-i+t[2]-t[0])}},DF=yP(),fu="data-scroll-locked",zF=function(e,t,i,a){var h=e.left,g=e.top,p=e.right,c=e.gap;return i===void 0&&(i="margin"),`
  .`.concat(pF,` {
   overflow: hidden `).concat(a,`;
   padding-right: `).concat(c,"px ").concat(a,`;
  }
  body[`).concat(fu,`] {
    overflow: hidden `).concat(a,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(a,";"),i==="margin"&&`
    padding-left: `.concat(h,`px;
    padding-top: `).concat(g,`px;
    padding-right: `).concat(p,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(a,`;
    `),i==="padding"&&"padding-right: ".concat(c,"px ").concat(a,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(om,` {
    right: `).concat(c,"px ").concat(a,`;
  }
  
  .`).concat(am,` {
    margin-right: `).concat(c,"px ").concat(a,`;
  }
  
  .`).concat(om," .").concat(om,` {
    right: 0 `).concat(a,`;
  }
  
  .`).concat(am," .").concat(am,` {
    margin-right: 0 `).concat(a,`;
  }
  
  body[`).concat(fu,`] {
    `).concat(mF,": ").concat(c,`px;
  }
`)},IS=function(){var e=parseInt(document.body.getAttribute(fu)||"0",10);return isFinite(e)?e:0},RF=function(){$.useEffect(function(){return document.body.setAttribute(fu,(IS()+1).toString()),function(){var e=IS()-1;e<=0?document.body.removeAttribute(fu):document.body.setAttribute(fu,e.toString())}},[])},LF=function(e){var t=e.noRelative,i=e.noImportant,a=e.gapMode,h=a===void 0?"margin":a;RF();var g=$.useMemo(function(){return MF(h)},[h]);return $.createElement(DF,{styles:zF(g,!t,h,i?"":"!important")})},t0=!1;if(typeof window<"u")try{var Lp=Object.defineProperty({},"passive",{get:function(){return t0=!0,!0}});window.addEventListener("test",Lp,Lp),window.removeEventListener("test",Lp,Lp)}catch{t0=!1}var Nc=t0?{passive:!1}:!1,BF=function(e){return e.tagName==="TEXTAREA"},vP=function(e,t){if(!(e instanceof Element))return!1;var i=window.getComputedStyle(e);return i[t]!=="hidden"&&!(i.overflowY===i.overflowX&&!BF(e)&&i[t]==="visible")},FF=function(e){return vP(e,"overflowY")},NF=function(e){return vP(e,"overflowX")},AS=function(e,t){var i=t.ownerDocument,a=t;do{typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&(a=a.host);var h=_P(e,a);if(h){var g=xP(e,a),p=g[1],c=g[2];if(p>c)return!0}a=a.parentNode}while(a&&a!==i.body);return!1},OF=function(e){var t=e.scrollTop,i=e.scrollHeight,a=e.clientHeight;return[t,i,a]},jF=function(e){var t=e.scrollLeft,i=e.scrollWidth,a=e.clientWidth;return[t,i,a]},_P=function(e,t){return e==="v"?FF(t):NF(t)},xP=function(e,t){return e==="v"?OF(t):jF(t)},VF=function(e,t){return e==="h"&&t==="rtl"?-1:1},UF=function(e,t,i,a,h){var g=VF(e,window.getComputedStyle(t).direction),p=g*a,c=i.target,S=t.contains(c),E=!1,P=p>0,k=0,I=0;do{if(!c)break;var G=xP(e,c),Z=G[0],H=G[1],te=G[2],L=H-te-g*Z;(Z||L)&&_P(e,c)&&(k+=L,I+=Z);var V=c.parentNode;c=V&&V.nodeType===Node.DOCUMENT_FRAGMENT_NODE?V.host:V}while(!S&&c!==document.body||S&&(t.contains(c)||t===c));return(P&&Math.abs(k)<1||!P&&Math.abs(I)<1)&&(E=!0),E},Bp=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},MS=function(e){return[e.deltaX,e.deltaY]},DS=function(e){return e&&"current"in e?e.current:e},$F=function(e,t){return e[0]===t[0]&&e[1]===t[1]},HF=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},GF=0,Oc=[];function WF(e){var t=$.useRef([]),i=$.useRef([0,0]),a=$.useRef(),h=$.useState(GF++)[0],g=$.useState(yP)[0],p=$.useRef(e);$.useEffect(function(){p.current=e},[e]),$.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(h));var H=fF([e.lockRef.current],(e.shards||[]).map(DS),!0).filter(Boolean);return H.forEach(function(te){return te.classList.add("allow-interactivity-".concat(h))}),function(){document.body.classList.remove("block-interactivity-".concat(h)),H.forEach(function(te){return te.classList.remove("allow-interactivity-".concat(h))})}}},[e.inert,e.lockRef.current,e.shards]);var c=$.useCallback(function(H,te){if("touches"in H&&H.touches.length===2||H.type==="wheel"&&H.ctrlKey)return!p.current.allowPinchZoom;var L=Bp(H),V=i.current,W="deltaX"in H?H.deltaX:V[0]-L[0],re="deltaY"in H?H.deltaY:V[1]-L[1],pe,_e=H.target,le=Math.abs(W)>Math.abs(re)?"h":"v";if("touches"in H&&le==="h"&&_e.type==="range")return!1;var ce=window.getSelection(),De=ce&&ce.anchorNode,Be=De?De===_e||De.contains(_e):!1;if(Be)return!1;var Ce=AS(le,_e);if(!Ce)return!0;if(Ce?pe=le:(pe=le==="v"?"h":"v",Ce=AS(le,_e)),!Ce)return!1;if(!a.current&&"changedTouches"in H&&(W||re)&&(a.current=pe),!pe)return!0;var Fe=a.current||pe;return UF(Fe,te,H,Fe==="h"?W:re)},[]),S=$.useCallback(function(H){var te=H;if(!(!Oc.length||Oc[Oc.length-1]!==g)){var L="deltaY"in te?MS(te):Bp(te),V=t.current.filter(function(pe){return pe.name===te.type&&(pe.target===te.target||te.target===pe.shadowParent)&&$F(pe.delta,L)})[0];if(V&&V.should){te.cancelable&&te.preventDefault();return}if(!V){var W=(p.current.shards||[]).map(DS).filter(Boolean).filter(function(pe){return pe.contains(te.target)}),re=W.length>0?c(te,W[0]):!p.current.noIsolation;re&&te.cancelable&&te.preventDefault()}}},[]),E=$.useCallback(function(H,te,L,V){var W={name:H,delta:te,target:L,should:V,shadowParent:qF(L)};t.current.push(W),setTimeout(function(){t.current=t.current.filter(function(re){return re!==W})},1)},[]),P=$.useCallback(function(H){i.current=Bp(H),a.current=void 0},[]),k=$.useCallback(function(H){E(H.type,MS(H),H.target,c(H,e.lockRef.current))},[]),I=$.useCallback(function(H){E(H.type,Bp(H),H.target,c(H,e.lockRef.current))},[]);$.useEffect(function(){return Oc.push(g),e.setCallbacks({onScrollCapture:k,onWheelCapture:k,onTouchMoveCapture:I}),document.addEventListener("wheel",S,Nc),document.addEventListener("touchmove",S,Nc),document.addEventListener("touchstart",P,Nc),function(){Oc=Oc.filter(function(H){return H!==g}),document.removeEventListener("wheel",S,Nc),document.removeEventListener("touchmove",S,Nc),document.removeEventListener("touchstart",P,Nc)}},[]);var G=e.removeScrollBar,Z=e.inert;return $.createElement($.Fragment,null,Z?$.createElement(g,{styles:HF(h)}):null,G?$.createElement(LF,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function qF(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ZF=wF(gP,WF);var bP=$.forwardRef(function(e,t){return $.createElement(hg,Js({},e,{ref:t,sideCar:ZF}))});bP.classNames=hg.classNames;var XF=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},jc=new WeakMap,Fp=new WeakMap,Np={},Mv=0,wP=function(e){return e&&(e.host||wP(e.parentNode))},KF=function(e,t){return t.map(function(i){if(e.contains(i))return i;var a=wP(i);return a&&e.contains(a)?a:(console.error("aria-hidden",i,"in not contained inside",e,". Doing nothing"),null)}).filter(function(i){return!!i})},YF=function(e,t,i,a){var h=KF(t,Array.isArray(e)?e:[e]);Np[i]||(Np[i]=new WeakMap);var g=Np[i],p=[],c=new Set,S=new Set(h),E=function(k){!k||c.has(k)||(c.add(k),E(k.parentNode))};h.forEach(E);var P=function(k){!k||S.has(k)||Array.prototype.forEach.call(k.children,function(I){if(c.has(I))P(I);else try{var G=I.getAttribute(a),Z=G!==null&&G!=="false",H=(jc.get(I)||0)+1,te=(g.get(I)||0)+1;jc.set(I,H),g.set(I,te),p.push(I),H===1&&Z&&Fp.set(I,!0),te===1&&I.setAttribute(i,"true"),Z||I.setAttribute(a,"true")}catch(L){console.error("aria-hidden: cannot operate on ",I,L)}})};return P(t),c.clear(),Mv++,function(){p.forEach(function(k){var I=jc.get(k)-1,G=g.get(k)-1;jc.set(k,I),g.set(k,G),I||(Fp.has(k)||k.removeAttribute(a),Fp.delete(k)),G||k.removeAttribute(i)}),Mv--,Mv||(jc=new WeakMap,jc=new WeakMap,Fp=new WeakMap,Np={})}},JF=function(e,t,i){i===void 0&&(i="data-aria-hidden");var a=Array.from(Array.isArray(e)?e:[e]),h=XF(e);return h?(a.push.apply(a,Array.from(h.querySelectorAll("[aria-live], script"))),YF(a,h,i,"aria-hidden")):function(){return null}},dg="Dialog",[SP]=Hx(dg),[QF,Os]=SP(dg),kP=e=>{const{__scopeDialog:t,children:i,open:a,defaultOpen:h,onOpenChange:g,modal:p=!0}=e,c=$.useRef(null),S=$.useRef(null),[E,P]=aP({prop:a,defaultProp:h??!1,onChange:g,caller:dg});return Q.jsx(QF,{scope:t,triggerRef:c,contentRef:S,contentId:Io(),titleId:Io(),descriptionId:Io(),open:E,onOpenChange:P,onOpenToggle:$.useCallback(()=>P(k=>!k),[P]),modal:p,children:i})};kP.displayName=dg;var TP="DialogTrigger",eN=$.forwardRef((e,t)=>{const{__scopeDialog:i,...a}=e,h=Os(TP,i),g=wi(t,h.triggerRef);return Q.jsx(lr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":h.open,"aria-controls":h.contentId,"data-state":qx(h.open),...a,ref:g,onClick:Fi(e.onClick,h.onOpenToggle)})});eN.displayName=TP;var Gx="DialogPortal",[tN,CP]=SP(Gx,{forceMount:void 0}),EP=e=>{const{__scopeDialog:t,forceMount:i,children:a,container:h}=e,g=Os(Gx,t);return Q.jsx(tN,{scope:t,forceMount:i,children:$.Children.map(a,p=>Q.jsx(ug,{present:i||g.open,children:Q.jsx(fP,{asChild:!0,container:h,children:p})}))})};EP.displayName=Gx;var jm="DialogOverlay",PP=$.forwardRef((e,t)=>{const i=CP(jm,e.__scopeDialog),{forceMount:a=i.forceMount,...h}=e,g=Os(jm,e.__scopeDialog);return g.modal?Q.jsx(ug,{present:a||g.open,children:Q.jsx(rN,{...h,ref:t})}):null});PP.displayName=jm;var nN=Om("DialogOverlay.RemoveScroll"),rN=$.forwardRef((e,t)=>{const{__scopeDialog:i,...a}=e,h=Os(jm,i);return Q.jsx(bP,{as:nN,allowPinchZoom:!0,shards:[h.contentRef],children:Q.jsx(lr.div,{"data-state":qx(h.open),...a,ref:t,style:{pointerEvents:"auto",...a.style}})})}),Fl="DialogContent",IP=$.forwardRef((e,t)=>{const i=CP(Fl,e.__scopeDialog),{forceMount:a=i.forceMount,...h}=e,g=Os(Fl,e.__scopeDialog);return Q.jsx(ug,{present:a||g.open,children:g.modal?Q.jsx(iN,{...h,ref:t}):Q.jsx(sN,{...h,ref:t})})});IP.displayName=Fl;var iN=$.forwardRef((e,t)=>{const i=Os(Fl,e.__scopeDialog),a=$.useRef(null),h=wi(t,i.contentRef,a);return $.useEffect(()=>{const g=a.current;if(g)return JF(g)},[]),Q.jsx(AP,{...e,ref:h,trapFocus:i.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Fi(e.onCloseAutoFocus,g=>{var p;g.preventDefault(),(p=i.triggerRef.current)==null||p.focus()}),onPointerDownOutside:Fi(e.onPointerDownOutside,g=>{const p=g.detail.originalEvent,c=p.button===0&&p.ctrlKey===!0;(p.button===2||c)&&g.preventDefault()}),onFocusOutside:Fi(e.onFocusOutside,g=>g.preventDefault())})}),sN=$.forwardRef((e,t)=>{const i=Os(Fl,e.__scopeDialog),a=$.useRef(!1),h=$.useRef(!1);return Q.jsx(AP,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:g=>{var p,c;(p=e.onCloseAutoFocus)==null||p.call(e,g),g.defaultPrevented||(a.current||(c=i.triggerRef.current)==null||c.focus(),g.preventDefault()),a.current=!1,h.current=!1},onInteractOutside:g=>{var S,E;(S=e.onInteractOutside)==null||S.call(e,g),g.defaultPrevented||(a.current=!0,g.detail.originalEvent.type==="pointerdown"&&(h.current=!0));const p=g.target;((E=i.triggerRef.current)==null?void 0:E.contains(p))&&g.preventDefault(),g.detail.originalEvent.type==="focusin"&&h.current&&g.preventDefault()}})}),AP=$.forwardRef((e,t)=>{const{__scopeDialog:i,trapFocus:a,onOpenAutoFocus:h,onCloseAutoFocus:g,...p}=e,c=Os(Fl,i),S=$.useRef(null),E=wi(t,S);return dF(),Q.jsxs(Q.Fragment,{children:[Q.jsx(hP,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:h,onUnmountAutoFocus:g,children:Q.jsx(cP,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":qx(c.open),...p,ref:E,onDismiss:()=>c.onOpenChange(!1)})}),Q.jsxs(Q.Fragment,{children:[Q.jsx(oN,{titleId:c.titleId}),Q.jsx(lN,{contentRef:S,descriptionId:c.descriptionId})]})]})}),Wx="DialogTitle",MP=$.forwardRef((e,t)=>{const{__scopeDialog:i,...a}=e,h=Os(Wx,i);return Q.jsx(lr.h2,{id:h.titleId,...a,ref:t})});MP.displayName=Wx;var DP="DialogDescription",zP=$.forwardRef((e,t)=>{const{__scopeDialog:i,...a}=e,h=Os(DP,i);return Q.jsx(lr.p,{id:h.descriptionId,...a,ref:t})});zP.displayName=DP;var RP="DialogClose",LP=$.forwardRef((e,t)=>{const{__scopeDialog:i,...a}=e,h=Os(RP,i);return Q.jsx(lr.button,{type:"button",...a,ref:t,onClick:Fi(e.onClick,()=>h.onOpenChange(!1))})});LP.displayName=RP;function qx(e){return e?"open":"closed"}var BP="DialogTitleWarning",[D8,FP]=z4(BP,{contentName:Fl,titleName:Wx,docsSlug:"dialog"}),oN=({titleId:e})=>{const t=FP(BP),i=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return $.useEffect(()=>{e&&(document.getElementById(e)||console.error(i))},[i,e]),null},aN="DialogDescriptionWarning",lN=({contentRef:e,descriptionId:t})=>{const a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${FP(aN).contentName}}.`;return $.useEffect(()=>{var g;const h=(g=e.current)==null?void 0:g.getAttribute("aria-describedby");t&&h&&(document.getElementById(t)||console.warn(a))},[a,e,t]),null},NP=kP,Zx=EP,fg=PP,pg=IP,Xx=MP,Kx=zP,cN=LP;function uN(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}const OP=Me.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),sf=()=>{const e=Me.useContext(OP);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};uN(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function hN(){const e=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(e)&&/Mobile/.test(e)||/FxiOS/.test(e))}function dN(){return Yx(/^Mac/)}function fN(){return Yx(/^iPhone/)}function zS(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function pN(){return Yx(/^iPad/)||dN()&&navigator.maxTouchPoints>1}function jP(){return fN()||pN()}function Yx(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const mN=24,gN=typeof window<"u"?$.useLayoutEffect:$.useEffect;function RS(...e){return(...t)=>{for(let i of e)typeof i=="function"&&i(...t)}}const Dv=typeof document<"u"&&window.visualViewport;function LS(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function VP(e){for(LS(e)&&(e=e.parentElement);e&&!LS(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const yN=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Op=0,zv;function vN(e={}){let{isDisabled:t}=e;gN(()=>{if(!t)return Op++,Op===1&&jP()&&(zv=_N()),()=>{Op--,Op===0&&(zv==null||zv())}},[t])}function _N(){let e,t=0,i=k=>{e=VP(k.target),!(e===document.documentElement&&e===document.body)&&(t=k.changedTouches[0].pageY)},a=k=>{if(!e||e===document.documentElement||e===document.body){k.preventDefault();return}let I=k.changedTouches[0].pageY,G=e.scrollTop,Z=e.scrollHeight-e.clientHeight;Z!==0&&((G<=0&&I>t||G>=Z&&I<t)&&k.preventDefault(),t=I)},h=k=>{let I=k.target;n0(I)&&I!==document.activeElement&&(k.preventDefault(),I.style.transform="translateY(-2000px)",I.focus(),requestAnimationFrame(()=>{I.style.transform=""}))},g=k=>{let I=k.target;n0(I)&&(I.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{I.style.transform="",Dv&&(Dv.height<window.innerHeight?requestAnimationFrame(()=>{BS(I)}):Dv.addEventListener("resize",()=>BS(I),{once:!0}))}))},p=()=>{window.scrollTo(0,0)},c=window.pageXOffset,S=window.pageYOffset,E=RS(xN(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let P=RS(Jh(document,"touchstart",i,{passive:!1,capture:!0}),Jh(document,"touchmove",a,{passive:!1,capture:!0}),Jh(document,"touchend",h,{passive:!1,capture:!0}),Jh(document,"focus",g,!0),Jh(window,"scroll",p));return()=>{E(),P(),window.scrollTo(c,S)}}function xN(e,t,i){let a=e.style[t];return e.style[t]=i,()=>{e.style[t]=a}}function Jh(e,t,i,a){return e.addEventListener(t,i,a),()=>{e.removeEventListener(t,i,a)}}function BS(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let i=VP(e);if(i!==document.documentElement&&i!==document.body&&i!==e){let a=i.getBoundingClientRect().top,h=e.getBoundingClientRect().top,g=e.getBoundingClientRect().bottom;const p=i.getBoundingClientRect().bottom+mN;g>p&&(i.scrollTop+=h-a)}e=i.parentElement}}function n0(e){return e instanceof HTMLInputElement&&!yN.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function bN(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function wN(...e){return t=>e.forEach(i=>bN(i,t))}function UP(...e){return $.useCallback(wN(...e),e)}const $P=new WeakMap;function Cr(e,t,i=!1){if(!e||!(e instanceof HTMLElement))return;let a={};Object.entries(t).forEach(([h,g])=>{if(h.startsWith("--")){e.style.setProperty(h,g);return}a[h]=e.style[h],e.style[h]=g}),!i&&$P.set(e,a)}function SN(e,t){if(!e||!(e instanceof HTMLElement))return;let i=$P.get(e);i&&(e.style[t]=i[t])}const yr=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function jp(e,t){if(!e)return null;const i=window.getComputedStyle(e),a=i.transform||i.webkitTransform||i.mozTransform;let h=a.match(/^matrix3d\((.+)\)$/);return h?parseFloat(h[1].split(", ")[yr(t)?13:12]):(h=a.match(/^matrix\((.+)\)$/),h?parseFloat(h[1].split(", ")[yr(t)?5:4]):null)}function kN(e){return 8*(Math.log(e+1)-2)}function Rv(e,t){if(!e)return()=>{};const i=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=i}}function TN(...e){return(...t)=>{for(const i of e)typeof i=="function"&&i(...t)}}const Zn={DURATION:.5,EASE:[.32,.72,0,1]},HP=.4,CN=.25,EN=100,GP=8,_l=16,r0=26,Lv="vaul-dragging";function WP(e){const t=Me.useRef(e);return Me.useEffect(()=>{t.current=e}),Me.useMemo(()=>(...i)=>t.current==null?void 0:t.current.call(t,...i),[])}function PN({defaultProp:e,onChange:t}){const i=Me.useState(e),[a]=i,h=Me.useRef(a),g=WP(t);return Me.useEffect(()=>{h.current!==a&&(g(a),h.current=a)},[a,h,g]),i}function qP({prop:e,defaultProp:t,onChange:i=()=>{}}){const[a,h]=PN({defaultProp:t,onChange:i}),g=e!==void 0,p=g?e:a,c=WP(i),S=Me.useCallback(E=>{if(g){const k=typeof E=="function"?E(e):E;k!==e&&c(k)}else h(E)},[g,e,h,c]);return[p,S]}function IN({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:i,drawerRef:a,overlayRef:h,fadeFromIndex:g,onSnapPointChange:p,direction:c="bottom",container:S,snapToSequentialPoint:E}){const[P,k]=qP({prop:e,defaultProp:i==null?void 0:i[0],onChange:t}),[I,G]=Me.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);Me.useEffect(()=>{function le(){G({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",le),()=>window.removeEventListener("resize",le)},[]);const Z=Me.useMemo(()=>P===(i==null?void 0:i[i.length-1])||null,[i,P]),H=Me.useMemo(()=>{var le;return(le=i==null?void 0:i.findIndex(ce=>ce===P))!=null?le:null},[i,P]),te=i&&i.length>0&&(g||g===0)&&!Number.isNaN(g)&&i[g]===P||!i,L=Me.useMemo(()=>{const le=S?{width:S.getBoundingClientRect().width,height:S.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var ce;return(ce=i==null?void 0:i.map(De=>{const Be=typeof De=="string";let Ce=0;if(Be&&(Ce=parseInt(De,10)),yr(c)){const ze=Be?Ce:I?De*le.height:0;return I?c==="bottom"?le.height-ze:-le.height+ze:ze}const Fe=Be?Ce:I?De*le.width:0;return I?c==="right"?le.width-Fe:-le.width+Fe:Fe}))!=null?ce:[]},[i,I,S]),V=Me.useMemo(()=>H!==null?L==null?void 0:L[H]:null,[L,H]),W=Me.useCallback(le=>{var ce;const De=(ce=L==null?void 0:L.findIndex(Be=>Be===le))!=null?ce:null;p(De),Cr(a.current,{transition:`transform ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`,transform:yr(c)?`translate3d(0, ${le}px, 0)`:`translate3d(${le}px, 0, 0)`}),L&&De!==L.length-1&&g!==void 0&&De!==g&&De<g?Cr(h.current,{transition:`opacity ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`,opacity:"0"}):Cr(h.current,{transition:`opacity ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`,opacity:"1"}),k(i==null?void 0:i[Math.max(De,0)])},[a.current,i,L,g,h,k]);Me.useEffect(()=>{if(P||e){var le;const ce=(le=i==null?void 0:i.findIndex(De=>De===e||De===P))!=null?le:-1;L&&ce!==-1&&typeof L[ce]=="number"&&W(L[ce])}},[P,e,i,L,W]);function re({draggedDistance:le,closeDrawer:ce,velocity:De,dismissible:Be}){if(g===void 0)return;const Ce=c==="bottom"||c==="right"?(V??0)-le:(V??0)+le,Fe=H===g-1,ze=H===0,Qe=le>0;if(Fe&&Cr(h.current,{transition:`opacity ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`}),!E&&De>2&&!Qe){Be?ce():W(L[0]);return}if(!E&&De>2&&Qe&&L&&i){W(L[i.length-1]);return}const Ze=L==null?void 0:L.reduce(($e,ke)=>typeof $e!="number"||typeof ke!="number"?$e:Math.abs(ke-Ce)<Math.abs($e-Ce)?ke:$e),Je=yr(c)?window.innerHeight:window.innerWidth;if(De>HP&&Math.abs(le)<Je*.4){const $e=Qe?1:-1;if($e>0&&Z&&i){W(L[i.length-1]);return}if(ze&&$e<0&&Be&&ce(),H===null)return;W(L[H+$e]);return}W(Ze)}function pe({draggedDistance:le}){if(V===null)return;const ce=c==="bottom"||c==="right"?V-le:V+le;(c==="bottom"||c==="right")&&ce<L[L.length-1]||(c==="top"||c==="left")&&ce>L[L.length-1]||Cr(a.current,{transform:yr(c)?`translate3d(0, ${ce}px, 0)`:`translate3d(${ce}px, 0, 0)`})}function _e(le,ce){if(!i||typeof H!="number"||!L||g===void 0)return null;const De=H===g-1;if(H>=g&&ce)return 0;if(De&&!ce)return 1;if(!te&&!De)return null;const Ce=De?H+1:H-1,Fe=De?L[Ce]-L[Ce-1]:L[Ce+1]-L[Ce],ze=le/Math.abs(Fe);return De?1-ze:ze}return{isLastSnapPoint:Z,activeSnapPoint:P,shouldFade:te,getPercentageDragged:_e,setActiveSnapPoint:k,activeSnapPointIndex:H,onRelease:re,onDrag:pe,snapPointsOffset:L}}const AN=()=>()=>{};function MN(){const{direction:e,isOpen:t,shouldScaleBackground:i,setBackgroundColorOnScale:a,noBodyStyles:h}=sf(),g=Me.useRef(null),p=$.useMemo(()=>document.body.style.backgroundColor,[]);function c(){return(window.innerWidth-r0)/window.innerWidth}Me.useEffect(()=>{if(t&&i){g.current&&clearTimeout(g.current);const S=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!S)return;TN(a&&!h?Rv(document.body,{background:"black"}):AN,Rv(S,{transformOrigin:yr(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${Zn.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Zn.EASE.join(",")})`}));const E=Rv(S,{borderRadius:`${GP}px`,overflow:"hidden",...yr(e)?{transform:`scale(${c()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${c()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{E(),g.current=window.setTimeout(()=>{p?document.body.style.background=p:document.body.style.removeProperty("background")},Zn.DURATION*1e3)}}},[t,i,p])}let Qh=null;function DN({isOpen:e,modal:t,nested:i,hasBeenOpened:a,preventScrollRestoration:h,noBodyStyles:g}){const[p,c]=Me.useState(()=>typeof window<"u"?window.location.href:""),S=Me.useRef(0),E=Me.useCallback(()=>{if(zS()&&Qh===null&&e&&!g){Qh={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:k,innerHeight:I}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-S.current}px`,left:`${-k}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const G=I-window.innerHeight;G&&S.current>=I&&(document.body.style.top=`${-(S.current+G)}px`)}),300)}},[e]),P=Me.useCallback(()=>{if(zS()&&Qh!==null&&!g){const k=-parseInt(document.body.style.top,10),I=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Qh),window.requestAnimationFrame(()=>{if(h&&p!==window.location.href){c(window.location.href);return}window.scrollTo(I,k)}),Qh=null}},[p]);return Me.useEffect(()=>{function k(){S.current=window.scrollY}return k(),window.addEventListener("scroll",k),()=>{window.removeEventListener("scroll",k)}},[]),Me.useEffect(()=>{if(t)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||P()}},[t,P]),Me.useEffect(()=>{i||!a||(e?(!window.matchMedia("(display-mode: standalone)").matches&&E(),t||window.setTimeout(()=>{P()},500)):P())},[e,a,p,t,i,E,P]),{restorePositionSetting:P}}function zN({open:e,onOpenChange:t,children:i,onDrag:a,onRelease:h,snapPoints:g,shouldScaleBackground:p=!1,setBackgroundColorOnScale:c=!0,closeThreshold:S=CN,scrollLockTimeout:E=EN,dismissible:P=!0,handleOnly:k=!1,fadeFromIndex:I=g&&g.length-1,activeSnapPoint:G,setActiveSnapPoint:Z,fixed:H,modal:te=!0,onClose:L,nested:V,noBodyStyles:W=!1,direction:re="bottom",defaultOpen:pe=!1,disablePreventScroll:_e=!0,snapToSequentialPoint:le=!1,preventScrollRestoration:ce=!1,repositionInputs:De=!0,onAnimationEnd:Be,container:Ce,autoFocus:Fe=!1}){var ze,Qe;const[Ze=!1,Je]=qP({defaultProp:pe,prop:e,onChange:xt=>{t==null||t(xt),!xt&&!V&&Ti(),setTimeout(()=>{Be==null||Be(xt)},Zn.DURATION*1e3),xt&&!te&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),xt||(document.body.style.pointerEvents="auto")}}),[$e,ke]=Me.useState(!1),[Ue,et]=Me.useState(!1),[pt,Le]=Me.useState(!1),Ve=Me.useRef(null),We=Me.useRef(null),He=Me.useRef(null),_t=Me.useRef(null),tt=Me.useRef(null),dt=Me.useRef(!1),Pt=Me.useRef(null),Ut=Me.useRef(0),Ft=Me.useRef(!1),at=Me.useRef(!pe),Wt=Me.useRef(0),mt=Me.useRef(null),wn=Me.useRef(((ze=mt.current)==null?void 0:ze.getBoundingClientRect().height)||0),Pe=Me.useRef(((Qe=mt.current)==null?void 0:Qe.getBoundingClientRect().width)||0),Sn=Me.useRef(0),dr=Me.useCallback(xt=>{g&&xt===En.length-1&&(We.current=new Date)},[]),{activeSnapPoint:Nt,activeSnapPointIndex:Jt,setActiveSnapPoint:Ir,onRelease:xn,snapPointsOffset:En,onDrag:ci,shouldFade:er,getPercentageDragged:Xr}=IN({snapPoints:g,activeSnapPointProp:G,setActiveSnapPointProp:Z,drawerRef:mt,fadeFromIndex:I,overlayRef:Ve,onSnapPointChange:dr,direction:re,container:Ce,snapToSequentialPoint:le});vN({isDisabled:!Ze||Ue||!te||pt||!$e||!De||!_e});const{restorePositionSetting:Ti}=DN({isOpen:Ze,modal:te,nested:V??!1,hasBeenOpened:$e,preventScrollRestoration:ce,noBodyStyles:W});function qe(){return(window.innerWidth-r0)/window.innerWidth}function tr(xt){var Zt,Qt;!P&&!g||mt.current&&!mt.current.contains(xt.target)||(wn.current=((Zt=mt.current)==null?void 0:Zt.getBoundingClientRect().height)||0,Pe.current=((Qt=mt.current)==null?void 0:Qt.getBoundingClientRect().width)||0,et(!0),He.current=new Date,jP()&&window.addEventListener("touchend",()=>dt.current=!1,{once:!0}),xt.target.setPointerCapture(xt.pointerId),Ut.current=yr(re)?xt.pageY:xt.pageX)}function dn(xt,Zt){var Qt;let Ht=xt;const ie=(Qt=window.getSelection())==null?void 0:Qt.toString(),N=mt.current?jp(mt.current,re):null,j=new Date;if(Ht.tagName==="SELECT"||Ht.hasAttribute("data-vaul-no-drag")||Ht.closest("[data-vaul-no-drag]"))return!1;if(re==="right"||re==="left")return!0;if(We.current&&j.getTime()-We.current.getTime()<500)return!1;if(N!==null&&(re==="bottom"?N>0:N<0))return!0;if(ie&&ie.length>0)return!1;if(tt.current&&j.getTime()-tt.current.getTime()<E&&N===0||Zt)return tt.current=j,!1;for(;Ht;){if(Ht.scrollHeight>Ht.clientHeight){if(Ht.scrollTop!==0)return tt.current=new Date,!1;if(Ht.getAttribute("role")==="dialog")return!0}Ht=Ht.parentNode}return!0}function cr(xt){if(mt.current&&Ue){const Zt=re==="bottom"||re==="right"?1:-1,Qt=(Ut.current-(yr(re)?xt.pageY:xt.pageX))*Zt,Ht=Qt>0,ie=g&&!P&&!Ht;if(ie&&Jt===0)return;const N=Math.abs(Qt),j=document.querySelector("[data-vaul-drawer-wrapper]"),K=re==="bottom"||re==="top"?wn.current:Pe.current;let ne=N/K;const me=Xr(N,Ht);if(me!==null&&(ne=me),ie&&ne>=1||!dt.current&&!dn(xt.target,Ht))return;if(mt.current.classList.add(Lv),dt.current=!0,Cr(mt.current,{transition:"none"}),Cr(Ve.current,{transition:"none"}),g&&ci({draggedDistance:Qt}),Ht&&!g){const xe=kN(Qt),de=Math.min(xe*-1,0)*Zt;Cr(mt.current,{transform:yr(re)?`translate3d(0, ${de}px, 0)`:`translate3d(${de}px, 0, 0)`});return}const ge=1-ne;if((er||I&&Jt===I-1)&&(a==null||a(xt,ne),Cr(Ve.current,{opacity:`${ge}`,transition:"none"},!0)),j&&Ve.current&&p){const xe=Math.min(qe()+ne*(1-qe()),1),de=8-ne*8,Ie=Math.max(0,14-ne*14);Cr(j,{borderRadius:`${de}px`,transform:yr(re)?`scale(${xe}) translate3d(0, ${Ie}px, 0)`:`scale(${xe}) translate3d(${Ie}px, 0, 0)`,transition:"none"},!0)}if(!g){const xe=N*Zt;Cr(mt.current,{transform:yr(re)?`translate3d(0, ${xe}px, 0)`:`translate3d(${xe}px, 0, 0)`})}}}Me.useEffect(()=>{window.requestAnimationFrame(()=>{at.current=!0})},[]),Me.useEffect(()=>{var xt;function Zt(){if(!mt.current||!De)return;const Qt=document.activeElement;if(n0(Qt)||Ft.current){var Ht;const ie=((Ht=window.visualViewport)==null?void 0:Ht.height)||0,N=window.innerHeight;let j=N-ie;const K=mt.current.getBoundingClientRect().height||0,ne=K>N*.8;Sn.current||(Sn.current=K);const me=mt.current.getBoundingClientRect().top;if(Math.abs(Wt.current-j)>60&&(Ft.current=!Ft.current),g&&g.length>0&&En&&Jt){const ge=En[Jt]||0;j+=ge}if(Wt.current=j,K>ie||Ft.current){const ge=mt.current.getBoundingClientRect().height;let xe=ge;ge>ie&&(xe=ie-(ne?me:r0)),H?mt.current.style.height=`${ge-Math.max(j,0)}px`:mt.current.style.height=`${Math.max(xe,ie-me)}px`}else hN()||(mt.current.style.height=`${Sn.current}px`);g&&g.length>0&&!Ft.current?mt.current.style.bottom="0px":mt.current.style.bottom=`${Math.max(j,0)}px`}}return(xt=window.visualViewport)==null||xt.addEventListener("resize",Zt),()=>{var Qt;return(Qt=window.visualViewport)==null?void 0:Qt.removeEventListener("resize",Zt)}},[Jt,g,En]);function zn(xt){$t(),L==null||L(),xt||Je(!1),setTimeout(()=>{g&&Ir(g[0])},Zn.DURATION*1e3)}function Ye(){if(!mt.current)return;const xt=document.querySelector("[data-vaul-drawer-wrapper]"),Zt=jp(mt.current,re);Cr(mt.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`}),Cr(Ve.current,{transition:`opacity ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`,opacity:"1"}),p&&Zt&&Zt>0&&Ze&&Cr(xt,{borderRadius:`${GP}px`,overflow:"hidden",...yr(re)?{transform:`scale(${qe()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${qe()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${Zn.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Zn.EASE.join(",")})`},!0)}function $t(){!Ue||!mt.current||(mt.current.classList.remove(Lv),dt.current=!1,et(!1),_t.current=new Date)}function Dt(xt){if(!Ue||!mt.current)return;mt.current.classList.remove(Lv),dt.current=!1,et(!1),_t.current=new Date;const Zt=jp(mt.current,re);if(!xt||!dn(xt.target,!1)||!Zt||Number.isNaN(Zt)||He.current===null)return;const Qt=_t.current.getTime()-He.current.getTime(),Ht=Ut.current-(yr(re)?xt.pageY:xt.pageX),ie=Math.abs(Ht)/Qt;if(ie>.05&&(Le(!0),setTimeout(()=>{Le(!1)},200)),g){xn({draggedDistance:Ht*(re==="bottom"||re==="right"?1:-1),closeDrawer:zn,velocity:ie,dismissible:P}),h==null||h(xt,!0);return}if(re==="bottom"||re==="right"?Ht>0:Ht<0){Ye(),h==null||h(xt,!0);return}if(ie>HP){zn(),h==null||h(xt,!1);return}var N;const j=Math.min((N=mt.current.getBoundingClientRect().height)!=null?N:0,window.innerHeight);var K;const ne=Math.min((K=mt.current.getBoundingClientRect().width)!=null?K:0,window.innerWidth),me=re==="left"||re==="right";if(Math.abs(Zt)>=(me?ne:j)*S){zn(),h==null||h(xt,!1);return}h==null||h(xt,!0),Ye()}Me.useEffect(()=>(Ze&&(Cr(document.documentElement,{scrollBehavior:"auto"}),We.current=new Date),()=>{SN(document.documentElement,"scrollBehavior")}),[Ze]);function Gn(xt){const Zt=xt?(window.innerWidth-_l)/window.innerWidth:1,Qt=xt?-_l:0;Pt.current&&window.clearTimeout(Pt.current),Cr(mt.current,{transition:`transform ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`,transform:yr(re)?`scale(${Zt}) translate3d(0, ${Qt}px, 0)`:`scale(${Zt}) translate3d(${Qt}px, 0, 0)`}),!xt&&mt.current&&(Pt.current=setTimeout(()=>{const Ht=jp(mt.current,re);Cr(mt.current,{transition:"none",transform:yr(re)?`translate3d(0, ${Ht}px, 0)`:`translate3d(${Ht}px, 0, 0)`})},500))}function xr(xt,Zt){if(Zt<0)return;const Qt=(window.innerWidth-_l)/window.innerWidth,Ht=Qt+Zt*(1-Qt),ie=-_l+Zt*_l;Cr(mt.current,{transform:yr(re)?`scale(${Ht}) translate3d(0, ${ie}px, 0)`:`scale(${Ht}) translate3d(${ie}px, 0, 0)`,transition:"none"})}function Bt(xt,Zt){const Qt=yr(re)?window.innerHeight:window.innerWidth,Ht=Zt?(Qt-_l)/Qt:1,ie=Zt?-_l:0;Zt&&Cr(mt.current,{transition:`transform ${Zn.DURATION}s cubic-bezier(${Zn.EASE.join(",")})`,transform:yr(re)?`scale(${Ht}) translate3d(0, ${ie}px, 0)`:`scale(${Ht}) translate3d(${ie}px, 0, 0)`})}return Me.useEffect(()=>{te||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[te]),Me.createElement(NP,{defaultOpen:pe,onOpenChange:xt=>{!P&&!xt||(xt?ke(!0):zn(!0),Je(xt))},open:Ze},Me.createElement(OP.Provider,{value:{activeSnapPoint:Nt,snapPoints:g,setActiveSnapPoint:Ir,drawerRef:mt,overlayRef:Ve,onOpenChange:t,onPress:tr,onRelease:Dt,onDrag:cr,dismissible:P,shouldAnimate:at,handleOnly:k,isOpen:Ze,isDragging:Ue,shouldFade:er,closeDrawer:zn,onNestedDrag:xr,onNestedOpenChange:Gn,onNestedRelease:Bt,keyboardIsOpen:Ft,modal:te,snapPointsOffset:En,activeSnapPointIndex:Jt,direction:re,shouldScaleBackground:p,setBackgroundColorOnScale:c,noBodyStyles:W,container:Ce,autoFocus:Fe}},i))}const ZP=Me.forwardRef(function({...e},t){const{overlayRef:i,snapPoints:a,onRelease:h,shouldFade:g,isOpen:p,modal:c,shouldAnimate:S}=sf(),E=UP(t,i),P=a&&a.length>0;if(!c)return null;const k=Me.useCallback(I=>h(I),[h]);return Me.createElement(fg,{onMouseUp:k,ref:E,"data-vaul-overlay":"","data-vaul-snap-points":p&&P?"true":"false","data-vaul-snap-points-overlay":p&&g?"true":"false","data-vaul-animate":S!=null&&S.current?"true":"false",...e})});ZP.displayName="Drawer.Overlay";const XP=Me.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:i,...a},h){const{drawerRef:g,onPress:p,onRelease:c,onDrag:S,keyboardIsOpen:E,snapPointsOffset:P,activeSnapPointIndex:k,modal:I,isOpen:G,direction:Z,snapPoints:H,container:te,handleOnly:L,shouldAnimate:V,autoFocus:W}=sf(),[re,pe]=Me.useState(!1),_e=UP(h,g),le=Me.useRef(null),ce=Me.useRef(null),De=Me.useRef(!1),Be=H&&H.length>0;MN();const Ce=(ze,Qe,Ze=0)=>{if(De.current)return!0;const Je=Math.abs(ze.y),$e=Math.abs(ze.x),ke=$e>Je,Ue=["bottom","right"].includes(Qe)?1:-1;if(Qe==="left"||Qe==="right"){if(!(ze.x*Ue<0)&&$e>=0&&$e<=Ze)return ke}else if(!(ze.y*Ue<0)&&Je>=0&&Je<=Ze)return!ke;return De.current=!0,!0};Me.useEffect(()=>{Be&&window.requestAnimationFrame(()=>{pe(!0)})},[]);function Fe(ze){le.current=null,De.current=!1,c(ze)}return Me.createElement(pg,{"data-vaul-drawer-direction":Z,"data-vaul-drawer":"","data-vaul-delayed-snap-points":re?"true":"false","data-vaul-snap-points":G&&Be?"true":"false","data-vaul-custom-container":te?"true":"false","data-vaul-animate":V!=null&&V.current?"true":"false",...a,ref:_e,style:P&&P.length>0?{"--snap-point-height":`${P[k??0]}px`,...t}:t,onPointerDown:ze=>{L||(a.onPointerDown==null||a.onPointerDown.call(a,ze),le.current={x:ze.pageX,y:ze.pageY},p(ze))},onOpenAutoFocus:ze=>{i==null||i(ze),W||ze.preventDefault()},onPointerDownOutside:ze=>{if(e==null||e(ze),!I||ze.defaultPrevented){ze.preventDefault();return}E.current&&(E.current=!1)},onFocusOutside:ze=>{if(!I){ze.preventDefault();return}},onPointerMove:ze=>{if(ce.current=ze,L||(a.onPointerMove==null||a.onPointerMove.call(a,ze),!le.current))return;const Qe=ze.pageY-le.current.y,Ze=ze.pageX-le.current.x,Je=ze.pointerType==="touch"?10:2;Ce({x:Ze,y:Qe},Z,Je)?S(ze):(Math.abs(Ze)>Je||Math.abs(Qe)>Je)&&(le.current=null)},onPointerUp:ze=>{a.onPointerUp==null||a.onPointerUp.call(a,ze),le.current=null,De.current=!1,c(ze)},onPointerOut:ze=>{a.onPointerOut==null||a.onPointerOut.call(a,ze),Fe(ce.current)},onContextMenu:ze=>{a.onContextMenu==null||a.onContextMenu.call(a,ze),ce.current&&Fe(ce.current)}})});XP.displayName="Drawer.Content";const RN=250,LN=120,BN=Me.forwardRef(function({preventCycle:e=!1,children:t,...i},a){const{closeDrawer:h,isDragging:g,snapPoints:p,activeSnapPoint:c,setActiveSnapPoint:S,dismissible:E,handleOnly:P,isOpen:k,onPress:I,onDrag:G}=sf(),Z=Me.useRef(null),H=Me.useRef(!1);function te(){if(H.current){W();return}window.setTimeout(()=>{L()},LN)}function L(){if(g||e||H.current){W();return}if(W(),!p||p.length===0){E||h();return}if(c===p[p.length-1]&&E){h();return}const pe=p.findIndex(le=>le===c);if(pe===-1)return;const _e=p[pe+1];S(_e)}function V(){Z.current=window.setTimeout(()=>{H.current=!0},RN)}function W(){Z.current&&window.clearTimeout(Z.current),H.current=!1}return Me.createElement("div",{onClick:te,onPointerCancel:W,onPointerDown:re=>{P&&I(re),V()},onPointerMove:re=>{P&&G(re)},ref:a,"data-vaul-drawer-visible":k?"true":"false","data-vaul-handle":"","aria-hidden":"true",...i},Me.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});BN.displayName="Drawer.Handle";function FN(e){const t=sf(),{container:i=t.container,...a}=e;return Me.createElement(Zx,{container:i,...a})}const Bo={Root:zN,Content:XP,Overlay:ZP,Portal:FN,Title:Xx,Description:Kx},KP=({shouldScaleBackground:e=!0,...t})=>Q.jsx(Bo.Root,{shouldScaleBackground:e,...t});KP.displayName="Drawer";const NN=Bo.Portal,YP=$.forwardRef(({className:e,...t},i)=>Q.jsx(Bo.Overlay,{ref:i,className:Yt("fixed inset-0 z-[250] bg-black/80",e),...t}));YP.displayName=Bo.Overlay.displayName;const JP=$.forwardRef(({className:e,children:t,showOverlay:i=!0,...a},h)=>Q.jsxs(NN,{children:[i&&Q.jsx(YP,{}),Q.jsx(Bo.Content,{ref:h,className:Yt("fixed inset-x-0 bottom-0 z-[251] mt-24 flex h-auto flex-col rounded-t-[10px] border border-border bg-background",e),...a,children:t})]}));JP.displayName="DrawerContent";const ON=$.forwardRef(({className:e,...t},i)=>Q.jsx(Bo.Title,{ref:i,className:Yt("text-lg font-semibold leading-none tracking-tight",e),...t}));ON.displayName=Bo.Title.displayName;const jN=$.forwardRef(({className:e,...t},i)=>Q.jsx(Bo.Description,{ref:i,className:Yt("text-sm text-neutral-500",e),...t}));jN.displayName=Bo.Description.displayName;function VN(e){return Object.prototype.toString.call(e)==="[object Object]"}function FS(e){return VN(e)||Array.isArray(e)}function UN(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Jx(e,t){const i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;const h=JSON.stringify(Object.keys(e.breakpoints||{})),g=JSON.stringify(Object.keys(t.breakpoints||{}));return h!==g?!1:i.every(p=>{const c=e[p],S=t[p];return typeof c=="function"?`${c}`==`${S}`:!FS(c)||!FS(S)?c===S:Jx(c,S)})}function NS(e){return e.concat().sort((t,i)=>t.name>i.name?1:-1).map(t=>t.options)}function $N(e,t){if(e.length!==t.length)return!1;const i=NS(e),a=NS(t);return i.every((h,g)=>{const p=a[g];return Jx(h,p)})}function Qx(e){return typeof e=="number"}function i0(e){return typeof e=="string"}function mg(e){return typeof e=="boolean"}function OS(e){return Object.prototype.toString.call(e)==="[object Object]"}function Yn(e){return Math.abs(e)}function eb(e){return Math.sign(e)}function wd(e,t){return Yn(e-t)}function HN(e,t){if(e===0||t===0||Yn(e)<=Yn(t))return 0;const i=wd(Yn(e),Yn(t));return Yn(i/e)}function GN(e){return Math.round(e*100)/100}function Wd(e){return qd(e).map(Number)}function Fs(e){return e[of(e)]}function of(e){return Math.max(0,e.length-1)}function tb(e,t){return t===of(e)}function jS(e,t=0){return Array.from(Array(e),(i,a)=>t+a)}function qd(e){return Object.keys(e)}function QP(e,t){return[e,t].reduce((i,a)=>(qd(a).forEach(h=>{const g=i[h],p=a[h],c=OS(g)&&OS(p);i[h]=c?QP(g,p):p}),i),{})}function s0(e,t){return typeof t.MouseEvent<"u"&&e instanceof t.MouseEvent}function WN(e,t){const i={start:a,center:h,end:g};function a(){return 0}function h(S){return g(S)/2}function g(S){return t-S}function p(S,E){return i0(e)?i[e](S):e(t,S,E)}return{measure:p}}function Zd(){let e=[];function t(h,g,p,c={passive:!0}){let S;if("addEventListener"in h)h.addEventListener(g,p,c),S=()=>h.removeEventListener(g,p,c);else{const E=h;E.addListener(p),S=()=>E.removeListener(p)}return e.push(S),a}function i(){e=e.filter(h=>h())}const a={add:t,clear:i};return a}function qN(e,t,i,a){const h=Zd(),g=1e3/60;let p=null,c=0,S=0;function E(){h.add(e,"visibilitychange",()=>{e.hidden&&Z()})}function P(){G(),h.clear()}function k(te){if(!S)return;p||(p=te,i(),i());const L=te-p;for(p=te,c+=L;c>=g;)i(),c-=g;const V=c/g;a(V),S&&(S=t.requestAnimationFrame(k))}function I(){S||(S=t.requestAnimationFrame(k))}function G(){t.cancelAnimationFrame(S),p=null,c=0,S=0}function Z(){p=null,c=0}return{init:E,destroy:P,start:I,stop:G,update:i,render:a}}function ZN(e,t){const i=t==="rtl",a=e==="y",h=a?"y":"x",g=a?"x":"y",p=!a&&i?-1:1,c=P(),S=k();function E(Z){const{height:H,width:te}=Z;return a?H:te}function P(){return a?"top":i?"right":"left"}function k(){return a?"bottom":i?"left":"right"}function I(Z){return Z*p}return{scroll:h,cross:g,startEdge:c,endEdge:S,measureSize:E,direction:I}}function Nl(e=0,t=0){const i=Yn(e-t);function a(E){return E<e}function h(E){return E>t}function g(E){return a(E)||h(E)}function p(E){return g(E)?a(E)?e:t:E}function c(E){return i?E-i*Math.ceil((E-t)/i):E}return{length:i,max:t,min:e,constrain:p,reachedAny:g,reachedMax:h,reachedMin:a,removeOffset:c}}function eI(e,t,i){const{constrain:a}=Nl(0,e),h=e+1;let g=p(t);function p(I){return i?Yn((h+I)%h):a(I)}function c(){return g}function S(I){return g=p(I),k}function E(I){return P().set(c()+I)}function P(){return eI(e,c(),i)}const k={get:c,set:S,add:E,clone:P};return k}function XN(e,t,i,a,h,g,p,c,S,E,P,k,I,G,Z,H,te,L,V){const{cross:W,direction:re}=e,pe=["INPUT","SELECT","TEXTAREA"],_e={passive:!1},le=Zd(),ce=Zd(),De=Nl(50,225).constrain(G.measure(20)),Be={mouse:300,touch:400},Ce={mouse:500,touch:600},Fe=Z?43:25;let ze=!1,Qe=0,Ze=0,Je=!1,$e=!1,ke=!1,Ue=!1;function et(at){if(!V)return;function Wt(wn){(mg(V)||V(at,wn))&&_t(wn)}const mt=t;le.add(mt,"dragstart",wn=>wn.preventDefault(),_e).add(mt,"touchmove",()=>{},_e).add(mt,"touchend",()=>{}).add(mt,"touchstart",Wt).add(mt,"mousedown",Wt).add(mt,"touchcancel",dt).add(mt,"contextmenu",dt).add(mt,"click",Pt,!0)}function pt(){le.clear(),ce.clear()}function Le(){const at=Ue?i:t;ce.add(at,"touchmove",tt,_e).add(at,"touchend",dt).add(at,"mousemove",tt,_e).add(at,"mouseup",dt)}function Ve(at){const Wt=at.nodeName||"";return pe.includes(Wt)}function We(){return(Z?Ce:Be)[Ue?"mouse":"touch"]}function He(at,Wt){const mt=k.add(eb(at)*-1),wn=P.byDistance(at,!Z).distance;return Z||Yn(at)<De?wn:te&&Wt?wn*.5:P.byIndex(mt.get(),0).distance}function _t(at){const Wt=s0(at,a);Ue=Wt,ke=Z&&Wt&&!at.buttons&&ze,ze=wd(h.get(),p.get())>=2,!(Wt&&at.button!==0)&&(Ve(at.target)||(Je=!0,g.pointerDown(at),E.useFriction(0).useDuration(0),h.set(p),Le(),Qe=g.readPoint(at),Ze=g.readPoint(at,W),I.emit("pointerDown")))}function tt(at){if(!s0(at,a)&&at.touches.length>=2)return dt(at);const mt=g.readPoint(at),wn=g.readPoint(at,W),Pe=wd(mt,Qe),Sn=wd(wn,Ze);if(!$e&&!Ue&&(!at.cancelable||($e=Pe>Sn,!$e)))return dt(at);const dr=g.pointerMove(at);Pe>H&&(ke=!0),E.useFriction(.3).useDuration(.75),c.start(),h.add(re(dr)),at.preventDefault()}function dt(at){const mt=P.byDistance(0,!1).index!==k.get(),wn=g.pointerUp(at)*We(),Pe=He(re(wn),mt),Sn=HN(wn,Pe),dr=Fe-10*Sn,Nt=L+Sn/50;$e=!1,Je=!1,ce.clear(),E.useDuration(dr).useFriction(Nt),S.distance(Pe,!Z),Ue=!1,I.emit("pointerUp")}function Pt(at){ke&&(at.stopPropagation(),at.preventDefault(),ke=!1)}function Ut(){return Je}return{init:et,destroy:pt,pointerDown:Ut}}function KN(e,t){let a,h;function g(k){return k.timeStamp}function p(k,I){const Z=`client${(I||e.scroll)==="x"?"X":"Y"}`;return(s0(k,t)?k:k.touches[0])[Z]}function c(k){return a=k,h=k,p(k)}function S(k){const I=p(k)-p(h),G=g(k)-g(a)>170;return h=k,G&&(a=k),I}function E(k){if(!a||!h)return 0;const I=p(h)-p(a),G=g(k)-g(a),Z=g(k)-g(h)>170,H=I/G;return G&&!Z&&Yn(H)>.1?H:0}return{pointerDown:c,pointerMove:S,pointerUp:E,readPoint:p}}function YN(){function e(i){const{offsetTop:a,offsetLeft:h,offsetWidth:g,offsetHeight:p}=i;return{top:a,right:h+g,bottom:a+p,left:h,width:g,height:p}}return{measure:e}}function JN(e){function t(a){return e*(a/100)}return{measure:t}}function QN(e,t,i,a,h,g,p){const c=[e].concat(a);let S,E,P=[],k=!1;function I(te){return h.measureSize(p.measure(te))}function G(te){if(!g)return;E=I(e),P=a.map(I);function L(V){for(const W of V){if(k)return;const re=W.target===e,pe=a.indexOf(W.target),_e=re?E:P[pe],le=I(re?e:a[pe]);if(Yn(le-_e)>=.5){te.reInit(),t.emit("resize");break}}}S=new ResizeObserver(V=>{(mg(g)||g(te,V))&&L(V)}),i.requestAnimationFrame(()=>{c.forEach(V=>S.observe(V))})}function Z(){k=!0,S&&S.disconnect()}return{init:G,destroy:Z}}function eO(e,t,i,a,h,g){let p=0,c=0,S=h,E=g,P=e.get(),k=0;function I(){const _e=a.get()-e.get(),le=!S;let ce=0;return le?(p=0,i.set(a),e.set(a),ce=_e):(i.set(e),p+=_e/S,p*=E,P+=p,e.add(p),ce=P-k),c=eb(ce),k=P,pe}function G(){const _e=a.get()-t.get();return Yn(_e)<.001}function Z(){return S}function H(){return c}function te(){return p}function L(){return W(h)}function V(){return re(g)}function W(_e){return S=_e,pe}function re(_e){return E=_e,pe}const pe={direction:H,duration:Z,velocity:te,seek:I,settled:G,useBaseFriction:V,useBaseDuration:L,useFriction:re,useDuration:W};return pe}function tO(e,t,i,a,h){const g=h.measure(10),p=h.measure(50),c=Nl(.1,.99);let S=!1;function E(){return!(S||!e.reachedAny(i.get())||!e.reachedAny(t.get()))}function P(G){if(!E())return;const Z=e.reachedMin(t.get())?"min":"max",H=Yn(e[Z]-t.get()),te=i.get()-t.get(),L=c.constrain(H/p);i.subtract(te*L),!G&&Yn(te)<g&&(i.set(e.constrain(i.get())),a.useDuration(25).useBaseFriction())}function k(G){S=!G}return{shouldConstrain:E,constrain:P,toggleActive:k}}function nO(e,t,i,a,h){const g=Nl(-t+e,0),p=k(),c=P(),S=I();function E(Z,H){return wd(Z,H)<=1}function P(){const Z=p[0],H=Fs(p),te=p.lastIndexOf(Z),L=p.indexOf(H)+1;return Nl(te,L)}function k(){return i.map((Z,H)=>{const{min:te,max:L}=g,V=g.constrain(Z),W=!H,re=tb(i,H);return W?L:re||E(te,V)?te:E(L,V)?L:V}).map(Z=>parseFloat(Z.toFixed(3)))}function I(){if(t<=e+h)return[g.max];if(a==="keepSnaps")return p;const{min:Z,max:H}=c;return p.slice(Z,H)}return{snapsContained:S,scrollContainLimit:c}}function rO(e,t,i){const a=t[0],h=i?a-e:Fs(t);return{limit:Nl(h,a)}}function iO(e,t,i,a){const g=t.min+.1,p=t.max+.1,{reachedMin:c,reachedMax:S}=Nl(g,p);function E(I){return I===1?S(i.get()):I===-1?c(i.get()):!1}function P(I){if(!E(I))return;const G=e*(I*-1);a.forEach(Z=>Z.add(G))}return{loop:P}}function sO(e){const{max:t,length:i}=e;function a(g){const p=g-t;return i?p/-i:0}return{get:a}}function oO(e,t,i,a,h){const{startEdge:g,endEdge:p}=e,{groupSlides:c}=h,S=k().map(t.measure),E=I(),P=G();function k(){return c(a).map(H=>Fs(H)[p]-H[0][g]).map(Yn)}function I(){return a.map(H=>i[g]-H[g]).map(H=>-Yn(H))}function G(){return c(E).map(H=>H[0]).map((H,te)=>H+S[te])}return{snaps:E,snapsAligned:P}}function aO(e,t,i,a,h,g){const{groupSlides:p}=h,{min:c,max:S}=a,E=P();function P(){const I=p(g),G=!e||t==="keepSnaps";return i.length===1?[g]:G?I:I.slice(c,S).map((Z,H,te)=>{const L=!H,V=tb(te,H);if(L){const W=Fs(te[0])+1;return jS(W)}if(V){const W=of(g)-Fs(te)[0]+1;return jS(W,Fs(te)[0])}return Z})}return{slideRegistry:E}}function lO(e,t,i,a,h){const{reachedAny:g,removeOffset:p,constrain:c}=a;function S(Z){return Z.concat().sort((H,te)=>Yn(H)-Yn(te))[0]}function E(Z){const H=e?p(Z):c(Z),te=t.map((V,W)=>({diff:P(V-H,0),index:W})).sort((V,W)=>Yn(V.diff)-Yn(W.diff)),{index:L}=te[0];return{index:L,distance:H}}function P(Z,H){const te=[Z,Z+i,Z-i];if(!e)return Z;if(!H)return S(te);const L=te.filter(V=>eb(V)===H);return L.length?S(L):Fs(te)-i}function k(Z,H){const te=t[Z]-h.get(),L=P(te,H);return{index:Z,distance:L}}function I(Z,H){const te=h.get()+Z,{index:L,distance:V}=E(te),W=!e&&g(te);if(!H||W)return{index:L,distance:Z};const re=t[L]-V,pe=Z+P(re,0);return{index:L,distance:pe}}return{byDistance:I,byIndex:k,shortcut:P}}function cO(e,t,i,a,h,g,p){function c(k){const I=k.distance,G=k.index!==t.get();g.add(I),I&&(a.duration()?e.start():(e.update(),e.render(1),e.update())),G&&(i.set(t.get()),t.set(k.index),p.emit("select"))}function S(k,I){const G=h.byDistance(k,I);c(G)}function E(k,I){const G=t.clone().set(k),Z=h.byIndex(G.get(),I);c(Z)}return{distance:S,index:E}}function uO(e,t,i,a,h,g,p,c){const S={passive:!0,capture:!0};let E=0;function P(G){if(!c)return;function Z(H){if(new Date().getTime()-E>10)return;p.emit("slideFocusStart"),e.scrollLeft=0;const V=i.findIndex(W=>W.includes(H));Qx(V)&&(h.useDuration(0),a.index(V,0),p.emit("slideFocus"))}g.add(document,"keydown",k,!1),t.forEach((H,te)=>{g.add(H,"focus",L=>{(mg(c)||c(G,L))&&Z(te)},S)})}function k(G){G.code==="Tab"&&(E=new Date().getTime())}return{init:P}}function ad(e){let t=e;function i(){return t}function a(S){t=p(S)}function h(S){t+=p(S)}function g(S){t-=p(S)}function p(S){return Qx(S)?S:S.get()}return{get:i,set:a,add:h,subtract:g}}function tI(e,t){const i=e.scroll==="x"?p:c,a=t.style;let h=null,g=!1;function p(I){return`translate3d(${I}px,0px,0px)`}function c(I){return`translate3d(0px,${I}px,0px)`}function S(I){if(g)return;const G=GN(e.direction(I));G!==h&&(a.transform=i(G),h=G)}function E(I){g=!I}function P(){g||(a.transform="",t.getAttribute("style")||t.removeAttribute("style"))}return{clear:P,to:S,toggleActive:E}}function hO(e,t,i,a,h,g,p,c,S){const P=Wd(h),k=Wd(h).reverse(),I=L().concat(V());function G(le,ce){return le.reduce((De,Be)=>De-h[Be],ce)}function Z(le,ce){return le.reduce((De,Be)=>G(De,ce)>0?De.concat([Be]):De,[])}function H(le){return g.map((ce,De)=>({start:ce-a[De]+.5+le,end:ce+t-.5+le}))}function te(le,ce,De){const Be=H(ce);return le.map(Ce=>{const Fe=De?0:-i,ze=De?i:0,Qe=De?"end":"start",Ze=Be[Ce][Qe];return{index:Ce,loopPoint:Ze,slideLocation:ad(-1),translate:tI(e,S[Ce]),target:()=>c.get()>Ze?Fe:ze}})}function L(){const le=p[0],ce=Z(k,le);return te(ce,i,!1)}function V(){const le=t-p[0]-1,ce=Z(P,le);return te(ce,-i,!0)}function W(){return I.every(({index:le})=>{const ce=P.filter(De=>De!==le);return G(ce,t)<=.1})}function re(){I.forEach(le=>{const{target:ce,translate:De,slideLocation:Be}=le,Ce=ce();Ce!==Be.get()&&(De.to(Ce),Be.set(Ce))})}function pe(){I.forEach(le=>le.translate.clear())}return{canLoop:W,clear:pe,loop:re,loopPoints:I}}function dO(e,t,i){let a,h=!1;function g(S){if(!i)return;function E(P){for(const k of P)if(k.type==="childList"){S.reInit(),t.emit("slidesChanged");break}}a=new MutationObserver(P=>{h||(mg(i)||i(S,P))&&E(P)}),a.observe(e,{childList:!0})}function p(){a&&a.disconnect(),h=!0}return{init:g,destroy:p}}function fO(e,t,i,a){const h={};let g=null,p=null,c,S=!1;function E(){c=new IntersectionObserver(Z=>{S||(Z.forEach(H=>{const te=t.indexOf(H.target);h[te]=H}),g=null,p=null,i.emit("slidesInView"))},{root:e.parentElement,threshold:a}),t.forEach(Z=>c.observe(Z))}function P(){c&&c.disconnect(),S=!0}function k(Z){return qd(h).reduce((H,te)=>{const L=parseInt(te),{isIntersecting:V}=h[L];return(Z&&V||!Z&&!V)&&H.push(L),H},[])}function I(Z=!0){if(Z&&g)return g;if(!Z&&p)return p;const H=k(Z);return Z&&(g=H),Z||(p=H),H}return{init:E,destroy:P,get:I}}function pO(e,t,i,a,h,g){const{measureSize:p,startEdge:c,endEdge:S}=e,E=i[0]&&h,P=Z(),k=H(),I=i.map(p),G=te();function Z(){if(!E)return 0;const V=i[0];return Yn(t[c]-V[c])}function H(){if(!E)return 0;const V=g.getComputedStyle(Fs(a));return parseFloat(V.getPropertyValue(`margin-${S}`))}function te(){return i.map((V,W,re)=>{const pe=!W,_e=tb(re,W);return pe?I[W]+P:_e?I[W]+k:re[W+1][c]-V[c]}).map(Yn)}return{slideSizes:I,slideSizesWithGaps:G,startGap:P,endGap:k}}function mO(e,t,i,a,h,g,p,c,S){const{startEdge:E,endEdge:P,direction:k}=e,I=Qx(i);function G(L,V){return Wd(L).filter(W=>W%V===0).map(W=>L.slice(W,W+V))}function Z(L){return L.length?Wd(L).reduce((V,W,re)=>{const pe=Fs(V)||0,_e=pe===0,le=W===of(L),ce=h[E]-g[pe][E],De=h[E]-g[W][P],Be=!a&&_e?k(p):0,Ce=!a&&le?k(c):0,Fe=Yn(De-Ce-(ce+Be));return re&&Fe>t+S&&V.push(W),le&&V.push(L.length),V},[]).map((V,W,re)=>{const pe=Math.max(re[W-1]||0);return L.slice(pe,V)}):[]}function H(L){return I?G(L,i):Z(L)}return{groupSlides:H}}function gO(e,t,i,a,h,g,p){const{align:c,axis:S,direction:E,startIndex:P,loop:k,duration:I,dragFree:G,dragThreshold:Z,inViewThreshold:H,slidesToScroll:te,skipSnaps:L,containScroll:V,watchResize:W,watchSlides:re,watchDrag:pe,watchFocus:_e}=g,le=2,ce=YN(),De=ce.measure(t),Be=i.map(ce.measure),Ce=ZN(S,E),Fe=Ce.measureSize(De),ze=JN(Fe),Qe=WN(c,Fe),Ze=!k&&!!V,Je=k||!!V,{slideSizes:$e,slideSizesWithGaps:ke,startGap:Ue,endGap:et}=pO(Ce,De,Be,i,Je,h),pt=mO(Ce,Fe,te,k,De,Be,Ue,et,le),{snaps:Le,snapsAligned:Ve}=oO(Ce,Qe,De,Be,pt),We=-Fs(Le)+Fs(ke),{snapsContained:He,scrollContainLimit:_t}=nO(Fe,We,Ve,V,le),tt=Ze?He:Ve,{limit:dt}=rO(We,tt,k),Pt=eI(of(tt),P,k),Ut=Pt.clone(),Ft=Wd(i),at=({dragHandler:dn,scrollBody:cr,scrollBounds:zn,options:{loop:Ye}})=>{Ye||zn.constrain(dn.pointerDown()),cr.seek()},Wt=({scrollBody:dn,translate:cr,location:zn,offsetLocation:Ye,previousLocation:$t,scrollLooper:Dt,slideLooper:Gn,dragHandler:xr,animation:Bt,eventHandler:xt,scrollBounds:Zt,options:{loop:Qt}},Ht)=>{const ie=dn.settled(),N=!Zt.shouldConstrain(),j=Qt?ie:ie&&N,K=j&&!xr.pointerDown();K&&Bt.stop();const ne=zn.get()*Ht+$t.get()*(1-Ht);Ye.set(ne),Qt&&(Dt.loop(dn.direction()),Gn.loop()),cr.to(Ye.get()),K&&xt.emit("settle"),j||xt.emit("scroll")},mt=qN(a,h,()=>at(tr),dn=>Wt(tr,dn)),wn=.68,Pe=tt[Pt.get()],Sn=ad(Pe),dr=ad(Pe),Nt=ad(Pe),Jt=ad(Pe),Ir=eO(Sn,Nt,dr,Jt,I,wn),xn=lO(k,tt,We,dt,Jt),En=cO(mt,Pt,Ut,Ir,xn,Jt,p),ci=sO(dt),er=Zd(),Xr=fO(t,i,p,H),{slideRegistry:Ti}=aO(Ze,V,tt,_t,pt,Ft),qe=uO(e,i,Ti,En,Ir,er,p,_e),tr={ownerDocument:a,ownerWindow:h,eventHandler:p,containerRect:De,slideRects:Be,animation:mt,axis:Ce,dragHandler:XN(Ce,e,a,h,Jt,KN(Ce,h),Sn,mt,En,Ir,xn,Pt,p,ze,G,Z,L,wn,pe),eventStore:er,percentOfView:ze,index:Pt,indexPrevious:Ut,limit:dt,location:Sn,offsetLocation:Nt,previousLocation:dr,options:g,resizeHandler:QN(t,p,h,i,Ce,W,ce),scrollBody:Ir,scrollBounds:tO(dt,Nt,Jt,Ir,ze),scrollLooper:iO(We,dt,Nt,[Sn,Nt,dr,Jt]),scrollProgress:ci,scrollSnapList:tt.map(ci.get),scrollSnaps:tt,scrollTarget:xn,scrollTo:En,slideLooper:hO(Ce,Fe,We,$e,ke,Le,tt,Nt,i),slideFocus:qe,slidesHandler:dO(t,p,re),slidesInView:Xr,slideIndexes:Ft,slideRegistry:Ti,slidesToScroll:pt,target:Jt,translate:tI(Ce,t)};return tr}function yO(){let e={},t;function i(E){t=E}function a(E){return e[E]||[]}function h(E){return a(E).forEach(P=>P(t,E)),S}function g(E,P){return e[E]=a(E).concat([P]),S}function p(E,P){return e[E]=a(E).filter(k=>k!==P),S}function c(){e={}}const S={init:i,emit:h,off:p,on:g,clear:c};return S}const vO={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function _O(e){function t(g,p){return QP(g,p||{})}function i(g){const p=g.breakpoints||{},c=qd(p).filter(S=>e.matchMedia(S).matches).map(S=>p[S]).reduce((S,E)=>t(S,E),{});return t(g,c)}function a(g){return g.map(p=>qd(p.breakpoints||{})).reduce((p,c)=>p.concat(c),[]).map(e.matchMedia)}return{mergeOptions:t,optionsAtMedia:i,optionsMediaQueries:a}}function xO(e){let t=[];function i(g,p){return t=p.filter(({options:c})=>e.optionsAtMedia(c).active!==!1),t.forEach(c=>c.init(g,e)),p.reduce((c,S)=>Object.assign(c,{[S.name]:S}),{})}function a(){t=t.filter(g=>g.destroy())}return{init:i,destroy:a}}function Vm(e,t,i){const a=e.ownerDocument,h=a.defaultView,g=_O(h),p=xO(g),c=Zd(),S=yO(),{mergeOptions:E,optionsAtMedia:P,optionsMediaQueries:k}=g,{on:I,off:G,emit:Z}=S,H=Ce;let te=!1,L,V=E(vO,Vm.globalOptions),W=E(V),re=[],pe,_e,le;function ce(){const{container:Ft,slides:at}=W;_e=(i0(Ft)?e.querySelector(Ft):Ft)||e.children[0];const mt=i0(at)?_e.querySelectorAll(at):at;le=[].slice.call(mt||_e.children)}function De(Ft){const at=gO(e,_e,le,a,h,Ft,S);if(Ft.loop&&!at.slideLooper.canLoop()){const Wt=Object.assign({},Ft,{loop:!1});return De(Wt)}return at}function Be(Ft,at){te||(V=E(V,Ft),W=P(V),re=at||re,ce(),L=De(W),k([V,...re.map(({options:Wt})=>Wt)]).forEach(Wt=>c.add(Wt,"change",Ce)),W.active&&(L.translate.to(L.location.get()),L.animation.init(),L.slidesInView.init(),L.slideFocus.init(Ut),L.eventHandler.init(Ut),L.resizeHandler.init(Ut),L.slidesHandler.init(Ut),L.options.loop&&L.slideLooper.loop(),_e.offsetParent&&le.length&&L.dragHandler.init(Ut),pe=p.init(Ut,re)))}function Ce(Ft,at){const Wt=pt();Fe(),Be(E({startIndex:Wt},Ft),at),S.emit("reInit")}function Fe(){L.dragHandler.destroy(),L.eventStore.clear(),L.translate.clear(),L.slideLooper.clear(),L.resizeHandler.destroy(),L.slidesHandler.destroy(),L.slidesInView.destroy(),L.animation.destroy(),p.destroy(),c.clear()}function ze(){te||(te=!0,c.clear(),Fe(),S.emit("destroy"),S.clear())}function Qe(Ft,at,Wt){!W.active||te||(L.scrollBody.useBaseFriction().useDuration(at===!0?0:W.duration),L.scrollTo.index(Ft,Wt||0))}function Ze(Ft){const at=L.index.add(1).get();Qe(at,Ft,-1)}function Je(Ft){const at=L.index.add(-1).get();Qe(at,Ft,1)}function $e(){return L.index.add(1).get()!==pt()}function ke(){return L.index.add(-1).get()!==pt()}function Ue(){return L.scrollSnapList}function et(){return L.scrollProgress.get(L.offsetLocation.get())}function pt(){return L.index.get()}function Le(){return L.indexPrevious.get()}function Ve(){return L.slidesInView.get()}function We(){return L.slidesInView.get(!1)}function He(){return pe}function _t(){return L}function tt(){return e}function dt(){return _e}function Pt(){return le}const Ut={canScrollNext:$e,canScrollPrev:ke,containerNode:dt,internalEngine:_t,destroy:ze,off:G,on:I,emit:Z,plugins:He,previousScrollSnap:Le,reInit:H,rootNode:tt,scrollNext:Ze,scrollPrev:Je,scrollProgress:et,scrollSnapList:Ue,scrollTo:Qe,selectedScrollSnap:pt,slideNodes:Pt,slidesInView:Ve,slidesNotInView:We};return Be(t,i),setTimeout(()=>S.emit("init"),0),Ut}Vm.globalOptions=void 0;function nb(e={},t=[]){const i=$.useRef(e),a=$.useRef(t),[h,g]=$.useState(),[p,c]=$.useState(),S=$.useCallback(()=>{h&&h.reInit(i.current,a.current)},[h]);return $.useEffect(()=>{Jx(i.current,e)||(i.current=e,S())},[e,S]),$.useEffect(()=>{$N(a.current,t)||(a.current=t,S())},[t,S]),$.useEffect(()=>{if(UN()&&p){Vm.globalOptions=nb.globalOptions;const E=Vm(p,i.current,a.current);return g(E),()=>E.destroy()}else g(void 0)},[p,g]),[c,h]}nb.globalOptions=void 0;/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wO=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,i,a)=>a?a.toUpperCase():i.toLowerCase()),VS=e=>{const t=wO(e);return t.charAt(0).toUpperCase()+t.slice(1)},nI=(...e)=>e.filter((t,i,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===i).join(" ").trim(),SO=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=$.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:h="",children:g,iconNode:p,...c},S)=>$.createElement("svg",{ref:S,...kO,width:t,height:t,stroke:e,strokeWidth:a?Number(i)*24/Number(t):i,className:nI("lucide",h),...!g&&!SO(c)&&{"aria-hidden":"true"},...c},[...p.map(([E,P])=>$.createElement(E,P)),...Array.isArray(g)?g:[g]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=(e,t)=>{const i=$.forwardRef(({className:a,...h},g)=>$.createElement(TO,{ref:g,iconNode:t,className:nI(`lucide-${bO(VS(e))}`,`lucide-${e}`,a),...h}));return i.displayName=VS(e),i};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],EO=ro("calendar",CO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],IO=ro("chevron-down",PO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],rI=ro("chevron-left",AO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],iI=ro("chevron-right",MO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],zO=ro("hammer",DO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],LO=ro("navigation",RO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],FO=ro("pen-tool",BO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],sI=ro("search",NO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],jO=ro("share-2",OO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],gg=ro("x",VO),oI=$.createContext(null);function yg(){const e=$.useContext(oI);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const aI=$.forwardRef(({orientation:e="horizontal",opts:t,setApi:i,plugins:a,className:h,children:g,...p},c)=>{const[S,E]=nb({...t,axis:e==="horizontal"?"x":"y"},a),[P,k]=$.useState(0),[I,G]=$.useState([]),Z=$.useCallback(V=>{V&&k(V.selectedScrollSnap())},[]),H=$.useCallback(()=>{E&&E.scrollPrev()},[E]),te=$.useCallback(()=>{E&&E.scrollNext()},[E]),L=$.useCallback(V=>{E&&E.scrollTo(V)},[E]);return $.useEffect(()=>{!E||!i||i(E)},[E,i]),$.useEffect(()=>{if(E)return G(E.scrollSnapList()),Z(E),E.on("reInit",Z),E.on("select",Z),()=>{E==null||E.off("select",Z)}},[E,Z]),Q.jsx(oI.Provider,{value:{carouselRef:S,api:E,opts:t,orientation:e,scrollPrev:H,scrollNext:te,scrollTo:L,selectedIndex:P,scrollSnaps:I},children:Q.jsx("div",{ref:c,className:Yt("relative",h),role:"region","aria-roledescription":"carousel",...p,children:g})})});aI.displayName="Carousel";const lI=$.forwardRef(({className:e,...t},i)=>{const{carouselRef:a,orientation:h}=yg();return Q.jsx("div",{ref:a,className:"overflow-hidden",children:Q.jsx("div",{ref:i,className:Yt("flex",h==="horizontal"?"":"flex-col",e),...t})})});lI.displayName="CarouselContent";const cI=$.forwardRef(({className:e,...t},i)=>Q.jsx("div",{ref:i,role:"group","aria-roledescription":"slide",className:Yt("min-w-0 shrink-0 grow-0 basis-full",e),...t}));cI.displayName="CarouselItem";const UO=$.forwardRef(({className:e,...t},i)=>{const{scrollPrev:a,api:h}=yg(),g=p=>{p.preventDefault(),p.stopPropagation(),a()};return Q.jsx("button",{ref:i,type:"button",className:Yt("absolute left-3 top-1/2 -translate-y-1/2 z-20","h-10 w-10 rounded-full","bg-white/80 hover:bg-white","flex items-center justify-center","shadow-lg border-0","transition-colors cursor-pointer","focus:outline-none focus-visible:ring-2 focus-visible:ring-[#d4af37]",e),onClick:g,disabled:!h,...t,children:Q.jsx(rI,{className:"h-5 w-5 text-neutral-700"})})});UO.displayName="CarouselPrevious";const $O=$.forwardRef(({className:e,...t},i)=>{const{scrollNext:a,api:h}=yg(),g=p=>{p.preventDefault(),p.stopPropagation(),a()};return Q.jsx("button",{ref:i,type:"button",className:Yt("absolute right-3 top-1/2 -translate-y-1/2 z-20","h-10 w-10 rounded-full","bg-white/80 hover:bg-white","flex items-center justify-center","shadow-lg border-0","transition-colors cursor-pointer","focus:outline-none focus-visible:ring-2 focus-visible:ring-[#d4af37]",e),onClick:g,disabled:!h,...t,children:Q.jsx(iI,{className:"h-5 w-5 text-neutral-700"})})});$O.displayName="CarouselNext";const HO=$.forwardRef(({className:e,...t},i)=>{const{scrollTo:a,selectedIndex:h,scrollSnaps:g}=yg();return g.length<=1?null:Q.jsx("div",{ref:i,className:Yt("flex justify-center gap-2",e),...t,children:g.map((p,c)=>Q.jsx("button",{type:"button",className:Yt("h-2 rounded-full transition-all",c===h?"bg-white w-5":"bg-white/50 hover:bg-white/75 w-2"),onClick:()=>a(c),"aria-label":`Go to slide ${c+1}`},c))})});HO.displayName="CarouselDots";const GO=({api:e})=>e?Q.jsxs(Q.Fragment,{children:[Q.jsx("button",{type:"button",onClick:()=>e.scrollPrev(),className:"absolute left-3 top-1/2 -translate-y-1/2 z-20 h-10 w-10 rounded-full bg-white/90 hover:bg-white flex items-center justify-center shadow-lg",style:{transform:"translateY(-50%)"},children:Q.jsx(rI,{className:"h-5 w-5 text-neutral-700"})}),Q.jsx("button",{type:"button",onClick:()=>e.scrollNext(),className:"absolute right-3 top-1/2 -translate-y-1/2 z-20 h-10 w-10 rounded-full bg-white/90 hover:bg-white flex items-center justify-center shadow-lg",style:{transform:"translateY(-50%)"},children:Q.jsx(iI,{className:"h-5 w-5 text-neutral-700"})})]}):null,WO=({images:e,title:t,onClose:i})=>{const[a,h]=$.useState(null),[g,p]=$.useState(0);return $.useEffect(()=>{a&&(p(a.selectedScrollSnap()),a.on("select",()=>{p(a.selectedScrollSnap())}))},[a]),Q.jsxs("div",{className:"relative w-full",children:[Q.jsx("button",{type:"button",className:"absolute top-3 right-3 z-[60] h-9 w-9 rounded-full bg-black/40 backdrop-blur-sm text-white hover:bg-black/60 flex items-center justify-center",onClick:i,children:Q.jsx(gg,{className:"h-5 w-5"})}),Q.jsx(aI,{className:"w-full",opts:{loop:e.length>1},setApi:h,children:Q.jsx(lI,{className:"m-0",children:e.map((c,S)=>Q.jsx(cI,{className:"p-0",children:Q.jsx("div",{className:"w-full bg-muted/20 h-[45vh] md:h-[45vh]",children:Q.jsx("img",{src:VB(c),alt:`${t} - Image ${S+1}`,className:"w-full h-full object-cover"})})},S))})}),e.length>1&&Q.jsxs(Q.Fragment,{children:[Q.jsx(GO,{api:a}),Q.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-20 flex gap-2",children:e.map((c,S)=>Q.jsx("button",{type:"button",className:`h-2 rounded-full transition-all ${S===g?"bg-white w-5":"bg-white/50 w-2"}`,onClick:()=>a==null?void 0:a.scrollTo(S)},S))})]})]})},US=({selectedRecord:e,onClose:t,scrollAreaRef:i,checkScroll:a})=>{const h=e.images&&Array.isArray(e.images)?e.images:[e.image],g=ps(e),p=`https://www.google.com/maps/dir/?api=1&destination=${e.location.center[1]},${e.location.center[0]}&travelmode=walking`,c=[{icon:EO,label:"Year",value:e.year},{icon:FO,label:"Architect",value:e.architect||"Unknown"},{icon:zO,label:"Builder",value:e.builder||"Unknown"}],S=async()=>{var k,I;const E=`${window.location.origin}${window.location.pathname}?site=${encodeURIComponent(e.id)}`,P={title:`${e.title} - Kala Ghoda Heritage Map`,text:e.description,url:E};if(navigator.share&&((k=navigator.canShare)!=null&&k.call(navigator,P)))try{await navigator.share(P);return}catch(G){if(G.name==="AbortError")return}try{await((I=navigator.clipboard)==null?void 0:I.writeText(E)),alert("Link copied to clipboard!")}catch{prompt("Copy this link:",E)}};return Q.jsx("div",{ref:i,className:"flex-1 overflow-y-auto overflow-x-hidden",onScroll:a,children:Q.jsxs("div",{"data-vaul-no-drag":!0,children:[Q.jsx(WO,{images:h,title:e.title,onClose:t}),Q.jsxs("div",{className:"p-6 space-y-5",children:[Q.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(E=>Q.jsx(sm,{className:"px-3 py-1 text-xs font-bold uppercase tracking-wide text-white border-0 shadow-sm",style:{backgroundColor:sr.colors[E]||"#333"},children:E},E))}),Q.jsx("h2",{className:"text-2xl font-bold text-foreground tracking-tight",style:{fontFamily:"'Labrada', serif"},children:e.title}),Q.jsx("p",{className:"text-muted-foreground leading-relaxed text-[15px]",children:e.description}),Q.jsx(lg,{className:"bg-muted/30 backdrop-blur-sm border-border/50 shadow-none",children:Q.jsx(cg,{className:"p-4 space-y-3",children:c.map(E=>Q.jsxs("div",{className:"flex items-center gap-3",children:[Q.jsx(E.icon,{className:"h-4 w-4 text-primary"}),Q.jsx("span",{className:"text-sm text-muted-foreground w-20 font-medium",children:E.label}),Q.jsx("span",{className:"text-sm font-semibold text-foreground",children:E.value})]},E.label))})}),Q.jsxs("div",{className:"flex gap-3 pt-2",children:[Q.jsx(Rs,{asChild:!0,className:"flex-1 bg-[#2980b9] hover:bg-[#2471a3] text-white shadow-md transition-all active:scale-95",children:Q.jsxs("a",{href:p,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2",children:[Q.jsx(LO,{className:"h-4 w-4"}),Q.jsx("span",{className:"font-semibold",children:"Navigate"})]})}),Q.jsxs(Rs,{variant:"outline",className:"flex-1 border-border/50 bg-background/50 hover:bg-accent transition-all active:scale-95",onClick:S,children:[Q.jsx(jO,{className:"h-4 w-4 mr-2"}),Q.jsx("span",{className:"font-semibold",children:"Share"})]})]})]})]})})},qO=({selectedRecord:e,onClose:t})=>{const i=$.useRef(null),[a,h]=$.useState(!1),g=window.innerWidth<=768;$.useEffect(()=>{const I=G=>{G.key==="Escape"&&t()};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[t]);const p=()=>{if(i.current){const{scrollTop:I,scrollHeight:G,clientHeight:Z}=i.current;h(I+Z<G-20)}};$.useEffect(()=>{const I=()=>{if(i.current){const{scrollTop:G,scrollHeight:Z,clientHeight:H}=i.current;h(Z>H+10&&G+H<Z-10)}};if(i.current){i.current.scrollTop=0;const G=new ResizeObserver(I);return G.observe(i.current),i.current.firstElementChild&&G.observe(i.current.firstElementChild),I(),setTimeout(I,200),()=>G.disconnect()}},[e]);const c=()=>{var I;(I=i.current)==null||I.scrollBy({top:300,behavior:"smooth"})},[S,E]=$.useState(!0);$.useEffect(()=>{g&&E(!0)},[e,g]);const P=()=>{E(!1),setTimeout(t,300)},k=I=>{E(I),I||setTimeout(t,300)};return g?Q.jsx(KP,{open:S,onOpenChange:k,modal:!1,children:Q.jsxs(JP,{className:"h-[75vh] max-h-[75vh] flex flex-col bg-background/80 backdrop-blur-xl border-t border-border/50",showOverlay:!1,children:[Q.jsx("div",{className:"absolute top-0 left-0 right-0 h-12 z-50 flex justify-center pt-3 cursor-grab active:cursor-grabbing",children:Q.jsx("div",{className:"w-12 h-1.5 bg-foreground/20 rounded-full shadow-sm"})}),Q.jsx(US,{selectedRecord:e,onClose:P,scrollAreaRef:i,checkScroll:p}),a&&Q.jsx("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center pointer-events-none z-50",children:Q.jsx(Rs,{variant:"secondary",size:"icon",className:"h-10 w-10 rounded-full shadow-lg bg-background/90 backdrop-blur hover:bg-background pointer-events-auto border border-border/50",onClick:c,children:Q.jsx(rs.div,{animate:{y:[0,4,0]},transition:{repeat:1/0,duration:1.5,ease:"easeInOut"},children:Q.jsx(IO,{className:"h-5 w-5 text-muted-foreground"})})})})]})}):Q.jsxs(Q.Fragment,{children:[Q.jsx(rs.div,{className:"fixed inset-0 bg-black/20 z-[199] backdrop-blur-[2px]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),Q.jsx(rs.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:500,damping:30,mass:.8},className:"fixed right-0 top-0 h-full w-[400px] bg-background/70 backdrop-blur-xl border-l border-border/50 shadow-2xl z-[200] flex flex-col rounded-l-2xl overflow-hidden",children:Q.jsx(US,{selectedRecord:e,onClose:t,scrollAreaRef:i,checkScroll:p})})]})};var uI={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,t){(function(i,a){e.exports=a()})(FM,function(){var i={},a={};function h(p,c,S){if(a[p]=S,p==="index"){var E="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",P={};return a.shared(P),a.index(i,P),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([E],{type:"text/javascript"}))),i}}h("shared",["exports"],function(p){function c(s,r,o,u){return new(o||(o=Promise))(function(m,_){function x(M){try{T(u.next(M))}catch(D){_(D)}}function b(M){try{T(u.throw(M))}catch(D){_(D)}}function T(M){var D;M.done?m(M.value):(D=M.value,D instanceof o?D:new o(function(R){R(D)})).then(x,b)}T((u=u.apply(s,r||[])).next())})}function S(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}typeof SuppressedError=="function"&&SuppressedError;var E=P;function P(s,r){this.x=s,this.y=r}P.prototype={clone:function(){return new P(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,o=s.y-this.y;return r*r+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),o=Math.sin(s),u=o*this.x+r*this.y;return this.x=r*this.x-o*this.y,this.y=u,this},_rotateAround:function(s,r){var o=Math.cos(s),u=Math.sin(s),m=r.y+u*(this.x-r.x)+o*(this.y-r.y);return this.x=r.x+o*(this.x-r.x)-u*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},P.convert=function(s){return s instanceof P?s:Array.isArray(s)?new P(s[0],s[1]):s};var k=S(E),I=G;function G(s,r,o,u){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(u-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=o,this.p2y=u}G.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,u=0;u<8;u++){var m=this.sampleCurveX(o)-s;if(Math.abs(m)<r)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=m/_}var x=0,b=1;for(o=s,u=0;u<20&&(m=this.sampleCurveX(o),!(Math.abs(m-s)<r));u++)s>m?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var Z=S(I);let H,te;function L(){return H==null&&(H=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),H}function V(){if(te==null&&(te=!1,L())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let u=0;u<5*5;u++){const m=4*u;r.fillStyle=`rgb(${m},${m+1},${m+2})`,r.fillRect(u%5,Math.floor(u/5),1,1)}const o=r.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&o[u]!==u){te=!0;break}}}return te||!1}function W(s,r,o,u){const m=new Z(s,r,o,u);return _=>m.solve(_)}const re=W(.25,.1,.25,1);function pe(s,r,o){return Math.min(o,Math.max(r,s))}function _e(s,r,o){const u=o-r,m=((s-r)%u+u)%u+r;return m===r?o:m}function le(s,...r){for(const o of r)for(const u in o)s[u]=o[u];return s}let ce=1;function De(s,r,o){const u={};for(const m in s)u[m]=r.call(this,s[m],m,s);return u}function Be(s,r,o){const u={};for(const m in s)r.call(this,s[m],m,s)&&(u[m]=s[m]);return u}function Ce(s){return Array.isArray(s)?s.map(Ce):typeof s=="object"&&s?De(s,Ce):s}const Fe={};function ze(s){Fe[s]||(typeof console<"u"&&console.warn(s),Fe[s]=!0)}function Qe(s,r,o){return(o.y-s.y)*(r.x-s.x)>(r.y-s.y)*(o.x-s.x)}function Ze(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let Je=null;function $e(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ue(s,r,o,u,m){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(s,{timestamp:0});try{const x=_==null?void 0:_.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const b=x.startsWith("BGR"),T=new Uint8ClampedArray(u*m*4);if(yield _.copyTo(T,function(M,D,R,O,U){const X=4*Math.max(-D,0),Y=(Math.max(0,R)-R)*O*4+X,oe=4*O,ue=Math.max(0,D),Te=Math.max(0,R);return{rect:{x:ue,y:Te,width:Math.min(M.width,D+O)-ue,height:Math.min(M.height,R+U)-Te},layout:[{offset:Y,stride:oe}]}}(s,r,o,u,m)),b)for(let M=0;M<T.length;M+=4){const D=T[M];T[M]=T[M+2],T[M+2]=D}return T}finally{_.close()}})}let et,pt;const Le="AbortError";function Ve(){return new Error(Le)}const We={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function He(s){return We.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const _t="global-dispatcher";class tt extends Error{constructor(r,o,u,m){super(`AJAXError: ${o} (${r}): ${u}`),this.status=r,this.statusText=o,this.url=u,this.body=m}}const dt=()=>Ze(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Pt=function(s,r){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const u=He(s.url);if(u)return u(s,r);if(Ze(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:_t},r)}if(!(/^file:/.test(o=s.url)||/^file:/.test(dt())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,m){return c(this,void 0,void 0,function*(){const _=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:dt(),signal:m.signal});u.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");const x=yield fetch(_);if(!x.ok){const M=yield x.blob();throw new tt(x.status,x.statusText,u.url,M)}let b;b=u.type==="arrayBuffer"||u.type==="image"?x.arrayBuffer():u.type==="json"?x.json():x.text();const T=yield b;if(m.signal.aborted)throw Ve();return{data:T,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(s,r);if(Ze(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:_t},r)}var o;return function(u,m){return new Promise((_,x)=>{var b;const T=new XMLHttpRequest;T.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(T.responseType="arraybuffer");for(const M in u.headers)T.setRequestHeader(M,u.headers[M]);u.type==="json"&&(T.responseType="text",!((b=u.headers)===null||b===void 0)&&b.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=u.credentials==="include",T.onerror=()=>{x(new Error(T.statusText))},T.onload=()=>{if(!m.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let M=T.response;if(u.type==="json")try{M=JSON.parse(T.response)}catch(D){return void x(D)}_({data:M,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const M=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});x(new tt(T.status,T.statusText,u.url,M))}},m.signal.addEventListener("abort",()=>{T.abort(),x(Ve())}),T.send(u.body)})}(s,r)};function Ut(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const r=new URL(s),o=window.location;return r.protocol===o.protocol&&r.host===o.host}function Ft(s,r,o){o[s]&&o[s].indexOf(r)!==-1||(o[s]=o[s]||[],o[s].push(r))}function at(s,r,o){if(o&&o[s]){const u=o[s].indexOf(r);u!==-1&&o[s].splice(u,1)}}class Wt{constructor(r,o={}){le(this,o),this.type=r}}class mt extends Wt{constructor(r,o={}){super("error",le({error:r},o))}}class wn{on(r,o){return this._listeners=this._listeners||{},Ft(r,o,this._listeners),this}off(r,o){return at(r,o,this._listeners),at(r,o,this._oneTimeListeners),this}once(r,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Ft(r,o,this._oneTimeListeners),this):new Promise(u=>this.once(r,u))}fire(r,o){typeof r=="string"&&(r=new Wt(r,o||{}));const u=r.type;if(this.listens(u)){r.target=this;const m=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const b of m)b.call(this,r);const _=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const b of _)at(u,b,this._oneTimeListeners),b.call(this,r);const x=this._eventedParent;x&&(le(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof mt&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,o){return this._eventedParent=r,this._eventedParentData=o,this}}var Pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Sn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function dr(s,r){const o={};for(const u in s)u!=="ref"&&(o[u]=s[u]);return Sn.forEach(u=>{u in r&&(o[u]=r[u])}),o}function Nt(s,r){if(Array.isArray(s)){if(!Array.isArray(r)||s.length!==r.length)return!1;for(let o=0;o<s.length;o++)if(!Nt(s[o],r[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&r!==null){if(typeof r!="object"||Object.keys(s).length!==Object.keys(r).length)return!1;for(const o in s)if(!Nt(s[o],r[o]))return!1;return!0}return s===r}function Jt(s,r){s.push(r)}function Ir(s,r,o){Jt(o,{command:"addSource",args:[s,r[s]]})}function xn(s,r,o){Jt(r,{command:"removeSource",args:[s]}),o[s]=!0}function En(s,r,o,u){xn(s,o,u),Ir(s,r,o)}function ci(s,r,o){let u;for(u in s[o])if(Object.prototype.hasOwnProperty.call(s[o],u)&&u!=="data"&&!Nt(s[o][u],r[o][u]))return!1;for(u in r[o])if(Object.prototype.hasOwnProperty.call(r[o],u)&&u!=="data"&&!Nt(s[o][u],r[o][u]))return!1;return!0}function er(s,r,o,u,m,_){s=s||{},r=r||{};for(const x in s)Object.prototype.hasOwnProperty.call(s,x)&&(Nt(s[x],r[x])||o.push({command:_,args:[u,x,r[x],m]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(s,x)&&(Nt(s[x],r[x])||o.push({command:_,args:[u,x,r[x],m]}))}function Xr(s){return s.id}function Ti(s,r){return s[r.id]=r,s}class qe{constructor(r,o,u,m){this.message=(r?`${r}: `:"")+u,m&&(this.identifier=m),o!=null&&o.__line__&&(this.line=o.__line__)}}function tr(s,...r){for(const o of r)for(const u in o)s[u]=o[u];return s}class dn extends Error{constructor(r,o){super(o),this.message=o,this.key=r}}class cr{constructor(r,o=[]){this.parent=r,this.bindings={};for(const[u,m]of o)this.bindings[u]=m}concat(r){return new cr(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const zn={kind:"null"},Ye={kind:"number"},$t={kind:"string"},Dt={kind:"boolean"},Gn={kind:"color"},xr={kind:"object"},Bt={kind:"value"},xt={kind:"collator"},Zt={kind:"formatted"},Qt={kind:"padding"},Ht={kind:"resolvedImage"},ie={kind:"variableAnchorOffsetCollection"};function N(s,r){return{kind:"array",itemType:s,N:r}}function j(s){if(s.kind==="array"){const r=j(s.itemType);return typeof s.N=="number"?`array<${r}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${r}>`}return s.kind}const K=[zn,Ye,$t,Dt,Gn,Zt,xr,N(Bt),Qt,Ht,ie];function ne(s,r){if(r.kind==="error")return null;if(s.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!ne(s.itemType,r.itemType))&&(typeof s.N!="number"||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if(s.kind==="value"){for(const o of K)if(!ne(o,r))return null}}return`Expected ${j(s)} but found ${j(r)} instead.`}function me(s,r){return r.some(o=>o.kind===s.kind)}function ge(s,r){return r.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}function xe(s,r){return s.kind==="array"&&r.kind==="array"?s.itemType.kind===r.itemType.kind&&typeof s.N=="number":s.kind===r.kind}const de=.96422,Ie=.82521,Ne=4/29,Ae=6/29,Xe=3*Ae*Ae,Tt=Ae*Ae*Ae,zt=Math.PI/180,on=180/Math.PI;function Gt(s){return(s%=360)<0&&(s+=360),s}function an([s,r,o,u]){let m,_;const x=nr((.2225045*(s=en(s))+.7168786*(r=en(r))+.0606169*(o=en(o)))/1);s===r&&r===o?m=_=x:(m=nr((.4360747*s+.3850649*r+.1430804*o)/de),_=nr((.0139322*s+.0971045*r+.7141733*o)/Ie));const b=116*x-16;return[b<0?0:b,500*(m-x),200*(x-_),u]}function en(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function nr(s){return s>Tt?Math.pow(s,1/3):s/Xe+Ne}function Bn([s,r,o,u]){let m=(s+16)/116,_=isNaN(r)?m:m+r/500,x=isNaN(o)?m:m-o/200;return m=1*mn(m),_=de*mn(_),x=Ie*mn(x),[Xt(3.1338561*_-1.6168667*m-.4906146*x),Xt(-.9787684*_+1.9161415*m+.033454*x),Xt(.0719453*_-.2289914*m+1.4052427*x),u]}function Xt(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function mn(s){return s>Ae?s*s*s:Xe*(s-Ne)}function Rn(s){return parseInt(s.padEnd(2,s),16)/255}function fr(s,r){return br(r?s/100:s,0,1)}function br(s,r,o){return Math.min(Math.max(r,s),o)}function jr(s){return!s.some(Number.isNaN)}const Fo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class gn{constructor(r,o,u,m=1,_=!0){this.r=r,this.g=o,this.b=u,this.a=m,_||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[r,o,u,m]))}static parse(r){if(r instanceof gn)return r;if(typeof r!="string")return;const o=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=Fo[u];if(m){const[x,b,T]=m;return[x/255,b/255,T/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const x=u.length<6?1:2;let b=1;return[Rn(u.slice(b,b+=x)),Rn(u.slice(b,b+=x)),Rn(u.slice(b,b+=x)),Rn(u.slice(b,b+x)||"ff")]}if(u.startsWith("rgb")){const x=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,T,M,D,R,O,U,X,Y,oe,ue,Te]=x,ve=[D||" ",U||" ",oe].join("");if(ve==="  "||ve==="  /"||ve===",,"||ve===",,,"){const Se=[M,O,Y].join(""),Re=Se==="%%%"?100:Se===""?255:0;if(Re){const Ge=[br(+T/Re,0,1),br(+R/Re,0,1),br(+X/Re,0,1),ue?fr(+ue,Te):1];if(jr(Ge))return Ge}}return}}const _=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,b,T,M,D,R,O,U,X]=_,Y=[T||" ",D||" ",O].join("");if(Y==="  "||Y==="  /"||Y===",,"||Y===",,,"){const oe=[+b,br(+M,0,100),br(+R,0,100),U?fr(+U,X):1];if(jr(oe))return function([ue,Te,ve,Se]){function Re(Ge){const ht=(Ge+ue/30)%12,Rt=Te*Math.min(ve,1-ve);return ve-Rt*Math.max(-1,Math.min(ht-3,9-ht,1))}return ue=Gt(ue),Te/=100,ve/=100,[Re(0),Re(8),Re(4),Se]}(oe)}}}(r);return o?new gn(...o,!1):void 0}get rgb(){const{r,g:o,b:u,a:m}=this,_=m||1/0;return this.overwriteGetter("rgb",[r/_,o/_,u/_,m])}get hcl(){return this.overwriteGetter("hcl",function(r){const[o,u,m,_]=an(r),x=Math.sqrt(u*u+m*m);return[Math.round(1e4*x)?Gt(Math.atan2(m,u)*on):NaN,x,o,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",an(this.rgb))}overwriteGetter(r,o){return Object.defineProperty(this,r,{value:o}),o}toString(){const[r,o,u,m]=this.rgb;return`rgba(${[r,o,u].map(_=>Math.round(255*_)).join(",")},${m})`}}gn.black=new gn(0,0,0,1),gn.white=new gn(1,1,1,1),gn.transparent=new gn(0,0,0,0),gn.red=new gn(1,0,0,1);class Ru{constructor(r,o,u){this.sensitivity=r?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,o){return this.collator.compare(r,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Lu{constructor(r,o,u,m,_){this.text=r,this.image=o,this.scale=u,this.fontStack=m,this.textColor=_}}class ui{constructor(r){this.sections=r}static fromString(r){return new ui([new Lu(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof ui?r:ui.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class hi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof hi)return r;if(typeof r=="number")return new hi([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const o of r)if(typeof o!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new hi(r)}}toString(){return JSON.stringify(this.values)}}const xg=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ci{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Ci)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let o=0;o<r.length;o+=2){const u=r[o],m=r[o+1];if(typeof u!="string"||!xg.has(u)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Ci(r)}}toString(){return JSON.stringify(this.values)}}class di{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new di({name:r,available:!1}):null}}function No(s,r,o,u){return typeof s=="number"&&s>=0&&s<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[s,r,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[s,r,o,u]:[s,r,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function io(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof gn||s instanceof Ru||s instanceof ui||s instanceof hi||s instanceof Ci||s instanceof di)return!0;if(Array.isArray(s)){for(const r of s)if(!io(r))return!1;return!0}if(typeof s=="object"){for(const r in s)if(!io(s[r]))return!1;return!0}return!1}function rr(s){if(s===null)return zn;if(typeof s=="string")return $t;if(typeof s=="boolean")return Dt;if(typeof s=="number")return Ye;if(s instanceof gn)return Gn;if(s instanceof Ru)return xt;if(s instanceof ui)return Zt;if(s instanceof hi)return Qt;if(s instanceof Ci)return ie;if(s instanceof di)return Ht;if(Array.isArray(s)){const r=s.length;let o;for(const u of s){const m=rr(u);if(o){if(o===m)continue;o=Bt;break}o=m}return N(o||Bt,r)}return xr}function Ha(s){const r=typeof s;return s===null?"":r==="string"||r==="number"||r==="boolean"?String(s):s instanceof gn||s instanceof ui||s instanceof hi||s instanceof Ci||s instanceof di?s.toString():JSON.stringify(s)}class Ui{constructor(r,o){this.type=r,this.value=o}static parse(r,o){if(r.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!io(r[1]))return o.error("invalid value");const u=r[1];let m=rr(u);const _=o.expectedType;return m.kind!=="array"||m.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(m=_),new Ui(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Wn{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Ul={string:$t,number:Ye,boolean:Dt,object:xr};class $i{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");let u,m=1;const _=r[0];if(_==="array"){let b,T;if(r.length>2){const M=r[1];if(typeof M!="string"||!(M in Ul)||M==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=Ul[M],m++}else b=Bt;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return o.error('The length argument to "array" must be a positive integer literal',2);T=r[2],m++}u=N(b,T)}else{if(!Ul[_])throw new Error(`Types doesn't contain name = ${_}`);u=Ul[_]}const x=[];for(;m<r.length;m++){const b=o.parse(r[m],m,Bt);if(!b)return null;x.push(b)}return new $i(u,x)}evaluate(r){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(r);if(!ne(this.type,rr(u)))return u;if(o===this.args.length-1)throw new Wn(`Expected value to be of type ${j(this.type)}, but found ${j(rr(u))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Bu={"to-boolean":Dt,"to-color":Gn,"to-number":Ye,"to-string":$t};class Hi{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const u=r[0];if(!Bu[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&r.length!==2)return o.error("Expected one argument.");const m=Bu[u],_=[];for(let x=1;x<r.length;x++){const b=o.parse(r[x],x,Bt);if(!b)return null;_.push(b)}return new Hi(m,_)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let o,u;for(const m of this.args){if(o=m.evaluate(r),u=null,o instanceof gn)return o;if(typeof o=="string"){const _=r.parseColor(o);if(_)return _}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:No(o[0],o[1],o[2],o[3]),!u))return new gn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Wn(u||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const u of this.args){o=u.evaluate(r);const m=hi.parse(o);if(m)return m}throw new Wn(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const u of this.args){o=u.evaluate(r);const m=Ci.parse(o);if(m)return m}throw new Wn(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const u of this.args){if(o=u.evaluate(r),o===null)return 0;const m=Number(o);if(!isNaN(m))return m}throw new Wn(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return ui.fromString(Ha(this.args[0].evaluate(r)));case"resolvedImage":return di.fromString(Ha(this.args[0].evaluate(r)));default:return Ha(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const bg=["Unknown","Point","LineString","Polygon"];class $l{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?bg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let o=this._parseColorCache[r];return o||(o=this._parseColorCache[r]=gn.parse(r)),o}}class so{constructor(r,o,u=[],m,_=new cr,x=[]){this.registry=r,this.path=u,this.key=u.map(b=>`[${b}]`).join(""),this.scope=_,this.errors=x,this.expectedType=m,this._isConstant=o}parse(r,o,u,m,_={}){return o?this.concat(o,u,m)._parse(r,_):this._parse(r,_)}_parse(r,o){function u(m,_,x){return x==="assert"?new $i(_,[m]):x==="coerce"?new Hi(_,[m]):m}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=r[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[m];if(_){let x=_.parse(r,this);if(!x)return null;if(this.expectedType){const b=this.expectedType,T=x.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||T.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(b.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(b,T))return null}else x=u(x,b,o.typeAnnotation||"coerce");else x=u(x,b,o.typeAnnotation||"coerce");else x=u(x,b,o.typeAnnotation||"coerce");else x=u(x,b,o.typeAnnotation||"assert")}if(!(x instanceof Ui)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const b=new $l;try{x=new Ui(x.type,x.evaluate(b))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,o,u){const m=typeof r=="number"?this.path.concat(r):this.path,_=u?this.scope.concat(u):this.scope;return new so(this.registry,this._isConstant,m,o||null,_,this.errors)}error(r,...o){const u=`${this.key}${o.map(m=>`[${m}]`).join("")}`;this.errors.push(new dn(u,r))}checkSubtype(r,o){const u=ne(r,o);return u&&this.error(u),u}}class js{constructor(r,o){this.type=o.type,this.bindings=[].concat(r),this.result=o}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const o of this.bindings)r(o[1]);r(this.result)}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const u=[];for(let _=1;_<r.length-1;_+=2){const x=r[_];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",_);const b=o.parse(r[_+1],_+1);if(!b)return null;u.push([x,b])}const m=o.parse(r[r.length-1],r.length-1,o.expectedType,u);return m?new js(u,m):null}outputDefined(){return this.result.outputDefined()}}class hn{constructor(r,o){this.type=o.type,this.name=r,this.boundExpression=o}static parse(r,o){if(r.length!==2||typeof r[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=r[1];return o.scope.has(u)?new hn(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Fu{constructor(r,o,u){this.type=r,this.index=o,this.input=u}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,Ye),m=o.parse(r[2],2,N(o.expectedType||Bt));return u&&m?new Fu(m.type.itemType,u,m):null}evaluate(r){const o=this.index.evaluate(r),u=this.input.evaluate(r);if(o<0)throw new Wn(`Array index out of bounds: ${o} < 0.`);if(o>=u.length)throw new Wn(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o!==Math.floor(o))throw new Wn(`Array index must be an integer, but found ${o} instead.`);return u[o]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Nu{constructor(r,o){this.type=Dt,this.needle=r,this.haystack=o}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,Bt),m=o.parse(r[2],2,Bt);return u&&m?me(u.type,[Dt,$t,Ye,zn,Bt])?new Nu(u,m):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${j(u.type)} instead`):null}evaluate(r){const o=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!u)return!1;if(!ge(o,["boolean","string","number","null"]))throw new Wn(`Expected first argument to be of type boolean, string, number or null, but found ${j(rr(o))} instead.`);if(!ge(u,["string","array"]))throw new Wn(`Expected second argument to be of type array or string, but found ${j(rr(u))} instead.`);return u.indexOf(o)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Oo{constructor(r,o,u){this.type=Ye,this.needle=r,this.haystack=o,this.fromIndex=u}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,Bt),m=o.parse(r[2],2,Bt);if(!u||!m)return null;if(!me(u.type,[Dt,$t,Ye,zn,Bt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${j(u.type)} instead`);if(r.length===4){const _=o.parse(r[3],3,Ye);return _?new Oo(u,m,_):null}return new Oo(u,m)}evaluate(r){const o=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!ge(o,["boolean","string","number","null"]))throw new Wn(`Expected first argument to be of type boolean, string, number or null, but found ${j(rr(o))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(r)),ge(u,["string"])){const _=u.indexOf(o,m);return _===-1?-1:[...u.slice(0,_)].length}if(ge(u,["array"]))return u.indexOf(o,m);throw new Wn(`Expected second argument to be of type array or string, but found ${j(rr(u))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Ou{constructor(r,o,u,m,_,x){this.inputType=r,this.type=o,this.input=u,this.cases=m,this.outputs=_,this.otherwise=x}static parse(r,o){if(r.length<5)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return o.error("Expected an even number of arguments.");let u,m;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);const _={},x=[];for(let M=2;M<r.length-1;M+=2){let D=r[M];const R=r[M+1];Array.isArray(D)||(D=[D]);const O=o.concat(M);if(D.length===0)return O.error("Expected at least one branch label.");for(const X of D){if(typeof X!="number"&&typeof X!="string")return O.error("Branch labels must be numbers or strings.");if(typeof X=="number"&&Math.abs(X)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof X=="number"&&Math.floor(X)!==X)return O.error("Numeric branch labels must be integer values.");if(u){if(O.checkSubtype(u,rr(X)))return null}else u=rr(X);if(_[String(X)]!==void 0)return O.error("Branch labels must be unique.");_[String(X)]=x.length}const U=o.parse(R,M,m);if(!U)return null;m=m||U.type,x.push(U)}const b=o.parse(r[1],1,Bt);if(!b)return null;const T=o.parse(r[r.length-1],r.length-1,m);return T?b.type.kind!=="value"&&o.concat(1).checkSubtype(u,b.type)?null:new Ou(u,m,b,_,x,T):null}evaluate(r){const o=this.input.evaluate(r);return(rr(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class Hl{constructor(r,o,u){this.type=r,this.branches=o,this.otherwise=u}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const m=[];for(let x=1;x<r.length-1;x+=2){const b=o.parse(r[x],x,Dt);if(!b)return null;const T=o.parse(r[x+1],x+1,u);if(!T)return null;m.push([b,T]),u=u||T.type}const _=o.parse(r[r.length-1],r.length-1,u);if(!_)return null;if(!u)throw new Error("Can't infer output type");return new Hl(u,m,_)}evaluate(r){for(const[o,u]of this.branches)if(o.evaluate(r))return u.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[o,u]of this.branches)r(o),r(u);r(this.otherwise)}outputDefined(){return this.branches.every(([r,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Ga{constructor(r,o,u,m){this.type=r,this.input=o,this.beginIndex=u,this.endIndex=m}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,Bt),m=o.parse(r[2],2,Ye);if(!u||!m)return null;if(!me(u.type,[N(Bt),$t,Bt]))return o.error(`Expected first argument to be of type array or string, but found ${j(u.type)} instead`);if(r.length===4){const _=o.parse(r[3],3,Ye);return _?new Ga(u.type,u,m,_):null}return new Ga(u.type,u,m)}evaluate(r){const o=this.input.evaluate(r),u=this.beginIndex.evaluate(r);let m;if(this.endIndex&&(m=this.endIndex.evaluate(r)),ge(o,["string"]))return[...o].slice(u,m).join("");if(ge(o,["array"]))return o.slice(u,m);throw new Wn(`Expected first argument to be of type array or string, but found ${j(rr(o))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Gl(s,r){const o=s.length-1;let u,m,_=0,x=o,b=0;for(;_<=x;)if(b=Math.floor((_+x)/2),u=s[b],m=s[b+1],u<=r){if(b===o||r<m)return b;_=b+1}else{if(!(u>r))throw new Wn("Input is not a number.");x=b-1}return 0}class jo{constructor(r,o,u){this.type=r,this.input=o,this.labels=[],this.outputs=[];for(const[m,_]of u)this.labels.push(m),this.outputs.push(_)}static parse(r,o){if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(r[1],1,Ye);if(!u)return null;const m=[];let _=null;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);for(let x=1;x<r.length;x+=2){const b=x===1?-1/0:r[x],T=r[x+1],M=x,D=x+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(m.length&&m[m.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const R=o.parse(T,D,_);if(!R)return null;_=_||R.type,m.push([b,R])}return new jo(_,u,m)}evaluate(r){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(r);const m=this.input.evaluate(r);if(m<=o[0])return u[0].evaluate(r);const _=o.length;return m>=o[_-1]?u[_-1].evaluate(r):u[Gl(o,m)].evaluate(r)}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function lf(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var wg=cf;function cf(s,r,o,u){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(u-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=o,this.p2y=u}cf.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,u=0;u<8;u++){var m=this.sampleCurveX(o)-s;if(Math.abs(m)<r)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=m/_}var x=0,b=1;for(o=s,u=0;u<20&&(m=this.sampleCurveX(o),!(Math.abs(m-s)<r));u++)s>m?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var Sg=lf(wg);function oo(s,r,o){return s+o*(r-s)}function Wa(s,r,o){return s.map((u,m)=>oo(u,r[m],o))}const Kr={number:oo,color:function(s,r,o,u="rgb"){switch(u){case"rgb":{const[m,_,x,b]=Wa(s.rgb,r.rgb,o);return new gn(m,_,x,b,!1)}case"hcl":{const[m,_,x,b]=s.hcl,[T,M,D,R]=r.hcl;let O,U;if(isNaN(m)||isNaN(T))isNaN(m)?isNaN(T)?O=NaN:(O=T,x!==1&&x!==0||(U=M)):(O=m,D!==1&&D!==0||(U=_));else{let Te=T-m;T>m&&Te>180?Te-=360:T<m&&m-T>180&&(Te+=360),O=m+o*Te}const[X,Y,oe,ue]=function([Te,ve,Se,Re]){return Te=isNaN(Te)?0:Te*zt,Bn([Se,Math.cos(Te)*ve,Math.sin(Te)*ve,Re])}([O,U??oo(_,M,o),oo(x,D,o),oo(b,R,o)]);return new gn(X,Y,oe,ue,!1)}case"lab":{const[m,_,x,b]=Bn(Wa(s.lab,r.lab,o));return new gn(m,_,x,b,!1)}}},array:Wa,padding:function(s,r,o){return new hi(Wa(s.values,r.values,o))},variableAnchorOffsetCollection:function(s,r,o){const u=s.values,m=r.values;if(u.length!==m.length)throw new Wn(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${r.toString()}`);const _=[];for(let x=0;x<u.length;x+=2){if(u[x]!==m[x])throw new Wn(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${u[x]}, to[${x}]: ${m[x]}`);_.push(u[x]);const[b,T]=u[x+1],[M,D]=m[x+1];_.push([oo(b,M,o),oo(T,D,o)])}return new Ci(_)}};class Yr{constructor(r,o,u,m,_){this.type=r,this.operator=o,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(const[x,b]of _)this.labels.push(x),this.outputs.push(b)}static interpolationFactor(r,o,u,m){let _=0;if(r.name==="exponential")_=Wl(o,r.base,u,m);else if(r.name==="linear")_=Wl(o,1,u,m);else if(r.name==="cubic-bezier"){const x=r.controlPoints;_=new Sg(x[0],x[1],x[2],x[3]).solve(Wl(o,1,u,m))}return _}static parse(r,o){let[u,m,_,...x]=r;if(!Array.isArray(m)||m.length===0)return o.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const M=m[1];if(typeof M!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:M}}else{if(m[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const M=m.slice(1);if(M.length!==4||M.some(D=>typeof D!="number"||D<0||D>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:M}}}if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(_=o.parse(_,2,Ye),!_)return null;const b=[];let T=null;u==="interpolate-hcl"||u==="interpolate-lab"?T=Gn:o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let M=0;M<x.length;M+=2){const D=x[M],R=x[M+1],O=M+3,U=M+4;if(typeof D!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(b.length&&b[b.length-1][0]>=D)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const X=o.parse(R,U,T);if(!X)return null;T=T||X.type,b.push([D,X])}return xe(T,Ye)||xe(T,Gn)||xe(T,Qt)||xe(T,ie)||xe(T,N(Ye))?new Yr(T,u,m,_,b):o.error(`Type ${j(T)} is not interpolatable.`)}evaluate(r){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(r);const m=this.input.evaluate(r);if(m<=o[0])return u[0].evaluate(r);const _=o.length;if(m>=o[_-1])return u[_-1].evaluate(r);const x=Gl(o,m),b=Yr.interpolationFactor(this.interpolation,m,o[x],o[x+1]),T=u[x].evaluate(r),M=u[x+1].evaluate(r);switch(this.operator){case"interpolate":return Kr[this.type.kind](T,M,b);case"interpolate-hcl":return Kr.color(T,M,b,"hcl");case"interpolate-lab":return Kr.color(T,M,b,"lab")}}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Wl(s,r,o,u){const m=u-o,_=s-o;return m===0?0:r===1?_/m:(Math.pow(r,_)-1)/(Math.pow(r,m)-1)}class ql{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expectected at least one argument.");let u=null;const m=o.expectedType;m&&m.kind!=="value"&&(u=m);const _=[];for(const b of r.slice(1)){const T=o.parse(b,1+_.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,_.push(T)}if(!u)throw new Error("No output type");const x=m&&_.some(b=>ne(m,b.type));return new ql(x?Bt:u,_)}evaluate(r){let o,u=null,m=0;for(const _ of this.args)if(m++,u=_.evaluate(r),u&&u instanceof di&&!u.available&&(o||(o=u.name),u=null,m===this.args.length&&(u=o)),u!==null)break;return u}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function Zl(s,r){return s==="=="||s==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function uf(s,r,o,u){return u.compare(r,o)===0}function Vo(s,r,o){const u=s!=="=="&&s!=="!=";return class hI{constructor(_,x,b){this.type=Dt,this.lhs=_,this.rhs=x,this.collator=b,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const b=_[0];let T=x.parse(_[1],1,Bt);if(!T)return null;if(!Zl(b,T.type))return x.concat(1).error(`"${b}" comparisons are not supported for type '${j(T.type)}'.`);let M=x.parse(_[2],2,Bt);if(!M)return null;if(!Zl(b,M.type))return x.concat(2).error(`"${b}" comparisons are not supported for type '${j(M.type)}'.`);if(T.type.kind!==M.type.kind&&T.type.kind!=="value"&&M.type.kind!=="value")return x.error(`Cannot compare types '${j(T.type)}' and '${j(M.type)}'.`);u&&(T.type.kind==="value"&&M.type.kind!=="value"?T=new $i(M.type,[T]):T.type.kind!=="value"&&M.type.kind==="value"&&(M=new $i(T.type,[M])));let D=null;if(_.length===4){if(T.type.kind!=="string"&&M.type.kind!=="string"&&T.type.kind!=="value"&&M.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(D=x.parse(_[3],3,xt),!D)return null}return new hI(T,M,D)}evaluate(_){const x=this.lhs.evaluate(_),b=this.rhs.evaluate(_);if(u&&this.hasUntypedArgument){const T=rr(x),M=rr(b);if(T.kind!==M.kind||T.kind!=="string"&&T.kind!=="number")throw new Wn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const T=rr(x),M=rr(b);if(T.kind!=="string"||M.kind!=="string")return r(_,x,b)}return this.collator?o(_,x,b,this.collator.evaluate(_)):r(_,x,b)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const kg=Vo("==",function(s,r,o){return r===o},uf),hf=Vo("!=",function(s,r,o){return r!==o},function(s,r,o,u){return!uf(0,r,o,u)}),df=Vo("<",function(s,r,o){return r<o},function(s,r,o,u){return u.compare(r,o)<0}),Tg=Vo(">",function(s,r,o){return r>o},function(s,r,o,u){return u.compare(r,o)>0}),Cg=Vo("<=",function(s,r,o){return r<=o},function(s,r,o,u){return u.compare(r,o)<=0}),ff=Vo(">=",function(s,r,o){return r>=o},function(s,r,o,u){return u.compare(r,o)>=0});class qa{constructor(r,o,u){this.type=xt,this.locale=u,this.caseSensitive=r,this.diacriticSensitive=o}static parse(r,o){if(r.length!==2)return o.error("Expected one argument.");const u=r[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const m=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Dt);if(!m)return null;const _=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Dt);if(!_)return null;let x=null;return u.locale&&(x=o.parse(u.locale,1,$t),!x)?null:new qa(m,_,x)}evaluate(r){return new Ru(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class ju{constructor(r,o,u,m,_){this.type=$t,this.number=r,this.locale=o,this.currency=u,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(r,o){if(r.length!==3)return o.error("Expected two arguments.");const u=o.parse(r[1],1,Ye);if(!u)return null;const m=r[2];if(typeof m!="object"||Array.isArray(m))return o.error("NumberFormat options argument must be an object.");let _=null;if(m.locale&&(_=o.parse(m.locale,1,$t),!_))return null;let x=null;if(m.currency&&(x=o.parse(m.currency,1,$t),!x))return null;let b=null;if(m["min-fraction-digits"]&&(b=o.parse(m["min-fraction-digits"],1,Ye),!b))return null;let T=null;return m["max-fraction-digits"]&&(T=o.parse(m["max-fraction-digits"],1,Ye),!T)?null:new ju(u,_,x,b,T)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class Xl{constructor(r){this.type=Zt,this.sections=r}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const u=r[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const m=[];let _=!1;for(let x=1;x<=r.length-1;++x){const b=r[x];if(_&&typeof b=="object"&&!Array.isArray(b)){_=!1;let T=null;if(b["font-scale"]&&(T=o.parse(b["font-scale"],1,Ye),!T))return null;let M=null;if(b["text-font"]&&(M=o.parse(b["text-font"],1,N($t)),!M))return null;let D=null;if(b["text-color"]&&(D=o.parse(b["text-color"],1,Gn),!D))return null;const R=m[m.length-1];R.scale=T,R.font=M,R.textColor=D}else{const T=o.parse(r[x],1,Bt);if(!T)return null;const M=T.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,m.push({content:T,scale:null,font:null,textColor:null})}}return new Xl(m)}evaluate(r){return new ui(this.sections.map(o=>{const u=o.content.evaluate(r);return rr(u)===Ht?new Lu("",u,null,null,null):new Lu(Ha(u),null,o.scale?o.scale.evaluate(r):null,o.font?o.font.evaluate(r).join(","):null,o.textColor?o.textColor.evaluate(r):null)}))}eachChild(r){for(const o of this.sections)r(o.content),o.scale&&r(o.scale),o.font&&r(o.font),o.textColor&&r(o.textColor)}outputDefined(){return!1}}class Vu{constructor(r){this.type=Ht,this.input=r}static parse(r,o){if(r.length!==2)return o.error("Expected two arguments.");const u=o.parse(r[1],1,$t);return u?new Vu(u):o.error("No image name provided.")}evaluate(r){const o=this.input.evaluate(r),u=di.fromString(o);return u&&r.availableImages&&(u.available=r.availableImages.indexOf(o)>-1),u}eachChild(r){r(this.input)}outputDefined(){return!1}}class Uu{constructor(r){this.type=Ye,this.input=r}static parse(r,o){if(r.length!==2)return o.error(`Expected 1 argument, but found ${r.length-1} instead.`);const u=o.parse(r[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${j(u.type)} instead.`):new Uu(u):null}evaluate(r){const o=this.input.evaluate(r);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new Wn(`Expected value to be of type string or array, but found ${j(rr(o))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const as=8192;function Eg(s,r){const o=(180+s[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,m=Math.pow(2,r.z);return[Math.round(o*m*as),Math.round(u*m*as)]}function $u(s,r){const o=Math.pow(2,r.z);return[(m=(s[0]/as+r.x)/o,360*m-180),(u=(s[1]/as+r.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,m}function ao(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function Vs(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function fn(s,r,o){const u=s[0]-r[0],m=s[1]-r[1],_=s[0]-o[0],x=s[1]-o[1];return u*x-_*m==0&&u*_<=0&&m*x<=0}function Kl(s,r,o,u){return(m=[u[0]-o[0],u[1]-o[1]])[0]*(_=[r[0]-s[0],r[1]-s[1]])[1]-m[1]*_[0]!=0&&!(!mf(s,r,o,u)||!mf(o,u,s,r));var m,_}function Pg(s,r,o){for(const u of o)for(let m=0;m<u.length-1;++m)if(Kl(s,r,u[m],u[m+1]))return!0;return!1}function Uo(s,r,o=!1){let u=!1;for(const b of r)for(let T=0;T<b.length-1;T++){if(fn(s,b[T],b[T+1]))return o;(_=b[T])[1]>(m=s)[1]!=(x=b[T+1])[1]>m[1]&&m[0]<(x[0]-_[0])*(m[1]-_[1])/(x[1]-_[1])+_[0]&&(u=!u)}var m,_,x;return u}function Ig(s,r){for(const o of r)if(Uo(s,o))return!0;return!1}function pf(s,r){for(const o of s)if(!Uo(o,r))return!1;for(let o=0;o<s.length-1;++o)if(Pg(s[o],s[o+1],r))return!1;return!0}function Ag(s,r){for(const o of r)if(pf(s,o))return!0;return!1}function mf(s,r,o,u){const m=u[0]-o[0],_=u[1]-o[1],x=(s[0]-o[0])*_-m*(s[1]-o[1]),b=(r[0]-o[0])*_-m*(r[1]-o[1]);return x>0&&b<0||x<0&&b>0}function Hu(s,r,o){const u=[];for(let m=0;m<s.length;m++){const _=[];for(let x=0;x<s[m].length;x++){const b=Eg(s[m][x],o);ao(r,b),_.push(b)}u.push(_)}return u}function gf(s,r,o){const u=[];for(let m=0;m<s.length;m++){const _=Hu(s[m],r,o);u.push(_)}return u}function yf(s,r,o,u){if(s[0]<o[0]||s[0]>o[2]){const m=.5*u;let _=s[0]-o[0]>m?-u:o[0]-s[0]>m?u:0;_===0&&(_=s[0]-o[2]>m?-u:o[2]-s[0]>m?u:0),s[0]+=_}ao(r,s)}function vf(s,r,o,u){const m=Math.pow(2,u.z)*as,_=[u.x*as,u.y*as],x=[];for(const b of s)for(const T of b){const M=[T.x+_[0],T.y+_[1]];yf(M,r,o,m),x.push(M)}return x}function _f(s,r,o,u){const m=Math.pow(2,u.z)*as,_=[u.x*as,u.y*as],x=[];for(const T of s){const M=[];for(const D of T){const R=[D.x+_[0],D.y+_[1]];ao(r,R),M.push(R)}x.push(M)}if(r[2]-r[0]<=m/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const T of x)for(const M of T)yf(M,r,o,m)}var b;return x}class lo{constructor(r,o){this.type=Dt,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(io(r[1])){const u=r[1];if(u.type==="FeatureCollection"){const m=[];for(const _ of u.features){const{type:x,coordinates:b}=_.geometry;x==="Polygon"&&m.push(b),x==="MultiPolygon"&&m.push(...b)}if(m.length)return new lo(u,{type:"MultiPolygon",coordinates:m})}else if(u.type==="Feature"){const m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new lo(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new lo(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){const b=Hu(u.coordinates,_,x),T=vf(o.geometry(),m,_,x);if(!Vs(m,_))return!1;for(const M of T)if(!Uo(M,b))return!1}if(u.type==="MultiPolygon"){const b=gf(u.coordinates,_,x),T=vf(o.geometry(),m,_,x);if(!Vs(m,_))return!1;for(const M of T)if(!Ig(M,b))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){const b=Hu(u.coordinates,_,x),T=_f(o.geometry(),m,_,x);if(!Vs(m,_))return!1;for(const M of T)if(!pf(M,b))return!1}if(u.type==="MultiPolygon"){const b=gf(u.coordinates,_,x),T=_f(o.geometry(),m,_,x);if(!Vs(m,_))return!1;for(const M of T)if(!Ag(M,b))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let xf=class{constructor(s=[],r=(o,u)=>o<u?-1:o>u?1:0){if(this.data=s,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:r,compare:o}=this,u=r[s];for(;s>0;){const m=s-1>>1,_=r[m];if(o(u,_)>=0)break;r[s]=_,s=m}r[s]=u}_down(s){const{data:r,compare:o}=this,u=this.length>>1,m=r[s];for(;s<u;){let _=1+(s<<1);const x=_+1;if(x<this.length&&o(r[x],r[_])<0&&(_=x),o(r[_],m)>=0)break;r[s]=r[_],s=_}r[s]=m}};function Mg(s,r,o,u,m){bf(s,r,o,u||s.length-1,m||Dg)}function bf(s,r,o,u,m){for(;u>o;){if(u-o>600){var _=u-o+1,x=r-o+1,b=Math.log(_),T=.5*Math.exp(2*b/3),M=.5*Math.sqrt(b*T*(_-T)/_)*(x-_/2<0?-1:1);bf(s,r,Math.max(o,Math.floor(r-x*T/_+M)),Math.min(u,Math.floor(r+(_-x)*T/_+M)),m)}var D=s[r],R=o,O=u;for(Za(s,o,r),m(s[u],D)>0&&Za(s,o,u);R<O;){for(Za(s,R,O),R++,O--;m(s[R],D)<0;)R++;for(;m(s[O],D)>0;)O--}m(s[o],D)===0?Za(s,o,O):Za(s,++O,u),O<=r&&(o=O+1),r<=O&&(u=O-1)}}function Za(s,r,o){var u=s[r];s[r]=s[o],s[o]=u}function Dg(s,r){return s<r?-1:s>r?1:0}function Yl(s,r){if(s.length<=1)return[s];const o=[];let u,m;for(const _ of s){const x=Rg(_);x!==0&&(_.area=Math.abs(x),m===void 0&&(m=x<0),m===x<0?(u&&o.push(u),u=[_]):u.push(_))}if(u&&o.push(u),r>1)for(let _=0;_<o.length;_++)o[_].length<=r||(Mg(o[_],r,1,o[_].length-1,zg),o[_]=o[_].slice(0,r));return o}function zg(s,r){return r.area-s.area}function Rg(s){let r=0;for(let o,u,m=0,_=s.length,x=_-1;m<_;x=m++)o=s[m],u=s[x],r+=(u.x-o.x)*(o.y+u.y);return r}const wf=1/298.257223563,Sf=wf*(2-wf),kf=Math.PI/180;class Gu{constructor(r){const o=6378.137*kf*1e3,u=Math.cos(r*kf),m=1/(1-Sf*(1-u*u)),_=Math.sqrt(m);this.kx=o*_*u,this.ky=o*_*m*(1-Sf)}distance(r,o){const u=this.wrap(r[0]-o[0])*this.kx,m=(r[1]-o[1])*this.ky;return Math.sqrt(u*u+m*m)}pointOnLine(r,o){let u,m,_,x,b=1/0;for(let T=0;T<r.length-1;T++){let M=r[T][0],D=r[T][1],R=this.wrap(r[T+1][0]-M)*this.kx,O=(r[T+1][1]-D)*this.ky,U=0;R===0&&O===0||(U=(this.wrap(o[0]-M)*this.kx*R+(o[1]-D)*this.ky*O)/(R*R+O*O),U>1?(M=r[T+1][0],D=r[T+1][1]):U>0&&(M+=R/this.kx*U,D+=O/this.ky*U)),R=this.wrap(o[0]-M)*this.kx,O=(o[1]-D)*this.ky;const X=R*R+O*O;X<b&&(b=X,u=M,m=D,_=T,x=U)}return{point:[u,m],index:_,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Tf(s,r){return r[0]-s[0]}function Jl(s){return s[1]-s[0]+1}function Ss(s,r){return s[1]>=s[0]&&s[1]<r}function Wu(s,r){if(s[0]>s[1])return[null,null];const o=Jl(s);if(r){if(o===2)return[s,null];const m=Math.floor(o/2);return[[s[0],s[0]+m],[s[0]+m,s[1]]]}if(o===1)return[s,null];const u=Math.floor(o/2)-1;return[[s[0],s[0]+u],[s[0]+u+1,s[1]]]}function qu(s,r){if(!Ss(r,s.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let u=r[0];u<=r[1];++u)ao(o,s[u]);return o}function Zu(s){const r=[1/0,1/0,-1/0,-1/0];for(const o of s)for(const u of o)ao(r,u);return r}function Ql(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Xu(s,r,o){if(!Ql(s)||!Ql(r))return NaN;let u=0,m=0;return s[2]<r[0]&&(u=r[0]-s[2]),s[0]>r[2]&&(u=s[0]-r[2]),s[1]>r[3]&&(m=s[1]-r[3]),s[3]<r[1]&&(m=r[1]-s[3]),o.distance([0,0],[u,m])}function co(s,r,o){const u=o.pointOnLine(r,s);return o.distance(s,u.point)}function Ku(s,r,o,u,m){const _=Math.min(co(s,[o,u],m),co(r,[o,u],m)),x=Math.min(co(o,[s,r],m),co(u,[s,r],m));return Math.min(_,x)}function Lg(s,r,o,u,m){if(!Ss(r,s.length)||!Ss(u,o.length))return 1/0;let _=1/0;for(let x=r[0];x<r[1];++x){const b=s[x],T=s[x+1];for(let M=u[0];M<u[1];++M){const D=o[M],R=o[M+1];if(Kl(b,T,D,R))return 0;_=Math.min(_,Ku(b,T,D,R,m))}}return _}function Vn(s,r,o,u,m){if(!Ss(r,s.length)||!Ss(u,o.length))return NaN;let _=1/0;for(let x=r[0];x<=r[1];++x)for(let b=u[0];b<=u[1];++b)if(_=Math.min(_,m.distance(s[x],o[b])),_===0)return _;return _}function Bg(s,r,o){if(Uo(s,r,!0))return 0;let u=1/0;for(const m of r){const _=m[0],x=m[m.length-1];if(_!==x&&(u=Math.min(u,co(s,[x,_],o)),u===0))return u;const b=o.pointOnLine(m,s);if(u=Math.min(u,o.distance(s,b.point)),u===0)return u}return u}function Kt(s,r,o,u){if(!Ss(r,s.length))return NaN;for(let _=r[0];_<=r[1];++_)if(Uo(s[_],o,!0))return 0;let m=1/0;for(let _=r[0];_<r[1];++_){const x=s[_],b=s[_+1];for(const T of o)for(let M=0,D=T.length,R=D-1;M<D;R=M++){const O=T[R],U=T[M];if(Kl(x,b,O,U))return 0;m=Math.min(m,Ku(x,b,O,U,u))}}return m}function ec(s,r){for(const o of s)for(const u of o)if(Uo(u,r,!0))return!0;return!1}function kn(s,r,o,u=1/0){const m=Zu(s),_=Zu(r);if(u!==1/0&&Xu(m,_,o)>=u)return u;if(Vs(m,_)){if(ec(s,r))return 0}else if(ec(r,s))return 0;let x=1/0;for(const b of s)for(let T=0,M=b.length,D=M-1;T<M;D=T++){const R=b[D],O=b[T];for(const U of r)for(let X=0,Y=U.length,oe=Y-1;X<Y;oe=X++){const ue=U[oe],Te=U[X];if(Kl(R,O,ue,Te))return 0;x=Math.min(x,Ku(R,O,ue,Te,o))}}return x}function yn(s,r,o,u,m,_){if(!_)return;const x=Xu(qu(u,_),m,o);x<r&&s.push([x,_,[0,0]])}function uo(s,r,o,u,m,_,x){if(!_||!x)return;const b=Xu(qu(u,_),qu(m,x),o);b<r&&s.push([b,_,x])}function Xa(s,r,o,u,m=1/0){let _=Math.min(u.distance(s[0],o[0][0]),m);if(_===0)return _;const x=new xf([[0,[0,s.length-1],[0,0]]],Tf),b=Zu(o);for(;x.length>0;){const T=x.pop();if(T[0]>=_)continue;const M=T[1],D=r?50:100;if(Jl(M)<=D){if(!Ss(M,s.length))return NaN;if(r){const R=Kt(s,M,o,u);if(isNaN(R)||R===0)return R;_=Math.min(_,R)}else for(let R=M[0];R<=M[1];++R){const O=Bg(s[R],o,u);if(_=Math.min(_,O),_===0)return 0}}else{const R=Wu(M,r);yn(x,_,u,s,b,R[0]),yn(x,_,u,s,b,R[1])}}return _}function Ka(s,r,o,u,m,_=1/0){let x=Math.min(_,m.distance(s[0],o[0]));if(x===0)return x;const b=new xf([[0,[0,s.length-1],[0,o.length-1]]],Tf);for(;b.length>0;){const T=b.pop();if(T[0]>=x)continue;const M=T[1],D=T[2],R=r?50:100,O=u?50:100;if(Jl(M)<=R&&Jl(D)<=O){if(!Ss(M,s.length)&&Ss(D,o.length))return NaN;let U;if(r&&u)U=Lg(s,M,o,D,m),x=Math.min(x,U);else if(r&&!u){const X=s.slice(M[0],M[1]+1);for(let Y=D[0];Y<=D[1];++Y)if(U=co(o[Y],X,m),x=Math.min(x,U),x===0)return x}else if(!r&&u){const X=o.slice(D[0],D[1]+1);for(let Y=M[0];Y<=M[1];++Y)if(U=co(s[Y],X,m),x=Math.min(x,U),x===0)return x}else U=Vn(s,M,o,D,m),x=Math.min(x,U)}else{const U=Wu(M,r),X=Wu(D,u);uo(b,x,m,s,o,U[0],X[0]),uo(b,x,m,s,o,U[0],X[1]),uo(b,x,m,s,o,U[1],X[0]),uo(b,x,m,s,o,U[1],X[1])}}return x}function Yu(s){return s.type==="MultiPolygon"?s.coordinates.map(r=>({type:"Polygon",coordinates:r})):s.type==="MultiLineString"?s.coordinates.map(r=>({type:"LineString",coordinates:r})):s.type==="MultiPoint"?s.coordinates.map(r=>({type:"Point",coordinates:r})):[s]}class ho{constructor(r,o){this.type=Ye,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(io(r[1])){const u=r[1];if(u.type==="FeatureCollection")return new ho(u,u.features.map(m=>Yu(m.geometry)).flat());if(u.type==="Feature")return new ho(u,Yu(u.geometry));if("type"in u&&"coordinates"in u)return new ho(u,Yu(u))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,u){const m=o.geometry(),_=m.flat().map(T=>$u([T.x,T.y],o.canonical));if(m.length===0)return NaN;const x=new Gu(_[0][1]);let b=1/0;for(const T of u){switch(T.type){case"Point":b=Math.min(b,Ka(_,!1,[T.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,Ka(_,!1,T.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,Xa(_,!1,T.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,u){const m=o.geometry(),_=m.flat().map(T=>$u([T.x,T.y],o.canonical));if(m.length===0)return NaN;const x=new Gu(_[0][1]);let b=1/0;for(const T of u){switch(T.type){case"Point":b=Math.min(b,Ka(_,!0,[T.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,Ka(_,!0,T.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,Xa(_,!0,T.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="Polygon")return function(o,u){const m=o.geometry();if(m.length===0||m[0].length===0)return NaN;const _=Yl(m,0).map(T=>T.map(M=>M.map(D=>$u([D.x,D.y],o.canonical)))),x=new Gu(_[0][0][0][1]);let b=1/0;for(const T of u)for(const M of _){switch(T.type){case"Point":b=Math.min(b,Xa([T.coordinates],!1,M,x,b));break;case"LineString":b=Math.min(b,Xa(T.coordinates,!0,M,x,b));break;case"Polygon":b=Math.min(b,kn(M,T.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const $o={"==":kg,"!=":hf,">":Tg,"<":df,">=":ff,"<=":Cg,array:$i,at:Fu,boolean:$i,case:Hl,coalesce:ql,collator:qa,format:Xl,image:Vu,in:Nu,"index-of":Oo,interpolate:Yr,"interpolate-hcl":Yr,"interpolate-lab":Yr,length:Uu,let:js,literal:Ui,match:Ou,number:$i,"number-format":ju,object:$i,slice:Ga,step:jo,string:$i,"to-boolean":Hi,"to-color":Hi,"to-number":Hi,"to-string":Hi,var:hn,within:lo,distance:ho};class Ei{constructor(r,o,u,m){this.name=r,this.type=o,this._evaluate=u,this.args=m}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,o){const u=r[0],m=Ei.definitions[u];if(!m)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,b=x.filter(([M])=>!Array.isArray(M)||M.length===r.length-1);let T=null;for(const[M,D]of b){T=new so(o.registry,Ya,o.path,null,o.scope);const R=[];let O=!1;for(let U=1;U<r.length;U++){const X=r[U],Y=Array.isArray(M)?M[U-1]:M.type,oe=T.parse(X,1+R.length,Y);if(!oe){O=!0;break}R.push(oe)}if(!O)if(Array.isArray(M)&&M.length!==R.length)T.error(`Expected ${M.length} arguments, but found ${R.length} instead.`);else{for(let U=0;U<R.length;U++){const X=Array.isArray(M)?M[U]:M.type,Y=R[U];T.concat(U+1).checkSubtype(X,Y.type)}if(T.errors.length===0)return new Ei(u,_,D,R)}}if(b.length===1)o.errors.push(...T.errors);else{const M=(b.length?b:x).map(([R])=>{return O=R,Array.isArray(O)?`(${O.map(j).join(", ")})`:`(${j(O.type)}...)`;var O}).join(" | "),D=[];for(let R=1;R<r.length;R++){const O=o.parse(r[R],1+D.length);if(!O)return null;D.push(j(O.type))}o.error(`Expected arguments of type ${M}, but found (${D.join(", ")}) instead.`)}return null}static register(r,o){Ei.definitions=o;for(const u in o)r[u]=Ei}}function Ju(s,[r,o,u,m]){r=r.evaluate(s),o=o.evaluate(s),u=u.evaluate(s);const _=m?m.evaluate(s):1,x=No(r,o,u,_);if(x)throw new Wn(x);return new gn(r/255,o/255,u/255,_,!1)}function Qu(s,r){return s in r}function eh(s,r){const o=r[s];return o===void 0?null:o}function fo(s){return{type:s}}function Ya(s){if(s instanceof hn)return Ya(s.boundExpression);if(s instanceof Ei&&s.name==="error"||s instanceof qa||s instanceof lo||s instanceof ho)return!1;const r=s instanceof Hi||s instanceof $i;let o=!0;return s.eachChild(u=>{o=r?o&&Ya(u):o&&u instanceof Ui}),!!o&&Ja(s)&&Qa(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ja(s){if(s instanceof Ei&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof lo||s instanceof ho)return!1;let r=!0;return s.eachChild(o=>{r&&!Ja(o)&&(r=!1)}),r}function Ho(s){if(s instanceof Ei&&s.name==="feature-state")return!1;let r=!0;return s.eachChild(o=>{r&&!Ho(o)&&(r=!1)}),r}function Qa(s,r){if(s instanceof Ei&&r.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(u=>{o&&!Qa(u,r)&&(o=!1)}),o}function tc(s){return{result:"success",value:s}}function Go(s){return{result:"error",value:s}}function Wo(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Cf(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function th(s){return!!s.expression&&s.expression.interpolated}function cn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function nc(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Fg(s){return s}function Ef(s,r){const o=r.type==="color",u=s.stops&&typeof s.stops[0][0]=="object",m=u||!(u||s.property!==void 0),_=s.type||(th(r)?"exponential":"interval");if(o||r.type==="padding"){const D=o?gn.parse:hi.parse;(s=tr({},s)).stops&&(s.stops=s.stops.map(R=>[R[0],D(R[1])])),s.default=D(s.default?s.default:r.default)}if(s.colorSpace&&(x=s.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var x;let b,T,M;if(_==="exponential")b=If;else if(_==="interval")b=rc;else if(_==="categorical"){b=Pf,T=Object.create(null);for(const D of s.stops)T[D[0]]=D[1];M=typeof s.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);b=Af}if(u){const D={},R=[];for(let X=0;X<s.stops.length;X++){const Y=s.stops[X],oe=Y[0].zoom;D[oe]===void 0&&(D[oe]={zoom:oe,type:s.type,property:s.property,default:s.default,stops:[]},R.push(oe)),D[oe].stops.push([Y[0].value,Y[1]])}const O=[];for(const X of R)O.push([D[X].zoom,Ef(D[X],r)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Yr.interpolationFactor.bind(void 0,U),zoomStops:O.map(X=>X[0]),evaluate:({zoom:X},Y)=>If({stops:O,base:s.base},r,X).evaluate(X,Y)}}if(m){const D=_==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Yr.interpolationFactor.bind(void 0,D),zoomStops:s.stops.map(R=>R[0]),evaluate:({zoom:R})=>b(s,r,R,T,M)}}return{kind:"source",evaluate(D,R){const O=R&&R.properties?R.properties[s.property]:void 0;return O===void 0?qo(s.default,r.default):b(s,r,O,T,M)}}}function qo(s,r,o){return s!==void 0?s:r!==void 0?r:o!==void 0?o:void 0}function Pf(s,r,o,u,m){return qo(typeof o===m?u[o]:void 0,s.default,r.default)}function rc(s,r,o){if(cn(o)!=="number")return qo(s.default,r.default);const u=s.stops.length;if(u===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[u-1][0])return s.stops[u-1][1];const m=Gl(s.stops.map(_=>_[0]),o);return s.stops[m][1]}function If(s,r,o){const u=s.base!==void 0?s.base:1;if(cn(o)!=="number")return qo(s.default,r.default);const m=s.stops.length;if(m===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[m-1][0])return s.stops[m-1][1];const _=Gl(s.stops.map(D=>D[0]),o),x=function(D,R,O,U){const X=U-O,Y=D-O;return X===0?0:R===1?Y/X:(Math.pow(R,Y)-1)/(Math.pow(R,X)-1)}(o,u,s.stops[_][0],s.stops[_+1][0]),b=s.stops[_][1],T=s.stops[_+1][1],M=Kr[r.type]||Fg;return typeof b.evaluate=="function"?{evaluate(...D){const R=b.evaluate.apply(void 0,D),O=T.evaluate.apply(void 0,D);if(R!==void 0&&O!==void 0)return M(R,O,x,s.colorSpace)}}:M(b,T,x,s.colorSpace)}function Af(s,r,o){switch(r.type){case"color":o=gn.parse(o);break;case"formatted":o=ui.fromString(o.toString());break;case"resolvedImage":o=di.fromString(o.toString());break;case"padding":o=hi.parse(o);break;default:cn(o)===r.type||r.type==="enum"&&r.values[o]||(o=void 0)}return qo(o,s.default,r.default)}Ei.register($o,{error:[{kind:"error"},[$t],(s,[r])=>{throw new Wn(r.evaluate(s))}],typeof:[$t,[Bt],(s,[r])=>j(rr(r.evaluate(s)))],"to-rgba":[N(Ye,4),[Gn],(s,[r])=>{const[o,u,m,_]=r.evaluate(s).rgb;return[255*o,255*u,255*m,_]}],rgb:[Gn,[Ye,Ye,Ye],Ju],rgba:[Gn,[Ye,Ye,Ye,Ye],Ju],has:{type:Dt,overloads:[[[$t],(s,[r])=>Qu(r.evaluate(s),s.properties())],[[$t,xr],(s,[r,o])=>Qu(r.evaluate(s),o.evaluate(s))]]},get:{type:Bt,overloads:[[[$t],(s,[r])=>eh(r.evaluate(s),s.properties())],[[$t,xr],(s,[r,o])=>eh(r.evaluate(s),o.evaluate(s))]]},"feature-state":[Bt,[$t],(s,[r])=>eh(r.evaluate(s),s.featureState||{})],properties:[xr,[],s=>s.properties()],"geometry-type":[$t,[],s=>s.geometryType()],id:[Bt,[],s=>s.id()],zoom:[Ye,[],s=>s.globals.zoom],"heatmap-density":[Ye,[],s=>s.globals.heatmapDensity||0],"line-progress":[Ye,[],s=>s.globals.lineProgress||0],accumulated:[Bt,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[Ye,fo(Ye),(s,r)=>{let o=0;for(const u of r)o+=u.evaluate(s);return o}],"*":[Ye,fo(Ye),(s,r)=>{let o=1;for(const u of r)o*=u.evaluate(s);return o}],"-":{type:Ye,overloads:[[[Ye,Ye],(s,[r,o])=>r.evaluate(s)-o.evaluate(s)],[[Ye],(s,[r])=>-r.evaluate(s)]]},"/":[Ye,[Ye,Ye],(s,[r,o])=>r.evaluate(s)/o.evaluate(s)],"%":[Ye,[Ye,Ye],(s,[r,o])=>r.evaluate(s)%o.evaluate(s)],ln2:[Ye,[],()=>Math.LN2],pi:[Ye,[],()=>Math.PI],e:[Ye,[],()=>Math.E],"^":[Ye,[Ye,Ye],(s,[r,o])=>Math.pow(r.evaluate(s),o.evaluate(s))],sqrt:[Ye,[Ye],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[Ye,[Ye],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[Ye,[Ye],(s,[r])=>Math.log(r.evaluate(s))],log2:[Ye,[Ye],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[Ye,[Ye],(s,[r])=>Math.sin(r.evaluate(s))],cos:[Ye,[Ye],(s,[r])=>Math.cos(r.evaluate(s))],tan:[Ye,[Ye],(s,[r])=>Math.tan(r.evaluate(s))],asin:[Ye,[Ye],(s,[r])=>Math.asin(r.evaluate(s))],acos:[Ye,[Ye],(s,[r])=>Math.acos(r.evaluate(s))],atan:[Ye,[Ye],(s,[r])=>Math.atan(r.evaluate(s))],min:[Ye,fo(Ye),(s,r)=>Math.min(...r.map(o=>o.evaluate(s)))],max:[Ye,fo(Ye),(s,r)=>Math.max(...r.map(o=>o.evaluate(s)))],abs:[Ye,[Ye],(s,[r])=>Math.abs(r.evaluate(s))],round:[Ye,[Ye],(s,[r])=>{const o=r.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[Ye,[Ye],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[Ye,[Ye],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[Dt,[$t,Bt],(s,[r,o])=>s.properties()[r.value]===o.value],"filter-id-==":[Dt,[Bt],(s,[r])=>s.id()===r.value],"filter-type-==":[Dt,[$t],(s,[r])=>s.geometryType()===r.value],"filter-<":[Dt,[$t,Bt],(s,[r,o])=>{const u=s.properties()[r.value],m=o.value;return typeof u==typeof m&&u<m}],"filter-id-<":[Dt,[Bt],(s,[r])=>{const o=s.id(),u=r.value;return typeof o==typeof u&&o<u}],"filter->":[Dt,[$t,Bt],(s,[r,o])=>{const u=s.properties()[r.value],m=o.value;return typeof u==typeof m&&u>m}],"filter-id->":[Dt,[Bt],(s,[r])=>{const o=s.id(),u=r.value;return typeof o==typeof u&&o>u}],"filter-<=":[Dt,[$t,Bt],(s,[r,o])=>{const u=s.properties()[r.value],m=o.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[Dt,[Bt],(s,[r])=>{const o=s.id(),u=r.value;return typeof o==typeof u&&o<=u}],"filter->=":[Dt,[$t,Bt],(s,[r,o])=>{const u=s.properties()[r.value],m=o.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[Dt,[Bt],(s,[r])=>{const o=s.id(),u=r.value;return typeof o==typeof u&&o>=u}],"filter-has":[Dt,[Bt],(s,[r])=>r.value in s.properties()],"filter-has-id":[Dt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Dt,[N($t)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[Dt,[N(Bt)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[Dt,[$t,N(Bt)],(s,[r,o])=>o.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[Dt,[$t,N(Bt)],(s,[r,o])=>function(u,m,_,x){for(;_<=x;){const b=_+x>>1;if(m[b]===u)return!0;m[b]>u?x=b-1:_=b+1}return!1}(s.properties()[r.value],o.value,0,o.value.length-1)],all:{type:Dt,overloads:[[[Dt,Dt],(s,[r,o])=>r.evaluate(s)&&o.evaluate(s)],[fo(Dt),(s,r)=>{for(const o of r)if(!o.evaluate(s))return!1;return!0}]]},any:{type:Dt,overloads:[[[Dt,Dt],(s,[r,o])=>r.evaluate(s)||o.evaluate(s)],[fo(Dt),(s,r)=>{for(const o of r)if(o.evaluate(s))return!0;return!1}]]},"!":[Dt,[Dt],(s,[r])=>!r.evaluate(s)],"is-supported-script":[Dt,[$t],(s,[r])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(r.evaluate(s))}],upcase:[$t,[$t],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[$t,[$t],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[$t,fo(Bt),(s,r)=>r.map(o=>Ha(o.evaluate(s))).join("")],"resolved-locale":[$t,[xt],(s,[r])=>r.evaluate(s).resolvedLocale()]});class ic{constructor(r,o){var u;this.expression=r,this._warningHistory={},this._evaluator=new $l,this._defaultValue=o?(u=o).type==="color"&&nc(u.default)?new gn(0,0,0,0):u.type==="color"?gn.parse(u.default)||null:u.type==="padding"?hi.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?Ci.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(r,o,u,m,_,x){return this._evaluator.globals=r,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,o,u,m,_,x){this._evaluator.globals=r,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Wn(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function sc(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in $o}function Zo(s,r){const o=new so($o,Ya,[],r?function(m){const _={color:Gn,string:$t,number:Ye,enum:$t,boolean:Dt,formatted:Zt,padding:Qt,resolvedImage:Ht,variableAnchorOffsetCollection:ie};return m.type==="array"?N(_[m.value]||Bt,m.length):_[m.type]}(r):void 0),u=o.parse(s,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?tc(new ic(u,r)):Go(o.errors)}class Xo{constructor(r,o){this.kind=r,this._styleExpression=o,this.isStateDependent=r!=="constant"&&!Ho(o.expression)}evaluateWithoutErrorHandling(r,o,u,m,_,x){return this._styleExpression.evaluateWithoutErrorHandling(r,o,u,m,_,x)}evaluate(r,o,u,m,_,x){return this._styleExpression.evaluate(r,o,u,m,_,x)}}class Ko{constructor(r,o,u,m){this.kind=r,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=r!=="camera"&&!Ho(o.expression),this.interpolationType=m}evaluateWithoutErrorHandling(r,o,u,m,_,x){return this._styleExpression.evaluateWithoutErrorHandling(r,o,u,m,_,x)}evaluate(r,o,u,m,_,x){return this._styleExpression.evaluate(r,o,u,m,_,x)}interpolationFactor(r,o,u){return this.interpolationType?Yr.interpolationFactor(this.interpolationType,r,o,u):0}}function nh(s,r){const o=Zo(s,r);if(o.result==="error")return o;const u=o.value.expression,m=Ja(u);if(!m&&!Wo(r))return Go([new dn("","data expressions not supported")]);const _=Qa(u,["zoom"]);if(!_&&!Cf(r))return Go([new dn("","zoom expressions not supported")]);const x=el(u);return x||_?x instanceof dn?Go([x]):x instanceof Yr&&!th(r)?Go([new dn("",'"interpolate" expressions cannot be used with this property')]):tc(x?new Ko(m?"camera":"composite",o.value,x.labels,x instanceof Yr?x.interpolation:void 0):new Xo(m?"constant":"source",o.value)):Go([new dn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Yo{constructor(r,o){this._parameters=r,this._specification=o,tr(this,Ef(this._parameters,this._specification))}static deserialize(r){return new Yo(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function el(s){let r=null;if(s instanceof js)r=el(s.result);else if(s instanceof ql){for(const o of s.args)if(r=el(o),r)break}else(s instanceof jo||s instanceof Yr)&&s.input instanceof Ei&&s.input.name==="zoom"&&(r=s);return r instanceof dn||s.eachChild(o=>{const u=el(o);u instanceof dn?r=u:!r&&u?r=new dn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&u&&r!==u&&(r=new dn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function oc(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!oc(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const ac={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rh(s){if(s==null)return{filter:()=>!0,needGeometry:!1};oc(s)||(s=lc(s));const r=Zo(s,ac);if(r.result==="error")throw new Error(r.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,u,m)=>r.value.evaluate(o,u,{},m),needGeometry:Mf(s)}}function Ng(s,r){return s<r?-1:s>r?1:0}function Mf(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let r=1;r<s.length;r++)if(Mf(s[r]))return!0;return!1}function lc(s){if(!s)return!0;const r=s[0];return s.length<=1?r!=="any":r==="=="?ih(s[1],s[2],"=="):r==="!="?Ar(ih(s[1],s[2],"==")):r==="<"||r===">"||r==="<="||r===">="?ih(s[1],s[2],r):r==="any"?(o=s.slice(1),["any"].concat(o.map(lc))):r==="all"?["all"].concat(s.slice(1).map(lc)):r==="none"?["all"].concat(s.slice(1).map(lc).map(Ar)):r==="in"?tl(s[1],s.slice(2)):r==="!in"?Ar(tl(s[1],s.slice(2))):r==="has"?nl(s[1]):r!=="!has"||Ar(nl(s[1]));var o}function ih(s,r,o){switch(s){case"$type":return[`filter-type-${o}`,r];case"$id":return[`filter-id-${o}`,r];default:return[`filter-${o}`,s,r]}}function tl(s,r){if(r.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(o=>typeof o!=typeof r[0])?["filter-in-large",s,["literal",r.sort(Ng)]]:["filter-in-small",s,["literal",r]]}}function nl(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Ar(s){return["!",s]}function po(s){const r=typeof s;if(r==="number"||r==="boolean"||r==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let m="[";for(const _ of s)m+=`${po(_)},`;return`${m}]`}const o=Object.keys(s).sort();let u="{";for(let m=0;m<o.length;m++)u+=`${JSON.stringify(o[m])}:${po(s[o[m]])},`;return`${u}}`}function Df(s){let r="";for(const o of Sn)r+=`/${po(s[o])}`;return r}function zf(s){const r=s.value;return r?[new qe(s.key,r,"constants have been deprecated as of v8")]:[]}function Un(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Gi(s){if(Array.isArray(s))return s.map(Gi);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const o in s)r[o]=Gi(s[o]);return r}return Un(s)}function fi(s){const r=s.key,o=s.value,u=s.valueSpec||{},m=s.objectElementValidators||{},_=s.style,x=s.styleSpec,b=s.validateSpec;let T=[];const M=cn(o);if(M!=="object")return[new qe(r,o,`object expected, ${M} found`)];for(const D in o){const R=D.split(".")[0],O=u[R]||u["*"];let U;if(m[R])U=m[R];else if(u[R])U=b;else if(m["*"])U=m["*"];else{if(!u["*"]){T.push(new qe(r,o[D],`unknown property "${D}"`));continue}U=b}T=T.concat(U({key:(r&&`${r}.`)+D,value:o[D],valueSpec:O,style:_,styleSpec:x,object:o,objectKey:D,validateSpec:b},o))}for(const D in u)m[D]||u[D].required&&u[D].default===void 0&&o[D]===void 0&&T.push(new qe(r,o,`missing required property "${D}"`));return T}function rl(s){const r=s.value,o=s.valueSpec,u=s.style,m=s.styleSpec,_=s.key,x=s.arrayElementValidator||s.validateSpec;if(cn(r)!=="array")return[new qe(_,r,`array expected, ${cn(r)} found`)];if(o.length&&r.length!==o.length)return[new qe(_,r,`array length ${o.length} expected, length ${r.length} found`)];if(o["min-length"]&&r.length<o["min-length"])return[new qe(_,r,`array length at least ${o["min-length"]} expected, length ${r.length} found`)];let b={type:o.value,values:o.values};m.$version<7&&(b.function=o.function),cn(o.value)==="object"&&(b=o.value);let T=[];for(let M=0;M<r.length;M++)T=T.concat(x({array:r,arrayIndex:M,value:r[M],valueSpec:b,validateSpec:s.validateSpec,style:u,styleSpec:m,key:`${_}[${M}]`}));return T}function sh(s){const r=s.key,o=s.value,u=s.valueSpec;let m=cn(o);return m==="number"&&o!=o&&(m="NaN"),m!=="number"?[new qe(r,o,`number expected, ${m} found`)]:"minimum"in u&&o<u.minimum?[new qe(r,o,`${o} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&o>u.maximum?[new qe(r,o,`${o} is greater than the maximum value ${u.maximum}`)]:[]}function cc(s){const r=s.valueSpec,o=Un(s.value.type);let u,m,_,x={};const b=o!=="categorical"&&s.value.property===void 0,T=!b,M=cn(s.value.stops)==="array"&&cn(s.value.stops[0])==="array"&&cn(s.value.stops[0][0])==="object",D=fi({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(U){if(o==="identity")return[new qe(U.key,U.value,'identity function may not have a "stops" property')];let X=[];const Y=U.value;return X=X.concat(rl({key:U.key,value:Y,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:R})),cn(Y)==="array"&&Y.length===0&&X.push(new qe(U.key,Y,"array must have at least one stop")),X},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:r,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return o==="identity"&&b&&D.push(new qe(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||D.push(new qe(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!th(s.valueSpec)&&D.push(new qe(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(T&&!Wo(s.valueSpec)?D.push(new qe(s.key,s.value,"property functions not supported")):b&&!Cf(s.valueSpec)&&D.push(new qe(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!M||s.value.property!==void 0||D.push(new qe(s.key,s.value,'"property" property is required')),D;function R(U){let X=[];const Y=U.value,oe=U.key;if(cn(Y)!=="array")return[new qe(oe,Y,`array expected, ${cn(Y)} found`)];if(Y.length!==2)return[new qe(oe,Y,`array length 2 expected, length ${Y.length} found`)];if(M){if(cn(Y[0])!=="object")return[new qe(oe,Y,`object expected, ${cn(Y[0])} found`)];if(Y[0].zoom===void 0)return[new qe(oe,Y,"object stop key must have zoom")];if(Y[0].value===void 0)return[new qe(oe,Y,"object stop key must have value")];if(_&&_>Un(Y[0].zoom))return[new qe(oe,Y[0].zoom,"stop zoom values must appear in ascending order")];Un(Y[0].zoom)!==_&&(_=Un(Y[0].zoom),m=void 0,x={}),X=X.concat(fi({key:`${oe}[0]`,value:Y[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:sh,value:O}}))}else X=X.concat(O({key:`${oe}[0]`,value:Y[0],validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},Y));return sc(Gi(Y[1]))?X.concat([new qe(`${oe}[1]`,Y[1],"expressions are not allowed in function stops.")]):X.concat(U.validateSpec({key:`${oe}[1]`,value:Y[1],valueSpec:r,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function O(U,X){const Y=cn(U.value),oe=Un(U.value),ue=U.value!==null?U.value:X;if(u){if(Y!==u)return[new qe(U.key,ue,`${Y} stop domain type must match previous stop domain type ${u}`)]}else u=Y;if(Y!=="number"&&Y!=="string"&&Y!=="boolean")return[new qe(U.key,ue,"stop domain value must be a number, string, or boolean")];if(Y!=="number"&&o!=="categorical"){let Te=`number expected, ${Y} found`;return Wo(r)&&o===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new qe(U.key,ue,Te)]}return o!=="categorical"||Y!=="number"||isFinite(oe)&&Math.floor(oe)===oe?o!=="categorical"&&Y==="number"&&m!==void 0&&oe<m?[new qe(U.key,ue,"stop domain values must appear in ascending order")]:(m=oe,o==="categorical"&&oe in x?[new qe(U.key,ue,"stop domain values must be unique")]:(x[oe]=!0,[])):[new qe(U.key,ue,`integer expected, found ${oe}`)]}}function Jo(s){const r=(s.expressionContext==="property"?nh:Zo)(Gi(s.value),s.valueSpec);if(r.result==="error")return r.value.map(u=>new qe(`${s.key}${u.key}`,s.value,u.message));const o=r.value.expression||r.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new qe(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Ho(o))return[new qe(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!Ho(o))return[new qe(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Qa(o,["zoom","feature-state"]))return[new qe(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Ja(o))return[new qe(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ks(s){const r=s.key,o=s.value,u=s.valueSpec,m=[];return Array.isArray(u.values)?u.values.indexOf(Un(o))===-1&&m.push(new qe(r,o,`expected one of [${u.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(u.values).indexOf(Un(o))===-1&&m.push(new qe(r,o,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(o)} found`)),m}function oh(s){return oc(Gi(s.value))?Jo(tr({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):uc(s)}function uc(s){const r=s.value,o=s.key;if(cn(r)!=="array")return[new qe(o,r,`array expected, ${cn(r)} found`)];const u=s.styleSpec;let m,_=[];if(r.length<1)return[new qe(o,r,"filter array must have at least 1 element")];switch(_=_.concat(ks({key:`${o}[0]`,value:r[0],valueSpec:u.filter_operator,style:s.style,styleSpec:s.styleSpec})),Un(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Un(r[1])==="$type"&&_.push(new qe(o,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&_.push(new qe(o,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(m=cn(r[1]),m!=="string"&&_.push(new qe(`${o}[1]`,r[1],`string expected, ${m} found`)));for(let x=2;x<r.length;x++)m=cn(r[x]),Un(r[1])==="$type"?_=_.concat(ks({key:`${o}[${x}]`,value:r[x],valueSpec:u.geometry_type,style:s.style,styleSpec:s.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&_.push(new qe(`${o}[${x}]`,r[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)_=_.concat(uc({key:`${o}[${x}]`,value:r[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":m=cn(r[1]),r.length!==2?_.push(new qe(o,r,`filter array for "${r[0]}" operator must have 2 elements`)):m!=="string"&&_.push(new qe(`${o}[1]`,r[1],`string expected, ${m} found`))}return _}function ah(s,r){const o=s.key,u=s.validateSpec,m=s.style,_=s.styleSpec,x=s.value,b=s.objectKey,T=_[`${r}_${s.layerType}`];if(!T)return[];const M=b.match(/^(.*)-transition$/);if(r==="paint"&&M&&T[M[1]]&&T[M[1]].transition)return u({key:o,value:x,valueSpec:_.transition,style:m,styleSpec:_});const D=s.valueSpec||T[b];if(!D)return[new qe(o,x,`unknown property "${b}"`)];let R;if(cn(x)==="string"&&Wo(D)&&!D.tokens&&(R=/^{([^}]+)}$/.exec(x)))return[new qe(o,x,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const O=[];return s.layerType==="symbol"&&(b==="text-field"&&m&&!m.glyphs&&O.push(new qe(o,x,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&nc(Gi(x))&&Un(x.type)==="identity"&&O.push(new qe(o,x,'"text-font" does not support identity functions'))),O.concat(u({key:s.key,value:x,valueSpec:D,style:m,styleSpec:_,expressionContext:"property",propertyType:r,propertyKey:b}))}function hc(s){return ah(s,"paint")}function lh(s){return ah(s,"layout")}function ch(s){let r=[];const o=s.value,u=s.key,m=s.style,_=s.styleSpec;o.type||o.ref||r.push(new qe(u,o,'either "type" or "ref" is required'));let x=Un(o.type);const b=Un(o.ref);if(o.id){const T=Un(o.id);for(let M=0;M<s.arrayIndex;M++){const D=m.layers[M];Un(D.id)===T&&r.push(new qe(u,o.id,`duplicate layer id "${o.id}", previously used at line ${D.id.__line__}`))}}if("ref"in o){let T;["type","source","source-layer","filter","layout"].forEach(M=>{M in o&&r.push(new qe(u,o[M],`"${M}" is prohibited for ref layers`))}),m.layers.forEach(M=>{Un(M.id)===b&&(T=M)}),T?T.ref?r.push(new qe(u,o.ref,"ref cannot reference another ref layer")):x=Un(T.type):r.push(new qe(u,o.ref,`ref layer "${b}" not found`))}else if(x!=="background")if(o.source){const T=m.sources&&m.sources[o.source],M=T&&Un(T.type);T?M==="vector"&&x==="raster"?r.push(new qe(u,o.source,`layer "${o.id}" requires a raster source`)):M!=="raster-dem"&&x==="hillshade"?r.push(new qe(u,o.source,`layer "${o.id}" requires a raster-dem source`)):M==="raster"&&x!=="raster"?r.push(new qe(u,o.source,`layer "${o.id}" requires a vector source`)):M!=="vector"||o["source-layer"]?M==="raster-dem"&&x!=="hillshade"?r.push(new qe(u,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||M==="geojson"&&T.lineMetrics||r.push(new qe(u,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new qe(u,o,`layer "${o.id}" must specify a "source-layer"`)):r.push(new qe(u,o.source,`source "${o.source}" not found`))}else r.push(new qe(u,o,'missing required property "source"'));return r=r.concat(fi({key:u,value:o,valueSpec:_.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${u}.type`,value:o.type,valueSpec:_.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:o,objectKey:"type"}),filter:oh,layout:T=>fi({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>lh(tr({layerType:x},M))}}),paint:T=>fi({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>hc(tr({layerType:x},M))}})}})),r}function mo(s){const r=s.value,o=s.key,u=cn(r);return u!=="string"?[new qe(o,r,`string expected, ${u} found`)]:[]}const dc={promoteId:function({key:s,value:r}){if(cn(r)==="string")return mo({key:s,value:r});{const o=[];for(const u in r)o.push(...mo({key:`${s}.${u}`,value:r[u]}));return o}}};function il(s){const r=s.value,o=s.key,u=s.styleSpec,m=s.style,_=s.validateSpec;if(!r.type)return[new qe(o,r,'"type" is required')];const x=Un(r.type);let b;switch(x){case"vector":case"raster":return b=fi({key:o,value:r,valueSpec:u[`source_${x.replace("-","_")}`],style:s.style,styleSpec:u,objectElementValidators:dc,validateSpec:_}),b;case"raster-dem":return b=function(T){var M;const D=(M=T.sourceName)!==null&&M!==void 0?M:"",R=T.value,O=T.styleSpec,U=O.source_raster_dem,X=T.style;let Y=[];const oe=cn(R);if(R===void 0)return Y;if(oe!=="object")return Y.push(new qe("source_raster_dem",R,`object expected, ${oe} found`)),Y;const ue=Un(R.encoding)==="custom",Te=["redFactor","greenFactor","blueFactor","baseShift"],ve=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const Se in R)!ue&&Te.includes(Se)?Y.push(new qe(Se,R[Se],`In "${D}": "${Se}" is only valid when "encoding" is set to "custom". ${ve} encoding found`)):U[Se]?Y=Y.concat(T.validateSpec({key:Se,value:R[Se],valueSpec:U[Se],validateSpec:T.validateSpec,style:X,styleSpec:O})):Y.push(new qe(Se,R[Se],`unknown property "${Se}"`));return Y}({sourceName:o,value:r,style:s.style,styleSpec:u,validateSpec:_}),b;case"geojson":if(b=fi({key:o,value:r,valueSpec:u.source_geojson,style:m,styleSpec:u,validateSpec:_,objectElementValidators:dc}),r.cluster)for(const T in r.clusterProperties){const[M,D]=r.clusterProperties[T],R=typeof M=="string"?[M,["accumulated"],["get",T]]:M;b.push(...Jo({key:`${o}.${T}.map`,value:D,expressionContext:"cluster-map"})),b.push(...Jo({key:`${o}.${T}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return b;case"video":return fi({key:o,value:r,valueSpec:u.source_video,style:m,validateSpec:_,styleSpec:u});case"image":return fi({key:o,value:r,valueSpec:u.source_image,style:m,validateSpec:_,styleSpec:u});case"canvas":return[new qe(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ks({key:`${o}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function uh(s){const r=s.value,o=s.styleSpec,u=o.light,m=s.style;let _=[];const x=cn(r);if(r===void 0)return _;if(x!=="object")return _=_.concat([new qe("light",r,`object expected, ${x} found`)]),_;for(const b in r){const T=b.match(/^(.*)-transition$/);_=_.concat(T&&u[T[1]]&&u[T[1]].transition?s.validateSpec({key:b,value:r[b],valueSpec:o.transition,validateSpec:s.validateSpec,style:m,styleSpec:o}):u[b]?s.validateSpec({key:b,value:r[b],valueSpec:u[b],validateSpec:s.validateSpec,style:m,styleSpec:o}):[new qe(b,r[b],`unknown property "${b}"`)])}return _}function hh(s){const r=s.value,o=s.styleSpec,u=o.sky,m=s.style,_=cn(r);if(r===void 0)return[];if(_!=="object")return[new qe("sky",r,`object expected, ${_} found`)];let x=[];for(const b in r)x=x.concat(u[b]?s.validateSpec({key:b,value:r[b],valueSpec:u[b],style:m,styleSpec:o}):[new qe(b,r[b],`unknown property "${b}"`)]);return x}function dh(s){const r=s.value,o=s.styleSpec,u=o.terrain,m=s.style;let _=[];const x=cn(r);if(r===void 0)return _;if(x!=="object")return _=_.concat([new qe("terrain",r,`object expected, ${x} found`)]),_;for(const b in r)_=_.concat(u[b]?s.validateSpec({key:b,value:r[b],valueSpec:u[b],validateSpec:s.validateSpec,style:m,styleSpec:o}):[new qe(b,r[b],`unknown property "${b}"`)]);return _}function fh(s){let r=[];const o=s.value,u=s.key;if(Array.isArray(o)){const m=[],_=[];for(const x in o)o[x].id&&m.includes(o[x].id)&&r.push(new qe(u,o,`all the sprites' ids must be unique, but ${o[x].id} is duplicated`)),m.push(o[x].id),o[x].url&&_.includes(o[x].url)&&r.push(new qe(u,o,`all the sprites' URLs must be unique, but ${o[x].url} is duplicated`)),_.push(o[x].url),r=r.concat(fi({key:`${u}[${x}]`,value:o[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return r}return mo({key:u,value:o})}const fc={"*":()=>[],array:rl,boolean:function(s){const r=s.value,o=s.key,u=cn(r);return u!=="boolean"?[new qe(o,r,`boolean expected, ${u} found`)]:[]},number:sh,color:function(s){const r=s.key,o=s.value,u=cn(o);return u!=="string"?[new qe(r,o,`color expected, ${u} found`)]:gn.parse(String(o))?[]:[new qe(r,o,`color expected, "${o}" found`)]},constants:zf,enum:ks,filter:oh,function:cc,layer:ch,object:fi,source:il,light:uh,sky:hh,terrain:dh,projection:function(s){const r=s.value,o=s.styleSpec,u=o.projection,m=s.style,_=cn(r);if(r===void 0)return[];if(_!=="object")return[new qe("projection",r,`object expected, ${_} found`)];let x=[];for(const b in r)x=x.concat(u[b]?s.validateSpec({key:b,value:r[b],valueSpec:u[b],style:m,styleSpec:o}):[new qe(b,r[b],`unknown property "${b}"`)]);return x},string:mo,formatted:function(s){return mo(s).length===0?[]:Jo(s)},resolvedImage:function(s){return mo(s).length===0?[]:Jo(s)},padding:function(s){const r=s.key,o=s.value;if(cn(o)==="array"){if(o.length<1||o.length>4)return[new qe(r,o,`padding requires 1 to 4 values; ${o.length} values found`)];const u={type:"number"};let m=[];for(let _=0;_<o.length;_++)m=m.concat(s.validateSpec({key:`${r}[${_}]`,value:o[_],validateSpec:s.validateSpec,valueSpec:u}));return m}return sh({key:r,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const r=s.key,o=s.value,u=cn(o),m=s.styleSpec;if(u!=="array"||o.length<1||o.length%2!=0)return[new qe(r,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let x=0;x<o.length;x+=2)_=_.concat(ks({key:`${r}[${x}]`,value:o[x],valueSpec:m.layout_symbol["text-anchor"]})),_=_.concat(rl({key:`${r}[${x+1}]`,value:o[x+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:m}));return _},sprite:fh};function sl(s){const r=s.value,o=s.valueSpec,u=s.styleSpec;return s.validateSpec=sl,o.expression&&nc(Un(r))?cc(s):o.expression&&sc(Gi(r))?Jo(s):o.type&&fc[o.type]?fc[o.type](s):fi(tr({},s,{valueSpec:o.type?u[o.type]:o}))}function Rf(s){const r=s.value,o=s.key,u=mo(s);return u.length||(r.indexOf("{fontstack}")===-1&&u.push(new qe(o,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&u.push(new qe(o,r,'"glyphs" url must include a "{range}" token'))),u}function Pi(s,r=Pe){let o=[];return o=o.concat(sl({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,validateSpec:sl,objectElementValidators:{glyphs:Rf,"*":()=>[]}})),s.constants&&(o=o.concat(zf({key:"constants",value:s.constants}))),ph(o)}function ls(s){return function(r){return s({...r,validateSpec:sl})}}function ph(s){return[].concat(s).sort((r,o)=>r.line-o.line)}function Wi(s){return function(...r){return ph(s.apply(this,r))}}Pi.source=Wi(ls(il)),Pi.sprite=Wi(ls(fh)),Pi.glyphs=Wi(ls(Rf)),Pi.light=Wi(ls(uh)),Pi.sky=Wi(ls(hh)),Pi.terrain=Wi(ls(dh)),Pi.layer=Wi(ls(ch)),Pi.filter=Wi(ls(oh)),Pi.paintProperty=Wi(ls(hc)),Pi.layoutProperty=Wi(ls(lh));const go=Pi,Og=go.light,jg=go.sky,Lf=go.paintProperty,Bf=go.layoutProperty;function mh(s,r){let o=!1;if(r&&r.length)for(const u of r)s.fire(new mt(new Error(u.message))),o=!0;return o}class Qo{constructor(r,o,u){const m=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(o=x[1])+2*(u=x[2]);for(let T=0;T<this.d*this.d;T++){const M=x[3+T],D=x[3+T+1];m.push(M===D?null:x.subarray(M,D))}const b=x[3+m.length+1];this.keys=x.subarray(x[3+m.length],b),this.bboxes=x.subarray(b),this.insert=this._insertReadonly}else{this.d=o+2*u;for(let x=0;x<this.d*this.d;x++)m.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=r,this.padding=u,this.scale=o/r,this.uid=0;const _=u/o*r;this.min=-_,this.max=r+_}insert(r,o,u,m,_){this._forEachCell(o,u,m,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,o,u,m,_,x){this.cells[_].push(x)}query(r,o,u,m,_){const x=this.min,b=this.max;if(r<=x&&o<=x&&b<=u&&b<=m&&!_)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(r,o,u,m,this._queryCell,T,{},_),T}}_queryCell(r,o,u,m,_,x,b,T){const M=this.cells[_];if(M!==null){const D=this.keys,R=this.bboxes;for(let O=0;O<M.length;O++){const U=M[O];if(b[U]===void 0){const X=4*U;(T?T(R[X+0],R[X+1],R[X+2],R[X+3]):r<=R[X+2]&&o<=R[X+3]&&u>=R[X+0]&&m>=R[X+1])?(b[U]=!0,x.push(D[U])):b[U]=!1}}}}_forEachCell(r,o,u,m,_,x,b,T){const M=this._convertToCellCoord(r),D=this._convertToCellCoord(o),R=this._convertToCellCoord(u),O=this._convertToCellCoord(m);for(let U=M;U<=R;U++)for(let X=D;X<=O;X++){const Y=this.d*X+U;if((!T||T(this._convertFromCellCoord(U),this._convertFromCellCoord(X),this._convertFromCellCoord(U+1),this._convertFromCellCoord(X+1)))&&_.call(this,r,o,u,m,Y,x,b,T))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,o=3+this.cells.length+1+1;let u=0;for(let x=0;x<this.cells.length;x++)u+=this.cells[x].length;const m=new Int32Array(o+u+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let _=o;for(let x=0;x<r.length;x++){const b=r[x];m[3+x]=_,m.set(b,_),_+=b.length}return m[3+r.length]=_,m.set(this.keys,_),_+=this.keys.length,m[3+r.length+1]=_,m.set(this.bboxes,_),_+=this.bboxes.length,m.buffer}static serialize(r,o){const u=r.toArrayBuffer();return o&&o.push(u),{buffer:u}}static deserialize(r){return new Qo(r.buffer)}}const Ii={};function yt(s,r,o={}){if(Ii[s])throw new Error(`${s} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:s,writeable:!1}),Ii[s]={klass:r,omit:o.omit||[],shallow:o.shallow||[]}}yt("Object",Object),yt("TransferableGridIndex",Qo),yt("Color",gn),yt("Error",Error),yt("AJAXError",tt),yt("ResolvedImage",di),yt("StylePropertyFunction",Yo),yt("StyleExpression",ic,{omit:["_evaluator"]}),yt("ZoomDependentExpression",Ko),yt("ZoomConstantExpression",Xo),yt("CompoundExpression",Ei,{omit:["_evaluate"]});for(const s in $o)$o[s]._classRegistryKey||yt(`Expression_${s}`,$o[s]);function pc(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function gh(s){return s.$name||s.constructor._classRegistryKey}function Ff(s){return!function(r){if(r===null||typeof r!="object")return!1;const o=gh(r);return!(!o||o==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||pc(s)||$e(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function ea(s,r){if(Ff(s))return(pc(s)||$e(s))&&r&&r.push(s),ArrayBuffer.isView(s)&&r&&r.push(s.buffer),s instanceof ImageData&&r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const _=[];for(const x of s)_.push(ea(x,r));return _}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const o=gh(s);if(!o)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!Ii[o])throw new Error(`${o} is not registered.`);const{klass:u}=Ii[o],m=u.serialize?u.serialize(s,r):{};if(u.serialize){if(r&&m===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in s){if(!s.hasOwnProperty(_)||Ii[o].omit.indexOf(_)>=0)continue;const x=s[_];m[_]=Ii[o].shallow.indexOf(_)>=0?x:ea(x,r)}s instanceof Error&&(m.message=s.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(m.$name=o),m}function ta(s){if(Ff(s))return s;if(Array.isArray(s))return s.map(ta);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const r=gh(s)||"Object";if(!Ii[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:o}=Ii[r];if(!o)throw new Error(`can't deserialize unregistered class ${r}`);if(o.deserialize)return o.deserialize(s);const u=Object.create(o.prototype);for(const m of Object.keys(s)){if(m==="$name")continue;const _=s[m];u[m]=Ii[r].shallow.indexOf(m)>=0?_:ta(_)}return u}class yh{constructor(){this.first=!0}update(r,o){const u=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=u,!0))}}const nn={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function vh(s){for(const r of s)if(xh(r.charCodeAt(0)))return!0;return!1}function Vg(s){for(const r of s)if(!na(r.charCodeAt(0)))return!1;return!0}function _h(s){const r=s.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(r.join("|"),"u")}const Ug=_h(["Arab","Dupl","Mong","Ougr","Syrc"]);function na(s){return!Ug.test(String.fromCodePoint(s))}const Nf=_h(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function xh(s){return!(s!==746&&s!==747&&(s<4352||!(nn["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||nn["CJK Compatibility"](s)||nn["CJK Strokes"](s)||!(!nn["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||nn["Enclosed CJK Letters and Months"](s)||nn["Ideographic Description Characters"](s)||nn.Kanbun(s)||nn.Katakana(s)&&s!==12540||!(!nn["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!nn["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||nn["Vertical Forms"](s)||nn["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||Nf.test(String.fromCodePoint(s)))))}function Of(s){return!(xh(s)||function(r){return!!(nn["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||nn["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||nn["Letterlike Symbols"](r)||nn["Number Forms"](r)||nn["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||nn["Control Pictures"](r)&&r!==9251||nn["Optical Character Recognition"](r)||nn["Enclosed Alphanumerics"](r)||nn["Geometric Shapes"](r)||nn["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||nn["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||nn["CJK Symbols and Punctuation"](r)||nn.Katakana(r)||nn["Private Use Area"](r)||nn["CJK Compatibility Forms"](r)||nn["Small Form Variants"](r)||nn["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(s))}const $g=_h(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function bh(s){return $g.test(String.fromCodePoint(s))}function Hg(s,r){return!(!r&&bh(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||nn.Khmer(s))}function Gg(s){for(const r of s)if(bh(r.charCodeAt(0)))return!0;return!1}const pi=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Pn{constructor(r,o){this.zoom=r,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yh,this.transition={})}isSupportedScript(r){return function(o,u){for(const m of o)if(!Hg(m.charCodeAt(0),u))return!1;return!0}(r,pi.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,o=r-Math.floor(r),u=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}}}class ra{constructor(r,o){this.property=r,this.value=o,this.expression=function(u,m){if(nc(u))return new Yo(u,m);if(sc(u)){const _=nh(u,m);if(_.result==="error")throw new Error(_.value.map(x=>`${x.key}: ${x.message}`).join(", "));return _.value}{let _=u;return m.type==="color"&&typeof u=="string"?_=gn.parse(u):m.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(u)&&(_=Ci.parse(u)):_=hi.parse(u),{kind:"constant",evaluate:()=>_}}}(o===void 0?r.specification.default:o,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,o,u){return this.property.possiblyEvaluate(this,r,o,u)}}class mc{constructor(r){this.property=r,this.value=new ra(r,void 0)}transitioned(r,o){return new jf(this.property,this.value,o,le({},r.transition,this.transition),r.now)}untransitioned(){return new jf(this.property,this.value,null,{},0)}}class gc{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Ce(this._values[r].value.value)}setValue(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new mc(this._values[r].property)),this._values[r].value=new ra(this._values[r].property,o===null?void 0:Ce(o))}getTransition(r){return Ce(this._values[r].transition)}setTransition(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new mc(this._values[r].property)),this._values[r].transition=Ce(o)||void 0}serialize(){const r={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(r[o]=u);const m=this.getTransition(o);m!==void 0&&(r[`${o}-transition`]=m)}return r}transitioned(r,o){const u=new ol(this._properties);for(const m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(r,o._values[m]);return u}untransitioned(){const r=new ol(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].untransitioned();return r}}class jf{constructor(r,o,u,m,_){this.property=r,this.value=o,this.begin=_+m.delay||0,this.end=this.begin+m.duration||0,r.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(r,o,u){const m=r.now||0,_=this.value.possiblyEvaluate(r,o,u),x=this.prior;if(x){if(m>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(m<this.begin)return x.possiblyEvaluate(r,o,u);{const b=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,o,u),_,function(T){if(T<=0)return 0;if(T>=1)return 1;const M=T*T,D=M*T;return 4*(T<.5?D:3*(T-M)+D-.75)}(b))}}return _}}class ol{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,o,u){const m=new ll(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(r,o,u);return m}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class al{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Ce(this._values[r].value)}setValue(r,o){this._values[r]=new ra(this._values[r].property,o===null?void 0:Ce(o))}serialize(){const r={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(r[o]=u)}return r}possiblyEvaluate(r,o,u){const m=new ll(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(r,o,u);return m}}class cs{constructor(r,o,u){this.property=r,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,o,u,m){return this.property.evaluate(this.value,this.parameters,r,o,u,m)}}class ll{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class bt{constructor(r){this.specification=r}possiblyEvaluate(r,o){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(o)}interpolate(r,o,u){const m=Kr[this.specification.type];return m?m(r,o,u):r}}class Lt{constructor(r,o){this.specification=r,this.overrides=o}possiblyEvaluate(r,o,u,m){return new cs(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(o,null,{},u,m)}:r.expression,o)}interpolate(r,o,u){if(r.value.kind!=="constant"||o.value.kind!=="constant")return r;if(r.value.value===void 0||o.value.value===void 0)return new cs(this,{kind:"constant",value:void 0},r.parameters);const m=Kr[this.specification.type];if(m){const _=m(r.value.value,o.value.value,u);return new cs(this,{kind:"constant",value:_},r.parameters)}return r}evaluate(r,o,u,m,_,x){return r.kind==="constant"?r.value:r.evaluate(o,u,m,_,x)}}class yc extends Lt{possiblyEvaluate(r,o,u,m){if(r.value===void 0)return new cs(this,{kind:"constant",value:void 0},o);if(r.expression.kind==="constant"){const _=r.expression.evaluate(o,null,{},u,m),x=r.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,b=this._calculate(x,x,x,o);return new cs(this,{kind:"constant",value:b},o)}if(r.expression.kind==="camera"){const _=this._calculate(r.expression.evaluate({zoom:o.zoom-1}),r.expression.evaluate({zoom:o.zoom}),r.expression.evaluate({zoom:o.zoom+1}),o);return new cs(this,{kind:"constant",value:_},o)}return new cs(this,r.expression,o)}evaluate(r,o,u,m,_,x){if(r.kind==="source"){const b=r.evaluate(o,u,m,_,x);return this._calculate(b,b,b,o)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(o.zoom)-1},u,m),r.evaluate({zoom:Math.floor(o.zoom)},u,m),r.evaluate({zoom:Math.floor(o.zoom)+1},u,m),o):r.value}_calculate(r,o,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:u,to:o}}interpolate(r){return r}}class vc{constructor(r){this.specification=r}possiblyEvaluate(r,o,u,m){if(r.value!==void 0){if(r.expression.kind==="constant"){const _=r.expression.evaluate(o,null,{},u,m);return this._calculate(_,_,_,o)}return this._calculate(r.expression.evaluate(new Pn(Math.floor(o.zoom-1),o)),r.expression.evaluate(new Pn(Math.floor(o.zoom),o)),r.expression.evaluate(new Pn(Math.floor(o.zoom+1),o)),o)}}_calculate(r,o,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:u,to:o}}interpolate(r){return r}}class wh{constructor(r){this.specification=r}possiblyEvaluate(r,o,u,m){return!!r.expression.evaluate(o,null,{},u,m)}interpolate(){return!1}}class v{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in r){const u=r[o];u.specification.overridable&&this.overridableProperties.push(o);const m=this.defaultPropertyValues[o]=new ra(u,void 0),_=this.defaultTransitionablePropertyValues[o]=new mc(u);this.defaultTransitioningPropertyValues[o]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=m.possiblyEvaluate({})}}}yt("DataDrivenProperty",Lt),yt("DataConstantProperty",bt),yt("CrossFadedDataDrivenProperty",yc),yt("CrossFadedProperty",vc),yt("ColorRampProperty",wh);const n="-transition";class l extends wn{constructor(r,o){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),o.layout&&(this._unevaluatedLayout=new al(o.layout)),o.paint)){this._transitionablePaint=new gc(o.paint);for(const u in r.paint)this.setPaintProperty(u,r.paint[u],{validate:!1});for(const u in r.layout)this.setLayoutProperty(u,r.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ll(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,o,u={}){o!=null&&this._validate(Bf,`layers.${this.id}.layout.${r}`,r,o,u)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,o):this.visibility=o)}getPaintProperty(r){return r.endsWith(n)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,o,u={}){if(o!=null&&this._validate(Lf,`layers.${this.id}.paint.${r}`,r,o,u))return!1;if(r.endsWith(n))return this._transitionablePaint.setTransition(r.slice(0,-11),o||void 0),!1;{const m=this._transitionablePaint._values[r],_=m.property.specification["property-type"]==="cross-faded-data-driven",x=m.value.isDataDriven(),b=m.value;this._transitionablePaint.setValue(r,o),this._handleSpecialPaintPropertyUpdate(r);const T=this._transitionablePaint._values[r].value;return T.isDataDriven()||x||_||this._handleOverridablePaintPropertyUpdate(r,b,T)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,o,u){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,o){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,o)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Be(r,(o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length))}_validate(r,o,u,m,_={}){return(!_||_.validate!==!1)&&mh(this,r.call(go,{key:o,layerType:this.type,objectKey:u,value:m,styleSpec:Pe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const o=this.paint.get(r);if(o instanceof cs&&Wo(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const d={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class f{constructor(r,o){this._structArray=r,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class y{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,o){return r._trim(),o&&(r.isTransferred=!0,o.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const o=Object.create(this.prototype);return o.arrayBuffer=r.arrayBuffer,o.length=r.length,o.capacity=r.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function w(s,r=1){let o=0,u=0;return{members:s.map(m=>{const _=d[m.type].BYTES_PER_ELEMENT,x=o=C(o,Math.max(r,_)),b=m.components||1;return u=Math.max(u,_),o+=_*b,{name:m.name,type:m.type,components:b,offset:x}}),size:C(o,Math.max(u,r)),alignment:r}}function C(s,r){return Math.ceil(s/r)*r}class A extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o){const u=this.length;return this.resize(u+1),this.emplace(u,r,o)}emplace(r,o,u){const m=2*r;return this.int16[m+0]=o,this.int16[m+1]=u,r}}A.prototype.bytesPerElement=4,yt("StructArrayLayout2i4",A);class z extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,r,o,u)}emplace(r,o,u,m){const _=3*r;return this.int16[_+0]=o,this.int16[_+1]=u,this.int16[_+2]=m,r}}z.prototype.bytesPerElement=6,yt("StructArrayLayout3i6",z);class B extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,m){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,u,m)}emplace(r,o,u,m,_){const x=4*r;return this.int16[x+0]=o,this.int16[x+1]=u,this.int16[x+2]=m,this.int16[x+3]=_,r}}B.prototype.bytesPerElement=8,yt("StructArrayLayout4i8",B);class F extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,m,_,x)}emplace(r,o,u,m,_,x,b){const T=6*r;return this.int16[T+0]=o,this.int16[T+1]=u,this.int16[T+2]=m,this.int16[T+3]=_,this.int16[T+4]=x,this.int16[T+5]=b,r}}F.prototype.bytesPerElement=12,yt("StructArrayLayout2i4i12",F);class q extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,m,_,x)}emplace(r,o,u,m,_,x,b){const T=4*r,M=8*r;return this.int16[T+0]=o,this.int16[T+1]=u,this.uint8[M+4]=m,this.uint8[M+5]=_,this.uint8[M+6]=x,this.uint8[M+7]=b,r}}q.prototype.bytesPerElement=8,yt("StructArrayLayout2i4ub8",q);class J extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o){const u=this.length;return this.resize(u+1),this.emplace(u,r,o)}emplace(r,o,u){const m=2*r;return this.float32[m+0]=o,this.float32[m+1]=u,r}}J.prototype.bytesPerElement=8,yt("StructArrayLayout2f8",J);class ee extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x,b,T,M,D){const R=this.length;return this.resize(R+1),this.emplace(R,r,o,u,m,_,x,b,T,M,D)}emplace(r,o,u,m,_,x,b,T,M,D,R){const O=10*r;return this.uint16[O+0]=o,this.uint16[O+1]=u,this.uint16[O+2]=m,this.uint16[O+3]=_,this.uint16[O+4]=x,this.uint16[O+5]=b,this.uint16[O+6]=T,this.uint16[O+7]=M,this.uint16[O+8]=D,this.uint16[O+9]=R,r}}ee.prototype.bytesPerElement=20,yt("StructArrayLayout10ui20",ee);class ae extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x,b,T,M,D,R,O){const U=this.length;return this.resize(U+1),this.emplace(U,r,o,u,m,_,x,b,T,M,D,R,O)}emplace(r,o,u,m,_,x,b,T,M,D,R,O,U){const X=12*r;return this.int16[X+0]=o,this.int16[X+1]=u,this.int16[X+2]=m,this.int16[X+3]=_,this.uint16[X+4]=x,this.uint16[X+5]=b,this.uint16[X+6]=T,this.uint16[X+7]=M,this.int16[X+8]=D,this.int16[X+9]=R,this.int16[X+10]=O,this.int16[X+11]=U,r}}ae.prototype.bytesPerElement=24,yt("StructArrayLayout4i4ui4i24",ae);class he extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,r,o,u)}emplace(r,o,u,m){const _=3*r;return this.float32[_+0]=o,this.float32[_+1]=u,this.float32[_+2]=m,r}}he.prototype.bytesPerElement=12,yt("StructArrayLayout3f12",he);class fe extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint32[1*r+0]=o,r}}fe.prototype.bytesPerElement=4,yt("StructArrayLayout1ul4",fe);class ye extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x,b,T,M){const D=this.length;return this.resize(D+1),this.emplace(D,r,o,u,m,_,x,b,T,M)}emplace(r,o,u,m,_,x,b,T,M,D){const R=10*r,O=5*r;return this.int16[R+0]=o,this.int16[R+1]=u,this.int16[R+2]=m,this.int16[R+3]=_,this.int16[R+4]=x,this.int16[R+5]=b,this.uint32[O+3]=T,this.uint16[R+8]=M,this.uint16[R+9]=D,r}}ye.prototype.bytesPerElement=20,yt("StructArrayLayout6i1ul2ui20",ye);class se extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,m,_,x)}emplace(r,o,u,m,_,x,b){const T=6*r;return this.int16[T+0]=o,this.int16[T+1]=u,this.int16[T+2]=m,this.int16[T+3]=_,this.int16[T+4]=x,this.int16[T+5]=b,r}}se.prototype.bytesPerElement=12,yt("StructArrayLayout2i2i2i12",se);class be extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_){const x=this.length;return this.resize(x+1),this.emplace(x,r,o,u,m,_)}emplace(r,o,u,m,_,x){const b=4*r,T=8*r;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=m,this.int16[T+6]=_,this.int16[T+7]=x,r}}be.prototype.bytesPerElement=16,yt("StructArrayLayout2f1f2i16",be);class we extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,m,_,x)}emplace(r,o,u,m,_,x,b){const T=16*r,M=4*r,D=8*r;return this.uint8[T+0]=o,this.uint8[T+1]=u,this.float32[M+1]=m,this.float32[M+2]=_,this.int16[D+6]=x,this.int16[D+7]=b,r}}we.prototype.bytesPerElement=16,yt("StructArrayLayout2ub2f2i16",we);class Ee extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,r,o,u)}emplace(r,o,u,m){const _=3*r;return this.uint16[_+0]=o,this.uint16[_+1]=u,this.uint16[_+2]=m,r}}Ee.prototype.bytesPerElement=6,yt("StructArrayLayout3ui6",Ee);class je extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x,b,T,M,D,R,O,U,X,Y,oe,ue){const Te=this.length;return this.resize(Te+1),this.emplace(Te,r,o,u,m,_,x,b,T,M,D,R,O,U,X,Y,oe,ue)}emplace(r,o,u,m,_,x,b,T,M,D,R,O,U,X,Y,oe,ue,Te){const ve=24*r,Se=12*r,Re=48*r;return this.int16[ve+0]=o,this.int16[ve+1]=u,this.uint16[ve+2]=m,this.uint16[ve+3]=_,this.uint32[Se+2]=x,this.uint32[Se+3]=b,this.uint32[Se+4]=T,this.uint16[ve+10]=M,this.uint16[ve+11]=D,this.uint16[ve+12]=R,this.float32[Se+7]=O,this.float32[Se+8]=U,this.uint8[Re+36]=X,this.uint8[Re+37]=Y,this.uint8[Re+38]=oe,this.uint32[Se+10]=ue,this.int16[ve+22]=Te,r}}je.prototype.bytesPerElement=48,yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",je);class Ke extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,m,_,x,b,T,M,D,R,O,U,X,Y,oe,ue,Te,ve,Se,Re,Ge,ht,Rt,ct,ot,kt,vt){const gt=this.length;return this.resize(gt+1),this.emplace(gt,r,o,u,m,_,x,b,T,M,D,R,O,U,X,Y,oe,ue,Te,ve,Se,Re,Ge,ht,Rt,ct,ot,kt,vt)}emplace(r,o,u,m,_,x,b,T,M,D,R,O,U,X,Y,oe,ue,Te,ve,Se,Re,Ge,ht,Rt,ct,ot,kt,vt,gt){const Oe=32*r,Ct=16*r;return this.int16[Oe+0]=o,this.int16[Oe+1]=u,this.int16[Oe+2]=m,this.int16[Oe+3]=_,this.int16[Oe+4]=x,this.int16[Oe+5]=b,this.int16[Oe+6]=T,this.int16[Oe+7]=M,this.uint16[Oe+8]=D,this.uint16[Oe+9]=R,this.uint16[Oe+10]=O,this.uint16[Oe+11]=U,this.uint16[Oe+12]=X,this.uint16[Oe+13]=Y,this.uint16[Oe+14]=oe,this.uint16[Oe+15]=ue,this.uint16[Oe+16]=Te,this.uint16[Oe+17]=ve,this.uint16[Oe+18]=Se,this.uint16[Oe+19]=Re,this.uint16[Oe+20]=Ge,this.uint16[Oe+21]=ht,this.uint16[Oe+22]=Rt,this.uint32[Ct+12]=ct,this.float32[Ct+13]=ot,this.float32[Ct+14]=kt,this.uint16[Oe+30]=vt,this.uint16[Oe+31]=gt,r}}Ke.prototype.bytesPerElement=64,yt("StructArrayLayout8i15ui1ul2f2ui64",Ke);class lt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.float32[1*r+0]=o,r}}lt.prototype.bytesPerElement=4,yt("StructArrayLayout1f4",lt);class ft extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,r,o,u)}emplace(r,o,u,m){const _=3*r;return this.uint16[6*r+0]=o,this.float32[_+1]=u,this.float32[_+2]=m,r}}ft.prototype.bytesPerElement=12,yt("StructArrayLayout1ui2f12",ft);class it extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,r,o,u)}emplace(r,o,u,m){const _=4*r;return this.uint32[2*r+0]=o,this.uint16[_+2]=u,this.uint16[_+3]=m,r}}it.prototype.bytesPerElement=8,yt("StructArrayLayout1ul2ui8",it);class rt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o){const u=this.length;return this.resize(u+1),this.emplace(u,r,o)}emplace(r,o,u){const m=2*r;return this.uint16[m+0]=o,this.uint16[m+1]=u,r}}rt.prototype.bytesPerElement=4,yt("StructArrayLayout2ui4",rt);class wt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint16[1*r+0]=o,r}}wt.prototype.bytesPerElement=2,yt("StructArrayLayout1ui2",wt);class Vt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,m){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,u,m)}emplace(r,o,u,m,_){const x=4*r;return this.float32[x+0]=o,this.float32[x+1]=u,this.float32[x+2]=m,this.float32[x+3]=_,r}}Vt.prototype.bytesPerElement=16,yt("StructArrayLayout4f16",Vt);class st extends f{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new k(this.anchorPointX,this.anchorPointY)}}st.prototype.size=20;class ut extends ye{get(r){return new st(this,r)}}yt("CollisionBoxArray",ut);class Ot extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ot.prototype.size=48;class In extends je{get(r){return new Ot(this,r)}}yt("PlacedSymbolArray",In);class qt extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}qt.prototype.size=64;class tn extends Ke{get(r){return new qt(this,r)}}yt("SymbolInstanceArray",tn);class An extends lt{getoffsetX(r){return this.float32[1*r+0]}}yt("GlyphOffsetArray",An);class Mr extends z{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}yt("SymbolLineVertexArray",Mr);class qi extends f{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}qi.prototype.size=12;class Mn extends ft{get(r){return new qi(this,r)}}yt("TextAnchorOffsetArray",Mn);class Jr extends f{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Jr.prototype.size=8;class Vr extends it{get(r){return new Jr(this,r)}}yt("FeatureIndexArray",Vr);class Dr extends A{}class Ur extends A{}class us extends A{}class ia extends F{}class _c extends q{}class sa extends J{}class Ai extends ee{}class xc extends ae{}class Sh extends he{}class Mi extends fe{}class Di extends se{}class Us extends we{}class Zi extends Ee{}class wr extends rt{}const zr=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:mi}=zr;class rn{constructor(r=[]){this.segments=r}prepareSegment(r,o,u,m){let _=this.segments[this.segments.length-1];return r>rn.MAX_VERTEX_ARRAY_LENGTH&&ze(`Max vertices per segment is ${rn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!_||_.vertexLength+r>rn.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==m)&&(_={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},m!==void 0&&(_.sortKey=m),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const r of this.segments)for(const o in r.vaos)r.vaos[o].destroy()}static simpleSegment(r,o,u,m){return new rn([{vertexOffset:r,primitiveOffset:o,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function yo(s,r){return 256*(s=pe(Math.floor(s),0,255))+pe(Math.floor(r),0,255)}rn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,yt("SegmentVector",rn);const oa=w([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var aa={exports:{}},Vf={exports:{}};Vf.exports=function(s,r){var o,u,m,_,x,b,T,M;for(u=s.length-(o=3&s.length),m=r,x=3432918353,b=461845907,M=0;M<u;)T=255&s.charCodeAt(M)|(255&s.charCodeAt(++M))<<8|(255&s.charCodeAt(++M))<<16|(255&s.charCodeAt(++M))<<24,++M,m=27492+(65535&(_=5*(65535&(m=(m^=T=(65535&(T=(T=(65535&T)*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(T=0,o){case 3:T^=(255&s.charCodeAt(M+2))<<16;case 2:T^=(255&s.charCodeAt(M+1))<<8;case 1:m^=T=(65535&(T=(T=(65535&(T^=255&s.charCodeAt(M)))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295}return m^=s.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Wg=Vf.exports,Uf={exports:{}};Uf.exports=function(s,r){for(var o,u=s.length,m=r^u,_=0;u>=4;)o=1540483477*(65535&(o=255&s.charCodeAt(_)|(255&s.charCodeAt(++_))<<8|(255&s.charCodeAt(++_))<<16|(255&s.charCodeAt(++_))<<24))+((1540483477*(o>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),u-=4,++_;switch(u){case 3:m^=(255&s.charCodeAt(_+2))<<16;case 2:m^=(255&s.charCodeAt(_+1))<<8;case 1:m=1540483477*(65535&(m^=255&s.charCodeAt(_)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var $s=Wg,$f=Uf.exports;aa.exports=$s,aa.exports.murmur3=$s,aa.exports.murmur2=$f;var bc=S(aa.exports);class cl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,o,u,m){this.ids.push(wc(r)),this.positions.push(o,u,m)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=wc(r);let u=0,m=this.ids.length-1;for(;u<m;){const x=u+m>>1;this.ids[x]>=o?m=x:u=x+1}const _=[];for(;this.ids[u]===o;)_.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return _}static serialize(r,o){const u=new Float64Array(r.ids),m=new Uint32Array(r.positions);return Sc(u,m,0,u.length-1),o&&o.push(u.buffer,m.buffer),{ids:u,positions:m}}static deserialize(r){const o=new cl;return o.ids=r.ids,o.positions=r.positions,o.indexed=!0,o}}function wc(s){const r=+s;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:bc(String(s))}function Sc(s,r,o,u){for(;o<u;){const m=s[o+u>>1];let _=o-1,x=u+1;for(;;){do _++;while(s[_]<m);do x--;while(s[x]>m);if(_>=x)break;la(s,_,x),la(r,3*_,3*x),la(r,3*_+1,3*x+1),la(r,3*_+2,3*x+2)}x-o<u-x?(Sc(s,r,o,x),o=x+1):(Sc(s,r,x+1,u),u=x)}}function la(s,r,o){const u=s[r];s[r]=s[o],s[o]=u}yt("FeaturePositionMap",cl);class ul{constructor(r,o){this.gl=r.gl,this.location=o}}class Hf extends ul{constructor(r,o){super(r,o),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class ob extends ul{constructor(r,o){super(r,o),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class ab extends ul{constructor(r,o){super(r,o),this.current=gn.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const HI=new Float32Array(16);function qg(s){return[yo(255*s.r,255*s.g),yo(255*s.b,255*s.a)]}class kh{constructor(r,o,u){this.value=r,this.uniformNames=o.map(m=>`u_${m}`),this.type=u}setUniform(r,o,u){r.set(u.constantOr(this.value))}getBinding(r,o,u){return this.type==="color"?new ab(r,o):new Hf(r,o)}}class kc{constructor(r,o){this.uniformNames=o.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=r.tlbr}setUniform(r,o,u,m){const _=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&r.set(_)}getBinding(r,o,u){return u.substr(0,9)==="u_pattern"?new ob(r,o):new Hf(r,o)}}class vo{constructor(r,o,u,m){this.expression=r,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(_=>({name:`a_${_}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(r,o,u,m,_){const x=this.paintVertexArray.length,b=this.expression.evaluate(new Pn(0),o,{},m,[],_);this.paintVertexArray.resize(r),this._setPaintValue(x,r,b)}updatePaintArray(r,o,u,m){const _=this.expression.evaluate({zoom:0},u,m);this._setPaintValue(r,o,_)}_setPaintValue(r,o,u){if(this.type==="color"){const m=qg(u);for(let _=r;_<o;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=r;m<o;m++)this.paintVertexArray.emplace(m,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ts{constructor(r,o,u,m,_,x){this.expression=r,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=u,this.useIntegerZoom=m,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(r,o,u,m,_){const x=this.expression.evaluate(new Pn(this.zoom),o,{},m,[],_),b=this.expression.evaluate(new Pn(this.zoom+1),o,{},m,[],_),T=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(T,r,x,b)}updatePaintArray(r,o,u,m){const _=this.expression.evaluate({zoom:this.zoom},u,m),x=this.expression.evaluate({zoom:this.zoom+1},u,m);this._setPaintValue(r,o,_,x)}_setPaintValue(r,o,u,m){if(this.type==="color"){const _=qg(u),x=qg(m);for(let b=r;b<o;b++)this.paintVertexArray.emplace(b,_[0],_[1],x[0],x[1])}else{for(let _=r;_<o;_++)this.paintVertexArray.emplace(_,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,o){const u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,m=pe(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);r.set(m)}getBinding(r,o,u){return new Hf(r,o)}}class ca{constructor(r,o,u,m,_,x){this.expression=r,this.type=o,this.useIntegerZoom=u,this.zoom=m,this.layerId=x,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(r,o,u){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(m,r,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(r,o,u,m,_){this._setPaintValues(r,o,u.patterns&&u.patterns[this.layerId],_)}_setPaintValues(r,o,u,m){if(!m||!u)return;const{min:_,mid:x,max:b}=u,T=m[_],M=m[x],D=m[b];if(T&&M&&D)for(let R=r;R<o;R++)this.zoomInPaintVertexArray.emplace(R,M.tl[0],M.tl[1],M.br[0],M.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],M.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,M.tl[0],M.tl[1],M.br[0],M.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],M.pixelRatio,D.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,oa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,oa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class lb{constructor(r,o,u){this.binders={},this._buffers=[];const m=[];for(const _ in r.paint._values){if(!u(_))continue;const x=r.paint.get(_);if(!(x instanceof cs&&Wo(x.property.specification)))continue;const b=GI(_,r.type),T=x.value,M=x.property.specification.type,D=x.property.useIntegerZoom,R=x.property.specification["property-type"],O=R==="cross-faded"||R==="cross-faded-data-driven";if(T.kind==="constant")this.binders[_]=O?new kc(T.value,b):new kh(T.value,b,M),m.push(`/u_${_}`);else if(T.kind==="source"||O){const U=cb(_,M,"source");this.binders[_]=O?new ca(T,M,D,o,U,r.id):new vo(T,b,M,U),m.push(`/a_${_}`)}else{const U=cb(_,M,"composite");this.binders[_]=new Ts(T,b,M,D,o,U),m.push(`/z_${_}`)}}this.cacheKey=m.sort().join("")}getMaxValue(r){const o=this.binders[r];return o instanceof vo||o instanceof Ts?o.maxValue:0}populatePaintArrays(r,o,u,m,_){for(const x in this.binders){const b=this.binders[x];(b instanceof vo||b instanceof Ts||b instanceof ca)&&b.populatePaintArray(r,o,u,m,_)}}setConstantPatternPositions(r,o){for(const u in this.binders){const m=this.binders[u];m instanceof kc&&m.setConstantPatternPositions(r,o)}}updatePaintArrays(r,o,u,m,_){let x=!1;for(const b in r){const T=o.getPositions(b);for(const M of T){const D=u.feature(M.index);for(const R in this.binders){const O=this.binders[R];if((O instanceof vo||O instanceof Ts||O instanceof ca)&&O.expression.isStateDependent===!0){const U=m.paint.get(R);O.expression=U.value,O.updatePaintArray(M.start,M.end,D,r[b],_),x=!0}}}}return x}defines(){const r=[];for(const o in this.binders){const u=this.binders[o];(u instanceof kh||u instanceof kc)&&r.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return r}getBinderAttributes(){const r=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof vo||u instanceof Ts)for(let m=0;m<u.paintVertexAttributes.length;m++)r.push(u.paintVertexAttributes[m].name);else if(u instanceof ca)for(let m=0;m<oa.members.length;m++)r.push(oa.members[m].name)}return r}getBinderUniforms(){const r=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof kh||u instanceof kc||u instanceof Ts)for(const m of u.uniformNames)r.push(m)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,o){const u=[];for(const m in this.binders){const _=this.binders[m];if(_ instanceof kh||_ instanceof kc||_ instanceof Ts){for(const x of _.uniformNames)if(o[x]){const b=_.getBinding(r,o[x],x);u.push({name:x,property:m,binding:b})}}}return u}setUniforms(r,o,u,m){for(const{name:_,property:x,binding:b}of o)this.binders[x].setUniform(b,m,u.get(x),_)}updatePaintBuffers(r){this._buffers=[];for(const o in this.binders){const u=this.binders[o];if(r&&u instanceof ca){const m=r.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(u instanceof vo||u instanceof Ts)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(r){for(const o in this.binders){const u=this.binders[o];(u instanceof vo||u instanceof Ts||u instanceof ca)&&u.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const o=this.binders[r];(o instanceof vo||o instanceof Ts||o instanceof ca)&&o.destroy()}}}class hl{constructor(r,o,u=()=>!0){this.programConfigurations={};for(const m of r)this.programConfigurations[m.id]=new lb(m,o,u);this.needsUpload=!1,this._featureMap=new cl,this._bufferOffset=0}populatePaintArrays(r,o,u,m,_,x){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(r,o,m,_,x);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,o,u,m){for(const _ of u)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(r,this._featureMap,o,_,m)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function GI(s,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}function cb(s,r,o){const u={color:{source:J,composite:Vt},number:{source:lt,composite:J}},m=function(_){return{"line-pattern":{source:Ai,composite:Ai},"fill-pattern":{source:Ai,composite:Ai},"fill-extrusion-pattern":{source:Ai,composite:Ai}}[_]}(s);return m&&m[o]||u[r][o]}yt("ConstantBinder",kh),yt("CrossFadedConstantBinder",kc),yt("SourceExpressionBinder",vo),yt("CrossFadedCompositeBinder",ca),yt("CompositeExpressionBinder",Ts),yt("ProgramConfiguration",lb,{omit:["_buffers"]}),yt("ProgramConfigurationSet",hl);const ir=8192,Zg=Math.pow(2,14)-1,ub=-Zg-1;function dl(s){const r=ir/s.extent,o=s.loadGeometry();for(let u=0;u<o.length;u++){const m=o[u];for(let _=0;_<m.length;_++){const x=m[_],b=Math.round(x.x*r),T=Math.round(x.y*r);x.x=pe(b,ub,Zg),x.y=pe(T,ub,Zg),(b<x.x||b>x.x+1||T<x.y||T>x.y+1)&&ze("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function fl(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?dl(s):[]}}function Gf(s,r,o,u,m){s.emplaceBack(2*r+(u+1)/2,2*o+(m+1)/2)}class Xg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Ur,this.indexArray=new Zi,this.segments=new rn,this.programConfigurations=new hl(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,u){const m=this.layers[0],_=[];let x=null,b=!1;m.type==="circle"&&(x=m.layout.get("circle-sort-key"),b=!x.isConstant());for(const{feature:T,id:M,index:D,sourceLayerIndex:R}of r){const O=this.layers[0]._featureFilter.needGeometry,U=fl(T,O);if(!this.layers[0]._featureFilter.filter(new Pn(this.zoom),U,u))continue;const X=b?x.evaluate(U,{},u):void 0,Y={id:M,properties:T.properties,type:T.type,sourceLayerIndex:R,index:D,geometry:O?U.geometry:dl(T),patterns:{},sortKey:X};_.push(Y)}b&&_.sort((T,M)=>T.sortKey-M.sortKey);for(const T of _){const{geometry:M,index:D,sourceLayerIndex:R}=T,O=r[D].feature;this.addFeature(T,M,D,u),o.featureIndex.insert(O,M,D,R,this.index)}}update(r,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,mi),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,o,u,m){for(const _ of o)for(const x of _){const b=x.x,T=x.y;if(b<0||b>=ir||T<0||T>=ir)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),D=M.vertexLength;Gf(this.layoutVertexArray,b,T,-1,-1),Gf(this.layoutVertexArray,b,T,1,-1),Gf(this.layoutVertexArray,b,T,1,1),Gf(this.layoutVertexArray,b,T,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+3,D+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,{},m)}}function hb(s,r){for(let o=0;o<s.length;o++)if(Tc(r,s[o]))return!0;for(let o=0;o<r.length;o++)if(Tc(s,r[o]))return!0;return!!Kg(s,r)}function WI(s,r,o){return!!Tc(s,r)||!!Yg(r,s,o)}function db(s,r){if(s.length===1)return pb(r,s[0]);for(let o=0;o<r.length;o++){const u=r[o];for(let m=0;m<u.length;m++)if(Tc(s,u[m]))return!0}for(let o=0;o<s.length;o++)if(pb(r,s[o]))return!0;for(let o=0;o<r.length;o++)if(Kg(s,r[o]))return!0;return!1}function qI(s,r,o){if(s.length>1){if(Kg(s,r))return!0;for(let u=0;u<r.length;u++)if(Yg(r[u],s,o))return!0}for(let u=0;u<s.length;u++)if(Yg(s[u],r,o))return!0;return!1}function Kg(s,r){if(s.length===0||r.length===0)return!1;for(let o=0;o<s.length-1;o++){const u=s[o],m=s[o+1];for(let _=0;_<r.length-1;_++)if(ZI(u,m,r[_],r[_+1]))return!0}return!1}function ZI(s,r,o,u){return Qe(s,o,u)!==Qe(r,o,u)&&Qe(s,r,o)!==Qe(s,r,u)}function Yg(s,r,o){const u=o*o;if(r.length===1)return s.distSqr(r[0])<u;for(let m=1;m<r.length;m++)if(fb(s,r[m-1],r[m])<u)return!0;return!1}function fb(s,r,o){const u=r.distSqr(o);if(u===0)return s.distSqr(r);const m=((s.x-r.x)*(o.x-r.x)+(s.y-r.y)*(o.y-r.y))/u;return s.distSqr(m<0?r:m>1?o:o.sub(r)._mult(m)._add(r))}function pb(s,r){let o,u,m,_=!1;for(let x=0;x<s.length;x++){o=s[x];for(let b=0,T=o.length-1;b<o.length;T=b++)u=o[b],m=o[T],u.y>r.y!=m.y>r.y&&r.x<(m.x-u.x)*(r.y-u.y)/(m.y-u.y)+u.x&&(_=!_)}return _}function Tc(s,r){let o=!1;for(let u=0,m=s.length-1;u<s.length;m=u++){const _=s[u],x=s[m];_.y>r.y!=x.y>r.y&&r.x<(x.x-_.x)*(r.y-_.y)/(x.y-_.y)+_.x&&(o=!o)}return o}function XI(s,r,o){const u=o[0],m=o[2];if(s.x<u.x&&r.x<u.x||s.x>m.x&&r.x>m.x||s.y<u.y&&r.y<u.y||s.y>m.y&&r.y>m.y)return!1;const _=Qe(s,r,o[0]);return _!==Qe(s,r,o[1])||_!==Qe(s,r,o[2])||_!==Qe(s,r,o[3])}function Th(s,r,o){const u=r.paint.get(s).value;return u.kind==="constant"?u.value:o.programConfigurations.get(r.id).getMaxValue(s)}function Wf(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function qf(s,r,o,u,m){if(!r[0]&&!r[1])return s;const _=k.convert(r)._mult(m);o==="viewport"&&_._rotate(-u);const x=[];for(let b=0;b<s.length;b++)x.push(s[b].sub(_));return x}let mb,gb;yt("CircleBucket",Xg,{omit:["layers"]});var KI={get paint(){return gb=gb||new v({"circle-radius":new Lt(Pe.paint_circle["circle-radius"]),"circle-color":new Lt(Pe.paint_circle["circle-color"]),"circle-blur":new Lt(Pe.paint_circle["circle-blur"]),"circle-opacity":new Lt(Pe.paint_circle["circle-opacity"]),"circle-translate":new bt(Pe.paint_circle["circle-translate"]),"circle-translate-anchor":new bt(Pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bt(Pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bt(Pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Lt(Pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Lt(Pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Lt(Pe.paint_circle["circle-stroke-opacity"])})},get layout(){return mb=mb||new v({"circle-sort-key":new Lt(Pe.layout_circle["circle-sort-key"])})}},Qr=1e-6,Cc=typeof Float32Array<"u"?Float32Array:Array;function Jg(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function yb(s,r,o){var u=r[0],m=r[1],_=r[2],x=r[3],b=r[4],T=r[5],M=r[6],D=r[7],R=r[8],O=r[9],U=r[10],X=r[11],Y=r[12],oe=r[13],ue=r[14],Te=r[15],ve=o[0],Se=o[1],Re=o[2],Ge=o[3];return s[0]=ve*u+Se*b+Re*R+Ge*Y,s[1]=ve*m+Se*T+Re*O+Ge*oe,s[2]=ve*_+Se*M+Re*U+Ge*ue,s[3]=ve*x+Se*D+Re*X+Ge*Te,s[4]=(ve=o[4])*u+(Se=o[5])*b+(Re=o[6])*R+(Ge=o[7])*Y,s[5]=ve*m+Se*T+Re*O+Ge*oe,s[6]=ve*_+Se*M+Re*U+Ge*ue,s[7]=ve*x+Se*D+Re*X+Ge*Te,s[8]=(ve=o[8])*u+(Se=o[9])*b+(Re=o[10])*R+(Ge=o[11])*Y,s[9]=ve*m+Se*T+Re*O+Ge*oe,s[10]=ve*_+Se*M+Re*U+Ge*ue,s[11]=ve*x+Se*D+Re*X+Ge*Te,s[12]=(ve=o[12])*u+(Se=o[13])*b+(Re=o[14])*R+(Ge=o[15])*Y,s[13]=ve*m+Se*T+Re*O+Ge*oe,s[14]=ve*_+Se*M+Re*U+Ge*ue,s[15]=ve*x+Se*D+Re*X+Ge*Te,s}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var Ch,YI=yb;function Zf(s,r,o){var u=r[0],m=r[1],_=r[2],x=r[3];return s[0]=o[0]*u+o[4]*m+o[8]*_+o[12]*x,s[1]=o[1]*u+o[5]*m+o[9]*_+o[13]*x,s[2]=o[2]*u+o[6]*m+o[10]*_+o[14]*x,s[3]=o[3]*u+o[7]*m+o[11]*_+o[15]*x,s}Ch=new Cc(4),Cc!=Float32Array&&(Ch[0]=0,Ch[1]=0,Ch[2]=0,Ch[3]=0);class JI extends l{constructor(r){super(r,KI)}createBucket(r){return new Xg(r)}queryRadius(r){const o=r;return Th("circle-radius",this,o)+Th("circle-stroke-width",this,o)+Wf(this.paint.get("circle-translate"))}queryIntersectsFeature(r,o,u,m,_,x,b,T){const M=qf(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,b),D=this.paint.get("circle-radius").evaluate(o,u)+this.paint.get("circle-stroke-width").evaluate(o,u),R=this.paint.get("circle-pitch-alignment")==="map",O=R?M:function(X,Y){return X.map(oe=>vb(oe,Y))}(M,T),U=R?D*b:D;for(const X of m)for(const Y of X){const oe=R?Y:vb(Y,T);let ue=U;const Te=Zf([],[Y.x,Y.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ue*=Te[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ue*=x.cameraToCenterDistance/Te[3]),WI(O,oe,ue))return!0}return!1}}function vb(s,r){const o=Zf([],[s.x,s.y,0,1],r);return new k(o[0]/o[3],o[1]/o[3])}class _b extends Xg{}let xb;yt("HeatmapBucket",_b,{omit:["layers"]});var QI={get paint(){return xb=xb||new v({"heatmap-radius":new Lt(Pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Lt(Pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bt(Pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wh(Pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bt(Pe.paint_heatmap["heatmap-opacity"])})}};function Qg(s,{width:r,height:o},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==r*o*u)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${r*o*u}`)}else m=new Uint8Array(r*o*u);return s.width=r,s.height=o,s.data=m,s}function bb(s,{width:r,height:o},u){if(r===s.width&&o===s.height)return;const m=Qg({},{width:r,height:o},u);ey(s,m,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,r),height:Math.min(s.height,o)},u),s.width=r,s.height=o,s.data=m.data}function ey(s,r,o,u,m,_){if(m.width===0||m.height===0)return r;if(m.width>s.width||m.height>s.height||o.x>s.width-m.width||o.y>s.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>r.width||m.height>r.height||u.x>r.width-m.width||u.y>r.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,b=r.data;if(x===b)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<m.height;T++){const M=((o.y+T)*s.width+o.x)*_,D=((u.y+T)*r.width+u.x)*_;for(let R=0;R<m.width*_;R++)b[D+R]=x[M+R]}return r}class Eh{constructor(r,o){Qg(this,r,1,o)}resize(r){bb(this,r,1)}clone(){return new Eh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,u,m,_){ey(r,o,u,m,_,1)}}class Xi{constructor(r,o){Qg(this,r,4,o)}resize(r){bb(this,r,4)}replace(r,o){o?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Xi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,u,m,_){ey(r,o,u,m,_,4)}}function wb(s){const r={},o=s.resolution||256,u=s.clips?s.clips.length:1,m=s.image||new Xi({width:o,height:u});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const _=(x,b,T)=>{r[s.evaluationKey]=T;const M=s.expression.evaluate(r);m.data[x+b+0]=Math.floor(255*M.r/M.a),m.data[x+b+1]=Math.floor(255*M.g/M.a),m.data[x+b+2]=Math.floor(255*M.b/M.a),m.data[x+b+3]=Math.floor(255*M.a)};if(s.clips)for(let x=0,b=0;x<u;++x,b+=4*o)for(let T=0,M=0;T<o;T++,M+=4){const D=T/(o-1),{start:R,end:O}=s.clips[x];_(b,M,R*(1-D)+O*D)}else for(let x=0,b=0;x<o;x++,b+=4)_(0,b,x/(o-1));return m}yt("AlphaImage",Eh),yt("RGBAImage",Xi);const ty="big-fb";class eA extends l{createBucket(r){return new _b(r)}constructor(r){super(r,QI),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=wb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ty)&&this.heatmapFbos.delete(ty)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Sb;var tA={get paint(){return Sb=Sb||new v({"hillshade-illumination-direction":new bt(Pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bt(Pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bt(Pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bt(Pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bt(Pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bt(Pe.paint_hillshade["hillshade-accent-color"])})}};class nA extends l{constructor(r){super(r,tA)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const rA=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:iA}=rA;function kb(s,r,o=2){const u=r&&r.length,m=u?r[0]*o:s.length;let _=Tb(s,0,m,o,!0);const x=[];if(!_||_.next===_.prev)return x;let b,T,M;if(u&&(_=function(D,R,O,U){const X=[];for(let Y=0,oe=R.length;Y<oe;Y++){const ue=Tb(D,R[Y]*U,Y<oe-1?R[Y+1]*U:D.length,U,!1);ue===ue.next&&(ue.steiner=!0),X.push(dA(ue))}X.sort(cA);for(let Y=0;Y<X.length;Y++)O=uA(X[Y],O);return O}(s,r,_,o)),s.length>80*o){b=1/0,T=1/0;let D=-1/0,R=-1/0;for(let O=o;O<m;O+=o){const U=s[O],X=s[O+1];U<b&&(b=U),X<T&&(T=X),U>D&&(D=U),X>R&&(R=X)}M=Math.max(D-b,R-T),M=M!==0?32767/M:0}return Ph(_,x,o,b,T,M,0),x}function Tb(s,r,o,u,m){let _;if(m===function(x,b,T,M){let D=0;for(let R=b,O=T-M;R<T;R+=M)D+=(x[O]-x[R])*(x[R+1]+x[O+1]),O=R;return D}(s,r,o,u)>0)for(let x=r;x<o;x+=u)_=Pb(x/u|0,s[x],s[x+1],_);else for(let x=o-u;x>=r;x-=u)_=Pb(x/u|0,s[x],s[x+1],_);return _&&Xf(_,_.next)&&(Ah(_),_=_.next),_}function pl(s,r){if(!s)return s;r||(r=s);let o,u=s;do if(o=!1,u.steiner||!Xf(u,u.next)&&qn(u.prev,u,u.next)!==0)u=u.next;else{if(Ah(u),u=r=u.prev,u===u.next)break;o=!0}while(o||u!==r);return r}function Ph(s,r,o,u,m,_,x){if(!s)return;!x&&_&&function(T,M,D,R){let O=T;do O.z===0&&(O.z=ny(O.x,O.y,M,D,R)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==T);O.prevZ.nextZ=null,O.prevZ=null,function(U){let X,Y=1;do{let oe,ue=U;U=null;let Te=null;for(X=0;ue;){X++;let ve=ue,Se=0;for(let Ge=0;Ge<Y&&(Se++,ve=ve.nextZ,ve);Ge++);let Re=Y;for(;Se>0||Re>0&&ve;)Se!==0&&(Re===0||!ve||ue.z<=ve.z)?(oe=ue,ue=ue.nextZ,Se--):(oe=ve,ve=ve.nextZ,Re--),Te?Te.nextZ=oe:U=oe,oe.prevZ=Te,Te=oe;ue=ve}Te.nextZ=null,Y*=2}while(X>1)}(O)}(s,u,m,_);let b=s;for(;s.prev!==s.next;){const T=s.prev,M=s.next;if(_?oA(s,u,m,_):sA(s))r.push(T.i,s.i,M.i),Ah(s),s=M.next,b=M.next;else if((s=M)===b){x?x===1?Ph(s=aA(pl(s),r),r,o,u,m,_,2):x===2&&lA(s,r,o,u,m,_):Ph(pl(s),r,o,u,m,_,1);break}}}function sA(s){const r=s.prev,o=s,u=s.next;if(qn(r,o,u)>=0)return!1;const m=r.x,_=o.x,x=u.x,b=r.y,T=o.y,M=u.y,D=m<_?m<x?m:x:_<x?_:x,R=b<T?b<M?b:M:T<M?T:M,O=m>_?m>x?m:x:_>x?_:x,U=b>T?b>M?b:M:T>M?T:M;let X=u.next;for(;X!==r;){if(X.x>=D&&X.x<=O&&X.y>=R&&X.y<=U&&Ec(m,b,_,T,x,M,X.x,X.y)&&qn(X.prev,X,X.next)>=0)return!1;X=X.next}return!0}function oA(s,r,o,u){const m=s.prev,_=s,x=s.next;if(qn(m,_,x)>=0)return!1;const b=m.x,T=_.x,M=x.x,D=m.y,R=_.y,O=x.y,U=b<T?b<M?b:M:T<M?T:M,X=D<R?D<O?D:O:R<O?R:O,Y=b>T?b>M?b:M:T>M?T:M,oe=D>R?D>O?D:O:R>O?R:O,ue=ny(U,X,r,o,u),Te=ny(Y,oe,r,o,u);let ve=s.prevZ,Se=s.nextZ;for(;ve&&ve.z>=ue&&Se&&Se.z<=Te;){if(ve.x>=U&&ve.x<=Y&&ve.y>=X&&ve.y<=oe&&ve!==m&&ve!==x&&Ec(b,D,T,R,M,O,ve.x,ve.y)&&qn(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Se.x>=U&&Se.x<=Y&&Se.y>=X&&Se.y<=oe&&Se!==m&&Se!==x&&Ec(b,D,T,R,M,O,Se.x,Se.y)&&qn(Se.prev,Se,Se.next)>=0))return!1;Se=Se.nextZ}for(;ve&&ve.z>=ue;){if(ve.x>=U&&ve.x<=Y&&ve.y>=X&&ve.y<=oe&&ve!==m&&ve!==x&&Ec(b,D,T,R,M,O,ve.x,ve.y)&&qn(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Se&&Se.z<=Te;){if(Se.x>=U&&Se.x<=Y&&Se.y>=X&&Se.y<=oe&&Se!==m&&Se!==x&&Ec(b,D,T,R,M,O,Se.x,Se.y)&&qn(Se.prev,Se,Se.next)>=0)return!1;Se=Se.nextZ}return!0}function aA(s,r){let o=s;do{const u=o.prev,m=o.next.next;!Xf(u,m)&&Cb(u,o,o.next,m)&&Ih(u,m)&&Ih(m,u)&&(r.push(u.i,o.i,m.i),Ah(o),Ah(o.next),o=s=m),o=o.next}while(o!==s);return pl(o)}function lA(s,r,o,u,m,_){let x=s;do{let b=x.next.next;for(;b!==x.prev;){if(x.i!==b.i&&fA(x,b)){let T=Eb(x,b);return x=pl(x,x.next),T=pl(T,T.next),Ph(x,r,o,u,m,_,0),void Ph(T,r,o,u,m,_,0)}b=b.next}x=x.next}while(x!==s)}function cA(s,r){return s.x-r.x}function uA(s,r){const o=function(m,_){let x=_;const b=m.x,T=m.y;let M,D=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){const Y=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(Y<=b&&Y>D&&(D=Y,M=x.x<x.next.x?x:x.next,Y===b))return M}x=x.next}while(x!==_);if(!M)return null;const R=M,O=M.x,U=M.y;let X=1/0;x=M;do{if(b>=x.x&&x.x>=O&&b!==x.x&&Ec(T<U?b:D,T,O,U,T<U?D:b,T,x.x,x.y)){const Y=Math.abs(T-x.y)/(b-x.x);Ih(x,m)&&(Y<X||Y===X&&(x.x>M.x||x.x===M.x&&hA(M,x)))&&(M=x,X=Y)}x=x.next}while(x!==R);return M}(s,r);if(!o)return r;const u=Eb(o,s);return pl(u,u.next),pl(o,o.next)}function hA(s,r){return qn(s.prev,s,r.prev)<0&&qn(r.next,s,s.next)<0}function ny(s,r,o,u,m){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-u)*m|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function dA(s){let r=s,o=s;do(r.x<o.x||r.x===o.x&&r.y<o.y)&&(o=r),r=r.next;while(r!==s);return o}function Ec(s,r,o,u,m,_,x,b){return(m-x)*(r-b)>=(s-x)*(_-b)&&(s-x)*(u-b)>=(o-x)*(r-b)&&(o-x)*(_-b)>=(m-x)*(u-b)}function fA(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!function(o,u){let m=o;do{if(m.i!==o.i&&m.next.i!==o.i&&m.i!==u.i&&m.next.i!==u.i&&Cb(m,m.next,o,u))return!0;m=m.next}while(m!==o);return!1}(s,r)&&(Ih(s,r)&&Ih(r,s)&&function(o,u){let m=o,_=!1;const x=(o.x+u.x)/2,b=(o.y+u.y)/2;do m.y>b!=m.next.y>b&&m.next.y!==m.y&&x<(m.next.x-m.x)*(b-m.y)/(m.next.y-m.y)+m.x&&(_=!_),m=m.next;while(m!==o);return _}(s,r)&&(qn(s.prev,s,r.prev)||qn(s,r.prev,r))||Xf(s,r)&&qn(s.prev,s,s.next)>0&&qn(r.prev,r,r.next)>0)}function qn(s,r,o){return(r.y-s.y)*(o.x-r.x)-(r.x-s.x)*(o.y-r.y)}function Xf(s,r){return s.x===r.x&&s.y===r.y}function Cb(s,r,o,u){const m=Yf(qn(s,r,o)),_=Yf(qn(s,r,u)),x=Yf(qn(o,u,s)),b=Yf(qn(o,u,r));return m!==_&&x!==b||!(m!==0||!Kf(s,o,r))||!(_!==0||!Kf(s,u,r))||!(x!==0||!Kf(o,s,u))||!(b!==0||!Kf(o,r,u))}function Kf(s,r,o){return r.x<=Math.max(s.x,o.x)&&r.x>=Math.min(s.x,o.x)&&r.y<=Math.max(s.y,o.y)&&r.y>=Math.min(s.y,o.y)}function Yf(s){return s>0?1:s<0?-1:0}function Ih(s,r){return qn(s.prev,s,s.next)<0?qn(s,r,s.next)>=0&&qn(s,s.prev,r)>=0:qn(s,r,s.prev)<0||qn(s,s.next,r)<0}function Eb(s,r){const o=ry(s.i,s.x,s.y),u=ry(r.i,r.x,r.y),m=s.next,_=r.prev;return s.next=r,r.prev=s,o.next=m,m.prev=o,u.next=o,o.prev=u,_.next=u,u.prev=_,u}function Pb(s,r,o,u){const m=ry(s,r,o);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function Ah(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function ry(s,r,o){return{i:s,x:r,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function iy(s,r,o){const u=o.patternDependencies;let m=!1;for(const _ of r){const x=_.paint.get(`${s}-pattern`);x.isConstant()||(m=!0);const b=x.constantOr(null);b&&(m=!0,u[b.to]=!0,u[b.from]=!0)}return m}function sy(s,r,o,u,m){const _=m.patternDependencies;for(const x of r){const b=x.paint.get(`${s}-pattern`).value;if(b.kind!=="constant"){let T=b.evaluate({zoom:u-1},o,{},m.availableImages),M=b.evaluate({zoom:u},o,{},m.availableImages),D=b.evaluate({zoom:u+1},o,{},m.availableImages);T=T&&T.name?T.name:T,M=M&&M.name?M.name:M,D=D&&D.name?D.name:D,_[T]=!0,_[M]=!0,_[D]=!0,o.patterns[x.id]={min:T,mid:M,max:D}}}return o}class oy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new us,this.indexArray=new Zi,this.indexArray2=new wr,this.programConfigurations=new hl(r.layers,r.zoom),this.segments=new rn,this.segments2=new rn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,u){this.hasPattern=iy("fill",this.layers,o);const m=this.layers[0].layout.get("fill-sort-key"),_=!m.isConstant(),x=[];for(const{feature:b,id:T,index:M,sourceLayerIndex:D}of r){const R=this.layers[0]._featureFilter.needGeometry,O=fl(b,R);if(!this.layers[0]._featureFilter.filter(new Pn(this.zoom),O,u))continue;const U=_?m.evaluate(O,{},u,o.availableImages):void 0,X={id:T,properties:b.properties,type:b.type,sourceLayerIndex:D,index:M,geometry:R?O.geometry:dl(b),patterns:{},sortKey:U};x.push(X)}_&&x.sort((b,T)=>b.sortKey-T.sortKey);for(const b of x){const{geometry:T,index:M,sourceLayerIndex:D}=b;if(this.hasPattern){const R=sy("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(R)}else this.addFeature(b,T,M,u,{});o.featureIndex.insert(r[M].feature,T,M,D,this.index)}}update(r,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,u)}addFeatures(r,o,u){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,iA),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,o,u,m,_){for(const x of Yl(o,500)){let b=0;for(const U of x)b+=U.length;const T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),M=T.vertexLength,D=[],R=[];for(const U of x){if(U.length===0)continue;U!==x[0]&&R.push(D.length/2);const X=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),Y=X.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(Y+U.length-1,Y),D.push(U[0].x),D.push(U[0].y);for(let oe=1;oe<U.length;oe++)this.layoutVertexArray.emplaceBack(U[oe].x,U[oe].y),this.indexArray2.emplaceBack(Y+oe-1,Y+oe),D.push(U[oe].x),D.push(U[oe].y);X.vertexLength+=U.length,X.primitiveLength+=U.length}const O=kb(D,R);for(let U=0;U<O.length;U+=3)this.indexArray.emplaceBack(M+O[U],M+O[U+1],M+O[U+2]);T.vertexLength+=b,T.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,_,m)}}let Ib,Ab;yt("FillBucket",oy,{omit:["layers","patternFeatures"]});var pA={get paint(){return Ab=Ab||new v({"fill-antialias":new bt(Pe.paint_fill["fill-antialias"]),"fill-opacity":new Lt(Pe.paint_fill["fill-opacity"]),"fill-color":new Lt(Pe.paint_fill["fill-color"]),"fill-outline-color":new Lt(Pe.paint_fill["fill-outline-color"]),"fill-translate":new bt(Pe.paint_fill["fill-translate"]),"fill-translate-anchor":new bt(Pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new yc(Pe.paint_fill["fill-pattern"])})},get layout(){return Ib=Ib||new v({"fill-sort-key":new Lt(Pe.layout_fill["fill-sort-key"])})}};class mA extends l{constructor(r){super(r,pA)}recalculate(r,o){super.recalculate(r,o);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new oy(r)}queryRadius(){return Wf(this.paint.get("fill-translate"))}queryIntersectsFeature(r,o,u,m,_,x,b){return db(qf(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,b),m)}isTileClipped(){return!0}}const gA=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),yA=w([{name:"a_centroid",components:2,type:"Int16"}],4),{members:vA}=gA;var ua={},_A=E,Mb=Pc;function Pc(s,r,o,u,m){this.properties={},this.extent=o,this.type=0,this._pbf=s,this._geometry=-1,this._keys=u,this._values=m,s.readFields(xA,this,r)}function xA(s,r,o){s==1?r.id=o.readVarint():s==2?function(u,m){for(var _=u.readVarint()+u.pos;u.pos<_;){var x=m._keys[u.readVarint()],b=m._values[u.readVarint()];m.properties[x]=b}}(o,r):s==3?r.type=o.readVarint():s==4&&(r._geometry=o.pos)}function bA(s){for(var r,o,u=0,m=0,_=s.length,x=_-1;m<_;x=m++)u+=((o=s[x]).x-(r=s[m]).x)*(r.y+o.y);return u}Pc.types=["Unknown","Point","LineString","Polygon"],Pc.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,o=s.readVarint()+s.pos,u=1,m=0,_=0,x=0,b=[];s.pos<o;){if(m<=0){var T=s.readVarint();u=7&T,m=T>>3}if(m--,u===1||u===2)_+=s.readSVarint(),x+=s.readSVarint(),u===1&&(r&&b.push(r),r=[]),r.push(new _A(_,x));else{if(u!==7)throw new Error("unknown command "+u);r&&r.push(r[0].clone())}}return r&&b.push(r),b},Pc.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,o=1,u=0,m=0,_=0,x=1/0,b=-1/0,T=1/0,M=-1/0;s.pos<r;){if(u<=0){var D=s.readVarint();o=7&D,u=D>>3}if(u--,o===1||o===2)(m+=s.readSVarint())<x&&(x=m),m>b&&(b=m),(_+=s.readSVarint())<T&&(T=_),_>M&&(M=_);else if(o!==7)throw new Error("unknown command "+o)}return[x,T,b,M]},Pc.prototype.toGeoJSON=function(s,r,o){var u,m,_=this.extent*Math.pow(2,o),x=this.extent*s,b=this.extent*r,T=this.loadGeometry(),M=Pc.types[this.type];function D(U){for(var X=0;X<U.length;X++){var Y=U[X];U[X]=[360*(Y.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(Y.y+b)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(u=0;u<T.length;u++)R[u]=T[u][0];D(T=R);break;case 2:for(u=0;u<T.length;u++)D(T[u]);break;case 3:for(T=function(U){var X=U.length;if(X<=1)return[U];for(var Y,oe,ue=[],Te=0;Te<X;Te++){var ve=bA(U[Te]);ve!==0&&(oe===void 0&&(oe=ve<0),oe===ve<0?(Y&&ue.push(Y),Y=[U[Te]]):Y.push(U[Te]))}return Y&&ue.push(Y),ue}(T),u=0;u<T.length;u++)for(m=0;m<T[u].length;m++)D(T[u][m])}T.length===1?T=T[0]:M="Multi"+M;var O={type:"Feature",geometry:{type:M,coordinates:T},properties:this.properties};return"id"in this&&(O.id=this.id),O};var wA=Mb,Db=zb;function zb(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(SA,this,r),this.length=this._features.length}function SA(s,r,o){s===15?r.version=o.readVarint():s===1?r.name=o.readString():s===5?r.extent=o.readVarint():s===2?r._features.push(o.pos):s===3?r._keys.push(o.readString()):s===4&&r._values.push(function(u){for(var m=null,_=u.readVarint()+u.pos;u.pos<_;){var x=u.readVarint()>>3;m=x===1?u.readString():x===2?u.readFloat():x===3?u.readDouble():x===4?u.readVarint64():x===5?u.readVarint():x===6?u.readSVarint():x===7?u.readBoolean():null}return m}(o))}zb.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new wA(this._pbf,r,this.extent,this._keys,this._values)};var kA=Db;function TA(s,r,o){if(s===3){var u=new kA(o,o.readVarint()+o.pos);u.length&&(r[u.name]=u)}}ua.VectorTile=function(s,r){this.layers=s.readFields(TA,{},r)},ua.VectorTileFeature=Mb,ua.VectorTileLayer=Db;const CA=ua.VectorTileFeature.types,ay=Math.pow(2,13);function Mh(s,r,o,u,m,_,x,b){s.emplaceBack(r,o,2*Math.floor(u*ay)+x,m*ay*2,_*ay*2,Math.round(b))}class ly{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new ia,this.centroidVertexArray=new Dr,this.indexArray=new Zi,this.programConfigurations=new hl(r.layers,r.zoom),this.segments=new rn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,u){this.features=[],this.hasPattern=iy("fill-extrusion",this.layers,o);for(const{feature:m,id:_,index:x,sourceLayerIndex:b}of r){const T=this.layers[0]._featureFilter.needGeometry,M=fl(m,T);if(!this.layers[0]._featureFilter.filter(new Pn(this.zoom),M,u))continue;const D={id:_,sourceLayerIndex:b,index:x,geometry:T?M.geometry:dl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(sy("fill-extrusion",this.layers,D,this.zoom,o)):this.addFeature(D,D.geometry,x,u,{}),o.featureIndex.insert(m,D.geometry,x,b,this.index,!0)}}addFeatures(r,o,u){for(const m of this.features){const{geometry:_}=m;this.addFeature(m,_,m.index,o,u)}}update(r,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,vA),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,yA.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,o,u,m,_){for(const x of Yl(o,500)){const b={x:0,y:0,vertexCount:0};let T=0;for(const X of x)T+=X.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const X of x){if(X.length===0||PA(X))continue;let Y=0;for(let oe=0;oe<X.length;oe++){const ue=X[oe];if(oe>=1){const Te=X[oe-1];if(!EA(ue,Te)){M.vertexLength+4>rn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ve=ue.sub(Te)._perp()._unit(),Se=Te.dist(ue);Y+Se>32768&&(Y=0),Mh(this.layoutVertexArray,ue.x,ue.y,ve.x,ve.y,0,0,Y),Mh(this.layoutVertexArray,ue.x,ue.y,ve.x,ve.y,0,1,Y),b.x+=2*ue.x,b.y+=2*ue.y,b.vertexCount+=2,Y+=Se,Mh(this.layoutVertexArray,Te.x,Te.y,ve.x,ve.y,0,0,Y),Mh(this.layoutVertexArray,Te.x,Te.y,ve.x,ve.y,0,1,Y),b.x+=2*Te.x,b.y+=2*Te.y,b.vertexCount+=2;const Re=M.vertexLength;this.indexArray.emplaceBack(Re,Re+2,Re+1),this.indexArray.emplaceBack(Re+1,Re+2,Re+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+T>rn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),CA[r.type]!=="Polygon")continue;const D=[],R=[],O=M.vertexLength;for(const X of x)if(X.length!==0){X!==x[0]&&R.push(D.length/2);for(let Y=0;Y<X.length;Y++){const oe=X[Y];Mh(this.layoutVertexArray,oe.x,oe.y,0,0,1,1,0),b.x+=oe.x,b.y+=oe.y,b.vertexCount+=1,D.push(oe.x),D.push(oe.y)}}const U=kb(D,R);for(let X=0;X<U.length;X+=3)this.indexArray.emplaceBack(O+U[X],O+U[X+2],O+U[X+1]);M.primitiveLength+=U.length/3,M.vertexLength+=T;for(let X=0;X<b.vertexCount;X++){const Y=Math.floor(b.x/b.vertexCount),oe=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(Y,oe)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,_,m)}}function EA(s,r){return s.x===r.x&&(s.x<0||s.x>ir)||s.y===r.y&&(s.y<0||s.y>ir)}function PA(s){return s.every(r=>r.x<0)||s.every(r=>r.x>ir)||s.every(r=>r.y<0)||s.every(r=>r.y>ir)}let Rb;yt("FillExtrusionBucket",ly,{omit:["layers","features"]});var IA={get paint(){return Rb=Rb||new v({"fill-extrusion-opacity":new bt(Pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Lt(Pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bt(Pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bt(Pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yc(Pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Lt(Pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Lt(Pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bt(Pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class AA extends l{constructor(r){super(r,IA)}createBucket(r){return new ly(r)}queryRadius(){return Wf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,o,u,m,_,x,b,T){const M=qf(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,b),D=this.paint.get("fill-extrusion-height").evaluate(o,u),R=this.paint.get("fill-extrusion-base").evaluate(o,u),O=function(X,Y,oe,ue){const Te=[];for(const ve of X){const Se=[ve.x,ve.y,0,1];Zf(Se,Se,Y),Te.push(new k(Se[0]/Se[3],Se[1]/Se[3]))}return Te}(M,T),U=function(X,Y,oe,ue){const Te=[],ve=[],Se=ue[8]*Y,Re=ue[9]*Y,Ge=ue[10]*Y,ht=ue[11]*Y,Rt=ue[8]*oe,ct=ue[9]*oe,ot=ue[10]*oe,kt=ue[11]*oe;for(const vt of X){const gt=[],Oe=[];for(const Ct of vt){const St=Ct.x,jt=Ct.y,bn=ue[0]*St+ue[4]*jt+ue[12],_n=ue[1]*St+ue[5]*jt+ue[13],pr=ue[2]*St+ue[6]*jt+ue[14],hs=ue[3]*St+ue[7]*jt+ue[15],Lr=pr+Ge,mr=hs+ht,ei=bn+Rt,ti=_n+ct,ni=pr+ot,$n=hs+kt,gr=new k((bn+Se)/mr,(_n+Re)/mr);gr.z=Lr/mr,gt.push(gr);const $r=new k(ei/$n,ti/$n);$r.z=ni/$n,Oe.push($r)}Te.push(gt),ve.push(Oe)}return[Te,ve]}(m,R,D,T);return function(X,Y,oe){let ue=1/0;db(oe,Y)&&(ue=Lb(oe,Y[0]));for(let Te=0;Te<Y.length;Te++){const ve=Y[Te],Se=X[Te];for(let Re=0;Re<ve.length-1;Re++){const Ge=ve[Re],ht=[Ge,ve[Re+1],Se[Re+1],Se[Re],Ge];hb(oe,ht)&&(ue=Math.min(ue,Lb(oe,ht)))}}return ue!==1/0&&ue}(U[0],U[1],O)}}function Dh(s,r){return s.x*r.x+s.y*r.y}function Lb(s,r){if(s.length===1){let o=0;const u=r[o++];let m;for(;!m||u.equals(m);)if(m=r[o++],!m)return 1/0;for(;o<r.length;o++){const _=r[o],x=s[0],b=m.sub(u),T=_.sub(u),M=x.sub(u),D=Dh(b,b),R=Dh(b,T),O=Dh(T,T),U=Dh(M,b),X=Dh(M,T),Y=D*O-R*R,oe=(O*U-R*X)/Y,ue=(D*X-R*U)/Y,Te=u.z*(1-oe-ue)+m.z*oe+_.z*ue;if(isFinite(Te))return Te}return 1/0}{let o=1/0;for(const u of r)o=Math.min(o,u.z);return o}}const MA=w([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:DA}=MA,zA=w([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:RA}=zA,LA=ua.VectorTileFeature.types,BA=Math.cos(Math.PI/180*37.5),Bb=Math.pow(2,14)/.5;class cy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new _c,this.layoutVertexArray2=new sa,this.indexArray=new Zi,this.programConfigurations=new hl(r.layers,r.zoom),this.segments=new rn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,u){this.hasPattern=iy("line",this.layers,o);const m=this.layers[0].layout.get("line-sort-key"),_=!m.isConstant(),x=[];for(const{feature:b,id:T,index:M,sourceLayerIndex:D}of r){const R=this.layers[0]._featureFilter.needGeometry,O=fl(b,R);if(!this.layers[0]._featureFilter.filter(new Pn(this.zoom),O,u))continue;const U=_?m.evaluate(O,{},u):void 0,X={id:T,properties:b.properties,type:b.type,sourceLayerIndex:D,index:M,geometry:R?O.geometry:dl(b),patterns:{},sortKey:U};x.push(X)}_&&x.sort((b,T)=>b.sortKey-T.sortKey);for(const b of x){const{geometry:T,index:M,sourceLayerIndex:D}=b;if(this.hasPattern){const R=sy("line",this.layers,b,this.zoom,o);this.patternFeatures.push(R)}else this.addFeature(b,T,M,u,{});o.featureIndex.insert(r[M].feature,T,M,D,this.index)}}update(r,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,u)}addFeatures(r,o,u){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,RA)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,DA),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,o,u,m,_){const x=this.layers[0].layout,b=x.get("line-join").evaluate(r,{}),T=x.get("line-cap"),M=x.get("line-miter-limit"),D=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const R of o)this.addLine(R,r,b,T,M,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,_,m)}addLine(r,o,u,m,_,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<r.length-1;ue++)this.totalDistance+=r[ue].dist(r[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=LA[o.type]==="Polygon";let T=r.length;for(;T>=2&&r[T-1].equals(r[T-2]);)T--;let M=0;for(;M<T-1&&r[M].equals(r[M+1]);)M++;if(T<(b?3:2))return;u==="bevel"&&(_=1.05);const D=this.overscaling<=16?15*ir/(512*this.overscaling):0,R=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let O,U,X,Y,oe;this.e1=this.e2=-1,b&&(O=r[T-2],oe=r[M].sub(O)._unit()._perp());for(let ue=M;ue<T;ue++){if(X=ue===T-1?b?r[M+1]:void 0:r[ue+1],X&&r[ue].equals(X))continue;oe&&(Y=oe),O&&(U=O),O=r[ue],oe=X?X.sub(O)._unit()._perp():Y,Y=Y||oe;let Te=Y.add(oe);Te.x===0&&Te.y===0||Te._unit();const ve=Y.x*oe.x+Y.y*oe.y,Se=Te.x*oe.x+Te.y*oe.y,Re=Se!==0?1/Se:1/0,Ge=2*Math.sqrt(2-2*Se),ht=Se<BA&&U&&X,Rt=Y.x*oe.y-Y.y*oe.x>0;if(ht&&ue>M){const kt=O.dist(U);if(kt>2*D){const vt=O.sub(O.sub(U)._mult(D/kt)._round());this.updateDistance(U,vt),this.addCurrentVertex(vt,Y,0,0,R),U=vt}}const ct=U&&X;let ot=ct?u:b?"butt":m;if(ct&&ot==="round"&&(Re<x?ot="miter":Re<=2&&(ot="fakeround")),ot==="miter"&&Re>_&&(ot="bevel"),ot==="bevel"&&(Re>2&&(ot="flipbevel"),Re<_&&(ot="miter")),U&&this.updateDistance(U,O),ot==="miter")Te._mult(Re),this.addCurrentVertex(O,Te,0,0,R);else if(ot==="flipbevel"){if(Re>100)Te=oe.mult(-1);else{const kt=Re*Y.add(oe).mag()/Y.sub(oe).mag();Te._perp()._mult(kt*(Rt?-1:1))}this.addCurrentVertex(O,Te,0,0,R),this.addCurrentVertex(O,Te.mult(-1),0,0,R)}else if(ot==="bevel"||ot==="fakeround"){const kt=-Math.sqrt(Re*Re-1),vt=Rt?kt:0,gt=Rt?0:kt;if(U&&this.addCurrentVertex(O,Y,vt,gt,R),ot==="fakeround"){const Oe=Math.round(180*Ge/Math.PI/20);for(let Ct=1;Ct<Oe;Ct++){let St=Ct/Oe;if(St!==.5){const bn=St-.5;St+=St*bn*(St-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*bn*bn+(.848013+ve*(.215638*ve-1.06021)))}const jt=oe.sub(Y)._mult(St)._add(Y)._unit()._mult(Rt?-1:1);this.addHalfVertex(O,jt.x,jt.y,!1,Rt,0,R)}}X&&this.addCurrentVertex(O,oe,-vt,-gt,R)}else if(ot==="butt")this.addCurrentVertex(O,Te,0,0,R);else if(ot==="square"){const kt=U?1:-1;this.addCurrentVertex(O,Te,kt,kt,R)}else ot==="round"&&(U&&(this.addCurrentVertex(O,Y,0,0,R),this.addCurrentVertex(O,Y,1,1,R,!0)),X&&(this.addCurrentVertex(O,oe,-1,-1,R,!0),this.addCurrentVertex(O,oe,0,0,R)));if(ht&&ue<T-1){const kt=O.dist(X);if(kt>2*D){const vt=O.add(X.sub(O)._mult(D/kt)._round());this.updateDistance(O,vt),this.addCurrentVertex(vt,oe,0,0,R),O=vt}}}}addCurrentVertex(r,o,u,m,_,x=!1){const b=o.y*m-o.x,T=-o.y-o.x*m;this.addHalfVertex(r,o.x+o.y*u,o.y-o.x*u,x,!1,u,_),this.addHalfVertex(r,b,T,x,!0,-m,_),this.distance>Bb/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,o,u,m,_,x))}addHalfVertex({x:r,y:o},u,m,_,x,b,T){const M=.5*(this.lineClips?this.scaledDistance*(Bb-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(_?1:0),(o<<1)+(x?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(b===0?0:b<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),T.primitiveLength++),x?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,o){this.distance+=r.dist(o),this.updateScaledDistance()}}let Fb,Nb;yt("LineBucket",cy,{omit:["layers","patternFeatures"]});var Ob={get paint(){return Nb=Nb||new v({"line-opacity":new Lt(Pe.paint_line["line-opacity"]),"line-color":new Lt(Pe.paint_line["line-color"]),"line-translate":new bt(Pe.paint_line["line-translate"]),"line-translate-anchor":new bt(Pe.paint_line["line-translate-anchor"]),"line-width":new Lt(Pe.paint_line["line-width"]),"line-gap-width":new Lt(Pe.paint_line["line-gap-width"]),"line-offset":new Lt(Pe.paint_line["line-offset"]),"line-blur":new Lt(Pe.paint_line["line-blur"]),"line-dasharray":new vc(Pe.paint_line["line-dasharray"]),"line-pattern":new yc(Pe.paint_line["line-pattern"]),"line-gradient":new wh(Pe.paint_line["line-gradient"])})},get layout(){return Fb=Fb||new v({"line-cap":new bt(Pe.layout_line["line-cap"]),"line-join":new Lt(Pe.layout_line["line-join"]),"line-miter-limit":new bt(Pe.layout_line["line-miter-limit"]),"line-round-limit":new bt(Pe.layout_line["line-round-limit"]),"line-sort-key":new Lt(Pe.layout_line["line-sort-key"])})}};class FA extends Lt{possiblyEvaluate(r,o){return o=new Pn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(r,o)}evaluate(r,o,u,m){return o=le({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(r,o,u,m)}}let Jf;class NA extends l{constructor(r){super(r,Ob),this.gradientVersion=0,Jf||(Jf=new FA(Ob.paint.properties["line-width"].specification),Jf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof jo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,o){super.recalculate(r,o),this.paint._values["line-floorwidth"]=Jf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new cy(r)}queryRadius(r){const o=r,u=jb(Th("line-width",this,o),Th("line-gap-width",this,o)),m=Th("line-offset",this,o);return u/2+Math.abs(m)+Wf(this.paint.get("line-translate"))}queryIntersectsFeature(r,o,u,m,_,x,b){const T=qf(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,b),M=b/2*jb(this.paint.get("line-width").evaluate(o,u),this.paint.get("line-gap-width").evaluate(o,u)),D=this.paint.get("line-offset").evaluate(o,u);return D&&(m=function(R,O){const U=[];for(let X=0;X<R.length;X++){const Y=R[X],oe=[];for(let ue=0;ue<Y.length;ue++){const Te=Y[ue-1],ve=Y[ue],Se=Y[ue+1],Re=ue===0?new k(0,0):ve.sub(Te)._unit()._perp(),Ge=ue===Y.length-1?new k(0,0):Se.sub(ve)._unit()._perp(),ht=Re._add(Ge)._unit(),Rt=ht.x*Ge.x+ht.y*Ge.y;Rt!==0&&ht._mult(1/Rt),oe.push(ht._mult(O)._add(ve))}U.push(oe)}return U}(m,D*b)),function(R,O,U){for(let X=0;X<O.length;X++){const Y=O[X];if(R.length>=3){for(let oe=0;oe<Y.length;oe++)if(Tc(R,Y[oe]))return!0}if(qI(R,Y,U))return!0}return!1}(T,m,M)}isTileClipped(){return!0}}function jb(s,r){return r>0?r+2*s:s}const OA=w([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),jA=w([{name:"a_projected_pos",components:3,type:"Float32"}],4);w([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const VA=w([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);w([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Vb=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),UA=w([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function $A(s,r,o){return s.sections.forEach(u=>{u.text=function(m,_,x){const b=_.layout.get("text-transform").evaluate(x,{});return b==="uppercase"?m=m.toLocaleUpperCase():b==="lowercase"&&(m=m.toLocaleLowerCase()),pi.applyArabicShaping&&(m=pi.applyArabicShaping(m)),m}(u.text,r,o)}),s}w([{name:"triangle",components:3,type:"Uint16"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),w([{type:"Float32",name:"offsetX"}]),w([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),w([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const zh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ur=24,Ub=vn,$b=function(s,r,o,u,m){var _,x,b=8*m-u-1,T=(1<<b)-1,M=T>>1,D=-7,R=m-1,O=-1,U=s[r+R];for(R+=O,_=U&(1<<-D)-1,U>>=-D,D+=b;D>0;_=256*_+s[r+R],R+=O,D-=8);for(x=_&(1<<-D)-1,_>>=-D,D+=u;D>0;x=256*x+s[r+R],R+=O,D-=8);if(_===0)_=1-M;else{if(_===T)return x?NaN:1/0*(U?-1:1);x+=Math.pow(2,u),_-=M}return(U?-1:1)*x*Math.pow(2,_-u)},Hb=function(s,r,o,u,m,_){var x,b,T,M=8*_-m-1,D=(1<<M)-1,R=D>>1,O=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=0,X=1,Y=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(b=isNaN(r)?1:0,x=D):(x=Math.floor(Math.log(r)/Math.LN2),r*(T=Math.pow(2,-x))<1&&(x--,T*=2),(r+=x+R>=1?O/T:O*Math.pow(2,1-R))*T>=2&&(x++,T/=2),x+R>=D?(b=0,x=D):x+R>=1?(b=(r*T-1)*Math.pow(2,m),x+=R):(b=r*Math.pow(2,R-1)*Math.pow(2,m),x=0));m>=8;s[o+U]=255&b,U+=X,b/=256,m-=8);for(x=x<<m|b,M+=m;M>0;s[o+U]=255&x,U+=X,x/=256,M-=8);s[o+U-X]|=128*Y};function vn(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}vn.Varint=0,vn.Fixed64=1,vn.Bytes=2,vn.Fixed32=5;var uy=4294967296,Gb=1/uy,Wb=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function _o(s){return s.type===vn.Bytes?s.readVarint()+s.pos:s.pos+1}function Ic(s,r,o){return o?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}function qb(s,r,o){var u=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));o.realloc(u);for(var m=o.pos-1;m>=s;m--)o.buf[m+u]=o.buf[m]}function HA(s,r){for(var o=0;o<s.length;o++)r.writeVarint(s[o])}function GA(s,r){for(var o=0;o<s.length;o++)r.writeSVarint(s[o])}function WA(s,r){for(var o=0;o<s.length;o++)r.writeFloat(s[o])}function qA(s,r){for(var o=0;o<s.length;o++)r.writeDouble(s[o])}function ZA(s,r){for(var o=0;o<s.length;o++)r.writeBoolean(s[o])}function XA(s,r){for(var o=0;o<s.length;o++)r.writeFixed32(s[o])}function KA(s,r){for(var o=0;o<s.length;o++)r.writeSFixed32(s[o])}function YA(s,r){for(var o=0;o<s.length;o++)r.writeFixed64(s[o])}function JA(s,r){for(var o=0;o<s.length;o++)r.writeSFixed64(s[o])}function Qf(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function Ac(s,r,o){s[o]=r,s[o+1]=r>>>8,s[o+2]=r>>>16,s[o+3]=r>>>24}function Zb(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}vn.prototype={destroy:function(){this.buf=null},readFields:function(s,r,o){for(o=o||this.length;this.pos<o;){var u=this.readVarint(),m=u>>3,_=this.pos;this.type=7&u,s(m,r,this),this.pos===_&&this.skip(u)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=Qf(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=Zb(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=Qf(this.buf,this.pos)+Qf(this.buf,this.pos+4)*uy;return this.pos+=8,s},readSFixed64:function(){var s=Qf(this.buf,this.pos)+Zb(this.buf,this.pos+4)*uy;return this.pos+=8,s},readFloat:function(){var s=$b(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=$b(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,o,u=this.buf;return r=127&(o=u[this.pos++]),o<128?r:(r|=(127&(o=u[this.pos++]))<<7,o<128?r:(r|=(127&(o=u[this.pos++]))<<14,o<128?r:(r|=(127&(o=u[this.pos++]))<<21,o<128?r:function(m,_,x){var b,T,M=x.buf;if(b=(112&(T=M[x.pos++]))>>4,T<128||(b|=(127&(T=M[x.pos++]))<<3,T<128)||(b|=(127&(T=M[x.pos++]))<<10,T<128)||(b|=(127&(T=M[x.pos++]))<<17,T<128)||(b|=(127&(T=M[x.pos++]))<<24,T<128)||(b|=(1&(T=M[x.pos++]))<<31,T<128))return Ic(m,b,_);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(o=u[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&Wb?function(o,u,m){return Wb.decode(o.subarray(u,m))}(this.buf,r,s):function(o,u,m){for(var _="",x=u;x<m;){var b,T,M,D=o[x],R=null,O=D>239?4:D>223?3:D>191?2:1;if(x+O>m)break;O===1?D<128&&(R=D):O===2?(192&(b=o[x+1]))==128&&(R=(31&D)<<6|63&b)<=127&&(R=null):O===3?(T=o[x+2],(192&(b=o[x+1]))==128&&(192&T)==128&&((R=(15&D)<<12|(63&b)<<6|63&T)<=2047||R>=55296&&R<=57343)&&(R=null)):O===4&&(T=o[x+2],M=o[x+3],(192&(b=o[x+1]))==128&&(192&T)==128&&(192&M)==128&&((R=(15&D)<<18|(63&b)<<12|(63&T)<<6|63&M)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,O=1):R>65535&&(R-=65536,_+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),_+=String.fromCharCode(R),x+=O}return _}(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==vn.Bytes)return s.push(this.readVarint(r));var o=_o(this);for(s=s||[];this.pos<o;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==vn.Bytes)return s.push(this.readSVarint());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==vn.Bytes)return s.push(this.readBoolean());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==vn.Bytes)return s.push(this.readFloat());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==vn.Bytes)return s.push(this.readDouble());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==vn.Bytes)return s.push(this.readFixed32());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==vn.Bytes)return s.push(this.readSFixed32());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==vn.Bytes)return s.push(this.readFixed64());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==vn.Bytes)return s.push(this.readSFixed64());var r=_o(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===vn.Varint)for(;this.buf[this.pos++]>127;);else if(r===vn.Bytes)this.pos=this.readVarint()+this.pos;else if(r===vn.Fixed32)this.pos+=4;else{if(r!==vn.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var o=new Uint8Array(r);o.set(this.buf),this.buf=o,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Ac(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Ac(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Ac(this.buf,-1&s,this.pos),Ac(this.buf,Math.floor(s*Gb),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Ac(this.buf,-1&s,this.pos),Ac(this.buf,Math.floor(s*Gb),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(r,o){var u,m;if(r>=0?(u=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(u=~(-r%4294967296))?u=u+1|0:(u=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(_,x,b){b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,b.buf[b.pos]=127&(_>>>=7)}(u,0,o),function(_,x){var b=(7&_)<<4;x.buf[x.pos++]|=b|((_>>>=3)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_)))))}(m,o)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=function(u,m,_){for(var x,b,T=0;T<m.length;T++){if((x=m.charCodeAt(T))>55295&&x<57344){if(!b){x>56319||T+1===m.length?(u[_++]=239,u[_++]=191,u[_++]=189):b=x;continue}if(x<56320){u[_++]=239,u[_++]=191,u[_++]=189,b=x;continue}x=b-55296<<10|x-56320|65536,b=null}else b&&(u[_++]=239,u[_++]=191,u[_++]=189,b=null);x<128?u[_++]=x:(x<2048?u[_++]=x>>6|192:(x<65536?u[_++]=x>>12|224:(u[_++]=x>>18|240,u[_++]=x>>12&63|128),u[_++]=x>>6&63|128),u[_++]=63&x|128)}return _}(this.buf,s,this.pos);var o=this.pos-r;o>=128&&qb(r,o,this),this.pos=r-1,this.writeVarint(o),this.pos+=o},writeFloat:function(s){this.realloc(4),Hb(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Hb(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var o=0;o<r;o++)this.buf[this.pos++]=s[o]},writeRawMessage:function(s,r){this.pos++;var o=this.pos;s(r,this);var u=this.pos-o;u>=128&&qb(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeMessage:function(s,r,o){this.writeTag(s,vn.Bytes),this.writeRawMessage(r,o)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,HA,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,GA,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,ZA,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,WA,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,qA,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,XA,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,KA,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,YA,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,JA,r)},writeBytesField:function(s,r){this.writeTag(s,vn.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,vn.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,vn.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,vn.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,vn.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,vn.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,vn.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,vn.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,vn.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,vn.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,!!r)}};var hy=S(Ub);const dy=3;function QA(s,r,o){s===1&&o.readMessage(eM,r)}function eM(s,r,o){if(s===3){const{id:u,bitmap:m,width:_,height:x,left:b,top:T,advance:M}=o.readMessage(tM,{});r.push({id:u,bitmap:new Eh({width:_+2*dy,height:x+2*dy},m),metrics:{width:_,height:x,left:b,top:T,advance:M}})}}function tM(s,r,o){s===1?r.id=o.readVarint():s===2?r.bitmap=o.readBytes():s===3?r.width=o.readVarint():s===4?r.height=o.readVarint():s===5?r.left=o.readSVarint():s===6?r.top=o.readSVarint():s===7&&(r.advance=o.readVarint())}const Xb=dy;function Kb(s){let r=0,o=0;for(const x of s)r+=x.w*x.h,o=Math.max(o,x.w);s.sort((x,b)=>b.h-x.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),o),h:1/0}];let m=0,_=0;for(const x of s)for(let b=u.length-1;b>=0;b--){const T=u[b];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,_=Math.max(_,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===T.w&&x.h===T.h){const M=u.pop();b<u.length&&(u[b]=M)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(u.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:m,h:_,fill:r/(m*_)||0}}const gi=1;class fy{constructor(r,{pixelRatio:o,version:u,stretchX:m,stretchY:_,content:x,textFitWidth:b,textFitHeight:T}){this.paddedRect=r,this.pixelRatio=o,this.stretchX=m,this.stretchY=_,this.content=x,this.version=u,this.textFitWidth=b,this.textFitHeight=T}get tl(){return[this.paddedRect.x+gi,this.paddedRect.y+gi]}get br(){return[this.paddedRect.x+this.paddedRect.w-gi,this.paddedRect.y+this.paddedRect.h-gi]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*gi)/this.pixelRatio,(this.paddedRect.h-2*gi)/this.pixelRatio]}}class Yb{constructor(r,o){const u={},m={};this.haveRenderCallbacks=[];const _=[];this.addImages(r,u,_),this.addImages(o,m,_);const{w:x,h:b}=Kb(_),T=new Xi({width:x||1,height:b||1});for(const M in r){const D=r[M],R=u[M].paddedRect;Xi.copy(D.data,T,{x:0,y:0},{x:R.x+gi,y:R.y+gi},D.data)}for(const M in o){const D=o[M],R=m[M].paddedRect,O=R.x+gi,U=R.y+gi,X=D.data.width,Y=D.data.height;Xi.copy(D.data,T,{x:0,y:0},{x:O,y:U},D.data),Xi.copy(D.data,T,{x:0,y:Y-1},{x:O,y:U-1},{width:X,height:1}),Xi.copy(D.data,T,{x:0,y:0},{x:O,y:U+Y},{width:X,height:1}),Xi.copy(D.data,T,{x:X-1,y:0},{x:O-1,y:U},{width:1,height:Y}),Xi.copy(D.data,T,{x:0,y:0},{x:O+X,y:U},{width:1,height:Y})}this.image=T,this.iconPositions=u,this.patternPositions=m}addImages(r,o,u){for(const m in r){const _=r[m],x={x:0,y:0,w:_.data.width+2*gi,h:_.data.height+2*gi};u.push(x),o[m]=new fy(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(r,o){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in r.updatedImages)this.patchUpdatedImage(this.iconPositions[u],r.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],r.getImage(u),o)}patchUpdatedImage(r,o,u){if(!r||!o||r.version===o.version)return;r.version=o.version;const[m,_]=r.tl;u.update(o.data,void 0,{x:m,y:_})}}var ha;yt("ImagePosition",fy),yt("ImageAtlas",Yb),p.ah=void 0,(ha=p.ah||(p.ah={}))[ha.none=0]="none",ha[ha.horizontal=1]="horizontal",ha[ha.vertical=2]="vertical",ha[ha.horizontalOnly=3]="horizontalOnly";const Rh=-17;class Lh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,o){const u=new Lh;return u.scale=r||1,u.fontStack=o,u}static forImage(r){const o=new Lh;return o.imageName=r,o}}class Mc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,o){const u=new Mc;for(let m=0;m<r.sections.length;m++){const _=r.sections[m];_.image?u.addImageSection(_):u.addTextSection(_,o)}return u}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let o="";for(let u=0;u<r.length;u++){const m=r.charCodeAt(u+1)||null,_=r.charCodeAt(u-1)||null;o+=m&&Of(m)&&!zh[r[u+1]]||_&&Of(_)&&!zh[r[u-1]]||!zh[r[u]]?r[u]:zh[r[u]]}return o}(this.text)}trim(){let r=0;for(let u=0;u<this.text.length&&tp[this.text.charCodeAt(u)];u++)r++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=r&&tp[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(r,o),this.sectionIndex=this.sectionIndex.slice(r,o)}substring(r,o){const u=new Mc;return u.text=this.text.substring(r,o),u.sectionIndex=this.sectionIndex.slice(r,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,o)=>Math.max(r,this.sections[o].scale),0)}addTextSection(r,o){this.text+=r.text,this.sections.push(Lh.forText(r.scale,r.fontStack||o));const u=this.sections.length-1;for(let m=0;m<r.text.length;++m)this.sectionIndex.push(u)}addImageSection(r){const o=r.image?r.image.name:"";if(o.length===0)return void ze("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Lh.forImage(o)),this.sectionIndex.push(this.sections.length-1)):ze("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ep(s,r,o,u,m,_,x,b,T,M,D,R,O,U,X){const Y=Mc.fromFeature(s,m);let oe;R===p.ah.vertical&&Y.verticalizePunctuation();const{processBidirectionalText:ue,processStyledBidirectionalText:Te}=pi;if(ue&&Y.sections.length===1){oe=[];const Re=ue(Y.toString(),py(Y,M,_,r,u,U));for(const Ge of Re){const ht=new Mc;ht.text=Ge,ht.sections=Y.sections;for(let Rt=0;Rt<Ge.length;Rt++)ht.sectionIndex.push(0);oe.push(ht)}}else if(Te){oe=[];const Re=Te(Y.text,Y.sectionIndex,py(Y,M,_,r,u,U));for(const Ge of Re){const ht=new Mc;ht.text=Ge[0],ht.sectionIndex=Ge[1],ht.sections=Y.sections,oe.push(ht)}}else oe=function(Re,Ge){const ht=[],Rt=Re.text;let ct=0;for(const ot of Ge)ht.push(Re.substring(ct,ot)),ct=ot;return ct<Rt.length&&ht.push(Re.substring(ct,Rt.length)),ht}(Y,py(Y,M,_,r,u,U));const ve=[],Se={positionedLines:ve,text:Y.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(Re,Ge,ht,Rt,ct,ot,kt,vt,gt,Oe,Ct,St){let jt=0,bn=Rh,_n=0,pr=0;const hs=vt==="right"?1:vt==="left"?0:.5;let Lr=0;for(const $n of ct){$n.trim();const gr=$n.getMaxScale(),$r=(gr-1)*ur,Br={positionedGlyphs:[],lineOffset:0};Re.positionedLines[Lr]=Br;const ri=Br.positionedGlyphs;let Fr=0;if(!$n.length()){bn+=ot,++Lr;continue}for(let yi=0;yi<$n.length();yi++){const un=$n.getSection(yi),Tn=$n.getSectionIndex(yi),Dn=$n.getCharCode(yi);let zi=0,Fn=null,Lc=null,Gs=null,Ws=ur;const ds=!(gt===p.ah.horizontal||!Ct&&!xh(Dn)||Ct&&(tp[Dn]||(mr=Dn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(mr)))));if(un.imageName){const Ji=Rt[un.imageName];if(!Ji)continue;Gs=un.imageName,Re.iconsInText=Re.iconsInText||!0,Lc=Ji.paddedRect;const Sr=Ji.displaySize;un.scale=un.scale*ur/St,Fn={width:Sr[0],height:Sr[1],left:gi,top:-Xb,advance:ds?Sr[1]:Sr[0]},zi=$r+(ur-Sr[1]*un.scale),Ws=Fn.advance;const xo=ds?Sr[0]*un.scale-ur*gr:Sr[1]*un.scale-ur*gr;xo>0&&xo>Fr&&(Fr=xo)}else{const Ji=ht[un.fontStack],Sr=Ji&&Ji[Dn];if(Sr&&Sr.rect)Lc=Sr.rect,Fn=Sr.metrics;else{const xo=Ge[un.fontStack],Vh=xo&&xo[Dn];if(!Vh)continue;Fn=Vh.metrics}zi=(gr-un.scale)*ur}ds?(Re.verticalizable=!0,ri.push({glyph:Dn,imageName:Gs,x:jt,y:bn+zi,vertical:ds,scale:un.scale,fontStack:un.fontStack,sectionIndex:Tn,metrics:Fn,rect:Lc}),jt+=Ws*un.scale+Oe):(ri.push({glyph:Dn,imageName:Gs,x:jt,y:bn+zi,vertical:ds,scale:un.scale,fontStack:un.fontStack,sectionIndex:Tn,metrics:Fn,rect:Lc}),jt+=Fn.advance*un.scale+Oe)}ri.length!==0&&(_n=Math.max(jt-Oe,_n),sM(ri,0,ri.length-1,hs,Fr)),jt=0;const Yi=ot*gr+Fr;Br.lineOffset=Math.max(Fr,$r),bn+=Yi,pr=Math.max(Yi,pr),++Lr}var mr;const ei=bn-Rh,{horizontalAlign:ti,verticalAlign:ni}=my(kt);(function($n,gr,$r,Br,ri,Fr,Yi,yi,un){const Tn=(gr-$r)*ri;let Dn=0;Dn=Fr!==Yi?-yi*Br-Rh:(-Br*un+.5)*Yi;for(const zi of $n)for(const Fn of zi.positionedGlyphs)Fn.x+=Tn,Fn.y+=Dn})(Re.positionedLines,hs,ti,ni,_n,pr,ot,ei,ct.length),Re.top+=-ni*ei,Re.bottom=Re.top+ei,Re.left+=-ti*_n,Re.right=Re.left+_n}(Se,r,o,u,oe,x,b,T,R,M,O,X),!function(Re){for(const Ge of Re)if(Ge.positionedGlyphs.length!==0)return!1;return!0}(ve)&&Se}const tp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nM={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},rM={40:!0};function Jb(s,r,o,u,m,_){if(r.imageName){const x=u[r.imageName];return x?x.displaySize[0]*r.scale*ur/_+m:0}{const x=o[r.fontStack],b=x&&x[s];return b?b.metrics.advance*r.scale+m:0}}function Qb(s,r,o,u){const m=Math.pow(s-r,2);return u?s<r?m/2:2*m:m+Math.abs(o)*o}function iM(s,r,o){let u=0;return s===10&&(u-=1e4),o&&(u+=150),s!==40&&s!==65288||(u+=50),r!==41&&r!==65289||(u+=50),u}function ew(s,r,o,u,m,_){let x=null,b=Qb(r,o,m,_);for(const T of u){const M=Qb(r-T.x,o,m,_)+T.badness;M<=b&&(x=T,b=M)}return{index:s,x:r,priorBreak:x,badness:b}}function tw(s){return s?tw(s.priorBreak).concat(s.index):[]}function py(s,r,o,u,m,_){if(!s)return[];const x=[],b=function(R,O,U,X,Y,oe){let ue=0;for(let Te=0;Te<R.length();Te++){const ve=R.getSection(Te);ue+=Jb(R.getCharCode(Te),ve,X,Y,O,oe)}return ue/Math.max(1,Math.ceil(ue/U))}(s,r,o,u,m,_),T=s.text.indexOf("")>=0;let M=0;for(let R=0;R<s.length();R++){const O=s.getSection(R),U=s.getCharCode(R);if(tp[U]||(M+=Jb(U,O,u,m,r,_)),R<s.length()-1){const X=!((D=U)<11904)&&(!!nn["CJK Compatibility Forms"](D)||!!nn["CJK Compatibility"](D)||!!nn["CJK Strokes"](D)||!!nn["CJK Symbols and Punctuation"](D)||!!nn["Enclosed CJK Letters and Months"](D)||!!nn["Halfwidth and Fullwidth Forms"](D)||!!nn["Ideographic Description Characters"](D)||!!nn["Vertical Forms"](D)||Nf.test(String.fromCodePoint(D)));(nM[U]||X||O.imageName||R!==s.length()-2&&rM[s.getCharCode(R+1)])&&x.push(ew(R+1,M,b,x,iM(U,s.getCharCode(R+1),X&&T),!1))}}var D;return tw(ew(s.length(),M,b,x,0,!0))}function my(s){let r=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:r,verticalAlign:o}}function sM(s,r,o,u,m){if(!u&&!m)return;const _=s[o],x=(s[o].x+_.metrics.advance*_.scale)*u;for(let b=r;b<=o;b++)s[b].x-=x,s[b].y+=m}function oM(s,r,o){const{horizontalAlign:u,verticalAlign:m}=my(o),_=r[0]-s.displaySize[0]*u,x=r[1]-s.displaySize[1]*m;return{image:s,top:x,bottom:x+s.displaySize[1],left:_,right:_+s.displaySize[0]}}function nw(s){var r,o;let u=s.left,m=s.top,_=s.right-u,x=s.bottom-m;const b=(r=s.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",T=(o=s.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",M=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(T==="proportional"){if(b==="stretchOnly"&&_/x<M||b==="proportional"){const D=Math.ceil(x*M);u*=D/_,_=D}}else if(b==="proportional"&&T==="stretchOnly"&&M!==0&&_/x>M){const D=Math.ceil(_/M);m*=D/x,x=D}return{x1:u,y1:m,x2:u+_,y2:m+x}}function rw(s,r,o,u,m,_){const x=s.image;let b;if(x.content){const oe=x.content,ue=x.pixelRatio||1;b=[oe[0]/ue,oe[1]/ue,x.displaySize[0]-oe[2]/ue,x.displaySize[1]-oe[3]/ue]}const T=r.left*_,M=r.right*_;let D,R,O,U;o==="width"||o==="both"?(U=m[0]+T-u[3],R=m[0]+M+u[1]):(U=m[0]+(T+M-x.displaySize[0])/2,R=U+x.displaySize[0]);const X=r.top*_,Y=r.bottom*_;return o==="height"||o==="both"?(D=m[1]+X-u[0],O=m[1]+Y+u[2]):(D=m[1]+(X+Y-x.displaySize[1])/2,O=D+x.displaySize[1]),{image:x,top:D,right:R,bottom:O,left:U,collisionPadding:b}}const Bh=255,Hs=128,da=Bh*Hs;function iw(s,r){const{expression:o}=r;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Pn(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:m}=o;let _=0;for(;_<u.length&&u[_]<=s;)_++;_=Math.max(0,_-1);let x=_;for(;x<u.length&&u[x]<s+1;)x++;x=Math.min(u.length-1,x);const b=u[_],T=u[x];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:T,interpolationType:m}:{kind:"camera",minZoom:b,maxZoom:T,minSize:o.evaluate(new Pn(b)),maxSize:o.evaluate(new Pn(T)),interpolationType:m}}}function gy(s,r,o){let u="never";const m=s.get(r);return m?u=m:s.get(o)&&(u="always"),u}const aM=ua.VectorTileFeature.types,lM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function np(s,r,o,u,m,_,x,b,T,M,D,R,O){const U=b?Math.min(da,Math.round(b[0])):0,X=b?Math.min(da,Math.round(b[1])):0;s.emplaceBack(r,o,Math.round(32*u),Math.round(32*m),_,x,(U<<1)+(T?1:0),X,16*M,16*D,256*R,256*O)}function yy(s,r,o){s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o)}function cM(s){for(const r of s.sections)if(Gg(r.text))return!0;return!1}class vy{constructor(r){this.layoutVertexArray=new xc,this.indexArray=new Zi,this.programConfigurations=r,this.segments=new rn,this.dynamicLayoutVertexArray=new Sh,this.opacityVertexArray=new Mi,this.hasVisibleVertices=!1,this.placedSymbolArray=new In}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,o,u,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,OA.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,jA.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,lM,!0),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}yt("SymbolBuffers",vy);class _y{constructor(r,o,u){this.layoutVertexArray=new r,this.layoutAttributes=o,this.indexArray=new u,this.segments=new rn,this.collisionVertexArray=new Us}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,VA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}yt("CollisionBuffers",_y);class Dc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(x=>x.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Jg([]),this.placementViewportMatrix=Jg([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=iw(this.zoom,o["text-size"]),this.iconSizeData=iw(this.zoom,o["icon-size"]);const u=this.layers[0].layout,m=u.get("symbol-sort-key"),_=u.get("symbol-z-order");this.canOverlap=gy(u,"text-overlap","text-allow-overlap")!=="never"||gy(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(x=>p.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=r.sourceID}createArrays(){this.text=new vy(new hl(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new vy(new hl(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new An,this.lineVertexArray=new Mr,this.symbolInstances=new tn,this.textAnchorOffsets=new Mn}calculateGlyphDependencies(r,o,u,m,_){for(let x=0;x<r.length;x++)if(o[r.charCodeAt(x)]=!0,(u||m)&&_){const b=zh[r.charAt(x)];b&&(o[b.charCodeAt(0)]=!0)}}populate(r,o,u){const m=this.layers[0],_=m.layout,x=_.get("text-font"),b=_.get("text-field"),T=_.get("icon-image"),M=(b.value.kind!=="constant"||b.value.value instanceof ui&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),D=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,R=_.get("symbol-sort-key");if(this.features=[],!M&&!D)return;const O=o.iconDependencies,U=o.glyphDependencies,X=o.availableImages,Y=new Pn(this.zoom);for(const{feature:oe,id:ue,index:Te,sourceLayerIndex:ve}of r){const Se=m._featureFilter.needGeometry,Re=fl(oe,Se);if(!m._featureFilter.filter(Y,Re,u))continue;let Ge,ht;if(Se||(Re.geometry=dl(oe)),M){const ct=m.getValueAndResolveTokens("text-field",Re,u,X),ot=ui.factory(ct),kt=this.hasRTLText=this.hasRTLText||cM(ot);(!kt||pi.getRTLTextPluginStatus()==="unavailable"||kt&&pi.isParsed())&&(Ge=$A(ot,m,Re))}if(D){const ct=m.getValueAndResolveTokens("icon-image",Re,u,X);ht=ct instanceof di?ct:di.fromString(ct)}if(!Ge&&!ht)continue;const Rt=this.sortFeaturesByKey?R.evaluate(Re,{},u):void 0;if(this.features.push({id:ue,text:Ge,icon:ht,index:Te,sourceLayerIndex:ve,geometry:Re.geometry,properties:oe.properties,type:aM[oe.type],sortKey:Rt}),ht&&(O[ht.name]=!0),Ge){const ct=x.evaluate(Re,{},u).join(","),ot=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(p.ah.vertical)>=0;for(const kt of Ge.sections)if(kt.image)O[kt.image.name]=!0;else{const vt=vh(Ge.toString()),gt=kt.fontStack||ct,Oe=U[gt]=U[gt]||{};this.calculateGlyphDependencies(kt.text,Oe,ot,this.allowVerticalPlacement,vt)}}}_.get("symbol-placement")==="line"&&(this.features=function(oe){const ue={},Te={},ve=[];let Se=0;function Re(ct){ve.push(oe[ct]),Se++}function Ge(ct,ot,kt){const vt=Te[ct];return delete Te[ct],Te[ot]=vt,ve[vt].geometry[0].pop(),ve[vt].geometry[0]=ve[vt].geometry[0].concat(kt[0]),vt}function ht(ct,ot,kt){const vt=ue[ot];return delete ue[ot],ue[ct]=vt,ve[vt].geometry[0].shift(),ve[vt].geometry[0]=kt[0].concat(ve[vt].geometry[0]),vt}function Rt(ct,ot,kt){const vt=kt?ot[0][ot[0].length-1]:ot[0][0];return`${ct}:${vt.x}:${vt.y}`}for(let ct=0;ct<oe.length;ct++){const ot=oe[ct],kt=ot.geometry,vt=ot.text?ot.text.toString():null;if(!vt){Re(ct);continue}const gt=Rt(vt,kt),Oe=Rt(vt,kt,!0);if(gt in Te&&Oe in ue&&Te[gt]!==ue[Oe]){const Ct=ht(gt,Oe,kt),St=Ge(gt,Oe,ve[Ct].geometry);delete ue[gt],delete Te[Oe],Te[Rt(vt,ve[St].geometry,!0)]=St,ve[Ct].geometry=null}else gt in Te?Ge(gt,Oe,kt):Oe in ue?ht(gt,Oe,kt):(Re(ct),ue[gt]=Se-1,Te[Oe]=Se-1)}return ve.filter(ct=>ct.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((oe,ue)=>oe.sortKey-ue.sortKey)}update(r,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(r,o,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,o){const u=this.lineVertexArray.length;if(r.segment!==void 0){let m=r.dist(o[r.segment+1]),_=r.dist(o[r.segment]);const x={};for(let b=r.segment+1;b<o.length;b++)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:m},b<o.length-1&&(m+=o[b+1].dist(o[b]));for(let b=r.segment||0;b>=0;b--)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:_},b>0&&(_+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const T=x[b];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(r,o,u,m,_,x,b,T,M,D,R,O){const U=r.indexArray,X=r.layoutVertexArray,Y=r.segments.prepareSegment(4*o.length,X,U,this.canOverlap?x.sortKey:void 0),oe=this.glyphOffsetArray.length,ue=Y.vertexLength,Te=this.allowVerticalPlacement&&b===p.ah.vertical?Math.PI/2:0,ve=x.text&&x.text.sections;for(let Se=0;Se<o.length;Se++){const{tl:Re,tr:Ge,bl:ht,br:Rt,tex:ct,pixelOffsetTL:ot,pixelOffsetBR:kt,minFontScaleX:vt,minFontScaleY:gt,glyphOffset:Oe,isSDF:Ct,sectionIndex:St}=o[Se],jt=Y.vertexLength,bn=Oe[1];np(X,T.x,T.y,Re.x,bn+Re.y,ct.x,ct.y,u,Ct,ot.x,ot.y,vt,gt),np(X,T.x,T.y,Ge.x,bn+Ge.y,ct.x+ct.w,ct.y,u,Ct,kt.x,ot.y,vt,gt),np(X,T.x,T.y,ht.x,bn+ht.y,ct.x,ct.y+ct.h,u,Ct,ot.x,kt.y,vt,gt),np(X,T.x,T.y,Rt.x,bn+Rt.y,ct.x+ct.w,ct.y+ct.h,u,Ct,kt.x,kt.y,vt,gt),yy(r.dynamicLayoutVertexArray,T,Te),U.emplaceBack(jt,jt+1,jt+2),U.emplaceBack(jt+1,jt+2,jt+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Oe[0]),Se!==o.length-1&&St===o[Se+1].sectionIndex||r.programConfigurations.populatePaintArrays(X.length,x,x.index,{},O,ve&&ve[St])}r.placedSymbolArray.emplaceBack(T.x,T.y,oe,this.glyphOffsetArray.length-oe,ue,M,D,T.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],b,0,!1,0,R)}_addCollisionDebugVertex(r,o,u,m,_,x){return o.emplaceBack(0,0),r.emplaceBack(u.x,u.y,m,_,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,o,u,m,_,x,b){const T=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),M=T.vertexLength,D=_.layoutVertexArray,R=_.collisionVertexArray,O=b.anchorX,U=b.anchorY;this._addCollisionDebugVertex(D,R,x,O,U,new k(r,o)),this._addCollisionDebugVertex(D,R,x,O,U,new k(u,o)),this._addCollisionDebugVertex(D,R,x,O,U,new k(u,m)),this._addCollisionDebugVertex(D,R,x,O,U,new k(r,m)),T.vertexLength+=4;const X=_.indexArray;X.emplaceBack(M,M+1),X.emplaceBack(M+1,M+2),X.emplaceBack(M+2,M+3),X.emplaceBack(M+3,M),T.primitiveLength+=4}addDebugCollisionBoxes(r,o,u,m){for(let _=r;_<o;_++){const x=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,m?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _y(Di,Vb.members,wr),this.iconCollisionBox=new _y(Di,Vb.members,wr);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(r,o,u,m,_,x,b,T,M){const D={};for(let R=o;R<u;R++){const O=r.get(R);D.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.textFeatureIndex=O.featureIndex;break}for(let R=m;R<_;R++){const O=r.get(R);D.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.verticalTextFeatureIndex=O.featureIndex;break}for(let R=x;R<b;R++){const O=r.get(R);D.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.iconFeatureIndex=O.featureIndex;break}for(let R=T;R<M;R++){const O=r.get(R);D.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.verticalIconFeatureIndex=O.featureIndex;break}return D}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,o){const u=r.placedSymbolArray.get(o),m=u.vertexStartIndex+4*u.numGlyphs;for(let _=u.vertexStartIndex;_<m;_+=4)r.indexArray.emplaceBack(_,_+1,_+2),r.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(r),u=Math.cos(r),m=[],_=[],x=[];for(let b=0;b<this.symbolInstances.length;++b){x.push(b);const T=this.symbolInstances.get(b);m.push(0|Math.round(o*T.anchorX+u*T.anchorY)),_.push(T.featureIndex)}return x.sort((b,T)=>m[b]-m[T]||_[T]-_[b]),x}addToSortKeyRanges(r,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((m,_,x)=>{m>=0&&x.indexOf(m)===_&&this.addIndicesForPlacedSymbol(this.text,m)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let sw,ow;yt("SymbolBucket",Dc,{omit:["layers","collisionBoxArray","features","compareText"]}),Dc.MAX_GLYPHS=65535,Dc.addDynamicAttributes=yy;var xy={get paint(){return ow=ow||new v({"icon-opacity":new Lt(Pe.paint_symbol["icon-opacity"]),"icon-color":new Lt(Pe.paint_symbol["icon-color"]),"icon-halo-color":new Lt(Pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Lt(Pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Lt(Pe.paint_symbol["icon-halo-blur"]),"icon-translate":new bt(Pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new bt(Pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Lt(Pe.paint_symbol["text-opacity"]),"text-color":new Lt(Pe.paint_symbol["text-color"],{runtimeType:Gn,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Lt(Pe.paint_symbol["text-halo-color"]),"text-halo-width":new Lt(Pe.paint_symbol["text-halo-width"]),"text-halo-blur":new Lt(Pe.paint_symbol["text-halo-blur"]),"text-translate":new bt(Pe.paint_symbol["text-translate"]),"text-translate-anchor":new bt(Pe.paint_symbol["text-translate-anchor"])})},get layout(){return sw=sw||new v({"symbol-placement":new bt(Pe.layout_symbol["symbol-placement"]),"symbol-spacing":new bt(Pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bt(Pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Lt(Pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bt(Pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bt(Pe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new bt(Pe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new bt(Pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new bt(Pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bt(Pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Lt(Pe.layout_symbol["icon-size"]),"icon-text-fit":new bt(Pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bt(Pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Lt(Pe.layout_symbol["icon-image"]),"icon-rotate":new Lt(Pe.layout_symbol["icon-rotate"]),"icon-padding":new Lt(Pe.layout_symbol["icon-padding"]),"icon-keep-upright":new bt(Pe.layout_symbol["icon-keep-upright"]),"icon-offset":new Lt(Pe.layout_symbol["icon-offset"]),"icon-anchor":new Lt(Pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bt(Pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bt(Pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bt(Pe.layout_symbol["text-rotation-alignment"]),"text-field":new Lt(Pe.layout_symbol["text-field"]),"text-font":new Lt(Pe.layout_symbol["text-font"]),"text-size":new Lt(Pe.layout_symbol["text-size"]),"text-max-width":new Lt(Pe.layout_symbol["text-max-width"]),"text-line-height":new bt(Pe.layout_symbol["text-line-height"]),"text-letter-spacing":new Lt(Pe.layout_symbol["text-letter-spacing"]),"text-justify":new Lt(Pe.layout_symbol["text-justify"]),"text-radial-offset":new Lt(Pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bt(Pe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Lt(Pe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Lt(Pe.layout_symbol["text-anchor"]),"text-max-angle":new bt(Pe.layout_symbol["text-max-angle"]),"text-writing-mode":new bt(Pe.layout_symbol["text-writing-mode"]),"text-rotate":new Lt(Pe.layout_symbol["text-rotate"]),"text-padding":new bt(Pe.layout_symbol["text-padding"]),"text-keep-upright":new bt(Pe.layout_symbol["text-keep-upright"]),"text-transform":new Lt(Pe.layout_symbol["text-transform"]),"text-offset":new Lt(Pe.layout_symbol["text-offset"]),"text-allow-overlap":new bt(Pe.layout_symbol["text-allow-overlap"]),"text-overlap":new bt(Pe.layout_symbol["text-overlap"]),"text-ignore-placement":new bt(Pe.layout_symbol["text-ignore-placement"]),"text-optional":new bt(Pe.layout_symbol["text-optional"])})}};class aw{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:zn,this.defaultValue=r}evaluate(r){if(r.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(r.formattedSection))return o.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}yt("FormatSectionOverride",aw,{omit:["defaultValue"]});class rp extends l{constructor(r){super(r,xy)}recalculate(r,o){if(super.recalculate(r,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const m=[];for(const _ of u)m.indexOf(_)<0&&m.push(_);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,o,u,m){const _=this.layout.get(r).evaluate(o,{},u,m),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||sc(x.value)||!_?_:function(b,T){return T.replace(/{([^{}]+)}/g,(M,D)=>b&&D in b?String(b[D]):"")}(o.properties,_)}createBucket(r){return new Dc(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of xy.paint.overridableProperties){if(!rp.hasPaintOverride(this.layout,r))continue;const o=this.paint.get(r),u=new aw(o),m=new ic(u,o.property.specification);let _=null;_=o.value.kind==="constant"||o.value.kind==="source"?new Xo("source",m):new Ko("composite",m,o.value.zoomStops),this.paint._values[r]=new cs(o.property,_,o.parameters)}}_handleOverridablePaintPropertyUpdate(r,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&rp.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,o){const u=r.get("text-field"),m=xy.paint.properties[o];let _=!1;const x=b=>{for(const T of b)if(m.overrides&&m.overrides.hasOverride(T))return void(_=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ui)x(u.value.value.sections);else if(u.value.kind==="source"){const b=M=>{_||(M instanceof Ui&&rr(M.value)===Zt?x(M.value.sections):M instanceof Xl?x(M.sections):M.eachChild(b))},T=u.value;T._styleExpression&&b(T._styleExpression.expression)}return _}}let lw;var uM={get paint(){return lw=lw||new v({"background-color":new bt(Pe.paint_background["background-color"]),"background-pattern":new vc(Pe.paint_background["background-pattern"]),"background-opacity":new bt(Pe.paint_background["background-opacity"])})}};class hM extends l{constructor(r){super(r,uM)}}let cw;var dM={get paint(){return cw=cw||new v({"raster-opacity":new bt(Pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new bt(Pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bt(Pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bt(Pe.paint_raster["raster-brightness-max"]),"raster-saturation":new bt(Pe.paint_raster["raster-saturation"]),"raster-contrast":new bt(Pe.paint_raster["raster-contrast"]),"raster-resampling":new bt(Pe.paint_raster["raster-resampling"]),"raster-fade-duration":new bt(Pe.paint_raster["raster-fade-duration"])})}};class fM extends l{constructor(r){super(r,dM)}}class pM extends l{constructor(r){super(r,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class mM{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const by=63710088e-1;class fa{constructor(r,o){if(isNaN(r)||isNaN(o))throw new Error(`Invalid LngLat object: (${r}, ${o})`);if(this.lng=+r,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fa(_e(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const o=Math.PI/180,u=this.lat*o,m=r.lat*o,_=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((r.lng-this.lng)*o);return by*Math.acos(Math.min(_,1))}static convert(r){if(r instanceof fa)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new fa(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new fa(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const uw=2*Math.PI*by;function hw(s){return uw*Math.cos(s*Math.PI/180)}function dw(s){return(180+s)/360}function fw(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function pw(s,r){return s/hw(r)}function wy(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class Fh{constructor(r,o,u=0){this.x=+r,this.y=+o,this.z=+u}static fromLngLat(r,o=0){const u=fa.convert(r);return new Fh(dw(u.lng),fw(u.lat),pw(o,u.lat))}toLngLat(){return new fa(360*this.x-180,wy(this.y))}toAltitude(){return this.z*hw(wy(this.y))}meterInMercatorCoordinateUnits(){return 1/uw*(r=wy(this.y),1/Math.cos(r*Math.PI/180));var r}}function mw(s,r,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[s*u-2*Math.PI*6378137/2,r*u-2*Math.PI*6378137/2]}class Sy{constructor(r,o,u){if(!function(m,_,x){return!(m<0||m>25||x<0||x>=Math.pow(2,m)||_<0||_>=Math.pow(2,m))}(r,o,u))throw new Error(`x=${o}, y=${u}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=o,this.y=u,this.key=Nh(0,r,r,o,u)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,o,u){const m=(x=this.y,b=this.z,T=mw(256*(_=this.x),256*(x=Math.pow(2,b)-x-1),b),M=mw(256*(_+1),256*(x+1),b),T[0]+","+T[1]+","+M[0]+","+M[1]);var _,x,b,T,M;const D=function(R,O,U){let X,Y="";for(let oe=R;oe>0;oe--)X=1<<oe-1,Y+=(O&X?1:0)+(U&X?2:0);return Y}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,m)}isChildOf(r){const o=this.z-r.z;return o>0&&r.x===this.x>>o&&r.y===this.y>>o}getTilePoint(r){const o=Math.pow(2,this.z);return new k((r.x*o-this.x)*ir,(r.y*o-this.y)*ir)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gw{constructor(r,o){this.wrap=r,this.canonical=o,this.key=Nh(r,o.z,o.z,o.x,o.y)}}class Ki{constructor(r,o,u,m,_){if(r<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${u}`);this.overscaledZ=r,this.wrap=o,this.canonical=new Sy(u,+m,+_),this.key=Nh(o,r,u,m,_)}clone(){return new Ki(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-r;return r>this.canonical.z?new Ki(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ki(r,this.wrap,r,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(r,o){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-r;return r>this.canonical.z?Nh(this.wrap*+o,r,this.canonical.z,this.canonical.x,this.canonical.y):Nh(this.wrap*+o,r,r,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const o=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>o&&r.canonical.y===this.canonical.y>>o}children(r){if(this.overscaledZ>=r)return[new Ki(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new Ki(o,this.wrap,o,u,m),new Ki(o,this.wrap,o,u+1,m),new Ki(o,this.wrap,o,u,m+1),new Ki(o,this.wrap,o,u+1,m+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ki(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ki(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Fh(r.x-this.wrap,r.y))}}function Nh(s,r,o,u,m){(s*=2)<0&&(s=-1*s-1);const _=1<<o;return(_*_*s+_*m+u).toString(36)+o.toString(36)+r.toString(36)}yt("CanonicalTileID",Sy),yt("OverscaledTileID",Ki,{omit:["posMatrix"]});class yw{constructor(r,o,u,m=1,_=1,x=1,b=0){if(this.uid=r,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void ze(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const T=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=_,this.blueFactor=x,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<T;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(T,M)]=this.data[this._idx(T-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,T)]=this.data[this._idx(M,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<T;M++)for(let D=0;D<T;D++){const R=this.get(M,D);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(r,o){const u=new Uint8Array(this.data.buffer),m=4*this._idx(r,o);return this.unpack(u[m],u[m+1],u[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,o){if(r<-1||r>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(r+1)}unpack(r,o,u){return r*this.redFactor+o*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new Xi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,o,u){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let m=o*this.dim,_=o*this.dim+this.dim,x=u*this.dim,b=u*this.dim+this.dim;switch(o){case-1:m=_-1;break;case 1:_=m+1}switch(u){case-1:x=b-1;break;case 1:b=x+1}const T=-o*this.dim,M=-u*this.dim;for(let D=x;D<b;D++)for(let R=m;R<_;R++)this.data[this._idx(R,D)]=r.data[this._idx(R+T,D+M)]}}yt("DEMData",yw);class vw{constructor(r){this._stringToNumber={},this._numberToString=[];for(let o=0;o<r.length;o++){const u=r[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class _w{constructor(r,o,u,m,_){this.type="Feature",this._vectorTileFeature=r,r._z=o,r._x=u,r._y=m,this.properties=r.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(r[o]=this[o]);return r}}class xw{constructor(r,o){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Qo(ir,16,0),this.grid3D=new Qo(ir,16,0),this.featureIndexArray=new Vr,this.promoteId=o}insert(r,o,u,m,_,x){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,_);const T=x?this.grid3D:this.grid;for(let M=0;M<o.length;M++){const D=o[M],R=[1/0,1/0,-1/0,-1/0];for(let O=0;O<D.length;O++){const U=D[O];R[0]=Math.min(R[0],U.x),R[1]=Math.min(R[1],U.y),R[2]=Math.max(R[2],U.x),R[3]=Math.max(R[3],U.y)}R[0]<ir&&R[1]<ir&&R[2]>=0&&R[3]>=0&&T.insert(b,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ua.VectorTile(new hy(this.rawTileData)).layers,this.sourceLayerCoder=new vw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,o,u,m){this.loadVTLayers();const _=r.params||{},x=ir/r.tileSize/r.scale,b=rh(_.filter),T=r.queryGeometry,M=r.queryPadding*x,D=ww(T),R=this.grid.query(D.minX-M,D.minY-M,D.maxX+M,D.maxY+M),O=ww(r.cameraQueryGeometry),U=this.grid3D.query(O.minX-M,O.minY-M,O.maxX+M,O.maxY+M,(oe,ue,Te,ve)=>function(Se,Re,Ge,ht,Rt){for(const ot of Se)if(Re<=ot.x&&Ge<=ot.y&&ht>=ot.x&&Rt>=ot.y)return!0;const ct=[new k(Re,Ge),new k(Re,Rt),new k(ht,Rt),new k(ht,Ge)];if(Se.length>2){for(const ot of ct)if(Tc(Se,ot))return!0}for(let ot=0;ot<Se.length-1;ot++)if(XI(Se[ot],Se[ot+1],ct))return!0;return!1}(r.cameraQueryGeometry,oe-M,ue-M,Te+M,ve+M));for(const oe of U)R.push(oe);R.sort(gM);const X={};let Y;for(let oe=0;oe<R.length;oe++){const ue=R[oe];if(ue===Y)continue;Y=ue;const Te=this.featureIndexArray.get(ue);let ve=null;this.loadMatchingFeature(X,Te.bucketIndex,Te.sourceLayerIndex,Te.featureIndex,b,_.layers,_.availableImages,o,u,m,(Se,Re,Ge)=>(ve||(ve=dl(Se)),Re.queryIntersectsFeature(T,Se,Ge,ve,this.z,r.transform,x,r.pixelPosMatrix)))}return X}loadMatchingFeature(r,o,u,m,_,x,b,T,M,D,R){const O=this.bucketLayerIDs[o];if(x&&!function(oe,ue){for(let Te=0;Te<oe.length;Te++)if(ue.indexOf(oe[Te])>=0)return!0;return!1}(x,O))return;const U=this.sourceLayerCoder.decode(u),X=this.vtLayers[U].feature(m);if(_.needGeometry){const oe=fl(X,!0);if(!_.filter(new Pn(this.tileID.overscaledZ),oe,this.tileID.canonical))return}else if(!_.filter(new Pn(this.tileID.overscaledZ),X))return;const Y=this.getId(X,U);for(let oe=0;oe<O.length;oe++){const ue=O[oe];if(x&&x.indexOf(ue)<0)continue;const Te=T[ue];if(!Te)continue;let ve={};Y&&D&&(ve=D.getState(Te.sourceLayer||"_geojsonTileLayer",Y));const Se=le({},M[ue]);Se.paint=bw(Se.paint,Te.paint,X,ve,b),Se.layout=bw(Se.layout,Te.layout,X,ve,b);const Re=!R||R(X,Te,ve);if(!Re)continue;const Ge=new _w(X,this.z,this.x,this.y,Y);Ge.layer=Se;let ht=r[ue];ht===void 0&&(ht=r[ue]=[]),ht.push({featureIndex:m,feature:Ge,intersectionZ:Re})}}lookupSymbolFeatures(r,o,u,m,_,x,b,T){const M={};this.loadVTLayers();const D=rh(_);for(const R of r)this.loadMatchingFeature(M,u,m,R,D,x,b,T,o);return M}hasLayer(r){for(const o of this.bucketLayerIDs)for(const u of o)if(r===u)return!0;return!1}getId(r,o){let u=r.id;return this.promoteId&&(u=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof u=="boolean"&&(u=Number(u))),u}}function bw(s,r,o,u,m){return De(s,(_,x)=>{const b=r instanceof ll?r.get(x):null;return b&&b.evaluate?b.evaluate(o,u,m):b})}function ww(s){let r=1/0,o=1/0,u=-1/0,m=-1/0;for(const _ of s)r=Math.min(r,_.x),o=Math.min(o,_.y),u=Math.max(u,_.x),m=Math.max(m,_.y);return{minX:r,minY:o,maxX:u,maxY:m}}function gM(s,r){return r-s}function Sw(s,r,o,u,m){const _=[];for(let x=0;x<s.length;x++){const b=s[x];let T;for(let M=0;M<b.length-1;M++){let D=b[M],R=b[M+1];D.x<r&&R.x<r||(D.x<r?D=new k(r,D.y+(r-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x<r&&(R=new k(r,D.y+(r-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y<o&&R.y<o||(D.y<o?D=new k(D.x+(o-D.y)/(R.y-D.y)*(R.x-D.x),o)._round():R.y<o&&(R=new k(D.x+(o-D.y)/(R.y-D.y)*(R.x-D.x),o)._round()),D.x>=u&&R.x>=u||(D.x>=u?D=new k(u,D.y+(u-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x>=u&&(R=new k(u,D.y+(u-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y>=m&&R.y>=m||(D.y>=m?D=new k(D.x+(m-D.y)/(R.y-D.y)*(R.x-D.x),m)._round():R.y>=m&&(R=new k(D.x+(m-D.y)/(R.y-D.y)*(R.x-D.x),m)._round()),T&&D.equals(T[T.length-1])||(T=[D],_.push(T)),T.push(R)))))}}return _}yt("FeatureIndex",xw,{omit:["rawTileData","sourceLayerCoder"]});class pa extends k{constructor(r,o,u,m){super(r,o),this.angle=u,m!==void 0&&(this.segment=m)}clone(){return new pa(this.x,this.y,this.angle,this.segment)}}function kw(s,r,o,u,m){if(r.segment===void 0||o===0)return!0;let _=r,x=r.segment+1,b=0;for(;b>-o/2;){if(x--,x<0)return!1;b-=s[x].dist(_),_=s[x]}b+=s[x].dist(s[x+1]),x++;const T=[];let M=0;for(;b<o/2;){const D=s[x],R=s[x+1];if(!R)return!1;let O=s[x-1].angleTo(D)-D.angleTo(R);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:b,angleDelta:O}),M+=O;b-T[0].distance>u;)M-=T.shift().angleDelta;if(M>m)return!1;x++,b+=D.dist(R)}return!0}function Tw(s){let r=0;for(let o=0;o<s.length-1;o++)r+=s[o].dist(s[o+1]);return r}function Cw(s,r,o){return s?.6*r*o:0}function Ew(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function yM(s,r,o,u,m,_){const x=Cw(o,m,_),b=Ew(o,u)*_;let T=0;const M=Tw(s)/2;for(let D=0;D<s.length-1;D++){const R=s[D],O=s[D+1],U=R.dist(O);if(T+U>M){const X=(M-T)/U,Y=Kr.number(R.x,O.x,X),oe=Kr.number(R.y,O.y,X),ue=new pa(Y,oe,O.angleTo(R),D);return ue._round(),!x||kw(s,ue,b,x,r)?ue:void 0}T+=U}}function vM(s,r,o,u,m,_,x,b,T){const M=Cw(u,_,x),D=Ew(u,m),R=D*x,O=s[0].x===0||s[0].x===T||s[0].y===0||s[0].y===T;return r-R<r/4&&(r=R+r/4),Pw(s,O?r/2*b%r:(D/2+2*_)*x*b%r,r,M,o,R,O,!1,T)}function Pw(s,r,o,u,m,_,x,b,T){const M=_/2,D=Tw(s);let R=0,O=r-o,U=[];for(let X=0;X<s.length-1;X++){const Y=s[X],oe=s[X+1],ue=Y.dist(oe),Te=oe.angleTo(Y);for(;O+o<R+ue;){O+=o;const ve=(O-R)/ue,Se=Kr.number(Y.x,oe.x,ve),Re=Kr.number(Y.y,oe.y,ve);if(Se>=0&&Se<T&&Re>=0&&Re<T&&O-M>=0&&O+M<=D){const Ge=new pa(Se,Re,Te,X);Ge._round(),u&&!kw(s,Ge,_,u,m)||U.push(Ge)}}R+=ue}return b||U.length||x||(U=Pw(s,R/2,o,u,m,_,x,!0,T)),U}yt("Anchor",pa);const zc=gi;function Iw(s,r,o,u){const m=[],_=s.image,x=_.pixelRatio,b=_.paddedRect.w-2*zc,T=_.paddedRect.h-2*zc;let M={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const D=_.stretchX||[[0,b]],R=_.stretchY||[[0,T]],O=(Oe,Ct)=>Oe+Ct[1]-Ct[0],U=D.reduce(O,0),X=R.reduce(O,0),Y=b-U,oe=T-X;let ue=0,Te=U,ve=0,Se=X,Re=0,Ge=Y,ht=0,Rt=oe;if(_.content&&u){const Oe=_.content,Ct=Oe[2]-Oe[0],St=Oe[3]-Oe[1];(_.textFitWidth||_.textFitHeight)&&(M=nw(s)),ue=ip(D,0,Oe[0]),ve=ip(R,0,Oe[1]),Te=ip(D,Oe[0],Oe[2]),Se=ip(R,Oe[1],Oe[3]),Re=Oe[0]-ue,ht=Oe[1]-ve,Ge=Ct-Te,Rt=St-Se}const ct=M.x1,ot=M.y1,kt=M.x2-ct,vt=M.y2-ot,gt=(Oe,Ct,St,jt)=>{const bn=sp(Oe.stretch-ue,Te,kt,ct),_n=op(Oe.fixed-Re,Ge,Oe.stretch,U),pr=sp(Ct.stretch-ve,Se,vt,ot),hs=op(Ct.fixed-ht,Rt,Ct.stretch,X),Lr=sp(St.stretch-ue,Te,kt,ct),mr=op(St.fixed-Re,Ge,St.stretch,U),ei=sp(jt.stretch-ve,Se,vt,ot),ti=op(jt.fixed-ht,Rt,jt.stretch,X),ni=new k(bn,pr),$n=new k(Lr,pr),gr=new k(Lr,ei),$r=new k(bn,ei),Br=new k(_n/x,hs/x),ri=new k(mr/x,ti/x),Fr=r*Math.PI/180;if(Fr){const un=Math.sin(Fr),Tn=Math.cos(Fr),Dn=[Tn,-un,un,Tn];ni._matMult(Dn),$n._matMult(Dn),$r._matMult(Dn),gr._matMult(Dn)}const Yi=Oe.stretch+Oe.fixed,yi=Ct.stretch+Ct.fixed;return{tl:ni,tr:$n,bl:$r,br:gr,tex:{x:_.paddedRect.x+zc+Yi,y:_.paddedRect.y+zc+yi,w:St.stretch+St.fixed-Yi,h:jt.stretch+jt.fixed-yi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Br,pixelOffsetBR:ri,minFontScaleX:Ge/x/kt,minFontScaleY:Rt/x/vt,isSDF:o}};if(u&&(_.stretchX||_.stretchY)){const Oe=Aw(D,Y,U),Ct=Aw(R,oe,X);for(let St=0;St<Oe.length-1;St++){const jt=Oe[St],bn=Oe[St+1];for(let _n=0;_n<Ct.length-1;_n++)m.push(gt(jt,Ct[_n],bn,Ct[_n+1]))}}else m.push(gt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:T+1}));return m}function ip(s,r,o){let u=0;for(const m of s)u+=Math.max(r,Math.min(o,m[1]))-Math.max(r,Math.min(o,m[0]));return u}function Aw(s,r,o){const u=[{fixed:-zc,stretch:0}];for(const[m,_]of s){const x=u[u.length-1];u.push({fixed:m-x.stretch,stretch:x.stretch}),u.push({fixed:m-x.stretch,stretch:x.stretch+(_-m)})}return u.push({fixed:r+zc,stretch:o}),u}function sp(s,r,o,u){return s/r*o+u}function op(s,r,o,u){return s-r*o/u}class ap{constructor(r,o,u,m,_,x,b,T,M,D){var R;if(this.boxStartIndex=r.length,M){let O=x.top,U=x.bottom;const X=x.collisionPadding;X&&(O-=X[1],U+=X[3]);let Y=U-O;Y>0&&(Y=Math.max(10,Y),this.circleDiameter=Y)}else{const O=!((R=x.image)===null||R===void 0)&&R.content&&(x.image.textFitWidth||x.image.textFitHeight)?nw(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};O.y1=O.y1*b-T[0],O.y2=O.y2*b+T[2],O.x1=O.x1*b-T[3],O.x2=O.x2*b+T[1];const U=x.collisionPadding;if(U&&(O.x1-=U[0]*b,O.y1-=U[1]*b,O.x2+=U[2]*b,O.y2+=U[3]*b),D){const X=new k(O.x1,O.y1),Y=new k(O.x2,O.y1),oe=new k(O.x1,O.y2),ue=new k(O.x2,O.y2),Te=D*Math.PI/180;X._rotate(Te),Y._rotate(Te),oe._rotate(Te),ue._rotate(Te),O.x1=Math.min(X.x,Y.x,oe.x,ue.x),O.x2=Math.max(X.x,Y.x,oe.x,ue.x),O.y1=Math.min(X.y,Y.y,oe.y,ue.y),O.y2=Math.max(X.y,Y.y,oe.y,ue.y)}r.emplaceBack(o.x,o.y,O.x1,O.y1,O.x2,O.y2,u,m,_)}this.boxEndIndex=r.length}}class _M{constructor(r=[],o=(u,m)=>u<m?-1:u>m?1:0){if(this.data=r,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:o,compare:u}=this,m=o[r];for(;r>0;){const _=r-1>>1,x=o[_];if(u(m,x)>=0)break;o[r]=x,r=_}o[r]=m}_down(r){const{data:o,compare:u}=this,m=this.length>>1,_=o[r];for(;r<m;){let x=1+(r<<1);const b=x+1;if(b<this.length&&u(o[b],o[x])<0&&(x=b),u(o[x],_)>=0)break;o[r]=o[x],r=x}o[r]=_}}function xM(s,r=1,o=!1){let u=1/0,m=1/0,_=-1/0,x=-1/0;const b=s[0];for(let U=0;U<b.length;U++){const X=b[U];(!U||X.x<u)&&(u=X.x),(!U||X.y<m)&&(m=X.y),(!U||X.x>_)&&(_=X.x),(!U||X.y>x)&&(x=X.y)}const T=Math.min(_-u,x-m);let M=T/2;const D=new _M([],bM);if(T===0)return new k(u,m);for(let U=u;U<_;U+=T)for(let X=m;X<x;X+=T)D.push(new Rc(U+M,X+M,M,s));let R=function(U){let X=0,Y=0,oe=0;const ue=U[0];for(let Te=0,ve=ue.length,Se=ve-1;Te<ve;Se=Te++){const Re=ue[Te],Ge=ue[Se],ht=Re.x*Ge.y-Ge.x*Re.y;Y+=(Re.x+Ge.x)*ht,oe+=(Re.y+Ge.y)*ht,X+=3*ht}return new Rc(Y/X,oe/X,0,U)}(s),O=D.length;for(;D.length;){const U=D.pop();(U.d>R.d||!R.d)&&(R=U,o&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,O)),U.max-R.d<=r||(M=U.h/2,D.push(new Rc(U.p.x-M,U.p.y-M,M,s)),D.push(new Rc(U.p.x+M,U.p.y-M,M,s)),D.push(new Rc(U.p.x-M,U.p.y+M,M,s)),D.push(new Rc(U.p.x+M,U.p.y+M,M,s)),O+=4)}return o&&(console.log(`num probes: ${O}`),console.log(`best distance: ${R.d}`)),R.p}function bM(s,r){return r.max-s.max}function Rc(s,r,o,u){this.p=new k(s,r),this.h=o,this.d=function(m,_){let x=!1,b=1/0;for(let T=0;T<_.length;T++){const M=_[T];for(let D=0,R=M.length,O=R-1;D<R;O=D++){const U=M[D],X=M[O];U.y>m.y!=X.y>m.y&&m.x<(X.x-U.x)*(m.y-U.y)/(X.y-U.y)+U.x&&(x=!x),b=Math.min(b,fb(m,U,X))}}return(x?1:-1)*Math.sqrt(b)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var Rr;p.aq=void 0,(Rr=p.aq||(p.aq={}))[Rr.center=1]="center",Rr[Rr.left=2]="left",Rr[Rr.right=3]="right",Rr[Rr.top=4]="top",Rr[Rr.bottom=5]="bottom",Rr[Rr["top-left"]=6]="top-left",Rr[Rr["top-right"]=7]="top-right",Rr[Rr["bottom-left"]=8]="bottom-left",Rr[Rr["bottom-right"]=9]="bottom-right";const ma=7,ky=Number.POSITIVE_INFINITY;function Mw(s,r){return r[1]!==ky?function(o,u,m){let _=0,x=0;switch(u=Math.abs(u),m=Math.abs(m),o){case"top-right":case"top-left":case"top":x=m-ma;break;case"bottom-right":case"bottom-left":case"bottom":x=-m+ma}switch(o){case"top-right":case"bottom-right":case"right":_=-u;break;case"top-left":case"bottom-left":case"left":_=u}return[_,x]}(s,r[0],r[1]):function(o,u){let m=0,_=0;u<0&&(u=0);const x=u/Math.SQRT2;switch(o){case"top-right":case"top-left":_=x-ma;break;case"bottom-right":case"bottom-left":_=-x+ma;break;case"bottom":_=-u+ma;break;case"top":_=u-ma}switch(o){case"top-right":case"bottom-right":m=-x;break;case"top-left":case"bottom-left":m=x;break;case"left":m=u;break;case"right":m=-u}return[m,_]}(s,r[0])}function Dw(s,r,o){var u;const m=s.layout,_=(u=m.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(r,{},o);if(_){const b=_.values,T=[];for(let M=0;M<b.length;M+=2){const D=T[M]=b[M],R=b[M+1].map(O=>O*ur);D.startsWith("top")?R[1]-=ma:D.startsWith("bottom")&&(R[1]+=ma),T[M+1]=R}return new Ci(T)}const x=m.get("text-variable-anchor");if(x){let b;b=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(r,{},o)*ur,ky]:m.get("text-offset").evaluate(r,{},o).map(M=>M*ur);const T=[];for(const M of x)T.push(M,Mw(M,b));return new Ci(T)}return null}function Ty(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wM(s,r,o,u,m,_,x,b,T,M,D){let R=_.textMaxSize.evaluate(r,{});R===void 0&&(R=x);const O=s.layers[0].layout,U=O.get("icon-offset").evaluate(r,{},D),X=Rw(o.horizontal),Y=x/24,oe=s.tilePixelRatio*Y,ue=s.tilePixelRatio*R/24,Te=s.tilePixelRatio*b,ve=s.tilePixelRatio*O.get("symbol-spacing"),Se=O.get("text-padding")*s.tilePixelRatio,Re=function(Oe,Ct,St,jt=1){const bn=Oe.get("icon-padding").evaluate(Ct,{},St),_n=bn&&bn.values;return[_n[0]*jt,_n[1]*jt,_n[2]*jt,_n[3]*jt]}(O,r,D,s.tilePixelRatio),Ge=O.get("text-max-angle")/180*Math.PI,ht=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",Rt=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",ct=O.get("symbol-placement"),ot=ve/2,kt=O.get("icon-text-fit");let vt;u&&kt!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(vt=rw(u,o.vertical,kt,O.get("icon-text-fit-padding"),U,Y)),X&&(u=rw(u,X,kt,O.get("icon-text-fit-padding"),U,Y)));const gt=(Oe,Ct)=>{Ct.x<0||Ct.x>=ir||Ct.y<0||Ct.y>=ir||function(St,jt,bn,_n,pr,hs,Lr,mr,ei,ti,ni,$n,gr,$r,Br,ri,Fr,Yi,yi,un,Tn,Dn,zi,Fn,Lc){const Gs=St.addToLineVertexArray(jt,bn);let Ws,ds,Ji,Sr,xo=0,Vh=0,Nw=0,Ow=0,zy=-1,Ry=-1;const bo={};let jw=bc("");if(St.allowVerticalPlacement&&_n.vertical){const Hr=mr.layout.get("text-rotate").evaluate(Tn,{},Fn)+90;Ji=new ap(ei,jt,ti,ni,$n,_n.vertical,gr,$r,Br,Hr),Lr&&(Sr=new ap(ei,jt,ti,ni,$n,Lr,Fr,Yi,Br,Hr))}if(pr){const Hr=mr.layout.get("icon-rotate").evaluate(Tn,{}),Qi=mr.layout.get("icon-text-fit")!=="none",ml=Iw(pr,Hr,zi,Qi),Es=Lr?Iw(Lr,Hr,zi,Qi):void 0;ds=new ap(ei,jt,ti,ni,$n,pr,Fr,Yi,!1,Hr),xo=4*ml.length;const gl=St.iconSizeData;let qs=null;gl.kind==="source"?(qs=[Hs*mr.layout.get("icon-size").evaluate(Tn,{})],qs[0]>da&&ze(`${St.layerIds[0]}: Value for "icon-size" is >= ${Bh}. Reduce your "icon-size".`)):gl.kind==="composite"&&(qs=[Hs*Dn.compositeIconSizes[0].evaluate(Tn,{},Fn),Hs*Dn.compositeIconSizes[1].evaluate(Tn,{},Fn)],(qs[0]>da||qs[1]>da)&&ze(`${St.layerIds[0]}: Value for "icon-size" is >= ${Bh}. Reduce your "icon-size".`)),St.addSymbols(St.icon,ml,qs,un,yi,Tn,p.ah.none,jt,Gs.lineStartIndex,Gs.lineLength,-1,Fn),zy=St.icon.placedSymbolArray.length-1,Es&&(Vh=4*Es.length,St.addSymbols(St.icon,Es,qs,un,yi,Tn,p.ah.vertical,jt,Gs.lineStartIndex,Gs.lineLength,-1,Fn),Ry=St.icon.placedSymbolArray.length-1)}const Vw=Object.keys(_n.horizontal);for(const Hr of Vw){const Qi=_n.horizontal[Hr];if(!Ws){jw=bc(Qi.text);const Es=mr.layout.get("text-rotate").evaluate(Tn,{},Fn);Ws=new ap(ei,jt,ti,ni,$n,Qi,gr,$r,Br,Es)}const ml=Qi.positionedLines.length===1;if(Nw+=zw(St,jt,Qi,hs,mr,Br,Tn,ri,Gs,_n.vertical?p.ah.horizontal:p.ah.horizontalOnly,ml?Vw:[Hr],bo,zy,Dn,Fn),ml)break}_n.vertical&&(Ow+=zw(St,jt,_n.vertical,hs,mr,Br,Tn,ri,Gs,p.ah.vertical,["vertical"],bo,Ry,Dn,Fn));const TM=Ws?Ws.boxStartIndex:St.collisionBoxArray.length,CM=Ws?Ws.boxEndIndex:St.collisionBoxArray.length,EM=Ji?Ji.boxStartIndex:St.collisionBoxArray.length,PM=Ji?Ji.boxEndIndex:St.collisionBoxArray.length,IM=ds?ds.boxStartIndex:St.collisionBoxArray.length,AM=ds?ds.boxEndIndex:St.collisionBoxArray.length,MM=Sr?Sr.boxStartIndex:St.collisionBoxArray.length,DM=Sr?Sr.boxEndIndex:St.collisionBoxArray.length;let Cs=-1;const cp=(Hr,Qi)=>Hr&&Hr.circleDiameter?Math.max(Hr.circleDiameter,Qi):Qi;Cs=cp(Ws,Cs),Cs=cp(Ji,Cs),Cs=cp(ds,Cs),Cs=cp(Sr,Cs);const Uw=Cs>-1?1:0;Uw&&(Cs*=Lc/ur),St.glyphOffsetArray.length>=Dc.MAX_GLYPHS&&ze("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Tn.sortKey!==void 0&&St.addToSortKeyRanges(St.symbolInstances.length,Tn.sortKey);const zM=Dw(mr,Tn,Fn),[RM,LM]=function(Hr,Qi){const ml=Hr.length,Es=Qi==null?void 0:Qi.values;if((Es==null?void 0:Es.length)>0)for(let gl=0;gl<Es.length;gl+=2){const qs=Es[gl+1];Hr.emplaceBack(p.aq[Es[gl]],qs[0],qs[1])}return[ml,Hr.length]}(St.textAnchorOffsets,zM);St.symbolInstances.emplaceBack(jt.x,jt.y,bo.right>=0?bo.right:-1,bo.center>=0?bo.center:-1,bo.left>=0?bo.left:-1,bo.vertical||-1,zy,Ry,jw,TM,CM,EM,PM,IM,AM,MM,DM,ti,Nw,Ow,xo,Vh,Uw,0,gr,Cs,RM,LM)}(s,Ct,Oe,o,u,m,vt,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,oe,[Se,Se,Se,Se],ht,T,Te,Re,Rt,U,r,_,M,D,x)};if(ct==="line")for(const Oe of Sw(r.geometry,0,0,ir,ir)){const Ct=vM(Oe,ve,Ge,o.vertical||X,u,24,ue,s.overscaling,ir);for(const St of Ct)X&&SM(s,X.text,ot,St)||gt(Oe,St)}else if(ct==="line-center"){for(const Oe of r.geometry)if(Oe.length>1){const Ct=yM(Oe,Ge,o.vertical||X,u,24,ue);Ct&&gt(Oe,Ct)}}else if(r.type==="Polygon")for(const Oe of Yl(r.geometry,0)){const Ct=xM(Oe,16);gt(Oe[0],new pa(Ct.x,Ct.y,0))}else if(r.type==="LineString")for(const Oe of r.geometry)gt(Oe,new pa(Oe[0].x,Oe[0].y,0));else if(r.type==="Point")for(const Oe of r.geometry)for(const Ct of Oe)gt([Ct],new pa(Ct.x,Ct.y,0))}function zw(s,r,o,u,m,_,x,b,T,M,D,R,O,U,X){const Y=function(Te,ve,Se,Re,Ge,ht,Rt,ct){const ot=Re.layout.get("text-rotate").evaluate(ht,{})*Math.PI/180,kt=[];for(const vt of ve.positionedLines)for(const gt of vt.positionedGlyphs){if(!gt.rect)continue;const Oe=gt.rect||{};let Ct=Xb+1,St=!0,jt=1,bn=0;const _n=(Ge||ct)&&gt.vertical,pr=gt.metrics.advance*gt.scale/2;if(ct&&ve.verticalizable&&(bn=vt.lineOffset/2-(gt.imageName?-(ur-gt.metrics.width*gt.scale)/2:(gt.scale-1)*ur)),gt.imageName){const un=Rt[gt.imageName];St=un.sdf,jt=un.pixelRatio,Ct=gi/jt}const hs=Ge?[gt.x+pr,gt.y]:[0,0];let Lr=Ge?[0,0]:[gt.x+pr+Se[0],gt.y+Se[1]-bn],mr=[0,0];_n&&(mr=Lr,Lr=[0,0]);const ei=gt.metrics.isDoubleResolution?2:1,ti=(gt.metrics.left-Ct)*gt.scale-pr+Lr[0],ni=(-gt.metrics.top-Ct)*gt.scale+Lr[1],$n=ti+Oe.w/ei*gt.scale/jt,gr=ni+Oe.h/ei*gt.scale/jt,$r=new k(ti,ni),Br=new k($n,ni),ri=new k(ti,gr),Fr=new k($n,gr);if(_n){const un=new k(-pr,pr-Rh),Tn=-Math.PI/2,Dn=ur/2-pr,zi=new k(5-Rh-Dn,-(gt.imageName?Dn:0)),Fn=new k(...mr);$r._rotateAround(Tn,un)._add(zi)._add(Fn),Br._rotateAround(Tn,un)._add(zi)._add(Fn),ri._rotateAround(Tn,un)._add(zi)._add(Fn),Fr._rotateAround(Tn,un)._add(zi)._add(Fn)}if(ot){const un=Math.sin(ot),Tn=Math.cos(ot),Dn=[Tn,-un,un,Tn];$r._matMult(Dn),Br._matMult(Dn),ri._matMult(Dn),Fr._matMult(Dn)}const Yi=new k(0,0),yi=new k(0,0);kt.push({tl:$r,tr:Br,bl:ri,br:Fr,tex:Oe,writingMode:ve.writingMode,glyphOffset:hs,sectionIndex:gt.sectionIndex,isSDF:St,pixelOffsetTL:Yi,pixelOffsetBR:yi,minFontScaleX:0,minFontScaleY:0})}return kt}(0,o,b,m,_,x,u,s.allowVerticalPlacement),oe=s.textSizeData;let ue=null;oe.kind==="source"?(ue=[Hs*m.layout.get("text-size").evaluate(x,{})],ue[0]>da&&ze(`${s.layerIds[0]}: Value for "text-size" is >= ${Bh}. Reduce your "text-size".`)):oe.kind==="composite"&&(ue=[Hs*U.compositeTextSizes[0].evaluate(x,{},X),Hs*U.compositeTextSizes[1].evaluate(x,{},X)],(ue[0]>da||ue[1]>da)&&ze(`${s.layerIds[0]}: Value for "text-size" is >= ${Bh}. Reduce your "text-size".`)),s.addSymbols(s.text,Y,ue,b,_,x,M,r,T.lineStartIndex,T.lineLength,O,X);for(const Te of D)R[Te]=s.text.placedSymbolArray.length-1;return 4*Y.length}function Rw(s){for(const r in s)return s[r];return null}function SM(s,r,o,u){const m=s.compareText;if(r in m){const _=m[r];for(let x=_.length-1;x>=0;x--)if(u.dist(_[x])<o)return!0}else m[r]=[];return m[r].push(u),!1}const Lw=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Cy{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(r,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=u>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const _=Lw[15&u];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[b]=new Uint32Array(r,4,1);return new Cy(b,x,_,r)}constructor(r,o=64,u=Float64Array,m){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const _=Lw.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,b=r*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-b%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+T,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+b+T),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+T,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=r)}add(r,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=r,this.coords[this._pos++]=o,u}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Ey(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,o,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:b}=this,T=[0,_.length-1,0],M=[];for(;T.length;){const D=T.pop()||0,R=T.pop()||0,O=T.pop()||0;if(R-O<=b){for(let oe=O;oe<=R;oe++){const ue=x[2*oe],Te=x[2*oe+1];ue>=r&&ue<=u&&Te>=o&&Te<=m&&M.push(_[oe])}continue}const U=O+R>>1,X=x[2*U],Y=x[2*U+1];X>=r&&X<=u&&Y>=o&&Y<=m&&M.push(_[U]),(D===0?r<=X:o<=Y)&&(T.push(O),T.push(U-1),T.push(1-D)),(D===0?u>=X:m>=Y)&&(T.push(U+1),T.push(R),T.push(1-D))}return M}within(r,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:x}=this,b=[0,m.length-1,0],T=[],M=u*u;for(;b.length;){const D=b.pop()||0,R=b.pop()||0,O=b.pop()||0;if(R-O<=x){for(let oe=O;oe<=R;oe++)Fw(_[2*oe],_[2*oe+1],r,o)<=M&&T.push(m[oe]);continue}const U=O+R>>1,X=_[2*U],Y=_[2*U+1];Fw(X,Y,r,o)<=M&&T.push(m[U]),(D===0?r-u<=X:o-u<=Y)&&(b.push(O),b.push(U-1),b.push(1-D)),(D===0?r+u>=X:o+u>=Y)&&(b.push(U+1),b.push(R),b.push(1-D))}return T}}function Ey(s,r,o,u,m,_){if(m-u<=o)return;const x=u+m>>1;Bw(s,r,x,u,m,_),Ey(s,r,o,u,x-1,1-_),Ey(s,r,o,x+1,m,1-_)}function Bw(s,r,o,u,m,_){for(;m>u;){if(m-u>600){const M=m-u+1,D=o-u+1,R=Math.log(M),O=.5*Math.exp(2*R/3),U=.5*Math.sqrt(R*O*(M-O)/M)*(D-M/2<0?-1:1);Bw(s,r,o,Math.max(u,Math.floor(o-D*O/M+U)),Math.min(m,Math.floor(o+(M-D)*O/M+U)),_)}const x=r[2*o+_];let b=u,T=m;for(Oh(s,r,u,o),r[2*m+_]>x&&Oh(s,r,u,m);b<T;){for(Oh(s,r,b,T),b++,T--;r[2*b+_]<x;)b++;for(;r[2*T+_]>x;)T--}r[2*u+_]===x?Oh(s,r,u,T):(T++,Oh(s,r,T,m)),T<=o&&(u=T+1),o<=T&&(m=T-1)}}function Oh(s,r,o,u){Py(s,o,u),Py(r,2*o,2*u),Py(r,2*o+1,2*u+1)}function Py(s,r,o){const u=s[r];s[r]=s[o],s[o]=u}function Fw(s,r,o,u){const m=s-o,_=r-u;return m*m+_*_}var Iy;p.bg=void 0,(Iy=p.bg||(p.bg={})).create="create",Iy.load="load",Iy.fullLoad="fullLoad";let lp=null,jh=[];const Ay=1e3/60,My="loadTime",Dy="fullLoadTime",kM={mark(s){performance.mark(s)},frame(s){const r=s;lp!=null&&jh.push(r-lp),lp=r},clearMetrics(){lp=null,jh=[],performance.clearMeasures(My),performance.clearMeasures(Dy);for(const s in p.bg)performance.clearMarks(p.bg[s])},getPerformanceMetrics(){performance.measure(My,p.bg.create,p.bg.load),performance.measure(Dy,p.bg.create,p.bg.fullLoad);const s=performance.getEntriesByName(My)[0].duration,r=performance.getEntriesByName(Dy)[0].duration,o=jh.length,u=1/(jh.reduce((_,x)=>_+x,0)/o/1e3),m=jh.filter(_=>_>Ay).reduce((_,x)=>_+(x-Ay)/Ay,0);return{loadTime:s,fullLoadTime:r,fps:u,percentDroppedFrames:m/(o+m)*100,totalFrames:o}}};p.$=class extends B{},p.A=Cc,p.B=jg,p.C=function(s){if(Je==null){const r=s.navigator?s.navigator.userAgent:null;Je=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Je},p.D=bt,p.E=wn,p.F=class{constructor(s,r){this.target=s,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new mM(()=>this.process()),this.subscription=function(o,u,m,_){return o.addEventListener(u,m,!1),{unsubscribe:()=>{o.removeEventListener(u,m,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=Ze(self)?s:window}registerMessageHandler(s,r){this.messageHandlers[s]=r}sendAsync(s,r){return new Promise((o,u)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[m]={resolve:o,reject:u},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[m];const b={id:m,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const _=[],x=Object.assign(Object.assign({},s),{id:m,sourceMapId:this.mapId,origin:location.origin,data:ea(s.data,_)});this.target.postMessage(x,{transfer:_})})}receive(s){const r=s.data,o=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[o];const u=this.abortControllers[o];return delete this.abortControllers[o],void(u&&u.abort())}if(Ze(self)||r.mustQueue)return this.tasks[o]=r,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,r)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),r=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(s,r)}processTask(s,r){return c(this,void 0,void 0,function*(){if(r.type==="<response>"){const m=this.resolveRejects[s];return delete this.resolveRejects[s],m?void(r.error?m.reject(ta(r.error)):m.resolve(ta(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=ta(r.data),u=new AbortController;this.abortControllers[s]=u;try{const m=yield this.messageHandlers[r.type](r.sourceMapId,o,u);this.completeTask(s,null,m)}catch(m){this.completeTask(s,m)}})}completeTask(s,r,o){const u=[];delete this.abortControllers[s];const m={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?ea(r):null,data:ea(o,u)};this.target.postMessage(m,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},p.G=_t,p.H=function(){var s=new Cc(16);return Cc!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},p.I=fy,p.J=function(s,r,o){var u,m,_,x,b,T,M,D,R,O,U,X,Y=o[0],oe=o[1],ue=o[2];return r===s?(s[12]=r[0]*Y+r[4]*oe+r[8]*ue+r[12],s[13]=r[1]*Y+r[5]*oe+r[9]*ue+r[13],s[14]=r[2]*Y+r[6]*oe+r[10]*ue+r[14],s[15]=r[3]*Y+r[7]*oe+r[11]*ue+r[15]):(m=r[1],_=r[2],x=r[3],b=r[4],T=r[5],M=r[6],D=r[7],R=r[8],O=r[9],U=r[10],X=r[11],s[0]=u=r[0],s[1]=m,s[2]=_,s[3]=x,s[4]=b,s[5]=T,s[6]=M,s[7]=D,s[8]=R,s[9]=O,s[10]=U,s[11]=X,s[12]=u*Y+b*oe+R*ue+r[12],s[13]=m*Y+T*oe+O*ue+r[13],s[14]=_*Y+M*oe+U*ue+r[14],s[15]=x*Y+D*oe+X*ue+r[15]),s},p.K=function(s,r,o){var u=o[0],m=o[1],_=o[2];return s[0]=r[0]*u,s[1]=r[1]*u,s[2]=r[2]*u,s[3]=r[3]*u,s[4]=r[4]*m,s[5]=r[5]*m,s[6]=r[6]*m,s[7]=r[7]*m,s[8]=r[8]*_,s[9]=r[9]*_,s[10]=r[10]*_,s[11]=r[11]*_,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},p.L=yb,p.M=function(s,r){const o={};for(let u=0;u<r.length;u++){const m=r[u];m in s&&(o[m]=s[m])}return o},p.N=fa,p.O=dw,p.P=k,p.Q=fw,p.R=Xi,p.S=Ki,p.T=gc,p.U=L,p.V=V,p.W=Ue,p.X=ir,p.Y=w,p.Z=Fh,p._=c,p.a=We,p.a$=function(s,r){var o=s[0],u=s[1],m=s[2],_=s[3],x=s[4],b=s[5],T=s[6],M=s[7],D=s[8],R=s[9],O=s[10],U=s[11],X=s[12],Y=s[13],oe=s[14],ue=s[15],Te=r[0],ve=r[1],Se=r[2],Re=r[3],Ge=r[4],ht=r[5],Rt=r[6],ct=r[7],ot=r[8],kt=r[9],vt=r[10],gt=r[11],Oe=r[12],Ct=r[13],St=r[14],jt=r[15];return Math.abs(o-Te)<=Qr*Math.max(1,Math.abs(o),Math.abs(Te))&&Math.abs(u-ve)<=Qr*Math.max(1,Math.abs(u),Math.abs(ve))&&Math.abs(m-Se)<=Qr*Math.max(1,Math.abs(m),Math.abs(Se))&&Math.abs(_-Re)<=Qr*Math.max(1,Math.abs(_),Math.abs(Re))&&Math.abs(x-Ge)<=Qr*Math.max(1,Math.abs(x),Math.abs(Ge))&&Math.abs(b-ht)<=Qr*Math.max(1,Math.abs(b),Math.abs(ht))&&Math.abs(T-Rt)<=Qr*Math.max(1,Math.abs(T),Math.abs(Rt))&&Math.abs(M-ct)<=Qr*Math.max(1,Math.abs(M),Math.abs(ct))&&Math.abs(D-ot)<=Qr*Math.max(1,Math.abs(D),Math.abs(ot))&&Math.abs(R-kt)<=Qr*Math.max(1,Math.abs(R),Math.abs(kt))&&Math.abs(O-vt)<=Qr*Math.max(1,Math.abs(O),Math.abs(vt))&&Math.abs(U-gt)<=Qr*Math.max(1,Math.abs(U),Math.abs(gt))&&Math.abs(X-Oe)<=Qr*Math.max(1,Math.abs(X),Math.abs(Oe))&&Math.abs(Y-Ct)<=Qr*Math.max(1,Math.abs(Y),Math.abs(Ct))&&Math.abs(oe-St)<=Qr*Math.max(1,Math.abs(oe),Math.abs(St))&&Math.abs(ue-jt)<=Qr*Math.max(1,Math.abs(ue),Math.abs(jt))},p.a0=rn,p.a1=Sy,p.a2=qe,p.a3=s=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(o=>{r.onloadstart=()=>{o(r)};for(const u of s){const m=window.document.createElement("source");Ut(u)||(r.crossOrigin="Anonymous"),m.src=u,r.appendChild(m)}})},p.a4=function(){return ce++},p.a5=ut,p.a6=Dc,p.a7=rh,p.a8=fl,p.a9=_w,p.aA=function(s){if(s.type==="custom")return new pM(s);switch(s.type){case"background":return new hM(s);case"circle":return new JI(s);case"fill":return new mA(s);case"fill-extrusion":return new AA(s);case"heatmap":return new eA(s);case"hillshade":return new nA(s);case"line":return new NA(s);case"raster":return new fM(s);case"symbol":return new rp(s)}},p.aB=Ce,p.aC=function(s,r){if(!s)return[{command:"setStyle",args:[r]}];let o=[];try{if(!Nt(s.version,r.version))return[{command:"setStyle",args:[r]}];Nt(s.center,r.center)||o.push({command:"setCenter",args:[r.center]}),Nt(s.zoom,r.zoom)||o.push({command:"setZoom",args:[r.zoom]}),Nt(s.bearing,r.bearing)||o.push({command:"setBearing",args:[r.bearing]}),Nt(s.pitch,r.pitch)||o.push({command:"setPitch",args:[r.pitch]}),Nt(s.sprite,r.sprite)||o.push({command:"setSprite",args:[r.sprite]}),Nt(s.glyphs,r.glyphs)||o.push({command:"setGlyphs",args:[r.glyphs]}),Nt(s.transition,r.transition)||o.push({command:"setTransition",args:[r.transition]}),Nt(s.light,r.light)||o.push({command:"setLight",args:[r.light]}),Nt(s.terrain,r.terrain)||o.push({command:"setTerrain",args:[r.terrain]}),Nt(s.sky,r.sky)||o.push({command:"setSky",args:[r.sky]}),Nt(s.projection,r.projection)||o.push({command:"setProjection",args:[r.projection]});const u={},m=[];(function(x,b,T,M){let D;for(D in b=b||{},x=x||{})Object.prototype.hasOwnProperty.call(x,D)&&(Object.prototype.hasOwnProperty.call(b,D)||xn(D,T,M));for(D in b)Object.prototype.hasOwnProperty.call(b,D)&&(Object.prototype.hasOwnProperty.call(x,D)?Nt(x[D],b[D])||(x[D].type==="geojson"&&b[D].type==="geojson"&&ci(x,b,D)?Jt(T,{command:"setGeoJSONSourceData",args:[D,b[D].data]}):En(D,b,T,M)):Ir(D,b,T))})(s.sources,r.sources,m,u);const _=[];s.layers&&s.layers.forEach(x=>{"source"in x&&u[x.source]?o.push({command:"removeLayer",args:[x.id]}):_.push(x)}),o=o.concat(m),function(x,b,T){b=b||[];const M=(x=x||[]).map(Xr),D=b.map(Xr),R=x.reduce(Ti,{}),O=b.reduce(Ti,{}),U=M.slice(),X=Object.create(null);let Y,oe,ue,Te,ve;for(let Se=0,Re=0;Se<M.length;Se++)Y=M[Se],Object.prototype.hasOwnProperty.call(O,Y)?Re++:(Jt(T,{command:"removeLayer",args:[Y]}),U.splice(U.indexOf(Y,Re),1));for(let Se=0,Re=0;Se<D.length;Se++)Y=D[D.length-1-Se],U[U.length-1-Se]!==Y&&(Object.prototype.hasOwnProperty.call(R,Y)?(Jt(T,{command:"removeLayer",args:[Y]}),U.splice(U.lastIndexOf(Y,U.length-Re),1)):Re++,Te=U[U.length-Se],Jt(T,{command:"addLayer",args:[O[Y],Te]}),U.splice(U.length-Se,0,Y),X[Y]=!0);for(let Se=0;Se<D.length;Se++)if(Y=D[Se],oe=R[Y],ue=O[Y],!X[Y]&&!Nt(oe,ue))if(Nt(oe.source,ue.source)&&Nt(oe["source-layer"],ue["source-layer"])&&Nt(oe.type,ue.type)){for(ve in er(oe.layout,ue.layout,T,Y,null,"setLayoutProperty"),er(oe.paint,ue.paint,T,Y,null,"setPaintProperty"),Nt(oe.filter,ue.filter)||Jt(T,{command:"setFilter",args:[Y,ue.filter]}),Nt(oe.minzoom,ue.minzoom)&&Nt(oe.maxzoom,ue.maxzoom)||Jt(T,{command:"setLayerZoomRange",args:[Y,ue.minzoom,ue.maxzoom]}),oe)Object.prototype.hasOwnProperty.call(oe,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?er(oe[ve],ue[ve],T,Y,ve.slice(6),"setPaintProperty"):Nt(oe[ve],ue[ve])||Jt(T,{command:"setLayerProperty",args:[Y,ve,ue[ve]]}));for(ve in ue)Object.prototype.hasOwnProperty.call(ue,ve)&&!Object.prototype.hasOwnProperty.call(oe,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?er(oe[ve],ue[ve],T,Y,ve.slice(6),"setPaintProperty"):Nt(oe[ve],ue[ve])||Jt(T,{command:"setLayerProperty",args:[Y,ve,ue[ve]]}))}else Jt(T,{command:"removeLayer",args:[Y]}),Te=U[U.lastIndexOf(Y)+1],Jt(T,{command:"addLayer",args:[ue,Te]})}(_,r.layers,o)}catch(u){console.warn("Unable to compute style diff:",u),o=[{command:"setStyle",args:[r]}]}return o},p.aD=function(s){const r=[],o=s.id;return o===void 0&&r.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&r.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&r.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),r},p.aE=function s(r,o){if(Array.isArray(r)){if(!Array.isArray(o)||r.length!==o.length)return!1;for(let u=0;u<r.length;u++)if(!s(r[u],o[u]))return!1;return!0}if(typeof r=="object"&&r!==null&&o!==null){if(typeof o!="object"||Object.keys(r).length!==Object.keys(o).length)return!1;for(const u in r)if(!s(r[u],o[u]))return!1;return!0}return r===o},p.aF=De,p.aG=Be,p.aH=class extends ul{constructor(s,r){super(s,r),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},p.aI=Hf,p.aJ=class extends ul{constructor(s,r){super(s,r),this.current=HI}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let r=1;r<16;r++)if(s[r]!==this.current[r]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},p.aK=ob,p.aL=ab,p.aM=gn,p.aN=class extends ul{constructor(s,r){super(s,r),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},p.aO=class extends ul{constructor(s,r){super(s,r),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},p.aP=function(s,r,o,u,m,_,x){var b=1/(r-o),T=1/(u-m),M=1/(_-x);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*T,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*M,s[11]=0,s[12]=(r+o)*b,s[13]=(m+u)*T,s[14]=(x+_)*M,s[15]=1,s},p.aQ=YI,p.aR=class extends be{},p.aS=UA,p.aT=class extends Ee{},p.aU=ty,p.aV=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},p.aW=wb,p.aX=Dr,p.aY=Zi,p.aZ=class extends wt{},p.a_=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]&&s[4]===r[4]&&s[5]===r[5]&&s[6]===r[6]&&s[7]===r[7]&&s[8]===r[8]&&s[9]===r[9]&&s[10]===r[10]&&s[11]===r[11]&&s[12]===r[12]&&s[13]===r[13]&&s[14]===r[14]&&s[15]===r[15]},p.aa=function(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,m,_)=>{const x=m||_;return r[u]=!x||x.toLowerCase(),""}),r["max-age"]){const o=parseInt(r["max-age"],10);isNaN(o)?delete r["max-age"]:r["max-age"]=o}return r},p.ab=function(s,r){const o=[];for(const u in s)u in r||o.push(u);return o},p.ac=pe,p.ad=function(s,r,o){var u=Math.sin(o),m=Math.cos(o),_=r[0],x=r[1],b=r[2],T=r[3],M=r[4],D=r[5],R=r[6],O=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=_*m+M*u,s[1]=x*m+D*u,s[2]=b*m+R*u,s[3]=T*m+O*u,s[4]=M*m-_*u,s[5]=D*m-x*u,s[6]=R*m-b*u,s[7]=O*m-T*u,s},p.ae=function(s){var r=new Cc(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},p.af=Zf,p.ag=function(s,r){let o=0,u=0;if(s.kind==="constant")u=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:m,minZoom:_,maxZoom:x}=s,b=m?pe(Yr.interpolationFactor(m,r,_,x),0,1):0;s.kind==="camera"?u=Kr.number(s.minSize,s.maxSize,b):o=b}return{uSizeT:o,uSize:u}},p.ai=function(s,{uSize:r,uSizeT:o},{lowerSize:u,upperSize:m}){return s.kind==="source"?u/Hs:s.kind==="composite"?Kr.number(u/Hs,m/Hs,o):r},p.aj=yy,p.ak=function(s,r,o,u){const m=r.y-s.y,_=r.x-s.x,x=u.y-o.y,b=u.x-o.x,T=x*_-b*m;if(T===0)return null;const M=(b*(s.y-o.y)-x*(s.x-o.x))/T;return new k(s.x+M*_,s.y+M*m)},p.al=Sw,p.am=hb,p.an=Jg,p.ao=function(s){let r=1/0,o=1/0,u=-1/0,m=-1/0;for(const _ of s)r=Math.min(r,_.x),o=Math.min(o,_.y),u=Math.max(u,_.x),m=Math.max(m,_.y);return[r,o,u,m]},p.ap=ur,p.ar=gy,p.as=function(s,r){var o=r[0],u=r[1],m=r[2],_=r[3],x=r[4],b=r[5],T=r[6],M=r[7],D=r[8],R=r[9],O=r[10],U=r[11],X=r[12],Y=r[13],oe=r[14],ue=r[15],Te=o*b-u*x,ve=o*T-m*x,Se=o*M-_*x,Re=u*T-m*b,Ge=u*M-_*b,ht=m*M-_*T,Rt=D*Y-R*X,ct=D*oe-O*X,ot=D*ue-U*X,kt=R*oe-O*Y,vt=R*ue-U*Y,gt=O*ue-U*oe,Oe=Te*gt-ve*vt+Se*kt+Re*ot-Ge*ct+ht*Rt;return Oe?(s[0]=(b*gt-T*vt+M*kt)*(Oe=1/Oe),s[1]=(m*vt-u*gt-_*kt)*Oe,s[2]=(Y*ht-oe*Ge+ue*Re)*Oe,s[3]=(O*Ge-R*ht-U*Re)*Oe,s[4]=(T*ot-x*gt-M*ct)*Oe,s[5]=(o*gt-m*ot+_*ct)*Oe,s[6]=(oe*Se-X*ht-ue*ve)*Oe,s[7]=(D*ht-O*Se+U*ve)*Oe,s[8]=(x*vt-b*ot+M*Rt)*Oe,s[9]=(u*ot-o*vt-_*Rt)*Oe,s[10]=(X*Ge-Y*Se+ue*Te)*Oe,s[11]=(R*Se-D*Ge-U*Te)*Oe,s[12]=(b*ct-x*kt-T*Rt)*Oe,s[13]=(o*kt-u*ct+m*Rt)*Oe,s[14]=(Y*ve-X*Re-oe*Te)*Oe,s[15]=(D*Re-R*ve+O*Te)*Oe,s):null},p.at=Ty,p.au=my,p.av=Cy,p.aw=function(){const s={},r=Pe.$version;for(const o in Pe.$root){const u=Pe.$root[o];if(u.required){let m=null;m=o==="version"?r:u.type==="array"?[]:{},m!=null&&(s[o]=m)}}return s},p.ax=yh,p.ay=dt,p.az=function(s){s=s.slice();const r=Object.create(null);for(let o=0;o<s.length;o++)r[s[o].id]=s[o];for(let o=0;o<s.length;o++)"ref"in s[o]&&(s[o]=dr(s[o],r[s[o].ref]));return s},p.b=$e,p.b0=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},p.b1=function(s,r,o){return s[0]=r[0]*o[0],s[1]=r[1]*o[1],s[2]=r[2]*o[2],s[3]=r[3]*o[3],s},p.b2=function(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]+s[3]*r[3]},p.b3=_e,p.b4=gw,p.b5=pw,p.b6=function(s,r,o,u,m){var _,x=1/Math.tan(r/2);return s[0]=x/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,m!=null&&m!==1/0?(s[10]=(m+u)*(_=1/(u-m)),s[14]=2*m*u*_):(s[10]=-1,s[14]=-2*u),s},p.b7=function(s,r,o){var u=Math.sin(o),m=Math.cos(o),_=r[4],x=r[5],b=r[6],T=r[7],M=r[8],D=r[9],R=r[10],O=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=_*m+M*u,s[5]=x*m+D*u,s[6]=b*m+R*u,s[7]=T*m+O*u,s[8]=M*m-_*u,s[9]=D*m-x*u,s[10]=R*m-b*u,s[11]=O*m-T*u,s},p.b8=W,p.b9=re,p.bA=Ub,p.bB=function(s){return s.message===Le},p.bC=Zo,p.bD=pi,p.ba=function(s){return s*Math.PI/180},p.bb=function(s,r){const{x:o,y:u}=Fh.fromLngLat(r);return!(s<0||s>25||u<0||u>=1||o<0||o>=1)},p.bc=function(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},p.bd=class extends z{},p.be=by,p.bf=kM,p.bh=tt,p.bi=function(s,r){We.REGISTERED_PROTOCOLS[s]=r},p.bj=function(s){delete We.REGISTERED_PROTOCOLS[s]},p.bk=function(s,r){const o={};for(let m=0;m<s.length;m++){const _=r&&r[s[m].id]||Df(s[m]);r&&(r[s[m].id]=_);let x=o[_];x||(x=o[_]=[]),x.push(s[m])}const u=[];for(const m in o)u.push(o[m]);return u},p.bl=yt,p.bm=vw,p.bn=xw,p.bo=Yb,p.bp=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=ir/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const r=s.bucket.layers[0],o=r.layout,u=r._unevaluatedLayout._values,m={layoutIconSize:u["icon-size"].possiblyEvaluate(new Pn(s.bucket.zoom+1),s.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Pn(s.bucket.zoom+1),s.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Pn(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:D}=s.bucket.textSizeData;m.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Pn(M),s.canonical),u["text-size"].possiblyEvaluate(new Pn(D),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:D}=s.bucket.iconSizeData;m.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Pn(M),s.canonical),u["icon-size"].possiblyEvaluate(new Pn(D),s.canonical)]}const _=o.get("text-line-height")*ur,x=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",b=o.get("text-keep-upright"),T=o.get("text-size");for(const M of s.bucket.features){const D=o.get("text-font").evaluate(M,{},s.canonical).join(","),R=T.evaluate(M,{},s.canonical),O=m.layoutTextSize.evaluate(M,{},s.canonical),U=m.layoutIconSize.evaluate(M,{},s.canonical),X={horizontal:{},vertical:void 0},Y=M.text;let oe,ue=[0,0];if(Y){const Se=Y.toString(),Re=o.get("text-letter-spacing").evaluate(M,{},s.canonical)*ur,Ge=Vg(Se)?Re:0,ht=o.get("text-anchor").evaluate(M,{},s.canonical),Rt=Dw(r,M,s.canonical);if(!Rt){const vt=o.get("text-radial-offset").evaluate(M,{},s.canonical);ue=vt?Mw(ht,[vt*ur,ky]):o.get("text-offset").evaluate(M,{},s.canonical).map(gt=>gt*ur)}let ct=x?"center":o.get("text-justify").evaluate(M,{},s.canonical);const ot=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(M,{},s.canonical)*ur:1/0,kt=()=>{s.bucket.allowVerticalPlacement&&vh(Se)&&(X.vertical=ep(Y,s.glyphMap,s.glyphPositions,s.imagePositions,D,ot,_,ht,"left",Ge,ue,p.ah.vertical,!0,O,R))};if(!x&&Rt){const vt=new Set;if(ct==="auto")for(let Oe=0;Oe<Rt.values.length;Oe+=2)vt.add(Ty(Rt.values[Oe]));else vt.add(ct);let gt=!1;for(const Oe of vt)if(!X.horizontal[Oe])if(gt)X.horizontal[Oe]=X.horizontal[0];else{const Ct=ep(Y,s.glyphMap,s.glyphPositions,s.imagePositions,D,ot,_,"center",Oe,Ge,ue,p.ah.horizontal,!1,O,R);Ct&&(X.horizontal[Oe]=Ct,gt=Ct.positionedLines.length===1)}kt()}else{ct==="auto"&&(ct=Ty(ht));const vt=ep(Y,s.glyphMap,s.glyphPositions,s.imagePositions,D,ot,_,ht,ct,Ge,ue,p.ah.horizontal,!1,O,R);vt&&(X.horizontal[ct]=vt),kt(),vh(Se)&&x&&b&&(X.vertical=ep(Y,s.glyphMap,s.glyphPositions,s.imagePositions,D,ot,_,ht,ct,Ge,ue,p.ah.vertical,!1,O,R))}}let Te=!1;if(M.icon&&M.icon.name){const Se=s.imageMap[M.icon.name];Se&&(oe=oM(s.imagePositions[M.icon.name],o.get("icon-offset").evaluate(M,{},s.canonical),o.get("icon-anchor").evaluate(M,{},s.canonical)),Te=!!Se.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=Te:s.bucket.sdfIcons!==Te&&ze("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Se.pixelRatio!==s.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ve=Rw(X.horizontal)||X.vertical;s.bucket.iconsInText=!!ve&&ve.iconsInText,(ve||oe)&&wM(s.bucket,M,X,oe,s.imageMap,m,O,U,ue,Te,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},p.bq=cy,p.br=oy,p.bs=ly,p.bt=ua,p.bu=hy,p.bv=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},p.bw=function(s,r,o,u,m){return c(this,void 0,void 0,function*(){if(V())try{return yield Ue(s,r,o,u,m)}catch{}return function(_,x,b,T,M){const D=_.width,R=_.height;et&&pt||(et=new OffscreenCanvas(D,R),pt=et.getContext("2d",{willReadFrequently:!0})),et.width=D,et.height=R,pt.drawImage(_,0,0,D,R);const O=pt.getImageData(x,b,T,M);return pt.clearRect(0,0,D,R),O.data}(s,r,o,u,m)})},p.bx=yw,p.by=S,p.bz=E,p.c=Ve,p.d=s=>c(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(r)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),p.e=le,p.f=s=>new Promise((r,o)=>{const u=new Image;u.onload=()=>{r(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=ke})},u.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(s)],{type:"image/png"});u.src=s.byteLength?URL.createObjectURL(m):ke}),p.g=He,p.h=(s,r)=>Pt(le(s,{type:"json"}),r),p.i=Ze,p.j=mt,p.k=Wt,p.l=(s,r)=>Pt(le(s,{type:"arrayBuffer"}),r),p.m=Pt,p.n=function(s){return new hy(s).readFields(QA,[])},p.o=Eh,p.p=Kb,p.q=v,p.r=Og,p.s=Ut,p.t=mh,p.u=go,p.v=Pe,p.w=ze,p.x=function([s,r,o]){return r+=90,r*=Math.PI/180,o*=Math.PI/180,{x:s*Math.cos(r)*Math.sin(o),y:s*Math.sin(r)*Math.sin(o),z:s*Math.cos(o)}},p.y=Kr,p.z=Pn}),h("worker",["./shared"],function(p){class c{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,j){for(const ne of N){this._layerConfigs[ne.id]=ne;const me=this._layers[ne.id]=p.aA(ne);me._featureFilter=p.a7(me.filter),this.keyCache[ne.id]&&delete this.keyCache[ne.id]}for(const ne of j)delete this.keyCache[ne],delete this._layerConfigs[ne],delete this._layers[ne];this.familiesBySource={};const K=p.bk(Object.values(this._layerConfigs),this.keyCache);for(const ne of K){const me=ne.map(Ae=>this._layers[Ae.id]),ge=me[0];if(ge.visibility==="none")continue;const xe=ge.source||"";let de=this.familiesBySource[xe];de||(de=this.familiesBySource[xe]={});const Ie=ge.sourceLayer||"_geojsonTileLayer";let Ne=de[Ie];Ne||(Ne=de[Ie]=[]),Ne.push(me)}}}class S{constructor(N){const j={},K=[];for(const xe in N){const de=N[xe],Ie=j[xe]={};for(const Ne in de){const Ae=de[+Ne];if(!Ae||Ae.bitmap.width===0||Ae.bitmap.height===0)continue;const Xe={x:0,y:0,w:Ae.bitmap.width+2,h:Ae.bitmap.height+2};K.push(Xe),Ie[Ne]={rect:Xe,metrics:Ae.metrics}}}const{w:ne,h:me}=p.p(K),ge=new p.o({width:ne||1,height:me||1});for(const xe in N){const de=N[xe];for(const Ie in de){const Ne=de[+Ie];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const Ae=j[xe][Ie].rect;p.o.copy(Ne.bitmap,ge,{x:0,y:0},{x:Ae.x+1,y:Ae.y+1},Ne.bitmap)}}this.image=ge,this.positions=j}}p.bl("GlyphAtlas",S);class E{constructor(N){this.tileID=new p.S(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[]}parse(N,j,K,ne){return p._(this,void 0,void 0,function*(){this.status="parsing",this.data=N,this.collisionBoxArray=new p.a5;const me=new p.bm(Object.keys(N.layers).sort()),ge=new p.bn(this.tileID,this.promoteId);ge.bucketLayerIDs=[];const xe={},de={featureIndex:ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K},Ie=j.familiesBySource[this.source];for(const Xt in Ie){const mn=N.layers[Xt];if(!mn)continue;mn.version===1&&p.w(`Vector tile source "${this.source}" layer "${Xt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Rn=me.encode(Xt),fr=[];for(let br=0;br<mn.length;br++){const jr=mn.feature(br),Fo=ge.getId(jr,Xt);fr.push({feature:jr,id:Fo,index:br,sourceLayerIndex:Rn})}for(const br of Ie[Xt]){const jr=br[0];jr.source!==this.source&&p.w(`layer.source = ${jr.source} does not equal this.source = ${this.source}`),jr.minzoom&&this.zoom<Math.floor(jr.minzoom)||jr.maxzoom&&this.zoom>=jr.maxzoom||jr.visibility!=="none"&&(P(br,this.zoom,K),(xe[jr.id]=jr.createBucket({index:ge.bucketLayerIDs.length,layers:br,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Rn,sourceID:this.source})).populate(fr,de,this.tileID.canonical),ge.bucketLayerIDs.push(br.map(Fo=>Fo.id)))}}const Ne=p.aF(de.glyphDependencies,Xt=>Object.keys(Xt).map(Number));this.inFlightDependencies.forEach(Xt=>Xt==null?void 0:Xt.abort()),this.inFlightDependencies=[];let Ae=Promise.resolve({});if(Object.keys(Ne).length){const Xt=new AbortController;this.inFlightDependencies.push(Xt),Ae=ne.sendAsync({type:"GG",data:{stacks:Ne,source:this.source,tileID:this.tileID,type:"glyphs"}},Xt)}const Xe=Object.keys(de.iconDependencies);let Tt=Promise.resolve({});if(Xe.length){const Xt=new AbortController;this.inFlightDependencies.push(Xt),Tt=ne.sendAsync({type:"GI",data:{icons:Xe,source:this.source,tileID:this.tileID,type:"icons"}},Xt)}const zt=Object.keys(de.patternDependencies);let on=Promise.resolve({});if(zt.length){const Xt=new AbortController;this.inFlightDependencies.push(Xt),on=ne.sendAsync({type:"GI",data:{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"}},Xt)}const[Gt,an,en]=yield Promise.all([Ae,Tt,on]),nr=new S(Gt),Bn=new p.bo(an,en);for(const Xt in xe){const mn=xe[Xt];mn instanceof p.a6?(P(mn.layers,this.zoom,K),p.bp({bucket:mn,glyphMap:Gt,glyphPositions:nr.positions,imageMap:an,imagePositions:Bn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):mn.hasPattern&&(mn instanceof p.bq||mn instanceof p.br||mn instanceof p.bs)&&(P(mn.layers,this.zoom,K),mn.addFeatures(de,this.tileID.canonical,Bn.patternPositions))}return this.status="done",{buckets:Object.values(xe).filter(Xt=>!Xt.isEmpty()),featureIndex:ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:nr.image,imageAtlas:Bn,glyphMap:this.returnDependencies?Gt:null,iconMap:this.returnDependencies?an:null,glyphPositions:this.returnDependencies?nr.positions:null}})}}function P(ie,N,j){const K=new p.z(N);for(const ne of ie)ne.recalculate(K,j)}class k{constructor(N,j,K){this.actor=N,this.layerIndex=j,this.availableImages=K,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(N,j){return p._(this,void 0,void 0,function*(){const K=yield p.l(N.request,j);try{return{vectorTile:new p.bt.VectorTile(new p.bu(K.data)),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(ne){const me=new Uint8Array(K.data);let ge=`Unable to parse the tile at ${N.request.url}, `;throw ge+=me[0]===31&&me[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ne.message}`,new Error(ge)}})}loadTile(N){return p._(this,void 0,void 0,function*(){const j=N.uid,K=!!(N&&N.request&&N.request.collectResourceTiming)&&new p.bv(N.request),ne=new E(N);this.loading[j]=ne;const me=new AbortController;ne.abort=me;try{const ge=yield this.loadVectorTile(N,me);if(delete this.loading[j],!ge)return null;const xe=ge.rawData,de={};ge.expires&&(de.expires=ge.expires),ge.cacheControl&&(de.cacheControl=ge.cacheControl);const Ie={};if(K){const Ae=K.finish();Ae&&(Ie.resourceTiming=JSON.parse(JSON.stringify(Ae)))}ne.vectorTile=ge.vectorTile;const Ne=ne.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[j]=ne,this.fetching[j]={rawTileData:xe,cacheControl:de,resourceTiming:Ie};try{const Ae=yield Ne;return p.e({rawTileData:xe.slice(0)},Ae,de,Ie)}finally{delete this.fetching[j]}}catch(ge){throw delete this.loading[j],ne.status="done",this.loaded[j]=ne,ge}})}reloadTile(N){return p._(this,void 0,void 0,function*(){const j=N.uid;if(!this.loaded||!this.loaded[j])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[j];if(K.showCollisionBoxes=N.showCollisionBoxes,K.status==="parsing"){const ne=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor);let me;if(this.fetching[j]){const{rawTileData:ge,cacheControl:xe,resourceTiming:de}=this.fetching[j];delete this.fetching[j],me=p.e({rawTileData:ge.slice(0)},ne,xe,de)}else me=ne;return me}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(N){return p._(this,void 0,void 0,function*(){const j=this.loading,K=N.uid;j&&j[K]&&j[K].abort&&(j[K].abort.abort(),delete j[K])})}removeTile(N){return p._(this,void 0,void 0,function*(){this.loaded&&this.loaded[N.uid]&&delete this.loaded[N.uid]})}}class I{constructor(){this.loaded={}}loadTile(N){return p._(this,void 0,void 0,function*(){const{uid:j,encoding:K,rawImageData:ne,redFactor:me,greenFactor:ge,blueFactor:xe,baseShift:de}=N,Ie=ne.width+2,Ne=ne.height+2,Ae=p.b(ne)?new p.R({width:Ie,height:Ne},yield p.bw(ne,-1,-1,Ie,Ne)):ne,Xe=new p.bx(j,Ae,K,me,ge,xe,de);return this.loaded=this.loaded||{},this.loaded[j]=Xe,Xe})}removeTile(N){const j=this.loaded,K=N.uid;j&&j[K]&&delete j[K]}}function G(ie,N){if(ie.length!==0){Z(ie[0],N);for(var j=1;j<ie.length;j++)Z(ie[j],!N)}}function Z(ie,N){for(var j=0,K=0,ne=0,me=ie.length,ge=me-1;ne<me;ge=ne++){var xe=(ie[ne][0]-ie[ge][0])*(ie[ge][1]+ie[ne][1]),de=j+xe;K+=Math.abs(j)>=Math.abs(xe)?j-de+xe:xe-de+j,j=de}j+K>=0!=!!N&&ie.reverse()}var H=p.by(function ie(N,j){var K,ne=N&&N.type;if(ne==="FeatureCollection")for(K=0;K<N.features.length;K++)ie(N.features[K],j);else if(ne==="GeometryCollection")for(K=0;K<N.geometries.length;K++)ie(N.geometries[K],j);else if(ne==="Feature")ie(N.geometry,j);else if(ne==="Polygon")G(N.coordinates,j);else if(ne==="MultiPolygon")for(K=0;K<N.coordinates.length;K++)G(N.coordinates[K],j);return N});const te=p.bt.VectorTileFeature.prototype.toGeoJSON;var L={exports:{}},V=p.bz,W=p.bt.VectorTileFeature,re=pe;function pe(ie,N){this.options=N||{},this.features=ie,this.length=ie.length}function _e(ie,N){this.id=typeof ie.id=="number"?ie.id:void 0,this.type=ie.type,this.rawGeometry=ie.type===1?[ie.geometry]:ie.geometry,this.properties=ie.tags,this.extent=N||4096}pe.prototype.feature=function(ie){return new _e(this.features[ie],this.options.extent)},_e.prototype.loadGeometry=function(){var ie=this.rawGeometry;this.geometry=[];for(var N=0;N<ie.length;N++){for(var j=ie[N],K=[],ne=0;ne<j.length;ne++)K.push(new V(j[ne][0],j[ne][1]));this.geometry.push(K)}return this.geometry},_e.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ie=this.geometry,N=1/0,j=-1/0,K=1/0,ne=-1/0,me=0;me<ie.length;me++)for(var ge=ie[me],xe=0;xe<ge.length;xe++){var de=ge[xe];N=Math.min(N,de.x),j=Math.max(j,de.x),K=Math.min(K,de.y),ne=Math.max(ne,de.y)}return[N,K,j,ne]},_e.prototype.toGeoJSON=W.prototype.toGeoJSON;var le=p.bA,ce=re;function De(ie){var N=new le;return function(j,K){for(var ne in j.layers)K.writeMessage(3,Be,j.layers[ne])}(ie,N),N.finish()}function Be(ie,N){var j;N.writeVarintField(15,ie.version||1),N.writeStringField(1,ie.name||""),N.writeVarintField(5,ie.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<ie.length;j++)K.feature=ie.feature(j),N.writeMessage(2,Ce,K);var ne=K.keys;for(j=0;j<ne.length;j++)N.writeStringField(3,ne[j]);var me=K.values;for(j=0;j<me.length;j++)N.writeMessage(4,Je,me[j])}function Ce(ie,N){var j=ie.feature;j.id!==void 0&&N.writeVarintField(1,j.id),N.writeMessage(2,Fe,ie),N.writeVarintField(3,j.type),N.writeMessage(4,Ze,j)}function Fe(ie,N){var j=ie.feature,K=ie.keys,ne=ie.values,me=ie.keycache,ge=ie.valuecache;for(var xe in j.properties){var de=j.properties[xe],Ie=me[xe];if(de!==null){Ie===void 0&&(K.push(xe),me[xe]=Ie=K.length-1),N.writeVarint(Ie);var Ne=typeof de;Ne!=="string"&&Ne!=="boolean"&&Ne!=="number"&&(de=JSON.stringify(de));var Ae=Ne+":"+de,Xe=ge[Ae];Xe===void 0&&(ne.push(de),ge[Ae]=Xe=ne.length-1),N.writeVarint(Xe)}}}function ze(ie,N){return(N<<3)+(7&ie)}function Qe(ie){return ie<<1^ie>>31}function Ze(ie,N){for(var j=ie.loadGeometry(),K=ie.type,ne=0,me=0,ge=j.length,xe=0;xe<ge;xe++){var de=j[xe],Ie=1;K===1&&(Ie=de.length),N.writeVarint(ze(1,Ie));for(var Ne=K===3?de.length-1:de.length,Ae=0;Ae<Ne;Ae++){Ae===1&&K!==1&&N.writeVarint(ze(2,Ne-1));var Xe=de[Ae].x-ne,Tt=de[Ae].y-me;N.writeVarint(Qe(Xe)),N.writeVarint(Qe(Tt)),ne+=Xe,me+=Tt}K===3&&N.writeVarint(ze(7,1))}}function Je(ie,N){var j=typeof ie;j==="string"?N.writeStringField(1,ie):j==="boolean"?N.writeBooleanField(7,ie):j==="number"&&(ie%1!=0?N.writeDoubleField(3,ie):ie<0?N.writeSVarintField(6,ie):N.writeVarintField(5,ie))}L.exports=De,L.exports.fromVectorTileJs=De,L.exports.fromGeojsonVt=function(ie,N){N=N||{};var j={};for(var K in ie)j[K]=new ce(ie[K].features,N),j[K].name=K,j[K].version=N.version,j[K].extent=N.extent;return De({layers:j})},L.exports.GeoJSONWrapper=ce;var $e=p.by(L.exports);const ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ie=>ie},Ue=Math.fround||(et=new Float32Array(1),ie=>(et[0]=+ie,et[0]));var et;const pt=3,Le=5,Ve=6;class We{constructor(N){this.options=Object.assign(Object.create(ke),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:j,minZoom:K,maxZoom:ne}=this.options;j&&console.time("total time");const me=`prepare ${N.length} points`;j&&console.time(me),this.points=N;const ge=[];for(let de=0;de<N.length;de++){const Ie=N[de];if(!Ie.geometry)continue;const[Ne,Ae]=Ie.geometry.coordinates,Xe=Ue(tt(Ne)),Tt=Ue(dt(Ae));ge.push(Xe,Tt,1/0,de,-1,1),this.options.reduce&&ge.push(0)}let xe=this.trees[ne+1]=this._createTree(ge);j&&console.timeEnd(me);for(let de=ne;de>=K;de--){const Ie=+Date.now();xe=this.trees[de]=this._createTree(this._cluster(xe,de)),j&&console.log("z%d: %d clusters in %dms",de,xe.numItems,+Date.now()-Ie)}return j&&console.timeEnd("total time"),this}getClusters(N,j){let K=((N[0]+180)%360+360)%360-180;const ne=Math.max(-90,Math.min(90,N[1]));let me=N[2]===180?180:((N[2]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)K=-180,me=180;else if(K>me){const Ae=this.getClusters([K,ne,180,ge],j),Xe=this.getClusters([-180,ne,me,ge],j);return Ae.concat(Xe)}const xe=this.trees[this._limitZoom(j)],de=xe.range(tt(K),dt(ge),tt(me),dt(ne)),Ie=xe.data,Ne=[];for(const Ae of de){const Xe=this.stride*Ae;Ne.push(Ie[Xe+Le]>1?He(Ie,Xe,this.clusterProps):this.points[Ie[Xe+pt]])}return Ne}getChildren(N){const j=this._getOriginId(N),K=this._getOriginZoom(N),ne="No cluster with the specified id.",me=this.trees[K];if(!me)throw new Error(ne);const ge=me.data;if(j*this.stride>=ge.length)throw new Error(ne);const xe=this.options.radius/(this.options.extent*Math.pow(2,K-1)),de=me.within(ge[j*this.stride],ge[j*this.stride+1],xe),Ie=[];for(const Ne of de){const Ae=Ne*this.stride;ge[Ae+4]===N&&Ie.push(ge[Ae+Le]>1?He(ge,Ae,this.clusterProps):this.points[ge[Ae+pt]])}if(Ie.length===0)throw new Error(ne);return Ie}getLeaves(N,j,K){const ne=[];return this._appendLeaves(ne,N,j=j||10,K=K||0,0),ne}getTile(N,j,K){const ne=this.trees[this._limitZoom(N)],me=Math.pow(2,N),{extent:ge,radius:xe}=this.options,de=xe/ge,Ie=(K-de)/me,Ne=(K+1+de)/me,Ae={features:[]};return this._addTileFeatures(ne.range((j-de)/me,Ie,(j+1+de)/me,Ne),ne.data,j,K,me,Ae),j===0&&this._addTileFeatures(ne.range(1-de/me,Ie,1,Ne),ne.data,me,K,me,Ae),j===me-1&&this._addTileFeatures(ne.range(0,Ie,de/me,Ne),ne.data,-1,K,me,Ae),Ae.features.length?Ae:null}getClusterExpansionZoom(N){let j=this._getOriginZoom(N)-1;for(;j<=this.options.maxZoom;){const K=this.getChildren(N);if(j++,K.length!==1)break;N=K[0].properties.cluster_id}return j}_appendLeaves(N,j,K,ne,me){const ge=this.getChildren(j);for(const xe of ge){const de=xe.properties;if(de&&de.cluster?me+de.point_count<=ne?me+=de.point_count:me=this._appendLeaves(N,de.cluster_id,K,ne,me):me<ne?me++:N.push(xe),N.length===K)break}return me}_createTree(N){const j=new p.av(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<N.length;K+=this.stride)j.add(N[K],N[K+1]);return j.finish(),j.data=N,j}_addTileFeatures(N,j,K,ne,me,ge){for(const xe of N){const de=xe*this.stride,Ie=j[de+Le]>1;let Ne,Ae,Xe;if(Ie)Ne=_t(j,de,this.clusterProps),Ae=j[de],Xe=j[de+1];else{const on=this.points[j[de+pt]];Ne=on.properties;const[Gt,an]=on.geometry.coordinates;Ae=tt(Gt),Xe=dt(an)}const Tt={type:1,geometry:[[Math.round(this.options.extent*(Ae*me-K)),Math.round(this.options.extent*(Xe*me-ne))]],tags:Ne};let zt;zt=Ie||this.options.generateId?j[de+pt]:this.points[j[de+pt]].id,zt!==void 0&&(Tt.id=zt),ge.features.push(Tt)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,j){const{radius:K,extent:ne,reduce:me,minPoints:ge}=this.options,xe=K/(ne*Math.pow(2,j)),de=N.data,Ie=[],Ne=this.stride;for(let Ae=0;Ae<de.length;Ae+=Ne){if(de[Ae+2]<=j)continue;de[Ae+2]=j;const Xe=de[Ae],Tt=de[Ae+1],zt=N.within(de[Ae],de[Ae+1],xe),on=de[Ae+Le];let Gt=on;for(const an of zt){const en=an*Ne;de[en+2]>j&&(Gt+=de[en+Le])}if(Gt>on&&Gt>=ge){let an,en=Xe*on,nr=Tt*on,Bn=-1;const Xt=((Ae/Ne|0)<<5)+(j+1)+this.points.length;for(const mn of zt){const Rn=mn*Ne;if(de[Rn+2]<=j)continue;de[Rn+2]=j;const fr=de[Rn+Le];en+=de[Rn]*fr,nr+=de[Rn+1]*fr,de[Rn+4]=Xt,me&&(an||(an=this._map(de,Ae,!0),Bn=this.clusterProps.length,this.clusterProps.push(an)),me(an,this._map(de,Rn)))}de[Ae+4]=Xt,Ie.push(en/Gt,nr/Gt,1/0,Xt,-1,Gt),me&&Ie.push(Bn)}else{for(let an=0;an<Ne;an++)Ie.push(de[Ae+an]);if(Gt>1)for(const an of zt){const en=an*Ne;if(!(de[en+2]<=j)){de[en+2]=j;for(let nr=0;nr<Ne;nr++)Ie.push(de[en+nr])}}}}return Ie}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,j,K){if(N[j+Le]>1){const ge=this.clusterProps[N[j+Ve]];return K?Object.assign({},ge):ge}const ne=this.points[N[j+pt]].properties,me=this.options.map(ne);return K&&me===ne?Object.assign({},me):me}}function He(ie,N,j){return{type:"Feature",id:ie[N+pt],properties:_t(ie,N,j),geometry:{type:"Point",coordinates:[(K=ie[N],360*(K-.5)),Pt(ie[N+1])]}};var K}function _t(ie,N,j){const K=ie[N+Le],ne=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,me=ie[N+Ve],ge=me===-1?{}:Object.assign({},j[me]);return Object.assign(ge,{cluster:!0,cluster_id:ie[N+pt],point_count:K,point_count_abbreviated:ne})}function tt(ie){return ie/360+.5}function dt(ie){const N=Math.sin(ie*Math.PI/180),j=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return j<0?0:j>1?1:j}function Pt(ie){const N=(180-360*ie)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Ut(ie,N,j,K){let ne=K;const me=N+(j-N>>1);let ge,xe=j-N;const de=ie[N],Ie=ie[N+1],Ne=ie[j],Ae=ie[j+1];for(let Xe=N+3;Xe<j;Xe+=3){const Tt=Ft(ie[Xe],ie[Xe+1],de,Ie,Ne,Ae);if(Tt>ne)ge=Xe,ne=Tt;else if(Tt===ne){const zt=Math.abs(Xe-me);zt<xe&&(ge=Xe,xe=zt)}}ne>K&&(ge-N>3&&Ut(ie,N,ge,K),ie[ge+2]=ne,j-ge>3&&Ut(ie,ge,j,K))}function Ft(ie,N,j,K,ne,me){let ge=ne-j,xe=me-K;if(ge!==0||xe!==0){const de=((ie-j)*ge+(N-K)*xe)/(ge*ge+xe*xe);de>1?(j=ne,K=me):de>0&&(j+=ge*de,K+=xe*de)}return ge=ie-j,xe=N-K,ge*ge+xe*xe}function at(ie,N,j,K){const ne={id:ie??null,type:N,geometry:j,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(N==="Point"||N==="MultiPoint"||N==="LineString")Wt(ne,j);else if(N==="Polygon")Wt(ne,j[0]);else if(N==="MultiLineString")for(const me of j)Wt(ne,me);else if(N==="MultiPolygon")for(const me of j)Wt(ne,me[0]);return ne}function Wt(ie,N){for(let j=0;j<N.length;j+=3)ie.minX=Math.min(ie.minX,N[j]),ie.minY=Math.min(ie.minY,N[j+1]),ie.maxX=Math.max(ie.maxX,N[j]),ie.maxY=Math.max(ie.maxY,N[j+1])}function mt(ie,N,j,K){if(!N.geometry)return;const ne=N.geometry.coordinates;if(ne&&ne.length===0)return;const me=N.geometry.type,ge=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2);let xe=[],de=N.id;if(j.promoteId?de=N.properties[j.promoteId]:j.generateId&&(de=K||0),me==="Point")wn(ne,xe);else if(me==="MultiPoint")for(const Ie of ne)wn(Ie,xe);else if(me==="LineString")Pe(ne,xe,ge,!1);else if(me==="MultiLineString"){if(j.lineMetrics){for(const Ie of ne)xe=[],Pe(Ie,xe,ge,!1),ie.push(at(de,"LineString",xe,N.properties));return}Sn(ne,xe,ge,!1)}else if(me==="Polygon")Sn(ne,xe,ge,!0);else{if(me!=="MultiPolygon"){if(me==="GeometryCollection"){for(const Ie of N.geometry.geometries)mt(ie,{id:de,geometry:Ie,properties:N.properties},j,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ie of ne){const Ne=[];Sn(Ie,Ne,ge,!0),xe.push(Ne)}}ie.push(at(de,me,xe,N.properties))}function wn(ie,N){N.push(dr(ie[0]),Nt(ie[1]),0)}function Pe(ie,N,j,K){let ne,me,ge=0;for(let de=0;de<ie.length;de++){const Ie=dr(ie[de][0]),Ne=Nt(ie[de][1]);N.push(Ie,Ne,0),de>0&&(ge+=K?(ne*Ne-Ie*me)/2:Math.sqrt(Math.pow(Ie-ne,2)+Math.pow(Ne-me,2))),ne=Ie,me=Ne}const xe=N.length-3;N[2]=1,Ut(N,0,xe,j),N[xe+2]=1,N.size=Math.abs(ge),N.start=0,N.end=N.size}function Sn(ie,N,j,K){for(let ne=0;ne<ie.length;ne++){const me=[];Pe(ie[ne],me,j,K),N.push(me)}}function dr(ie){return ie/360+.5}function Nt(ie){const N=Math.sin(ie*Math.PI/180),j=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return j<0?0:j>1?1:j}function Jt(ie,N,j,K,ne,me,ge,xe){if(K/=N,me>=(j/=N)&&ge<K)return ie;if(ge<j||me>=K)return null;const de=[];for(const Ie of ie){const Ne=Ie.geometry;let Ae=Ie.type;const Xe=ne===0?Ie.minX:Ie.minY,Tt=ne===0?Ie.maxX:Ie.maxY;if(Xe>=j&&Tt<K){de.push(Ie);continue}if(Tt<j||Xe>=K)continue;let zt=[];if(Ae==="Point"||Ae==="MultiPoint")Ir(Ne,zt,j,K,ne);else if(Ae==="LineString")xn(Ne,zt,j,K,ne,!1,xe.lineMetrics);else if(Ae==="MultiLineString")ci(Ne,zt,j,K,ne,!1);else if(Ae==="Polygon")ci(Ne,zt,j,K,ne,!0);else if(Ae==="MultiPolygon")for(const on of Ne){const Gt=[];ci(on,Gt,j,K,ne,!0),Gt.length&&zt.push(Gt)}if(zt.length){if(xe.lineMetrics&&Ae==="LineString"){for(const on of zt)de.push(at(Ie.id,Ae,on,Ie.tags));continue}Ae!=="LineString"&&Ae!=="MultiLineString"||(zt.length===1?(Ae="LineString",zt=zt[0]):Ae="MultiLineString"),Ae!=="Point"&&Ae!=="MultiPoint"||(Ae=zt.length===3?"Point":"MultiPoint"),de.push(at(Ie.id,Ae,zt,Ie.tags))}}return de.length?de:null}function Ir(ie,N,j,K,ne){for(let me=0;me<ie.length;me+=3){const ge=ie[me+ne];ge>=j&&ge<=K&&er(N,ie[me],ie[me+1],ie[me+2])}}function xn(ie,N,j,K,ne,me,ge){let xe=En(ie);const de=ne===0?Xr:Ti;let Ie,Ne,Ae=ie.start;for(let Gt=0;Gt<ie.length-3;Gt+=3){const an=ie[Gt],en=ie[Gt+1],nr=ie[Gt+2],Bn=ie[Gt+3],Xt=ie[Gt+4],mn=ne===0?an:en,Rn=ne===0?Bn:Xt;let fr=!1;ge&&(Ie=Math.sqrt(Math.pow(an-Bn,2)+Math.pow(en-Xt,2))),mn<j?Rn>j&&(Ne=de(xe,an,en,Bn,Xt,j),ge&&(xe.start=Ae+Ie*Ne)):mn>K?Rn<K&&(Ne=de(xe,an,en,Bn,Xt,K),ge&&(xe.start=Ae+Ie*Ne)):er(xe,an,en,nr),Rn<j&&mn>=j&&(Ne=de(xe,an,en,Bn,Xt,j),fr=!0),Rn>K&&mn<=K&&(Ne=de(xe,an,en,Bn,Xt,K),fr=!0),!me&&fr&&(ge&&(xe.end=Ae+Ie*Ne),N.push(xe),xe=En(ie)),ge&&(Ae+=Ie)}let Xe=ie.length-3;const Tt=ie[Xe],zt=ie[Xe+1],on=ne===0?Tt:zt;on>=j&&on<=K&&er(xe,Tt,zt,ie[Xe+2]),Xe=xe.length-3,me&&Xe>=3&&(xe[Xe]!==xe[0]||xe[Xe+1]!==xe[1])&&er(xe,xe[0],xe[1],xe[2]),xe.length&&N.push(xe)}function En(ie){const N=[];return N.size=ie.size,N.start=ie.start,N.end=ie.end,N}function ci(ie,N,j,K,ne,me){for(const ge of ie)xn(ge,N,j,K,ne,me,!1)}function er(ie,N,j,K){ie.push(N,j,K)}function Xr(ie,N,j,K,ne,me){const ge=(me-N)/(K-N);return er(ie,me,j+(ne-j)*ge,1),ge}function Ti(ie,N,j,K,ne,me){const ge=(me-j)/(ne-j);return er(ie,N+(K-N)*ge,me,1),ge}function qe(ie,N){const j=[];for(let K=0;K<ie.length;K++){const ne=ie[K],me=ne.type;let ge;if(me==="Point"||me==="MultiPoint"||me==="LineString")ge=tr(ne.geometry,N);else if(me==="MultiLineString"||me==="Polygon"){ge=[];for(const xe of ne.geometry)ge.push(tr(xe,N))}else if(me==="MultiPolygon"){ge=[];for(const xe of ne.geometry){const de=[];for(const Ie of xe)de.push(tr(Ie,N));ge.push(de)}}j.push(at(ne.id,me,ge,ne.tags))}return j}function tr(ie,N){const j=[];j.size=ie.size,ie.start!==void 0&&(j.start=ie.start,j.end=ie.end);for(let K=0;K<ie.length;K+=3)j.push(ie[K]+N,ie[K+1],ie[K+2]);return j}function dn(ie,N){if(ie.transformed)return ie;const j=1<<ie.z,K=ie.x,ne=ie.y;for(const me of ie.features){const ge=me.geometry,xe=me.type;if(me.geometry=[],xe===1)for(let de=0;de<ge.length;de+=2)me.geometry.push(cr(ge[de],ge[de+1],N,j,K,ne));else for(let de=0;de<ge.length;de++){const Ie=[];for(let Ne=0;Ne<ge[de].length;Ne+=2)Ie.push(cr(ge[de][Ne],ge[de][Ne+1],N,j,K,ne));me.geometry.push(Ie)}}return ie.transformed=!0,ie}function cr(ie,N,j,K,ne,me){return[Math.round(j*(ie*K-ne)),Math.round(j*(N*K-me))]}function zn(ie,N,j,K,ne){const me=N===ne.maxZoom?0:ne.tolerance/((1<<N)*ne.extent),ge={features:[],numPoints:0,numSimplified:0,numFeatures:ie.length,source:null,x:j,y:K,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const xe of ie)Ye(ge,xe,me,ne);return ge}function Ye(ie,N,j,K){const ne=N.geometry,me=N.type,ge=[];if(ie.minX=Math.min(ie.minX,N.minX),ie.minY=Math.min(ie.minY,N.minY),ie.maxX=Math.max(ie.maxX,N.maxX),ie.maxY=Math.max(ie.maxY,N.maxY),me==="Point"||me==="MultiPoint")for(let xe=0;xe<ne.length;xe+=3)ge.push(ne[xe],ne[xe+1]),ie.numPoints++,ie.numSimplified++;else if(me==="LineString")$t(ge,ne,ie,j,!1,!1);else if(me==="MultiLineString"||me==="Polygon")for(let xe=0;xe<ne.length;xe++)$t(ge,ne[xe],ie,j,me==="Polygon",xe===0);else if(me==="MultiPolygon")for(let xe=0;xe<ne.length;xe++){const de=ne[xe];for(let Ie=0;Ie<de.length;Ie++)$t(ge,de[Ie],ie,j,!0,Ie===0)}if(ge.length){let xe=N.tags||null;if(me==="LineString"&&K.lineMetrics){xe={};for(const Ie in N.tags)xe[Ie]=N.tags[Ie];xe.mapbox_clip_start=ne.start/ne.size,xe.mapbox_clip_end=ne.end/ne.size}const de={geometry:ge,type:me==="Polygon"||me==="MultiPolygon"?3:me==="LineString"||me==="MultiLineString"?2:1,tags:xe};N.id!==null&&(de.id=N.id),ie.features.push(de)}}function $t(ie,N,j,K,ne,me){const ge=K*K;if(K>0&&N.size<(ne?ge:K))return void(j.numPoints+=N.length/3);const xe=[];for(let de=0;de<N.length;de+=3)(K===0||N[de+2]>ge)&&(j.numSimplified++,xe.push(N[de],N[de+1])),j.numPoints++;ne&&function(de,Ie){let Ne=0;for(let Ae=0,Xe=de.length,Tt=Xe-2;Ae<Xe;Tt=Ae,Ae+=2)Ne+=(de[Ae]-de[Tt])*(de[Ae+1]+de[Tt+1]);if(Ne>0===Ie)for(let Ae=0,Xe=de.length;Ae<Xe/2;Ae+=2){const Tt=de[Ae],zt=de[Ae+1];de[Ae]=de[Xe-2-Ae],de[Ae+1]=de[Xe-1-Ae],de[Xe-2-Ae]=Tt,de[Xe-1-Ae]=zt}}(xe,me),ie.push(xe)}const Dt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Gn{constructor(N,j){const K=(j=this.options=function(me,ge){for(const xe in ge)me[xe]=ge[xe];return me}(Object.create(Dt),j)).debug;if(K&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");let ne=function(me,ge){const xe=[];if(me.type==="FeatureCollection")for(let de=0;de<me.features.length;de++)mt(xe,me.features[de],ge,de);else mt(xe,me.type==="Feature"?me:{geometry:me},ge);return xe}(N,j);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(me,ge){const xe=ge.buffer/ge.extent;let de=me;const Ie=Jt(me,1,-1-xe,xe,0,-1,2,ge),Ne=Jt(me,1,1-xe,2+xe,0,-1,2,ge);return(Ie||Ne)&&(de=Jt(me,1,-xe,1+xe,0,-1,2,ge)||[],Ie&&(de=qe(Ie,1).concat(de)),Ne&&(de=de.concat(qe(Ne,-1)))),de}(ne,j),ne.length&&this.splitTile(ne,0,0,0),K&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(N,j,K,ne,me,ge,xe){const de=[N,j,K,ne],Ie=this.options,Ne=Ie.debug;for(;de.length;){ne=de.pop(),K=de.pop(),j=de.pop(),N=de.pop();const Ae=1<<j,Xe=xr(j,K,ne);let Tt=this.tiles[Xe];if(!Tt&&(Ne>1&&console.time("creation"),Tt=this.tiles[Xe]=zn(N,j,K,ne,Ie),this.tileCoords.push({z:j,x:K,y:ne}),Ne)){Ne>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,K,ne,Tt.numFeatures,Tt.numPoints,Tt.numSimplified),console.timeEnd("creation"));const fr=`z${j}`;this.stats[fr]=(this.stats[fr]||0)+1,this.total++}if(Tt.source=N,me==null){if(j===Ie.indexMaxZoom||Tt.numPoints<=Ie.indexMaxPoints)continue}else{if(j===Ie.maxZoom||j===me)continue;if(me!=null){const fr=me-j;if(K!==ge>>fr||ne!==xe>>fr)continue}}if(Tt.source=null,N.length===0)continue;Ne>1&&console.time("clipping");const zt=.5*Ie.buffer/Ie.extent,on=.5-zt,Gt=.5+zt,an=1+zt;let en=null,nr=null,Bn=null,Xt=null,mn=Jt(N,Ae,K-zt,K+Gt,0,Tt.minX,Tt.maxX,Ie),Rn=Jt(N,Ae,K+on,K+an,0,Tt.minX,Tt.maxX,Ie);N=null,mn&&(en=Jt(mn,Ae,ne-zt,ne+Gt,1,Tt.minY,Tt.maxY,Ie),nr=Jt(mn,Ae,ne+on,ne+an,1,Tt.minY,Tt.maxY,Ie),mn=null),Rn&&(Bn=Jt(Rn,Ae,ne-zt,ne+Gt,1,Tt.minY,Tt.maxY,Ie),Xt=Jt(Rn,Ae,ne+on,ne+an,1,Tt.minY,Tt.maxY,Ie),Rn=null),Ne>1&&console.timeEnd("clipping"),de.push(en||[],j+1,2*K,2*ne),de.push(nr||[],j+1,2*K,2*ne+1),de.push(Bn||[],j+1,2*K+1,2*ne),de.push(Xt||[],j+1,2*K+1,2*ne+1)}}getTile(N,j,K){N=+N,j=+j,K=+K;const ne=this.options,{extent:me,debug:ge}=ne;if(N<0||N>24)return null;const xe=1<<N,de=xr(N,j=j+xe&xe-1,K);if(this.tiles[de])return dn(this.tiles[de],me);ge>1&&console.log("drilling down to z%d-%d-%d",N,j,K);let Ie,Ne=N,Ae=j,Xe=K;for(;!Ie&&Ne>0;)Ne--,Ae>>=1,Xe>>=1,Ie=this.tiles[xr(Ne,Ae,Xe)];return Ie&&Ie.source?(ge>1&&(console.log("found parent tile z%d-%d-%d",Ne,Ae,Xe),console.time("drilling down")),this.splitTile(Ie.source,Ne,Ae,Xe,N,j,K),ge>1&&console.timeEnd("drilling down"),this.tiles[de]?dn(this.tiles[de],me):null):null}}function xr(ie,N,j){return 32*((1<<ie)*j+N)+ie}function Bt(ie,N){return N?ie.properties[N]:ie.id}function xt(ie,N){if(ie==null)return!0;if(ie.type==="Feature")return Bt(ie,N)!=null;if(ie.type==="FeatureCollection"){const j=new Set;for(const K of ie.features){const ne=Bt(K,N);if(ne==null||j.has(ne))return!1;j.add(ne)}return!0}return!1}function Zt(ie,N){const j=new Map;if(ie!=null)if(ie.type==="Feature")j.set(Bt(ie,N),ie);else for(const K of ie.features)j.set(Bt(K,N),K);return j}class Qt extends k{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(N,j){return p._(this,void 0,void 0,function*(){const K=N.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ne=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!ne)return null;const me=new class{constructor(xe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.X,this.length=xe.length,this._features=xe}feature(xe){return new class{constructor(de){this._feature=de,this.extent=p.X,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const Ie of this._feature.geometry)de.push([new p.P(Ie[0],Ie[1])]);return de}{const de=[];for(const Ie of this._feature.geometry){const Ne=[];for(const Ae of Ie)Ne.push(new p.P(Ae[0],Ae[1]));de.push(Ne)}return de}}toGeoJSON(de,Ie,Ne){return te.call(this,de,Ie,Ne)}}(this._features[xe])}}(ne.features);let ge=$e(me);return ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),{vectorTile:me,rawData:ge.buffer}})}loadData(N){return p._(this,void 0,void 0,function*(){var j;(j=this._pendingRequest)===null||j===void 0||j.abort();const K=!!(N&&N.request&&N.request.collectResourceTiming)&&new p.bv(N.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(N,this._pendingRequest),this._geoJSONIndex=N.cluster?new We(function({superclusterOptions:ge,clusterProperties:xe}){if(!xe||!ge)return ge;const de={},Ie={},Ne={accumulated:null,zoom:0},Ae={properties:null},Xe=Object.keys(xe);for(const Tt of Xe){const[zt,on]=xe[Tt],Gt=p.bC(on),an=p.bC(typeof zt=="string"?[zt,["accumulated"],["get",Tt]]:zt);de[Tt]=Gt.value,Ie[Tt]=an.value}return ge.map=Tt=>{Ae.properties=Tt;const zt={};for(const on of Xe)zt[on]=de[on].evaluate(Ne,Ae);return zt},ge.reduce=(Tt,zt)=>{Ae.properties=zt;for(const on of Xe)Ne.accumulated=Tt[on],Tt[on]=Ie[on].evaluate(Ne,Ae)},ge}(N)).load((yield this._pendingData).features):(ne=yield this._pendingData,new Gn(ne,N.geojsonVtOptions)),this.loaded={};const me={};if(K){const ge=K.finish();ge&&(me.resourceTiming={},me.resourceTiming[N.source]=JSON.parse(JSON.stringify(ge)))}return me}catch(me){if(delete this._pendingRequest,p.bB(me))return{abandoned:!0};throw me}var ne})}getData(){return p._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(N){const j=this.loaded;return j&&j[N.uid]?super.reloadTile(N):this.loadTile(N)}loadAndProcessGeoJSON(N,j){return p._(this,void 0,void 0,function*(){let K=yield this.loadGeoJSON(N,j);if(delete this._pendingRequest,typeof K!="object")throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(H(K,!0),N.filter){const ne=p.bC(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ne.result==="error")throw new Error(ne.value.map(ge=>`${ge.key}: ${ge.message}`).join(", "));K={type:"FeatureCollection",features:K.features.filter(ge=>ne.value.evaluate({zoom:0},ge))}}return K})}loadGeoJSON(N,j){return p._(this,void 0,void 0,function*(){const{promoteId:K}=N;if(N.request){const ne=yield p.h(N.request,j);return this._dataUpdateable=xt(ne.data,K)?Zt(ne.data,K):void 0,ne.data}if(typeof N.data=="string")try{const ne=JSON.parse(N.data);return this._dataUpdateable=xt(ne,K)?Zt(ne,K):void 0,ne}catch{throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`)}if(!N.dataDiff)throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${N.source}`);return function(ne,me,ge){var xe,de,Ie,Ne;if(me.removeAll&&ne.clear(),me.remove)for(const Ae of me.remove)ne.delete(Ae);if(me.add)for(const Ae of me.add){const Xe=Bt(Ae,ge);Xe!=null&&ne.set(Xe,Ae)}if(me.update)for(const Ae of me.update){let Xe=ne.get(Ae.id);if(Xe==null)continue;const Tt=!Ae.removeAllProperties&&(((xe=Ae.removeProperties)===null||xe===void 0?void 0:xe.length)>0||((de=Ae.addOrUpdateProperties)===null||de===void 0?void 0:de.length)>0);if((Ae.newGeometry||Ae.removeAllProperties||Tt)&&(Xe=Object.assign({},Xe),ne.set(Ae.id,Xe),Tt&&(Xe.properties=Object.assign({},Xe.properties))),Ae.newGeometry&&(Xe.geometry=Ae.newGeometry),Ae.removeAllProperties)Xe.properties={};else if(((Ie=Ae.removeProperties)===null||Ie===void 0?void 0:Ie.length)>0)for(const zt of Ae.removeProperties)Object.prototype.hasOwnProperty.call(Xe.properties,zt)&&delete Xe.properties[zt];if(((Ne=Ae.addOrUpdateProperties)===null||Ne===void 0?void 0:Ne.length)>0)for(const{key:zt,value:on}of Ae.addOrUpdateProperties)Xe.properties[zt]=on}}(this._dataUpdateable,N.dataDiff,K),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(N){return p._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(N){return this._geoJSONIndex.getClusterExpansionZoom(N.clusterId)}getClusterChildren(N){return this._geoJSONIndex.getChildren(N.clusterId)}getClusterLeaves(N){return this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset)}}class Ht{constructor(N){this.self=N,this.actor=new p.F(N),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(j,K)=>{if(this.externalWorkerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.externalWorkerSourceTypes[j]=K},this.self.addProtocol=p.bi,this.self.removeProtocol=p.bj,this.self.registerRTLTextPlugin=j=>{if(p.bD.isParsed())throw new Error("RTL text plugin already registered.");p.bD.setMethods(j)},this.actor.registerMessageHandler("LDT",(j,K)=>this._getDEMWorkerSource(j,K.source).loadTile(K)),this.actor.registerMessageHandler("RDT",(j,K)=>p._(this,void 0,void 0,function*(){this._getDEMWorkerSource(j,K.source).removeTile(K)})),this.actor.registerMessageHandler("GCEZ",(j,K)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(j,K.type,K.source).getClusterExpansionZoom(K)})),this.actor.registerMessageHandler("GCC",(j,K)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(j,K.type,K.source).getClusterChildren(K)})),this.actor.registerMessageHandler("GCL",(j,K)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(j,K.type,K.source).getClusterLeaves(K)})),this.actor.registerMessageHandler("LD",(j,K)=>this._getWorkerSource(j,K.type,K.source).loadData(K)),this.actor.registerMessageHandler("GD",(j,K)=>this._getWorkerSource(j,K.type,K.source).getData()),this.actor.registerMessageHandler("LT",(j,K)=>this._getWorkerSource(j,K.type,K.source).loadTile(K)),this.actor.registerMessageHandler("RT",(j,K)=>this._getWorkerSource(j,K.type,K.source).reloadTile(K)),this.actor.registerMessageHandler("AT",(j,K)=>this._getWorkerSource(j,K.type,K.source).abortTile(K)),this.actor.registerMessageHandler("RMT",(j,K)=>this._getWorkerSource(j,K.type,K.source).removeTile(K)),this.actor.registerMessageHandler("RS",(j,K)=>p._(this,void 0,void 0,function*(){if(!this.workerSources[j]||!this.workerSources[j][K.type]||!this.workerSources[j][K.type][K.source])return;const ne=this.workerSources[j][K.type][K.source];delete this.workerSources[j][K.type][K.source],ne.removeSource!==void 0&&ne.removeSource(K)})),this.actor.registerMessageHandler("RM",j=>p._(this,void 0,void 0,function*(){delete this.layerIndexes[j],delete this.availableImages[j],delete this.workerSources[j],delete this.demWorkerSources[j]})),this.actor.registerMessageHandler("SR",(j,K)=>p._(this,void 0,void 0,function*(){this.referrer=K})),this.actor.registerMessageHandler("SRPS",(j,K)=>this._syncRTLPluginState(j,K)),this.actor.registerMessageHandler("IS",(j,K)=>p._(this,void 0,void 0,function*(){this.self.importScripts(K)})),this.actor.registerMessageHandler("SI",(j,K)=>this._setImages(j,K)),this.actor.registerMessageHandler("UL",(j,K)=>p._(this,void 0,void 0,function*(){this._getLayerIndex(j).update(K.layers,K.removedIds)})),this.actor.registerMessageHandler("SL",(j,K)=>p._(this,void 0,void 0,function*(){this._getLayerIndex(j).replace(K)}))}_setImages(N,j){return p._(this,void 0,void 0,function*(){this.availableImages[N]=j;for(const K in this.workerSources[N]){const ne=this.workerSources[N][K];for(const me in ne)ne[me].availableImages=j}})}_syncRTLPluginState(N,j){return p._(this,void 0,void 0,function*(){if(p.bD.isParsed())return p.bD.getState();if(j.pluginStatus!=="loading")return p.bD.setState(j),j;const K=j.pluginURL;if(this.self.importScripts(K),p.bD.isParsed()){const ne={pluginStatus:"loaded",pluginURL:K};return p.bD.setState(ne),ne}throw p.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${K}`)})}_getAvailableImages(N){let j=this.availableImages[N];return j||(j=[]),j}_getLayerIndex(N){let j=this.layerIndexes[N];return j||(j=this.layerIndexes[N]=new c),j}_getWorkerSource(N,j,K){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][j]||(this.workerSources[N][j]={}),!this.workerSources[N][j][K]){const ne={sendAsync:(me,ge)=>(me.targetMapId=N,this.actor.sendAsync(me,ge))};switch(j){case"vector":this.workerSources[N][j][K]=new k(ne,this._getLayerIndex(N),this._getAvailableImages(N));break;case"geojson":this.workerSources[N][j][K]=new Qt(ne,this._getLayerIndex(N),this._getAvailableImages(N));break;default:this.workerSources[N][j][K]=new this.externalWorkerSourceTypes[j](ne,this._getLayerIndex(N),this._getAvailableImages(N))}}return this.workerSources[N][j][K]}_getDEMWorkerSource(N,j){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][j]||(this.demWorkerSources[N][j]=new I),this.demWorkerSources[N][j]}}return p.i(self)&&(self.worker=new Ht(self)),Ht}),h("index",["exports","./shared"],function(p,c){var S="4.7.1";let E,P;const k={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:v=>new Promise((n,l)=>{const d=requestAnimationFrame(n);v.signal.addEventListener("abort",()=>{cancelAnimationFrame(d),l(c.c())})}),getImageData(v,n=0){return this.getImageCanvasContext(v).getImageData(-n,-n,v.width+2*n,v.height+2*n)},getImageCanvasContext(v){const n=window.document.createElement("canvas"),l=n.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return n.width=v.width,n.height=v.height,l.drawImage(v,0,0,v.width,v.height),l},resolveURL:v=>(E||(E=document.createElement("a")),E.href=v,E.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(P==null&&(P=matchMedia("(prefers-reduced-motion: reduce)")),P.matches)}};class I{static testProp(n){if(!I.docStyle)return n[0];for(let l=0;l<n.length;l++)if(n[l]in I.docStyle)return n[l];return n[0]}static create(n,l,d){const f=window.document.createElement(n);return l!==void 0&&(f.className=l),d&&d.appendChild(f),f}static createNS(n,l){return window.document.createElementNS(n,l)}static disableDrag(){I.docStyle&&I.selectProp&&(I.userSelect=I.docStyle[I.selectProp],I.docStyle[I.selectProp]="none")}static enableDrag(){I.docStyle&&I.selectProp&&(I.docStyle[I.selectProp]=I.userSelect)}static setTransform(n,l){n.style[I.transformProp]=l}static addEventListener(n,l,d,f={}){n.addEventListener(l,d,"passive"in f?f:f.capture)}static removeEventListener(n,l,d,f={}){n.removeEventListener(l,d,"passive"in f?f:f.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",I.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",I.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",I.suppressClickInternal,!0)},0)}static getScale(n){const l=n.getBoundingClientRect();return{x:l.width/n.offsetWidth||1,y:l.height/n.offsetHeight||1,boundingClientRect:l}}static getPoint(n,l,d){const f=l.boundingClientRect;return new c.P((d.clientX-f.left)/l.x-n.clientLeft,(d.clientY-f.top)/l.y-n.clientTop)}static mousePos(n,l){const d=I.getScale(n);return I.getPoint(n,d,l)}static touchPos(n,l){const d=[],f=I.getScale(n);for(let y=0;y<l.length;y++)d.push(I.getPoint(n,f,l[y]));return d}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}I.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,I.selectProp=I.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),I.transformProp=I.testProp(["transform","WebkitTransform"]);const G={supported:!1,testSupport:function(v){!te&&H&&(L?V(v):Z=v)}};let Z,H,te=!1,L=!1;function V(v){const n=v.createTexture();v.bindTexture(v.TEXTURE_2D,n);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,H),v.isContextLost())return;G.supported=!0}catch{}v.deleteTexture(n),te=!0}var W;typeof document<"u"&&(H=document.createElement("img"),H.onload=()=>{Z&&V(Z),Z=null,L=!0},H.onerror=()=>{te=!0,Z=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let n,l,d,f;v.resetRequestQueue=()=>{n=[],l=0,d=0,f={}},v.addThrottleControl=A=>{const z=d++;return f[z]=A,z},v.removeThrottleControl=A=>{delete f[A],w()},v.getImage=(A,z,B=!0)=>new Promise((F,q)=>{G.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),c.e(A,{type:"image"}),n.push({abortController:z,requestParameters:A,supportImageRefresh:B,state:"queued",onError:J=>{q(J)},onSuccess:J=>{F(J)}}),w()});const y=A=>c._(this,void 0,void 0,function*(){A.state="running";const{requestParameters:z,supportImageRefresh:B,onError:F,onSuccess:q,abortController:J}=A,ee=B===!1&&!c.i(self)&&!c.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((fe,ye)=>fe&&ye==="accept",!0));l++;const ae=ee?C(z,J):c.m(z,J);try{const fe=yield ae;delete A.abortController,A.state="completed",fe.data instanceof HTMLImageElement||c.b(fe.data)?q(fe):fe.data&&q({data:yield(he=fe.data,typeof createImageBitmap=="function"?c.d(he):c.f(he)),cacheControl:fe.cacheControl,expires:fe.expires})}catch(fe){delete A.abortController,F(fe)}finally{l--,w()}var he}),w=()=>{const A=(()=>{for(const z of Object.keys(f))if(f[z]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=l;z<A&&n.length>0;z++){const B=n.shift();B.abortController.signal.aborted?z--:y(B)}},C=(A,z)=>new Promise((B,F)=>{const q=new Image,J=A.url,ee=A.credentials;ee&&ee==="include"?q.crossOrigin="use-credentials":(ee&&ee==="same-origin"||!c.s(J))&&(q.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{q.src="",F(c.c())}),q.fetchPriority="high",q.onload=()=>{q.onerror=q.onload=null,B({data:q})},q.onerror=()=>{q.onerror=q.onload=null,z.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},q.src=J})}(W||(W={})),W.resetRequestQueue();class re{constructor(n){this._transformRequestFn=n}transformRequest(n,l){return this._transformRequestFn&&this._transformRequestFn(n,l)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function pe(v){var n=new c.A(3);return n[0]=v[0],n[1]=v[1],n[2]=v[2],n}var _e,le=function(v,n,l){return v[0]=n[0]-l[0],v[1]=n[1]-l[1],v[2]=n[2]-l[2],v};_e=new c.A(3),c.A!=Float32Array&&(_e[0]=0,_e[1]=0,_e[2]=0);var ce=function(v){var n=v[0],l=v[1];return n*n+l*l};function De(v){const n=[];if(typeof v=="string")n.push({id:"default",url:v});else if(v&&v.length>0){const l=[];for(const{id:d,url:f}of v){const y=`${d}${f}`;l.indexOf(y)===-1&&(l.push(y),n.push({id:d,url:f}))}}return n}function Be(v,n,l){const d=v.split("?");return d[0]+=`${n}${l}`,d.join("?")}(function(){var v=new c.A(2);c.A!=Float32Array&&(v[0]=0,v[1]=0)})();class Ce{constructor(n,l,d,f){this.context=n,this.format=d,this.texture=n.gl.createTexture(),this.update(l,f)}update(n,l,d){const{width:f,height:y}=n,w=!(this.size&&this.size[0]===f&&this.size[1]===y||d),{context:C}=this,{gl:A}=C;if(this.useMipmap=!!(l&&l.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!l||l.premultiply!==!1)),w)this.size=[f,y],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||c.b(n)?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,n):A.texImage2D(A.TEXTURE_2D,0,this.format,f,y,0,this.format,A.UNSIGNED_BYTE,n.data);else{const{x:z,y:B}=d||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||c.b(n)?A.texSubImage2D(A.TEXTURE_2D,0,z,B,A.RGBA,A.UNSIGNED_BYTE,n):A.texSubImage2D(A.TEXTURE_2D,0,z,B,f,y,A.RGBA,A.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)}bind(n,l,d){const{context:f}=this,{gl:y}=f;y.bindTexture(y.TEXTURE_2D,this.texture),d!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=y.LINEAR),n!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,d||n),this.filter=n),l!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function Fe(v){const{userImage:n}=v;return!!(n&&n.render&&n.render())&&(v.data.replace(new Uint8Array(n.data.buffer)),!0)}class ze extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:l,promiseResolve:d}of this.requestors)d(this._getImagesForIds(l));this.requestors=[]}}getImage(n){const l=this.images[n];if(l&&!l.data&&l.spriteData){const d=l.spriteData;l.data=new c.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),l.spriteData=null}return l}addImage(n,l){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,l)&&(this.images[n]=l)}_validate(n,l){let d=!0;const f=l.data||l.spriteData;return this._validateStretch(l.stretchX,f&&f.width)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "stretchX" value`))),d=!1),this._validateStretch(l.stretchY,f&&f.height)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "stretchY" value`))),d=!1),this._validateContent(l.content,l)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "content" value`))),d=!1),d}_validateStretch(n,l){if(!n)return!0;let d=0;for(const f of n){if(f[0]<d||f[1]<f[0]||l<f[1])return!1;d=f[1]}return!0}_validateContent(n,l){if(!n)return!0;if(n.length!==4)return!1;const d=l.spriteData,f=d&&d.width||l.data.width,y=d&&d.height||l.data.height;return!(n[0]<0||f<n[0]||n[1]<0||y<n[1]||n[2]<0||f<n[2]||n[3]<0||y<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,l,d=!0){const f=this.getImage(n);if(d&&(f.data.width!==l.data.width||f.data.height!==l.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${l.data.width}x${l.data.height}).`);l.version=f.version+1,this.images[n]=l,this.updatedImages[n]=!0}removeImage(n){const l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((l,d)=>{let f=!0;if(!this.isLoaded())for(const y of n)this.images[y]||(f=!1);this.isLoaded()||f?l(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:l})})}_getImagesForIds(n){const l={};for(const d of n){let f=this.getImage(d);f||(this.fire(new c.k("styleimagemissing",{id:d})),f=this.getImage(d)),f?l[d]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:c.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return l}getPixelSize(){const{width:n,height:l}=this.atlasImage;return{width:n,height:l}}getPattern(n){const l=this.patterns[n],d=this.getImage(n);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{const f={w:d.data.width+2,h:d.data.height+2,x:0,y:0},y=new c.I(f,d);this.patterns[n]={bin:f,position:y}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ce(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const y in this.patterns)n.push(this.patterns[y].bin);const{w:l,h:d}=c.p(n),f=this.atlasImage;f.resize({width:l||1,height:d||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],C=w.x+1,A=w.y+1,z=this.getImage(y).data,B=z.width,F=z.height;c.R.copy(z,f,{x:0,y:0},{x:C,y:A},{width:B,height:F}),c.R.copy(z,f,{x:0,y:F-1},{x:C,y:A-1},{width:B,height:1}),c.R.copy(z,f,{x:0,y:0},{x:C,y:A+F},{width:B,height:1}),c.R.copy(z,f,{x:B-1,y:0},{x:C-1,y:A},{width:1,height:F}),c.R.copy(z,f,{x:0,y:0},{x:C+B,y:A},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const l of n){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const d=this.getImage(l);d||c.w(`Image with ID: "${l}" was not found`),Fe(d)&&this.updateImage(l,d)}}}const Qe=1e20;function Ze(v,n,l,d,f,y,w,C,A){for(let z=n;z<n+d;z++)Je(v,l*y+z,y,f,w,C,A);for(let z=l;z<l+f;z++)Je(v,z*y+n,1,d,w,C,A)}function Je(v,n,l,d,f,y,w){y[0]=0,w[0]=-Qe,w[1]=Qe,f[0]=v[n];for(let C=1,A=0,z=0;C<d;C++){f[C]=v[n+C*l];const B=C*C;do{const F=y[A];z=(f[C]-f[F]+B-F*F)/(C-F)/2}while(z<=w[A]&&--A>-1);A++,y[A]=C,w[A]=z,w[A+1]=Qe}for(let C=0,A=0;C<d;C++){for(;w[A+1]<C;)A++;const z=y[A],B=C-z;v[n+C*l]=f[z]+B*B}}class $e{constructor(n,l){this.requestManager=n,this.localIdeographFontFamily=l,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return c._(this,void 0,void 0,function*(){const l=[];for(const y in n)for(const w of n[y])l.push(this._getAndCacheGlyphsPromise(y,w));const d=yield Promise.all(l),f={};for(const{stack:y,id:w,glyph:C}of d)f[y]||(f[y]={}),f[y][w]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return f})}_getAndCacheGlyphsPromise(n,l){return c._(this,void 0,void 0,function*(){let d=this.entries[n];d||(d=this.entries[n]={glyphs:{},requests:{},ranges:{}});let f=d.glyphs[l];if(f!==void 0)return{stack:n,id:l,glyph:f};if(f=this._tinySDF(d,n,l),f)return d.glyphs[l]=f,{stack:n,id:l,glyph:f};const y=Math.floor(l/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(d.ranges[y])return{stack:n,id:l,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!d.requests[y]){const C=$e.loadGlyphRange(n,y,this.url,this.requestManager);d.requests[y]=C}const w=yield d.requests[y];for(const C in w)this._doesCharSupportLocalGlyph(+C)||(d.glyphs[+C]=w[+C]);return d.ranges[y]=!0,{stack:n,id:l,glyph:w[l]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))}_tinySDF(n,l,d){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(d))return;let y=n.tinySDF;if(!y){let C="400";/bold/i.test(l)?C="900":/medium/i.test(l)?C="500":/light/i.test(l)&&(C="200"),y=n.tinySDF=new $e.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:C})}const w=y.draw(String.fromCharCode(d));return{id:d,bitmap:new c.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}$e.loadGlyphRange=function(v,n,l,d){return c._(this,void 0,void 0,function*(){const f=256*n,y=f+255,w=d.transformRequest(l.replace("{fontstack}",v).replace("{range}",`${f}-${y}`),"Glyphs"),C=yield c.l(w,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${n}, ${f}-${y}`);const A={};for(const z of c.n(C.data))A[z.id]=z;return A})},$e.TinySDF=class{constructor({fontSize:v=24,buffer:n=3,radius:l=8,cutoff:d=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=d,this.radius=l;const C=this.size=v+4*n,A=this._createCanvas(C),z=this.ctx=A.getContext("2d",{willReadFrequently:!0});z.font=`${w} ${y} ${v}px ${f}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(v){const n=document.createElement("canvas");return n.width=n.height=v,n}draw(v){const{width:n,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(v),w=Math.ceil(l),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),A=Math.min(this.size-this.buffer,w+Math.ceil(d)),z=C+2*this.buffer,B=A+2*this.buffer,F=Math.max(z*B,0),q=new Uint8ClampedArray(F),J={data:q,width:z,height:B,glyphWidth:C,glyphHeight:A,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(C===0||A===0)return J;const{ctx:ee,buffer:ae,gridInner:he,gridOuter:fe}=this;ee.clearRect(ae,ae,C,A),ee.fillText(v,ae,ae+w);const ye=ee.getImageData(ae,ae,C,A);fe.fill(Qe,0,F),he.fill(0,0,F);for(let se=0;se<A;se++)for(let be=0;be<C;be++){const we=ye.data[4*(se*C+be)+3]/255;if(we===0)continue;const Ee=(se+ae)*z+be+ae;if(we===1)fe[Ee]=0,he[Ee]=Qe;else{const je=.5-we;fe[Ee]=je>0?je*je:0,he[Ee]=je<0?je*je:0}}Ze(fe,0,0,z,B,z,this.f,this.v,this.z),Ze(he,ae,ae,C,A,z,this.f,this.v,this.z);for(let se=0;se<F;se++){const be=Math.sqrt(fe[se])-Math.sqrt(he[se]);q[se]=Math.round(255-255*(be/this.radius+this.cutoff))}return J}};class ke{constructor(){this.specification=c.v.light.position}possiblyEvaluate(n,l){return c.x(n.expression.evaluate(l))}interpolate(n,l,d){return{x:c.y.number(n.x,l.x,d),y:c.y.number(n.y,l.y,d),z:c.y.number(n.z,l.z,d)}}}let Ue;class et extends c.E{constructor(n){super(),Ue=Ue||new c.q({anchor:new c.D(c.v.light.anchor),position:new ke,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(Ue),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l={}){if(!this._validate(c.r,n,l))for(const d in n){const f=n[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d){return(!d||d.validate!==!1)&&c.t(this,n.call(c.u,{value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const pt=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Le extends c.E{constructor(n){super(),this._transitionable=new c.T(pt),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(n,l={}){if(!this._validate(c.B,n,l)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in n){const f=n[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d={}){return(d==null?void 0:d.validate)!==!1&&c.t(this,n.call(c.u,c.e({value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Ve{constructor(n,l){this.width=n,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,l){const d=n.join(",")+String(l);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(n,l)),this.dashEntry[d]}getDashRanges(n,l,d){const f=[];let y=n.length%2==1?-n[n.length-1]*d:0,w=n[0]*d,C=!0;f.push({left:y,right:w,isDash:C,zeroLength:n[0]===0});let A=n[0];for(let z=1;z<n.length;z++){C=!C;const B=n[z];y=A*d,A+=B,w=A*d,f.push({left:y,right:w,isDash:C,zeroLength:B===0})}return f}addRoundDash(n,l,d){const f=l/2;for(let y=-d;y<=d;y++){const w=this.width*(this.nextRow+d+y);let C=0,A=n[C];for(let z=0;z<this.width;z++){z/A.right>1&&(A=n[++C]);const B=Math.abs(z-A.left),F=Math.abs(z-A.right),q=Math.min(B,F);let J;const ee=y/d*(f+1);if(A.isDash){const ae=f-Math.abs(ee);J=Math.sqrt(q*q+ae*ae)}else J=f-Math.sqrt(q*q+ee*ee);this.data[w+z]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(n){for(let C=n.length-1;C>=0;--C){const A=n[C],z=n[C+1];A.zeroLength?n.splice(C,1):z&&z.isDash===A.isDash&&(z.left=A.left,n.splice(C,1))}const l=n[0],d=n[n.length-1];l.isDash===d.isDash&&(l.left=d.left-this.width,d.right=l.right+this.width);const f=this.width*this.nextRow;let y=0,w=n[y];for(let C=0;C<this.width;C++){C/w.right>1&&(w=n[++y]);const A=Math.abs(C-w.left),z=Math.abs(C-w.right),B=Math.min(A,z);this.data[f+C]=Math.max(0,Math.min(255,(w.isDash?B:-B)+128))}}addDash(n,l){const d=l?7:0,f=2*d+1;if(this.nextRow+f>this.height)return c.w("LineAtlas out of space"),null;let y=0;for(let C=0;C<n.length;C++)y+=n[C];if(y!==0){const C=this.width/y,A=this.getDashRanges(n,this.width,C);l?this.addRoundDash(A,C,d):this.addRegularDash(A)}const w={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:y};return this.nextRow+=f,this.dirty=!0,w}bind(n){const l=n.gl;this.texture?(l.bindTexture(l.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,l.texSubImage2D(l.TEXTURE_2D,0,0,0,this.width,this.height,l.ALPHA,l.UNSIGNED_BYTE,this.data))):(this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.ALPHA,this.width,this.height,0,l.ALPHA,l.UNSIGNED_BYTE,this.data))}}const We="maplibre_preloaded_worker_pool";class He{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<He.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[We]}numActive(){return Object.keys(this.active).length}}const _t=Math.floor(k.hardwareConcurrency/2);let tt,dt;function Pt(){return tt||(tt=new He),tt}He.workerCount=c.C(globalThis)?Math.max(Math.min(_t,3),1):1;class Ut{constructor(n,l){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=l;const d=this.workerPool.acquire(l);for(let f=0;f<d.length;f++){const y=new c.F(d[f],l);y.name=`Worker ${f}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,l){const d=[];for(const f of this.actors)d.push(f.sendAsync({type:n,data:l}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(l=>{l.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,l){for(const d of this.actors)d.registerMessageHandler(n,l)}}function Ft(){return dt||(dt=new Ut(Pt(),c.G),dt.registerMessageHandler("GR",(v,n,l)=>c.m(n,l))),dt}function at(v,n){const l=c.H();return c.J(l,l,[1,1,0]),c.K(l,l,[.5*v.width,.5*v.height,1]),c.L(l,l,v.calculatePosMatrix(n.toUnwrapped()))}function Wt(v,n,l,d,f,y){const w=function(F,q,J){if(F)for(const ee of F){const ae=q[ee];if(ae&&ae.source===J&&ae.type==="fill-extrusion")return!0}else for(const ee in q){const ae=q[ee];if(ae.source===J&&ae.type==="fill-extrusion")return!0}return!1}(f&&f.layers,n,v.id),C=y.maxPitchScaleFactor(),A=v.tilesIn(d,C,w);A.sort(mt);const z=[];for(const F of A)z.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(n,l,v._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,f,y,C,at(v.transform,F.tileID))});const B=function(F){const q={},J={};for(const ee of F){const ae=ee.queryResults,he=ee.wrappedTileID,fe=J[he]=J[he]||{};for(const ye in ae){const se=ae[ye],be=fe[ye]=fe[ye]||{},we=q[ye]=q[ye]||[];for(const Ee of se)be[Ee.featureIndex]||(be[Ee.featureIndex]=!0,we.push(Ee))}}return q}(z);for(const F in B)B[F].forEach(q=>{const J=q.feature,ee=v.getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=ee});return B}function mt(v,n){const l=v.tileID,d=n.tileID;return l.overscaledZ-d.overscaledZ||l.canonical.y-d.canonical.y||l.wrap-d.wrap||l.canonical.x-d.canonical.x}function wn(v,n,l){return c._(this,void 0,void 0,function*(){let d=v;if(v.url?d=(yield c.h(n.transformRequest(v.url,"Source"),l)).data:yield k.frameAsync(l),!d)return null;const f=c.M(c.e(d,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(f.vectorLayerIds=d.vector_layers.map(y=>y.id)),f})}class Pe{constructor(n,l){n&&(l?this.setSouthWest(n).setNorthEast(l):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof c.N?new c.N(n.lng,n.lat):c.N.convert(n),this}setSouthWest(n){return this._sw=n instanceof c.N?new c.N(n.lng,n.lat):c.N.convert(n),this}extend(n){const l=this._sw,d=this._ne;let f,y;if(n instanceof c.N)f=n,y=n;else{if(!(n instanceof Pe))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Pe.convert(n)):this.extend(c.N.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(c.N.convert(n)):this;if(f=n._sw,y=n._ne,!f||!y)return this}return l||d?(l.lng=Math.min(f.lng,l.lng),l.lat=Math.min(f.lat,l.lat),d.lng=Math.max(y.lng,d.lng),d.lat=Math.max(y.lat,d.lat)):(this._sw=new c.N(f.lng,f.lat),this._ne=new c.N(y.lng,y.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:l,lat:d}=c.N.convert(n);let f=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&f}static convert(n){return n instanceof Pe?n:n&&new Pe(n)}static fromLngLat(n,l=0){const d=360*l/40075017,f=d/Math.cos(Math.PI/180*n.lat);return new Pe(new c.N(n.lng-f,n.lat-d),new c.N(n.lng+f,n.lat+d))}adjustAntiMeridian(){const n=new c.N(this._sw.lng,this._sw.lat),l=new c.N(this._ne.lng,this._ne.lat);return new Pe(n,n.lng>l.lng?new c.N(l.lng+360,l.lat):l)}}class Sn{constructor(n,l,d){this.bounds=Pe.convert(this.validateBounds(n)),this.minzoom=l||0,this.maxzoom=d||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const l=Math.pow(2,n.z),d=Math.floor(c.O(this.bounds.getWest())*l),f=Math.floor(c.Q(this.bounds.getNorth())*l),y=Math.ceil(c.O(this.bounds.getEast())*l),w=Math.ceil(c.Q(this.bounds.getSouth())*l);return n.x>=d&&n.x<y&&n.y>=f&&n.y<w}}class dr extends c.E{constructor(n,l,d,f){if(super(),this.id=n,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(l,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield wn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(c.e(this,n),n.bounds&&(this.tileBounds=new Sn(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new c.j(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(l,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};d.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((y,w)=>{n.reloadPromise={resolve:y,reject:w}})}else n.actor=this.dispatcher.getActor(),f="LT";n.abortController=new AbortController;try{const y=yield n.actor.sendAsync({type:f,data:d},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,y)}catch(y){if(delete n.abortController,n.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,l){if(l&&l.resourceTiming&&(n.resourceTiming=l.resourceTiming),l&&this.map._refreshExpiredTiles&&n.setExpiryData(l),n.loadVectorData(l,this.map.painter),n.reloadPromise){const d=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(d.resolve).catch(d.reject)}}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Nt extends c.E{constructor(n,l,d,f){super(),this.id=n,this.dispatcher=d,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},l),c.e(this,c.M(l,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield wn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(c.e(this,n),n.bounds&&(this.tileBounds=new Sn(n.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new c.j(n))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return c.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const d=yield W.getImage(this.map._requestManager.transformRequest(l,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&n.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const f=this.map.painter.context,y=f.gl,w=d.data;n.texture=this.map.painter.getTileTexture(w.width),n.texture?n.texture.update(w,{useMipmap:!0}):(n.texture=new Ce(f,w,y.RGBA,{useMipmap:!0}),n.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(d){if(delete n.abortController,n.aborted)n.state="unloaded";else if(d)throw n.state="errored",d}})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class Jt extends Nt{constructor(n,l,d,f){super(n,l,d,f),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox",this.redFactor=l.redFactor,this.greenFactor=l.greenFactor,this.blueFactor=l.blueFactor,this.baseShift=l.baseShift}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(l,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const f=yield W.getImage(d,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(f&&f.data){const y=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&n.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const w=c.b(y)&&c.U()?y:yield this.readImageNow(y),C={type:this.type,uid:n.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const A=yield n.actor.sendAsync({type:"LDT",data:C});n.dem=A,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(f){if(delete n.abortController,n.aborted)n.state="unloaded";else if(f)throw n.state="errored",f}})}readImageNow(n){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const l=n.width+2,d=n.height+2;try{return new c.R({width:l,height:d},yield c.W(n,-1,-1,l,d))}catch{}}return k.getImageData(n,1)})}_getNeighboringTiles(n){const l=n.canonical,d=Math.pow(2,l.z),f=(l.x-1+d)%d,y=l.x===0?n.wrap-1:n.wrap,w=(l.x+1+d)%d,C=l.x+1===d?n.wrap+1:n.wrap,A={};return A[new c.S(n.overscaledZ,y,l.z,f,l.y).key]={backfilled:!1},A[new c.S(n.overscaledZ,C,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(A[new c.S(n.overscaledZ,y,l.z,f,l.y-1).key]={backfilled:!1},A[new c.S(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},A[new c.S(n.overscaledZ,C,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<d&&(A[new c.S(n.overscaledZ,y,l.z,f,l.y+1).key]={backfilled:!1},A[new c.S(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},A[new c.S(n.overscaledZ,C,l.z,w,l.y+1).key]={backfilled:!1}),A}unloadTile(n){return c._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class Ir extends c.E{constructor(n,l,d,f){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(f),this._data=l.data,this._options=c.e({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const y=c.X/this.tileSize;l.clusterMaxZoom!==void 0&&this.maxzoom<=l.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${l.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*y,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*y,extent:c.X,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:c.X,radius:(l.clusterRadius||50)*y,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return c._(this,void 0,void 0,function*(){const n=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,l,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:l,offset:d}})}_updateWorkerData(n){return c._(this,void 0,void 0,function*(){const l=c.e({type:this.type},this.workerOptions);n?l.dataDiff=n:typeof this._data=="string"?(l.request=this.map._requestManager.transformRequest(k.resolveURL(this._data),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:l});if(this._pendingLoads--,this._removed||d.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let f=null;d.resourceTiming&&d.resourceTiming[this.id]&&(f=d.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&c.e(y,{resourceTiming:f}),this.fire(new c.k("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(d){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(d))}})}loaded(){return this._pendingLoads===0}loadTile(n){return c._(this,void 0,void 0,function*(){const l=n.actor?"RT":"LT";n.actor=this.actor;const d={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.abortController=new AbortController;const f=yield this.actor.sendAsync({type:l,data:d},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(f,this.map.painter,l==="RT")})}abortTile(n){return c._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return c._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var xn=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class En extends c.E{constructor(n,l,d,f){super(),this.id=n,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=l}load(n){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const l=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,l&&l.data&&(this.image=l.data,n&&(this.coordinates=n),this._finishLoading())}catch(l){this._request=null,this._loaded=!0,this.fire(new c.j(l))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const l=n.map(c.Z.fromLngLat);this.tileID=function(f){let y=1/0,w=1/0,C=-1/0,A=-1/0;for(const q of f)y=Math.min(y,q.x),w=Math.min(w,q.y),C=Math.max(C,q.x),A=Math.max(A,q.y);const z=Math.max(C-y,A-w),B=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),F=Math.pow(2,B);return new c.a1(B,Math.floor((y+C)/2*F),Math.floor((w+A)/2*F))}(l),this.minzoom=this.maxzoom=this.tileID.z;const d=l.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,c.X,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,c.X),this._boundsArray.emplaceBack(d[2].x,d[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,xn.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ce(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ci extends En{constructor(n,l,d,f){super(n,l,d,f),this.roundZoom=!0,this.type="video",this.options=l}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const l of n.urls)this.urls.push(this.map._requestManager.transformRequest(l,"Source").url);try{const l=yield c.a3(this.urls);if(this._loaded=!0,!l)return;this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(l){this.fire(new c.j(l))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,xn.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new Ce(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class er extends En{constructor(n,l,d,f){super(n,l,d,f),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(w=>typeof w!="number"))||this.fire(new c.j(new c.a2(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${n}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${n}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,xn.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ce(l,this.canvas,d.RGBA,{premultiply:!0});let f=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Xr={},Ti=v=>{switch(v){case"geojson":return Ir;case"image":return En;case"raster":return Nt;case"raster-dem":return Jt;case"vector":return dr;case"video":return ci;case"canvas":return er}return Xr[v]},qe="RTLPluginLoaded";class tr extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ft()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(l=>{throw this.status="error",l})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return c._(this,arguments,void 0,function*(l,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=k.resolveURL(l),!this.url)throw new Error(`requested url ${l} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(qe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let dn=null;function cr(){return dn||(dn=new tr),dn}class zn{constructor(n,l){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=c.a4(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const l=n+this.timeAdded;l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,l,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(f,y){const w={};if(!y)return w;for(const C of f){const A=C.layerIds.map(z=>y.getLayer(z)).filter(Boolean);if(A.length!==0){C.layers=A,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(z=>A.filter(B=>B.id===z)[0]));for(const z of A)w[z.id]=C}}return w}(n.buckets,l.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof c.a6){if(this.hasSymbolBuckets=!0,!d)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof c.a6&&y.hasRTLText){this.hasRTLText=!0,cr().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(f).queryRadius(y))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const d in this.buckets){const f=this.buckets[d];f.uploadPending()&&f.upload(n)}const l=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ce(n,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ce(n,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,l,d,f,y,w,C,A,z,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:y,scale:w,tileSize:this.tileSize,pixelPosMatrix:B,transform:A,params:C,queryPadding:this.queryPadding*z},n,l,d):{}}querySourceFeatures(n,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const f=d.loadVTLayers(),y=l&&l.sourceLayer?l.sourceLayer:"",w=f._geojsonTileLayer||f[y];if(!w)return;const C=c.a7(l&&l.filter),{z:A,x:z,y:B}=this.tileID.canonical,F={z:A,x:z,y:B};for(let q=0;q<w.length;q++){const J=w.feature(q);if(C.needGeometry){const he=c.a8(J,!0);if(!C.filter(new c.z(this.tileID.overscaledZ),he,this.tileID.canonical))continue}else if(!C.filter(new c.z(this.tileID.overscaledZ),J))continue;const ee=d.getId(J,y),ae=new c.a9(J,A,z,B,ee);ae.tile=F,n.push(ae)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const d=c.aa(n.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const d=Date.now();let f=!1;if(this.expirationTime>d)f=!1;else if(l)if(this.expirationTime<l)f=!0;else{const y=this.expirationTime-l;y?this.expirationTime=d+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!l.style.hasLayer(f))continue;const y=this.buckets[f],w=y.layers[0].sourceLayer||"_geojsonTileLayer",C=d[w],A=n[w];if(!C||!A||Object.keys(A).length===0)continue;y.update(A,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=l&&l.style&&l.style.getLayer(f);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<k.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=k.now()+n}setDependencies(n,l){const d={};for(const f of l)d[f]=!0;this.dependencies[n]=d}hasDependency(n,l){for(const d of n){const f=this.dependencies[d];if(f){for(const y of l)if(f[y])return!0}}return!1}}class Ye{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,d){const f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:l,timeout:void 0};if(d!==void 0&&(y.timeout=setTimeout(()=>{this.remove(n,y)},d)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const d=n.wrapped().key,f=l===void 0?0:this.data[d].indexOf(l),y=this.data[d][f];return this.data[d].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(y.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const d in this.data)for(const f of this.data[d])n(f.value)||l.push(f);for(const d of l)this.remove(d.value.tileID,d)}}class $t{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,d){const f=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][f]=this.stateChanges[n][f]||{},c.e(this.stateChanges[n][f],d),this.deletedStates[n]===null){this.deletedStates[n]={};for(const y in this.state[n])y!==f&&(this.deletedStates[n][y]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][f]===null){this.deletedStates[n][f]={};for(const y in this.state[n][f])d[y]||(this.deletedStates[n][f][y]=null)}else for(const y in d)this.deletedStates[n]&&this.deletedStates[n][f]&&this.deletedStates[n][f][y]===null&&delete this.deletedStates[n][f][y]}removeFeatureState(n,l,d){if(this.deletedStates[n]===null)return;const f=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},d&&l!==void 0)this.deletedStates[n][f]!==null&&(this.deletedStates[n][f]=this.deletedStates[n][f]||{},this.deletedStates[n][f][d]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][f])for(d in this.deletedStates[n][f]={},this.stateChanges[n][f])this.deletedStates[n][f][d]=null;else this.deletedStates[n][f]=null;else this.deletedStates[n]=null}getState(n,l){const d=String(l),f=c.e({},(this.state[n]||{})[d],(this.stateChanges[n]||{})[d]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const y=this.deletedStates[n][l];if(y===null)return{};for(const w in y)delete f[w]}return f}initializeTileState(n,l){n.setFeatureState(this.state,l)}coalesceChanges(n,l){const d={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const w in this.stateChanges[f])this.state[f][w]||(this.state[f][w]={}),c.e(this.state[f][w],this.stateChanges[f][w]),y[w]=this.state[f][w];d[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const w in this.state[f])y[w]={},this.state[f][w]={};else for(const w in this.deletedStates[f]){if(this.deletedStates[f][w]===null)this.state[f][w]={};else for(const C of Object.keys(this.deletedStates[f][w]))delete this.state[f][w][C];y[w]=this.state[f][w]}d[f]=d[f]||{},c.e(d[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const f in n)n[f].setFeatureState(d,l)}}class Dt extends c.E{constructor(n,l,d){super(),this.id=n,this.dispatcher=d,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,y,w,C)=>{const A=new(Ti(y.type))(f,y,w,C);if(A.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${A.id}`);return A})(n,l,d,this),this._tiles={},this._cache=new Ye(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new $t,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,l,d){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,l,d)}catch(f){n.state="errored",f.status!==404?this._source.fire(new c.j(f,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new c.k("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(n),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Gn).map(n=>n.key)}getRenderableIds(n){const l=[];for(const d in this._tiles)this._isIdRenderable(d,n)&&l.push(this._tiles[d]);return n?l.sort((d,f)=>{const y=d.tileID,w=f.tileID,C=new c.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),A=new c.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-w.overscaledZ||A.y-C.y||A.x-C.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(Gn).map(d=>d.key)}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,l){return c._(this,void 0,void 0,function*(){const d=this._tiles[n];d&&(d.state!=="loading"&&(d.state=l),yield this._loadTile(d,n,l))})}_tileLoaded(n,l,d){n.timeAdded=k.now(),d==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const l=this.getRenderableIds();for(let f=0;f<l.length;f++){const y=l[f];if(n.neighboringTiles&&n.neighboringTiles[y]){const w=this.getTileByID(y);d(n,w),d(w,n)}}function d(f,y){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let w=y.tileID.canonical.x-f.tileID.canonical.x;const C=y.tileID.canonical.y-f.tileID.canonical.y,A=Math.pow(2,f.tileID.canonical.z),z=y.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+A)===1?w+=A:Math.abs(w-A)===1&&(w-=A)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,w,C),f.neighboringTiles&&f.neighboringTiles[z]&&(f.neighboringTiles[z].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,d,f){for(const y in this._tiles){let w=this._tiles[y];if(f[y]||!w.hasData()||w.tileID.overscaledZ<=l||w.tileID.overscaledZ>d)continue;let C=w.tileID;for(;w&&w.tileID.overscaledZ>l+1;){const z=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[z.key],w&&w.hasData()&&(C=z)}let A=C;for(;A.overscaledZ>l;)if(A=A.scaledTo(A.overscaledZ-1),n[A.key]){f[C.key]=C;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const d=this._loadedParentTiles[n.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=n.overscaledZ-1;d>=l;d--){const f=n.scaledTo(d),y=this._getLoadedTile(f);if(y)return y}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const l=Math.ceil(n.width/this._source.tileSize)+1,d=Math.ceil(n.height/this._source.tileSize)+1,f=Math.floor(l*d*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(y)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const d={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+l),d[y.tileID.key]=y}this._tiles=d;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(n,l,d,f,y,w){const C={},A={},z=Object.keys(n),B=k.now();for(const F of z){const q=n[F],J=this._tiles[F];if(!J||J.fadeEndTime!==0&&J.fadeEndTime<=B)continue;const ee=this.findLoadedParent(q,l),ae=this.findLoadedSibling(q),he=ee||ae||null;he&&(this._addTile(he.tileID),C[he.tileID.key]=he.tileID),A[F]=q}this._retainLoadedChildren(A,f,d,n);for(const F in C)n[F]||(this._coveredTiles[F]=!0,n[F]=C[F]);if(w){const F={},q={};for(const J of y)this._tiles[J.key].hasData()?F[J.key]=J:q[J.key]=J;for(const J in q){const ee=q[J].children(this._source.maxzoom);this._tiles[ee[0].key]&&this._tiles[ee[1].key]&&this._tiles[ee[2].key]&&this._tiles[ee[3].key]&&(F[ee[0].key]=n[ee[0].key]=ee[0],F[ee[1].key]=n[ee[1].key]=ee[1],F[ee[2].key]=n[ee[2].key]=ee[2],F[ee[3].key]=n[ee[3].key]=ee[3],delete q[J])}for(const J in q){const ee=q[J],ae=this.findLoadedParent(ee,this._source.minzoom),he=this.findLoadedSibling(ee),fe=ae||he||null;if(fe){F[fe.tileID.key]=n[fe.tileID.key]=fe.tileID;for(const ye in F)F[ye].isChildOf(fe.tileID)&&delete F[ye]}}for(const J in this._tiles)F[J]||(this._coveredTiles[J]=!0)}}update(n,l){if(!this._sourceLoaded||this._paused)return;let d;this.transform=n,this.terrain=l,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(B=>new c.S(B.canonical.z,B.wrap,B.canonical.z,B.canonical.x,B.canonical.y)):(d=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:l}),this._source.hasTile&&(d=d.filter(B=>this._source.hasTile(B)))):d=[];const f=n.coveringZoomLevel(this._source),y=Math.max(f-Dt.maxOverzooming,this._source.minzoom),w=Math.max(f+Dt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const B={};for(const F of d)if(F.canonical.z>this._source.minzoom){const q=F.scaledTo(F.canonical.z-1);B[q.key]=q;const J=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));B[J.key]=J}d=d.concat(Object.values(B))}const C=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const A=this._updateRetainedTiles(d,f);xr(this._source.type)&&this._updateCoveredAndRetainedTiles(A,y,w,f,d,l);for(const B in A)this._tiles[B].clearFadeHold();const z=c.ab(this._tiles,A);for(const B of z){const F=this._tiles[B];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(B)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,l){var d;const f={},y={},w=Math.max(l-Dt.maxOverzooming,this._source.minzoom),C=Math.max(l+Dt.maxUnderzooming,this._source.minzoom),A={};for(const z of n){const B=this._addTile(z);f[z.key]=z,B.hasData()||l<this._source.maxzoom&&(A[z.key]=z)}this._retainLoadedChildren(A,l,C,f);for(const z of n){let B=this._tiles[z.key];if(B.hasData())continue;if(l+1>this._source.maxzoom){const q=z.children(this._source.maxzoom)[0],J=this.getTile(q);if(J&&J.hasData()){f[q.key]=q;continue}}else{const q=z.children(this._source.maxzoom);if(f[q[0].key]&&f[q[1].key]&&f[q[2].key]&&f[q[3].key])continue}let F=B.wasRequested();for(let q=z.overscaledZ-1;q>=w;--q){const J=z.scaledTo(q);if(y[J.key])break;if(y[J.key]=!0,B=this.getTile(J),!B&&F&&(B=this._addTile(J)),B){const ee=B.hasData();if((ee||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||F)&&(f[J.key]=J),F=B.wasRequested(),ee)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let d,f=this._tiles[n].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){d=this._loadedParentTiles[f.key];break}l.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(d=this._getLoadedTile(y),d)break;f=y}for(const y of l)this._loadedParentTiles[y]=d}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const l=this._tiles[n].tileID,d=this._getLoadedTile(l);this._loadedSiblingTiles[l.key]=d}}_addTile(n){let l=this._tiles[n.key];if(l)return l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const d=l;return l||(l=new zn(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,n.key,l.state)),l.uses++,this._tiles[n.key]=l,d||this._source.fire(new c.k("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const d=l.getExpiryTimeout();d&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},d))}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}_dataHandler(n){const l=n.sourceDataType;n.dataType==="source"&&l==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&l==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,l,d){const f=[],y=this.transform;if(!y)return f;const w=d?y.getCameraQueryGeometry(n):n,C=n.map(ee=>y.pointCoordinate(ee,this.terrain)),A=w.map(ee=>y.pointCoordinate(ee,this.terrain)),z=this.getIds();let B=1/0,F=1/0,q=-1/0,J=-1/0;for(const ee of A)B=Math.min(B,ee.x),F=Math.min(F,ee.y),q=Math.max(q,ee.x),J=Math.max(J,ee.y);for(let ee=0;ee<z.length;ee++){const ae=this._tiles[z[ee]];if(ae.holdingForFade())continue;const he=ae.tileID,fe=Math.pow(2,y.zoom-ae.tileID.overscaledZ),ye=l*ae.queryPadding*c.X/ae.tileSize/fe,se=[he.getTilePoint(new c.Z(B,F)),he.getTilePoint(new c.Z(q,J))];if(se[0].x-ye<c.X&&se[0].y-ye<c.X&&se[1].x+ye>=0&&se[1].y+ye>=0){const be=C.map(Ee=>he.getTilePoint(Ee)),we=A.map(Ee=>he.getTilePoint(Ee));f.push({tile:ae,tileID:he,queryGeometry:be,cameraQueryGeometry:we,scale:fe})}}return f}getVisibleCoordinates(n){const l=this.getRenderableIds(n).map(d=>this._tiles[d].tileID);for(const d of l)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(xr(this._source.type)){const n=k.now();for(const l in this._tiles)if(this._tiles[l].fadeEndTime>=n)return!0}return!1}setFeatureState(n,l,d){this._state.updateState(n=n||"_geojsonTileLayer",l,d)}removeFeatureState(n,l,d){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,d)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,d){const f=this._tiles[n];f&&f.setDependencies(l,d)}reloadTilesForDependencies(n,l){for(const d in this._tiles)this._tiles[d].hasDependency(n,l)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(n,l))}}function Gn(v,n){const l=Math.abs(2*v.wrap)-+(v.wrap<0),d=Math.abs(2*n.wrap)-+(n.wrap<0);return v.overscaledZ-n.overscaledZ||d-l||n.canonical.y-v.canonical.y||n.canonical.x-v.canonical.x}function xr(v){return v==="raster"||v==="image"||v==="video"}Dt.maxOverzooming=10,Dt.maxUnderzooming=3;class Bt{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=c.ac(n,0,1);let l=1,d=this._distances[l];const f=n*this.paddedLength+this.padding;for(;d<f&&l<this._distances.length;)d=this._distances[++l];const y=l-1,w=this._distances[y],C=d-w,A=C>0?(f-w)/C:0;return this.points[y].mult(1-A).add(this.points[l].mult(A))}}function xt(v,n){let l=!0;return v==="always"||v!=="never"&&n!=="never"||(l=!1),l}class Zt{constructor(n,l,d){const f=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/d),this.yCellCount=Math.ceil(l/d);for(let w=0;w<this.xCellCount*this.yCellCount;w++)f.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,d,f,y){this._forEachCell(l,d,f,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(y)}insertCircle(n,l,d,f){this._forEachCell(l-f,d-f,l+f,d+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(d),this.circles.push(f)}_insertBoxCell(n,l,d,f,y,w){this.boxCells[y].push(w)}_insertCircleCell(n,l,d,f,y,w){this.circleCells[y].push(w)}_query(n,l,d,f,y,w,C){if(d<0||n>this.width||f<0||l>this.height)return[];const A=[];if(n<=0&&l<=0&&this.width<=d&&this.height<=f){if(y)return[{key:null,x1:n,y1:l,x2:d,y2:f}];for(let z=0;z<this.boxKeys.length;z++)A.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const B=this.circles[3*z],F=this.circles[3*z+1],q=this.circles[3*z+2];A.push({key:this.circleKeys[z],x1:B-q,y1:F-q,x2:B+q,y2:F+q})}}else this._forEachCell(n,l,d,f,this._queryCell,A,{hitTest:y,overlapMode:w,seenUids:{box:{},circle:{}}},C);return A}query(n,l,d,f){return this._query(n,l,d,f,!1,null)}hitTest(n,l,d,f,y,w){return this._query(n,l,d,f,!0,y,w).length>0}hitTestCircle(n,l,d,f,y){const w=n-d,C=n+d,A=l-d,z=l+d;if(C<0||w>this.width||z<0||A>this.height)return!1;const B=[];return this._forEachCell(w,A,C,z,this._queryCellCircle,B,{hitTest:!0,overlapMode:f,circle:{x:n,y:l,radius:d},seenUids:{box:{},circle:{}}},y),B.length>0}_queryCell(n,l,d,f,y,w,C,A){const{seenUids:z,hitTest:B,overlapMode:F}=C,q=this.boxCells[y];if(q!==null){const ee=this.bboxes;for(const ae of q)if(!z.box[ae]){z.box[ae]=!0;const he=4*ae,fe=this.boxKeys[ae];if(n<=ee[he+2]&&l<=ee[he+3]&&d>=ee[he+0]&&f>=ee[he+1]&&(!A||A(fe))&&(!B||!xt(F,fe.overlapMode))&&(w.push({key:fe,x1:ee[he],y1:ee[he+1],x2:ee[he+2],y2:ee[he+3]}),B))return!0}}const J=this.circleCells[y];if(J!==null){const ee=this.circles;for(const ae of J)if(!z.circle[ae]){z.circle[ae]=!0;const he=3*ae,fe=this.circleKeys[ae];if(this._circleAndRectCollide(ee[he],ee[he+1],ee[he+2],n,l,d,f)&&(!A||A(fe))&&(!B||!xt(F,fe.overlapMode))){const ye=ee[he],se=ee[he+1],be=ee[he+2];if(w.push({key:fe,x1:ye-be,y1:se-be,x2:ye+be,y2:se+be}),B)return!0}}}return!1}_queryCellCircle(n,l,d,f,y,w,C,A){const{circle:z,seenUids:B,overlapMode:F}=C,q=this.boxCells[y];if(q!==null){const ee=this.bboxes;for(const ae of q)if(!B.box[ae]){B.box[ae]=!0;const he=4*ae,fe=this.boxKeys[ae];if(this._circleAndRectCollide(z.x,z.y,z.radius,ee[he+0],ee[he+1],ee[he+2],ee[he+3])&&(!A||A(fe))&&!xt(F,fe.overlapMode))return w.push(!0),!0}}const J=this.circleCells[y];if(J!==null){const ee=this.circles;for(const ae of J)if(!B.circle[ae]){B.circle[ae]=!0;const he=3*ae,fe=this.circleKeys[ae];if(this._circlesCollide(ee[he],ee[he+1],ee[he+2],z.x,z.y,z.radius)&&(!A||A(fe))&&!xt(F,fe.overlapMode))return w.push(!0),!0}}}_forEachCell(n,l,d,f,y,w,C,A){const z=this._convertToXCellCoord(n),B=this._convertToYCellCoord(l),F=this._convertToXCellCoord(d),q=this._convertToYCellCoord(f);for(let J=z;J<=F;J++)for(let ee=B;ee<=q;ee++)if(y.call(this,n,l,d,f,this.xCellCount*ee+J,w,C,A))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,d,f,y,w){const C=f-n,A=y-l,z=d+w;return z*z>C*C+A*A}_circleAndRectCollide(n,l,d,f,y,w,C){const A=(w-f)/2,z=Math.abs(n-(f+A));if(z>A+d)return!1;const B=(C-y)/2,F=Math.abs(l-(y+B));if(F>B+d)return!1;if(z<=A||F<=B)return!0;const q=z-A,J=F-B;return q*q+J*J<=d*d}}function Qt(v,n,l,d,f){const y=c.H();return n?(c.K(y,y,[1/f,1/f,1]),l||c.ad(y,y,d.angle)):c.L(y,d.labelPlaneMatrix,v),y}function Ht(v,n,l,d,f){if(n){const y=c.ae(v);return c.K(y,y,[f,f,1]),l||c.ad(y,y,-d.angle),y}return d.glCoordMatrix}function ie(v,n,l,d){let f;d?(f=[v,n,d(v,n),1],c.af(f,f,l)):(f=[v,n,0,1],on(f,f,l));const y=f[3];return{point:new c.P(f[0]/y,f[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function N(v,n){return .5+v/n*.5}function j(v,n){return v.x>=-n[0]&&v.x<=n[0]&&v.y>=-n[1]&&v.y<=n[1]}function K(v,n,l,d,f,y,w,C,A,z,B,F,q,J,ee){const ae=d?v.textSizeData:v.iconSizeData,he=c.ag(ae,l.transform.zoom),fe=[256/l.width*2+1,256/l.height*2+1],ye=d?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ye.clear();const se=v.lineVertexArray,be=d?v.text.placedSymbolArray:v.icon.placedSymbolArray,we=l.transform.width/l.transform.height;let Ee=!1;for(let je=0;je<be.length;je++){const Ke=be.get(je);if(Ke.hidden||Ke.writingMode===c.ah.vertical&&!Ee){zt(Ke.numGlyphs,ye);continue}Ee=!1;const lt=ie(Ke.anchorX,Ke.anchorY,n,ee);if(!j(lt.point,fe)){zt(Ke.numGlyphs,ye);continue}const ft=N(l.transform.cameraToCenterDistance,lt.signedDistanceFromCamera),it=c.ai(ae,he,Ke),rt=w?it/ft:it*ft,wt={getElevation:ee,labelPlaneMatrix:f,lineVertexArray:se,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:z,tileAnchorPoint:new c.P(Ke.anchorX,Ke.anchorY),unwrappedTileID:B,width:F,height:q,translation:J},Vt=ge(wt,Ke,rt,!1,C,n,y,v.glyphOffsetArray,ye,we,A);Ee=Vt.useVertical,(Vt.notEnoughRoom||Ee||Vt.needsFlipping&&ge(wt,Ke,rt,!0,C,n,y,v.glyphOffsetArray,ye,we,A).notEnoughRoom)&&zt(Ke.numGlyphs,ye)}d?v.text.dynamicLayoutVertexBuffer.updateData(ye):v.icon.dynamicLayoutVertexBuffer.updateData(ye)}function ne(v,n,l,d,f,y,w,C){const A=y.glyphStartIndex+y.numGlyphs,z=y.lineStartIndex,B=y.lineStartIndex+y.lineLength,F=n.getoffsetX(y.glyphStartIndex),q=n.getoffsetX(A-1),J=Xe(v*F,l,d,f,y.segment,z,B,C,w);if(!J)return null;const ee=Xe(v*q,l,d,f,y.segment,z,B,C,w);return ee?C.projectionCache.anyProjectionOccluded?null:{first:J,last:ee}:null}function me(v,n,l,d){return v===c.ah.horizontal&&Math.abs(l.y-n.y)>Math.abs(l.x-n.x)*d?{useVertical:!0}:(v===c.ah.vertical?n.y<l.y:n.x>l.x)?{needsFlipping:!0}:null}function ge(v,n,l,d,f,y,w,C,A,z,B){const F=l/24,q=n.lineOffsetX*F,J=n.lineOffsetY*F;let ee;if(n.numGlyphs>1){const ae=n.glyphStartIndex+n.numGlyphs,he=n.lineStartIndex,fe=n.lineStartIndex+n.lineLength,ye=ne(F,C,q,J,d,n,B,v);if(!ye)return{notEnoughRoom:!0};const se=ie(ye.first.point.x,ye.first.point.y,w,v.getElevation).point,be=ie(ye.last.point.x,ye.last.point.y,w,v.getElevation).point;if(f&&!d){const we=me(n.writingMode,se,be,z);if(we)return we}ee=[ye.first];for(let we=n.glyphStartIndex+1;we<ae-1;we++)ee.push(Xe(F*C.getoffsetX(we),q,J,d,n.segment,he,fe,v,B));ee.push(ye.last)}else{if(f&&!d){const he=ie(v.tileAnchorPoint.x,v.tileAnchorPoint.y,y,v.getElevation).point,fe=n.lineStartIndex+n.segment+1,ye=new c.P(v.lineVertexArray.getx(fe),v.lineVertexArray.gety(fe)),se=ie(ye.x,ye.y,y,v.getElevation),be=se.signedDistanceFromCamera>0?se.point:function(Ee,je,Ke,lt,ft,it){return xe(Ee,je,Ke,1,ft,it)}(v.tileAnchorPoint,ye,he,0,y,v),we=me(n.writingMode,he,be,z);if(we)return we}const ae=Xe(F*C.getoffsetX(n.glyphStartIndex),q,J,d,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,v,B);if(!ae||v.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ee=[ae]}for(const ae of ee)c.aj(A,ae.point,ae.angle);return{}}function xe(v,n,l,d,f,y){const w=v.add(v.sub(n)._unit()),C=f!==void 0?ie(w.x,w.y,f,y.getElevation).point:Ie(w.x,w.y,y).point,A=l.sub(C);return l.add(A._mult(d/A.mag()))}function de(v,n,l){const d=n.projectionCache;if(d.projections[v])return d.projections[v];const f=new c.P(n.lineVertexArray.getx(v),n.lineVertexArray.gety(v)),y=Ie(f.x,f.y,n);if(y.signedDistanceFromCamera>0)return d.projections[v]=y.point,d.anyProjectionOccluded=d.anyProjectionOccluded||y.isOccluded,y.point;const w=v-l.direction;return function(C,A,z,B,F){return xe(C,A,z,B,void 0,F)}(l.distanceFromAnchor===0?n.tileAnchorPoint:new c.P(n.lineVertexArray.getx(w),n.lineVertexArray.gety(w)),f,l.previousVertex,l.absOffsetX-l.distanceFromAnchor+1,n)}function Ie(v,n,l){const d=v+l.translation[0],f=n+l.translation[1];let y;return!l.pitchWithMap&&l.projection.useSpecialProjectionForSymbols?(y=l.projection.projectTileCoordinates(d,f,l.unwrappedTileID,l.getElevation),y.point.x=(.5*y.point.x+.5)*l.width,y.point.y=(.5*-y.point.y+.5)*l.height):(y=ie(d,f,l.labelPlaneMatrix,l.getElevation),y.isOccluded=!1),y}function Ne(v,n,l){return v._unit()._perp()._mult(n*l)}function Ae(v,n,l,d,f,y,w,C,A){if(C.projectionCache.offsets[v])return C.projectionCache.offsets[v];const z=l.add(n);if(v+A.direction<d||v+A.direction>=f)return C.projectionCache.offsets[v]=z,z;const B=de(v+A.direction,C,A),F=Ne(B.sub(l),w,A.direction),q=l.add(F),J=B.add(F);return C.projectionCache.offsets[v]=c.ak(y,z,q,J)||z,C.projectionCache.offsets[v]}function Xe(v,n,l,d,f,y,w,C,A){const z=d?v-n:v+n;let B=z>0?1:-1,F=0;d&&(B*=-1,F=Math.PI),B<0&&(F+=Math.PI);let q,J=B>0?y+f:y+f+1;C.projectionCache.cachedAnchorPoint?q=C.projectionCache.cachedAnchorPoint:(q=Ie(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=q);let ee,ae,he=q,fe=q,ye=0,se=0;const be=Math.abs(z),we=[];let Ee;for(;ye+se<=be;){if(J+=B,J<y||J>=w)return null;ye+=se,fe=he,ae=ee;const lt={absOffsetX:be,direction:B,distanceFromAnchor:ye,previousVertex:fe};if(he=de(J,C,lt),l===0)we.push(fe),Ee=he.sub(fe);else{let ft;const it=he.sub(fe);ft=it.mag()===0?Ne(de(J+B,C,lt).sub(he),l,B):Ne(it,l,B),ae||(ae=fe.add(ft)),ee=Ae(J,ft,he,y,w,ae,l,C,lt),we.push(ae),Ee=ee.sub(ae)}se=Ee.mag()}const je=Ee._mult((be-ye)/se)._add(ae||fe),Ke=F+Math.atan2(he.y-fe.y,he.x-fe.x);return we.push(je),{point:je,angle:A?Ke:0,path:we}}const Tt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function zt(v,n){for(let l=0;l<v;l++){const d=n.length;n.resize(d+4),n.float32.set(Tt,3*d)}}function on(v,n,l){const d=n[0],f=n[1];return v[0]=l[0]*d+l[4]*f+l[12],v[1]=l[1]*d+l[5]*f+l[13],v[3]=l[3]*d+l[7]*f+l[15],v}const Gt=100;class an{constructor(n,l,d=new Zt(n.width+200,n.height+200,25),f=new Zt(n.width+200,n.height+200,25)){this.transform=n,this.mapProjection=l,this.grid=d,this.ignoredGrid=f,this.pitchFactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Gt,this.screenBottomBoundary=n.height+Gt,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,l,d,f,y,w,C,A,z,B,F){const q=n.anchorPointX+A[0],J=n.anchorPointY+A[1],ee=this.projectAndGetPerspectiveRatio(f,q,J,y,B),ae=d*ee.perspectiveRatio;let he;if(w||C)he=this._projectCollisionBox(n,ae,f,y,w,C,A,ee,B,F);else{const we=ee.point.x+(F?F.x*ae:0),Ee=ee.point.y+(F?F.y*ae:0);he={allPointsOccluded:!1,box:[we+n.x1*ae,Ee+n.y1*ae,we+n.x2*ae,Ee+n.y2*ae]}}const[fe,ye,se,be]=he.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?he.allPointsOccluded:this.mapProjection.isOccluded(q,J,y))||ee.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(fe,ye,se,be)||l!=="always"&&this.grid.hitTest(fe,ye,se,be,l,z)?{box:[fe,ye,se,be],placeable:!1,offscreen:!1}:{box:[fe,ye,se,be],placeable:!0,offscreen:this.isOffscreen(fe,ye,se,be)}}placeCollisionCircles(n,l,d,f,y,w,C,A,z,B,F,q,J,ee,ae,he){const fe=[],ye=new c.P(l.anchorX,l.anchorY),se=this.getPerspectiveRatio(w,ye.x,ye.y,C,he),be=(F?y/se:y*se)/c.ap,we={getElevation:he,labelPlaneMatrix:A,lineVertexArray:d,pitchWithMap:F,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ye,unwrappedTileID:C,width:this.transform.width,height:this.transform.height,translation:ae},Ee=ne(be,f,l.lineOffsetX*be,l.lineOffsetY*be,!1,l,!1,we);let je=!1,Ke=!1,lt=!0;if(Ee){const ft=.5*J*se+ee,it=new c.P(-100,-100),rt=new c.P(this.screenRightBoundary,this.screenBottomBoundary),wt=new Bt,Vt=Ee.first,st=Ee.last;let ut=[];for(let qt=Vt.path.length-1;qt>=1;qt--)ut.push(Vt.path[qt]);for(let qt=1;qt<st.path.length;qt++)ut.push(st.path[qt]);const Ot=2.5*ft;if(z){const qt=this.projectPathToScreenSpace(ut,we,z);ut=qt.some(tn=>tn.signedDistanceFromCamera<=0)?[]:qt.map(tn=>tn.point)}let In=[];if(ut.length>0){const qt=ut[0].clone(),tn=ut[0].clone();for(let An=1;An<ut.length;An++)qt.x=Math.min(qt.x,ut[An].x),qt.y=Math.min(qt.y,ut[An].y),tn.x=Math.max(tn.x,ut[An].x),tn.y=Math.max(tn.y,ut[An].y);In=qt.x>=it.x&&tn.x<=rt.x&&qt.y>=it.y&&tn.y<=rt.y?[ut]:tn.x<it.x||qt.x>rt.x||tn.y<it.y||qt.y>rt.y?[]:c.al([ut],it.x,it.y,rt.x,rt.y)}for(const qt of In){wt.reset(qt,.25*ft);let tn=0;tn=wt.length<=.5*ft?1:Math.ceil(wt.paddedLength/Ot)+1;for(let An=0;An<tn;An++){const Mr=An/Math.max(tn-1,1),qi=wt.lerp(Mr),Mn=qi.x+Gt,Jr=qi.y+Gt;fe.push(Mn,Jr,ft,0);const Vr=Mn-ft,Dr=Jr-ft,Ur=Mn+ft,us=Jr+ft;if(lt=lt&&this.isOffscreen(Vr,Dr,Ur,us),Ke=Ke||this.isInsideGrid(Vr,Dr,Ur,us),n!=="always"&&this.grid.hitTestCircle(Mn,Jr,ft,n,q)&&(je=!0,!B))return{circles:[],offscreen:!1,collisionDetected:je}}}}return{circles:!B&&je||!Ke||se<this.perspectiveRatioCutoff?[]:fe,offscreen:lt,collisionDetected:je}}projectPathToScreenSpace(n,l,d){return n.map(f=>ie(f.x,f.y,d,l.getElevation))}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let d=1/0,f=1/0,y=-1/0,w=-1/0;for(const B of n){const F=new c.P(B.x+Gt,B.y+Gt);d=Math.min(d,F.x),f=Math.min(f,F.y),y=Math.max(y,F.x),w=Math.max(w,F.y),l.push(F)}const C=this.grid.query(d,f,y,w).concat(this.ignoredGrid.query(d,f,y,w)),A={},z={};for(const B of C){const F=B.key;if(A[F.bucketInstanceId]===void 0&&(A[F.bucketInstanceId]={}),A[F.bucketInstanceId][F.featureIndex])continue;const q=[new c.P(B.x1,B.y1),new c.P(B.x2,B.y1),new c.P(B.x2,B.y2),new c.P(B.x1,B.y2)];c.am(l,q)&&(A[F.bucketInstanceId][F.featureIndex]=!0,z[F.bucketInstanceId]===void 0&&(z[F.bucketInstanceId]=[]),z[F.bucketInstanceId].push(F.featureIndex))}return z}insertCollisionBox(n,l,d,f,y,w){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:w,overlapMode:l},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,d,f,y,w){const C=d?this.ignoredGrid:this.grid,A={bucketInstanceId:f,featureIndex:y,collisionGroupID:w,overlapMode:l};for(let z=0;z<n.length;z+=4)C.insertCircle(A,n[z],n[z+1],n[z+2])}projectAndGetPerspectiveRatio(n,l,d,f,y){let w;y?(w=[l,d,y(l,d),1],c.af(w,w,n)):(w=[l,d,0,1],on(w,w,n));const C=w[3];return{point:new c.P((w[0]/C+1)/2*this.transform.width+Gt,(-w[1]/C+1)/2*this.transform.height+Gt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}getPerspectiveRatio(n,l,d,f,y){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(l,d,f,y):ie(l,d,n,y);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(n,l,d,f){return d<Gt||n>=this.screenRightBoundary||f<Gt||l>this.screenBottomBoundary}isInsideGrid(n,l,d,f){return d>=0&&n<this.gridRightBoundary&&f>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=c.an([]);return c.J(n,n,[-100,-100,0]),n}_projectCollisionBox(n,l,d,f,y,w,C,A,z,B){let F=new c.P(1,0),q=new c.P(0,1);const J=new c.P(n.anchorPointX+C[0],n.anchorPointY+C[1]);if(w&&!y){const lt=this.projectAndGetPerspectiveRatio(d,J.x+1,J.y,f,z).point.sub(A.point).unit(),ft=Math.atan(lt.y/lt.x)+(lt.x<0?Math.PI:0),it=Math.sin(ft),rt=Math.cos(ft);F=new c.P(rt,it),q=new c.P(-it,rt)}else if(!w&&y){const lt=-this.transform.angle,ft=Math.sin(lt),it=Math.cos(lt);F=new c.P(it,ft),q=new c.P(-ft,it)}let ee=A.point,ae=l;if(y){ee=J;const lt=this.transform.zoom-Math.floor(this.transform.zoom);ae=Math.pow(2,-lt),ae*=this.mapProjection.getPitchedTextCorrection(this.transform,J,f),B||(ae*=c.ac(.5+A.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}B&&(ee=ee.add(F.mult(B.x*ae)).add(q.mult(B.y*ae)));const he=n.x1*ae,fe=n.x2*ae,ye=(he+fe)/2,se=n.y1*ae,be=n.y2*ae,we=(se+be)/2,Ee=[{offsetX:he,offsetY:se},{offsetX:ye,offsetY:se},{offsetX:fe,offsetY:se},{offsetX:fe,offsetY:we},{offsetX:fe,offsetY:be},{offsetX:ye,offsetY:be},{offsetX:he,offsetY:be},{offsetX:he,offsetY:we}];let je=[];for(const{offsetX:lt,offsetY:ft}of Ee)je.push(new c.P(ee.x+F.x*lt+q.x*ft,ee.y+F.y*lt+q.y*ft));let Ke=!1;if(y){const lt=je.map(ft=>this.projectAndGetPerspectiveRatio(d,ft.x,ft.y,f,z));Ke=lt.some(ft=>!ft.isOccluded),je=lt.map(ft=>ft.point)}else Ke=!0;return{box:c.ao(je),allPointsOccluded:!Ke}}}function en(v,n,l){return n*(c.X/(v.tileSize*Math.pow(2,l-v.tileID.overscaledZ)))}class nr{constructor(n,l,d,f){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):f&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class Bn{constructor(n,l,d,f,y){this.text=new nr(n?n.text:null,l,d,y),this.icon=new nr(n?n.icon:null,l,f,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xt{constructor(n,l,d){this.text=n,this.icon=l,this.skipFade=d}}class mn{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class Rn{constructor(n,l,d,f,y){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=d,this.bucketIndex=f,this.tileID=y}}class fr{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:d=>d.collisionGroupID===l}}return this.collisionGroups[n]}}function br(v,n,l,d,f){const{horizontalAlign:y,verticalAlign:w}=c.au(v);return new c.P(-(y-.5)*n+d[0]*f,-(w-.5)*l+d[1]*f)}class jr{constructor(n,l,d,f,y,w){this.transform=n.clone(),this.terrain=d,this.collisionIndex=new an(this.transform,l),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new fr(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const l=this.terrain;return l?(d,f)=>l.getElevation(n,d,f):null}getBucketParts(n,l,d,f){const y=d.getBucket(l),w=d.latestFeatureIndex;if(!y||!w||l.id!==y.layerIds[0])return;const C=d.collisionBoxArray,A=y.layers[0].layout,z=y.layers[0].paint,B=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),F=d.tileSize/c.X,q=d.tileID.toUnwrapped(),J=this.transform.calculatePosMatrix(q),ee=A.get("text-pitch-alignment")==="map",ae=A.get("text-rotation-alignment")==="map",he=en(d,1,this.transform.zoom),fe=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("text-translate"),z.get("text-translate-anchor")),ye=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("icon-translate"),z.get("icon-translate-anchor")),se=Qt(J,ee,ae,this.transform,he);let be=null;if(ee){const Ee=Ht(J,ee,ae,this.transform,he);be=c.L([],this.transform.labelPlaneMatrix,Ee)}this.retainedQueryData[y.bucketInstanceId]=new Rn(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,d.tileID);const we={bucket:y,layout:A,translationText:fe,translationIcon:ye,posMatrix:J,unwrappedTileID:q,textLabelPlaneMatrix:se,labelToScreenMatrix:be,scale:B,textPixelRatio:F,holdingForFade:d.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:c.ag(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(f)for(const Ee of y.sortKeyRanges){const{sortKey:je,symbolInstanceStart:Ke,symbolInstanceEnd:lt}=Ee;n.push({sortKey:je,symbolInstanceStart:Ke,symbolInstanceEnd:lt,parameters:we})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:we})}attemptAnchorPlacement(n,l,d,f,y,w,C,A,z,B,F,q,J,ee,ae,he,fe,ye,se){const be=c.aq[n.textAnchor],we=[n.textOffset0,n.textOffset1],Ee=br(be,d,f,we,y),je=this.collisionIndex.placeCollisionBox(l,q,A,z,B,C,w,he,F.predicate,se,Ee);if((!ye||this.collisionIndex.placeCollisionBox(ye,q,A,z,B,C,w,fe,F.predicate,se,Ee).placeable)&&je.placeable){let Ke;if(this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(Ke=this.prevPlacement.variableOffsets[J.crossTileID].anchor),J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[J.crossTileID]={textOffset:we,width:d,height:f,anchor:be,textBoxScale:y,prevAnchor:Ke},this.markUsedJustification(ee,be,J,ae),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,ae,J),this.placedOrientations[J.crossTileID]=ae),{shift:Ee,placedGlyphBoxes:je}}}placeLayerBucketPart(n,l,d){const{bucket:f,layout:y,translationText:w,translationIcon:C,posMatrix:A,unwrappedTileID:z,textLabelPlaneMatrix:B,labelToScreenMatrix:F,textPixelRatio:q,holdingForFade:J,collisionBoxArray:ee,partiallyEvaluatedTextSize:ae,collisionGroup:he}=n.parameters,fe=y.get("text-optional"),ye=y.get("icon-optional"),se=c.ar(y,"text-overlap","text-allow-overlap"),be=se==="always",we=c.ar(y,"icon-overlap","icon-allow-overlap"),Ee=we==="always",je=y.get("text-rotation-alignment")==="map",Ke=y.get("text-pitch-alignment")==="map",lt=y.get("icon-text-fit")!=="none",ft=y.get("symbol-z-order")==="viewport-y",it=be&&(Ee||!f.hasIconData()||ye),rt=Ee&&(be||!f.hasTextData()||fe);!f.collisionArrays&&ee&&f.deserializeCollisionBoxes(ee);const wt=this._getTerrainElevationFunc(this.retainedQueryData[f.bucketInstanceId].tileID),Vt=(st,ut,Ot)=>{var In,qt;if(l[st.crossTileID])return;if(J)return void(this.placements[st.crossTileID]=new Xt(!1,!1,!1));let tn=!1,An=!1,Mr=!0,qi=null,Mn={box:null,placeable:!1,offscreen:null},Jr={placeable:!1},Vr=null,Dr=null,Ur=null,us=0,ia=0,_c=0;ut.textFeatureIndex?us=ut.textFeatureIndex:st.useRuntimeCollisionCircles&&(us=st.featureIndex),ut.verticalTextFeatureIndex&&(ia=ut.verticalTextFeatureIndex);const sa=ut.textBox;if(sa){const Mi=wr=>{let zr=c.ah.horizontal;if(f.allowVerticalPlacement&&!wr&&this.prevPlacement){const mi=this.prevPlacement.placedOrientations[st.crossTileID];mi&&(this.placedOrientations[st.crossTileID]=mi,zr=mi,this.markUsedOrientation(f,zr,st))}return zr},Di=(wr,zr)=>{if(f.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&ut.verticalTextBox){for(const mi of f.writingModes)if(mi===c.ah.vertical?(Mn=zr(),Jr=Mn):Mn=wr(),Mn&&Mn.placeable)break}else Mn=wr()},Us=st.textAnchorOffsetStartIndex,Zi=st.textAnchorOffsetEndIndex;if(Zi===Us){const wr=(zr,mi)=>{const rn=this.collisionIndex.placeCollisionBox(zr,se,q,A,z,Ke,je,w,he.predicate,wt);return rn&&rn.placeable&&(this.markUsedOrientation(f,mi,st),this.placedOrientations[st.crossTileID]=mi),rn};Di(()=>wr(sa,c.ah.horizontal),()=>{const zr=ut.verticalTextBox;return f.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&zr?wr(zr,c.ah.vertical):{box:null,offscreen:null}}),Mi(Mn&&Mn.placeable)}else{let wr=c.aq[(qt=(In=this.prevPlacement)===null||In===void 0?void 0:In.variableOffsets[st.crossTileID])===null||qt===void 0?void 0:qt.anchor];const zr=(rn,yo,oa)=>{const aa=rn.x2-rn.x1,Vf=rn.y2-rn.y1,Wg=st.textBoxScale,Uf=lt&&we==="never"?yo:null;let $s=null,$f=se==="never"?1:2,bc="never";wr&&$f++;for(let cl=0;cl<$f;cl++){for(let wc=Us;wc<Zi;wc++){const Sc=f.textAnchorOffsets.get(wc);if(wr&&Sc.textAnchor!==wr)continue;const la=this.attemptAnchorPlacement(Sc,rn,aa,Vf,Wg,je,Ke,q,A,z,he,bc,st,f,oa,w,C,Uf,wt);if(la&&($s=la.placedGlyphBoxes,$s&&$s.placeable))return tn=!0,qi=la.shift,$s}wr?wr=null:bc=se}return d&&!$s&&($s={box:this.collisionIndex.placeCollisionBox(sa,"always",q,A,z,Ke,je,w,he.predicate,wt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),$s};Di(()=>zr(sa,ut.iconBox,c.ah.horizontal),()=>{const rn=ut.verticalTextBox;return f.allowVerticalPlacement&&(!Mn||!Mn.placeable)&&st.numVerticalGlyphVertices>0&&rn?zr(rn,ut.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Mn&&(tn=Mn.placeable,Mr=Mn.offscreen);const mi=Mi(Mn&&Mn.placeable);if(!tn&&this.prevPlacement){const rn=this.prevPlacement.variableOffsets[st.crossTileID];rn&&(this.variableOffsets[st.crossTileID]=rn,this.markUsedJustification(f,rn.anchor,st,mi))}}}if(Vr=Mn,tn=Vr&&Vr.placeable,Mr=Vr&&Vr.offscreen,st.useRuntimeCollisionCircles){const Mi=f.text.placedSymbolArray.get(st.centerJustifiedTextSymbolIndex),Di=c.ai(f.textSizeData,ae,Mi),Us=y.get("text-padding");Dr=this.collisionIndex.placeCollisionCircles(se,Mi,f.lineVertexArray,f.glyphOffsetArray,Di,A,z,B,F,d,Ke,he.predicate,st.collisionCircleDiameter,Us,w,wt),Dr.circles.length&&Dr.collisionDetected&&!d&&c.w("Collisions detected, but collision boxes are not shown"),tn=be||Dr.circles.length>0&&!Dr.collisionDetected,Mr=Mr&&Dr.offscreen}if(ut.iconFeatureIndex&&(_c=ut.iconFeatureIndex),ut.iconBox){const Mi=Di=>this.collisionIndex.placeCollisionBox(Di,we,q,A,z,Ke,je,C,he.predicate,wt,lt&&qi?qi:void 0);Jr&&Jr.placeable&&ut.verticalIconBox?(Ur=Mi(ut.verticalIconBox),An=Ur.placeable):(Ur=Mi(ut.iconBox),An=Ur.placeable),Mr=Mr&&Ur.offscreen}const Ai=fe||st.numHorizontalGlyphVertices===0&&st.numVerticalGlyphVertices===0,xc=ye||st.numIconVertices===0;Ai||xc?xc?Ai||(An=An&&tn):tn=An&&tn:An=tn=An&&tn;const Sh=An&&Ur.placeable;if(tn&&Vr.placeable&&this.collisionIndex.insertCollisionBox(Vr.box,se,y.get("text-ignore-placement"),f.bucketInstanceId,Jr&&Jr.placeable&&ia?ia:us,he.ID),Sh&&this.collisionIndex.insertCollisionBox(Ur.box,we,y.get("icon-ignore-placement"),f.bucketInstanceId,_c,he.ID),Dr&&tn&&this.collisionIndex.insertCollisionCircles(Dr.circles,se,y.get("text-ignore-placement"),f.bucketInstanceId,us,he.ID),d&&this.storeCollisionData(f.bucketInstanceId,Ot,ut,Vr,Ur,Dr),st.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[st.crossTileID]=new Xt(tn||it,An||rt,Mr||f.justReloaded),l[st.crossTileID]=!0};if(ft){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const st=f.getSortedSymbolIndexes(this.transform.angle);for(let ut=st.length-1;ut>=0;--ut){const Ot=st[ut];Vt(f.symbolInstances.get(Ot),f.collisionArrays[Ot],Ot)}}else for(let st=n.symbolInstanceStart;st<n.symbolInstanceEnd;st++)Vt(f.symbolInstances.get(st),f.collisionArrays[st],st);if(d&&f.bucketInstanceId in this.collisionCircleArrays){const st=this.collisionCircleArrays[f.bucketInstanceId];c.as(st.invProjMatrix,A),st.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}storeCollisionData(n,l,d,f,y,w){if(d.textBox||d.iconBox){let C,A;this.collisionBoxArrays.has(n)?C=this.collisionBoxArrays.get(n):(C=new Map,this.collisionBoxArrays.set(n,C)),C.has(l)?A=C.get(l):(A={text:null,icon:null},C.set(l,A)),d.textBox&&(A.text=f.box),d.iconBox&&(A.icon=y.box)}if(w){let C=this.collisionCircleArrays[n];C===void 0&&(C=this.collisionCircleArrays[n]=new mn);for(let A=0;A<w.circles.length;A+=4)C.circles.push(w.circles[A+0]),C.circles.push(w.circles[A+1]),C.circles.push(w.circles[A+2]),C.circles.push(w.collisionDetected?1:0)}}markUsedJustification(n,l,d,f){let y;y=f===c.ah.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[c.at(l)];const w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const C of w)C>=0&&(n.text.placedSymbolArray.get(C).crossTileID=y>=0&&C!==y?0:d.crossTileID)}markUsedOrientation(n,l,d){const f=l===c.ah.horizontal||l===c.ah.horizontalOnly?l:0,y=l===c.ah.vertical?l:0,w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const C of w)n.text.placedSymbolArray.get(C).placedOrientation=f;d.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let d=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const f=l?l.symbolFadeChange(n):1,y=l?l.opacities:{},w=l?l.variableOffsets:{},C=l?l.placedOrientations:{};for(const A in this.placements){const z=this.placements[A],B=y[A];B?(this.opacities[A]=new Bn(B,f,z.text,z.icon),d=d||z.text!==B.text.placed||z.icon!==B.icon.placed):(this.opacities[A]=new Bn(null,f,z.text,z.icon,z.skipFade),d=d||z.text||z.icon)}for(const A in y){const z=y[A];if(!this.opacities[A]){const B=new Bn(z,f,!1,!1);B.isHidden()||(this.opacities[A]=B,d=d||z.text.placed||z.icon.placed)}}for(const A in w)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=w[A]);for(const A in C)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=C[A]);if(l&&l.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l){const d={};for(const f of l){const y=f.getBucket(n);y&&f.latestFeatureIndex&&n.id===y.layerIds[0]&&this.updateBucketOpacities(y,f.tileID,d,f.collisionBoxArray)}}updateBucketOpacities(n,l,d,f){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const y=n.layers[0],w=y.layout,C=new Bn(null,0,!1,!1,!0),A=w.get("text-allow-overlap"),z=w.get("icon-allow-overlap"),B=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),F=w.get("text-rotation-alignment")==="map",q=w.get("text-pitch-alignment")==="map",J=w.get("icon-text-fit")!=="none",ee=new Bn(null,0,A&&(z||!n.hasIconData()||w.get("icon-optional")),z&&(A||!n.hasTextData()||w.get("text-optional")),!0);!n.collisionArrays&&f&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(f);const ae=(fe,ye,se)=>{for(let be=0;be<ye/4;be++)fe.opacityVertexArray.emplaceBack(se);fe.hasVisibleVertices=fe.hasVisibleVertices||se!==No},he=this.collisionBoxArrays.get(n.bucketInstanceId);for(let fe=0;fe<n.symbolInstances.length;fe++){const ye=n.symbolInstances.get(fe),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:be,crossTileID:we}=ye;let Ee=this.opacities[we];d[we]?Ee=C:Ee||(Ee=ee,this.opacities[we]=Ee),d[we]=!0;const je=ye.numIconVertices>0,Ke=this.placedOrientations[ye.crossTileID],lt=Ke===c.ah.vertical,ft=Ke===c.ah.horizontal||Ke===c.ah.horizontalOnly;if(se>0||be>0){const rt=di(Ee.text);ae(n.text,se,lt?No:rt),ae(n.text,be,ft?No:rt);const wt=Ee.text.isHidden();[ye.rightJustifiedTextSymbolIndex,ye.centerJustifiedTextSymbolIndex,ye.leftJustifiedTextSymbolIndex].forEach(ut=>{ut>=0&&(n.text.placedSymbolArray.get(ut).hidden=wt||lt?1:0)}),ye.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(ye.verticalPlacedTextSymbolIndex).hidden=wt||ft?1:0);const Vt=this.variableOffsets[ye.crossTileID];Vt&&this.markUsedJustification(n,Vt.anchor,ye,Ke);const st=this.placedOrientations[ye.crossTileID];st&&(this.markUsedJustification(n,"left",ye,st),this.markUsedOrientation(n,st,ye))}if(je){const rt=di(Ee.icon),wt=!(J&&ye.verticalPlacedIconSymbolIndex&&lt);ye.placedIconSymbolIndex>=0&&(ae(n.icon,ye.numIconVertices,wt?rt:No),n.icon.placedSymbolArray.get(ye.placedIconSymbolIndex).hidden=Ee.icon.isHidden()),ye.verticalPlacedIconSymbolIndex>=0&&(ae(n.icon,ye.numVerticalIconVertices,wt?No:rt),n.icon.placedSymbolArray.get(ye.verticalPlacedIconSymbolIndex).hidden=Ee.icon.isHidden())}const it=he&&he.has(fe)?he.get(fe):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const rt=n.collisionArrays[fe];if(rt){let wt=new c.P(0,0);if(rt.textBox||rt.verticalTextBox){let Vt=!0;if(B){const st=this.variableOffsets[we];st?(wt=br(st.anchor,st.width,st.height,st.textOffset,st.textBoxScale),F&&wt._rotate(q?this.transform.angle:-this.transform.angle)):Vt=!1}if(rt.textBox||rt.verticalTextBox){let st;rt.textBox&&(st=lt),rt.verticalTextBox&&(st=ft),Fo(n.textCollisionBox.collisionVertexArray,Ee.text.placed,!Vt||st,it.text,wt.x,wt.y)}}if(rt.iconBox||rt.verticalIconBox){const Vt=!!(!ft&&rt.verticalIconBox);let st;rt.iconBox&&(st=Vt),rt.verticalIconBox&&(st=!Vt),Fo(n.iconCollisionBox.collisionVertexArray,Ee.icon.placed,st,it.icon,J?wt.x:0,J?wt.y:0)}}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const fe=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=fe.invProjMatrix,n.placementViewportMatrix=fe.viewportMatrix,n.collisionCircleArray=fe.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const d=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*d>n}setStale(){this.stale=!0}}function Fo(v,n,l,d,f,y){d&&d.length!==0||(d=[0,0,0,0]);const w=d[0]-Gt,C=d[1]-Gt,A=d[2]-Gt,z=d[3]-Gt;v.emplaceBack(n?1:0,l?1:0,f||0,y||0,w,C),v.emplaceBack(n?1:0,l?1:0,f||0,y||0,A,C),v.emplaceBack(n?1:0,l?1:0,f||0,y||0,A,z),v.emplaceBack(n?1:0,l?1:0,f||0,y||0,w,z)}const gn=Math.pow(2,25),Ru=Math.pow(2,24),Lu=Math.pow(2,17),ui=Math.pow(2,16),hi=Math.pow(2,9),xg=Math.pow(2,8),Ci=Math.pow(2,1);function di(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const n=v.placed?1:0,l=Math.floor(127*v.opacity);return l*gn+n*Ru+l*Lu+n*ui+l*hi+n*xg+l*Ci+n}const No=0;function io(){return{isOccluded:(v,n,l)=>!1,getPitchedTextCorrection:(v,n,l)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(v,n,l,d){throw new Error("Not implemented.")},translatePosition:(v,n,l,d)=>function(f,y,w,C,A=!1){if(!w[0]&&!w[1])return[0,0];const z=A?C==="map"?f.angle:0:C==="viewport"?-f.angle:0;if(z){const B=Math.sin(z),F=Math.cos(z);w=[w[0]*F-w[1]*B,w[0]*B+w[1]*F]}return[A?w[0]:en(y,w[0],f.zoom),A?w[1]:en(y,w[1],f.zoom)]}(v,n,l,d),getCircleRadiusCorrection:v=>1}}class rr{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,l,d,f,y){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(w,f,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((C,A)=>C.sortKey-A.sortKey));this._currentPartIndex<w.length;)if(l.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,y())return!0;return!1}}class Ha{constructor(n,l,d,f,y,w,C,A){this.placement=new jr(n,io(),l,w,C,A),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(n,l,d){const f=k.now(),y=()=>!this._forceFullPlacement&&k.now()-f>2;for(;this._currentPlacementIndex>=0;){const w=l[n[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=C)&&(!w.maxzoom||w.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new rr(w)),this._inProgressLayer.continuePlacement(d[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Ui=512/c.X/2;class Wn{constructor(n,l,d){this.tileID=n,this.bucketInstanceId=d,this._symbolsByKey={};const f=new Map;for(let y=0;y<l.length;y++){const w=l.get(y),C=w.key,A=f.get(C);A?A.push(w):f.set(C,[w])}for(const[y,w]of f){const C={positions:w.map(A=>({x:Math.floor(A.anchorX*Ui),y:Math.floor(A.anchorY*Ui)})),crossTileIDs:w.map(A=>A.crossTileID)};if(C.positions.length>128){const A=new c.av(C.positions.length,16,Uint16Array);for(const{x:z,y:B}of C.positions)A.add(z,B);A.finish(),delete C.positions,C.index=A}this._symbolsByKey[y]=C}}getScaledCoordinates(n,l){const{x:d,y:f,z:y}=this.tileID.canonical,{x:w,y:C,z:A}=l.canonical,z=Ui/Math.pow(2,A-y),B=(C*c.X+n.anchorY)*z,F=f*c.X*Ui;return{x:Math.floor((w*c.X+n.anchorX)*z-d*c.X*Ui),y:Math.floor(B-F)}}findMatches(n,l,d){const f=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let y=0;y<n.length;y++){const w=n.get(y);if(w.crossTileID)continue;const C=this._symbolsByKey[w.key];if(!C)continue;const A=this.getScaledCoordinates(w,l);if(C.index){const z=C.index.range(A.x-f,A.y-f,A.x+f,A.y+f).sort();for(const B of z){const F=C.crossTileIDs[B];if(!d[F]){d[F]=!0,w.crossTileID=F;break}}}else if(C.positions)for(let z=0;z<C.positions.length;z++){const B=C.positions[z],F=C.crossTileIDs[z];if(Math.abs(B.x-A.x)<=f&&Math.abs(B.y-A.y)<=f&&!d[F]){d[F]=!0,w.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class Ul{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $i{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const d in this.indexes){const f=this.indexes[d],y={};for(const w in f){const C=f[w];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+l),y[C.tileID.key]=C}this.indexes[d]=y}this.lng=n}addBucket(n,l,d){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let y=0;y<l.symbolInstances.length;y++)l.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const f=this.usedCrossTileIDs[n.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>n.overscaledZ)for(const C in w){const A=w[C];A.tileID.isChildOf(n)&&A.findMatches(l.symbolInstances,n,f)}else{const C=w[n.scaledTo(Number(y)).key];C&&C.findMatches(l.symbolInstances,n,f)}}for(let y=0;y<l.symbolInstances.length;y++){const w=l.symbolInstances.get(y);w.crossTileID||(w.crossTileID=d.generate(),f[w.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Wn(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const d of l.getCrossTileIDsLists())for(const f of d)delete this.usedCrossTileIDs[n][f]}removeStaleBuckets(n){let l=!1;for(const d in this.indexes){const f=this.indexes[d];for(const y in f)n[f[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,f[y]),delete f[y],l=!0)}return l}}class Bu{constructor(){this.layerIndexes={},this.crossTileIDs=new Ul,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,d){let f=this.layerIndexes[n.id];f===void 0&&(f=this.layerIndexes[n.id]=new $i);let y=!1;const w={};f.handleWrapJump(d);for(const C of l){const A=C.getBucket(n);A&&n.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(C.tileID,A,this.crossTileIDs)&&(y=!0),w[A.bucketInstanceId]=!0)}return f.removeStaleBuckets(w)&&(y=!0),y}pruneUnusedLayers(n){const l={};n.forEach(d=>{l[d]=!0});for(const d in this.layerIndexes)l[d]||delete this.layerIndexes[d]}}const Hi=(v,n)=>c.t(v,n&&n.filter(l=>l.identifier!=="source.canvas")),bg=c.aw();class $l extends c.E{constructor(n,l={}){super(),this._rtlPluginLoaded=()=>{for(const d in this.sourceCaches){const f=this.sourceCaches[d].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[d].reload()}},this.map=n,this.dispatcher=new Ut(Pt(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(d,f)=>this.getGlyphs(d,f)),this.dispatcher.registerMessageHandler("GI",(d,f)=>this.getImages(d,f)),this.imageManager=new ze,this.imageManager.setEventedParent(this),this.glyphManager=new $e(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Ve(256,512),this.crossTileSymbolIndex=new Bu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),cr().on(qe,this._rtlPluginLoaded),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const f=this.sourceCaches[d.sourceId];if(!f)return;const y=f.getSource();if(y&&y.vectorLayerIds)for(const w in this._layers){const C=this._layers[w];C.source===y.id&&this._validateLayer(C)}})}loadURL(n,l={},d){this.fire(new c.k("dataloading",{dataType:"style"})),l.validate=typeof l.validate!="boolean"||l.validate;const f=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;c.h(f,this._loadStyleRequest).then(w=>{this._loadStyleRequest=null,this._load(w.data,l,d)}).catch(w=>{this._loadStyleRequest=null,w&&!y.signal.aborted&&this.fire(new c.j(w))})}loadJSON(n,l={},d){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,k.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,l.validate=l.validate!==!1,this._load(n,l,d)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(bg,{validate:!1})}_load(n,l,d){var f;const y=l.transformStyle?l.transformStyle(d,n):n;if(!l.validate||!Hi(this,c.u(y))){this._loaded=!0,this.stylesheet=y;for(const w in y.sources)this.addSource(w,y.sources[w],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new et(this.stylesheet.light),this.sky=new Le(this.stylesheet.sky),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const n=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(l=>l.id),this._layers={},this._serializedLayers=null;for(const l of n){const d=c.aA(l);d.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=d}}_loadSprite(n,l=!1,d=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,w,C,A){return c._(this,void 0,void 0,function*(){const z=De(y),B=C>1?"@2x":"",F={},q={};for(const{id:J,url:ee}of z){const ae=w.transformRequest(Be(ee,B,".json"),"SpriteJSON");F[J]=c.h(ae,A);const he=w.transformRequest(Be(ee,B,".png"),"SpriteImage");q[J]=W.getImage(he,A)}return yield Promise.all([...Object.values(F),...Object.values(q)]),function(J,ee){return c._(this,void 0,void 0,function*(){const ae={};for(const he in J){ae[he]={};const fe=k.getImageCanvasContext((yield ee[he]).data),ye=(yield J[he]).data;for(const se in ye){const{width:be,height:we,x:Ee,y:je,sdf:Ke,pixelRatio:lt,stretchX:ft,stretchY:it,content:rt,textFitWidth:wt,textFitHeight:Vt}=ye[se];ae[he][se]={data:null,pixelRatio:lt,sdf:Ke,stretchX:ft,stretchY:it,content:rt,textFitWidth:wt,textFitHeight:Vt,spriteData:{width:be,height:we,x:Ee,y:je,context:fe}}}}return ae})}(F,q)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const w in y){this._spritesImagesIds[w]=[];const C=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(A=>!(A in y)):[];for(const A of C)this.imageManager.removeImage(A),this._changedImages[A]=!0;for(const A in y[w]){const z=w==="default"?A:`${w}:${A}`;this._spritesImagesIds[w].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,y[w][A],!1):this.imageManager.addImage(z,y[w][A]),l&&(this._changedImages[z]=!0)}}}).catch(y=>{this._spriteRequest=null,f=y,this.fire(new c.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),l&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),d&&d(f)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(n){const l=this.sourceCaches[n.source];if(!l)return;const d=n.sourceLayer;if(!d)return;const f=l.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(d)===-1)&&this.fire(new c.j(new Error(`Source layer "${d}" does not exist on source "${f.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,l=!1){const d=this._serializedAllLayers();if(!n||n.length===0)return Object.values(l?c.aB(d):d);const f=[];for(const y of n)if(d[y]){const w=l?c.aB(d[y]):d[y];f.push(w)}return f}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const l=Object.keys(this._layers);for(const d of l){const f=this._layers[d];f.type!=="custom"&&(n[d]=f.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const l=this._changed;if(l){const f=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(f.length||y.length)&&this._updateWorkerLayers(f,y);for(const w in this._updatedSources){const C=this._updatedSources[w];if(C==="reload")this._reloadSource(w);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const d={};for(const f in this.sourceCaches){const y=this.sourceCaches[f];d[f]=y.used,y.used=!1}for(const f of this._order){const y=this._layers[f];y.recalculate(n,this._availableImages),!y.isHidden(n.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const f in d){const y=this.sourceCaches[f];!!d[f]!=!!y.used&&y.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(n),this.sky.recalculate(n),this.z=n.zoom,l&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,l){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,l={}){var d;this._checkLoaded();const f=this.serialize();if(n=l.transformStyle?l.transformStyle(f,n):n,((d=l.validate)===null||d===void 0||d)&&Hi(this,c.u(n)))return!1;(n=c.aB(n)).layers=c.az(n.layers);const y=c.aC(f,n),w=this._getOperationsToPerform(y);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const C of w.operations)C();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const l=[],d=[];for(const f of n)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":l.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":l.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":l.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":l.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":l.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":l.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":l.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":l.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":l.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":l.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":l.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":l.push(()=>this.setSprite.apply(this,f.args));break;case"setSky":l.push(()=>this.setSky.apply(this,f.args));break;case"setTerrain":l.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setTransition":l.push(()=>{});break;default:d.push(f.command)}return{operations:l,unimplemented:d}}addImage(n,l){if(this.getImage(n))return this.fire(new c.j(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,l),this._afterImageUpdated(n)}updateImage(n,l){this.imageManager.updateImage(n,l)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new c.j(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,l,d={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(c.u.source,`sources.${n}`,l,null,d))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const f=this.sourceCaches[n]=new Dt(n,l,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:n})),f.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===n)return this.fire(new c.j(new Error(`Source "${n}" cannot be removed while layer "${d}" is using it.`)));const l=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],l.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),l.setEventedParent(null),l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,l){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const d=this.sourceCaches[n].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(l),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,l,d={}){this._checkLoaded();const f=n.id;if(this.getLayer(f))return void this.fire(new c.j(new Error(`Layer "${f}" already exists on this map.`)));let y;if(n.type==="custom"){if(Hi(this,c.aD(n)))return;y=c.aA(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(f,n.source),n=c.aB(n),n=c.e(n,{source:f})),this._validate(c.u.layer,`layers.${f}`,n,{arrayIndex:-1},d))return;y=c.aA(n),this._validateLayer(y),y.setEventedParent(this,{layer:{id:f}})}const w=l?this._order.indexOf(l):this._order.length;if(l&&w===-1)this.fire(new c.j(new Error(`Cannot add layer "${f}" before non-existing layer "${l}".`)));else{if(this._order.splice(w,0,f),this._layerOrderChanged=!0,this._layers[f]=y,this._removedLayers[f]&&y.source&&y.type!=="custom"){const C=this._removedLayers[f];delete this._removedLayers[f],C.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(n,l){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new c.j(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===l)return;const d=this._order.indexOf(n);this._order.splice(d,1);const f=l?this._order.indexOf(l):this._order.length;l&&f===-1?this.fire(new c.j(new Error(`Cannot move layer "${n}" before non-existing layer "${l}".`))):(this._order.splice(f,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const l=this._layers[n];if(!l)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${n}".`)));l.setEventedParent(null);const d=this._order.indexOf(n);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,l,d){this._checkLoaded();const f=this.getLayer(n);f?f.minzoom===l&&f.maxzoom===d||(l!=null&&(f.minzoom=l),d!=null&&(f.maxzoom=d),this._updateLayer(f)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,l,d={}){this._checkLoaded();const f=this.getLayer(n);if(f){if(!c.aE(f.filter,l))return l==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(c.u.filter,`layers.${f.id}.filter`,l,null,d)||(f.filter=c.aB(l),this._updateLayer(f)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return c.aB(this.getLayer(n).filter)}setLayoutProperty(n,l,d,f={}){this._checkLoaded();const y=this.getLayer(n);y?c.aE(y.getLayoutProperty(l),d)||(y.setLayoutProperty(l,d,f),this._updateLayer(y)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,l){const d=this.getLayer(n);if(d)return d.getLayoutProperty(l);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,l,d,f={}){this._checkLoaded();const y=this.getLayer(n);y?c.aE(y.getPaintProperty(l),d)||(y.setPaintProperty(l,d,f)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,l){return this.getLayer(n).getPaintProperty(l)}setFeatureState(n,l){this._checkLoaded();const d=n.source,f=n.sourceLayer,y=this.sourceCaches[d];if(y===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const w=y.getSource().type;w==="geojson"&&f?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||f?(n.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(f,n.id,l)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,l){this._checkLoaded();const d=n.source,f=this.sourceCaches[d];if(f===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const y=f.getSource().type,w=y==="vector"?n.sourceLayer:void 0;y!=="vector"||w?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(w,n.id,l):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const l=n.source,d=n.sourceLayer,f=this.sourceCaches[l];if(f!==void 0)return f.getSource().type!=="vector"||d?(n.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(d,n.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=c.aF(this.sourceCaches,y=>y.serialize()),l=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,f=this.stylesheet;return c.aG({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:n,layers:l,terrain:d},y=>y!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const l=w=>this._layers[w].type==="fill-extrusion",d={},f=[];for(let w=this._order.length-1;w>=0;w--){const C=this._order[w];if(l(C)){d[C]=w;for(const A of n){const z=A[C];if(z)for(const B of z)f.push(B)}}}f.sort((w,C)=>C.intersectionZ-w.intersectionZ);const y=[];for(let w=this._order.length-1;w>=0;w--){const C=this._order[w];if(l(C))for(let A=f.length-1;A>=0;A--){const z=f[A].feature;if(d[z.layer.id]<w)break;y.push(z),f.pop()}else for(const A of n){const z=A[C];if(z)for(const B of z)y.push(B.feature)}}return y}queryRenderedFeatures(n,l,d){l&&l.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",l.filter,null,l);const f={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const C of l.layers){const A=this._layers[C];if(!A)return this.fire(new c.j(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];f[A.source]=!0}}const y=[];l.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const C in this.sourceCaches)l.layers&&!f[C]||y.push(Wt(this.sourceCaches[C],this._layers,w,n,l,d));return this.placement&&y.push(function(C,A,z,B,F,q,J){const ee={},ae=q.queryRenderedSymbols(B),he=[];for(const fe of Object.keys(ae).map(Number))he.push(J[fe]);he.sort(mt);for(const fe of he){const ye=fe.featureIndex.lookupSymbolFeatures(ae[fe.bucketInstanceId],A,fe.bucketIndex,fe.sourceLayerIndex,F.filter,F.layers,F.availableImages,C);for(const se in ye){const be=ee[se]=ee[se]||[],we=ye[se];we.sort((Ee,je)=>{const Ke=fe.featureSortOrder;if(Ke){const lt=Ke.indexOf(Ee.featureIndex);return Ke.indexOf(je.featureIndex)-lt}return je.featureIndex-Ee.featureIndex});for(const Ee of we)be.push(Ee)}}for(const fe in ee)ee[fe].forEach(ye=>{const se=ye.feature,be=z[C[fe].source].getFeatureState(se.layer["source-layer"],se.id);se.source=se.layer.source,se.layer["source-layer"]&&(se.sourceLayer=se.layer["source-layer"]),se.state=be});return ee}(this._layers,w,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(n,l){l&&l.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",l.filter,null,l);const d=this.sourceCaches[n];return d?function(f,y){const w=f.getRenderableIds().map(z=>f.getTileByID(z)),C=[],A={};for(let z=0;z<w.length;z++){const B=w[z],F=B.tileID.canonical.key;A[F]||(A[F]=!0,B.querySourceFeatures(C,y))}return C}(d,l):[]}getLight(){return this.light.getLight()}setLight(n,l={}){this._checkLoaded();const d=this.light.getLight();let f=!1;for(const w in n)if(!c.aE(n[w],d[w])){f=!0;break}if(!f)return;const y={now:k.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(y)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,l={}){const d=this.getSky();let f=!1;if(!n&&!d)return;if(n&&!d)f=!0;else if(!n&&d)f=!0;else for(const w in n)if(!c.aE(n[w],d[w])){f=!0;break}if(!f)return;const y={now:k.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,l),this.sky.updateTransitions(y)}_validate(n,l,d,f,y={}){return(!y||y.validate!==!1)&&Hi(this,n.call(c.u,c.e({key:l,style:this.serialize(),value:d,styleSpec:c.v},f)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),cr().off(qe,this._rtlPluginLoaded);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const d=this.sourceCaches[l];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const l in this.sourceCaches)this.sourceCaches[l].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,l,d,f,y=!1){let w=!1,C=!1;const A={};for(const z of this._order){const B=this._layers[z];if(B.type!=="symbol")continue;if(!A[B.source]){const q=this.sourceCaches[B.source];A[B.source]=q.getRenderableIds(!0).map(J=>q.getTileByID(J)).sort((J,ee)=>ee.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(ee.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(B,A[B.source],n.center.lng);w=w||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(k.now(),n.zoom))&&(this.pauseablePlacement=new Ha(n,this.map.terrain,this._order,y,l,d,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(k.now()),C=!0),w&&this.pauseablePlacement.placement.setStale()),C||w)for(const z of this._order){const B=this._layers[z];B.type==="symbol"&&this.placement.updateLayerOpacities(B,A[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(k.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,l){return c._(this,void 0,void 0,function*(){const d=yield this.imageManager.getImages(l.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[l.source];return f&&f.setDependencies(l.tileID.key,l.type,l.icons),d})}getGlyphs(n,l){return c._(this,void 0,void 0,function*(){const d=yield this.glyphManager.getGlyphs(l.stacks),f=this.sourceCaches[l.source];return f&&f.setDependencies(l.tileID.key,l.type,[""]),d})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,l={}){this._checkLoaded(),n&&this._validate(c.u.glyphs,"glyphs",n,null,l)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,l,d={},f){this._checkLoaded();const y=[{id:n,url:l}],w=[...De(this.stylesheet.sprite),...y];this._validate(c.u.sprite,"sprite",w,null,d)||(this.stylesheet.sprite=w,this._loadSprite(y,!0,f))}removeSprite(n){this._checkLoaded();const l=De(this.stylesheet.sprite);if(l.find(d=>d.id===n)){if(this._spritesImagesIds[n])for(const d of this._spritesImagesIds[n])this.imageManager.removeImage(d),this._changedImages[d]=!0;l.splice(l.findIndex(d=>d.id===n),1),this.stylesheet.sprite=l.length>0?l:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return De(this.stylesheet.sprite)}setSprite(n,l={},d){this._checkLoaded(),n&&this._validate(c.u.sprite,"sprite",n,null,l)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,d):(this._unloadSprite(),d&&d(null)))}}var so=c.Y([{name:"a_pos",type:"Int16",components:2}]);const js={prelude:hn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:hn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:hn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:hn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:hn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:hn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:hn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:hn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:hn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:hn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:hn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:hn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:hn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:hn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:hn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:hn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:hn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:hn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:hn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:hn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:hn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:hn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:hn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:hn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:hn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:hn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function hn(v,n){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=n.match(/attribute ([\w]+) ([\w]+)/g),f=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=y?y.concat(f):f,C={};return{fragmentSource:v=v.replace(l,(A,z,B,F,q)=>(C[q]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${q}
varying ${B} ${F} ${q};
#else
uniform ${B} ${F} u_${q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${q}
    ${B} ${F} ${q} = u_${q};
#endif
`)),vertexSource:n=n.replace(l,(A,z,B,F,q)=>{const J=F==="float"?"vec2":"vec4",ee=q.match(/color/)?"color":J;return C[q]?z==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
attribute ${B} ${J} a_${q};
varying ${B} ${F} ${q};
#else
uniform ${B} ${F} u_${q};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${B} ${F} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${ee}(a_${q}, u_${q}_t);
#else
    ${B} ${F} ${q} = u_${q};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
attribute ${B} ${J} a_${q};
#else
uniform ${B} ${F} u_${q};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${B} ${F} ${q} = a_${q};
#else
    ${B} ${F} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${B} ${F} ${q} = unpack_mix_${ee}(a_${q}, u_${q}_t);
#else
    ${B} ${F} ${q} = u_${q};
#endif
`}),staticAttributes:d,staticUniforms:w}}class Fu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,l,d,f,y,w,C,A,z){this.context=n;let B=this.boundPaintVertexBuffers.length!==f.length;for(let F=0;!B&&F<f.length;F++)this.boundPaintVertexBuffers[F]!==f[F]&&(B=!0);!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==d||B||this.boundIndexBuffer!==y||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==A||this.boundDynamicVertexBuffer3!==z?this.freshBind(l,d,f,y,w,C,A,z):(n.bindVertexArray.set(this.vao),C&&C.bind(),y&&y.dynamicDraw&&y.bind(),A&&A.bind(),z&&z.bind())}freshBind(n,l,d,f,y,w,C,A){const z=n.numAttributes,B=this.context,F=B.gl;this.vao&&this.destroy(),this.vao=B.createVertexArray(),B.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=f,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=A,l.enableAttributes(F,n);for(const q of d)q.enableAttributes(F,n);w&&w.enableAttributes(F,n),C&&C.enableAttributes(F,n),A&&A.enableAttributes(F,n),l.bind(),l.setVertexAttribPointers(F,n,y);for(const q of d)q.bind(),q.setVertexAttribPointers(F,n,y);w&&(w.bind(),w.setVertexAttribPointers(F,n,y)),f&&f.bind(),C&&(C.bind(),C.setVertexAttribPointers(F,n,y)),A&&(A.bind(),A.setVertexAttribPointers(F,n,y)),B.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Nu=(v,n,l,d,f)=>({u_matrix:v,u_texture:0,u_ele_delta:n,u_fog_matrix:l,u_fog_color:d?d.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:d?d.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?d.calculateFogBlendOpacity(f):0,u_horizon_color:d?d.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:d?d.properties.get("horizon-fog-blend"):1});function Oo(v){const n=[];for(let l=0;l<v.length;l++){if(v[l]===null)continue;const d=v[l].split(" ");n.push(d.pop())}return n}class Ou{constructor(n,l,d,f,y,w){const C=n.gl;this.program=C.createProgram();const A=Oo(l.staticAttributes),z=d?d.getBinderAttributes():[],B=A.concat(z),F=js.prelude.staticUniforms?Oo(js.prelude.staticUniforms):[],q=l.staticUniforms?Oo(l.staticUniforms):[],J=d?d.getBinderUniforms():[],ee=F.concat(q).concat(J),ae=[];for(const Ee of ee)ae.indexOf(Ee)<0&&ae.push(Ee);const he=d?d.defines():[];y&&he.push("#define OVERDRAW_INSPECTOR;"),w&&he.push("#define TERRAIN3D;");const fe=he.concat(js.prelude.fragmentSource,l.fragmentSource).join(`
`),ye=he.concat(js.prelude.vertexSource,l.vertexSource).join(`
`),se=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(se,fe),C.compileShader(se),!C.getShaderParameter(se,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(se)}`);C.attachShader(this.program,se);const be=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(be,ye),C.compileShader(be),!C.getShaderParameter(be,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(be)}`);C.attachShader(this.program,be),this.attributes={};const we={};this.numAttributes=B.length;for(let Ee=0;Ee<this.numAttributes;Ee++)B[Ee]&&(C.bindAttribLocation(this.program,Ee,B[Ee]),this.attributes[B[Ee]]=Ee);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(be),C.deleteShader(se);for(let Ee=0;Ee<ae.length;Ee++){const je=ae[Ee];if(je&&!we[je]){const Ke=C.getUniformLocation(this.program,je);Ke&&(we[je]=Ke)}}this.fixedUniforms=f(n,we),this.terrainUniforms=((Ee,je)=>({u_depth:new c.aH(Ee,je.u_depth),u_terrain:new c.aH(Ee,je.u_terrain),u_terrain_dim:new c.aI(Ee,je.u_terrain_dim),u_terrain_matrix:new c.aJ(Ee,je.u_terrain_matrix),u_terrain_unpack:new c.aK(Ee,je.u_terrain_unpack),u_terrain_exaggeration:new c.aI(Ee,je.u_terrain_exaggeration)}))(n,we),this.binderUniforms=d?d.getUniforms(n,we):[]}draw(n,l,d,f,y,w,C,A,z,B,F,q,J,ee,ae,he,fe,ye){const se=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(d),n.setStencilMode(f),n.setColorMode(y),n.setCullFace(w),A){n.activeTexture.set(se.TEXTURE2),se.bindTexture(se.TEXTURE_2D,A.depthTexture),n.activeTexture.set(se.TEXTURE3),se.bindTexture(se.TEXTURE_2D,A.texture);for(const we in this.terrainUniforms)this.terrainUniforms[we].set(A[we])}for(const we in this.fixedUniforms)this.fixedUniforms[we].set(C[we]);ae&&ae.setUniforms(n,this.binderUniforms,J,{zoom:ee});let be=0;switch(l){case se.LINES:be=2;break;case se.TRIANGLES:be=3;break;case se.LINE_STRIP:be=1}for(const we of q.get()){const Ee=we.vaos||(we.vaos={});(Ee[z]||(Ee[z]=new Fu)).bind(n,this,B,ae?ae.getPaintVertexBuffers():[],F,we.vertexOffset,he,fe,ye),se.drawElements(l,we.primitiveLength*be,se.UNSIGNED_SHORT,we.primitiveOffset*be*2)}}}function Hl(v,n,l){const d=1/en(l,1,n.transform.tileZoom),f=Math.pow(2,l.tileID.overscaledZ),y=l.tileSize*Math.pow(2,n.transform.tileZoom)/f,w=y*(l.tileID.canonical.x+l.tileID.wrap*f),C=y*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[d,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[w>>16,C>>16],u_pixel_coord_lower:[65535&w,65535&C]}}const Ga=(v,n,l,d)=>{const f=n.style.light,y=f.properties.get("position"),w=[y.x,y.y,y.z],C=function(){var z=new c.A(9);return c.A!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[5]=0,z[6]=0,z[7]=0),z[0]=1,z[4]=1,z[8]=1,z}();f.properties.get("anchor")==="viewport"&&function(z,B){var F=Math.sin(B),q=Math.cos(B);z[0]=q,z[1]=F,z[2]=0,z[3]=-F,z[4]=q,z[5]=0,z[6]=0,z[7]=0,z[8]=1}(C,-n.transform.angle),function(z,B,F){var q=B[0],J=B[1],ee=B[2];z[0]=q*F[0]+J*F[3]+ee*F[6],z[1]=q*F[1]+J*F[4]+ee*F[7],z[2]=q*F[2]+J*F[5]+ee*F[8]}(w,w,C);const A=f.properties.get("color");return{u_matrix:v,u_lightpos:w,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+l,u_opacity:d}},Gl=(v,n,l,d,f,y,w)=>c.e(Ga(v,n,l,d),Hl(y,n,w),{u_height_factor:-Math.pow(2,f.overscaledZ)/w.tileSize/8}),jo=v=>({u_matrix:v}),lf=(v,n,l,d)=>c.e(jo(v),Hl(l,n,d)),wg=(v,n)=>({u_matrix:v,u_world:n}),cf=(v,n,l,d,f)=>c.e(lf(v,n,l,d),{u_world:f}),Sg=(v,n,l,d)=>{const f=v.transform;let y,w;if(d.paint.get("circle-pitch-alignment")==="map"){const C=en(l,1,f.zoom);y=!0,w=[C,C]}else y=!1,w=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:v.translatePosMatrix(n.posMatrix,l,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:w}},oo=(v,n,l)=>({u_matrix:v,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}),Wa=(v,n,l=1)=>({u_matrix:v,u_color:n,u_overlay:0,u_overlay_scale:l}),Kr=v=>({u_matrix:v}),Yr=(v,n,l,d)=>({u_matrix:v,u_extrude_scale:en(n,1,l),u_intensity:d}),Wl=(v,n,l,d)=>{const f=c.H();c.aP(f,0,v.width,v.height,0,0,1);const y=v.context.gl;return{u_matrix:f,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:l,u_color_ramp:d,u_opacity:n.paint.get("heatmap-opacity")}};function ql(v,n){const l=Math.pow(2,n.canonical.z),d=n.canonical.y;return[new c.Z(0,d/l).toLngLat().lat,new c.Z(0,(d+1)/l).toLngLat().lat]}const Zl=(v,n,l,d)=>{const f=v.transform;return{u_matrix:df(v,n,l,d),u_ratio:1/en(n,1,f.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},uf=(v,n,l,d,f)=>c.e(Zl(v,n,l,f),{u_image:0,u_image_height:d}),Vo=(v,n,l,d,f)=>{const y=v.transform,w=hf(n,y);return{u_matrix:df(v,n,l,f),u_texsize:n.imageAtlasTexture.size,u_ratio:1/en(n,1,y.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[w,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},kg=(v,n,l,d,f,y)=>{const w=v.lineAtlas,C=hf(n,v.transform),A=l.layout.get("line-cap")==="round",z=w.getDash(d.from,A),B=w.getDash(d.to,A),F=z.width*f.fromScale,q=B.width*f.toScale;return c.e(Zl(v,n,l,y),{u_patternscale_a:[C/F,-z.height/2],u_patternscale_b:[C/q,-B.height/2],u_sdfgamma:w.width/(256*Math.min(F,q)*v.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:B.y,u_mix:f.t})};function hf(v,n){return 1/en(v,1,n.tileZoom)}function df(v,n,l,d){return v.translatePosMatrix(d?d.posMatrix:n.tileID.posMatrix,n,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const Tg=(v,n,l,d,f)=>{return{u_matrix:v,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(w=f.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(y=f.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Cg(f.paint.get("raster-hue-rotate"))};var y,w};function Cg(v){v*=Math.PI/180;const n=Math.sin(v),l=Math.cos(v);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const ff=(v,n,l,d,f,y,w,C,A,z,B,F,q,J)=>{const ee=w.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:ee.cameraToCenterDistance,u_pitch:ee.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:ee.width/ee.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:A,u_coord_matrix:z,u_is_text:+F,u_pitch_with_map:+d,u_is_along_line:f,u_is_variable_anchor:y,u_texsize:q,u_texture:0,u_translation:B,u_pitched_scale:J}},qa=(v,n,l,d,f,y,w,C,A,z,B,F,q,J,ee)=>{const ae=w.transform;return c.e(ff(v,n,l,d,f,y,w,C,A,z,B,F,q,ee),{u_gamma_scale:d?Math.cos(ae._pitch)*ae.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:1})},ju=(v,n,l,d,f,y,w,C,A,z,B,F,q,J)=>c.e(qa(v,n,l,d,f,y,w,C,A,z,B,!0,F,!0,J),{u_texsize_icon:q,u_texture_icon:1}),Xl=(v,n,l)=>({u_matrix:v,u_opacity:n,u_color:l}),Vu=(v,n,l,d,f,y)=>c.e(function(w,C,A,z){const B=A.imageManager.getPattern(w.from.toString()),F=A.imageManager.getPattern(w.to.toString()),{width:q,height:J}=A.imageManager.getPixelSize(),ee=Math.pow(2,z.tileID.overscaledZ),ae=z.tileSize*Math.pow(2,A.transform.tileZoom)/ee,he=ae*(z.tileID.canonical.x+z.tileID.wrap*ee),fe=ae*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[q,J],u_mix:C.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/en(z,1,A.transform.tileZoom),u_pixel_coord_upper:[he>>16,fe>>16],u_pixel_coord_lower:[65535&he,65535&fe]}}(d,y,l,f),{u_matrix:v,u_opacity:n}),Uu={fillExtrusion:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_lightpos:new c.aN(v,n.u_lightpos),u_lightintensity:new c.aI(v,n.u_lightintensity),u_lightcolor:new c.aN(v,n.u_lightcolor),u_vertical_gradient:new c.aI(v,n.u_vertical_gradient),u_opacity:new c.aI(v,n.u_opacity)}),fillExtrusionPattern:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_lightpos:new c.aN(v,n.u_lightpos),u_lightintensity:new c.aI(v,n.u_lightintensity),u_lightcolor:new c.aN(v,n.u_lightcolor),u_vertical_gradient:new c.aI(v,n.u_vertical_gradient),u_height_factor:new c.aI(v,n.u_height_factor),u_image:new c.aH(v,n.u_image),u_texsize:new c.aO(v,n.u_texsize),u_pixel_coord_upper:new c.aO(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,n.u_pixel_coord_lower),u_scale:new c.aN(v,n.u_scale),u_fade:new c.aI(v,n.u_fade),u_opacity:new c.aI(v,n.u_opacity)}),fill:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix)}),fillPattern:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_image:new c.aH(v,n.u_image),u_texsize:new c.aO(v,n.u_texsize),u_pixel_coord_upper:new c.aO(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,n.u_pixel_coord_lower),u_scale:new c.aN(v,n.u_scale),u_fade:new c.aI(v,n.u_fade)}),fillOutline:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_world:new c.aO(v,n.u_world)}),fillOutlinePattern:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_world:new c.aO(v,n.u_world),u_image:new c.aH(v,n.u_image),u_texsize:new c.aO(v,n.u_texsize),u_pixel_coord_upper:new c.aO(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,n.u_pixel_coord_lower),u_scale:new c.aN(v,n.u_scale),u_fade:new c.aI(v,n.u_fade)}),circle:(v,n)=>({u_camera_to_center_distance:new c.aI(v,n.u_camera_to_center_distance),u_scale_with_map:new c.aH(v,n.u_scale_with_map),u_pitch_with_map:new c.aH(v,n.u_pitch_with_map),u_extrude_scale:new c.aO(v,n.u_extrude_scale),u_device_pixel_ratio:new c.aI(v,n.u_device_pixel_ratio),u_matrix:new c.aJ(v,n.u_matrix)}),collisionBox:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_pixel_extrude_scale:new c.aO(v,n.u_pixel_extrude_scale)}),collisionCircle:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_inv_matrix:new c.aJ(v,n.u_inv_matrix),u_camera_to_center_distance:new c.aI(v,n.u_camera_to_center_distance),u_viewport_size:new c.aO(v,n.u_viewport_size)}),debug:(v,n)=>({u_color:new c.aL(v,n.u_color),u_matrix:new c.aJ(v,n.u_matrix),u_overlay:new c.aH(v,n.u_overlay),u_overlay_scale:new c.aI(v,n.u_overlay_scale)}),clippingMask:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix)}),heatmap:(v,n)=>({u_extrude_scale:new c.aI(v,n.u_extrude_scale),u_intensity:new c.aI(v,n.u_intensity),u_matrix:new c.aJ(v,n.u_matrix)}),heatmapTexture:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_world:new c.aO(v,n.u_world),u_image:new c.aH(v,n.u_image),u_color_ramp:new c.aH(v,n.u_color_ramp),u_opacity:new c.aI(v,n.u_opacity)}),hillshade:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_image:new c.aH(v,n.u_image),u_latrange:new c.aO(v,n.u_latrange),u_light:new c.aO(v,n.u_light),u_shadow:new c.aL(v,n.u_shadow),u_highlight:new c.aL(v,n.u_highlight),u_accent:new c.aL(v,n.u_accent)}),hillshadePrepare:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_image:new c.aH(v,n.u_image),u_dimension:new c.aO(v,n.u_dimension),u_zoom:new c.aI(v,n.u_zoom),u_unpack:new c.aK(v,n.u_unpack)}),line:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_ratio:new c.aI(v,n.u_ratio),u_device_pixel_ratio:new c.aI(v,n.u_device_pixel_ratio),u_units_to_pixels:new c.aO(v,n.u_units_to_pixels)}),lineGradient:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_ratio:new c.aI(v,n.u_ratio),u_device_pixel_ratio:new c.aI(v,n.u_device_pixel_ratio),u_units_to_pixels:new c.aO(v,n.u_units_to_pixels),u_image:new c.aH(v,n.u_image),u_image_height:new c.aI(v,n.u_image_height)}),linePattern:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_texsize:new c.aO(v,n.u_texsize),u_ratio:new c.aI(v,n.u_ratio),u_device_pixel_ratio:new c.aI(v,n.u_device_pixel_ratio),u_image:new c.aH(v,n.u_image),u_units_to_pixels:new c.aO(v,n.u_units_to_pixels),u_scale:new c.aN(v,n.u_scale),u_fade:new c.aI(v,n.u_fade)}),lineSDF:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_ratio:new c.aI(v,n.u_ratio),u_device_pixel_ratio:new c.aI(v,n.u_device_pixel_ratio),u_units_to_pixels:new c.aO(v,n.u_units_to_pixels),u_patternscale_a:new c.aO(v,n.u_patternscale_a),u_patternscale_b:new c.aO(v,n.u_patternscale_b),u_sdfgamma:new c.aI(v,n.u_sdfgamma),u_image:new c.aH(v,n.u_image),u_tex_y_a:new c.aI(v,n.u_tex_y_a),u_tex_y_b:new c.aI(v,n.u_tex_y_b),u_mix:new c.aI(v,n.u_mix)}),raster:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_tl_parent:new c.aO(v,n.u_tl_parent),u_scale_parent:new c.aI(v,n.u_scale_parent),u_buffer_scale:new c.aI(v,n.u_buffer_scale),u_fade_t:new c.aI(v,n.u_fade_t),u_opacity:new c.aI(v,n.u_opacity),u_image0:new c.aH(v,n.u_image0),u_image1:new c.aH(v,n.u_image1),u_brightness_low:new c.aI(v,n.u_brightness_low),u_brightness_high:new c.aI(v,n.u_brightness_high),u_saturation_factor:new c.aI(v,n.u_saturation_factor),u_contrast_factor:new c.aI(v,n.u_contrast_factor),u_spin_weights:new c.aN(v,n.u_spin_weights)}),symbolIcon:(v,n)=>({u_is_size_zoom_constant:new c.aH(v,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(v,n.u_is_size_feature_constant),u_size_t:new c.aI(v,n.u_size_t),u_size:new c.aI(v,n.u_size),u_camera_to_center_distance:new c.aI(v,n.u_camera_to_center_distance),u_pitch:new c.aI(v,n.u_pitch),u_rotate_symbol:new c.aH(v,n.u_rotate_symbol),u_aspect_ratio:new c.aI(v,n.u_aspect_ratio),u_fade_change:new c.aI(v,n.u_fade_change),u_matrix:new c.aJ(v,n.u_matrix),u_label_plane_matrix:new c.aJ(v,n.u_label_plane_matrix),u_coord_matrix:new c.aJ(v,n.u_coord_matrix),u_is_text:new c.aH(v,n.u_is_text),u_pitch_with_map:new c.aH(v,n.u_pitch_with_map),u_is_along_line:new c.aH(v,n.u_is_along_line),u_is_variable_anchor:new c.aH(v,n.u_is_variable_anchor),u_texsize:new c.aO(v,n.u_texsize),u_texture:new c.aH(v,n.u_texture),u_translation:new c.aO(v,n.u_translation),u_pitched_scale:new c.aI(v,n.u_pitched_scale)}),symbolSDF:(v,n)=>({u_is_size_zoom_constant:new c.aH(v,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(v,n.u_is_size_feature_constant),u_size_t:new c.aI(v,n.u_size_t),u_size:new c.aI(v,n.u_size),u_camera_to_center_distance:new c.aI(v,n.u_camera_to_center_distance),u_pitch:new c.aI(v,n.u_pitch),u_rotate_symbol:new c.aH(v,n.u_rotate_symbol),u_aspect_ratio:new c.aI(v,n.u_aspect_ratio),u_fade_change:new c.aI(v,n.u_fade_change),u_matrix:new c.aJ(v,n.u_matrix),u_label_plane_matrix:new c.aJ(v,n.u_label_plane_matrix),u_coord_matrix:new c.aJ(v,n.u_coord_matrix),u_is_text:new c.aH(v,n.u_is_text),u_pitch_with_map:new c.aH(v,n.u_pitch_with_map),u_is_along_line:new c.aH(v,n.u_is_along_line),u_is_variable_anchor:new c.aH(v,n.u_is_variable_anchor),u_texsize:new c.aO(v,n.u_texsize),u_texture:new c.aH(v,n.u_texture),u_gamma_scale:new c.aI(v,n.u_gamma_scale),u_device_pixel_ratio:new c.aI(v,n.u_device_pixel_ratio),u_is_halo:new c.aH(v,n.u_is_halo),u_translation:new c.aO(v,n.u_translation),u_pitched_scale:new c.aI(v,n.u_pitched_scale)}),symbolTextAndIcon:(v,n)=>({u_is_size_zoom_constant:new c.aH(v,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(v,n.u_is_size_feature_constant),u_size_t:new c.aI(v,n.u_size_t),u_size:new c.aI(v,n.u_size),u_camera_to_center_distance:new c.aI(v,n.u_camera_to_center_distance),u_pitch:new c.aI(v,n.u_pitch),u_rotate_symbol:new c.aH(v,n.u_rotate_symbol),u_aspect_ratio:new c.aI(v,n.u_aspect_ratio),u_fade_change:new c.aI(v,n.u_fade_change),u_matrix:new c.aJ(v,n.u_matrix),u_label_plane_matrix:new c.aJ(v,n.u_label_plane_matrix),u_coord_matrix:new c.aJ(v,n.u_coord_matrix),u_is_text:new c.aH(v,n.u_is_text),u_pitch_with_map:new c.aH(v,n.u_pitch_with_map),u_is_along_line:new c.aH(v,n.u_is_along_line),u_is_variable_anchor:new c.aH(v,n.u_is_variable_anchor),u_texsize:new c.aO(v,n.u_texsize),u_texsize_icon:new c.aO(v,n.u_texsize_icon),u_texture:new c.aH(v,n.u_texture),u_texture_icon:new c.aH(v,n.u_texture_icon),u_gamma_scale:new c.aI(v,n.u_gamma_scale),u_device_pixel_ratio:new c.aI(v,n.u_device_pixel_ratio),u_is_halo:new c.aH(v,n.u_is_halo),u_translation:new c.aO(v,n.u_translation),u_pitched_scale:new c.aI(v,n.u_pitched_scale)}),background:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_opacity:new c.aI(v,n.u_opacity),u_color:new c.aL(v,n.u_color)}),backgroundPattern:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_opacity:new c.aI(v,n.u_opacity),u_image:new c.aH(v,n.u_image),u_pattern_tl_a:new c.aO(v,n.u_pattern_tl_a),u_pattern_br_a:new c.aO(v,n.u_pattern_br_a),u_pattern_tl_b:new c.aO(v,n.u_pattern_tl_b),u_pattern_br_b:new c.aO(v,n.u_pattern_br_b),u_texsize:new c.aO(v,n.u_texsize),u_mix:new c.aI(v,n.u_mix),u_pattern_size_a:new c.aO(v,n.u_pattern_size_a),u_pattern_size_b:new c.aO(v,n.u_pattern_size_b),u_scale_a:new c.aI(v,n.u_scale_a),u_scale_b:new c.aI(v,n.u_scale_b),u_pixel_coord_upper:new c.aO(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,n.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(v,n.u_tile_units_to_pixels)}),terrain:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_texture:new c.aH(v,n.u_texture),u_ele_delta:new c.aI(v,n.u_ele_delta),u_fog_matrix:new c.aJ(v,n.u_fog_matrix),u_fog_color:new c.aL(v,n.u_fog_color),u_fog_ground_blend:new c.aI(v,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(v,n.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(v,n.u_horizon_color),u_horizon_fog_blend:new c.aI(v,n.u_horizon_fog_blend)}),terrainDepth:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_ele_delta:new c.aI(v,n.u_ele_delta)}),terrainCoords:(v,n)=>({u_matrix:new c.aJ(v,n.u_matrix),u_texture:new c.aH(v,n.u_texture),u_terrain_coords_id:new c.aI(v,n.u_terrain_coords_id),u_ele_delta:new c.aI(v,n.u_ele_delta)}),sky:(v,n)=>({u_sky_color:new c.aL(v,n.u_sky_color),u_horizon_color:new c.aL(v,n.u_horizon_color),u_horizon:new c.aI(v,n.u_horizon),u_sky_horizon_blend:new c.aI(v,n.u_sky_horizon_blend)})};class as{constructor(n,l,d){this.context=n;const f=n.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Eg={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class $u{constructor(n,l,d,f){this.length=l.length,this.attributes=d,this.itemSize=l.bytesPerElement,this.dynamicDraw=f,this.context=n;const y=n.gl;this.buffer=y.createBuffer(),n.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let d=0;d<this.attributes.length;d++){const f=l.attributes[this.attributes[d].name];f!==void 0&&n.enableVertexAttribArray(f)}}setVertexAttribPointers(n,l,d){for(let f=0;f<this.attributes.length;f++){const y=this.attributes[f],w=l.attributes[y.name];w!==void 0&&n.vertexAttribPointer(w,y.components,n[Eg[y.type]],!1,this.itemSize,y.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ao=new WeakMap;function Vs(v){var n;if(ao.has(v))return ao.get(v);{const l=(n=v.getParameter(v.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return ao.set(v,l),l}}class fn{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Kl extends fn{getDefault(){return c.aM.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Pg extends fn{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Uo extends fn{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Ig extends fn{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class pf extends fn{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Ag extends fn{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class mf extends fn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Hu extends fn{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class gf extends fn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class yf extends fn{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class vf extends fn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class _f extends fn{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class lo extends fn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class xf extends fn{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Mg extends fn{getDefault(){return c.aM.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class bf extends fn{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Za extends fn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class Dg extends fn{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Yl extends fn{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class zg extends fn{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Rg extends fn{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class wf extends fn{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Sf extends fn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class kf extends fn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Gu extends fn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Tf extends fn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Jl extends fn{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Ss extends fn{getDefault(){return null}set(n){var l;if(n===this.current&&!this.dirty)return;const d=this.gl;Vs(d)?d.bindVertexArray(n):(l=d.getExtension("OES_vertex_array_object"))===null||l===void 0||l.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class Wu extends fn{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class qu extends fn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Zu extends fn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Ql extends fn{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class Xu extends Ql{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class co extends Ql{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Ku extends Ql{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Lg{constructor(n,l,d,f,y){this.context=n,this.width=l,this.height=d;const w=n.gl,C=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new Xu(n,C),f)this.depthAttachment=y?new Ku(n,C):new co(n,C);else if(y)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,l=this.colorAttachment.get();if(l&&n.deleteTexture(l),this.depthAttachment){const d=this.depthAttachment.get();d&&n.deleteRenderbuffer(d)}n.deleteFramebuffer(this.framebuffer)}}class Vn{constructor(n,l,d){this.blendFunction=n,this.blendColor=l,this.mask=d}}Vn.Replace=[1,0],Vn.disabled=new Vn(Vn.Replace,c.aM.transparent,[!1,!1,!1,!1]),Vn.unblended=new Vn(Vn.Replace,c.aM.transparent,[!0,!0,!0,!0]),Vn.alphaBlended=new Vn([1,771],c.aM.transparent,[!0,!0,!0,!0]);class Bg{constructor(n){var l,d;if(this.gl=n,this.clearColor=new Kl(this),this.clearDepth=new Pg(this),this.clearStencil=new Uo(this),this.colorMask=new Ig(this),this.depthMask=new pf(this),this.stencilMask=new Ag(this),this.stencilFunc=new mf(this),this.stencilOp=new Hu(this),this.stencilTest=new gf(this),this.depthRange=new yf(this),this.depthTest=new vf(this),this.depthFunc=new _f(this),this.blend=new lo(this),this.blendFunc=new xf(this),this.blendColor=new Mg(this),this.blendEquation=new bf(this),this.cullFace=new Za(this),this.cullFaceSide=new Dg(this),this.frontFace=new Yl(this),this.program=new zg(this),this.activeTexture=new Rg(this),this.viewport=new wf(this),this.bindFramebuffer=new Sf(this),this.bindRenderbuffer=new kf(this),this.bindTexture=new Gu(this),this.bindVertexBuffer=new Tf(this),this.bindElementBuffer=new Jl(this),this.bindVertexArray=new Ss(this),this.pixelStoreUnpack=new Wu(this),this.pixelStoreUnpackPremultiplyAlpha=new qu(this),this.pixelStoreUnpackFlipY=new Zu(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Vs(n)){this.HALF_FLOAT=n.HALF_FLOAT;const f=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(l=n.RGBA16F)!==null&&l!==void 0?l:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(d=n.RGB16F)!==null&&d!==void 0?d:f==null?void 0:f.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const f=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l){return new as(this,n,l)}createVertexBuffer(n,l,d){return new $u(this,n,l,d)}createRenderbuffer(n,l,d){const f=this.gl,y=f.createRenderbuffer();return this.bindRenderbuffer.set(y),f.renderbufferStorage(f.RENDERBUFFER,n,l,d),this.bindRenderbuffer.set(null),y}createFramebuffer(n,l,d,f){return new Lg(this,n,l,d,f)}clear({color:n,depth:l,stencil:d}){const f=this.gl;let y=0;n&&(y|=f.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(y|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),d!==void 0&&(y|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),f.clear(y)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){c.aE(n.blendFunction,Vn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Vs(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var l;return Vs(this.gl)?this.gl.deleteVertexArray(n):(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class Kt{constructor(n,l,d){this.func=n,this.mask=l,this.range=d}}Kt.ReadOnly=!1,Kt.ReadWrite=!0,Kt.disabled=new Kt(519,Kt.ReadOnly,[0,1]);const ec=7680;class kn{constructor(n,l,d,f,y,w){this.test=n,this.ref=l,this.mask=d,this.fail=f,this.depthFail=y,this.pass=w}}kn.disabled=new kn({func:519,mask:0},0,0,ec,ec,ec);class yn{constructor(n,l,d){this.enable=n,this.mode=l,this.frontFace=d}}let uo;function Xa(v,n,l,d,f){const y=v.context,w=y.gl,C=v.useProgram("collisionBox"),A=[];let z=0,B=0;for(let fe=0;fe<d.length;fe++){const ye=d[fe],se=n.getTile(ye).getBucket(l);if(!se)continue;const be=f?se.textCollisionBox:se.iconCollisionBox,we=se.collisionCircleArray;if(we.length>0){const Ee=c.H();c.aQ(Ee,se.placementInvProjMatrix,v.transform.glCoordMatrix),c.aQ(Ee,Ee,se.placementViewportMatrix),A.push({circleArray:we,circleOffset:B,transform:ye.posMatrix,invTransform:Ee,coord:ye}),z+=we.length/4,B=z}be&&C.draw(y,w.LINES,Kt.disabled,kn.disabled,v.colorModeForRenderPass(),yn.disabled,{u_matrix:ye.posMatrix,u_pixel_extrude_scale:[1/(F=v.transform).width,1/F.height]},v.style.map.terrain&&v.style.map.terrain.getTerrainData(ye),l.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,null,v.transform.zoom,null,null,be.collisionVertexBuffer)}var F;if(!f||!A.length)return;const q=v.useProgram("collisionCircle"),J=new c.aR;J.resize(4*z),J._trim();let ee=0;for(const fe of A)for(let ye=0;ye<fe.circleArray.length/4;ye++){const se=4*ye,be=fe.circleArray[se+0],we=fe.circleArray[se+1],Ee=fe.circleArray[se+2],je=fe.circleArray[se+3];J.emplace(ee++,be,we,Ee,je,0),J.emplace(ee++,be,we,Ee,je,1),J.emplace(ee++,be,we,Ee,je,2),J.emplace(ee++,be,we,Ee,je,3)}(!uo||uo.length<2*z)&&(uo=function(fe){const ye=2*fe,se=new c.aT;se.resize(ye),se._trim();for(let be=0;be<ye;be++){const we=6*be;se.uint16[we+0]=4*be+0,se.uint16[we+1]=4*be+1,se.uint16[we+2]=4*be+2,se.uint16[we+3]=4*be+2,se.uint16[we+4]=4*be+3,se.uint16[we+5]=4*be+0}return se}(z));const ae=y.createIndexBuffer(uo,!0),he=y.createVertexBuffer(J,c.aS.members,!0);for(const fe of A){const ye=oo(fe.transform,fe.invTransform,v.transform);q.draw(y,w.TRIANGLES,Kt.disabled,kn.disabled,v.colorModeForRenderPass(),yn.disabled,ye,v.style.map.terrain&&v.style.map.terrain.getTerrainData(fe.coord),l.id,he,ae,c.a0.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,v.transform.zoom,null,null,null)}he.destroy(),ae.destroy()}yn.disabled=new yn(!1,1029,2305),yn.backCCW=new yn(!0,1029,2305);const Ka=c.an(new Float32Array(16));function Yu(v,n,l,d,f,y){const{horizontalAlign:w,verticalAlign:C}=c.au(v);return new c.P((-(w-.5)*n/f+d[0])*y,(-(C-.5)*l/f+d[1])*y)}function ho(v,n,l,d,f,y){const w=n.tileAnchorPoint.add(new c.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let C=d.mult(y);l||(C=C.rotate(-f));const A=w.add(C);return ie(A.x,A.y,n.labelPlaneMatrix,n.getElevation).point}if(l){const C=Ie(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(v),A=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return v.add(d.rotate(A))}return v.add(d)}function $o(v,n,l,d,f,y,w,C,A,z,B,F,q,J){const ee=v.text.placedSymbolArray,ae=v.text.dynamicLayoutVertexArray,he=v.icon.dynamicLayoutVertexArray,fe={};ae.clear();for(let ye=0;ye<ee.length;ye++){const se=ee.get(ye),be=se.hidden||!se.crossTileID||v.allowVerticalPlacement&&!se.placedOrientation?null:d[se.crossTileID];if(be){const we=new c.P(se.anchorX,se.anchorY),Ee={getElevation:J,width:f.width,height:f.height,labelPlaneMatrix:y,pitchWithMap:l,projection:B,tileAnchorPoint:we,translation:F,unwrappedTileID:q},je=l?ie(we.x,we.y,w,J):Ie(we.x,we.y,Ee),Ke=N(f.cameraToCenterDistance,je.signedDistanceFromCamera);let lt=c.ai(v.textSizeData,A,se)*Ke/c.ap;l&&(lt*=v.tilePixelRatio/C);const{width:ft,height:it,anchor:rt,textOffset:wt,textBoxScale:Vt}=be,st=Yu(rt,ft,it,wt,Vt,lt),ut=B.getPitchedTextCorrection(f,we.add(new c.P(F[0],F[1])),q),Ot=ho(je.point,Ee,n,st,f.angle,ut),In=v.allowVerticalPlacement&&se.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let qt=0;qt<se.numGlyphs;qt++)c.aj(ae,Ot,In);z&&se.associatedIconIndex>=0&&(fe[se.associatedIconIndex]={shiftedAnchor:Ot,angle:In})}else zt(se.numGlyphs,ae)}if(z){he.clear();const ye=v.icon.placedSymbolArray;for(let se=0;se<ye.length;se++){const be=ye.get(se);if(be.hidden)zt(be.numGlyphs,he);else{const we=fe[se];if(we)for(let Ee=0;Ee<be.numGlyphs;Ee++)c.aj(he,we.shiftedAnchor,we.angle);else zt(be.numGlyphs,he)}}v.icon.dynamicLayoutVertexBuffer.updateData(he)}v.text.dynamicLayoutVertexBuffer.updateData(ae)}function Ei(v,n,l){return l.iconsInText&&n?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Ju(v,n,l,d,f,y,w,C,A,z,B,F){const q=v.context,J=q.gl,ee=v.transform,ae=io(),he=C==="map",fe=A==="map",ye=C!=="viewport"&&l.layout.get("symbol-placement")!=="point",se=he&&!fe&&!ye,be=!fe&&ye,we=!l.layout.get("symbol-sort-key").isConstant();let Ee=!1;const je=v.depthModeForSublayer(0,Kt.ReadOnly),Ke=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),lt=[],ft=ae.getCircleRadiusCorrection(ee);for(const it of d){const rt=n.getTile(it),wt=rt.getBucket(l);if(!wt)continue;const Vt=f?wt.text:wt.icon;if(!Vt||!Vt.segments.get().length||!Vt.hasVisibleVertices)continue;const st=Vt.programConfigurations.get(l.id),ut=f||wt.sdfIcons,Ot=f?wt.textSizeData:wt.iconSizeData,In=fe||ee.pitch!==0,qt=v.useProgram(Ei(ut,f,wt),st),tn=c.ag(Ot,ee.zoom),An=v.style.map.terrain&&v.style.map.terrain.getTerrainData(it);let Mr,qi,Mn,Jr,Vr=[0,0],Dr=null;if(f)qi=rt.glyphAtlasTexture,Mn=J.LINEAR,Mr=rt.glyphAtlasTexture.size,wt.iconsInText&&(Vr=rt.imageAtlasTexture.size,Dr=rt.imageAtlasTexture,Jr=In||v.options.rotating||v.options.zooming||Ot.kind==="composite"||Ot.kind==="camera"?J.LINEAR:J.NEAREST);else{const rn=l.layout.get("icon-size").constantOr(0)!==1||wt.iconsNeedLinear;qi=rt.imageAtlasTexture,Mn=ut||v.options.rotating||v.options.zooming||rn||In?J.LINEAR:J.NEAREST,Mr=rt.imageAtlasTexture.size}const Ur=en(rt,1,v.transform.zoom),us=be?it.posMatrix:Ka,ia=Qt(us,fe,he,v.transform,Ur),_c=Ht(us,fe,he,v.transform,Ur),sa=Ht(it.posMatrix,fe,he,v.transform,Ur),Ai=ae.translatePosition(v.transform,rt,y,w),xc=Ke&&wt.hasTextData(),Sh=l.layout.get("icon-text-fit")!=="none"&&xc&&wt.hasIconData();if(ye){const rn=v.style.map.terrain?(oa,aa)=>v.style.map.terrain.getElevation(it,oa,aa):null,yo=l.layout.get("text-rotation-alignment")==="map";K(wt,it.posMatrix,v,f,ia,sa,fe,z,yo,ae,it.toUnwrapped(),ee.width,ee.height,Ai,rn)}const Mi=it.posMatrix,Di=f&&Ke||Sh,Us=ye||Di?Ka:ia,Zi=_c,wr=ut&&l.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let zr;zr=ut?wt.iconsInText?ju(Ot.kind,tn,se,fe,ye,Di,v,Mi,Us,Zi,Ai,Mr,Vr,ft):qa(Ot.kind,tn,se,fe,ye,Di,v,Mi,Us,Zi,Ai,f,Mr,!0,ft):ff(Ot.kind,tn,se,fe,ye,Di,v,Mi,Us,Zi,Ai,f,Mr,ft);const mi={program:qt,buffers:Vt,uniformValues:zr,atlasTexture:qi,atlasTextureIcon:Dr,atlasInterpolation:Mn,atlasInterpolationIcon:Jr,isSDF:ut,hasHalo:wr};if(we&&wt.canOverlap){Ee=!0;const rn=Vt.segments.get();for(const yo of rn)lt.push({segments:new c.a0([yo]),sortKey:yo.sortKey,state:mi,terrainData:An})}else lt.push({segments:Vt.segments,sortKey:0,state:mi,terrainData:An})}Ee&&lt.sort((it,rt)=>it.sortKey-rt.sortKey);for(const it of lt){const rt=it.state;if(q.activeTexture.set(J.TEXTURE0),rt.atlasTexture.bind(rt.atlasInterpolation,J.CLAMP_TO_EDGE),rt.atlasTextureIcon&&(q.activeTexture.set(J.TEXTURE1),rt.atlasTextureIcon&&rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),rt.isSDF){const wt=rt.uniformValues;rt.hasHalo&&(wt.u_is_halo=1,Qu(rt.buffers,it.segments,l,v,rt.program,je,B,F,wt,it.terrainData)),wt.u_is_halo=0}Qu(rt.buffers,it.segments,l,v,rt.program,je,B,F,rt.uniformValues,it.terrainData)}}function Qu(v,n,l,d,f,y,w,C,A,z){const B=d.context;f.draw(B,B.gl.TRIANGLES,y,w,C,yn.disabled,A,z,l.id,v.layoutVertexBuffer,v.indexBuffer,n,l.paint,d.transform.zoom,v.programConfigurations.get(l.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function eh(v,n,l,d){const f=v.context,y=f.gl,w=kn.disabled,C=new Vn([y.ONE,y.ONE],c.aM.transparent,[!0,!0,!0,!0]),A=n.getBucket(l);if(!A)return;const z=d.key;let B=l.heatmapFbos.get(z);B||(B=Ya(f,n.tileSize,n.tileSize),l.heatmapFbos.set(z,B)),f.bindFramebuffer.set(B.framebuffer),f.viewport.set([0,0,n.tileSize,n.tileSize]),f.clear({color:c.aM.transparent});const F=A.programConfigurations.get(l.id),q=v.useProgram("heatmap",F),J=v.style.map.terrain.getTerrainData(d);q.draw(f,y.TRIANGLES,Kt.disabled,w,C,yn.disabled,Yr(d.posMatrix,n,v.transform.zoom,l.paint.get("heatmap-intensity")),J,l.id,A.layoutVertexBuffer,A.indexBuffer,A.segments,l.paint,v.transform.zoom,F)}function fo(v,n,l){const d=v.context,f=d.gl;d.setColorMode(v.colorModeForRenderPass());const y=Ja(d,n),w=l.key,C=n.heatmapFbos.get(w);C&&(d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,C.colorAttachment.get()),d.activeTexture.set(f.TEXTURE1),y.bind(f.LINEAR,f.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(d,f.TRIANGLES,Kt.disabled,kn.disabled,v.colorModeForRenderPass(),yn.disabled,Wl(v,n,0,1),null,n.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments,n.paint,v.transform.zoom),C.destroy(),n.heatmapFbos.delete(w))}function Ya(v,n,l){var d,f;const y=v.gl,w=y.createTexture();y.bindTexture(y.TEXTURE_2D,w),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const C=(d=v.HALF_FLOAT)!==null&&d!==void 0?d:y.UNSIGNED_BYTE,A=(f=v.RGBA16F)!==null&&f!==void 0?f:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,A,n,l,0,y.RGBA,C,null);const z=v.createFramebuffer(n,l,!1,!1);return z.colorAttachment.set(w),z}function Ja(v,n){return n.colorRampTexture||(n.colorRampTexture=new Ce(v,n.colorRamp,v.gl.RGBA)),n.colorRampTexture}function Ho(v,n,l,d,f){if(!l||!d||!d.imageAtlas)return;const y=d.imageAtlas.patternPositions;let w=y[l.to.toString()],C=y[l.from.toString()];if(!w&&C&&(w=C),!C&&w&&(C=w),!w||!C){const A=f.getPaintProperty(n);w=y[A],C=y[A]}w&&C&&v.setConstantPatternPositions(w,C)}function Qa(v,n,l,d,f,y,w){const C=v.context.gl,A="fill-pattern",z=l.paint.get(A),B=z&&z.constantOr(1),F=l.getCrossfadeParameters();let q,J,ee,ae,he;w?(J=B&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=C.LINES):(J=B?"fillPattern":"fill",q=C.TRIANGLES);const fe=z.constantOr(null);for(const ye of d){const se=n.getTile(ye);if(B&&!se.patternsLoaded())continue;const be=se.getBucket(l);if(!be)continue;const we=be.programConfigurations.get(l.id),Ee=v.useProgram(J,we),je=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ye);B&&(v.context.activeTexture.set(C.TEXTURE0),se.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),we.updatePaintBuffers(F)),Ho(we,A,fe,se,l);const Ke=je?ye:null,lt=v.translatePosMatrix(Ke?Ke.posMatrix:ye.posMatrix,se,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(w){ae=be.indexBuffer2,he=be.segments2;const ft=[C.drawingBufferWidth,C.drawingBufferHeight];ee=J==="fillOutlinePattern"&&B?cf(lt,v,F,se,ft):wg(lt,ft)}else ae=be.indexBuffer,he=be.segments,ee=B?lf(lt,v,F,se):jo(lt);Ee.draw(v.context,q,f,v.stencilModeForClipping(ye),y,yn.disabled,ee,je,l.id,be.layoutVertexBuffer,ae,he,l.paint,v.transform.zoom,we)}}function tc(v,n,l,d,f,y,w){const C=v.context,A=C.gl,z="fill-extrusion-pattern",B=l.paint.get(z),F=B.constantOr(1),q=l.getCrossfadeParameters(),J=l.paint.get("fill-extrusion-opacity"),ee=B.constantOr(null);for(const ae of d){const he=n.getTile(ae),fe=he.getBucket(l);if(!fe)continue;const ye=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ae),se=fe.programConfigurations.get(l.id),be=v.useProgram(F?"fillExtrusionPattern":"fillExtrusion",se);F&&(v.context.activeTexture.set(A.TEXTURE0),he.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),se.updatePaintBuffers(q)),Ho(se,z,ee,he,l);const we=v.translatePosMatrix(ae.posMatrix,he,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Ee=l.paint.get("fill-extrusion-vertical-gradient"),je=F?Gl(we,v,Ee,J,ae,q,he):Ga(we,v,Ee,J);be.draw(C,C.gl.TRIANGLES,f,y,w,yn.backCCW,je,ye,l.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,l.paint,v.transform.zoom,se,v.style.map.terrain&&fe.centroidVertexBuffer)}}function Go(v,n,l,d,f,y,w){const C=v.context,A=C.gl,z=l.fbo;if(!z)return;const B=v.useProgram("hillshade"),F=v.style.map.terrain&&v.style.map.terrain.getTerrainData(n);C.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,z.colorAttachment.get()),B.draw(C,A.TRIANGLES,f,y,w,yn.disabled,((q,J,ee,ae)=>{const he=ee.paint.get("hillshade-shadow-color"),fe=ee.paint.get("hillshade-highlight-color"),ye=ee.paint.get("hillshade-accent-color");let se=ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);ee.paint.get("hillshade-illumination-anchor")==="viewport"&&(se-=q.transform.angle);const be=!q.options.moving;return{u_matrix:ae?ae.posMatrix:q.transform.calculatePosMatrix(J.tileID.toUnwrapped(),be),u_image:0,u_latrange:ql(0,J.tileID),u_light:[ee.paint.get("hillshade-exaggeration"),se],u_shadow:he,u_highlight:fe,u_accent:ye}})(v,l,d,F?n:null),F,d.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function Wo(v,n,l,d,f,y){const w=v.context,C=w.gl,A=n.dem;if(A&&A.data){const z=A.dim,B=A.stride,F=A.getPixels();if(w.activeTexture.set(C.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||v.getTileTexture(B),n.demTexture){const J=n.demTexture;J.update(F,{premultiply:!1}),J.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else n.demTexture=new Ce(w,F,C.RGBA,{premultiply:!1}),n.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);w.activeTexture.set(C.TEXTURE0);let q=n.fbo;if(!q){const J=new Ce(w,{width:z,height:z,data:null},C.RGBA);J.bind(C.LINEAR,C.CLAMP_TO_EDGE),q=n.fbo=w.createFramebuffer(z,z,!0,!1),q.colorAttachment.set(J.texture)}w.bindFramebuffer.set(q.framebuffer),w.viewport.set([0,0,z,z]),v.useProgram("hillshadePrepare").draw(w,C.TRIANGLES,d,f,y,yn.disabled,((J,ee)=>{const ae=ee.stride,he=c.H();return c.aP(he,0,c.X,-c.X,0,0,1),c.J(he,he,[0,-c.X,0]),{u_matrix:he,u_image:1,u_dimension:[ae,ae],u_zoom:J.overscaledZ,u_unpack:ee.getUnpackVector()}})(n.tileID,A),null,l.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Cf(v,n,l,d,f,y){const w=d.paint.get("raster-fade-duration");if(!y&&w>0){const C=k.now(),A=(C-v.timeAdded)/w,z=n?(C-n.timeAdded)/w:-1,B=l.getSource(),F=f.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),q=!n||Math.abs(n.tileID.overscaledZ-F)>Math.abs(v.tileID.overscaledZ-F),J=q&&v.refreshedUponExpiration?1:c.ac(q?A:1-z,0,1);return v.refreshedUponExpiration&&A>=1&&(v.refreshedUponExpiration=!1),n?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const th=new c.aM(1,0,0,1),cn=new c.aM(0,1,0,1),nc=new c.aM(0,0,1,1),Fg=new c.aM(1,0,1,1),Ef=new c.aM(0,1,1,1);function qo(v,n,l,d){rc(v,0,n+l/2,v.transform.width,l,d)}function Pf(v,n,l,d){rc(v,n-l/2,0,l,v.transform.height,d)}function rc(v,n,l,d,f,y){const w=v.context,C=w.gl;C.enable(C.SCISSOR_TEST),C.scissor(n*v.pixelRatio,l*v.pixelRatio,d*v.pixelRatio,f*v.pixelRatio),w.clear({color:y}),C.disable(C.SCISSOR_TEST)}function If(v,n,l){const d=v.context,f=d.gl,y=l.posMatrix,w=v.useProgram("debug"),C=Kt.disabled,A=kn.disabled,z=v.colorModeForRenderPass(),B="$debug",F=v.style.map.terrain&&v.style.map.terrain.getTerrainData(l);d.activeTexture.set(f.TEXTURE0);const q=n.getTileByID(l.key).latestRawTileData,J=Math.floor((q&&q.byteLength||0)/1024),ee=n.getTile(l).tileSize,ae=512/Math.min(ee,512)*(l.overscaledZ/v.transform.zoom)*.5;let he=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(he+=` => ${l.overscaledZ}`),function(fe,ye){fe.initDebugOverlayCanvas();const se=fe.debugOverlayCanvas,be=fe.context.gl,we=fe.debugOverlayCanvas.getContext("2d");we.clearRect(0,0,se.width,se.height),we.shadowColor="white",we.shadowBlur=2,we.lineWidth=1.5,we.strokeStyle="white",we.textBaseline="top",we.font="bold 36px Open Sans, sans-serif",we.fillText(ye,5,5),we.strokeText(ye,5,5),fe.debugOverlayTexture.update(se),fe.debugOverlayTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE)}(v,`${he} ${J}kB`),w.draw(d,f.TRIANGLES,C,A,Vn.alphaBlended,yn.disabled,Wa(y,c.aM.transparent,ae),null,B,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),w.draw(d,f.LINE_STRIP,C,A,z,yn.disabled,Wa(y,c.aM.red),F,B,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function Af(v,n,l){const d=v.context,f=d.gl,y=v.colorModeForRenderPass(),w=new Kt(f.LEQUAL,Kt.ReadWrite,v.depthRangeFor3D),C=v.useProgram("terrain"),A=n.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,v.width,v.height]);for(const z of l){const B=v.renderToTexture.getTexture(z),F=n.getTerrainData(z.tileID);d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,B.texture);const q=v.transform.calculatePosMatrix(z.tileID.toUnwrapped()),J=n.getMeshFrameDelta(v.transform.zoom),ee=v.transform.calculateFogMatrix(z.tileID.toUnwrapped()),ae=Nu(q,J,ee,v.style.sky,v.transform.pitch);C.draw(d,f.TRIANGLES,w,kn.disabled,y,yn.backCCW,ae,F,"terrain",A.vertexBuffer,A.indexBuffer,A.segments)}}class ic{constructor(n,l,d){this.vertexBuffer=n,this.indexBuffer=l,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class sc{constructor(n,l){this.context=new Bg(n),this.transform=l,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Dt.maxUnderzooming+Dt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Bu}resize(n,l,d){if(this.width=Math.floor(n*d),this.height=Math.floor(l*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const n=this.context,l=new c.aX;l.emplaceBack(0,0),l.emplaceBack(c.X,0),l.emplaceBack(0,c.X),l.emplaceBack(c.X,c.X),this.tileExtentBuffer=n.createVertexBuffer(l,so.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const d=new c.aX;d.emplaceBack(0,0),d.emplaceBack(c.X,0),d.emplaceBack(0,c.X),d.emplaceBack(c.X,c.X),this.debugBuffer=n.createVertexBuffer(d,so.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const f=new c.$;f.emplaceBack(0,0,0,0),f.emplaceBack(c.X,0,c.X,0),f.emplaceBack(0,c.X,0,c.X),f.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=n.createVertexBuffer(f,xn.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const y=new c.aX;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,so.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const w=new c.aZ;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);const C=new c.aY;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(C);const A=this.context.gl;this.stencilClearMode=new kn({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO)}clearStencil(){const n=this.context,l=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=c.H();c.aP(d,0,this.width,this.height,0,0,1),c.K(d,d,[l.drawingBufferWidth,l.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,l.TRIANGLES,Kt.disabled,this.stencilClearMode,Vn.disabled,yn.disabled,Kr(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,l){if(this.currentStencilSource===n.source||!n.isTileClipped()||!l||!l.length)return;this.currentStencilSource=n.source;const d=this.context,f=d.gl;this.nextStencilID+l.length>256&&this.clearStencil(),d.setColorMode(Vn.disabled),d.setDepthMode(Kt.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of l){const C=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,A=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);y.draw(d,f.TRIANGLES,Kt.disabled,new kn({func:f.ALWAYS,mask:0},C,255,f.KEEP,f.KEEP,f.REPLACE),Vn.disabled,yn.disabled,Kr(w.posMatrix),A,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new kn({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){const l=this.context.gl;return new kn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(n){const l=this.context.gl,d=n.sort((w,C)=>C.overscaledZ-w.overscaledZ),f=d[d.length-1].overscaledZ,y=d[0].overscaledZ-f+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let C=0;C<y;C++)w[C+f]=new kn({func:l.GEQUAL,mask:255},C+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=y,[w,d]}return[{[f]:kn.disabled},d]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Vn([n.CONSTANT_COLOR,n.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Vn.unblended:Vn.alphaBlended}depthModeForSublayer(n,l,d){if(!this.opaquePassEnabledForLayer())return Kt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Kt(d||this.context.gl.LEQUAL,l,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,l){this.style=n,this.options=l,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(k.now()),this.imageManager.beginFrame();const d=this.style._order,f=this.style.sourceCaches,y={},w={},C={};for(const A in f){const z=f[A];z.used&&z.prepare(this.context),y[A]=z.getVisibleCoordinates(),w[A]=y[A].slice().reverse(),C[A]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let A=0;A<d.length;A++)if(this.style._layers[d[A]].is3D()){this.opaquePassCutoff=A;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const A of d){const z=this.style._layers[A];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const B=w[z.source];(z.type==="custom"||B.length)&&this.renderLayer(this,f[z.source],z,B)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:l.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(A,z){const B=A.context,F=B.gl,q=((fe,ye,se)=>({u_sky_color:fe.properties.get("sky-color"),u_horizon_color:fe.properties.get("horizon-color"),u_horizon:(ye.height/2+ye.getHorizon())*se,u_sky_horizon_blend:fe.properties.get("sky-horizon-blend")*ye.height/2*se}))(z,A.style.map.transform,A.pixelRatio),J=new Kt(F.LEQUAL,Kt.ReadWrite,[0,1]),ee=kn.disabled,ae=A.colorModeForRenderPass(),he=A.useProgram("sky");if(!z.mesh){const fe=new c.aX;fe.emplaceBack(-1,-1),fe.emplaceBack(1,-1),fe.emplaceBack(1,1),fe.emplaceBack(-1,1);const ye=new c.aY;ye.emplaceBack(0,1,2),ye.emplaceBack(0,2,3),z.mesh=new ic(B.createVertexBuffer(fe,so.members),B.createIndexBuffer(ye),c.a0.simpleSegment(0,0,fe.length,ye.length))}he.draw(B,F.TRIANGLES,J,ee,ae,yn.disabled,q,void 0,"sky",z.mesh.vertexBuffer,z.mesh.indexBuffer,z.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=l.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const A=this.style._layers[d[this.currentLayer]],z=f[A.source],B=y[A.source];this._renderTileClippingMasks(A,B),this.renderLayer(this,z,A,B)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const A=this.style._layers[d[this.currentLayer]],z=f[A.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(A))continue;const B=(A.type==="symbol"?C:w)[A.source];this._renderTileClippingMasks(A,y[A.source]),this.renderLayer(this,z,A,B)}if(this.options.showTileBoundaries){const A=function(z,B){let F=null;const q=Object.values(z._layers).flatMap(he=>he.source&&!he.isHidden(B)?[z.sourceCaches[he.source]]:[]),J=q.filter(he=>he.getSource().type==="vector"),ee=q.filter(he=>he.getSource().type!=="vector"),ae=he=>{(!F||F.getSource().maxzoom<he.getSource().maxzoom)&&(F=he)};return J.forEach(he=>ae(he)),F||ee.forEach(he=>ae(he)),F}(this.style,this.transform.zoom);A&&function(z,B,F){for(let q=0;q<F.length;q++)If(z,B,F[q])}(this,A,A.getVisibleCoordinates())}this.options.showPadding&&function(A){const z=A.transform.padding;qo(A,A.transform.height-(z.top||0),3,th),qo(A,z.bottom||0,3,cn),Pf(A,z.left||0,3,nc),Pf(A,A.transform.width-(z.right||0),3,Fg);const B=A.transform.centerPoint;(function(F,q,J,ee){rc(F,q-1,J-10,2,20,ee),rc(F,q-10,J-1,20,2,ee)})(A,B.x,A.transform.height-B.y,Ef)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const l=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=n?!c.a_(l,d):!c.a$(l,d)),f||(f=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),f&&(c.b0(l,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,w){const C=y.context,A=C.gl,z=Vn.unblended,B=new Kt(A.LEQUAL,Kt.ReadWrite,[0,1]),F=w.getTerrainMesh(),q=w.sourceCache.getRenderableTiles(),J=y.useProgram("terrainDepth");C.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),C.clear({color:c.aM.transparent,depth:1});for(const ee of q){const ae=w.getTerrainData(ee.tileID),he={u_matrix:y.transform.calculatePosMatrix(ee.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};J.draw(C,A.TRIANGLES,B,kn.disabled,z,yn.backCCW,he,ae,"terrain",F.vertexBuffer,F.indexBuffer,F.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,w){const C=y.context,A=C.gl,z=Vn.unblended,B=new Kt(A.LEQUAL,Kt.ReadWrite,[0,1]),F=w.getTerrainMesh(),q=w.getCoordsTexture(),J=w.sourceCache.getRenderableTiles(),ee=y.useProgram("terrainCoords");C.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),C.clear({color:c.aM.transparent,depth:1}),w.coordsIndex=[];for(const ae of J){const he=w.getTerrainData(ae.tileID);C.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,q.texture);const fe={u_matrix:y.transform.calculatePosMatrix(ae.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};ee.draw(C,A.TRIANGLES,B,kn.disabled,z,yn.backCCW,fe,he,"terrain",F.vertexBuffer,F.indexBuffer,F.segments),w.coordsIndex.push(ae.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(n,l,d,f){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(f||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(y,w,C,A,z){if(y.renderPass!=="translucent")return;const B=kn.disabled,F=y.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(q,J,ee,ae,he,fe,ye,se,be){const we=J.transform,Ee=io(),je=he==="map",Ke=fe==="map";for(const lt of q){const ft=ae.getTile(lt),it=ft.getBucket(ee);if(!it||!it.text||!it.text.segments.get().length)continue;const rt=c.ag(it.textSizeData,we.zoom),wt=en(ft,1,J.transform.zoom),Vt=Qt(lt.posMatrix,Ke,je,J.transform,wt),st=ee.layout.get("icon-text-fit")!=="none"&&it.hasIconData();if(rt){const ut=Math.pow(2,we.zoom-ft.tileID.overscaledZ),Ot=J.style.map.terrain?(qt,tn)=>J.style.map.terrain.getElevation(lt,qt,tn):null,In=Ee.translatePosition(we,ft,ye,se);$o(it,je,Ke,be,we,Vt,lt.posMatrix,ut,rt,st,Ee,In,lt.toUnwrapped(),Ot)}}}(A,y,C,w,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),z),C.paint.get("icon-opacity").constantOr(1)!==0&&Ju(y,w,C,A,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),B,F),C.paint.get("text-opacity").constantOr(1)!==0&&Ju(y,w,C,A,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),B,F),w.map.showCollisionBoxes&&(Xa(y,w,C,A,!0),Xa(y,w,C,A,!1))})(n,l,d,f,this.style.placement.variableOffsets);break;case"circle":(function(y,w,C,A){if(y.renderPass!=="translucent")return;const z=C.paint.get("circle-opacity"),B=C.paint.get("circle-stroke-width"),F=C.paint.get("circle-stroke-opacity"),q=!C.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(B.constantOr(1)===0||F.constantOr(1)===0))return;const J=y.context,ee=J.gl,ae=y.depthModeForSublayer(0,Kt.ReadOnly),he=kn.disabled,fe=y.colorModeForRenderPass(),ye=[];for(let se=0;se<A.length;se++){const be=A[se],we=w.getTile(be),Ee=we.getBucket(C);if(!Ee)continue;const je=Ee.programConfigurations.get(C.id),Ke=y.useProgram("circle",je),lt=Ee.layoutVertexBuffer,ft=Ee.indexBuffer,it=y.style.map.terrain&&y.style.map.terrain.getTerrainData(be),rt={programConfiguration:je,program:Ke,layoutVertexBuffer:lt,indexBuffer:ft,uniformValues:Sg(y,be,we,C),terrainData:it};if(q){const wt=Ee.segments.get();for(const Vt of wt)ye.push({segments:new c.a0([Vt]),sortKey:Vt.sortKey,state:rt})}else ye.push({segments:Ee.segments,sortKey:0,state:rt})}q&&ye.sort((se,be)=>se.sortKey-be.sortKey);for(const se of ye){const{programConfiguration:be,program:we,layoutVertexBuffer:Ee,indexBuffer:je,uniformValues:Ke,terrainData:lt}=se.state;we.draw(J,ee.TRIANGLES,ae,he,fe,yn.disabled,Ke,lt,C.id,Ee,je,se.segments,C.paint,y.transform.zoom,be)}})(n,l,d,f);break;case"heatmap":(function(y,w,C,A){if(C.paint.get("heatmap-opacity")===0)return;const z=y.context;if(y.style.map.terrain){for(const B of A){const F=w.getTile(B);w.hasRenderableParent(B)||(y.renderPass==="offscreen"?eh(y,F,C,B):y.renderPass==="translucent"&&fo(y,C,B))}z.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(B,F,q,J){const ee=B.context,ae=ee.gl,he=kn.disabled,fe=new Vn([ae.ONE,ae.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(ye,se,be){const we=ye.gl;ye.activeTexture.set(we.TEXTURE1),ye.viewport.set([0,0,se.width/4,se.height/4]);let Ee=be.heatmapFbos.get(c.aU);Ee?(we.bindTexture(we.TEXTURE_2D,Ee.colorAttachment.get()),ye.bindFramebuffer.set(Ee.framebuffer)):(Ee=Ya(ye,se.width/4,se.height/4),be.heatmapFbos.set(c.aU,Ee))})(ee,B,q),ee.clear({color:c.aM.transparent});for(let ye=0;ye<J.length;ye++){const se=J[ye];if(F.hasRenderableParent(se))continue;const be=F.getTile(se),we=be.getBucket(q);if(!we)continue;const Ee=we.programConfigurations.get(q.id),je=B.useProgram("heatmap",Ee),{zoom:Ke}=B.transform;je.draw(ee,ae.TRIANGLES,Kt.disabled,he,fe,yn.disabled,Yr(se.posMatrix,be,Ke,q.paint.get("heatmap-intensity")),null,q.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,q.paint,B.transform.zoom,Ee)}ee.viewport.set([0,0,B.width,B.height])}(y,w,C,A):y.renderPass==="translucent"&&function(B,F){const q=B.context,J=q.gl;q.setColorMode(B.colorModeForRenderPass());const ee=F.heatmapFbos.get(c.aU);ee&&(q.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,ee.colorAttachment.get()),q.activeTexture.set(J.TEXTURE1),Ja(q,F).bind(J.LINEAR,J.CLAMP_TO_EDGE),B.useProgram("heatmapTexture").draw(q,J.TRIANGLES,Kt.disabled,kn.disabled,B.colorModeForRenderPass(),yn.disabled,Wl(B,F,0,1),null,F.id,B.viewportBuffer,B.quadTriangleIndexBuffer,B.viewportSegments,F.paint,B.transform.zoom))}(y,C)})(n,l,d,f);break;case"line":(function(y,w,C,A){if(y.renderPass!=="translucent")return;const z=C.paint.get("line-opacity"),B=C.paint.get("line-width");if(z.constantOr(1)===0||B.constantOr(1)===0)return;const F=y.depthModeForSublayer(0,Kt.ReadOnly),q=y.colorModeForRenderPass(),J=C.paint.get("line-dasharray"),ee=C.paint.get("line-pattern"),ae=ee.constantOr(1),he=C.paint.get("line-gradient"),fe=C.getCrossfadeParameters(),ye=ae?"linePattern":J?"lineSDF":he?"lineGradient":"line",se=y.context,be=se.gl;let we=!0;for(const Ee of A){const je=w.getTile(Ee);if(ae&&!je.patternsLoaded())continue;const Ke=je.getBucket(C);if(!Ke)continue;const lt=Ke.programConfigurations.get(C.id),ft=y.context.program.get(),it=y.useProgram(ye,lt),rt=we||it.program!==ft,wt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ee),Vt=ee.constantOr(null);if(Vt&&je.imageAtlas){const Ot=je.imageAtlas,In=Ot.patternPositions[Vt.to.toString()],qt=Ot.patternPositions[Vt.from.toString()];In&&qt&&lt.setConstantPatternPositions(In,qt)}const st=wt?Ee:null,ut=ae?Vo(y,je,C,fe,st):J?kg(y,je,C,J,fe,st):he?uf(y,je,C,Ke.lineClipsArray.length,st):Zl(y,je,C,st);if(ae)se.activeTexture.set(be.TEXTURE0),je.imageAtlasTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE),lt.updatePaintBuffers(fe);else if(J&&(rt||y.lineAtlas.dirty))se.activeTexture.set(be.TEXTURE0),y.lineAtlas.bind(se);else if(he){const Ot=Ke.gradients[C.id];let In=Ot.texture;if(C.gradientVersion!==Ot.version){let qt=256;if(C.stepInterpolant){const tn=w.getSource().maxzoom,An=Ee.canonical.z===tn?Math.ceil(1<<y.transform.maxZoom-Ee.canonical.z):1;qt=c.ac(c.aV(Ke.maxLineLength/c.X*1024*An),256,se.maxTextureSize)}Ot.gradient=c.aW({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:qt,image:Ot.gradient||void 0,clips:Ke.lineClipsArray}),Ot.texture?Ot.texture.update(Ot.gradient):Ot.texture=new Ce(se,Ot.gradient,be.RGBA),Ot.version=C.gradientVersion,In=Ot.texture}se.activeTexture.set(be.TEXTURE0),In.bind(C.stepInterpolant?be.NEAREST:be.LINEAR,be.CLAMP_TO_EDGE)}it.draw(se,be.TRIANGLES,F,y.stencilModeForClipping(Ee),q,yn.disabled,ut,wt,C.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,C.paint,y.transform.zoom,lt,Ke.layoutVertexBuffer2),we=!1}})(n,l,d,f);break;case"fill":(function(y,w,C,A){const z=C.paint.get("fill-color"),B=C.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const F=y.colorModeForRenderPass(),q=C.paint.get("fill-pattern"),J=y.opaquePassEnabledForLayer()&&!q.constantOr(1)&&z.constantOr(c.aM.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===J){const ee=y.depthModeForSublayer(1,y.renderPass==="opaque"?Kt.ReadWrite:Kt.ReadOnly);Qa(y,w,C,A,ee,F,!1)}if(y.renderPass==="translucent"&&C.paint.get("fill-antialias")){const ee=y.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Kt.ReadOnly);Qa(y,w,C,A,ee,F,!0)}})(n,l,d,f);break;case"fill-extrusion":(function(y,w,C,A){const z=C.paint.get("fill-extrusion-opacity");if(z!==0&&y.renderPass==="translucent"){const B=new Kt(y.context.gl.LEQUAL,Kt.ReadWrite,y.depthRangeFor3D);if(z!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))tc(y,w,C,A,B,kn.disabled,Vn.disabled),tc(y,w,C,A,B,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const F=y.colorModeForRenderPass();tc(y,w,C,A,B,kn.disabled,F)}}})(n,l,d,f);break;case"hillshade":(function(y,w,C,A){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const z=y.context,B=y.depthModeForSublayer(0,Kt.ReadOnly),F=y.colorModeForRenderPass(),[q,J]=y.renderPass==="translucent"?y.stencilConfigForOverlap(A):[{},A];for(const ee of J){const ae=w.getTile(ee);ae.needsHillshadePrepare!==void 0&&ae.needsHillshadePrepare&&y.renderPass==="offscreen"?Wo(y,ae,C,B,kn.disabled,F):y.renderPass==="translucent"&&Go(y,ee,ae,C,B,q[ee.overscaledZ],F)}z.viewport.set([0,0,y.width,y.height])})(n,l,d,f);break;case"raster":(function(y,w,C,A){if(y.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!A.length)return;const z=y.context,B=z.gl,F=w.getSource(),q=y.useProgram("raster"),J=y.colorModeForRenderPass(),[ee,ae]=F instanceof En?[{},A]:y.stencilConfigForOverlap(A),he=ae[ae.length-1].overscaledZ,fe=!y.options.moving;for(const ye of ae){const se=y.depthModeForSublayer(ye.overscaledZ-he,C.paint.get("raster-opacity")===1?Kt.ReadWrite:Kt.ReadOnly,B.LESS),be=w.getTile(ye);be.registerFadeDuration(C.paint.get("raster-fade-duration"));const we=w.findLoadedParent(ye,0),Ee=w.findLoadedSibling(ye),je=Cf(be,we||Ee||null,w,C,y.transform,y.style.map.terrain);let Ke,lt;const ft=C.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;z.activeTexture.set(B.TEXTURE0),be.texture.bind(ft,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(B.TEXTURE1),we?(we.texture.bind(ft,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),Ke=Math.pow(2,we.tileID.overscaledZ-be.tileID.overscaledZ),lt=[be.tileID.canonical.x*Ke%1,be.tileID.canonical.y*Ke%1]):be.texture.bind(ft,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),be.texture.useMipmap&&z.extTextureFilterAnisotropic&&y.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const it=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ye),rt=it?ye:null,wt=rt?rt.posMatrix:y.transform.calculatePosMatrix(ye.toUnwrapped(),fe),Vt=Tg(wt,lt||[0,0],Ke||1,je,C);F instanceof En?q.draw(z,B.TRIANGLES,se,kn.disabled,J,yn.disabled,Vt,it,C.id,F.boundsBuffer,y.quadTriangleIndexBuffer,F.boundsSegments):q.draw(z,B.TRIANGLES,se,ee[ye.overscaledZ],J,yn.disabled,Vt,it,C.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(n,l,d,f);break;case"background":(function(y,w,C,A){const z=C.paint.get("background-color"),B=C.paint.get("background-opacity");if(B===0)return;const F=y.context,q=F.gl,J=y.transform,ee=J.tileSize,ae=C.paint.get("background-pattern");if(y.isPatternMissing(ae))return;const he=!ae&&z.a===1&&B===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==he)return;const fe=kn.disabled,ye=y.depthModeForSublayer(0,he==="opaque"?Kt.ReadWrite:Kt.ReadOnly),se=y.colorModeForRenderPass(),be=y.useProgram(ae?"backgroundPattern":"background"),we=A||J.coveringTiles({tileSize:ee,terrain:y.style.map.terrain});ae&&(F.activeTexture.set(q.TEXTURE0),y.imageManager.bind(y.context));const Ee=C.getCrossfadeParameters();for(const je of we){const Ke=A?je.posMatrix:y.transform.calculatePosMatrix(je.toUnwrapped()),lt=ae?Vu(Ke,B,y,ae,{tileID:je,tileSize:ee},Ee):Xl(Ke,B,z),ft=y.style.map.terrain&&y.style.map.terrain.getTerrainData(je);be.draw(F,q.TRIANGLES,ye,fe,se,yn.disabled,lt,ft,C.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(n,0,d,f);break;case"custom":(function(y,w,C){const A=y.context,z=C.implementation;if(y.renderPass==="offscreen"){const B=z.prerender;B&&(y.setCustomLayerDefaults(),A.setColorMode(y.colorModeForRenderPass()),B.call(z,A.gl,y.transform.customLayerMatrix()),A.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),A.setColorMode(y.colorModeForRenderPass()),A.setStencilMode(kn.disabled);const B=z.renderingMode==="3d"?new Kt(y.context.gl.LEQUAL,Kt.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Kt.ReadOnly);A.setDepthMode(B),z.render(A.gl,y.transform.customLayerMatrix(),{farZ:y.transform.farZ,nearZ:y.transform.nearZ,fov:y.transform._fov,modelViewProjectionMatrix:y.transform.modelViewProjectionMatrix,projectionMatrix:y.transform.projectionMatrix}),A.setDirty(),y.setBaseState(),A.bindFramebuffer.set(null)}})(n,0,d)}}translatePosMatrix(n,l,d,f,y){if(!d[0]&&!d[1])return n;const w=y?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(w){const z=Math.sin(w),B=Math.cos(w);d=[d[0]*B-d[1]*z,d[0]*z+d[1]*B]}const C=[y?d[0]:en(l,d[0],this.transform.zoom),y?d[1]:en(l,d[1],this.transform.zoom),0],A=new Float32Array(16);return c.J(A,n,C),A}saveTileTexture(n){const l=this._tileTextures[n.size[0]];l?l.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const l=this.imageManager.getPattern(n.from.toString()),d=this.imageManager.getPattern(n.to.toString());return!l||!d}useProgram(n,l){this.cache=this.cache||{};const d=n+(l?l.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new Ou(this.context,js[n],l,Uu[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ce(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:l}=this.context.gl;return this.width!==n||this.height!==l}}class Zo{constructor(n,l){this.points=n,this.planes=l}static fromInvProjectionMatrix(n,l,d){const f=Math.pow(2,d),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const A=1/(C=c.af([],C,n))[3]/l*f;return c.b1(C,C,[A,A,1/C[3],A])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const A=function(q,J){var ee=J[0],ae=J[1],he=J[2],fe=ee*ee+ae*ae+he*he;return fe>0&&(fe=1/Math.sqrt(fe)),q[0]=J[0]*fe,q[1]=J[1]*fe,q[2]=J[2]*fe,q}([],function(q,J,ee){var ae=J[0],he=J[1],fe=J[2],ye=ee[0],se=ee[1],be=ee[2];return q[0]=he*be-fe*se,q[1]=fe*ye-ae*be,q[2]=ae*se-he*ye,q}([],le([],y[C[0]],y[C[1]]),le([],y[C[2]],y[C[1]]))),z=-((B=A)[0]*(F=y[C[1]])[0]+B[1]*F[1]+B[2]*F[2]);var B,F;return A.concat(z)});return new Zo(y,w)}}class Xo{constructor(n,l){this.min=n,this.max=l,this.center=function(d,f,y){return d[0]=.5*f[0],d[1]=.5*f[1],d[2]=.5*f[2],d}([],function(d,f,y){return d[0]=f[0]+y[0],d[1]=f[1]+y[1],d[2]=f[2]+y[2],d}([],this.min,this.max))}quadrant(n){const l=[n%2==0,n<2],d=pe(this.min),f=pe(this.max);for(let y=0;y<l.length;y++)d[y]=l[y]?this.min[y]:this.center[y],f[y]=l[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new Xo(d,f)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const l=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let f=0;f<n.planes.length;f++){const y=n.planes[f];let w=0;for(let C=0;C<l.length;C++)c.b2(y,l[C])>=0&&w++;if(w===0)return 0;w!==l.length&&(d=!1)}if(d)return 2;for(let f=0;f<3;f++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let C=0;C<n.points.length;C++){const A=n.points[C][f]-this.min[f];y=Math.min(y,A),w=Math.max(w,A)}if(w<0||y>this.max[f]-this.min[f])return 0}return 1}}class Ko{constructor(n=0,l=0,d=0,f=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(d)||d<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=d,this.right=f}interpolate(n,l,d){return l.top!=null&&n.top!=null&&(this.top=c.y.number(n.top,l.top,d)),l.bottom!=null&&n.bottom!=null&&(this.bottom=c.y.number(n.bottom,l.bottom,d)),l.left!=null&&n.left!=null&&(this.left=c.y.number(n.left,l.left,d)),l.right!=null&&n.right!=null&&(this.right=c.y.number(n.right,l.right,d)),this}getCenter(n,l){const d=c.ac((this.left+n-this.right)/2,0,n),f=c.ac((this.top+l-this.bottom)/2,0,l);return new c.P(d,f)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Ko(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const nh=85.051129;class Yo{constructor(n,l,d,f,y){this.tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=d??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ko,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const n=new Yo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.lngRange=n.lngRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.minElevationForCurrentTile=n.minElevationForCurrentTile,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const l=-c.b3(n,-180,180)*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=function(){var d=new c.A(4);return c.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,f,y){var w=f[0],C=f[1],A=f[2],z=f[3],B=Math.sin(y),F=Math.cos(y);d[0]=w*F+A*B,d[1]=C*F+z*B,d[2]=w*-B+A*F,d[3]=C*-B+z*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const l=c.ac(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const l=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._zoom=l,this.tileZoom=Math.max(0,Math.floor(l)),this.scale=this.zoomScale(l),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,d){this._unmodified=!1,this._edgeInsets.interpolate(n,l,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const l=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(n){const l=[new c.b4(0,n)];if(this._renderWorldCopies){const d=this.pointCoordinate(new c.P(0,0)),f=this.pointCoordinate(new c.P(this.width,0)),y=this.pointCoordinate(new c.P(this.width,this.height)),w=this.pointCoordinate(new c.P(0,this.height)),C=Math.floor(Math.min(d.x,f.x,y.x,w.x)),A=Math.floor(Math.max(d.x,f.x,y.x,w.x)),z=1;for(let B=C-z;B<=A+z;B++)B!==0&&l.push(new c.b4(B,n))}return l}coveringTiles(n){var l,d;let f=this.coveringZoomLevel(n);const y=f;if(n.minzoom!==void 0&&f<n.minzoom)return[];n.maxzoom!==void 0&&f>n.maxzoom&&(f=n.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),C=c.Z.fromLngLat(this.center),A=Math.pow(2,f),z=[A*w.x,A*w.y,0],B=[A*C.x,A*C.y,0],F=Zo.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,f);let q=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(q=f);const J=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,ee=se=>({aabb:new Xo([se*A,0,0],[(se+1)*A,A,0]),zoom:0,x:0,y:0,wrap:se,fullyVisible:!1}),ae=[],he=[],fe=f,ye=n.reparseOverscaled?y:f;if(this._renderWorldCopies)for(let se=1;se<=3;se++)ae.push(ee(-se)),ae.push(ee(se));for(ae.push(ee(0));ae.length>0;){const se=ae.pop(),be=se.x,we=se.y;let Ee=se.fullyVisible;if(!Ee){const it=se.aabb.intersects(F);if(it===0)continue;Ee=it===2}const je=n.terrain?z:B,Ke=se.aabb.distanceX(je),lt=se.aabb.distanceY(je),ft=Math.max(Math.abs(Ke),Math.abs(lt));if(se.zoom===fe||ft>J+(1<<fe-se.zoom)-2&&se.zoom>=q){const it=fe-se.zoom,rt=z[0]-.5-(be<<it),wt=z[1]-.5-(we<<it);he.push({tileID:new c.S(se.zoom===fe?ye:se.zoom,se.wrap,se.zoom,be,we),distanceSq:ce([B[0]-.5-be,B[1]-.5-we]),tileDistanceToCamera:Math.sqrt(rt*rt+wt*wt)})}else for(let it=0;it<4;it++){const rt=(be<<1)+it%2,wt=(we<<1)+(it>>1),Vt=se.zoom+1;let st=se.aabb.quadrant(it);if(n.terrain){const ut=new c.S(Vt,se.wrap,Vt,rt,wt),Ot=n.terrain.getMinMaxElevation(ut),In=(l=Ot.minElevation)!==null&&l!==void 0?l:this.elevation,qt=(d=Ot.maxElevation)!==null&&d!==void 0?d:this.elevation;st=new Xo([st.min[0],st.min[1],In],[st.max[0],st.max[1],qt])}ae.push({aabb:st,zoom:Vt,x:rt,y:wt,wrap:se.wrap,fullyVisible:Ee})}}return he.sort((se,be)=>se.distanceSq-be.distanceSq).map(se=>se.tileID)}resize(n,l){this.width=n,this.height=l,this.pixelsToGLUnits=[2/n,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const l=c.ac(n.lat,-85.051129,nh);return new c.P(c.O(n.lng)*this.worldSize,c.Q(l)*this.worldSize)}unproject(n){return new c.Z(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const l=this.elevation,d=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,f=this.pointLocation(this.centerPoint,n),y=n.getElevationForLngLatZoom(f,this.tileZoom);if(!(this.elevation-y))return;const w=d+l-y,C=Math.cos(this._pitch)*this.cameraToCenterDistance/w/c.b5(1,f.lat),A=this.scaleZoom(C/this.tileSize);this._elevation=y,this._center=f,this.zoom=A}setLocationAtPoint(n,l){const d=this.pointCoordinate(l),f=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(n),w=new c.Z(y.x-(d.x-f.x),y.y-(d.y-f.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,l){return l?this.coordinatePoint(this.locationCoordinate(n),l.getElevationForLngLatZoom(n,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,l){return this.coordinateLocation(this.pointCoordinate(n,l))}locationCoordinate(n){return c.Z.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,l){if(l){const q=l.pointCoordinate(n);if(q!=null)return q}const d=[n.x,n.y,0,1],f=[n.x,n.y,1,1];c.af(d,d,this.pixelMatrixInverse),c.af(f,f,this.pixelMatrixInverse);const y=d[3],w=f[3],C=d[1]/y,A=f[1]/w,z=d[2]/y,B=f[2]/w,F=z===B?0:(0-z)/(B-z);return new c.Z(c.y.number(d[0]/y,f[0]/w,F)/this.worldSize,c.y.number(C,A,F)/this.worldSize)}coordinatePoint(n,l=0,d=this.pixelMatrix){const f=[n.x*this.worldSize,n.y*this.worldSize,l,1];return c.af(f,f,d),new c.P(f[0]/f[3],f[1]/f[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new Pe().extend(this.pointLocation(new c.P(0,n))).extend(this.pointLocation(new c.P(this.width,n))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Pe([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,nh])}calculateTileMatrix(n){const l=n.canonical,d=this.worldSize/this.zoomScale(l.z),f=l.x+Math.pow(2,l.z)*n.wrap,y=c.an(new Float64Array(16));return c.J(y,y,[f*d,l.y*d,0]),c.K(y,y,[d/c.X,d/c.X,1]),y}calculatePosMatrix(n,l=!1){const d=n.key,f=l?this._alignedPosMatrixCache:this._posMatrixCache;if(f[d])return f[d];const y=this.calculateTileMatrix(n);return c.L(y,l?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,y),f[d]=new Float32Array(y),f[d]}calculateFogMatrix(n){const l=n.key,d=this._fogMatrixCache;if(d[l])return d[l];const f=this.calculateTileMatrix(n);return c.L(f,this.fogMatrix,f),d[l]=new Float32Array(f),d[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(n,l){l=c.ac(+l,this.minZoom,this.maxZoom);const d={center:new c.N(n.lng,n.lat),zoom:l};let f=this.lngRange;if(!this._renderWorldCopies&&f===null){const se=179.9999999999;f=[-se,se]}const y=this.tileSize*this.zoomScale(d.zoom);let w=0,C=y,A=0,z=y,B=0,F=0;const{x:q,y:J}=this.size;if(this.latRange){const se=this.latRange;w=c.Q(se[1])*y,C=c.Q(se[0])*y,C-w<J&&(B=J/(C-w))}f&&(A=c.b3(c.O(f[0])*y,0,y),z=c.b3(c.O(f[1])*y,0,y),z<A&&(z+=y),z-A<q&&(F=q/(z-A)));const{x:ee,y:ae}=this.project.call({worldSize:y},n);let he,fe;const ye=Math.max(F||0,B||0);if(ye){const se=new c.P(F?(z+A)/2:ee,B?(C+w)/2:ae);return d.center=this.unproject.call({worldSize:y},se).wrap(),d.zoom+=this.scaleZoom(ye),d}if(this.latRange){const se=J/2;ae-se<w&&(fe=w+se),ae+se>C&&(fe=C-se)}if(f){const se=(A+z)/2;let be=ee;this._renderWorldCopies&&(be=c.b3(ee,se-y/2,se+y/2));const we=q/2;be-we<A&&(he=A+we),be+we>z&&(he=z-we)}if(he!==void 0||fe!==void 0){const se=new c.P(he??ee,fe??ae);d.center=this.unproject.call({worldSize:y},se).wrap()}return d}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:l,zoom:d}=this.getConstrained(this.center,this.zoom);this.center=l,this.zoom=d,this._unmodified=n,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,l=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let f=c.an(new Float64Array(16));c.K(f,f,[this.width/2,-this.height/2,1]),c.J(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=c.an(new Float64Array(16)),c.K(f,f,[1,-1,1]),c.J(f,f,[-1,-1,0]),c.K(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),C=y-w*this._pixelPerMeter/Math.cos(this._pitch),A=w<0?C:y,z=Math.PI/2+this._pitch,B=this._fov*(.5+n.y/this.height),F=Math.sin(B)*A/Math.sin(c.ac(Math.PI-z-B,.01,Math.PI-.01)),q=this.getHorizon(),J=2*Math.atan(q/this.cameraToCenterDistance)*(.5+n.y/(2*q)),ee=Math.sin(J)*A/Math.sin(c.ac(Math.PI-z-J,.01,Math.PI-.01)),ae=Math.min(F,ee);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ae+A),this.nearZ=this.height/50,f=new Float64Array(16),c.b6(f,this._fov,this.width/this.height,this.nearZ,this.farZ),f[8]=2*-n.x/this.width,f[9]=2*n.y/this.height,this.projectionMatrix=c.ae(f),c.K(f,f,[1,-1,1]),c.J(f,f,[0,0,-this.cameraToCenterDistance]),c.b7(f,f,this._pitch),c.ad(f,f,this.angle),c.J(f,f,[-l,-d,0]),this.mercatorMatrix=c.K([],f,[this.worldSize,this.worldSize,this.worldSize]),c.K(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,f),c.J(f,f,[0,0,-this.elevation]),this.modelViewProjectionMatrix=f,this.invModelViewProjectionMatrix=c.as([],f),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,y,this.farZ),this.fogMatrix[8]=2*-n.x/this.width,this.fogMatrix[9]=2*n.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-l,-d,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,f);const he=this.width%2/2,fe=this.height%2/2,ye=Math.cos(this.angle),se=Math.sin(this.angle),be=l-Math.round(l)+ye*he+se*fe,we=d-Math.round(d)+ye*fe+se*he,Ee=new Float64Array(f);if(c.J(Ee,Ee,[be>.5?be-1:be,we>.5?we-1:we,0]),this.alignedModelViewProjectionMatrix=Ee,f=c.as(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new c.P(0,0)),l=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.af(l,l,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,n))}getCameraQueryGeometry(n){const l=this.getCameraPoint();if(n.length===1)return[n[0],l];{let d=l.x,f=l.y,y=l.x,w=l.y;for(const C of n)d=Math.min(d,C.x),f=Math.min(f,C.y),y=Math.max(y,C.x),w=Math.max(w,C.y);return[new c.P(d,f),new c.P(y,f),new c.P(y,w),new c.P(d,w),new c.P(d,f)]}}lngLatToCameraDepth(n,l){const d=this.locationCoordinate(n),f=[d.x*this.worldSize,d.y*this.worldSize,l,1];return c.af(f,f,this.modelViewProjectionMatrix),f[2]/f[3]}}function el(v,n){let l,d=!1,f=null,y=null;const w=()=>{f=null,d&&(v.apply(y,l),f=setTimeout(w,n),d=!1)};return(...C)=>(d=!0,y=this,l=C,f||w(),f)}class oc{constructor(n){this._getCurrentHash=()=>{const l=window.location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(d=f)}),(d&&d[1]||"").split("/")}return l.split("/")},this._onHashChange=()=>{const l=this._getCurrentHash();if(l.length>=3&&!l.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:d,pitch:+(l[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const l=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,l)},this._removeHash=()=>{const l=this._getCurrentHash();if(l.length===0)return;const d=l.join("/");let f=d;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${d}`);let y=window.location.hash.replace(f,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let w=window.location.href.replace(/(#.+)?$/,y);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=el(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const l=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,f=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,f),w=Math.round(l.lng*y)/y,C=Math.round(l.lat*y)/y,A=this._map.getBearing(),z=this._map.getPitch();let B="";if(B+=n?`/${w}/${C}/${d}`:`${d}/${C}/${w}`,(A||z)&&(B+="/"+Math.round(10*A)/10),z&&(B+=`/${Math.round(z)}`),this._hashName){const F=this._hashName;let q=!1;const J=window.location.hash.slice(1).split("&").map(ee=>{const ae=ee.split("=")[0];return ae===F?(q=!0,`${ae}=${B}`):ee}).filter(ee=>ee);return q||J.push(`${F}=${B}`),`#${J.join("&")}`}return`#${B}`}}const ac={linearity:.3,easing:c.b8(0,0,.3,1)},rh=c.e({deceleration:2500,maxSpeed:1400},ac),Ng=c.e({deceleration:20,maxSpeed:1400},ac),Mf=c.e({deceleration:1e3,maxSpeed:360},ac),lc=c.e({deceleration:1e3,maxSpeed:90},ac);class ih{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:k.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=k.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)l.zoom+=y.zoomDelta||0,l.bearing+=y.bearingDelta||0,l.pitch+=y.pitchDelta||0,y.panDelta&&l.pan._add(y.panDelta),y.around&&(l.around=y.around),y.pinchAround&&(l.pinchAround=y.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(l.pan.mag()){const y=nl(l.pan.mag(),d,c.e({},rh,n||{}));f.offset=l.pan.mult(y.amount/l.pan.mag()),f.center=this._map.transform.center,tl(f,y)}if(l.zoom){const y=nl(l.zoom,d,Ng);f.zoom=this._map.transform.zoom+y.amount,tl(f,y)}if(l.bearing){const y=nl(l.bearing,d,Mf);f.bearing=this._map.transform.bearing+c.ac(y.amount,-179,179),tl(f,y)}if(l.pitch){const y=nl(l.pitch,d,lc);f.pitch=this._map.transform.pitch+y.amount,tl(f,y)}if(f.zoom||f.bearing){const y=l.pinchAround===void 0?l.around:l.pinchAround;f.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),c.e(f,{noMoveStart:!0})}}function tl(v,n){(!v.duration||v.duration<n.duration)&&(v.duration=n.duration,v.easing=n.easing)}function nl(v,n,l){const{maxSpeed:d,linearity:f,deceleration:y}=l,w=c.ac(v*f/(n/1e3),-d,d),C=Math.abs(w)/(y*f);return{easing:l.easing,duration:1e3*C,amount:w*(C/2)}}class Ar extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d,f={}){const y=I.mousePos(l.getCanvas(),d),w=l.unproject(y);super(n,c.e({point:y,lngLat:w,originalEvent:d},f)),this._defaultPrevented=!1,this.target=l}}class po extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){const f=n==="touchend"?d.changedTouches:d.touches,y=I.touchPos(l.getCanvasContainer(),f),w=y.map(A=>l.unproject(A)),C=y.reduce((A,z,B,F)=>A.add(z.div(F.length)),new c.P(0,0));super(n,{points:y,point:C,lngLats:w,lngLat:l.unproject(C),originalEvent:d}),this._defaultPrevented=!1}}class Df extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){super(n,{originalEvent:d}),this._defaultPrevented=!1}}class zf{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Df(n.type,this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new Ar(n.type,this._map,n))}mouseup(n){this._map.fire(new Ar(n.type,this._map,n))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||this._map.fire(new Ar(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Ar(n.type,this._map,n))}mouseover(n){this._map.fire(new Ar(n.type,this._map,n))}mouseout(n){this._map.fire(new Ar(n.type,this._map,n))}touchstart(n){return this._firePreventable(new po(n.type,this._map,n))}touchmove(n){this._map.fire(new po(n.type,this._map,n))}touchend(n){this._map.fire(new po(n.type,this._map,n))}touchcancel(n){this._map.fire(new po(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Un{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Ar(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ar("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Ar(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gi{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(c.P.convert(n),this._map.terrain)}}class fi{constructor(n,l){this._map=n,this._tr=new Gi(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(I.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const d=l;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=d,this._box||(this._box=I.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const y=Math.min(f.x,d.x),w=Math.max(f.x,d.x),C=Math.min(f.y,d.y),A=Math.max(f.y,d.y);I.setTransform(this._box,`translate(${y}px,${C}px)`),this._box.style.width=w-y+"px",this._box.style.height=A-C+"px"}mouseupWindow(n,l){if(!this._active||n.button!==0)return;const d=this._startPos,f=l;if(this.reset(),I.suppressClick(),d.x!==f.x||d.y!==f.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:n})),{cameraAnimation:y=>y.fitScreenCoordinates(d,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(I.remove(this._box),this._box=null),I.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new c.k(n,{originalEvent:l}))}}function rl(v,n){if(v.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${n.length}`);const l={};for(let d=0;d<v.length;d++)l[v[d].identifier]=n[d];return l}class sh{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,l,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),d.length===this.numTouches&&(this.centroid=function(f){const y=new c.P(0,0);for(const w of f)y._add(w);return y.div(f.length)}(l),this.touches=rl(d,l)))}touchmove(n,l,d){if(this.aborted||!this.centroid)return;const f=rl(d,l);for(const y in this.touches){const w=f[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(n,l,d){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class cc{constructor(n){this.singleTap=new sh(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,l,d){this.singleTap.touchstart(n,l,d)}touchmove(n,l,d){this.singleTap.touchmove(n,l,d)}touchend(n,l,d){const f=this.singleTap.touchend(n,l,d);if(f){const y=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(f)<30;if(y&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class Jo{constructor(n){this._tr=new Gi(n),this._zoomIn=new cc({numTouches:1,numTaps:2}),this._zoomOut=new cc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,d){this._zoomIn.touchstart(n,l,d),this._zoomOut.touchstart(n,l,d)}touchmove(n,l,d){this._zoomIn.touchmove(n,l,d),this._zoomOut.touchmove(n,l,d)}touchend(n,l,d){const f=this._zoomIn.touchend(n,l,d),y=this._zoomOut.touchend(n,l,d),w=this._tr;return f?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(f)},{originalEvent:n})}):y?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(y)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ks{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const l=this._moveFunction(...n);if(l.bearingDelta||l.pitchDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(n,l){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=l.length?l[0]:l,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,l){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const f=l.length?l[0]:l;return!this._moved&&f.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(d,f))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&I.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const oh={0:1,2:2};class uc{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const l=I.mouseButton(n);this._eventButton=l}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(l,d){const f=oh[d];return l.buttons===void 0||(l.buttons&f)!==f}(n,this._eventButton)}isValidEndEvent(n){return I.mouseButton(n)===this._eventButton}}class ah{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const hc=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=n=>{n.preventDefault()}},lh=({enable:v,clickTolerance:n,bearingDegreesPerPixelMoved:l=.8})=>{const d=new uc({checkCorrectEvent:f=>I.mouseButton(f)===0&&f.ctrlKey||I.mouseButton(f)===2});return new ks({clickTolerance:n,move:(f,y)=>({bearingDelta:(y.x-f.x)*l}),moveStateManager:d,enable:v,assignEvents:hc})},ch=({enable:v,clickTolerance:n,pitchDegreesPerPixelMoved:l=-.5})=>{const d=new uc({checkCorrectEvent:f=>I.mouseButton(f)===0&&f.ctrlKey||I.mouseButton(f)===2});return new ks({clickTolerance:n,move:(f,y)=>({pitchDelta:(y.y-f.y)*l}),moveStateManager:d,enable:v,assignEvents:hc})};class mo{constructor(n,l){this._clickTolerance=n.clickTolerance||1,this._map=l,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,l,d){return this._calculateTransform(n,l,d)}touchmove(n,l,d){if(this._active){if(!this._shouldBePrevented(d.length))return n.preventDefault(),this._calculateTransform(n,l,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,l,d){this._calculateTransform(n,l,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,d){d.length>0&&(this._active=!0);const f=rl(d,l),y=new c.P(0,0),w=new c.P(0,0);let C=0;for(const z in f){const B=f[z],F=this._touches[z];F&&(y._add(B),w._add(B.sub(F)),C++,f[z]=B)}if(this._touches=f,this._shouldBePrevented(C)||!w.mag())return;const A=w.div(C);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(C),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,l,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,d){if(!this._firstTwoTouches)return;n.preventDefault();const[f,y]=this._firstTwoTouches,w=il(d,l,f),C=il(d,l,y);if(!w||!C)return;const A=this._aroundCenter?null:w.add(C).div(2);return this._move([w,C],A,n)}touchend(n,l,d){if(!this._firstTwoTouches)return;const[f,y]=this._firstTwoTouches,w=il(d,l,f),C=il(d,l,y);w&&C||(this._active&&I.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function il(v,n,l){for(let d=0;d<v.length;d++)if(v[d].identifier===l)return n[d]}function uh(v,n){return Math.log(v/n)/Math.LN2}class hh extends dc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const d=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(uh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:uh(this._distance,d),pinchAround:l}}}function dh(v,n){return 180*v.angleWith(n)/Math.PI}class fh extends dc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l,d){const f=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:dh(this._vector,f),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,d=dh(n,this._startVector);return Math.abs(d)<l}}function fc(v){return Math.abs(v.y)>Math.abs(v.x)}class sl extends dc{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,l,d){super.touchstart(n,l,d),this._currentTouchCount=d.length}_start(n){this._lastPoints=n,fc(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=n[0].sub(this._lastPoints[0]),y=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,y,d.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(f.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(n,l,d){if(this._valid!==void 0)return this._valid;const f=n.mag()>=2,y=l.mag()>=2;if(!f&&!y)return;if(!f||!y)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const w=n.y>0==l.y>0;return fc(n)&&fc(l)&&w}}const Rf={panStep:100,bearingStep:15,pitchStep:10};class Pi{constructor(n){this._tr=new Gi(n);const l=Rf;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,d=0,f=0,y=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?d=-1:(n.preventDefault(),y=-1);break;case 39:n.shiftKey?d=1:(n.preventDefault(),y=1);break;case 38:n.shiftKey?f=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?f=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(d=0,f=0),{cameraAnimation:C=>{const A=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:ls,zoom:l?Math.round(A.zoom)+l*(n.shiftKey?2:1):A.zoom,bearing:A.bearing+d*this._bearingStep,pitch:A.pitch+f*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:A.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ls(v){return v*(2-v)}const ph=4.000244140625;class Wi{constructor(n,l){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=n,this._tr=new Gi(n),this._triggerRenderFrame=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let l=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const d=k.now(),f=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,l!==0&&l%ph==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(f*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=I.mousePos(this._map.getCanvas(),n),d=this._tr;this._around=l.y>d.transform.height/2-d.transform.getHorizon()?c.N.convert(this._aroundCenter?d.center:d.unproject(l)):c.N.convert(d.center),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>ph?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&z!==0&&(z=1/z);const B=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(B*z))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const l=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,d=this._startZoom,f=this._easing;let y,w=!1;const C=k.now()-this._lastWheelEventTime;if(this._type==="wheel"&&d&&f&&C){const A=Math.min(C/200,1),z=f(A);y=c.y.number(d,l,z),A<1?this._frameId||(this._frameId=!0):w=!0}else y=l,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:y-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=c.b9;if(this._prevEase){const d=this._prevEase,f=(k.now()-d.start)/d.duration,y=d.easing(f+.01)-d.easing(f),w=.27/Math.sqrt(y*y+1e-4)*.01,C=Math.sqrt(.0729-w*w);l=c.b8(w,C,.25,1)}return this._prevEase={start:k.now(),duration:n,easing:l},l}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class go{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Og{constructor(n){this._tr=new Gi(n),this.reset()}reset(){this._active=!1}dblclick(n,l){return n.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jg{constructor(){this._tap=new cc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,l,d){if(!this._swipePoint)if(this._tapTime){const f=l[0],y=n.timeStamp-this._tapTime<500,w=this._tapPoint.dist(f)<30;y&&w?d.length>0&&(this._swipePoint=f,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(n,l,d)}touchmove(n,l,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const f=l[0],y=f.y-this._swipePoint.y;return this._swipePoint=f,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,l,d)}touchend(n,l,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const f=this._tap.touchend(n,l,d);f&&(this._tapTime=n.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lf{constructor(n,l,d){this._el=n,this._mousePan=l,this._touchPan=d}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Bf{constructor(n,l,d){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=l,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class mh{constructor(n,l,d,f){this._el=n,this._touchZoom=l,this._touchRotate=d,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Qo{constructor(n,l){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=l,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=I.create("div","maplibregl-cooperative-gesture-screen",n);let l=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(l=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=l,this._container.appendChild(f);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=d,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(I.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,l){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:n,originalEvent:l})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ii=v=>v.zoom||v.drag||v.pitch||v.rotate;class yt extends c.k{}function pc(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class gh{constructor(n,l){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,y)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=f.type==="renderFrame"?void 0:f,C={needsRenderFrame:!1},A={},z={},B=f.touches,F=B?this._getMapTouches(B):void 0,q=F?I.touchPos(this._map.getCanvas(),F):I.mousePos(this._map.getCanvas(),f);for(const{handlerName:ae,handler:he,allowed:fe}of this._handlers){if(!he.isEnabled())continue;let ye;this._blockedByActive(z,fe,ae)?he.reset():he[y||f.type]&&(ye=he[y||f.type](f,q,F),this.mergeHandlerResult(C,A,ye,ae,w),ye&&ye.needsRenderFrame&&this._triggerRenderFrame()),(ye||he.isActive())&&(z[ae]=he)}const J={};for(const ae in this._previousActiveHandlers)z[ae]||(J[ae]=w);this._previousActiveHandlers=z,(Object.keys(J).length||pc(C))&&(this._changes.push([C,A,J]),this._triggerRenderFrame()),(Object.keys(z).length||pc(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ee}=C;ee&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ee(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ih(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,y,w]of this._listeners)I.addEventListener(f,y,f===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[n,l,d]of this._listeners)I.removeEventListener(n,l,n===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(n){const l=this._map,d=l.getCanvasContainer();this._add("mapEvent",new zf(l,n));const f=l.boxZoom=new fi(l,n);this._add("boxZoom",f),n.interactive&&n.boxZoom&&f.enable();const y=l.cooperativeGestures=new Qo(l,n.cooperativeGestures);this._add("cooperativeGestures",y),n.cooperativeGestures&&y.enable();const w=new Jo(l),C=new Og(l);l.doubleClickZoom=new go(C,w),this._add("tapZoom",w),this._add("clickZoom",C),n.interactive&&n.doubleClickZoom&&l.doubleClickZoom.enable();const A=new jg;this._add("tapDragZoom",A);const z=l.touchPitch=new sl(l);this._add("touchPitch",z),n.interactive&&n.touchPitch&&l.touchPitch.enable(n.touchPitch);const B=lh(n),F=ch(n);l.dragRotate=new Bf(n,B,F),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]),n.interactive&&n.dragRotate&&l.dragRotate.enable();const q=(({enable:ye,clickTolerance:se})=>{const be=new uc({checkCorrectEvent:we=>I.mouseButton(we)===0&&!we.ctrlKey});return new ks({clickTolerance:se,move:(we,Ee)=>({around:Ee,panDelta:Ee.sub(we)}),activateOnStart:!0,moveStateManager:be,enable:ye,assignEvents:hc})})(n),J=new mo(n,l);l.dragPan=new Lf(d,q,J),this._add("mousePan",q),this._add("touchPan",J,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&l.dragPan.enable(n.dragPan);const ee=new fh,ae=new hh;l.touchZoomRotate=new mh(d,ae,ee,A),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&l.touchZoomRotate.enable(n.touchZoomRotate);const he=l.scrollZoom=new Wi(l,()=>this._triggerRenderFrame());this._add("scrollZoom",he,["mousePan"]),n.interactive&&n.scrollZoom&&l.scrollZoom.enable(n.scrollZoom);const fe=l.keyboard=new Pi(l);this._add("keyboard",fe),n.interactive&&n.keyboard&&l.keyboard.enable(),this._add("blockableMapEvent",new Un(l))}_add(n,l,d){this._handlers.push({handlerName:n,handler:l,allowed:d}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ii(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,l,d){for(const f in n)if(f!==d&&(!l||l.indexOf(f)<0))return!0;return!1}_getMapTouches(n){const l=[];for(const d of n)this._el.contains(d.target)&&l.push(d);return l}mergeHandlerResult(n,l,d,f,y){if(!d)return;c.e(n,d);const w={handlerName:f,originalEvent:d.originalEvent||y};d.zoomDelta!==void 0&&(l.zoom=w),d.panDelta!==void 0&&(l.drag=w),d.pitchDelta!==void 0&&(l.pitch=w),d.bearingDelta!==void 0&&(l.rotate=w)}_applyChanges(){const n={},l={},d={};for(const[f,y,w]of this._changes)f.panDelta&&(n.panDelta=(n.panDelta||new c.P(0,0))._add(f.panDelta)),f.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(n.around=f.around),f.pinchAround!==void 0&&(n.pinchAround=f.pinchAround),f.noInertia&&(n.noInertia=f.noInertia),c.e(l,y),c.e(d,w);this._updateMapTransform(n,l,d),this._changes=[]}_updateMapTransform(n,l,d){const f=this._map,y=f._getTransformForUpdate(),w=f.terrain;if(!(pc(n)||w&&this._terrainMovement))return this._fireEvents(l,d,!0);let{panDelta:C,zoomDelta:A,bearingDelta:z,pitchDelta:B,around:F,pinchAround:q}=n;q!==void 0&&(F=q),f._stop(!0),F=F||f.transform.centerPoint;const J=y.pointLocation(C?F.sub(C):F);z&&(y.bearing+=z),B&&(y.pitch+=B),A&&(y.zoom+=A),w?this._terrainMovement||!l.drag&&!l.zoom?l.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(C)):y.setLocationAtPoint(J,F):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(J,F)):y.setLocationAtPoint(J,F),f._applyUpdatedTransform(y),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,d,!0)}_fireEvents(n,l,d){const f=Ii(this._eventsInProgress),y=Ii(n),w={};for(const F in n){const{originalEvent:q}=n[F];this._eventsInProgress[F]||(w[`${F}start`]=q),this._eventsInProgress[F]=n[F]}!f&&y&&this._fireEvent("movestart",y.originalEvent);for(const F in w)this._fireEvent(F,w[F]);y&&this._fireEvent("move",y.originalEvent);for(const F in n){const{originalEvent:q}=n[F];this._fireEvent(F,q)}const C={};let A;for(const F in this._eventsInProgress){const{handlerName:q,originalEvent:J}=this._eventsInProgress[F];this._handlersById[q].isActive()||(delete this._eventsInProgress[F],A=l[q]||J,C[`${F}end`]=A)}for(const F in C)this._fireEvent(F,C[F]);const z=Ii(this._eventsInProgress),B=(f||y)&&!z;if(B&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const F=this._map._getTransformForUpdate();F.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(F)}if(d&&B){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;!F||!F.essential&&k.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:A})),q(this._map.getBearing())&&this._map.resetNorth()):(q(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:A})),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new c.k(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new yt("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ff extends c.E{constructor(n,l){super(),this._renderFrameCallback=()=>{const d=Math.min((k.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}panBy(n,l,d){return n=c.P.convert(n).mult(-1),this.panTo(this.transform.center,c.e({offset:n},l),d)}panTo(n,l,d){return this.easeTo(c.e({center:n},l),d)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,d){return this.easeTo(c.e({zoom:n},l),d)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,d){return this.easeTo(c.e({bearing:n},l),d)}resetNorth(n,l){return this.rotateTo(0,c.e({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}cameraForBounds(n,l){n=Pe.convert(n).adjustAntiMeridian();const d=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),d,l)}_cameraForBoxAndBearing(n,l,d,f){const y={top:0,bottom:0,right:0,left:0};if(typeof(f=c.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const it=f.padding;f.padding={top:it,bottom:it,right:it,left:it}}f.padding=c.e(y,f.padding);const w=this.transform,C=w.padding,A=new Pe(n,l),z=w.project(A.getNorthWest()),B=w.project(A.getNorthEast()),F=w.project(A.getSouthEast()),q=w.project(A.getSouthWest()),J=c.ba(-d),ee=z.rotate(J),ae=B.rotate(J),he=F.rotate(J),fe=q.rotate(J),ye=new c.P(Math.max(ee.x,ae.x,fe.x,he.x),Math.max(ee.y,ae.y,fe.y,he.y)),se=new c.P(Math.min(ee.x,ae.x,fe.x,he.x),Math.min(ee.y,ae.y,fe.y,he.y)),be=ye.sub(se),we=(w.width-(C.left+C.right+f.padding.left+f.padding.right))/be.x,Ee=(w.height-(C.top+C.bottom+f.padding.top+f.padding.bottom))/be.y;if(Ee<0||we<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const je=Math.min(w.scaleZoom(w.scale*Math.min(we,Ee)),f.maxZoom),Ke=c.P.convert(f.offset),lt=new c.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(c.ba(d)),ft=Ke.add(lt).mult(w.scale/w.zoomScale(je));return{center:w.unproject(z.add(F).div(2).sub(ft)),zoom:je,bearing:d}}fitBounds(n,l,d){return this._fitInternal(this.cameraForBounds(n,l),l,d)}fitScreenCoordinates(n,l,d,f,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(n)),this.transform.pointLocation(c.P.convert(l)),d,f),f,y)}_fitInternal(n,l,d){return n?(delete(l=c.e(n,l)).padding,l.linear?this.easeTo(l,d):this.flyTo(l,d)):this}jumpTo(n,l){this.stop();const d=this._getTransformForUpdate();let f=!1,y=!1,w=!1;return"zoom"in n&&d.zoom!==+n.zoom&&(f=!0,d.zoom=+n.zoom),n.center!==void 0&&(d.center=c.N.convert(n.center)),"bearing"in n&&d.bearing!==+n.bearing&&(y=!0,d.bearing=+n.bearing),"pitch"in n&&d.pitch!==+n.pitch&&(w=!0,d.pitch=+n.pitch),n.padding==null||d.isPaddingEqual(n.padding)||(d.padding=n.padding),this._applyUpdatedTransform(d),this.fire(new c.k("movestart",l)).fire(new c.k("move",l)),f&&this.fire(new c.k("zoomstart",l)).fire(new c.k("zoom",l)).fire(new c.k("zoomend",l)),y&&this.fire(new c.k("rotatestart",l)).fire(new c.k("rotate",l)).fire(new c.k("rotateend",l)),w&&this.fire(new c.k("pitchstart",l)).fire(new c.k("pitch",l)).fire(new c.k("pitchend",l)),this.fire(new c.k("moveend",l))}calculateCameraOptionsFromTo(n,l,d,f=0){const y=c.Z.fromLngLat(n,l),w=c.Z.fromLngLat(d,f),C=w.x-y.x,A=w.y-y.y,z=w.z-y.z,B=Math.hypot(C,A,z);if(B===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(C,A),q=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),J=180*Math.atan2(C,-A)/Math.PI;let ee=180*Math.acos(F/B)/Math.PI;return ee=z<0?90-ee:90+ee,{center:w.toLngLat(),zoom:q,pitch:ee,bearing:J}}easeTo(n,l){var d;this._stop(!1,n.easeId),((n=c.e({offset:[0,0],duration:500,easing:c.b9},n)).animate===!1||!n.essential&&k.prefersReducedMotion)&&(n.duration=0);const f=this._getTransformForUpdate(),y=f.zoom,w=f.bearing,C=f.pitch,A=f.padding,z="bearing"in n?this._normalizeBearing(n.bearing,w):w,B="pitch"in n?+n.pitch:C,F="padding"in n?n.padding:f.padding,q=c.P.convert(n.offset);let J=f.centerPoint.add(q);const ee=f.pointLocation(J),{center:ae,zoom:he}=f.getConstrained(c.N.convert(n.center||ee),(d=n.zoom)!==null&&d!==void 0?d:y);this._normalizeCenter(ae,f);const fe=f.project(ee),ye=f.project(ae).sub(fe),se=f.zoomScale(he-y);let be,we;n.around&&(be=c.N.convert(n.around),we=f.locationPoint(be));const Ee={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||he!==y,this._rotating=this._rotating||w!==z,this._pitching=this._pitching||B!==C,this._padding=!f.isPaddingEqual(F),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Ee),this.terrain&&this._prepareElevation(ae),this._ease(je=>{if(this._zooming&&(f.zoom=c.y.number(y,he,je)),this._rotating&&(f.bearing=c.y.number(w,z,je)),this._pitching&&(f.pitch=c.y.number(C,B,je)),this._padding&&(f.interpolatePadding(A,F,je),J=f.centerPoint.add(q)),this.terrain&&!n.freezeElevation&&this._updateElevation(je),be)f.setLocationAtPoint(be,we);else{const Ke=f.zoomScale(f.zoom-y),lt=he>y?Math.min(2,se):Math.max(.5,se),ft=Math.pow(lt,1-je),it=f.unproject(fe.add(ye.mult(je*ft)).mult(Ke));f.setLocationAtPoint(f.renderWorldCopies?it.wrap():it,J)}this._applyUpdatedTransform(f),this._fireMoveEvents(l)},je=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l,je)},n),this}_prepareEase(n,l,d={}){this._moving=!0,l||d.moving||this.fire(new c.k("movestart",n)),this._zooming&&!d.zooming&&this.fire(new c.k("zoomstart",n)),this._rotating&&!d.rotating&&this.fire(new c.k("rotatestart",n)),this._pitching&&!d.pitching&&this.fire(new c.k("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const l=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&l!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(d-(l-(d*n+this._elevationStart))/(1-n)),this._elevationTarget=l}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){const l=n.getCameraPosition(),d=this.terrain.getElevationForLngLatZoom(l.lngLat,n.zoom);if(l.altitude<d){const f=this.calculateCameraOptionsFromTo(l.lngLat,d,n.center,n.elevation);return{pitch:f.pitch,zoom:f.zoom}}return{}}_applyUpdatedTransform(n){const l=[];if(this.terrain&&l.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&l.push(f=>this.transformCameraUpdate(f)),!l.length)return;const d=n.clone();for(const f of l){const y=d.clone(),{center:w,zoom:C,pitch:A,bearing:z,elevation:B}=f(y);w&&(y.center=w),C!==void 0&&(y.zoom=C),A!==void 0&&(y.pitch=A),z!==void 0&&(y.bearing=z),B!==void 0&&(y.elevation=B),d.apply(y)}this.transform.apply(d)}_fireMoveEvents(n){this.fire(new c.k("move",n)),this._zooming&&this.fire(new c.k("zoom",n)),this._rotating&&this.fire(new c.k("rotate",n)),this._pitching&&this.fire(new c.k("pitch",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId;const d=this._zooming,f=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new c.k("zoomend",n)),f&&this.fire(new c.k("rotateend",n)),y&&this.fire(new c.k("pitchend",n)),this.fire(new c.k("moveend",n))}flyTo(n,l){var d;if(!n.essential&&k.prefersReducedMotion){const ut=c.M(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ut,l)}this.stop(),n=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},n);const f=this._getTransformForUpdate(),y=f.zoom,w=f.bearing,C=f.pitch,A=f.padding,z="bearing"in n?this._normalizeBearing(n.bearing,w):w,B="pitch"in n?+n.pitch:C,F="padding"in n?n.padding:f.padding,q=c.P.convert(n.offset);let J=f.centerPoint.add(q);const ee=f.pointLocation(J),{center:ae,zoom:he}=f.getConstrained(c.N.convert(n.center||ee),(d=n.zoom)!==null&&d!==void 0?d:y);this._normalizeCenter(ae,f);const fe=f.zoomScale(he-y),ye=f.project(ee),se=f.project(ae).sub(ye);let be=n.curve;const we=Math.max(f.width,f.height),Ee=we/fe,je=se.mag();if("minZoom"in n){const ut=c.ac(Math.min(n.minZoom,y,he),f.minZoom,f.maxZoom),Ot=we/f.zoomScale(ut-y);be=Math.sqrt(Ot/je*2)}const Ke=be*be;function lt(ut){const Ot=(Ee*Ee-we*we+(ut?-1:1)*Ke*Ke*je*je)/(2*(ut?Ee:we)*Ke*je);return Math.log(Math.sqrt(Ot*Ot+1)-Ot)}function ft(ut){return(Math.exp(ut)-Math.exp(-ut))/2}function it(ut){return(Math.exp(ut)+Math.exp(-ut))/2}const rt=lt(!1);let wt=function(ut){return it(rt)/it(rt+be*ut)},Vt=function(ut){return we*((it(rt)*(ft(Ot=rt+be*ut)/it(Ot))-ft(rt))/Ke)/je;var Ot},st=(lt(!0)-rt)/be;if(Math.abs(je)<1e-6||!isFinite(st)){if(Math.abs(we-Ee)<1e-6)return this.easeTo(n,l);const ut=Ee<we?-1:1;st=Math.abs(Math.log(Ee/we))/be,Vt=()=>0,wt=Ot=>Math.exp(ut*be*Ot)}return n.duration="duration"in n?+n.duration:1e3*st/("screenSpeed"in n?+n.screenSpeed/be:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=w!==z,this._pitching=B!==C,this._padding=!f.isPaddingEqual(F),this._prepareEase(l,!1),this.terrain&&this._prepareElevation(ae),this._ease(ut=>{const Ot=ut*st,In=1/wt(Ot);f.zoom=ut===1?he:y+f.scaleZoom(In),this._rotating&&(f.bearing=c.y.number(w,z,ut)),this._pitching&&(f.pitch=c.y.number(C,B,ut)),this._padding&&(f.interpolatePadding(A,F,ut),J=f.centerPoint.add(q)),this.terrain&&!n.freezeElevation&&this._updateElevation(ut);const qt=ut===1?ae:f.unproject(ye.add(se.mult(Vt(Ot))).mult(In));f.setLocationAtPoint(f.renderWorldCopies?qt.wrap():qt,J),this._applyUpdatedTransform(f),this._fireMoveEvents(l)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,l){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,l)}return n||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(n,l,d){d.animate===!1||d.duration===0?(n(1),l()):(this._easeStart=k.now(),this._easeOptions=d,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,l){n=c.b3(n,-180,180);const d=Math.abs(n-l);return Math.abs(n-360-l)<d&&(n-=360),Math.abs(n+360-l)<d&&(n+=360),n}_normalizeCenter(n,l){if(!l.renderWorldCopies||l.lngRange)return;const d=n.lng-l.center.lng;n.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(n),this.transform.tileZoom)-this.transform.elevation:null}}const ea={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ta{constructor(n=ea){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=l=>{!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=I.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=I.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=I.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){I.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,l){const d=this._map._getUIString(`AttributionControl.${l}`);n.title=d,n.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const l=this._map.style.sourceCaches;for(const f in l){const y=l[f];if(y.used||y.usedForTerrain){const w=y.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n=n.filter(f=>String(f).trim()),n.sort((f,y)=>f.length-y.length),n=n.filter((f,y)=>{for(let w=y+1;w<n.length;w++)if(n[w].indexOf(f)>=0)return!1;return!0});const d=n.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,n.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class yh{constructor(n={}){this._updateCompact=()=>{const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=I.create("div","maplibregl-ctrl");const l=I.create("a","maplibregl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://maplibre.org/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){I.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class nn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,d=l?this._queue.concat(l):this._queue;for(const f of d)if(f.id===n)return void(f.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const l=this._currentlyRunning=this._queue;this._queue=[];for(const d of l)if(!d.cancelled&&(d.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var vh=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Vg extends c.E{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,l){this.sourceCache.update(n,l),this._renderableTilesKeys=[];const d={};for(const f of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:l}))d[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),c.aP(f.posMatrix,0,c.X,0,c.X,0,1),this._tiles[f.key]=new zn(f,this.tileSize));for(const f in this._tiles)d[f]||delete this._tiles[f]}freeRtt(n){for(const l in this._tiles){const d=this._tiles[l];(!n||d.tileID.equals(n)||d.tileID.isChildOf(n)||n.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const l={};for(const d of this._renderableTilesKeys){const f=this._tiles[d].tileID;if(f.canonical.equals(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16),c.aP(y.posMatrix,0,c.X,0,c.X,0,1),l[d]=y}else if(f.canonical.isChildOf(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=f.canonical.z-n.canonical.z,C=f.canonical.x-(f.canonical.x>>w<<w),A=f.canonical.y-(f.canonical.y>>w<<w),z=c.X>>w;c.aP(y.posMatrix,0,z,0,z,0,1),c.J(y.posMatrix,y.posMatrix,[-C*z,-A*z,0]),l[d]=y}else if(n.canonical.isChildOf(f.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=n.canonical.z-f.canonical.z,C=n.canonical.x-(n.canonical.x>>w<<w),A=n.canonical.y-(n.canonical.y>>w<<w),z=c.X>>w;c.aP(y.posMatrix,0,c.X,0,c.X,0,1),c.J(y.posMatrix,y.posMatrix,[C*z,A*z,0]),c.K(y.posMatrix,y.posMatrix,[1/2**w,1/2**w,0]),l[d]=y}}return l}getSourceTile(n,l){const d=this.sourceCache._source;let f=n.overscaledZ-this.deltaZoom;if(f>d.maxzoom&&(f=d.maxzoom),f<d.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(f).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!y||!y.dem)&&l)for(;f>=d.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(n.scaledTo(f--).key);return y}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(l=>l.timeAdded>=n)}}class _h{constructor(n,l,d){this.painter=n,this.sourceCache=new Vg(l),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,l,d,f=c.X){var y;if(!(l>=0&&l<f&&d>=0&&d<f))return 0;const w=this.getTerrainData(n),C=(y=w.tile)===null||y===void 0?void 0:y.dem;if(!C)return 0;const A=function(ee,ae,he){var fe=ae[0],ye=ae[1];return ee[0]=he[0]*fe+he[4]*ye+he[12],ee[1]=he[1]*fe+he[5]*ye+he[13],ee}([],[l/f*c.X,d/f*c.X],w.u_terrain_matrix),z=[A[0]*C.dim,A[1]*C.dim],B=Math.floor(z[0]),F=Math.floor(z[1]),q=z[0]-B,J=z[1]-F;return C.get(B,F)*(1-q)*(1-J)+C.get(B+1,F)*q*(1-J)+C.get(B,F+1)*(1-q)*J+C.get(B+1,F+1)*q*J}getElevationForLngLatZoom(n,l){if(!c.bb(l,n.wrap()))return 0;const{tileID:d,mercatorX:f,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(n,l);return this.getElevation(d,f%c.X,y%c.X,c.X)}getElevation(n,l,d,f=c.X){return this.getDEMElevation(n,l,d,f)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const f=this.painter.context,y=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ce(f,y,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ce(f,new c.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const l=this.sourceCache.getSourceTile(n,!0);if(l&&l.dem&&(!l.demTexture||l.needsTerrainPrepare)){const f=this.painter.context;l.demTexture=this.painter.getTileTexture(l.dem.stride),l.demTexture?l.demTexture.update(l.dem.getPixels(),{premultiply:!1}):l.demTexture=new Ce(f,l.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),l.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),l.needsTerrainPrepare=!1}const d=l&&l+l.tileID.key+n.key;if(d&&!this._demMatrixCache[d]){const f=this.sourceCache.sourceCache._source.maxzoom;let y=n.canonical.z-l.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=f?y=n.canonical.z-f:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=n.canonical.x-(n.canonical.x>>y<<y),C=n.canonical.y-(n.canonical.y>>y<<y),A=c.bc(new Float64Array(16),[1/(c.X<<y),1/(c.X<<y),0]);c.J(A,A,[w*c.X,C*c.X,0]),this._demMatrixCache[n.key]={matrix:A,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:l&&l.dem&&l.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:l&&l.dem&&l.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(l&&l.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:l}}getFramebuffer(n){const l=this.painter,d=l.width/devicePixelRatio,f=l.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ce(l.context,{width:d,height:f,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ce(l.context,{width:d,height:f,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=l.context.createFramebuffer(d,f,!0,!1),this._fbo.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,d,f))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const l=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,w=0;y<this._coordsTextureSize;y++)for(let C=0;C<this._coordsTextureSize;C++,w+=4)l[w+0]=255&C,l[w+1]=255&y,l[w+2]=C>>8<<4|y>>8,l[w+3]=0;const d=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(l.buffer)),f=new Ce(n,d,n.gl.RGBA,{premultiply:!1});return f.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const l=new Uint8Array(4),d=this.painter.context,f=d.gl,y=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(y,C-w-1,1,1,f.RGBA,f.UNSIGNED_BYTE,l),d.bindFramebuffer.set(null);const A=l[0]+(l[2]>>4<<8),z=l[1]+((15&l[2])<<8),B=this.coordsIndex[255-l[3]],F=B&&this.sourceCache.getTileByID(B);if(!F)return null;const q=this._coordsTextureSize,J=(1<<F.tileID.canonical.z)*q;return new c.Z((F.tileID.canonical.x*q+A)/J+F.tileID.wrap,(F.tileID.canonical.y*q+z)/J,this.getElevation(F.tileID,A,z,q))}depthAtPoint(n){const l=new Uint8Array(4),d=this.painter.context,f=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,l),d.bindFramebuffer.set(null),(l[0]/16777216+l[1]/65536+l[2]/256+l[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,l=new c.bd,d=new c.aY,f=this.meshSize,y=c.X/f,w=f*f;for(let F=0;F<=f;F++)for(let q=0;q<=f;q++)l.emplaceBack(q*y,F*y,0);for(let F=0;F<w;F+=f+1)for(let q=0;q<f;q++)d.emplaceBack(q+F,f+q+F+1,f+q+F+2),d.emplaceBack(q+F,f+q+F+2,q+F+1);const C=l.length,A=C+2*(f+1);for(const F of[0,1])for(let q=0;q<=f;q++)for(const J of[0,1])l.emplaceBack(q*y,F*c.X,J);for(let F=0;F<2*f;F+=2)d.emplaceBack(A+F,A+F+1,A+F+3),d.emplaceBack(A+F,A+F+3,A+F+2),d.emplaceBack(C+F,C+F+3,C+F+1),d.emplaceBack(C+F,C+F+2,C+F+3);const z=l.length,B=z+2*(f+1);for(const F of[0,1])for(let q=0;q<=f;q++)for(const J of[0,1])l.emplaceBack(F*c.X,q*y,J);for(let F=0;F<2*f;F+=2)d.emplaceBack(z+F,z+F+1,z+F+3),d.emplaceBack(z+F,z+F+3,z+F+2),d.emplaceBack(B+F,B+F+3,B+F+1),d.emplaceBack(B+F,B+F+2,B+F+3);return this._mesh=new ic(n.createVertexBuffer(l,vh.members),n.createIndexBuffer(d),c.a0.simpleSegment(0,0,l.length,d.length)),this._mesh}getMeshFrameDelta(n){return 2*Math.PI*c.be/Math.pow(2,n)/5}getMinTileElevationForLngLatZoom(n,l){var d;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(n,l);return(d=this.getMinMaxElevation(f).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(n){const l=this.getTerrainData(n).tile,d={minElevation:null,maxElevation:null};return l&&l.dem&&(d.minElevation=l.dem.min*this.exaggeration,d.maxElevation=l.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(n,l){const d=c.Z.fromLngLat(n.wrap()),f=(1<<l)*c.X,y=d.x*f,w=d.y*f,C=Math.floor(y/c.X),A=Math.floor(w/c.X);return{tileID:new c.S(l,0,l,C,A),mercatorX:y,mercatorY:w}}}class Ug{constructor(n,l,d){this._context=n,this._size=l,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const l=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Ce(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),l.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),l.colorAttachment.set(d.texture),{id:n,fbo:l,texture:d,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(l=>n.id!==l),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const l of this._recentlyUsed)if(!this._objects[l].inUse)return this._objects[l];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const na={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Nf{constructor(n,l){this.painter=n,this.terrain=l,this.pool=new Ug(n.context,30,l.sourceCache.tileSize*l.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,l){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(d=>!n._layers[d].isHidden(l)),this._coordsDescendingInv={};for(const d in n.sourceCaches){this._coordsDescendingInv[d]={};const f=n.sourceCaches[d].getVisibleCoordinates();for(const y of f){const w=this.terrain.sourceCache.getTerrainCoords(y);for(const C in w)this._coordsDescendingInv[d][C]||(this._coordsDescendingInv[d][C]=[]),this._coordsDescendingInv[d][C].push(w[C])}}this._coordsDescendingInvStr={};for(const d of n._order){const f=n._layers[d],y=f.source;if(na[f.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const w in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][w]=this._coordsDescendingInv[y][w].map(C=>C.key).sort().join()}}for(const d of this._renderableTiles)for(const f in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[f][d.tileID.key];y&&y!==d.rttCoords[f]&&(d.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const l=n.type,d=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(na[l]&&(this._prevType&&na[this._prevType]||this._stacks.push([]),this._prevType=l,this._stacks[this._stacks.length-1].push(n.id),!f))return!0;if(na[this._prevType]||na[l]&&f){this._prevType=l;const y=this._stacks.length-1,w=this._stacks[y]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(Af(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[y]){const z=this.pool.getObjectForId(C.rtt[y].id);if(z.stamp===C.rtt[y].stamp){this.pool.useObject(z);continue}}const A=this.pool.getOrCreateFreeObject();this.pool.useObject(A),this.pool.stampObject(A),C.rtt[y]={id:A.id,stamp:A.stamp},d.context.bindFramebuffer.set(A.fbo.framebuffer),d.context.clear({color:c.aM.transparent,stencil:0}),d.currentStencilSource=void 0;for(let z=0;z<w.length;z++){const B=d.style._layers[w[z]],F=B.source?this._coordsDescendingInv[B.source][C.tileID.key]:[C.tileID];d.context.viewport.set([0,0,A.fbo.width,A.fbo.height]),d._renderTileClippingMasks(B,F),d.renderLayer(d,d.style.sourceCaches[B.source],B,F),B.source&&(C.rttCoords[B.source]=this._coordsDescendingInvStr[B.source][C.tileID.key])}}return Af(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),na[l]}return!1}}const xh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Of=S,$g={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ea,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},bh=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},Hg={showCompass:!0,showZoom:!0,visualizePitch:!1};class Gg{constructor(n,l,d=!1){this.mousedown=w=>{this.startMouse(c.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),I.mousePos(this.element,w)),I.addEventListener(window,"mousemove",this.mousemove),I.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,I.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=I.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),I.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=I.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const f=n.dragRotate._mouseRotate.getClickTolerance(),y=n.dragRotate._mousePitch.getClickTolerance();this.element=l,this.mouseRotate=lh({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:C,bearingDegreesPerPixelMoved:A=.8})=>{const z=new ah;return new ks({clickTolerance:C,move:(B,F)=>({bearingDelta:(F.x-B.x)*A}),moveStateManager:z,enable:w,assignEvents:bh})})({clickTolerance:f,enable:!0}),this.map=n,d&&(this.mousePitch=ch({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:C,pitchDegreesPerPixelMoved:A=-.5})=>{const z=new ah;return new ks({clickTolerance:C,move:(B,F)=>({pitchDelta:(F.y-B.y)*A}),moveStateManager:z,enable:w,assignEvents:bh})})({clickTolerance:y,enable:!0})),I.addEventListener(l,"mousedown",this.mousedown),I.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),I.addEventListener(l,"touchcancel",this.reset)}startMouse(n,l){this.mouseRotate.dragStart(n,l),this.mousePitch&&this.mousePitch.dragStart(n,l),I.disableDrag()}startTouch(n,l){this.touchRotate.dragStart(n,l),this.touchPitch&&this.touchPitch.dragStart(n,l),I.disableDrag()}moveMouse(n,l){const d=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(n,l)||{};if(f&&d.setBearing(d.getBearing()+f),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(n,l)||{};y&&d.setPitch(d.getPitch()+y)}}moveTouch(n,l){const d=this.map,{bearingDelta:f}=this.touchRotate.dragMove(n,l)||{};if(f&&d.setBearing(d.getBearing()+f),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(n,l)||{};y&&d.setPitch(d.getPitch()+y)}}off(){const n=this.element;I.removeEventListener(n,"mousedown",this.mousedown),I.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),I.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.removeEventListener(window,"touchend",this.touchend),I.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){I.enableDrag(),I.removeEventListener(window,"mousemove",this.mousemove),I.removeEventListener(window,"mouseup",this.mouseup),I.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.removeEventListener(window,"touchend",this.touchend)}}let pi;function Pn(v,n,l){const d=new c.N(v.lng,v.lat);if(v=new c.N(v.lng,v.lat),n){const f=new c.N(v.lng-360,v.lat),y=new c.N(v.lng+360,v.lat),w=l.locationPoint(v).distSqr(n);l.locationPoint(f).distSqr(n)<w?v=f:l.locationPoint(y).distSqr(n)<w&&(v=y)}for(;Math.abs(v.lng-l.center.lng)>180;){const f=l.locationPoint(v);if(f.x>=0&&f.y>=0&&f.x<=l.width&&f.y<=l.height)break;v.lng>l.center.lng?v.lng-=360:v.lng+=360}return v.lng!==d.lng&&l.locationPoint(v).y>l.height/2-l.getHorizon()?v:d}const ra={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function mc(v,n,l){const d=v.classList;for(const f in ra)d.remove(`maplibregl-${l}-anchor-${f}`);d.add(`maplibregl-${l}-anchor-${n}`)}class gc extends c.E{constructor(n){if(super(),this._onKeyPress=l=>{const d=l.code,f=l.charCode||l.keyCode;d!=="Space"&&d!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=l=>{const d=l.originalEvent.target,f=this._element;this._popup&&(d===f||f.contains(d))&&this.togglePopup()},this._update=l=>{var d;if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((l==null?void 0:l.type)==="terrain"||(l==null?void 0:l.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Pn(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||l&&l.type!=="moveend"||(this._pos=this._pos.round()),I.setTransform(this._element,`${ra[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${y}`),k.frameAsync(new AbortController).then(()=>{this._updateOpacity(l&&l.type==="moveend")}).catch(()=>{})},this._onMove=l=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=l=>{this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=c.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=I.create("div");const l=I.createNS("http://www.w3.org/2000/svg","svg"),d=41,f=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${d}px`),l.setAttributeNS(null,"width",`${f}px`),l.setAttributeNS(null,"viewBox",`0 0 ${f} ${d}`);const y=I.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const w=I.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const C=I.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of A){const ye=I.createNS("http://www.w3.org/2000/svg","ellipse");ye.setAttributeNS(null,"opacity","0.04"),ye.setAttributeNS(null,"cx","10.5"),ye.setAttributeNS(null,"cy","5.80029008"),ye.setAttributeNS(null,"rx",fe.rx),ye.setAttributeNS(null,"ry",fe.ry),C.appendChild(ye)}const z=I.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const B=I.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(B);const F=I.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const q=I.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(q);const J=I.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const ee=I.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ae=I.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#000000"),ae.setAttributeNS(null,"opacity","0.25"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962");const he=I.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#FFFFFF"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962"),ee.appendChild(ae),ee.appendChild(he),w.appendChild(C),w.appendChild(z),w.appendChild(F),w.appendChild(J),w.appendChild(ee),l.appendChild(w),l.setAttributeNS(null,"height",d*this._scale+"px"),l.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(l),this._offset=c.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),mc(this._element,this._anchor,"marker"),n&&n.className)for(const l of n.className.split(" "))this._element.classList.add(l);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),I.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=c.N.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const f=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var l,d;if(!(!((l=this._map)===null||l===void 0)&&l.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const f=this._map,y=f.terrain.depthAtPoint(this._pos),w=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,w)-y<.006)return void(this._element.style.opacity=this._opacity);const C=-this._offset.y/f.transform._pixelPerMeter,A=Math.sin(f.getPitch()*Math.PI/180)*C,z=f.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),B=f.transform.lngLatToCameraDepth(this._lngLat,w+A)-z>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=c.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,l){return n===void 0&&l===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),l!==void 0&&(this._opacityWhenCovered=l),this._map&&this._updateOpacity(!0),this}}const jf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ol=0,al=!1;const cs={maxWidth:100,unit:"metric"};function ll(v,n,l){const d=l&&l.maxWidth||100,f=v._container.clientHeight/2,y=v.unproject([0,f]),w=v.unproject([d,f]),C=y.distanceTo(w);if(l&&l.unit==="imperial"){const A=3.2808*C;A>5280?bt(n,d,A/5280,v._getUIString("ScaleControl.Miles")):bt(n,d,A,v._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?bt(n,d,C/1852,v._getUIString("ScaleControl.NauticalMiles")):C>=1e3?bt(n,d,C/1e3,v._getUIString("ScaleControl.Kilometers")):bt(n,d,C,v._getUIString("ScaleControl.Meters"))}function bt(v,n,l,d){const f=function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let C=y/w;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(A){const z=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*z)/z}(C),w*C}(l);v.style.width=n*(f/l)+"px",v.innerHTML=`${f}&nbsp;${d}`}const Lt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},yc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vc(v){if(v){if(typeof v=="number"){const n=Math.round(Math.abs(v)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,v),"top-left":new c.P(n,n),"top-right":new c.P(-n,n),bottom:new c.P(0,-v),"bottom-left":new c.P(n,-n),"bottom-right":new c.P(-n,-n),left:new c.P(v,0),right:new c.P(-v,0)}}if(v instanceof c.P||Array.isArray(v)){const n=c.P.convert(v);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:c.P.convert(v.center||[0,0]),top:c.P.convert(v.top||[0,0]),"top-left":c.P.convert(v["top-left"]||[0,0]),"top-right":c.P.convert(v["top-right"]||[0,0]),bottom:c.P.convert(v.bottom||[0,0]),"bottom-left":c.P.convert(v["bottom-left"]||[0,0]),"bottom-right":c.P.convert(v["bottom-right"]||[0,0]),left:c.P.convert(v.left||[0,0]),right:c.P.convert(v.right||[0,0])}}return vc(new c.P(0,0))}const wh=S;p.AJAXError=c.bh,p.Evented=c.E,p.LngLat=c.N,p.MercatorCoordinate=c.Z,p.Point=c.P,p.addProtocol=c.bi,p.config=c.a,p.removeProtocol=c.bj,p.AttributionControl=ta,p.BoxZoomHandler=fi,p.CanvasSource=er,p.CooperativeGesturesHandler=Qo,p.DoubleClickZoomHandler=go,p.DragPanHandler=Lf,p.DragRotateHandler=Bf,p.EdgeInsets=Ko,p.FullscreenControl=class extends c.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var n;let l=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=l==null?void 0:l.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)l=l.shadowRoot.fullscreenElement;l===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){I.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=I.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);I.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},p.GeoJSONSource=Ir,p.GeolocateControl=class extends c.E{constructor(v){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",n)),this._finish()}},this._updateCamera=n=>{const l=new c.N(n.coords.longitude,n.coords.latitude),d=n.coords.accuracy,f=this._map.getBearing(),y=c.e({bearing:f},this.options.fitBoundsOptions),w=Pe.fromLngLat(l,d);this._map.fitBounds(w,y,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const l=new c.N(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&al)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=I.create("button","maplibregl-ctrl-geolocate",this._container),I.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new gc({element:this._dotElement}),this._circleElement=I.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},jf,v)}onAdd(v){return this._map=v,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(n=!1){if(pi!==void 0&&!n)return pi;if(window.navigator.permissions===void 0)return pi=!!window.navigator.geolocation,pi;try{pi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{pi=!!window.navigator.geolocation}return pi})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),I.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ol=0,al=!1}_isOutOfMapMaxBounds(v){const n=this._map.getMaxBounds(),l=v.coords;return n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),n=v.getSouthEast(),l=v.getNorthEast(),d=n.distanceTo(l),f=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ol--,al=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ol++,ol>1?(v={maximumAge:6e5,timeout:0},al=!0):(v=this.options.positionOptions,al=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},p.Hash=oc,p.ImageSource=En,p.KeyboardHandler=Pi,p.LngLatBounds=Pe,p.LogoControl=yh,p.Map=class extends Ff{constructor(v){c.bf.mark(c.bg.create);const n=Object.assign(Object.assign({},$g),v);if(n.minZoom!=null&&n.maxZoom!=null&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(n.minPitch!=null&&n.maxPitch!=null&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(n.minPitch!=null&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(n.maxPitch!=null&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Yo(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),{bearingSnap:n.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new nn,this._controls=[],this._mapId=c.a4(),this._contextLost=l=>{l.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:l}))},this._contextRestored=l=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:l}))},this._onMapScroll=l=>{if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._maxTileCacheZoomLevels=n.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=n.preserveDrawingBuffer===!0,this._antialias=n.antialias===!0,this._trackResize=n.trackResize===!0,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles===!0,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=n.crossSourceCollisions===!0,this._collectResourceTiming=n.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},xh),n.locale),this._clickTolerance=n.clickTolerance,this._overridePixelRatio=n.pixelRatio,this._maxCanvasSize=n.maxCanvasSize,this.transformCameraUpdate=n.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=n.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new re(n.transformRequest),typeof n.container=="string"){if(this._container=document.getElementById(n.container),!this._container)throw new Error(`Container '${n.container}' not found.`)}else{if(!(n.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let l=!1;const d=el(f=>{this._trackResize&&!this._removed&&(this.resize(f),this.redraw())},50);this._resizeObserver=new ResizeObserver(f=>{l?d(f):l=!0}),this._resizeObserver.observe(this._container)}this.handlers=new gh(this,n),this._hash=n.hash&&new oc(typeof n.hash=="string"&&n.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,c.e({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,this._validateStyle=n.validateStyle,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new ta(typeof n.attributionControl=="boolean"?void 0:n.attributionControl)),n.maplibreLogo&&this.addControl(new yh,n.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new c.k(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new c.k(`${l.dataType}dataloading`,l))}),this.on("dataabort",l=>{this.fire(new c.k("sourcedataabort",l))})}_getMapId(){return this._mapId}addControl(v,n){if(n===void 0&&(n=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=v.onAdd(this);this._controls.push(v);const d=this._controlPositions[n];return n.indexOf("bottom")!==-1?d.insertBefore(l,d.firstChild):d.appendChild(l),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(v);return n>-1&&this._controls.splice(n,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,n,l,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,n,l,d)}resize(v){var n;const l=this._containerDimensions(),d=l[0],f=l[1],y=this._getClampedPixelRatio(d,f);if(this._resizeCanvas(d,f,y),this.painter.resize(d,f,y),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const A=this._getClampedPixelRatio(d,f);this._resizeCanvas(d,f,A),this.painter.resize(d,f,A)}this.transform.resize(d,f),(n=this._requestedCameraState)===null||n===void 0||n.resize(d,f);const w=!this._moving;return w&&(this.stop(),this.fire(new c.k("movestart",v)).fire(new c.k("move",v))),this.fire(new c.k("resize",v)),w&&this.fire(new c.k("moveend",v)),this}_getClampedPixelRatio(v,n){const{0:l,1:d}=this._maxCanvasSize,f=this.getPixelRatio(),y=v*f,w=n*f;return Math.min(y>l?l/y:1,w>d?d/w:1)*f}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(Pe.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}project(v){return this.transform.locationPoint(c.N.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(c.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,n,l){if(v==="mouseenter"||v==="mouseover"){let d=!1;return{layers:n,listener:l,delegates:{mousemove:y=>{const w=n.filter(A=>this.getLayer(A)),C=w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[];C.length?d||(d=!0,l.call(this,new Ar(v,this,y.originalEvent,{features:C}))):d=!1},mouseout:()=>{d=!1}}}}if(v==="mouseleave"||v==="mouseout"){let d=!1;return{layers:n,listener:l,delegates:{mousemove:w=>{const C=n.filter(A=>this.getLayer(A));(C.length!==0?this.queryRenderedFeatures(w.point,{layers:C}):[]).length?d=!0:d&&(d=!1,l.call(this,new Ar(v,this,w.originalEvent)))},mouseout:w=>{d&&(d=!1,l.call(this,new Ar(v,this,w.originalEvent)))}}}}{const d=f=>{const y=n.filter(C=>this.getLayer(C)),w=y.length!==0?this.queryRenderedFeatures(f.point,{layers:y}):[];w.length&&(f.features=w,l.call(this,f),delete f.features)};return{layers:n,listener:l,delegates:{[v]:d}}}}_saveDelegatedListener(v,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(n)}_removeDelegatedListener(v,n,l){if(!this._delegatedListeners||!this._delegatedListeners[v])return;const d=this._delegatedListeners[v];for(let f=0;f<d.length;f++){const y=d[f];if(y.listener===l&&y.layers.length===n.length&&y.layers.every(w=>n.includes(w))){for(const w in y.delegates)this.off(w,y.delegates[w]);return void d.splice(f,1)}}}on(v,n,l){if(l===void 0)return super.on(v,n);const d=this._createDelegatedListener(v,typeof n=="string"?[n]:n,l);this._saveDelegatedListener(v,d);for(const f in d.delegates)this.on(f,d.delegates[f]);return this}once(v,n,l){if(l===void 0)return super.once(v,n);const d=typeof n=="string"?[n]:n,f=this._createDelegatedListener(v,d,l);for(const y in f.delegates){const w=f.delegates[y];f.delegates[y]=(...C)=>{this._removeDelegatedListener(v,d,l),w(...C)}}this._saveDelegatedListener(v,f);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(v,n,l){return l===void 0?super.off(v,n):(this._removeDelegatedListener(v,typeof n=="string"?[n]:n,l),this)}queryRenderedFeatures(v,n){if(!this.style)return[];let l;const d=v instanceof c.P||Array.isArray(v),f=d?v:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(d?{}:v)||{},f instanceof c.P||typeof f[0]=="number")l=[c.P.convert(f)];else{const y=c.P.convert(f[0]),w=c.P.convert(f[1]);l=[y,new c.P(w.x,y.y),w,new c.P(y.x,w.y),y]}return this.style.queryRenderedFeatures(l,n,this.transform)}querySourceFeatures(v,n){return this.style.querySourceFeatures(v,n)}setStyle(v,n){return(n=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(v,n))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const n=this._locale[v];if(n==null)throw new Error(`Missing UI string '${v}'`);return n}_updateStyle(v,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,n));const l=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new $l(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,n,l):this.style.loadJSON(v,n,l),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new $l(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,n){if(typeof v=="string"){const l=this._requestManager.transformRequest(v,"Style");c.h(l,new AbortController).then(d=>{this._updateDiff(d.data,n)}).catch(d=>{d&&this.fire(new c.j(d))})}else typeof v=="object"&&this._updateDiff(v,n)}_updateDiff(v,n){try{this.style.setState(v,n)&&this._update(!0)}catch(l){c.w(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(v,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(v,n){return this._lazyInitEmptyStyle(),this.style.addSource(v,n),this._update(!0)}isSourceLoaded(v){const n=this.style&&this.style.sourceCaches[v];if(n!==void 0)return n.loaded();this.fire(new c.j(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const n=this.style.sourceCaches[v.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);this.terrain===null&&n.reload();for(const l in this.style._layers){const d=this.style._layers[l];d.type==="hillshade"&&d.source===v.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new _h(this.painter,n,v),this.painter.renderToTexture=new Nf(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=l=>{l.dataType==="style"?this.terrain.sourceCache.freeRtt():l.dataType==="source"&&l.tile&&(l.sourceId!==v.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(l.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:v})),this}getTerrain(){var v,n;return(n=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const n in v){const l=v[n]._tiles;for(const d in l){const f=l[d];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,n,l={}){const{pixelRatio:d=1,sdf:f=!1,stretchX:y,stretchY:w,content:C,textFitWidth:A,textFitHeight:z}=l;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||c.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:B,height:F,data:q}=n,J=n;return this.style.addImage(v,{data:new c.R({width:B,height:F},new Uint8Array(q)),pixelRatio:d,stretchX:y,stretchY:w,content:C,textFitWidth:A,textFitHeight:z,sdf:f,version:0,userImage:J}),J.onAdd&&J.onAdd(this,v),this}}{const{width:B,height:F,data:q}=k.getImageData(n);this.style.addImage(v,{data:new c.R({width:B,height:F},q),pixelRatio:d,stretchX:y,stretchY:w,content:C,textFitWidth:A,textFitHeight:z,sdf:f,version:0})}}updateImage(v,n){const l=this.style.getImage(v);if(!l)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=n instanceof HTMLImageElement||c.b(n)?k.getImageData(n):n,{width:f,height:y,data:w}=d;if(f===void 0||y===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==l.data.width||y!==l.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(n instanceof HTMLImageElement||c.b(n));return l.data.replace(w,C),this.style.updateImage(v,l),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return W.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,n){return this._lazyInitEmptyStyle(),this.style.addLayer(v,n),this._update(!0)}moveLayer(v,n){return this.style.moveLayer(v,n),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,n,l){return this.style.setLayerZoomRange(v,n,l),this._update(!0)}setFilter(v,n,l={}){return this.style.setFilter(v,n,l),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,n,l,d={}){return this.style.setPaintProperty(v,n,l,d),this._update(!0)}getPaintProperty(v,n){return this.style.getPaintProperty(v,n)}setLayoutProperty(v,n,l,d={}){return this.style.setLayoutProperty(v,n,l,d),this._update(!0)}getLayoutProperty(v,n){return this.style.getLayoutProperty(v,n)}setGlyphs(v,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,n,l={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,n,l,d=>{d||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,n,l=>{l||this._update(!0)}),this}setLight(v,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(v){return this._lazyInitEmptyStyle(),this.style.setSky(v),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,n){return this.style.setFeatureState(v,n),this._update()}removeFeatureState(v,n){return this.style.removeFeatureState(v,n),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,n=0;return this._container&&(v=this._container.clientWidth||400,n=this._container.clientHeight||300),[v,n]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const n=this._canvasContainer=I.create("div","maplibregl-canvas-container",v);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=I.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const l=this._containerDimensions(),d=this._getClampedPixelRatio(l[0],l[1]);this._resizeCanvas(l[0],l[1],d);const f=this._controlContainer=I.create("div","maplibregl-control-container",v),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=I.create("div",`maplibregl-ctrl-${w} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,n,l){this._canvas.width=Math.floor(l*v),this._canvas.height=Math.floor(l*n),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{n={requestedAttributes:v},d&&(n.statusMessage=d.statusMessage,n.type=d.type)},{once:!0});const l=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!l){const d="Failed to initialize WebGL";throw n?(n.message=d,new Error(JSON.stringify(n))):new Error(d)}this.painter=new sc(l,this.transform),G.testSupport(l)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let l=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const f=this.transform.zoom,y=k.now();this.style.zoomHistory.update(f,y);const w=new c.z(f,{now:y,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=w.crossFadingFactor();C===1&&C===this._crossFadingFactor||(l=!0,this._crossFadingFactor=C),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||l)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),I.remove(this._canvasContainer),I.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,k.frameAsync(this._frameRequest).then(v=>{c.bf.frame(v),this._frameRequest=null,this._render(v)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return Of}getCameraTargetElevation(){return this.transform.elevation}},p.MapMouseEvent=Ar,p.MapTouchEvent=po,p.MapWheelEvent=Df,p.Marker=gc,p.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const n=this._map.getZoom(),l=n===this._map.getMaxZoom(),d=n===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._setButtonTitle=(n,l)=>{const d=this._map._getUIString(`NavigationControl.${l}`);n.title=d,n.setAttribute("aria-label",d)},this.options=c.e({},Hg,v),this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),I.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),I.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=I.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gg(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){I.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,n){const l=I.create("button",v,this._container);return l.type="button",l.addEventListener("click",n),l}},p.Popup=class extends c.E{constructor(v){super(),this.remove=()=>(this._content&&I.remove(this._content),this._container&&(I.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{var l;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=I.create("div","maplibregl-popup",this._map.getContainer()),this._tip=I.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const C of this.options.className.split(" "))this._container.classList.add(C);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Pn(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._trackPointer&&!n)return;const d=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationPoint(this._lngLat));let f=this.options.anchor;const y=vc(this.options.offset);if(!f){const C=this._container.offsetWidth,A=this._container.offsetHeight;let z;z=d.y+y.bottom.y<A?["top"]:d.y>this._map.transform.height-A?["bottom"]:[],d.x<C/2?z.push("left"):d.x>this._map.transform.width-C/2&&z.push("right"),f=z.length===0?"bottom":z.join("-")}let w=d.add(y[f]);this.options.subpixelPositioning||(w=w.round()),I.setTransform(this._container,`${ra[f]} translate(${w.x}px,${w.y}px)`),mc(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Lt),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=c.N.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const n=document.createDocumentFragment(),l=document.createElement("body");let d;for(l.innerHTML=v;d=l.firstChild,d;)n.appendChild(d);return this.setDOMContent(n)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=I.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=I.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(yc);v&&v.focus()}},p.RasterDEMTileSource=Jt,p.RasterTileSource=Nt,p.ScaleControl=class{constructor(v){this._onMove=()=>{ll(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,ll(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},cs),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){I.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},p.ScrollZoomHandler=Wi,p.Style=$l,p.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=I.create("button","maplibregl-ctrl-terrain",this._container),I.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){I.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},p.TwoFingersTouchPitchHandler=sl,p.TwoFingersTouchRotateHandler=fh,p.TwoFingersTouchZoomHandler=hh,p.TwoFingersTouchZoomRotateHandler=mh,p.VectorTileSource=dr,p.VideoSource=ci,p.addSourceType=(v,n)=>c._(void 0,void 0,void 0,function*(){if(Ti(v))throw new Error(`A source type called "${v}" already exists.`);((l,d)=>{Xr[l]=d})(v,n)}),p.clearPrewarmedResources=function(){const v=tt;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(We),tt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},p.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},p.getRTLTextPluginStatus=function(){return cr().getRTLTextPluginStatus()},p.getVersion=function(){return wh},p.getWorkerCount=function(){return He.workerCount},p.getWorkerUrl=function(){return c.a.WORKER_URL},p.importScriptInWorkers=function(v){return Ft().broadcast("IS",v)},p.prewarm=function(){Pt().acquire(We)},p.setMaxParallelImageRequests=function(v){c.a.MAX_PARALLEL_IMAGE_REQUESTS=v},p.setRTLTextPlugin=function(v,n){return cr().setRTLTextPlugin(v,n)},p.setWorkerCount=function(v){He.workerCount=v},p.setWorkerUrl=function(v){c.a.WORKER_URL=v}});var g=i;return g})})(uI);var ZO=uI.exports;const Vp=p0(ZO),dI=$.createContext({theme:"system",setTheme:()=>null});function XO({children:e,defaultTheme:t="system",storageKey:i="vite-ui-theme",...a}){const[h,g]=$.useState(()=>localStorage.getItem(i)||t);$.useEffect(()=>{const c=window.document.documentElement;if(c.classList.remove("light","dark"),h==="system"){const S=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";c.classList.add(S);return}c.classList.add(h)},[h]);const p={theme:h,setTheme:c=>{localStorage.setItem(i,c),g(c)}};return Q.jsx(dI.Provider,{...a,value:p,children:e})}const rb=()=>{const e=$.useContext(dI);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},Vc=16,KO=$.forwardRef(({selectedRecord:e,onSelectRecord:t,currentYear:i,disabledCategories:a,is1883Mode:h,isFortWallVisible:g,is3DBuildingsVisible:p,onMapLoad:c},S)=>{const E=$.useRef(null),P=$.useRef(null),k=$.useRef({}),I=$.useRef({click:null,mouseenter:null,mouseleave:null}),G=$.useRef({unclusteredMouseEnter:null,unclusteredMouseLeave:null}),Z=$.useRef(null),[H,te]=$.useState(!1),[L,V]=$.useState(null),[W,re]=$.useState(window.innerWidth<=768),{theme:pe}=rb(),_e=$.useRef({is1883Mode:h,disabledCategories:a,currentYear:i,isFortWallVisible:g,is3DBuildingsVisible:p,theme:pe});$.useEffect(()=>{const Ce=()=>re(window.innerWidth<=768);return window.addEventListener("resize",Ce),()=>window.removeEventListener("resize",Ce)},[]),$.useEffect(()=>{_e.current={is1883Mode:h,disabledCategories:a,currentYear:i,isFortWallVisible:g,is3DBuildingsVisible:p,theme:pe}},[h,a,i,g,p,pe]),$.useImperativeHandle(S,()=>({zoomIn:()=>{var Ce;return(Ce=P.current)==null?void 0:Ce.zoomIn()},zoomOut:()=>{var Ce;return(Ce=P.current)==null?void 0:Ce.zoomOut()},resetNorth:()=>{var Ce;return(Ce=P.current)==null?void 0:Ce.resetNorth()},resetView:()=>{var Ce;(Ce=P.current)==null||Ce.flyTo({center:sr.startCenter,zoom:sr.initialZoom,pitch:45,bearing:-15,duration:1e3})},flyTo:(Ce,Fe)=>{var ze;return(ze=P.current)==null?void 0:ze.flyTo({center:Ce,zoom:Fe||P.current.getZoom(),duration:1e3})},locate:()=>{navigator.geolocation.getCurrentPosition(Ce=>{var Fe;(Fe=P.current)==null||Fe.flyTo({center:[Ce.coords.longitude,Ce.coords.latitude],zoom:17,duration:1e3})})}}));const le=$.useCallback(()=>{var _t,tt,dt;if(!P.current)return;const{is1883Mode:Ce,disabledCategories:Fe,currentYear:ze,isFortWallVisible:Qe,is3DBuildingsVisible:Ze,theme:Je}=_e.current;P.current.getLayer("layer-1883")&&P.current.removeLayer("layer-1883"),P.current.getSource("source-1883")&&P.current.removeSource("source-1883"),P.current.getLayer("3d-buildings")&&P.current.removeLayer("3d-buildings"),P.current.getLayer("fort-wall-layer")&&P.current.removeLayer("fort-wall-layer"),P.current.getSource("fort-wall")&&P.current.removeSource("fort-wall"),P.current.getLayer("clusters")&&P.current.removeLayer("clusters"),P.current.getLayer("unclustered-point")&&P.current.removeLayer("unclustered-point"),P.current.getLayer("cluster-count")&&P.current.removeLayer("cluster-count"),P.current.getSource("heritage-clusters")&&P.current.removeSource("heritage-clusters"),P.current.addSource("source-1883",{type:"image",url:"/kalaghoda/images/fort-1883.jpg",coordinates:[[72.8228,18.9435],[72.8492,18.9435],[72.8492,18.9235],[72.8228,18.9235]]}),P.current.addLayer({id:"layer-1883",type:"raster",source:"source-1883",paint:{"raster-fade-duration":0},layout:{visibility:Ce?"visible":"none"}}),P.current.getSource("openmaptiles")&&P.current.addLayer({id:"3d-buildings",source:"openmaptiles","source-layer":"building",type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":Je==="dark"?"#222":"#f0f0f0","fill-extrusion-height":["get","render_height"],"fill-extrusion-base":["get","render_min_height"],"fill-extrusion-opacity":Je==="dark"?.6:.9},layout:{visibility:Ze&&!Ce?"visible":"none"}});const $e={type:"Feature",geometry:{type:"LineString",coordinates:[[72.8312,18.9278],[72.8318,18.9276],[72.8325,18.9273],[72.8335,18.9268],[72.8342,18.9265]]}};P.current.addSource("fort-wall",{type:"geojson",data:$e}),P.current.addLayer({id:"fort-wall-layer",type:"line",source:"fort-wall",layout:{"line-join":"round","line-cap":"round",visibility:Qe?"visible":"none"},paint:{"line-color":"#c0392b","line-width":4,"line-dasharray":[2,4]}});const ke=Ce?[]:bd.filter(Pt=>{const Ft=ps(Pt).some(Wt=>!Fe.includes(Wt)),at=Mp(Pt.year)<=ze;return Ft&&at}).map(Pt=>{const Ft=ps(Pt)[0];return{type:"Feature",properties:{id:Pt.id,title:Pt.title,category:Ft,color:sr.colors[Ft]||"#333"},geometry:{type:"Point",coordinates:Pt.location.center}}});P.current.addSource("heritage-clusters",{type:"geojson",data:{type:"FeatureCollection",features:ke},cluster:!0,clusterMaxZoom:Vc,clusterRadius:50}),P.current.addLayer({id:"unclustered-point",type:"circle",source:"heritage-clusters",filter:["!",["has","point_count"]],maxzoom:Vc,paint:{"circle-color":["get","color"],"circle-radius":10,"circle-stroke-width":2,"circle-stroke-color":Je==="dark"?"#111":"#fff","circle-opacity":1,"circle-stroke-opacity":1},layout:{visibility:Ce?"none":"visible"}}),P.current.addLayer({id:"clusters",type:"circle",source:"heritage-clusters",filter:["has","point_count"],maxzoom:Vc,paint:{"circle-color":["step",["get","point_count"],"#2980b9",10,"#8e44ad",25,"#c0392b"],"circle-radius":["step",["get","point_count"],18,10,24,25,30],"circle-stroke-width":3,"circle-stroke-color":Je==="dark"?"#111":"#fff","circle-opacity":1,"circle-stroke-opacity":1},layout:{visibility:Ce?"none":"visible"}});const Ue=P.current.getStyle(),et=((dt=(tt=(_t=Ue==null?void 0:Ue.layers)==null?void 0:_t.find(Pt=>{var Ut;return(Ut=Pt.layout)==null?void 0:Ut["text-font"]}))==null?void 0:tt.layout)==null?void 0:dt["text-font"])||["Lato Semi Bold","Noto Sans Semi Bold"];P.current.addLayer({id:"cluster-count",type:"symbol",source:"heritage-clusters",filter:["has","point_count"],maxzoom:Vc,layout:{"text-field":"{point_count_abbreviated}","text-font":et,"text-size":12,visibility:Ce?"none":"visible"},paint:{"text-color":"#ffffff"}}),I.current.click&&P.current.off("click","clusters",I.current.click),I.current.mouseenter&&P.current.off("mouseenter","clusters",I.current.mouseenter),I.current.mouseleave&&P.current.off("mouseleave","clusters",I.current.mouseleave);const pt=async Pt=>{const Ut=P.current.queryRenderedFeatures(Pt.point,{layers:["clusters"]});if(!Ut.length)return;const Ft=Ut[0].properties.cluster_id,at=Ut[0].geometry.coordinates.slice(),Wt=P.current.getSource("heritage-clusters");if(Wt){const mt=await Wt.getClusterExpansionZoom(Ft);P.current.flyTo({center:at,zoom:Math.min(mt+.5,18),duration:500})}},Le=()=>{P.current&&(P.current.getCanvas().style.cursor="pointer")},Ve=()=>{P.current&&(P.current.getCanvas().style.cursor="")};I.current={click:pt,mouseenter:Le,mouseleave:Ve},P.current.on("click","clusters",pt),P.current.on("mouseenter","clusters",Le),P.current.on("mouseleave","clusters",Ve),G.current.unclusteredMouseEnter&&P.current.off("mouseenter","unclustered-point",G.current.unclusteredMouseEnter),G.current.unclusteredMouseLeave&&P.current.off("mouseleave","unclustered-point",G.current.unclusteredMouseLeave);const We=Pt=>{if(!(window.innerWidth<=768)&&(P.current.getCanvas().style.cursor="pointer",Z.current)){Z.current.innerText=Pt.features[0].properties.title,Z.current.style.opacity="1";const Ut=Pt.features[0].geometry.coordinates.slice(),Ft=P.current.project(Ut);Z.current.style.left=`${Ft.x}px`,Z.current.style.top=`${Ft.y}px`}},He=()=>{window.innerWidth<=768||(P.current.getCanvas().style.cursor="",Z.current&&(Z.current.style.opacity="0"))};G.current={unclusteredMouseEnter:We,unclusteredMouseLeave:He},P.current.on("mouseenter","unclustered-point",We),P.current.on("mouseleave","unclustered-point",He),P.current.getLayer("unclustered-point")&&P.current.moveLayer("unclustered-point"),P.current.getLayer("clusters")&&P.current.moveLayer("clusters"),P.current.getLayer("cluster-count")&&P.current.moveLayer("cluster-count")},[]);$.useEffect(()=>{if(P.current)return;const Fe={top:0,bottom:window.innerWidth<768?0:300,left:0,right:0};return P.current=new Vp.Map({container:E.current,style:pe==="dark"?sr.darkStyle:sr.style,center:sr.startCenter,zoom:sr.initialZoom,minZoom:14.5,maxBounds:[[72.81,18.91],[72.85,18.945]],pitch:45,bearing:-15,antialias:!0,attributionControl:!1,padding:Fe}),P.current.addControl(new Vp.AttributionControl({compact:!0}),"bottom-right"),P.current.addControl(new Vp.ScaleControl({maxWidth:100,unit:"metric"}),"bottom-left"),P.current.on("load",()=>{le(),bd.forEach(ze=>{const Qe=ps(ze),Ze=Qe[0],Je=sr.colors[Ze]||"#333",$e=sr.icons[Ze]||"fa-location-dot",ke=Qe.length>1,Ue=document.createElement("div");if(Ue.className="marker"+(ke?" marker-multi":""),Ue.style.backgroundColor=Je,Ue.style.display="none",Ue.innerHTML=`<i class="fa-solid ${$e}"></i>`,ke){const pt=Qe[1],Le=sr.colors[pt]||"#333";Ue.style.setProperty("--ring-color",Le)}Ue.addEventListener("click",()=>t(ze)),window.matchMedia("(hover: hover)").matches&&(Ue.addEventListener("mouseenter",()=>{if(!(window.innerWidth<=768)&&Z.current){Z.current.innerText=ze.title,Z.current.style.opacity="1";const pt=Ue.getBoundingClientRect();Z.current.style.left=`${pt.left+pt.width/2}px`,Z.current.style.top=`${pt.top}px`}}),Ue.addEventListener("mouseleave",()=>{Z.current&&(Z.current.style.opacity="0")}));const et=new Vp.Marker({element:Ue}).setLngLat(ze.location.center).addTo(P.current);k.current[ze.id]={marker:et,element:Ue,record:ze,categories:Qe}}),te(!0),c==null||c()}),()=>{P.current&&(P.current.remove(),P.current=null)}},[t,le]),$.useEffect(()=>{if(!P.current||!H)return;const Fe=P.current.getZoom()>=Vc;h?Object.values(k.current).forEach(({element:Ze})=>{Ze.style.display="none"}):Object.values(k.current).forEach(({element:Ze,categories:Je,record:$e})=>{const ke=Je.some(Le=>!a.includes(Le)),Ue=Mp($e.year)<=i,et=(e==null?void 0:e.id)===$e.id,pt=et&&!W;et?Ze.classList.add("selected"):Ze.classList.remove("selected"),!pt&&(Fe||et)&&ke&&Ue?(Ze.style.display="flex",Ze.style.opacity="1"):Ze.style.display="none"});const ze=h?[]:bd.filter(Ze=>{const $e=ps(Ze).some(Ue=>!a.includes(Ue)),ke=Mp(Ze.year)<=i;return $e&&ke}).map(Ze=>{const $e=ps(Ze)[0];return{type:"Feature",properties:{id:Ze.id,title:Ze.title,category:$e,color:sr.colors[$e]||"#333"},geometry:{type:"Point",coordinates:Ze.location.center}}}),Qe=P.current.getSource("heritage-clusters");Qe&&P.current.isStyleLoaded()&&Qe.setData({type:"FeatureCollection",features:ze}),P.current.getLayer("layer-1883")&&(P.current.setLayoutProperty("layer-1883","visibility",h?"visible":"none"),h&&P.current.moveLayer("layer-1883")),P.current.getLayer("fort-wall-layer")&&P.current.setLayoutProperty("fort-wall-layer","visibility",g?"visible":"none"),P.current.getLayer("3d-buildings")&&P.current.setLayoutProperty("3d-buildings","visibility",p&&!h?"visible":"none"),P.current.getLayer("unclustered-point")&&P.current.setLayoutProperty("unclustered-point","visibility",h?"none":"visible"),P.current.getLayer("clusters")&&P.current.setLayoutProperty("clusters","visibility",h?"none":"visible"),P.current.getLayer("cluster-count")&&P.current.setLayoutProperty("cluster-count","visibility",h?"none":"visible")},[i,a,h,g,p,e,H,pe]);const ce=$.useRef(pe);$.useEffect(()=>{if(!P.current||!H||ce.current===pe)return;ce.current=pe;const Ce=pe==="dark"?sr.darkStyle:sr.style;P.current.setStyle(Ce);const Fe=()=>{P.current.isStyleLoaded()&&(le(),P.current.off("styledata",Fe))};return P.current.on("styledata",Fe),()=>{P.current&&P.current.off("styledata",Fe)}},[pe,H,le]);const De=$.useRef(h);$.useEffect(()=>{!P.current||!H||(h&&!De.current&&P.current.fitBounds([[72.8228,18.9235],[72.8492,18.9435]],{padding:W?40:100,pitch:0,bearing:0}),De.current=h)},[h,H]);const Be=$.useRef(g);return $.useEffect(()=>{!P.current||!H||(g&&!Be.current&&P.current.fitBounds([[72.8312,18.9265],[72.8342,18.9278]],{padding:W?60:150,pitch:45,bearing:-15,duration:2e3}),Be.current=g)},[g,H]),$.useEffect(()=>{!P.current||!H||h||P.current.easeTo({pitch:p?45:0,duration:1e3})},[p,h,H]),$.useEffect(()=>{if(!P.current||!H)return;const Ce=()=>{if(h)return;const Fe=P.current.getZoom()>=Vc;Object.values(k.current).forEach(({element:ze,categories:Qe,record:Ze})=>{const Je=(e==null?void 0:e.id)===Ze.id,ke=!(Je&&!W)&&(Fe||Je)&&Qe.some(Ue=>!a.includes(Ue))&&Mp(Ze.year)<=i;ze.style.display=ke?"flex":"none",Je?ze.classList.add("selected"):ze.classList.remove("selected")})};return P.current.on("zoom",Ce),()=>{P.current&&P.current.off("zoom",Ce)}},[H,a,i,e,h]),$.useEffect(()=>{if(!P.current||!e||W||!H){V(null);return}const Ce=()=>{if(!P.current||!e)return;const Fe=P.current.project(e.location.center);V({x:Fe.x,y:Fe.y})};return Ce(),P.current.on("move",Ce),P.current.on("zoom",Ce),P.current.on("rotate",Ce),P.current.on("pitch",Ce),()=>{P.current&&(P.current.off("move",Ce),P.current.off("zoom",Ce),P.current.off("rotate",Ce),P.current.off("pitch",Ce))}},[e,W,H]),Q.jsxs(Q.Fragment,{children:[Q.jsxs("div",{className:"map-wrapper",style:{width:"100%",height:"100vh",position:"fixed",top:0,left:0,zIndex:1},children:[Q.jsx("div",{ref:E,id:"map",style:{width:"100%",height:"100%"}}),Q.jsx("div",{id:"tooltip",ref:Z})]}),L&&e&&!W&&Q.jsx("div",{className:"floating-focused-marker",style:{left:L.x,top:L.y,backgroundColor:sr.colors[ps(e)[0]]||"#333",position:"fixed",zIndex:2e3},children:Q.jsx("i",{className:`fa-solid ${sr.icons[ps(e)[0]]||"fa-location-dot"}`})})]})});var $S=1,YO=.9,JO=.8,QO=.17,Bv=.1,Fv=.999,ej=.9999,tj=.99,nj=/[\\\/_+.#"@\[\(\{&]/,rj=/[\\\/_+.#"@\[\(\{&]/g,ij=/[\s-]/,fI=/[\s-]/g;function o0(e,t,i,a,h,g,p){if(g===t.length)return h===e.length?$S:tj;var c=`${h},${g}`;if(p[c]!==void 0)return p[c];for(var S=a.charAt(g),E=i.indexOf(S,h),P=0,k,I,G,Z;E>=0;)k=o0(e,t,i,a,E+1,g+1,p),k>P&&(E===h?k*=$S:nj.test(e.charAt(E-1))?(k*=JO,G=e.slice(h,E-1).match(rj),G&&h>0&&(k*=Math.pow(Fv,G.length))):ij.test(e.charAt(E-1))?(k*=YO,Z=e.slice(h,E-1).match(fI),Z&&h>0&&(k*=Math.pow(Fv,Z.length))):(k*=QO,h>0&&(k*=Math.pow(Fv,E-h))),e.charAt(E)!==t.charAt(g)&&(k*=ej)),(k<Bv&&i.charAt(E-1)===a.charAt(g+1)||a.charAt(g+1)===a.charAt(g)&&i.charAt(E-1)!==a.charAt(g))&&(I=o0(e,t,i,a,E+1,g+2,p),I*Bv>k&&(k=I*Bv)),k>P&&(P=k),E=i.indexOf(S,E+1);return p[c]=P,P}function HS(e){return e.toLowerCase().replace(fI," ")}function sj(e,t,i){return e=i&&i.length>0?`${e+" "+i.join(" ")}`:e,o0(e,t,HS(e),HS(t),0,0,{})}var ed='[cmdk-group=""]',Nv='[cmdk-group-items=""]',oj='[cmdk-group-heading=""]',pI='[cmdk-item=""]',GS=`${pI}:not([aria-disabled="true"])`,a0="cmdk-item-select",Uc="data-value",aj=(e,t,i)=>sj(e,t,i),mI=$.createContext(void 0),af=()=>$.useContext(mI),gI=$.createContext(void 0),ib=()=>$.useContext(gI),yI=$.createContext(void 0),vI=$.forwardRef((e,t)=>{let i=$c(()=>{var Le,Ve;return{search:"",value:(Ve=(Le=e.value)!=null?Le:e.defaultValue)!=null?Ve:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),a=$c(()=>new Set),h=$c(()=>new Map),g=$c(()=>new Map),p=$c(()=>new Set),c=_I(e),{label:S,children:E,value:P,onValueChange:k,filter:I,shouldFilter:G,loop:Z,disablePointerSelection:H=!1,vimBindings:te=!0,...L}=e,V=Io(),W=Io(),re=Io(),pe=$.useRef(null),_e=vj();Ol(()=>{if(P!==void 0){let Le=P.trim();i.current.value=Le,le.emit()}},[P]),Ol(()=>{_e(6,ze)},[]);let le=$.useMemo(()=>({subscribe:Le=>(p.current.add(Le),()=>p.current.delete(Le)),snapshot:()=>i.current,setState:(Le,Ve,We)=>{var He,_t,tt,dt;if(!Object.is(i.current[Le],Ve)){if(i.current[Le]=Ve,Le==="search")Fe(),Be(),_e(1,Ce);else if(Le==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Pt=document.getElementById(re);Pt?Pt.focus():(He=document.getElementById(V))==null||He.focus()}if(_e(7,()=>{var Pt;i.current.selectedItemId=(Pt=Qe())==null?void 0:Pt.id,le.emit()}),We||_e(5,ze),((_t=c.current)==null?void 0:_t.value)!==void 0){let Pt=Ve??"";(dt=(tt=c.current).onValueChange)==null||dt.call(tt,Pt);return}}le.emit()}},emit:()=>{p.current.forEach(Le=>Le())}}),[]),ce=$.useMemo(()=>({value:(Le,Ve,We)=>{var He;Ve!==((He=g.current.get(Le))==null?void 0:He.value)&&(g.current.set(Le,{value:Ve,keywords:We}),i.current.filtered.items.set(Le,De(Ve,We)),_e(2,()=>{Be(),le.emit()}))},item:(Le,Ve)=>(a.current.add(Le),Ve&&(h.current.has(Ve)?h.current.get(Ve).add(Le):h.current.set(Ve,new Set([Le]))),_e(3,()=>{Fe(),Be(),i.current.value||Ce(),le.emit()}),()=>{g.current.delete(Le),a.current.delete(Le),i.current.filtered.items.delete(Le);let We=Qe();_e(4,()=>{Fe(),(We==null?void 0:We.getAttribute("id"))===Le&&Ce(),le.emit()})}),group:Le=>(h.current.has(Le)||h.current.set(Le,new Set),()=>{g.current.delete(Le),h.current.delete(Le)}),filter:()=>c.current.shouldFilter,label:S||e["aria-label"],getDisablePointerSelection:()=>c.current.disablePointerSelection,listId:V,inputId:re,labelId:W,listInnerRef:pe}),[]);function De(Le,Ve){var We,He;let _t=(He=(We=c.current)==null?void 0:We.filter)!=null?He:aj;return Le?_t(Le,i.current.search,Ve):0}function Be(){if(!i.current.search||c.current.shouldFilter===!1)return;let Le=i.current.filtered.items,Ve=[];i.current.filtered.groups.forEach(He=>{let _t=h.current.get(He),tt=0;_t.forEach(dt=>{let Pt=Le.get(dt);tt=Math.max(Pt,tt)}),Ve.push([He,tt])});let We=pe.current;Ze().sort((He,_t)=>{var tt,dt;let Pt=He.getAttribute("id"),Ut=_t.getAttribute("id");return((tt=Le.get(Ut))!=null?tt:0)-((dt=Le.get(Pt))!=null?dt:0)}).forEach(He=>{let _t=He.closest(Nv);_t?_t.appendChild(He.parentElement===_t?He:He.closest(`${Nv} > *`)):We.appendChild(He.parentElement===We?He:He.closest(`${Nv} > *`))}),Ve.sort((He,_t)=>_t[1]-He[1]).forEach(He=>{var _t;let tt=(_t=pe.current)==null?void 0:_t.querySelector(`${ed}[${Uc}="${encodeURIComponent(He[0])}"]`);tt==null||tt.parentElement.appendChild(tt)})}function Ce(){let Le=Ze().find(We=>We.getAttribute("aria-disabled")!=="true"),Ve=Le==null?void 0:Le.getAttribute(Uc);le.setState("value",Ve||void 0)}function Fe(){var Le,Ve,We,He;if(!i.current.search||c.current.shouldFilter===!1){i.current.filtered.count=a.current.size;return}i.current.filtered.groups=new Set;let _t=0;for(let tt of a.current){let dt=(Ve=(Le=g.current.get(tt))==null?void 0:Le.value)!=null?Ve:"",Pt=(He=(We=g.current.get(tt))==null?void 0:We.keywords)!=null?He:[],Ut=De(dt,Pt);i.current.filtered.items.set(tt,Ut),Ut>0&&_t++}for(let[tt,dt]of h.current)for(let Pt of dt)if(i.current.filtered.items.get(Pt)>0){i.current.filtered.groups.add(tt);break}i.current.filtered.count=_t}function ze(){var Le,Ve,We;let He=Qe();He&&(((Le=He.parentElement)==null?void 0:Le.firstChild)===He&&((We=(Ve=He.closest(ed))==null?void 0:Ve.querySelector(oj))==null||We.scrollIntoView({block:"nearest"})),He.scrollIntoView({block:"nearest"}))}function Qe(){var Le;return(Le=pe.current)==null?void 0:Le.querySelector(`${pI}[aria-selected="true"]`)}function Ze(){var Le;return Array.from(((Le=pe.current)==null?void 0:Le.querySelectorAll(GS))||[])}function Je(Le){let Ve=Ze()[Le];Ve&&le.setState("value",Ve.getAttribute(Uc))}function $e(Le){var Ve;let We=Qe(),He=Ze(),_t=He.findIndex(dt=>dt===We),tt=He[_t+Le];(Ve=c.current)!=null&&Ve.loop&&(tt=_t+Le<0?He[He.length-1]:_t+Le===He.length?He[0]:He[_t+Le]),tt&&le.setState("value",tt.getAttribute(Uc))}function ke(Le){let Ve=Qe(),We=Ve==null?void 0:Ve.closest(ed),He;for(;We&&!He;)We=Le>0?gj(We,ed):yj(We,ed),He=We==null?void 0:We.querySelector(GS);He?le.setState("value",He.getAttribute(Uc)):$e(Le)}let Ue=()=>Je(Ze().length-1),et=Le=>{Le.preventDefault(),Le.metaKey?Ue():Le.altKey?ke(1):$e(1)},pt=Le=>{Le.preventDefault(),Le.metaKey?Je(0):Le.altKey?ke(-1):$e(-1)};return $.createElement(lr.div,{ref:t,tabIndex:-1,...L,"cmdk-root":"",onKeyDown:Le=>{var Ve;(Ve=L.onKeyDown)==null||Ve.call(L,Le);let We=Le.nativeEvent.isComposing||Le.keyCode===229;if(!(Le.defaultPrevented||We))switch(Le.key){case"n":case"j":{te&&Le.ctrlKey&&et(Le);break}case"ArrowDown":{et(Le);break}case"p":case"k":{te&&Le.ctrlKey&&pt(Le);break}case"ArrowUp":{pt(Le);break}case"Home":{Le.preventDefault(),Je(0);break}case"End":{Le.preventDefault(),Ue();break}case"Enter":{Le.preventDefault();let He=Qe();if(He){let _t=new Event(a0);He.dispatchEvent(_t)}}}}},$.createElement("label",{"cmdk-label":"",htmlFor:ce.inputId,id:ce.labelId,style:xj},S),vg(e,Le=>$.createElement(gI.Provider,{value:le},$.createElement(mI.Provider,{value:ce},Le))))}),lj=$.forwardRef((e,t)=>{var i,a;let h=Io(),g=$.useRef(null),p=$.useContext(yI),c=af(),S=_I(e),E=(a=(i=S.current)==null?void 0:i.forceMount)!=null?a:p==null?void 0:p.forceMount;Ol(()=>{if(!E)return c.item(h,p==null?void 0:p.id)},[E]);let P=xI(h,g,[e.value,e.children,g],e.keywords),k=ib(),I=Oa(_e=>_e.value&&_e.value===P.current),G=Oa(_e=>E||c.filter()===!1?!0:_e.search?_e.filtered.items.get(h)>0:!0);$.useEffect(()=>{let _e=g.current;if(!(!_e||e.disabled))return _e.addEventListener(a0,Z),()=>_e.removeEventListener(a0,Z)},[G,e.onSelect,e.disabled]);function Z(){var _e,le;H(),(le=(_e=S.current).onSelect)==null||le.call(_e,P.current)}function H(){k.setState("value",P.current,!0)}if(!G)return null;let{disabled:te,value:L,onSelect:V,forceMount:W,keywords:re,...pe}=e;return $.createElement(lr.div,{ref:Bl(g,t),...pe,id:h,"cmdk-item":"",role:"option","aria-disabled":!!te,"aria-selected":!!I,"data-disabled":!!te,"data-selected":!!I,onPointerMove:te||c.getDisablePointerSelection()?void 0:H,onClick:te?void 0:Z},e.children)}),cj=$.forwardRef((e,t)=>{let{heading:i,children:a,forceMount:h,...g}=e,p=Io(),c=$.useRef(null),S=$.useRef(null),E=Io(),P=af(),k=Oa(G=>h||P.filter()===!1?!0:G.search?G.filtered.groups.has(p):!0);Ol(()=>P.group(p),[]),xI(p,c,[e.value,e.heading,S]);let I=$.useMemo(()=>({id:p,forceMount:h}),[h]);return $.createElement(lr.div,{ref:Bl(c,t),...g,"cmdk-group":"",role:"presentation",hidden:k?void 0:!0},i&&$.createElement("div",{ref:S,"cmdk-group-heading":"","aria-hidden":!0,id:E},i),vg(e,G=>$.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":i?E:void 0},$.createElement(yI.Provider,{value:I},G))))}),uj=$.forwardRef((e,t)=>{let{alwaysRender:i,...a}=e,h=$.useRef(null),g=Oa(p=>!p.search);return!i&&!g?null:$.createElement(lr.div,{ref:Bl(h,t),...a,"cmdk-separator":"",role:"separator"})}),hj=$.forwardRef((e,t)=>{let{onValueChange:i,...a}=e,h=e.value!=null,g=ib(),p=Oa(E=>E.search),c=Oa(E=>E.selectedItemId),S=af();return $.useEffect(()=>{e.value!=null&&g.setState("search",e.value)},[e.value]),$.createElement(lr.input,{ref:t,...a,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":S.listId,"aria-labelledby":S.labelId,"aria-activedescendant":c,id:S.inputId,type:"text",value:h?e.value:p,onChange:E=>{h||g.setState("search",E.target.value),i==null||i(E.target.value)}})}),dj=$.forwardRef((e,t)=>{let{children:i,label:a="Suggestions",...h}=e,g=$.useRef(null),p=$.useRef(null),c=Oa(E=>E.selectedItemId),S=af();return $.useEffect(()=>{if(p.current&&g.current){let E=p.current,P=g.current,k,I=new ResizeObserver(()=>{k=requestAnimationFrame(()=>{let G=E.offsetHeight;P.style.setProperty("--cmdk-list-height",G.toFixed(1)+"px")})});return I.observe(E),()=>{cancelAnimationFrame(k),I.unobserve(E)}}},[]),$.createElement(lr.div,{ref:Bl(g,t),...h,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":c,"aria-label":a,id:S.listId},vg(e,E=>$.createElement("div",{ref:Bl(p,S.listInnerRef),"cmdk-list-sizer":""},E)))}),fj=$.forwardRef((e,t)=>{let{open:i,onOpenChange:a,overlayClassName:h,contentClassName:g,container:p,...c}=e;return $.createElement(NP,{open:i,onOpenChange:a},$.createElement(Zx,{container:p},$.createElement(fg,{"cmdk-overlay":"",className:h}),$.createElement(pg,{"aria-label":e.label,"cmdk-dialog":"",className:g},$.createElement(vI,{ref:t,...c}))))}),pj=$.forwardRef((e,t)=>Oa(i=>i.filtered.count===0)?$.createElement(lr.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),mj=$.forwardRef((e,t)=>{let{progress:i,children:a,label:h="Loading...",...g}=e;return $.createElement(lr.div,{ref:t,...g,"cmdk-loading":"",role:"progressbar","aria-valuenow":i,"aria-valuemin":0,"aria-valuemax":100,"aria-label":h},vg(e,p=>$.createElement("div",{"aria-hidden":!0},p)))}),Vi=Object.assign(vI,{List:dj,Item:lj,Input:hj,Group:cj,Separator:uj,Dialog:fj,Empty:pj,Loading:mj});function gj(e,t){let i=e.nextElementSibling;for(;i;){if(i.matches(t))return i;i=i.nextElementSibling}}function yj(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return i;i=i.previousElementSibling}}function _I(e){let t=$.useRef(e);return Ol(()=>{t.current=e}),t}var Ol=typeof window>"u"?$.useEffect:$.useLayoutEffect;function $c(e){let t=$.useRef();return t.current===void 0&&(t.current=e()),t}function Oa(e){let t=ib(),i=()=>e(t.snapshot());return $.useSyncExternalStore(t.subscribe,i,i)}function xI(e,t,i,a=[]){let h=$.useRef(),g=af();return Ol(()=>{var p;let c=(()=>{var E;for(let P of i){if(typeof P=="string")return P.trim();if(typeof P=="object"&&"current"in P)return P.current?(E=P.current.textContent)==null?void 0:E.trim():h.current}})(),S=a.map(E=>E.trim());g.value(e,c,S),(p=t.current)==null||p.setAttribute(Uc,c),h.current=c}),h}var vj=()=>{let[e,t]=$.useState(),i=$c(()=>new Map);return Ol(()=>{i.current.forEach(a=>a()),i.current=new Map},[e]),(a,h)=>{i.current.set(a,h),t({})}};function _j(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function vg({asChild:e,children:t},i){return e&&$.isValidElement(t)?$.cloneElement(_j(t),{ref:t.ref},i(t.props.children)):i(t)}var xj={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const bj=Zx,bI=$.forwardRef(({className:e,...t},i)=>Q.jsx(fg,{ref:i,className:Yt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));bI.displayName=fg.displayName;const wj=$.forwardRef(({className:e,children:t,...i},a)=>Q.jsxs(bj,{children:[Q.jsx(bI,{}),Q.jsxs(pg,{ref:a,className:Yt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...i,children:[t,Q.jsxs(cN,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[Q.jsx(gg,{className:"h-4 w-4"}),Q.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));wj.displayName=pg.displayName;const Sj=$.forwardRef(({className:e,...t},i)=>Q.jsx(Xx,{ref:i,className:Yt("text-lg font-semibold leading-none tracking-tight",e),...t}));Sj.displayName=Xx.displayName;const kj=$.forwardRef(({className:e,...t},i)=>Q.jsx(Kx,{ref:i,className:Yt("text-sm text-muted-foreground",e),...t}));kj.displayName=Kx.displayName;const wI=$.forwardRef(({className:e,...t},i)=>Q.jsx(Vi,{ref:i,className:Yt("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));wI.displayName=Vi.displayName;const l0=$.forwardRef(({className:e,...t},i)=>Q.jsxs("div",{className:"flex items-center px-3","cmdk-input-wrapper":"",children:[Q.jsx(sI,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),Q.jsx(Vi.Input,{ref:i,className:Yt("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));l0.displayName=Vi.Input.displayName;const SI=$.forwardRef(({className:e,...t},i)=>Q.jsx(Vi.List,{ref:i,className:Yt("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));SI.displayName=Vi.List.displayName;const kI=$.forwardRef((e,t)=>Q.jsx(Vi.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));kI.displayName=Vi.Empty.displayName;const TI=$.forwardRef(({className:e,...t},i)=>Q.jsx(Vi.Group,{ref:i,className:Yt("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));TI.displayName=Vi.Group.displayName;const Tj=$.forwardRef(({className:e,...t},i)=>Q.jsx(Vi.Separator,{ref:i,className:Yt("-mx-1 h-px bg-border",e),...t}));Tj.displayName=Vi.Separator.displayName;const CI=$.forwardRef(({className:e,...t},i)=>Q.jsx(Vi.Item,{ref:i,className:Yt("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));CI.displayName=Vi.Item.displayName;const Cj=({disabledCategories:e,onToggle:t,onSolo:i,onReset:a,isFortWallVisible:h,onToggleFortWall:g})=>{const p=$.useRef(null),c=Object.keys(sr.colors),[S,E]=$.useState(!1);$.useEffect(()=>{const k=p.current;if(!k)return;const I=()=>{const G=k.scrollLeft+k.clientWidth>=k.scrollWidth-10;k.parentElement.classList.toggle("scrolled-end",G)};return k.addEventListener("scroll",I),()=>k.removeEventListener("scroll",I)},[]),$.useEffect(()=>{if(h){const k=document.getElementById("wall-info");k&&setTimeout(()=>{k.scrollIntoView({behavior:"smooth",block:"nearest"})},100)}},[h]);const P=k=>{const I=e.includes(k),G=sr.colors[k],Z=sr.icons[k];return!e.includes(k)&&c.every(H=>H===k||e.includes(H)),Q.jsxs(sm,{variant:"outline",className:Yt("rounded-full px-3.5 py-2 text-xs font-bold uppercase tracking-wide cursor-pointer transition-all duration-200 select-none flex items-center gap-1.5 shrink-0 border",I?"opacity-70 bg-muted text-muted-foreground border-border":"text-white shadow-sm"),onClick:()=>t(k),onContextMenu:H=>{H.preventDefault(),i(k)},style:{backgroundColor:I?void 0:G,borderColor:I?void 0:G},children:[Q.jsx("i",{className:Yt(`fa-solid ${Z}`,I?"text-neutral-500":"text-white")}),k]},k)};return Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{className:"chip-filter-wrapper",children:Q.jsxs("div",{id:"chip-filter-bar",ref:p,className:"flex gap-2 overflow-x-auto px-5 py-2 items-center no-scrollbar",children:[Q.jsx(sm,{variant:"secondary",className:"rounded-full px-3.5 py-2 text-xs font-bold uppercase tracking-wide cursor-pointer shrink-0 bg-neutral-800 text-white hover:bg-neutral-700",onClick:a,children:"All"}),c.map(P),Q.jsxs(sm,{variant:"outline",className:Yt("rounded-full px-3.5 py-2 text-xs font-bold uppercase tracking-wide cursor-pointer shrink-0 gap-1.5 flex items-center transition-colors shadow-sm",h?"bg-[#c0392b] text-white border-[#c0392b]":"bg-background text-[#c0392b] border-[#c0392b]","mr-5"),onClick:g,children:[Q.jsx("i",{className:"fa-solid fa-archway"})," Toggle 1860 Fort Wall"]})]})}),Q.jsxs("div",{id:"console",children:[Q.jsxs("div",{id:"layers-header",onClick:()=>E(!S),className:"cursor-pointer",children:[Q.jsxs("span",{children:[Q.jsx("i",{className:"fa-solid fa-layer-group"})," Filter Layers"]}),Q.jsx("i",{id:"layers-arrow",className:`fa-solid fa-chevron-down ${S?"rotated":""}`})]}),Q.jsx(wu,{children:S&&Q.jsx(rs.div,{id:"layers-content-panel",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",stiffness:350,damping:30},style:{overflow:"hidden"},className:"flex flex-col gap-2",children:Q.jsxs("div",{className:"flex flex-col gap-2",children:[Q.jsx(Rs,{variant:"default",className:"w-full text-xs font-bold uppercase tracking-widest bg-primary text-primary-foreground hover:bg-primary/90 h-8 shadow-sm shrink-0",onClick:a,children:"RESET ALL LAYERS"}),Q.jsxs("div",{className:"max-h-[50vh] overflow-y-auto custom-scrollbar flex flex-col gap-2 p-1",children:[c.map(k=>{const I=e.includes(k),G=!e.includes(k)&&c.every(te=>te===k||e.includes(te)),Z=sr.colors[k],H=sr.icons[k];return Q.jsxs("div",{className:"flex items-center gap-2 shrink-0 h-8",children:[Q.jsxs("div",{className:Yt("flex-1 flex items-center justify-start h-full px-3 rounded-md cursor-pointer transition-all shadow-sm",I?"bg-muted text-muted-foreground":"text-white hover:opacity-90"),style:{backgroundColor:I?void 0:Z},onClick:()=>t(k),children:[Q.jsx("i",{className:Yt(`fa-solid ${H} text-sm w-4 text-center mr-2.5`,I?"text-neutral-400":"text-white")}),Q.jsx("span",{className:"text-[11px] font-extrabold uppercase tracking-wide",children:k})]}),Q.jsxs("div",{className:"flex items-center gap-1",children:[Q.jsx(Rs,{variant:G?"default":"outline",size:"sm",className:Yt("h-8 w-12 px-0 text-[10px] font-black",G?"bg-sky-600 hover:bg-sky-700 text-white border-sky-600":"text-muted-foreground hover:text-foreground border-border dark:text-gray-300 dark:hover:text-white dark:bg-transparent dark:hover:bg-neutral-800"),onClick:te=>{te.stopPropagation(),i(k)},title:"Show Only This Layer",children:"ONLY"}),Q.jsx(Rs,{variant:"outline",size:"sm",className:Yt("h-7 w-12 px-0 text-[10px] font-black",I?"bg-neutral-500 text-white border-neutral-500 hover:bg-neutral-600 dark:bg-primary dark:text-primary-foreground dark:border-primary dark:hover:bg-primary/90":"text-muted-foreground hover:text-foreground border-border dark:text-gray-300 dark:hover:text-white dark:bg-transparent dark:hover:bg-neutral-800"),onClick:()=>t(k),title:"Toggle Visibility",children:I?"SHOW":"HIDE"})]})]},k)}),Q.jsx("div",{className:"h-px bg-border my-2 w-full shrink-0"}),Q.jsxs(Rs,{variant:"outline",className:Yt("w-full h-8 flex items-center justify-start gap-2.5 px-3 mb-4 border transition-all shrink-0",h?"bg-red-950/20 text-red-700 border-red-200 dark:border-red-900 hover:bg-red-950/30":"bg-background text-red-700 border-border hover:bg-muted"),onClick:g,children:[Q.jsx("i",{className:"fa-solid fa-archway text-red-700"}),Q.jsx("span",{className:"text-[11px] font-extrabold uppercase tracking-wide text-red-700",children:"1860 Fort Wall"})]})]})]})})})]})]})},Ej=({onSelectRecord:e,disabledCategories:t,onToggle:i,onSolo:a,onReset:h,isFortWallVisible:g,onToggleFortWall:p})=>{const[c,S]=$.useState(""),[E,P]=$.useState([]),[k,I]=$.useState(!1),G=L=>{const V=L.target.value;if(S(V),V.length<1){P([]);return}const W=V.toLowerCase(),re=bd.filter(pe=>{const _e=pe.title.toLowerCase().includes(W),le=pe.description.toLowerCase().includes(W),De=ps(pe).some(Be=>Be.toLowerCase().includes(W));return _e||le||De}).sort((pe,_e)=>{const le=pe.title.toLowerCase().startsWith(W),ce=_e.title.toLowerCase().startsWith(W);if(le&&!ce)return-1;if(!le&&ce)return 1;const De=pe.title.toLowerCase().includes(W),Be=_e.title.toLowerCase().includes(W);if(De&&!Be)return-1;if(!De&&Be)return 1;const Ce=ps(pe),Fe=ps(_e),ze=Ce.some(Ze=>Ze.toLowerCase().includes(W)),Qe=Fe.some(Ze=>Ze.toLowerCase().includes(W));return ze&&!Qe?-1:!ze&&Qe?1:0}).slice(0,10);P(re)},Z=L=>{e(L),S(""),P([]),I(!1)},te={hidden:{opacity:0,y:-8},visible:{opacity:1,y:0,transition:{...{type:"spring",stiffness:350,damping:30,mass:.8},staggerChildren:.04,delayChildren:.05}},exit:{opacity:0,y:-8,transition:{duration:.2,ease:[.4,0,.2,1]}}};return Q.jsxs("header",{id:"header",className:"fade-on-move",children:[Q.jsxs("div",{className:"flex items-start justify-between px-5 pt-5",children:[Q.jsx("div",{className:"flex-1",children:Q.jsxs("h1",{className:"p-0 m-0",children:[Q.jsx("span",{className:"title-sub block",children:"Visual Audit"}),Q.jsx("span",{className:"title-main block",children:"Kala Ghoda"})]})}),Q.jsx("div",{className:"flex items-start",children:Q.jsx("a",{href:"about.html",className:Yt(oP({variant:"ghost",size:"icon"}),"info-icon-btn rounded-full -mr-2"),title:"About This Project",children:Q.jsx("i",{className:"fa-solid fa-circle-info text-2xl"})})})]}),Q.jsxs("div",{id:"mobile-title",children:[Q.jsx("span",{className:"m-sub",children:"Visual Audit"}),Q.jsx("span",{className:"m-main",children:"Kala Ghoda"})]}),Q.jsx("div",{id:"search-container",className:Yt("fade-on-move",k&&"expanded"),children:Q.jsxs(wI,{className:"bg-transparent overflow-visible",shouldFilter:!1,children:[Q.jsx("div",{className:"hidden md:block",children:Q.jsx("div",{className:"rounded-full border border-border/60 bg-muted/40 hover:bg-muted/60 transition-colors px-1",children:Q.jsx(l0,{placeholder:"Search buildings, styles...",value:c,onValueChange:L=>G({target:{value:L}}),onFocus:()=>I(!0),onBlur:()=>setTimeout(()=>I(!1),200),className:"h-10 border-none focus-visible:ring-0 placeholder:text-neutral-500"})})}),Q.jsxs("div",{className:"mobile-header-pills flex md:hidden items-center gap-2 w-full px-5",children:[Q.jsx(wu,{mode:"popLayout",children:!k&&Q.jsxs(rs.a,{href:"about.html",className:"h-[50px] flex items-center gap-3 bg-background border border-border/80 shadow-lg px-4 shrink-0 rounded-[24px]",initial:{width:0,opacity:0,paddingLeft:0,paddingRight:0,borderWidth:0},animate:{width:"auto",opacity:1,paddingLeft:16,paddingRight:16,borderWidth:"1px"},exit:{width:0,opacity:0,paddingLeft:0,paddingRight:0,borderWidth:0},transition:{type:"spring",stiffness:400,damping:30},style:{overflow:"hidden"},children:[Q.jsxs("div",{className:"flex flex-col justify-center gap-[1px]",children:[Q.jsx("span",{className:"font-['Lato'] text-[9px] font-extrabold text-[#666] uppercase tracking-[2px] leading-none",children:"Visual Audit"}),Q.jsx("span",{className:"font-['Labrada'] text-[19px] font-bold text-[#bfa05a] leading-none",children:"Kala Ghoda"})]}),Q.jsx("div",{className:"w-[28px] h-[28px] bg-muted/50 rounded-full flex items-center justify-center text-muted-foreground text-[14px] shrink-0",children:Q.jsx("i",{className:"fa-solid fa-circle-info"})})]})}),Q.jsx(rs.div,{layout:!0,className:"flex-1 rounded-[24px] border border-border/80 bg-background shadow-lg h-[50px] flex items-center overflow-hidden",transition:{type:"spring",stiffness:400,damping:30},children:Q.jsx(l0,{placeholder:"Search...",value:c,onValueChange:L=>G({target:{value:L}}),onFocus:()=>I(!0),onBlur:()=>setTimeout(()=>I(!1),200),className:"border-none shadow-none focus-visible:ring-0 focus-visible:ring-offset-0 h-full text-[16px] bg-transparent placeholder:text-neutral-400 flex-1 min-w-0"})})]}),Q.jsx(wu,{children:k&&c.length>0&&Q.jsx(rs.div,{variants:te,initial:"hidden",animate:"visible",exit:"exit",className:"absolute top-[calc(100%+16px)] left-0 right-0 z-[1000] px-5",children:Q.jsx("div",{className:"rounded-2xl border border-border/80 bg-white dark:bg-background text-popover-foreground shadow-2xl outline-none overflow-hidden",children:Q.jsx(SI,{className:"max-h-[60vh] overflow-y-auto p-0",children:E.length===0?Q.jsxs(kI,{className:"py-10 text-center text-sm opacity-50 flex flex-col items-center gap-3",children:[Q.jsx(sI,{className:"h-5 w-5 opacity-20"}),Q.jsxs("span",{children:['No buildings found for "',c,'"']})]}):Q.jsx(TI,{className:"p-2",children:E.map(L=>Q.jsxs(CI,{onSelect:()=>Z(L),className:"search-result-item flex flex-col items-start py-4 px-5 rounded-xl cursor-pointer transition-colors m-1 data-[selected='true']:bg-accent dark:data-[selected='true']:bg-black/20",children:[Q.jsx("div",{className:"result-title font-bold text-[15px]",children:L.title}),Q.jsxs("div",{className:"result-meta text-[11px] uppercase tracking-widest opacity-60 font-medium mt-1",children:[L.year,"  ",ps(L).join("  ")]})]},L.id))})})})})})]})}),Q.jsx(Cj,{disabledCategories:t,onToggle:i,onSolo:a,onReset:h,isFortWallVisible:g,onToggleFortWall:p})]})};function EI(e,[t,i]){return Math.min(i,Math.max(t,e))}var Pj=$.createContext(void 0);function Ij(e){const t=$.useContext(Pj);return e||t||"ltr"}function Aj(e){const t=$.useRef({value:e,previous:e});return $.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}function Mj(e){const[t,i]=$.useState(void 0);return ku(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});const a=new ResizeObserver(h=>{if(!Array.isArray(h)||!h.length)return;const g=h[0];let p,c;if("borderBoxSize"in g){const S=g.borderBoxSize,E=Array.isArray(S)?S[0]:S;p=E.inlineSize,c=E.blockSize}else p=e.offsetWidth,c=e.offsetHeight;i({width:p,height:c})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}else i(void 0)},[e]),t}function Dj(e){const t=e+"CollectionProvider",[i,a]=Hx(t),[h,g]=i(t,{collectionRef:{current:null},itemMap:new Map}),p=H=>{const{scope:te,children:L}=H,V=Me.useRef(null),W=Me.useRef(new Map).current;return Q.jsx(h,{scope:te,itemMap:W,collectionRef:V,children:L})};p.displayName=t;const c=e+"CollectionSlot",S=Om(c),E=Me.forwardRef((H,te)=>{const{scope:L,children:V}=H,W=g(c,L),re=wi(te,W.collectionRef);return Q.jsx(S,{ref:re,children:V})});E.displayName=c;const P=e+"CollectionItemSlot",k="data-radix-collection-item",I=Om(P),G=Me.forwardRef((H,te)=>{const{scope:L,children:V,...W}=H,re=Me.useRef(null),pe=wi(te,re),_e=g(P,L);return Me.useEffect(()=>(_e.itemMap.set(re,{ref:re,...W}),()=>void _e.itemMap.delete(re))),Q.jsx(I,{[k]:"",ref:pe,children:V})});G.displayName=P;function Z(H){const te=g(e+"CollectionConsumer",H);return Me.useCallback(()=>{const V=te.collectionRef.current;if(!V)return[];const W=Array.from(V.querySelectorAll(`[${k}]`));return Array.from(te.itemMap.values()).sort((_e,le)=>W.indexOf(_e.ref.current)-W.indexOf(le.ref.current))},[te.collectionRef,te.itemMap])}return[{Provider:p,Slot:E,ItemSlot:G},Z,a]}var PI=["PageUp","PageDown"],II=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],AI={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},zu="Slider",[c0,zj,Rj]=Dj(zu),[MI]=Hx(zu,[Rj]),[Lj,_g]=MI(zu),DI=$.forwardRef((e,t)=>{const{name:i,min:a=0,max:h=100,step:g=1,orientation:p="horizontal",disabled:c=!1,minStepsBetweenThumbs:S=0,defaultValue:E=[a],value:P,onValueChange:k=()=>{},onValueCommit:I=()=>{},inverted:G=!1,form:Z,...H}=e,te=$.useRef(new Set),L=$.useRef(0),W=p==="horizontal"?Bj:Fj,[re=[],pe]=aP({prop:P,defaultProp:E,onChange:Ce=>{var ze;(ze=[...te.current][L.current])==null||ze.focus(),k(Ce)}}),_e=$.useRef(re);function le(Ce){const Fe=Uj(re,Ce);Be(Ce,Fe)}function ce(Ce){Be(Ce,L.current)}function De(){const Ce=_e.current[L.current];re[L.current]!==Ce&&I(re)}function Be(Ce,Fe,{commit:ze}={commit:!1}){const Qe=Wj(g),Ze=qj(Math.round((Ce-a)/g)*g+a,Qe),Je=EI(Ze,[a,h]);pe(($e=[])=>{const ke=jj($e,Je,Fe);if(Gj(ke,S*g)){L.current=ke.indexOf(Je);const Ue=String(ke)!==String($e);return Ue&&ze&&I(ke),Ue?ke:$e}else return $e})}return Q.jsx(Lj,{scope:e.__scopeSlider,name:i,disabled:c,min:a,max:h,valueIndexToChangeRef:L,thumbs:te.current,values:re,orientation:p,form:Z,children:Q.jsx(c0.Provider,{scope:e.__scopeSlider,children:Q.jsx(c0.Slot,{scope:e.__scopeSlider,children:Q.jsx(W,{"aria-disabled":c,"data-disabled":c?"":void 0,...H,ref:t,onPointerDown:Fi(H.onPointerDown,()=>{c||(_e.current=re)}),min:a,max:h,inverted:G,onSlideStart:c?void 0:le,onSlideMove:c?void 0:ce,onSlideEnd:c?void 0:De,onHomeKeyDown:()=>!c&&Be(a,0,{commit:!0}),onEndKeyDown:()=>!c&&Be(h,re.length-1,{commit:!0}),onStepKeyDown:({event:Ce,direction:Fe})=>{if(!c){const Ze=PI.includes(Ce.key)||Ce.shiftKey&&II.includes(Ce.key)?10:1,Je=L.current,$e=re[Je],ke=g*Ze*Fe;Be($e+ke,Je,{commit:!0})}}})})})})});DI.displayName=zu;var[zI,RI]=MI(zu,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Bj=$.forwardRef((e,t)=>{const{min:i,max:a,dir:h,inverted:g,onSlideStart:p,onSlideMove:c,onSlideEnd:S,onStepKeyDown:E,...P}=e,[k,I]=$.useState(null),G=wi(t,W=>I(W)),Z=$.useRef(void 0),H=Ij(h),te=H==="ltr",L=te&&!g||!te&&g;function V(W){const re=Z.current||k.getBoundingClientRect(),pe=[0,re.width],le=sb(pe,L?[i,a]:[a,i]);return Z.current=re,le(W-re.left)}return Q.jsx(zI,{scope:e.__scopeSlider,startEdge:L?"left":"right",endEdge:L?"right":"left",direction:L?1:-1,size:"width",children:Q.jsx(LI,{dir:H,"data-orientation":"horizontal",...P,ref:G,style:{...P.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:W=>{const re=V(W.clientX);p==null||p(re)},onSlideMove:W=>{const re=V(W.clientX);c==null||c(re)},onSlideEnd:()=>{Z.current=void 0,S==null||S()},onStepKeyDown:W=>{const pe=AI[L?"from-left":"from-right"].includes(W.key);E==null||E({event:W,direction:pe?-1:1})}})})}),Fj=$.forwardRef((e,t)=>{const{min:i,max:a,inverted:h,onSlideStart:g,onSlideMove:p,onSlideEnd:c,onStepKeyDown:S,...E}=e,P=$.useRef(null),k=wi(t,P),I=$.useRef(void 0),G=!h;function Z(H){const te=I.current||P.current.getBoundingClientRect(),L=[0,te.height],W=sb(L,G?[a,i]:[i,a]);return I.current=te,W(H-te.top)}return Q.jsx(zI,{scope:e.__scopeSlider,startEdge:G?"bottom":"top",endEdge:G?"top":"bottom",size:"height",direction:G?1:-1,children:Q.jsx(LI,{"data-orientation":"vertical",...E,ref:k,style:{...E.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:H=>{const te=Z(H.clientY);g==null||g(te)},onSlideMove:H=>{const te=Z(H.clientY);p==null||p(te)},onSlideEnd:()=>{I.current=void 0,c==null||c()},onStepKeyDown:H=>{const L=AI[G?"from-bottom":"from-top"].includes(H.key);S==null||S({event:H,direction:L?-1:1})}})})}),LI=$.forwardRef((e,t)=>{const{__scopeSlider:i,onSlideStart:a,onSlideMove:h,onSlideEnd:g,onHomeKeyDown:p,onEndKeyDown:c,onStepKeyDown:S,...E}=e,P=_g(zu,i);return Q.jsx(lr.span,{...E,ref:t,onKeyDown:Fi(e.onKeyDown,k=>{k.key==="Home"?(p(k),k.preventDefault()):k.key==="End"?(c(k),k.preventDefault()):PI.concat(II).includes(k.key)&&(S(k),k.preventDefault())}),onPointerDown:Fi(e.onPointerDown,k=>{const I=k.target;I.setPointerCapture(k.pointerId),k.preventDefault(),P.thumbs.has(I)?I.focus():a(k)}),onPointerMove:Fi(e.onPointerMove,k=>{k.target.hasPointerCapture(k.pointerId)&&h(k)}),onPointerUp:Fi(e.onPointerUp,k=>{const I=k.target;I.hasPointerCapture(k.pointerId)&&(I.releasePointerCapture(k.pointerId),g(k))})})}),BI="SliderTrack",FI=$.forwardRef((e,t)=>{const{__scopeSlider:i,...a}=e,h=_g(BI,i);return Q.jsx(lr.span,{"data-disabled":h.disabled?"":void 0,"data-orientation":h.orientation,...a,ref:t})});FI.displayName=BI;var u0="SliderRange",NI=$.forwardRef((e,t)=>{const{__scopeSlider:i,...a}=e,h=_g(u0,i),g=RI(u0,i),p=$.useRef(null),c=wi(t,p),S=h.values.length,E=h.values.map(I=>VI(I,h.min,h.max)),P=S>1?Math.min(...E):0,k=100-Math.max(...E);return Q.jsx(lr.span,{"data-orientation":h.orientation,"data-disabled":h.disabled?"":void 0,...a,ref:c,style:{...e.style,[g.startEdge]:P+"%",[g.endEdge]:k+"%"}})});NI.displayName=u0;var h0="SliderThumb",OI=$.forwardRef((e,t)=>{const i=zj(e.__scopeSlider),[a,h]=$.useState(null),g=wi(t,c=>h(c)),p=$.useMemo(()=>a?i().findIndex(c=>c.ref.current===a):-1,[i,a]);return Q.jsx(Nj,{...e,ref:g,index:p})}),Nj=$.forwardRef((e,t)=>{const{__scopeSlider:i,index:a,name:h,...g}=e,p=_g(h0,i),c=RI(h0,i),[S,E]=$.useState(null),P=wi(t,V=>E(V)),k=S?p.form||!!S.closest("form"):!0,I=Mj(S),G=p.values[a],Z=G===void 0?0:VI(G,p.min,p.max),H=Vj(a,p.values.length),te=I==null?void 0:I[c.size],L=te?$j(te,Z,c.direction):0;return $.useEffect(()=>{if(S)return p.thumbs.add(S),()=>{p.thumbs.delete(S)}},[S,p.thumbs]),Q.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${Z}% + ${L}px)`},children:[Q.jsx(c0.ItemSlot,{scope:e.__scopeSlider,children:Q.jsx(lr.span,{role:"slider","aria-label":e["aria-label"]||H,"aria-valuemin":p.min,"aria-valuenow":G,"aria-valuemax":p.max,"aria-orientation":p.orientation,"data-orientation":p.orientation,"data-disabled":p.disabled?"":void 0,tabIndex:p.disabled?void 0:0,...g,ref:P,style:G===void 0?{display:"none"}:e.style,onFocus:Fi(e.onFocus,()=>{p.valueIndexToChangeRef.current=a})})}),k&&Q.jsx(jI,{name:h??(p.name?p.name+(p.values.length>1?"[]":""):void 0),form:p.form,value:G},a)]})});OI.displayName=h0;var Oj="RadioBubbleInput",jI=$.forwardRef(({__scopeSlider:e,value:t,...i},a)=>{const h=$.useRef(null),g=wi(h,a),p=Aj(t);return $.useEffect(()=>{const c=h.current;if(!c)return;const S=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(S,"value").set;if(p!==t&&P){const k=new Event("input",{bubbles:!0});P.call(c,t),c.dispatchEvent(k)}},[p,t]),Q.jsx(lr.input,{style:{display:"none"},...i,ref:g,defaultValue:t})});jI.displayName=Oj;function jj(e=[],t,i){const a=[...e];return a[i]=t,a.sort((h,g)=>h-g)}function VI(e,t,i){const g=100/(i-t)*(e-t);return EI(g,[0,100])}function Vj(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Uj(e,t){if(e.length===1)return 0;const i=e.map(h=>Math.abs(h-t)),a=Math.min(...i);return i.indexOf(a)}function $j(e,t,i){const a=e/2,g=sb([0,50],[0,a]);return(a-g(t)*i)*i}function Hj(e){return e.slice(0,-1).map((t,i)=>e[i+1]-t)}function Gj(e,t){if(t>0){const i=Hj(e);return Math.min(...i)>=t}return!0}function sb(e,t){return i=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(i-e[0])}}function Wj(e){return(String(e).split(".")[1]||"").length}function qj(e,t){const i=Math.pow(10,t);return Math.round(e*i)/i}var UI=DI,Zj=FI,Xj=NI,Kj=OI;const $I=$.forwardRef(({className:e,...t},i)=>Q.jsxs(UI,{ref:i,className:Yt("relative flex w-full touch-none select-none items-center",e),...t,children:[Q.jsx(Zj,{className:"relative h-[3px] w-full grow overflow-hidden rounded-full bg-neutral-300",children:Q.jsx(Xj,{className:"absolute h-full bg-neutral-300"})}),Q.jsx(Kj,{className:"block h-6 w-6 rounded-full border-2 border-white bg-[#d4af37] shadow-md ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#d4af37]/50 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 cursor-pointer"})]}));$I.displayName=UI.displayName;const Yj=({currentYear:e,onChange:t,onClose:i})=>{const g=p=>{t(p[0])};return Q.jsxs(Q.Fragment,{children:[Q.jsx(rs.div,{className:"fixed inset-0 bg-black/20 z-[115] md:hidden",onClick:i,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),Q.jsx(rs.div,{className:"fixed bottom-10 left-1/2 z-[120] w-[90%] max-w-[400px]",initial:{y:100,opacity:0,x:"-50%"},animate:{y:0,opacity:1,x:"-50%"},exit:{y:100,opacity:0,x:"-50%"},transition:{type:"spring",stiffness:300,damping:30},children:Q.jsxs(lg,{className:"border-0 shadow-2xl bg-background/80 backdrop-blur-md",children:[Q.jsx(Rs,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 h-8 w-8 text-muted-foreground hover:text-foreground md:hidden",onClick:i,children:Q.jsx(gg,{className:"h-5 w-5"})}),Q.jsxs(cg,{className:"pt-6 pb-5 px-8",children:[Q.jsx("div",{className:"text-center mb-4",children:Q.jsx("h2",{className:"text-2xl font-normal text-[#c0392b]",style:{fontFamily:"'Labrada', serif"},children:e===2025?"Present Day":`Year: ${e}`})}),Q.jsx($I,{value:[e],onValueChange:g,min:1850,max:2025,step:1,className:"py-4"}),Q.jsxs("div",{className:"flex justify-between text-xs font-bold text-muted-foreground mt-1 px-1",children:[Q.jsx("span",{children:1850}),Q.jsx("span",{children:"Present"})]})]})]})})]})};function Jj(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}const Qj=e=>{switch(e){case"success":return n8;case"info":return i8;case"warning":return r8;case"error":return s8;default:return null}},e8=Array(12).fill(0),t8=({visible:e,className:t})=>Me.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Me.createElement("div",{className:"sonner-spinner"},e8.map((i,a)=>Me.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),n8=Me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Me.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),r8=Me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Me.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),i8=Me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),s8=Me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),o8=Me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Me.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Me.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),a8=()=>{const[e,t]=Me.useState(document.hidden);return Me.useEffect(()=>{const i=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",i),()=>window.removeEventListener("visibilitychange",i)},[]),e};let d0=1;class l8{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const i=this.subscribers.indexOf(t);this.subscribers.splice(i,1)}),this.publish=t=>{this.subscribers.forEach(i=>i(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var i;const{message:a,...h}=t,g=typeof(t==null?void 0:t.id)=="number"||((i=t.id)==null?void 0:i.length)>0?t.id:d0++,p=this.toasts.find(S=>S.id===g),c=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(g)&&this.dismissedToasts.delete(g),p?this.toasts=this.toasts.map(S=>S.id===g?(this.publish({...S,...t,id:g,title:a}),{...S,...t,id:g,dismissible:c,title:a}):S):this.addToast({title:a,...h,dismissible:c,id:g}),g},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(i=>i({id:t,dismiss:!0})))):this.toasts.forEach(i=>{this.subscribers.forEach(a=>a({id:i.id,dismiss:!0}))}),t),this.message=(t,i)=>this.create({...i,message:t}),this.error=(t,i)=>this.create({...i,message:t,type:"error"}),this.success=(t,i)=>this.create({...i,type:"success",message:t}),this.info=(t,i)=>this.create({...i,type:"info",message:t}),this.warning=(t,i)=>this.create({...i,type:"warning",message:t}),this.loading=(t,i)=>this.create({...i,type:"loading",message:t}),this.promise=(t,i)=>{if(!i)return;let a;i.loading!==void 0&&(a=this.create({...i,promise:t,type:"loading",message:i.loading,description:typeof i.description!="function"?i.description:void 0}));const h=Promise.resolve(t instanceof Function?t():t);let g=a!==void 0,p;const c=h.then(async E=>{if(p=["resolve",E],Me.isValidElement(E))g=!1,this.create({id:a,type:"default",message:E});else if(u8(E)&&!E.ok){g=!1;const k=typeof i.error=="function"?await i.error(`HTTP error! status: ${E.status}`):i.error,I=typeof i.description=="function"?await i.description(`HTTP error! status: ${E.status}`):i.description,Z=typeof k=="object"&&!Me.isValidElement(k)?k:{message:k};this.create({id:a,type:"error",description:I,...Z})}else if(E instanceof Error){g=!1;const k=typeof i.error=="function"?await i.error(E):i.error,I=typeof i.description=="function"?await i.description(E):i.description,Z=typeof k=="object"&&!Me.isValidElement(k)?k:{message:k};this.create({id:a,type:"error",description:I,...Z})}else if(i.success!==void 0){g=!1;const k=typeof i.success=="function"?await i.success(E):i.success,I=typeof i.description=="function"?await i.description(E):i.description,Z=typeof k=="object"&&!Me.isValidElement(k)?k:{message:k};this.create({id:a,type:"success",description:I,...Z})}}).catch(async E=>{if(p=["reject",E],i.error!==void 0){g=!1;const P=typeof i.error=="function"?await i.error(E):i.error,k=typeof i.description=="function"?await i.description(E):i.description,G=typeof P=="object"&&!Me.isValidElement(P)?P:{message:P};this.create({id:a,type:"error",description:k,...G})}}).finally(()=>{g&&(this.dismiss(a),a=void 0),i.finally==null||i.finally.call(i)}),S=()=>new Promise((E,P)=>c.then(()=>p[0]==="reject"?P(p[1]):E(p[1])).catch(P));return typeof a!="string"&&typeof a!="number"?{unwrap:S}:Object.assign(a,{unwrap:S})},this.custom=(t,i)=>{const a=(i==null?void 0:i.id)||d0++;return this.create({jsx:t(a),id:a,...i}),a},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Ri=new l8,c8=(e,t)=>{const i=(t==null?void 0:t.id)||d0++;return Ri.addToast({title:e,...t,id:i}),i},u8=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",h8=c8,d8=()=>Ri.toasts,f8=()=>Ri.getActiveToasts(),f0=Object.assign(h8,{success:Ri.success,info:Ri.info,warning:Ri.warning,error:Ri.error,custom:Ri.custom,message:Ri.message,promise:Ri.promise,dismiss:Ri.dismiss,loading:Ri.loading},{getHistory:d8,getToasts:f8});Jj("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Up(e){return e.label!==void 0}const p8=3,m8="24px",g8="16px",WS=4e3,y8=356,v8=14,_8=45,x8=200;function Xs(...e){return e.filter(Boolean).join(" ")}function b8(e){const[t,i]=e.split("-"),a=[];return t&&a.push(t),i&&a.push(i),a}const w8=e=>{var t,i,a,h,g,p,c,S,E;const{invert:P,toast:k,unstyled:I,interacting:G,setHeights:Z,visibleToasts:H,heights:te,index:L,toasts:V,expanded:W,removeToast:re,defaultRichColors:pe,closeButton:_e,style:le,cancelButtonStyle:ce,actionButtonStyle:De,className:Be="",descriptionClassName:Ce="",duration:Fe,position:ze,gap:Qe,expandByDefault:Ze,classNames:Je,icons:$e,closeButtonAriaLabel:ke="Close toast"}=e,[Ue,et]=Me.useState(null),[pt,Le]=Me.useState(null),[Ve,We]=Me.useState(!1),[He,_t]=Me.useState(!1),[tt,dt]=Me.useState(!1),[Pt,Ut]=Me.useState(!1),[Ft,at]=Me.useState(!1),[Wt,mt]=Me.useState(0),[wn,Pe]=Me.useState(0),Sn=Me.useRef(k.duration||Fe||WS),dr=Me.useRef(null),Nt=Me.useRef(null),Jt=L===0,Ir=L+1<=H,xn=k.type,En=k.dismissible!==!1,ci=k.className||"",er=k.descriptionClassName||"",Xr=Me.useMemo(()=>te.findIndex(N=>N.toastId===k.id)||0,[te,k.id]),Ti=Me.useMemo(()=>{var N;return(N=k.closeButton)!=null?N:_e},[k.closeButton,_e]),qe=Me.useMemo(()=>k.duration||Fe||WS,[k.duration,Fe]),tr=Me.useRef(0),dn=Me.useRef(0),cr=Me.useRef(0),zn=Me.useRef(null),[Ye,$t]=ze.split("-"),Dt=Me.useMemo(()=>te.reduce((N,j,K)=>K>=Xr?N:N+j.height,0),[te,Xr]),Gn=a8(),xr=k.invert||P,Bt=xn==="loading";dn.current=Me.useMemo(()=>Xr*Qe+Dt,[Xr,Dt]),Me.useEffect(()=>{Sn.current=qe},[qe]),Me.useEffect(()=>{We(!0)},[]),Me.useEffect(()=>{const N=Nt.current;if(N){const j=N.getBoundingClientRect().height;return Pe(j),Z(K=>[{toastId:k.id,height:j,position:k.position},...K]),()=>Z(K=>K.filter(ne=>ne.toastId!==k.id))}},[Z,k.id]),Me.useLayoutEffect(()=>{if(!Ve)return;const N=Nt.current,j=N.style.height;N.style.height="auto";const K=N.getBoundingClientRect().height;N.style.height=j,Pe(K),Z(ne=>ne.find(ge=>ge.toastId===k.id)?ne.map(ge=>ge.toastId===k.id?{...ge,height:K}:ge):[{toastId:k.id,height:K,position:k.position},...ne])},[Ve,k.title,k.description,Z,k.id,k.jsx,k.action,k.cancel]);const xt=Me.useCallback(()=>{_t(!0),mt(dn.current),Z(N=>N.filter(j=>j.toastId!==k.id)),setTimeout(()=>{re(k)},x8)},[k,re,Z,dn]);Me.useEffect(()=>{if(k.promise&&xn==="loading"||k.duration===1/0||k.type==="loading")return;let N;return W||G||Gn?(()=>{if(cr.current<tr.current){const ne=new Date().getTime()-tr.current;Sn.current=Sn.current-ne}cr.current=new Date().getTime()})():(()=>{Sn.current!==1/0&&(tr.current=new Date().getTime(),N=setTimeout(()=>{k.onAutoClose==null||k.onAutoClose.call(k,k),xt()},Sn.current))})(),()=>clearTimeout(N)},[W,G,k,xn,Gn,xt]),Me.useEffect(()=>{k.delete&&(xt(),k.onDismiss==null||k.onDismiss.call(k,k))},[xt,k.delete]);function Zt(){var N;if($e!=null&&$e.loading){var j;return Me.createElement("div",{className:Xs(Je==null?void 0:Je.loader,k==null||(j=k.classNames)==null?void 0:j.loader,"sonner-loader"),"data-visible":xn==="loading"},$e.loading)}return Me.createElement(t8,{className:Xs(Je==null?void 0:Je.loader,k==null||(N=k.classNames)==null?void 0:N.loader),visible:xn==="loading"})}const Qt=k.icon||($e==null?void 0:$e[xn])||Qj(xn);var Ht,ie;return Me.createElement("li",{tabIndex:0,ref:Nt,className:Xs(Be,ci,Je==null?void 0:Je.toast,k==null||(t=k.classNames)==null?void 0:t.toast,Je==null?void 0:Je.default,Je==null?void 0:Je[xn],k==null||(i=k.classNames)==null?void 0:i[xn]),"data-sonner-toast":"","data-rich-colors":(Ht=k.richColors)!=null?Ht:pe,"data-styled":!(k.jsx||k.unstyled||I),"data-mounted":Ve,"data-promise":!!k.promise,"data-swiped":Ft,"data-removed":He,"data-visible":Ir,"data-y-position":Ye,"data-x-position":$t,"data-index":L,"data-front":Jt,"data-swiping":tt,"data-dismissible":En,"data-type":xn,"data-invert":xr,"data-swipe-out":Pt,"data-swipe-direction":pt,"data-expanded":!!(W||Ze&&Ve),"data-testid":k.testId,style:{"--index":L,"--toasts-before":L,"--z-index":V.length-L,"--offset":`${He?Wt:dn.current}px`,"--initial-height":Ze?"auto":`${wn}px`,...le,...k.style},onDragEnd:()=>{dt(!1),et(null),zn.current=null},onPointerDown:N=>{N.button!==2&&(Bt||!En||(dr.current=new Date,mt(dn.current),N.target.setPointerCapture(N.pointerId),N.target.tagName!=="BUTTON"&&(dt(!0),zn.current={x:N.clientX,y:N.clientY})))},onPointerUp:()=>{var N,j,K;if(Pt||!En)return;zn.current=null;const ne=Number(((N=Nt.current)==null?void 0:N.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),me=Number(((j=Nt.current)==null?void 0:j.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ge=new Date().getTime()-((K=dr.current)==null?void 0:K.getTime()),xe=Ue==="x"?ne:me,de=Math.abs(xe)/ge;if(Math.abs(xe)>=_8||de>.11){mt(dn.current),k.onDismiss==null||k.onDismiss.call(k,k),Le(Ue==="x"?ne>0?"right":"left":me>0?"down":"up"),xt(),Ut(!0);return}else{var Ie,Ne;(Ie=Nt.current)==null||Ie.style.setProperty("--swipe-amount-x","0px"),(Ne=Nt.current)==null||Ne.style.setProperty("--swipe-amount-y","0px")}at(!1),dt(!1),et(null)},onPointerMove:N=>{var j,K,ne;if(!zn.current||!En||((j=window.getSelection())==null?void 0:j.toString().length)>0)return;const ge=N.clientY-zn.current.y,xe=N.clientX-zn.current.x;var de;const Ie=(de=e.swipeDirections)!=null?de:b8(ze);!Ue&&(Math.abs(xe)>1||Math.abs(ge)>1)&&et(Math.abs(xe)>Math.abs(ge)?"x":"y");let Ne={x:0,y:0};const Ae=Xe=>1/(1.5+Math.abs(Xe)/20);if(Ue==="y"){if(Ie.includes("top")||Ie.includes("bottom"))if(Ie.includes("top")&&ge<0||Ie.includes("bottom")&&ge>0)Ne.y=ge;else{const Xe=ge*Ae(ge);Ne.y=Math.abs(Xe)<Math.abs(ge)?Xe:ge}}else if(Ue==="x"&&(Ie.includes("left")||Ie.includes("right")))if(Ie.includes("left")&&xe<0||Ie.includes("right")&&xe>0)Ne.x=xe;else{const Xe=xe*Ae(xe);Ne.x=Math.abs(Xe)<Math.abs(xe)?Xe:xe}(Math.abs(Ne.x)>0||Math.abs(Ne.y)>0)&&at(!0),(K=Nt.current)==null||K.style.setProperty("--swipe-amount-x",`${Ne.x}px`),(ne=Nt.current)==null||ne.style.setProperty("--swipe-amount-y",`${Ne.y}px`)}},Ti&&!k.jsx&&xn!=="loading"?Me.createElement("button",{"aria-label":ke,"data-disabled":Bt,"data-close-button":!0,onClick:Bt||!En?()=>{}:()=>{xt(),k.onDismiss==null||k.onDismiss.call(k,k)},className:Xs(Je==null?void 0:Je.closeButton,k==null||(a=k.classNames)==null?void 0:a.closeButton)},(ie=$e==null?void 0:$e.close)!=null?ie:o8):null,(xn||k.icon||k.promise)&&k.icon!==null&&(($e==null?void 0:$e[xn])!==null||k.icon)?Me.createElement("div",{"data-icon":"",className:Xs(Je==null?void 0:Je.icon,k==null||(h=k.classNames)==null?void 0:h.icon)},k.promise||k.type==="loading"&&!k.icon?k.icon||Zt():null,k.type!=="loading"?Qt:null):null,Me.createElement("div",{"data-content":"",className:Xs(Je==null?void 0:Je.content,k==null||(g=k.classNames)==null?void 0:g.content)},Me.createElement("div",{"data-title":"",className:Xs(Je==null?void 0:Je.title,k==null||(p=k.classNames)==null?void 0:p.title)},k.jsx?k.jsx:typeof k.title=="function"?k.title():k.title),k.description?Me.createElement("div",{"data-description":"",className:Xs(Ce,er,Je==null?void 0:Je.description,k==null||(c=k.classNames)==null?void 0:c.description)},typeof k.description=="function"?k.description():k.description):null),Me.isValidElement(k.cancel)?k.cancel:k.cancel&&Up(k.cancel)?Me.createElement("button",{"data-button":!0,"data-cancel":!0,style:k.cancelButtonStyle||ce,onClick:N=>{Up(k.cancel)&&En&&(k.cancel.onClick==null||k.cancel.onClick.call(k.cancel,N),xt())},className:Xs(Je==null?void 0:Je.cancelButton,k==null||(S=k.classNames)==null?void 0:S.cancelButton)},k.cancel.label):null,Me.isValidElement(k.action)?k.action:k.action&&Up(k.action)?Me.createElement("button",{"data-button":!0,"data-action":!0,style:k.actionButtonStyle||De,onClick:N=>{Up(k.action)&&(k.action.onClick==null||k.action.onClick.call(k.action,N),!N.defaultPrevented&&xt())},className:Xs(Je==null?void 0:Je.actionButton,k==null||(E=k.classNames)==null?void 0:E.actionButton)},k.action.label):null)};function qS(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function S8(e,t){const i={};return[e,t].forEach((a,h)=>{const g=h===1,p=g?"--mobile-offset":"--offset",c=g?g8:m8;function S(E){["top","right","bottom","left"].forEach(P=>{i[`${p}-${P}`]=typeof E=="number"?`${E}px`:E})}typeof a=="number"||typeof a=="string"?S(a):typeof a=="object"?["top","right","bottom","left"].forEach(E=>{a[E]===void 0?i[`${p}-${E}`]=c:i[`${p}-${E}`]=typeof a[E]=="number"?`${a[E]}px`:a[E]}):S(c)}),i}const k8=Me.forwardRef(function(t,i){const{id:a,invert:h,position:g="bottom-right",hotkey:p=["altKey","KeyT"],expand:c,closeButton:S,className:E,offset:P,mobileOffset:k,theme:I="light",richColors:G,duration:Z,style:H,visibleToasts:te=p8,toastOptions:L,dir:V=qS(),gap:W=v8,icons:re,containerAriaLabel:pe="Notifications"}=t,[_e,le]=Me.useState([]),ce=Me.useMemo(()=>a?_e.filter(Ve=>Ve.toasterId===a):_e.filter(Ve=>!Ve.toasterId),[_e,a]),De=Me.useMemo(()=>Array.from(new Set([g].concat(ce.filter(Ve=>Ve.position).map(Ve=>Ve.position)))),[ce,g]),[Be,Ce]=Me.useState([]),[Fe,ze]=Me.useState(!1),[Qe,Ze]=Me.useState(!1),[Je,$e]=Me.useState(I!=="system"?I:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ke=Me.useRef(null),Ue=p.join("+").replace(/Key/g,"").replace(/Digit/g,""),et=Me.useRef(null),pt=Me.useRef(!1),Le=Me.useCallback(Ve=>{le(We=>{var He;return(He=We.find(_t=>_t.id===Ve.id))!=null&&He.delete||Ri.dismiss(Ve.id),We.filter(({id:_t})=>_t!==Ve.id)})},[]);return Me.useEffect(()=>Ri.subscribe(Ve=>{if(Ve.dismiss){requestAnimationFrame(()=>{le(We=>We.map(He=>He.id===Ve.id?{...He,delete:!0}:He))});return}setTimeout(()=>{aC.flushSync(()=>{le(We=>{const He=We.findIndex(_t=>_t.id===Ve.id);return He!==-1?[...We.slice(0,He),{...We[He],...Ve},...We.slice(He+1)]:[Ve,...We]})})})}),[_e]),Me.useEffect(()=>{if(I!=="system"){$e(I);return}if(I==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?$e("dark"):$e("light")),typeof window>"u")return;const Ve=window.matchMedia("(prefers-color-scheme: dark)");try{Ve.addEventListener("change",({matches:We})=>{$e(We?"dark":"light")})}catch{Ve.addListener(({matches:He})=>{try{$e(He?"dark":"light")}catch(_t){console.error(_t)}})}},[I]),Me.useEffect(()=>{_e.length<=1&&ze(!1)},[_e]),Me.useEffect(()=>{const Ve=We=>{var He;if(p.every(dt=>We[dt]||We.code===dt)){var tt;ze(!0),(tt=ke.current)==null||tt.focus()}We.code==="Escape"&&(document.activeElement===ke.current||(He=ke.current)!=null&&He.contains(document.activeElement))&&ze(!1)};return document.addEventListener("keydown",Ve),()=>document.removeEventListener("keydown",Ve)},[p]),Me.useEffect(()=>{if(ke.current)return()=>{et.current&&(et.current.focus({preventScroll:!0}),et.current=null,pt.current=!1)}},[ke.current]),Me.createElement("section",{ref:i,"aria-label":`${pe} ${Ue}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},De.map((Ve,We)=>{var He;const[_t,tt]=Ve.split("-");return ce.length?Me.createElement("ol",{key:Ve,dir:V==="auto"?qS():V,tabIndex:-1,ref:ke,className:E,"data-sonner-toaster":!0,"data-sonner-theme":Je,"data-y-position":_t,"data-x-position":tt,style:{"--front-toast-height":`${((He=Be[0])==null?void 0:He.height)||0}px`,"--width":`${y8}px`,"--gap":`${W}px`,...H,...S8(P,k)},onBlur:dt=>{pt.current&&!dt.currentTarget.contains(dt.relatedTarget)&&(pt.current=!1,et.current&&(et.current.focus({preventScroll:!0}),et.current=null))},onFocus:dt=>{dt.target instanceof HTMLElement&&dt.target.dataset.dismissible==="false"||pt.current||(pt.current=!0,et.current=dt.relatedTarget)},onMouseEnter:()=>ze(!0),onMouseMove:()=>ze(!0),onMouseLeave:()=>{Qe||ze(!1)},onDragEnd:()=>ze(!1),onPointerDown:dt=>{dt.target instanceof HTMLElement&&dt.target.dataset.dismissible==="false"||Ze(!0)},onPointerUp:()=>Ze(!1)},ce.filter(dt=>!dt.position&&We===0||dt.position===Ve).map((dt,Pt)=>{var Ut,Ft;return Me.createElement(w8,{key:dt.id,icons:re,index:Pt,toast:dt,defaultRichColors:G,duration:(Ut=L==null?void 0:L.duration)!=null?Ut:Z,className:L==null?void 0:L.className,descriptionClassName:L==null?void 0:L.descriptionClassName,invert:h,visibleToasts:te,closeButton:(Ft=L==null?void 0:L.closeButton)!=null?Ft:S,interacting:Qe,position:Ve,style:L==null?void 0:L.style,unstyled:L==null?void 0:L.unstyled,classNames:L==null?void 0:L.classNames,cancelButtonStyle:L==null?void 0:L.cancelButtonStyle,actionButtonStyle:L==null?void 0:L.actionButtonStyle,closeButtonAriaLabel:L==null?void 0:L.closeButtonAriaLabel,removeToast:Le,toasts:ce.filter(at=>at.position==dt.position),heights:Be.filter(at=>at.position==dt.position),setHeights:Ce,expandByDefault:c,gap:W,expanded:Fe,swipeDirections:t.swipeDirections})})):null}))}),T8=({id:e,onClick:t,iconClass:i,label:a,isActive:h,disabled:g,className:p,hideLabel:c=!1,isMobile:S=!1})=>{const[E,P]=$.useState(!1);return Q.jsxs(Rs,{variant:"ghost",size:"icon",id:e,onClick:t,disabled:g,className:Yt("v-control-btn border transition-all duration-300",h&&"active",g&&"opacity-40 cursor-not-allowed",!c&&!S&&"hover:w-auto",S&&"!w-10 !max-w-10 !min-w-10",p),onMouseEnter:()=>!S&&P(!0),onMouseLeave:()=>!S&&P(!1),children:[Q.jsx("div",{className:"v-control-icon-wrapper",children:Q.jsx("i",{className:Yt("fa-solid",i)})}),!c&&!S&&Q.jsx("span",{className:Yt("whitespace-nowrap text-[11px] font-extrabold uppercase tracking-widest overflow-hidden transition-all duration-300 ease-out",!E&&"max-w-0 p-0 opacity-0",E&&"max-w-[200px] px-3 opacity-100"),children:a})]})},C8=({onZoomIn:e,onZoomOut:t,onResetNorth:i,onToggleTime:a,isTimeActive:h,is1883Mode:g,onToggle1883:p,is3DVisible:c,onToggle3D:S,onResetView:E,onLocate:P})=>{const[k,I]=$.useState(!1),{theme:G,setTheme:Z}=rb();$.useEffect(()=>{const re=()=>I(window.innerWidth<=768);return re(),window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]);const H={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},te={hidden:{opacity:0,x:20},visible:{opacity:1,x:0}},L=(re,pe)=>{k&&re&&f0(re,{duration:1500}),pe()},V=g,W=[{id:"zoom-in-btn",onClick:e,icon:"fa-plus",label:"Zoom In",hideLabel:!0},{id:"zoom-out-btn",onClick:t,icon:"fa-minus",label:"Zoom Out",hideLabel:!0},{id:"compass-btn",onClick:()=>L("Reset North",i),icon:"fa-arrow-up",label:"Reset North"},{id:"time-travel-btn",onClick:a,icon:"fa-clock-rotate-left",label:"Time Travel",isActive:h,disabled:g},{id:"map-1883-btn",onClick:()=>g?p():L("1883 Map",p),icon:"fa-map-location-dot",label:"1883 Map",isActive:g,overrideDim:!0},{id:"view-3d-btn",onClick:()=>L("3D View",S),icon:"fa-cube",label:"3D View",isActive:c,disabled:g},{id:"reset-view-btn",onClick:()=>L("Reset View",E),icon:"fa-compress",label:"Reset View"},{id:"locate-btn",onClick:()=>L("My Location",P),icon:"fa-location-crosshairs",label:"My Location"},{id:"theme-toggle-btn",onClick:()=>Z(G==="dark"?"light":"dark"),icon:G==="dark"?"fa-sun":"fa-moon",label:G==="dark"?"Light Mode":"Dark Mode",overrideDim:!0}];return Q.jsx(rs.div,{id:"vertical-controls",className:"fixed right-5 bottom-8 flex flex-col items-end gap-2 z-[95] overflow-visible !max-h-none !h-auto",variants:H,initial:"hidden",animate:"visible",children:W.map(re=>Q.jsx(rs.div,{variants:te,children:Q.jsx(T8,{id:re.id,onClick:re.onClick,iconClass:re.icon,label:re.label,isActive:re.isActive,disabled:re.disabled,hideLabel:re.hideLabel,isMobile:k,className:V&&!re.overrideDim&&!re.disabled?"opacity-40 pointer-events-none":""})},re.id))})},E8=({visible:e,onDismiss:t})=>Q.jsx(wu,{children:e&&Q.jsx(rs.div,{id:"tutorial-overlay",className:"fixed inset-0 z-[150] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:Q.jsx(rs.div,{className:"w-full max-w-sm",initial:{scale:.8,y:50,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.8,y:50,opacity:0},transition:{type:"spring",stiffness:300,damping:25},children:Q.jsxs(lg,{className:"max-w-[360px] w-full border-none shadow-2xl bg-background/80 backdrop-blur-md overflow-hidden p-0",children:[Q.jsxs(rP,{className:"text-center pb-2",children:[Q.jsx("div",{className:"text-4xl mb-2",children:""}),Q.jsx(iP,{className:"text-3xl font-bold text-[#d4af37]",style:{fontFamily:"'Labrada', serif"},children:"Kala Ghoda"}),Q.jsx("div",{className:"text-sm font-medium text-muted-foreground uppercase tracking-widest",children:"Heritage Map"})]}),Q.jsxs(cg,{className:"grid gap-4 pt-4",children:[Q.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-muted border border-border",children:[Q.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 shrink-0",children:Q.jsx("i",{className:"fa-solid fa-hand-pointer text-lg"})}),Q.jsxs("div",{className:"text-sm text-muted-foreground",children:[Q.jsx("strong",{className:"text-foreground",children:"Tap markers"})," to explore heritage sites"]})]}),Q.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-muted border border-border",children:[Q.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 shrink-0",children:Q.jsx("i",{className:"fa-solid fa-filter text-lg"})}),Q.jsxs("div",{className:"text-sm text-muted-foreground",children:[Q.jsx("strong",{className:"text-foreground",children:"Tap chips"})," to show/hide layer types"]})]}),Q.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-muted border border-border",children:[Q.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400 shrink-0",children:Q.jsx("i",{className:"fa-solid fa-hand text-lg"})}),Q.jsxs("div",{className:"text-sm text-muted-foreground",children:[Q.jsx("strong",{className:"text-foreground",children:"Long-press chips"})," for solo mode"]})]}),Q.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-muted border border-border",children:[Q.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 shrink-0",children:Q.jsx("i",{className:"fa-solid fa-clock-rotate-left text-lg"})}),Q.jsxs("div",{className:"text-sm text-muted-foreground",children:[Q.jsx("strong",{className:"text-foreground",children:"Time slider"})," to filter by year built"]})]}),Q.jsx(Rs,{size:"lg",className:"w-full mt-2 font-bold bg-[#c0392b] hover:bg-[#a93226] text-white",onClick:t,children:"Got it, let's explore"})]})]})})})}),P8=({...e})=>Q.jsx(k8,{theme:"system",className:"toaster group",closeButton:!0,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-white group-[.toaster]:text-neutral-950 group-[.toaster]:border-neutral-200 group-[.toaster]:shadow-lg group-[.toaster]:rounded-lg group-[.toaster]:p-4 dark:group-[.toaster]:bg-neutral-900 dark:group-[.toaster]:text-white dark:group-[.toaster]:border-neutral-800 group-[.toaster]:font-['Lato'] group-[.toaster]:w-full group-[.toaster]:max-w-[250px] group-[.toaster]:relative group-[.toaster]:mx-auto group-[.toaster]:text-left",title:"group-[.toast]:font-bold group-[.toast]:text-sm group-[.toast]:text-left",description:"group-[.toast]:text-neutral-500 dark:group-[.toast]:text-neutral-400 group-[.toast]:text-sm group-[.toast]:text-left",actionButton:"group-[.toast]:bg-neutral-900 group-[.toast]:text-neutral-50 dark:group-[.toast]:bg-neutral-50 dark:group-[.toast]:text-neutral-900",cancelButton:"group-[.toast]:bg-neutral-100 group-[.toast]:text-neutral-500 dark:group-[.toast]:bg-neutral-800 dark:group-[.toast]:text-neutral-400",closeButton:"group-[.toast]:!bg-transparent group-[.toast]:!border-0 group-[.toast]:!text-neutral-500 group-[.toast]:hover:!text-neutral-900 group-[.toast]:!absolute group-[.toast]:!right-0 group-[.toast]:!top-3 group-[.toast]:!left-auto group-[.toast]:!h-15 group-[.toast]:!w-15"}},...e});function I8(){const e=$.useRef(null),[t,i]=$.useState(null),[a,h]=$.useState(2025),[g,p]=$.useState([]),[c,S]=$.useState(!1),[E,P]=$.useState(!1),[k,I]=$.useState(!0),[G,Z]=$.useState(()=>window.innerWidth>768),[H,te]=$.useState(()=>{const Fe=window.innerWidth<=768,ze=localStorage.getItem("tutorialSeen");return Fe&&!ze}),{theme:L}=rb(),[V,W]=$.useState(!1),re=$.useCallback(()=>{W(!0);const Fe=document.getElementById("loading-bar");Fe&&(Fe.style.width="100%")},[]);$.useEffect(()=>{if(V){const Fe=document.getElementById("loading-screen"),ze=document.getElementById("loading-text");ze&&(ze.innerText="Ready!");const Qe=setTimeout(()=>{Fe&&(Fe.style.opacity="0",setTimeout(()=>{Fe.style.display="none"},800))},300);return()=>clearTimeout(Qe)}},[V]);const pe=$.useCallback(()=>{localStorage.setItem("tutorialSeen","true"),te(!1)},[]);$.useEffect(()=>(c?document.body.classList.add("mode-1883"):document.body.classList.remove("mode-1883"),()=>{document.body.classList.remove("mode-1883")}),[c]),$.useEffect(()=>{const ze=new URLSearchParams(window.location.search).get("site");if(ze&&V){const Qe=bd.find(Ze=>Ze.id===ze);Qe&&(i(Qe),Qe.location&&setTimeout(()=>{var Ze;(Ze=e.current)==null||Ze.flyTo(Qe.location.center,18)},500))}},[V]);const _e=$.useCallback(Fe=>{var ze;i(Fe),Fe.location&&((ze=e.current)==null||ze.flyTo(Fe.location.center,18))},[]),le=$.useCallback(()=>{i(null)},[]),ce=$.useCallback(Fe=>{p(ze=>ze.includes(Fe)?ze.filter(Qe=>Qe!==Fe):[...ze,Fe])},[]),De=$.useCallback(Fe=>{const Qe=Object.keys(sr.colors).filter(Ze=>Ze!==Fe);p(Ze=>{const Je=!Ze.includes(Fe),$e=Qe.every(Ue=>Ze.includes(Ue));return Je&&$e?[]:Qe})},[]),Be=$.useCallback(()=>{p([])},[]),Ce=$.useCallback(()=>{P(Fe=>{const ze=!Fe;return ze&&setTimeout(()=>{f0.custom(Qe=>Q.jsxs("div",{className:"bg-[#FFF5F5] relative border-l-[6px] border-l-red-700 shadow-xl rounded-lg p-5 font-['Lato'] w-full max-w-[356px] pointer-events-auto flex flex-col gap-2 mx-auto",children:[Q.jsxs("div",{className:"flex justify-between items-start gap-3",children:[Q.jsx("div",{className:"text-red-700 uppercase font-black tracking-wider text-sm leading-tight",children:"The Invisible Ramparts"}),Q.jsx("button",{onClick:()=>f0.dismiss(Qe),className:"text-neutral-400 hover:text-neutral-600 transition-colors -mt-1 -mr-2 p-1","aria-label":"Close",children:Q.jsx(gg,{className:"h-4 w-4"})})]}),Q.jsx("div",{className:"text-neutral-700 leading-normal text-sm",children:"This dashed line traces the demolished fortifications of the Bombay Fort (removed 1862)."})]}),{id:"fort-wall-toast",duration:1/0,className:"!bg-transparent !border-0 !shadow-none !p-0 !pointer-events-auto flex justify-center w-full",unstyled:!0})},0),ze})},[]);return Q.jsxs("div",{className:`app-container ${c?"mode-1883":""}`,children:[Q.jsx(KO,{ref:e,selectedRecord:t,onSelectRecord:_e,currentYear:a,disabledCategories:g,is1883Mode:c,isFortWallVisible:E,is3DBuildingsVisible:k,onMapLoad:re},L),Q.jsx(Ej,{onSelectRecord:_e,disabledCategories:g,onToggle:ce,onSolo:De,onReset:Be,isFortWallVisible:E,onToggleFortWall:Ce}),Q.jsx(wu,{children:G&&Q.jsx(Yj,{currentYear:a,onChange:h,onClose:()=>Z(!1)})}),Q.jsx(C8,{onZoomIn:()=>{var Fe;return(Fe=e.current)==null?void 0:Fe.zoomIn()},onZoomOut:()=>{var Fe;return(Fe=e.current)==null?void 0:Fe.zoomOut()},onResetNorth:()=>{var Fe;return(Fe=e.current)==null?void 0:Fe.resetNorth()},onToggleTime:()=>Z(!G),isTimeActive:G,is1883Mode:c,onToggle1883:()=>S(!c),is3DVisible:k,onToggle3D:()=>I(!k),onResetView:()=>{var Fe;return(Fe=e.current)==null?void 0:Fe.resetView()},onLocate:()=>{var Fe;return(Fe=e.current)==null?void 0:Fe.locate()}}),Q.jsx(wu,{children:t&&Q.jsx(qO,{selectedRecord:t,onClose:le},"side-panel")}),Q.jsx(E8,{visible:H,onDismiss:pe}),Q.jsx(P8,{position:"bottom-center"})]})}function A8(){return Q.jsx(XO,{defaultTheme:"light",storageKey:"kala-ghoda-theme",children:Q.jsx(I8,{})})}lC(document.getElementById("root")).render(Q.jsx($.StrictMode,{children:Q.jsx(A8,{})}));
