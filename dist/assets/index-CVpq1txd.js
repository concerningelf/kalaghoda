(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))u(g);new MutationObserver(g=>{for(const x of g)if(x.type==="childList")for(const v of x.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&u(v)}).observe(document,{childList:!0,subtree:!0});function o(g){const x={};return g.integrity&&(x.integrity=g.integrity),g.referrerPolicy&&(x.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?x.credentials="include":g.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function u(g){if(g.ep)return;g.ep=!0;const x=o(g);fetch(g.href,x)}})();var kC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function CC(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ow={exports:{}},xf={},jw={exports:{}},Et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qh=Symbol.for("react.element"),PC=Symbol.for("react.portal"),IC=Symbol.for("react.fragment"),AC=Symbol.for("react.strict_mode"),MC=Symbol.for("react.profiler"),EC=Symbol.for("react.provider"),zC=Symbol.for("react.context"),DC=Symbol.for("react.forward_ref"),LC=Symbol.for("react.suspense"),RC=Symbol.for("react.memo"),BC=Symbol.for("react.lazy"),m0=Symbol.iterator;function FC(e){return e===null||typeof e!="object"?null:(e=m0&&e[m0]||e["@@iterator"],typeof e=="function"?e:null)}var Vw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nw=Object.assign,Uw={};function Bc(e,n,o){this.props=e,this.context=n,this.refs=Uw,this.updater=o||Vw}Bc.prototype.isReactComponent={};Bc.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Bc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $w(){}$w.prototype=Bc.prototype;function s_(e,n,o){this.props=e,this.context=n,this.refs=Uw,this.updater=o||Vw}var a_=s_.prototype=new $w;a_.constructor=s_;Nw(a_,Bc.prototype);a_.isPureReactComponent=!0;var g0=Array.isArray,Gw=Object.prototype.hasOwnProperty,o_={current:null},Hw={key:!0,ref:!0,__self:!0,__source:!0};function qw(e,n,o){var u,g={},x=null,v=null;if(n!=null)for(u in n.ref!==void 0&&(v=n.ref),n.key!==void 0&&(x=""+n.key),n)Gw.call(n,u)&&!Hw.hasOwnProperty(u)&&(g[u]=n[u]);var c=arguments.length-2;if(c===1)g.children=o;else if(1<c){for(var A=Array(c),D=0;D<c;D++)A[D]=arguments[D+2];g.children=A}if(e&&e.defaultProps)for(u in c=e.defaultProps,c)g[u]===void 0&&(g[u]=c[u]);return{$$typeof:qh,type:e,key:x,ref:v,props:g,_owner:o_.current}}function OC(e,n){return{$$typeof:qh,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function l_(e){return typeof e=="object"&&e!==null&&e.$$typeof===qh}function jC(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return n[o]})}var y0=/\/+/g;function tg(e,n){return typeof e=="object"&&e!==null&&e.key!=null?jC(""+e.key):n.toString(36)}function Pp(e,n,o,u,g){var x=typeof e;(x==="undefined"||x==="boolean")&&(e=null);var v=!1;if(e===null)v=!0;else switch(x){case"string":case"number":v=!0;break;case"object":switch(e.$$typeof){case qh:case PC:v=!0}}if(v)return v=e,g=g(v),e=u===""?"."+tg(v,0):u,g0(g)?(o="",e!=null&&(o=e.replace(y0,"$&/")+"/"),Pp(g,n,o,"",function(D){return D})):g!=null&&(l_(g)&&(g=OC(g,o+(!g.key||v&&v.key===g.key?"":(""+g.key).replace(y0,"$&/")+"/")+e)),n.push(g)),1;if(v=0,u=u===""?".":u+":",g0(e))for(var c=0;c<e.length;c++){x=e[c];var A=u+tg(x,c);v+=Pp(x,n,o,A,g)}else if(A=FC(e),typeof A=="function")for(e=A.call(e),c=0;!(x=e.next()).done;)x=x.value,A=u+tg(x,c++),v+=Pp(x,n,o,A,g);else if(x==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return v}function np(e,n,o){if(e==null)return e;var u=[],g=0;return Pp(e,u,"","",function(x){return n.call(o,x,g++)}),u}function VC(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var jn={current:null},Ip={transition:null},NC={ReactCurrentDispatcher:jn,ReactCurrentBatchConfig:Ip,ReactCurrentOwner:o_};function Zw(){throw Error("act(...) is not supported in production builds of React.")}Et.Children={map:np,forEach:function(e,n,o){np(e,function(){n.apply(this,arguments)},o)},count:function(e){var n=0;return np(e,function(){n++}),n},toArray:function(e){return np(e,function(n){return n})||[]},only:function(e){if(!l_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Et.Component=Bc;Et.Fragment=IC;Et.Profiler=MC;Et.PureComponent=s_;Et.StrictMode=AC;Et.Suspense=LC;Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NC;Et.act=Zw;Et.cloneElement=function(e,n,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var u=Nw({},e.props),g=e.key,x=e.ref,v=e._owner;if(n!=null){if(n.ref!==void 0&&(x=n.ref,v=o_.current),n.key!==void 0&&(g=""+n.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(A in n)Gw.call(n,A)&&!Hw.hasOwnProperty(A)&&(u[A]=n[A]===void 0&&c!==void 0?c[A]:n[A])}var A=arguments.length-2;if(A===1)u.children=o;else if(1<A){c=Array(A);for(var D=0;D<A;D++)c[D]=arguments[D+2];u.children=c}return{$$typeof:qh,type:e.type,key:g,ref:x,props:u,_owner:v}};Et.createContext=function(e){return e={$$typeof:zC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:EC,_context:e},e.Consumer=e};Et.createElement=qw;Et.createFactory=function(e){var n=qw.bind(null,e);return n.type=e,n};Et.createRef=function(){return{current:null}};Et.forwardRef=function(e){return{$$typeof:DC,render:e}};Et.isValidElement=l_;Et.lazy=function(e){return{$$typeof:BC,_payload:{_status:-1,_result:e},_init:VC}};Et.memo=function(e,n){return{$$typeof:RC,type:e,compare:n===void 0?null:n}};Et.startTransition=function(e){var n=Ip.transition;Ip.transition={};try{e()}finally{Ip.transition=n}};Et.unstable_act=Zw;Et.useCallback=function(e,n){return jn.current.useCallback(e,n)};Et.useContext=function(e){return jn.current.useContext(e)};Et.useDebugValue=function(){};Et.useDeferredValue=function(e){return jn.current.useDeferredValue(e)};Et.useEffect=function(e,n){return jn.current.useEffect(e,n)};Et.useId=function(){return jn.current.useId()};Et.useImperativeHandle=function(e,n,o){return jn.current.useImperativeHandle(e,n,o)};Et.useInsertionEffect=function(e,n){return jn.current.useInsertionEffect(e,n)};Et.useLayoutEffect=function(e,n){return jn.current.useLayoutEffect(e,n)};Et.useMemo=function(e,n){return jn.current.useMemo(e,n)};Et.useReducer=function(e,n,o){return jn.current.useReducer(e,n,o)};Et.useRef=function(e){return jn.current.useRef(e)};Et.useState=function(e){return jn.current.useState(e)};Et.useSyncExternalStore=function(e,n,o){return jn.current.useSyncExternalStore(e,n,o)};Et.useTransition=function(){return jn.current.useTransition()};Et.version="18.3.1";jw.exports=Et;var De=jw.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UC=De,$C=Symbol.for("react.element"),GC=Symbol.for("react.fragment"),HC=Object.prototype.hasOwnProperty,qC=UC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZC={key:!0,ref:!0,__self:!0,__source:!0};function Ww(e,n,o){var u,g={},x=null,v=null;o!==void 0&&(x=""+o),n.key!==void 0&&(x=""+n.key),n.ref!==void 0&&(v=n.ref);for(u in n)HC.call(n,u)&&!ZC.hasOwnProperty(u)&&(g[u]=n[u]);if(e&&e.defaultProps)for(u in n=e.defaultProps,n)g[u]===void 0&&(g[u]=n[u]);return{$$typeof:$C,type:e,key:x,ref:v,props:g,_owner:qC.current}}xf.Fragment=GC;xf.jsx=Ww;xf.jsxs=Ww;Ow.exports=xf;var _e=Ow.exports,Xw={exports:{}},wr={},Kw={exports:{}},Yw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(Ge,ut){var dt=Ge.length;Ge.push(ut);e:for(;0<dt;){var Ct=dt-1>>>1,jt=Ge[Ct];if(0<g(jt,ut))Ge[Ct]=ut,Ge[dt]=jt,dt=Ct;else break e}}function o(Ge){return Ge.length===0?null:Ge[0]}function u(Ge){if(Ge.length===0)return null;var ut=Ge[0],dt=Ge.pop();if(dt!==ut){Ge[0]=dt;e:for(var Ct=0,jt=Ge.length,ir=jt>>>1;Ct<ir;){var Ni=2*(Ct+1)-1,un=Ge[Ni],hn=Ni+1,Pi=Ge[hn];if(0>g(un,dt))hn<jt&&0>g(Pi,un)?(Ge[Ct]=Pi,Ge[hn]=dt,Ct=hn):(Ge[Ct]=un,Ge[Ni]=dt,Ct=Ni);else if(hn<jt&&0>g(Pi,dt))Ge[Ct]=Pi,Ge[hn]=dt,Ct=hn;else break e}}return ut}function g(Ge,ut){var dt=Ge.sortIndex-ut.sortIndex;return dt!==0?dt:Ge.id-ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;e.unstable_now=function(){return x.now()}}else{var v=Date,c=v.now();e.unstable_now=function(){return v.now()-c}}var A=[],D=[],V=1,L=null,B=3,se=!1,ce=!1,ge=!1,Ce=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function W(Ge){for(var ut=o(D);ut!==null;){if(ut.callback===null)u(D);else if(ut.startTime<=Ge)u(D),ut.sortIndex=ut.expirationTime,n(A,ut);else break;ut=o(D)}}function ve(Ge){if(ge=!1,W(Ge),!ce)if(o(A)!==null)ce=!0,tr(Se);else{var ut=o(D);ut!==null&&Bt(ve,ut.startTime-Ge)}}function Se(Ge,ut){ce=!1,ge&&(ge=!1,X(Me),Me=-1),se=!0;var dt=B;try{for(W(ut),L=o(A);L!==null&&(!(L.expirationTime>ut)||Ge&&!pt());){var Ct=L.callback;if(typeof Ct=="function"){L.callback=null,B=L.priorityLevel;var jt=Ct(L.expirationTime<=ut);ut=e.unstable_now(),typeof jt=="function"?L.callback=jt:L===o(A)&&u(A),W(ut)}else u(A);L=o(A)}if(L!==null)var ir=!0;else{var Ni=o(D);Ni!==null&&Bt(ve,Ni.startTime-ut),ir=!1}return ir}finally{L=null,B=dt,se=!1}}var ke=!1,Ae=null,Me=-1,ot=5,at=-1;function pt(){return!(e.unstable_now()-at<ot)}function Vi(){if(Ae!==null){var Ge=e.unstable_now();at=Ge;var ut=!0;try{ut=Ae(!0,Ge)}finally{ut?Xt():(ke=!1,Ae=null)}}else ke=!1}var Xt;if(typeof Z=="function")Xt=function(){Z(Vi)};else if(typeof MessageChannel<"u"){var pi=new MessageChannel,cn=pi.port2;pi.port1.onmessage=Vi,Xt=function(){cn.postMessage(null)}}else Xt=function(){Ce(Vi,0)};function tr(Ge){Ae=Ge,ke||(ke=!0,Xt())}function Bt(Ge,ut){Me=Ce(function(){Ge(e.unstable_now())},ut)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ge){Ge.callback=null},e.unstable_continueExecution=function(){ce||se||(ce=!0,tr(Se))},e.unstable_forceFrameRate=function(Ge){0>Ge||125<Ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ot=0<Ge?Math.floor(1e3/Ge):5},e.unstable_getCurrentPriorityLevel=function(){return B},e.unstable_getFirstCallbackNode=function(){return o(A)},e.unstable_next=function(Ge){switch(B){case 1:case 2:case 3:var ut=3;break;default:ut=B}var dt=B;B=ut;try{return Ge()}finally{B=dt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ge,ut){switch(Ge){case 1:case 2:case 3:case 4:case 5:break;default:Ge=3}var dt=B;B=Ge;try{return ut()}finally{B=dt}},e.unstable_scheduleCallback=function(Ge,ut,dt){var Ct=e.unstable_now();switch(typeof dt=="object"&&dt!==null?(dt=dt.delay,dt=typeof dt=="number"&&0<dt?Ct+dt:Ct):dt=Ct,Ge){case 1:var jt=-1;break;case 2:jt=250;break;case 5:jt=1073741823;break;case 4:jt=1e4;break;default:jt=5e3}return jt=dt+jt,Ge={id:V++,callback:ut,priorityLevel:Ge,startTime:dt,expirationTime:jt,sortIndex:-1},dt>Ct?(Ge.sortIndex=dt,n(D,Ge),o(A)===null&&Ge===o(D)&&(ge?(X(Me),Me=-1):ge=!0,Bt(ve,dt-Ct))):(Ge.sortIndex=jt,n(A,Ge),ce||se||(ce=!0,tr(Se))),Ge},e.unstable_shouldYield=pt,e.unstable_wrapCallback=function(Ge){var ut=B;return function(){var dt=B;B=ut;try{return Ge.apply(this,arguments)}finally{B=dt}}}})(Yw);Kw.exports=Yw;var WC=Kw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XC=De,xr=WC;function Be(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jw=new Set,Th={};function al(e,n){Pc(e,n),Pc(e+"Capture",n)}function Pc(e,n){for(Th[e]=n,e=0;e<n.length;e++)Jw.add(n[e])}var Js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hg=Object.prototype.hasOwnProperty,KC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_0={},v0={};function YC(e){return Hg.call(v0,e)?!0:Hg.call(_0,e)?!1:KC.test(e)?v0[e]=!0:(_0[e]=!0,!1)}function JC(e,n,o,u){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return u?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function QC(e,n,o,u){if(n===null||typeof n>"u"||JC(e,n,o,u))return!0;if(u)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Vn(e,n,o,u,g,x,v){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=u,this.attributeNamespace=g,this.mustUseProperty=o,this.propertyName=e,this.type=n,this.sanitizeURL=x,this.removeEmptyString=v}var ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ln[e]=new Vn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];ln[n]=new Vn(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ln[e]=new Vn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ln[e]=new Vn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ln[e]=new Vn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ln[e]=new Vn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ln[e]=new Vn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ln[e]=new Vn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ln[e]=new Vn(e,5,!1,e.toLowerCase(),null,!1,!1)});var c_=/[\-:]([a-z])/g;function u_(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(c_,u_);ln[n]=new Vn(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(c_,u_);ln[n]=new Vn(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(c_,u_);ln[n]=new Vn(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ln[e]=new Vn(e,1,!1,e.toLowerCase(),null,!1,!1)});ln.xlinkHref=new Vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ln[e]=new Vn(e,1,!1,e.toLowerCase(),null,!0,!0)});function h_(e,n,o,u){var g=ln.hasOwnProperty(n)?ln[n]:null;(g!==null?g.type!==0:u||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(QC(n,o,g,u)&&(o=null),u||g===null?YC(n)&&(o===null?e.removeAttribute(n):e.setAttribute(n,""+o)):g.mustUseProperty?e[g.propertyName]=o===null?g.type===3?!1:"":o:(n=g.attributeName,u=g.attributeNamespace,o===null?e.removeAttribute(n):(g=g.type,o=g===3||g===4&&o===!0?"":""+o,u?e.setAttributeNS(u,n,o):e.setAttribute(n,o))))}var na=XC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rp=Symbol.for("react.element"),nc=Symbol.for("react.portal"),rc=Symbol.for("react.fragment"),d_=Symbol.for("react.strict_mode"),qg=Symbol.for("react.profiler"),Qw=Symbol.for("react.provider"),eb=Symbol.for("react.context"),p_=Symbol.for("react.forward_ref"),Zg=Symbol.for("react.suspense"),Wg=Symbol.for("react.suspense_list"),f_=Symbol.for("react.memo"),Na=Symbol.for("react.lazy"),tb=Symbol.for("react.offscreen"),x0=Symbol.iterator;function Ku(e){return e===null||typeof e!="object"?null:(e=x0&&e[x0]||e["@@iterator"],typeof e=="function"?e:null)}var vi=Object.assign,ig;function sh(e){if(ig===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);ig=n&&n[1]||""}return`
`+ig+e}var ng=!1;function rg(e,n){if(!e||ng)return"";ng=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(D){var u=D}Reflect.construct(e,[],n)}else{try{n.call()}catch(D){u=D}e.call(n.prototype)}else{try{throw Error()}catch(D){u=D}e()}}catch(D){if(D&&u&&typeof D.stack=="string"){for(var g=D.stack.split(`
`),x=u.stack.split(`
`),v=g.length-1,c=x.length-1;1<=v&&0<=c&&g[v]!==x[c];)c--;for(;1<=v&&0<=c;v--,c--)if(g[v]!==x[c]){if(v!==1||c!==1)do if(v--,c--,0>c||g[v]!==x[c]){var A=`
`+g[v].replace(" at new "," at ");return e.displayName&&A.includes("<anonymous>")&&(A=A.replace("<anonymous>",e.displayName)),A}while(1<=v&&0<=c);break}}}finally{ng=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?sh(e):""}function eP(e){switch(e.tag){case 5:return sh(e.type);case 16:return sh("Lazy");case 13:return sh("Suspense");case 19:return sh("SuspenseList");case 0:case 2:case 15:return e=rg(e.type,!1),e;case 11:return e=rg(e.type.render,!1),e;case 1:return e=rg(e.type,!0),e;default:return""}}function Xg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case rc:return"Fragment";case nc:return"Portal";case qg:return"Profiler";case d_:return"StrictMode";case Zg:return"Suspense";case Wg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case eb:return(e.displayName||"Context")+".Consumer";case Qw:return(e._context.displayName||"Context")+".Provider";case p_:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case f_:return n=e.displayName||null,n!==null?n:Xg(e.type)||"Memo";case Na:n=e._payload,e=e._init;try{return Xg(e(n))}catch{}}return null}function tP(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xg(n);case 8:return n===d_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function io(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ib(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function iP(e){var n=ib(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),u=""+e[n];if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var g=o.get,x=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return g.call(this)},set:function(v){u=""+v,x.call(this,v)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(v){u=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function sp(e){e._valueTracker||(e._valueTracker=iP(e))}function nb(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var o=n.getValue(),u="";return e&&(u=ib(e)?e.checked?"true":"false":e.value),e=u,e!==o?(n.setValue(e),!0):!1}function $p(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Kg(e,n){var o=n.checked;return vi({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function w0(e,n){var o=n.defaultValue==null?"":n.defaultValue,u=n.checked!=null?n.checked:n.defaultChecked;o=io(n.value!=null?n.value:o),e._wrapperState={initialChecked:u,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function rb(e,n){n=n.checked,n!=null&&h_(e,"checked",n,!1)}function Yg(e,n){rb(e,n);var o=io(n.value),u=n.type;if(o!=null)u==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Jg(e,n.type,o):n.hasOwnProperty("defaultValue")&&Jg(e,n.type,io(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function b0(e,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var u=n.type;if(!(u!=="submit"&&u!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,o||n===e.value||(e.value=n),e.defaultValue=n}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function Jg(e,n,o){(n!=="number"||$p(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var ah=Array.isArray;function vc(e,n,o,u){if(e=e.options,n){n={};for(var g=0;g<o.length;g++)n["$"+o[g]]=!0;for(o=0;o<e.length;o++)g=n.hasOwnProperty("$"+e[o].value),e[o].selected!==g&&(e[o].selected=g),g&&u&&(e[o].defaultSelected=!0)}else{for(o=""+io(o),n=null,g=0;g<e.length;g++){if(e[g].value===o){e[g].selected=!0,u&&(e[g].defaultSelected=!0);return}n!==null||e[g].disabled||(n=e[g])}n!==null&&(n.selected=!0)}}function Qg(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(Be(91));return vi({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function S0(e,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(Be(92));if(ah(o)){if(1<o.length)throw Error(Be(93));o=o[0]}n=o}n==null&&(n=""),o=n}e._wrapperState={initialValue:io(o)}}function sb(e,n){var o=io(n.value),u=io(n.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),n.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),u!=null&&(e.defaultValue=""+u)}function T0(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function ab(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ey(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?ab(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ap,ob=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,u,g){MSApp.execUnsafeLocalFunction(function(){return e(n,o,u,g)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(ap=ap||document.createElement("div"),ap.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=ap.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function kh(e,n){if(n){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=n;return}}e.textContent=n}var hh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nP=["Webkit","ms","Moz","O"];Object.keys(hh).forEach(function(e){nP.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),hh[n]=hh[e]})});function lb(e,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||hh.hasOwnProperty(e)&&hh[e]?(""+n).trim():n+"px"}function cb(e,n){e=e.style;for(var o in n)if(n.hasOwnProperty(o)){var u=o.indexOf("--")===0,g=lb(o,n[o],u);o==="float"&&(o="cssFloat"),u?e.setProperty(o,g):e[o]=g}}var rP=vi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ty(e,n){if(n){if(rP[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(Be(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(Be(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(Be(61))}if(n.style!=null&&typeof n.style!="object")throw Error(Be(62))}}function iy(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ny=null;function m_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ry=null,xc=null,wc=null;function k0(e){if(e=Xh(e)){if(typeof ry!="function")throw Error(Be(280));var n=e.stateNode;n&&(n=kf(n),ry(e.stateNode,e.type,n))}}function ub(e){xc?wc?wc.push(e):wc=[e]:xc=e}function hb(){if(xc){var e=xc,n=wc;if(wc=xc=null,k0(e),n)for(e=0;e<n.length;e++)k0(n[e])}}function db(e,n){return e(n)}function pb(){}var sg=!1;function fb(e,n,o){if(sg)return e(n,o);sg=!0;try{return db(e,n,o)}finally{sg=!1,(xc!==null||wc!==null)&&(pb(),hb())}}function Ch(e,n){var o=e.stateNode;if(o===null)return null;var u=kf(o);if(u===null)return null;o=u[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(Be(231,n,typeof o));return o}var sy=!1;if(Js)try{var Yu={};Object.defineProperty(Yu,"passive",{get:function(){sy=!0}}),window.addEventListener("test",Yu,Yu),window.removeEventListener("test",Yu,Yu)}catch{sy=!1}function sP(e,n,o,u,g,x,v,c,A){var D=Array.prototype.slice.call(arguments,3);try{n.apply(o,D)}catch(V){this.onError(V)}}var dh=!1,Gp=null,Hp=!1,ay=null,aP={onError:function(e){dh=!0,Gp=e}};function oP(e,n,o,u,g,x,v,c,A){dh=!1,Gp=null,sP.apply(aP,arguments)}function lP(e,n,o,u,g,x,v,c,A){if(oP.apply(this,arguments),dh){if(dh){var D=Gp;dh=!1,Gp=null}else throw Error(Be(198));Hp||(Hp=!0,ay=D)}}function ol(e){var n=e,o=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(o=n.return),e=n.return;while(e)}return n.tag===3?o:null}function mb(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function C0(e){if(ol(e)!==e)throw Error(Be(188))}function cP(e){var n=e.alternate;if(!n){if(n=ol(e),n===null)throw Error(Be(188));return n!==e?null:e}for(var o=e,u=n;;){var g=o.return;if(g===null)break;var x=g.alternate;if(x===null){if(u=g.return,u!==null){o=u;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===o)return C0(g),e;if(x===u)return C0(g),n;x=x.sibling}throw Error(Be(188))}if(o.return!==u.return)o=g,u=x;else{for(var v=!1,c=g.child;c;){if(c===o){v=!0,o=g,u=x;break}if(c===u){v=!0,u=g,o=x;break}c=c.sibling}if(!v){for(c=x.child;c;){if(c===o){v=!0,o=x,u=g;break}if(c===u){v=!0,u=x,o=g;break}c=c.sibling}if(!v)throw Error(Be(189))}}if(o.alternate!==u)throw Error(Be(190))}if(o.tag!==3)throw Error(Be(188));return o.stateNode.current===o?e:n}function gb(e){return e=cP(e),e!==null?yb(e):null}function yb(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=yb(e);if(n!==null)return n;e=e.sibling}return null}var _b=xr.unstable_scheduleCallback,P0=xr.unstable_cancelCallback,uP=xr.unstable_shouldYield,hP=xr.unstable_requestPaint,Ci=xr.unstable_now,dP=xr.unstable_getCurrentPriorityLevel,g_=xr.unstable_ImmediatePriority,vb=xr.unstable_UserBlockingPriority,qp=xr.unstable_NormalPriority,pP=xr.unstable_LowPriority,xb=xr.unstable_IdlePriority,wf=null,bs=null;function fP(e){if(bs&&typeof bs.onCommitFiberRoot=="function")try{bs.onCommitFiberRoot(wf,e,void 0,(e.current.flags&128)===128)}catch{}}var is=Math.clz32?Math.clz32:yP,mP=Math.log,gP=Math.LN2;function yP(e){return e>>>=0,e===0?32:31-(mP(e)/gP|0)|0}var op=64,lp=4194304;function oh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zp(e,n){var o=e.pendingLanes;if(o===0)return 0;var u=0,g=e.suspendedLanes,x=e.pingedLanes,v=o&268435455;if(v!==0){var c=v&~g;c!==0?u=oh(c):(x&=v,x!==0&&(u=oh(x)))}else v=o&~g,v!==0?u=oh(v):x!==0&&(u=oh(x));if(u===0)return 0;if(n!==0&&n!==u&&!(n&g)&&(g=u&-u,x=n&-n,g>=x||g===16&&(x&4194240)!==0))return n;if(u&4&&(u|=o&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=u;0<n;)o=31-is(n),g=1<<o,u|=e[o],n&=~g;return u}function _P(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vP(e,n){for(var o=e.suspendedLanes,u=e.pingedLanes,g=e.expirationTimes,x=e.pendingLanes;0<x;){var v=31-is(x),c=1<<v,A=g[v];A===-1?(!(c&o)||c&u)&&(g[v]=_P(c,n)):A<=n&&(e.expiredLanes|=c),x&=~c}}function oy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wb(){var e=op;return op<<=1,!(op&4194240)&&(op=64),e}function ag(e){for(var n=[],o=0;31>o;o++)n.push(e);return n}function Zh(e,n,o){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-is(n),e[n]=o}function xP(e,n){var o=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<o;){var g=31-is(o),x=1<<g;n[g]=0,u[g]=-1,e[g]=-1,o&=~x}}function y_(e,n){var o=e.entangledLanes|=n;for(e=e.entanglements;o;){var u=31-is(o),g=1<<u;g&n|e[u]&n&&(e[u]|=n),o&=~g}}var Wt=0;function bb(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Sb,__,Tb,kb,Cb,ly=!1,cp=[],Wa=null,Xa=null,Ka=null,Ph=new Map,Ih=new Map,$a=[],wP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function I0(e,n){switch(e){case"focusin":case"focusout":Wa=null;break;case"dragenter":case"dragleave":Xa=null;break;case"mouseover":case"mouseout":Ka=null;break;case"pointerover":case"pointerout":Ph.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ih.delete(n.pointerId)}}function Ju(e,n,o,u,g,x){return e===null||e.nativeEvent!==x?(e={blockedOn:n,domEventName:o,eventSystemFlags:u,nativeEvent:x,targetContainers:[g]},n!==null&&(n=Xh(n),n!==null&&__(n)),e):(e.eventSystemFlags|=u,n=e.targetContainers,g!==null&&n.indexOf(g)===-1&&n.push(g),e)}function bP(e,n,o,u,g){switch(n){case"focusin":return Wa=Ju(Wa,e,n,o,u,g),!0;case"dragenter":return Xa=Ju(Xa,e,n,o,u,g),!0;case"mouseover":return Ka=Ju(Ka,e,n,o,u,g),!0;case"pointerover":var x=g.pointerId;return Ph.set(x,Ju(Ph.get(x)||null,e,n,o,u,g)),!0;case"gotpointercapture":return x=g.pointerId,Ih.set(x,Ju(Ih.get(x)||null,e,n,o,u,g)),!0}return!1}function Pb(e){var n=Zo(e.target);if(n!==null){var o=ol(n);if(o!==null){if(n=o.tag,n===13){if(n=mb(o),n!==null){e.blockedOn=n,Cb(e.priority,function(){Tb(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ap(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var o=cy(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var u=new o.constructor(o.type,o);ny=u,o.target.dispatchEvent(u),ny=null}else return n=Xh(o),n!==null&&__(n),e.blockedOn=o,!1;n.shift()}return!0}function A0(e,n,o){Ap(e)&&o.delete(n)}function SP(){ly=!1,Wa!==null&&Ap(Wa)&&(Wa=null),Xa!==null&&Ap(Xa)&&(Xa=null),Ka!==null&&Ap(Ka)&&(Ka=null),Ph.forEach(A0),Ih.forEach(A0)}function Qu(e,n){e.blockedOn===n&&(e.blockedOn=null,ly||(ly=!0,xr.unstable_scheduleCallback(xr.unstable_NormalPriority,SP)))}function Ah(e){function n(g){return Qu(g,e)}if(0<cp.length){Qu(cp[0],e);for(var o=1;o<cp.length;o++){var u=cp[o];u.blockedOn===e&&(u.blockedOn=null)}}for(Wa!==null&&Qu(Wa,e),Xa!==null&&Qu(Xa,e),Ka!==null&&Qu(Ka,e),Ph.forEach(n),Ih.forEach(n),o=0;o<$a.length;o++)u=$a[o],u.blockedOn===e&&(u.blockedOn=null);for(;0<$a.length&&(o=$a[0],o.blockedOn===null);)Pb(o),o.blockedOn===null&&$a.shift()}var bc=na.ReactCurrentBatchConfig,Wp=!0;function TP(e,n,o,u){var g=Wt,x=bc.transition;bc.transition=null;try{Wt=1,v_(e,n,o,u)}finally{Wt=g,bc.transition=x}}function kP(e,n,o,u){var g=Wt,x=bc.transition;bc.transition=null;try{Wt=4,v_(e,n,o,u)}finally{Wt=g,bc.transition=x}}function v_(e,n,o,u){if(Wp){var g=cy(e,n,o,u);if(g===null)gg(e,n,u,Xp,o),I0(e,u);else if(bP(g,e,n,o,u))u.stopPropagation();else if(I0(e,u),n&4&&-1<wP.indexOf(e)){for(;g!==null;){var x=Xh(g);if(x!==null&&Sb(x),x=cy(e,n,o,u),x===null&&gg(e,n,u,Xp,o),x===g)break;g=x}g!==null&&u.stopPropagation()}else gg(e,n,u,null,o)}}var Xp=null;function cy(e,n,o,u){if(Xp=null,e=m_(u),e=Zo(e),e!==null)if(n=ol(e),n===null)e=null;else if(o=n.tag,o===13){if(e=mb(n),e!==null)return e;e=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Xp=e,null}function Ib(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dP()){case g_:return 1;case vb:return 4;case qp:case pP:return 16;case xb:return 536870912;default:return 16}default:return 16}}var Ha=null,x_=null,Mp=null;function Ab(){if(Mp)return Mp;var e,n=x_,o=n.length,u,g="value"in Ha?Ha.value:Ha.textContent,x=g.length;for(e=0;e<o&&n[e]===g[e];e++);var v=o-e;for(u=1;u<=v&&n[o-u]===g[x-u];u++);return Mp=g.slice(e,1<u?1-u:void 0)}function Ep(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function up(){return!0}function M0(){return!1}function br(e){function n(o,u,g,x,v){this._reactName=o,this._targetInst=g,this.type=u,this.nativeEvent=x,this.target=v,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(o=e[c],this[c]=o?o(x):x[c]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?up:M0,this.isPropagationStopped=M0,this}return vi(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=up)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=up)},persist:function(){},isPersistent:up}),n}var Fc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},w_=br(Fc),Wh=vi({},Fc,{view:0,detail:0}),CP=br(Wh),og,lg,eh,bf=vi({},Wh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:b_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==eh&&(eh&&e.type==="mousemove"?(og=e.screenX-eh.screenX,lg=e.screenY-eh.screenY):lg=og=0,eh=e),og)},movementY:function(e){return"movementY"in e?e.movementY:lg}}),E0=br(bf),PP=vi({},bf,{dataTransfer:0}),IP=br(PP),AP=vi({},Wh,{relatedTarget:0}),cg=br(AP),MP=vi({},Fc,{animationName:0,elapsedTime:0,pseudoElement:0}),EP=br(MP),zP=vi({},Fc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),DP=br(zP),LP=vi({},Fc,{data:0}),z0=br(LP),RP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OP(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=FP[e])?!!n[e]:!1}function b_(){return OP}var jP=vi({},Wh,{key:function(e){if(e.key){var n=RP[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Ep(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?BP[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:b_,charCode:function(e){return e.type==="keypress"?Ep(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ep(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),VP=br(jP),NP=vi({},bf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D0=br(NP),UP=vi({},Wh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:b_}),$P=br(UP),GP=vi({},Fc,{propertyName:0,elapsedTime:0,pseudoElement:0}),HP=br(GP),qP=vi({},bf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ZP=br(qP),WP=[9,13,27,32],S_=Js&&"CompositionEvent"in window,ph=null;Js&&"documentMode"in document&&(ph=document.documentMode);var XP=Js&&"TextEvent"in window&&!ph,Mb=Js&&(!S_||ph&&8<ph&&11>=ph),L0=" ",R0=!1;function Eb(e,n){switch(e){case"keyup":return WP.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sc=!1;function KP(e,n){switch(e){case"compositionend":return zb(n);case"keypress":return n.which!==32?null:(R0=!0,L0);case"textInput":return e=n.data,e===L0&&R0?null:e;default:return null}}function YP(e,n){if(sc)return e==="compositionend"||!S_&&Eb(e,n)?(e=Ab(),Mp=x_=Ha=null,sc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Mb&&n.locale!=="ko"?null:n.data;default:return null}}var JP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function B0(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!JP[e.type]:n==="textarea"}function Db(e,n,o,u){ub(u),n=Kp(n,"onChange"),0<n.length&&(o=new w_("onChange","change",null,o,u),e.push({event:o,listeners:n}))}var fh=null,Mh=null;function QP(e){Gb(e,0)}function Sf(e){var n=lc(e);if(nb(n))return e}function eI(e,n){if(e==="change")return n}var Lb=!1;if(Js){var ug;if(Js){var hg="oninput"in document;if(!hg){var F0=document.createElement("div");F0.setAttribute("oninput","return;"),hg=typeof F0.oninput=="function"}ug=hg}else ug=!1;Lb=ug&&(!document.documentMode||9<document.documentMode)}function O0(){fh&&(fh.detachEvent("onpropertychange",Rb),Mh=fh=null)}function Rb(e){if(e.propertyName==="value"&&Sf(Mh)){var n=[];Db(n,Mh,e,m_(e)),fb(QP,n)}}function tI(e,n,o){e==="focusin"?(O0(),fh=n,Mh=o,fh.attachEvent("onpropertychange",Rb)):e==="focusout"&&O0()}function iI(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Sf(Mh)}function nI(e,n){if(e==="click")return Sf(n)}function rI(e,n){if(e==="input"||e==="change")return Sf(n)}function sI(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var rs=typeof Object.is=="function"?Object.is:sI;function Eh(e,n){if(rs(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var o=Object.keys(e),u=Object.keys(n);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var g=o[u];if(!Hg.call(n,g)||!rs(e[g],n[g]))return!1}return!0}function j0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function V0(e,n){var o=j0(e);e=0;for(var u;o;){if(o.nodeType===3){if(u=e+o.textContent.length,e<=n&&u>=n)return{node:o,offset:n-e};e=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=j0(o)}}function Bb(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Bb(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Fb(){for(var e=window,n=$p();n instanceof e.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)e=n.contentWindow;else break;n=$p(e.document)}return n}function T_(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function aI(e){var n=Fb(),o=e.focusedElem,u=e.selectionRange;if(n!==o&&o&&o.ownerDocument&&Bb(o.ownerDocument.documentElement,o)){if(u!==null&&T_(o)){if(n=u.start,e=u.end,e===void 0&&(e=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(e,o.value.length);else if(e=(n=o.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var g=o.textContent.length,x=Math.min(u.start,g);u=u.end===void 0?x:Math.min(u.end,g),!e.extend&&x>u&&(g=u,u=x,x=g),g=V0(o,x);var v=V0(o,u);g&&v&&(e.rangeCount!==1||e.anchorNode!==g.node||e.anchorOffset!==g.offset||e.focusNode!==v.node||e.focusOffset!==v.offset)&&(n=n.createRange(),n.setStart(g.node,g.offset),e.removeAllRanges(),x>u?(e.addRange(n),e.extend(v.node,v.offset)):(n.setEnd(v.node,v.offset),e.addRange(n)))}}for(n=[],e=o;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)e=n[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var oI=Js&&"documentMode"in document&&11>=document.documentMode,ac=null,uy=null,mh=null,hy=!1;function N0(e,n,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;hy||ac==null||ac!==$p(u)||(u=ac,"selectionStart"in u&&T_(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),mh&&Eh(mh,u)||(mh=u,u=Kp(uy,"onSelect"),0<u.length&&(n=new w_("onSelect","select",null,n,o),e.push({event:n,listeners:u}),n.target=ac)))}function hp(e,n){var o={};return o[e.toLowerCase()]=n.toLowerCase(),o["Webkit"+e]="webkit"+n,o["Moz"+e]="moz"+n,o}var oc={animationend:hp("Animation","AnimationEnd"),animationiteration:hp("Animation","AnimationIteration"),animationstart:hp("Animation","AnimationStart"),transitionend:hp("Transition","TransitionEnd")},dg={},Ob={};Js&&(Ob=document.createElement("div").style,"AnimationEvent"in window||(delete oc.animationend.animation,delete oc.animationiteration.animation,delete oc.animationstart.animation),"TransitionEvent"in window||delete oc.transitionend.transition);function Tf(e){if(dg[e])return dg[e];if(!oc[e])return e;var n=oc[e],o;for(o in n)if(n.hasOwnProperty(o)&&o in Ob)return dg[e]=n[o];return e}var jb=Tf("animationend"),Vb=Tf("animationiteration"),Nb=Tf("animationstart"),Ub=Tf("transitionend"),$b=new Map,U0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ao(e,n){$b.set(e,n),al(n,[e])}for(var pg=0;pg<U0.length;pg++){var fg=U0[pg],lI=fg.toLowerCase(),cI=fg[0].toUpperCase()+fg.slice(1);ao(lI,"on"+cI)}ao(jb,"onAnimationEnd");ao(Vb,"onAnimationIteration");ao(Nb,"onAnimationStart");ao("dblclick","onDoubleClick");ao("focusin","onFocus");ao("focusout","onBlur");ao(Ub,"onTransitionEnd");Pc("onMouseEnter",["mouseout","mouseover"]);Pc("onMouseLeave",["mouseout","mouseover"]);Pc("onPointerEnter",["pointerout","pointerover"]);Pc("onPointerLeave",["pointerout","pointerover"]);al("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));al("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));al("onBeforeInput",["compositionend","keypress","textInput","paste"]);al("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));al("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));al("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uI=new Set("cancel close invalid load scroll toggle".split(" ").concat(lh));function $0(e,n,o){var u=e.type||"unknown-event";e.currentTarget=o,lP(u,n,void 0,e),e.currentTarget=null}function Gb(e,n){n=(n&4)!==0;for(var o=0;o<e.length;o++){var u=e[o],g=u.event;u=u.listeners;e:{var x=void 0;if(n)for(var v=u.length-1;0<=v;v--){var c=u[v],A=c.instance,D=c.currentTarget;if(c=c.listener,A!==x&&g.isPropagationStopped())break e;$0(g,c,D),x=A}else for(v=0;v<u.length;v++){if(c=u[v],A=c.instance,D=c.currentTarget,c=c.listener,A!==x&&g.isPropagationStopped())break e;$0(g,c,D),x=A}}}if(Hp)throw e=ay,Hp=!1,ay=null,e}function ai(e,n){var o=n[gy];o===void 0&&(o=n[gy]=new Set);var u=e+"__bubble";o.has(u)||(Hb(n,e,2,!1),o.add(u))}function mg(e,n,o){var u=0;n&&(u|=4),Hb(o,e,u,n)}var dp="_reactListening"+Math.random().toString(36).slice(2);function zh(e){if(!e[dp]){e[dp]=!0,Jw.forEach(function(o){o!=="selectionchange"&&(uI.has(o)||mg(o,!1,e),mg(o,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[dp]||(n[dp]=!0,mg("selectionchange",!1,n))}}function Hb(e,n,o,u){switch(Ib(n)){case 1:var g=TP;break;case 4:g=kP;break;default:g=v_}o=g.bind(null,n,o,e),g=void 0,!sy||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(g=!0),u?g!==void 0?e.addEventListener(n,o,{capture:!0,passive:g}):e.addEventListener(n,o,!0):g!==void 0?e.addEventListener(n,o,{passive:g}):e.addEventListener(n,o,!1)}function gg(e,n,o,u,g){var x=u;if(!(n&1)&&!(n&2)&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var c=u.stateNode.containerInfo;if(c===g||c.nodeType===8&&c.parentNode===g)break;if(v===4)for(v=u.return;v!==null;){var A=v.tag;if((A===3||A===4)&&(A=v.stateNode.containerInfo,A===g||A.nodeType===8&&A.parentNode===g))return;v=v.return}for(;c!==null;){if(v=Zo(c),v===null)return;if(A=v.tag,A===5||A===6){u=x=v;continue e}c=c.parentNode}}u=u.return}fb(function(){var D=x,V=m_(o),L=[];e:{var B=$b.get(e);if(B!==void 0){var se=w_,ce=e;switch(e){case"keypress":if(Ep(o)===0)break e;case"keydown":case"keyup":se=VP;break;case"focusin":ce="focus",se=cg;break;case"focusout":ce="blur",se=cg;break;case"beforeblur":case"afterblur":se=cg;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=E0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=IP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=$P;break;case jb:case Vb:case Nb:se=EP;break;case Ub:se=HP;break;case"scroll":se=CP;break;case"wheel":se=ZP;break;case"copy":case"cut":case"paste":se=DP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=D0}var ge=(n&4)!==0,Ce=!ge&&e==="scroll",X=ge?B!==null?B+"Capture":null:B;ge=[];for(var Z=D,W;Z!==null;){W=Z;var ve=W.stateNode;if(W.tag===5&&ve!==null&&(W=ve,X!==null&&(ve=Ch(Z,X),ve!=null&&ge.push(Dh(Z,ve,W)))),Ce)break;Z=Z.return}0<ge.length&&(B=new se(B,ce,null,o,V),L.push({event:B,listeners:ge}))}}if(!(n&7)){e:{if(B=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",B&&o!==ny&&(ce=o.relatedTarget||o.fromElement)&&(Zo(ce)||ce[Qs]))break e;if((se||B)&&(B=V.window===V?V:(B=V.ownerDocument)?B.defaultView||B.parentWindow:window,se?(ce=o.relatedTarget||o.toElement,se=D,ce=ce?Zo(ce):null,ce!==null&&(Ce=ol(ce),ce!==Ce||ce.tag!==5&&ce.tag!==6)&&(ce=null)):(se=null,ce=D),se!==ce)){if(ge=E0,ve="onMouseLeave",X="onMouseEnter",Z="mouse",(e==="pointerout"||e==="pointerover")&&(ge=D0,ve="onPointerLeave",X="onPointerEnter",Z="pointer"),Ce=se==null?B:lc(se),W=ce==null?B:lc(ce),B=new ge(ve,Z+"leave",se,o,V),B.target=Ce,B.relatedTarget=W,ve=null,Zo(V)===D&&(ge=new ge(X,Z+"enter",ce,o,V),ge.target=W,ge.relatedTarget=Ce,ve=ge),Ce=ve,se&&ce)t:{for(ge=se,X=ce,Z=0,W=ge;W;W=ic(W))Z++;for(W=0,ve=X;ve;ve=ic(ve))W++;for(;0<Z-W;)ge=ic(ge),Z--;for(;0<W-Z;)X=ic(X),W--;for(;Z--;){if(ge===X||X!==null&&ge===X.alternate)break t;ge=ic(ge),X=ic(X)}ge=null}else ge=null;se!==null&&G0(L,B,se,ge,!1),ce!==null&&Ce!==null&&G0(L,Ce,ce,ge,!0)}}e:{if(B=D?lc(D):window,se=B.nodeName&&B.nodeName.toLowerCase(),se==="select"||se==="input"&&B.type==="file")var Se=eI;else if(B0(B))if(Lb)Se=rI;else{Se=iI;var ke=tI}else(se=B.nodeName)&&se.toLowerCase()==="input"&&(B.type==="checkbox"||B.type==="radio")&&(Se=nI);if(Se&&(Se=Se(e,D))){Db(L,Se,o,V);break e}ke&&ke(e,B,D),e==="focusout"&&(ke=B._wrapperState)&&ke.controlled&&B.type==="number"&&Jg(B,"number",B.value)}switch(ke=D?lc(D):window,e){case"focusin":(B0(ke)||ke.contentEditable==="true")&&(ac=ke,uy=D,mh=null);break;case"focusout":mh=uy=ac=null;break;case"mousedown":hy=!0;break;case"contextmenu":case"mouseup":case"dragend":hy=!1,N0(L,o,V);break;case"selectionchange":if(oI)break;case"keydown":case"keyup":N0(L,o,V)}var Ae;if(S_)e:{switch(e){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else sc?Eb(e,o)&&(Me="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Me="onCompositionStart");Me&&(Mb&&o.locale!=="ko"&&(sc||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&sc&&(Ae=Ab()):(Ha=V,x_="value"in Ha?Ha.value:Ha.textContent,sc=!0)),ke=Kp(D,Me),0<ke.length&&(Me=new z0(Me,e,null,o,V),L.push({event:Me,listeners:ke}),Ae?Me.data=Ae:(Ae=zb(o),Ae!==null&&(Me.data=Ae)))),(Ae=XP?KP(e,o):YP(e,o))&&(D=Kp(D,"onBeforeInput"),0<D.length&&(V=new z0("onBeforeInput","beforeinput",null,o,V),L.push({event:V,listeners:D}),V.data=Ae))}Gb(L,n)})}function Dh(e,n,o){return{instance:e,listener:n,currentTarget:o}}function Kp(e,n){for(var o=n+"Capture",u=[];e!==null;){var g=e,x=g.stateNode;g.tag===5&&x!==null&&(g=x,x=Ch(e,o),x!=null&&u.unshift(Dh(e,x,g)),x=Ch(e,n),x!=null&&u.push(Dh(e,x,g))),e=e.return}return u}function ic(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function G0(e,n,o,u,g){for(var x=n._reactName,v=[];o!==null&&o!==u;){var c=o,A=c.alternate,D=c.stateNode;if(A!==null&&A===u)break;c.tag===5&&D!==null&&(c=D,g?(A=Ch(o,x),A!=null&&v.unshift(Dh(o,A,c))):g||(A=Ch(o,x),A!=null&&v.push(Dh(o,A,c)))),o=o.return}v.length!==0&&e.push({event:n,listeners:v})}var hI=/\r\n?/g,dI=/\u0000|\uFFFD/g;function H0(e){return(typeof e=="string"?e:""+e).replace(hI,`
`).replace(dI,"")}function pp(e,n,o){if(n=H0(n),H0(e)!==n&&o)throw Error(Be(425))}function Yp(){}var dy=null,py=null;function fy(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var my=typeof setTimeout=="function"?setTimeout:void 0,pI=typeof clearTimeout=="function"?clearTimeout:void 0,q0=typeof Promise=="function"?Promise:void 0,fI=typeof queueMicrotask=="function"?queueMicrotask:typeof q0<"u"?function(e){return q0.resolve(null).then(e).catch(mI)}:my;function mI(e){setTimeout(function(){throw e})}function yg(e,n){var o=n,u=0;do{var g=o.nextSibling;if(e.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"){if(u===0){e.removeChild(g),Ah(n);return}u--}else o!=="$"&&o!=="$?"&&o!=="$!"||u++;o=g}while(o);Ah(n)}function Ya(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Z0(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return e;n--}else o==="/$"&&n++}e=e.previousSibling}return null}var Oc=Math.random().toString(36).slice(2),xs="__reactFiber$"+Oc,Lh="__reactProps$"+Oc,Qs="__reactContainer$"+Oc,gy="__reactEvents$"+Oc,gI="__reactListeners$"+Oc,yI="__reactHandles$"+Oc;function Zo(e){var n=e[xs];if(n)return n;for(var o=e.parentNode;o;){if(n=o[Qs]||o[xs]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(e=Z0(e);e!==null;){if(o=e[xs])return o;e=Z0(e)}return n}e=o,o=e.parentNode}return null}function Xh(e){return e=e[xs]||e[Qs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function lc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Be(33))}function kf(e){return e[Lh]||null}var yy=[],cc=-1;function oo(e){return{current:e}}function oi(e){0>cc||(e.current=yy[cc],yy[cc]=null,cc--)}function ii(e,n){cc++,yy[cc]=e.current,e.current=n}var no={},kn=oo(no),Jn=oo(!1),tl=no;function Ic(e,n){var o=e.type.contextTypes;if(!o)return no;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===n)return u.__reactInternalMemoizedMaskedChildContext;var g={},x;for(x in o)g[x]=n[x];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=g),g}function Qn(e){return e=e.childContextTypes,e!=null}function Jp(){oi(Jn),oi(kn)}function W0(e,n,o){if(kn.current!==no)throw Error(Be(168));ii(kn,n),ii(Jn,o)}function qb(e,n,o){var u=e.stateNode;if(n=n.childContextTypes,typeof u.getChildContext!="function")return o;u=u.getChildContext();for(var g in u)if(!(g in n))throw Error(Be(108,tP(e)||"Unknown",g));return vi({},o,u)}function Qp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||no,tl=kn.current,ii(kn,e),ii(Jn,Jn.current),!0}function X0(e,n,o){var u=e.stateNode;if(!u)throw Error(Be(169));o?(e=qb(e,n,tl),u.__reactInternalMemoizedMergedChildContext=e,oi(Jn),oi(kn),ii(kn,e)):oi(Jn),ii(Jn,o)}var Zs=null,Cf=!1,_g=!1;function Zb(e){Zs===null?Zs=[e]:Zs.push(e)}function _I(e){Cf=!0,Zb(e)}function lo(){if(!_g&&Zs!==null){_g=!0;var e=0,n=Wt;try{var o=Zs;for(Wt=1;e<o.length;e++){var u=o[e];do u=u(!0);while(u!==null)}Zs=null,Cf=!1}catch(g){throw Zs!==null&&(Zs=Zs.slice(e+1)),_b(g_,lo),g}finally{Wt=n,_g=!1}}return null}var uc=[],hc=0,ef=null,tf=0,Lr=[],Rr=0,il=null,Ws=1,Xs="";function Go(e,n){uc[hc++]=tf,uc[hc++]=ef,ef=e,tf=n}function Wb(e,n,o){Lr[Rr++]=Ws,Lr[Rr++]=Xs,Lr[Rr++]=il,il=e;var u=Ws;e=Xs;var g=32-is(u)-1;u&=~(1<<g),o+=1;var x=32-is(n)+g;if(30<x){var v=g-g%5;x=(u&(1<<v)-1).toString(32),u>>=v,g-=v,Ws=1<<32-is(n)+g|o<<g|u,Xs=x+e}else Ws=1<<x|o<<g|u,Xs=e}function k_(e){e.return!==null&&(Go(e,1),Wb(e,1,0))}function C_(e){for(;e===ef;)ef=uc[--hc],uc[hc]=null,tf=uc[--hc],uc[hc]=null;for(;e===il;)il=Lr[--Rr],Lr[Rr]=null,Xs=Lr[--Rr],Lr[Rr]=null,Ws=Lr[--Rr],Lr[Rr]=null}var vr=null,_r=null,di=!1,ts=null;function Xb(e,n){var o=Br(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=e,n=e.deletions,n===null?(e.deletions=[o],e.flags|=16):n.push(o)}function K0(e,n){switch(e.tag){case 5:var o=e.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,vr=e,_r=Ya(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,vr=e,_r=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=il!==null?{id:Ws,overflow:Xs}:null,e.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=Br(18,null,null,0),o.stateNode=n,o.return=e,e.child=o,vr=e,_r=null,!0):!1;default:return!1}}function _y(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vy(e){if(di){var n=_r;if(n){var o=n;if(!K0(e,n)){if(_y(e))throw Error(Be(418));n=Ya(o.nextSibling);var u=vr;n&&K0(e,n)?Xb(u,o):(e.flags=e.flags&-4097|2,di=!1,vr=e)}}else{if(_y(e))throw Error(Be(418));e.flags=e.flags&-4097|2,di=!1,vr=e}}}function Y0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vr=e}function fp(e){if(e!==vr)return!1;if(!di)return Y0(e),di=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!fy(e.type,e.memoizedProps)),n&&(n=_r)){if(_y(e))throw Kb(),Error(Be(418));for(;n;)Xb(e,n),n=Ya(n.nextSibling)}if(Y0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Be(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(n===0){_r=Ya(e.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}e=e.nextSibling}_r=null}}else _r=vr?Ya(e.stateNode.nextSibling):null;return!0}function Kb(){for(var e=_r;e;)e=Ya(e.nextSibling)}function Ac(){_r=vr=null,di=!1}function P_(e){ts===null?ts=[e]:ts.push(e)}var vI=na.ReactCurrentBatchConfig;function th(e,n,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(Be(309));var u=o.stateNode}if(!u)throw Error(Be(147,e));var g=u,x=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===x?n.ref:(n=function(v){var c=g.refs;v===null?delete c[x]:c[x]=v},n._stringRef=x,n)}if(typeof e!="string")throw Error(Be(284));if(!o._owner)throw Error(Be(290,e))}return e}function mp(e,n){throw e=Object.prototype.toString.call(n),Error(Be(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function J0(e){var n=e._init;return n(e._payload)}function Yb(e){function n(X,Z){if(e){var W=X.deletions;W===null?(X.deletions=[Z],X.flags|=16):W.push(Z)}}function o(X,Z){if(!e)return null;for(;Z!==null;)n(X,Z),Z=Z.sibling;return null}function u(X,Z){for(X=new Map;Z!==null;)Z.key!==null?X.set(Z.key,Z):X.set(Z.index,Z),Z=Z.sibling;return X}function g(X,Z){return X=to(X,Z),X.index=0,X.sibling=null,X}function x(X,Z,W){return X.index=W,e?(W=X.alternate,W!==null?(W=W.index,W<Z?(X.flags|=2,Z):W):(X.flags|=2,Z)):(X.flags|=1048576,Z)}function v(X){return e&&X.alternate===null&&(X.flags|=2),X}function c(X,Z,W,ve){return Z===null||Z.tag!==6?(Z=kg(W,X.mode,ve),Z.return=X,Z):(Z=g(Z,W),Z.return=X,Z)}function A(X,Z,W,ve){var Se=W.type;return Se===rc?V(X,Z,W.props.children,ve,W.key):Z!==null&&(Z.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===Na&&J0(Se)===Z.type)?(ve=g(Z,W.props),ve.ref=th(X,Z,W),ve.return=X,ve):(ve=Op(W.type,W.key,W.props,null,X.mode,ve),ve.ref=th(X,Z,W),ve.return=X,ve)}function D(X,Z,W,ve){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==W.containerInfo||Z.stateNode.implementation!==W.implementation?(Z=Cg(W,X.mode,ve),Z.return=X,Z):(Z=g(Z,W.children||[]),Z.return=X,Z)}function V(X,Z,W,ve,Se){return Z===null||Z.tag!==7?(Z=Qo(W,X.mode,ve,Se),Z.return=X,Z):(Z=g(Z,W),Z.return=X,Z)}function L(X,Z,W){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=kg(""+Z,X.mode,W),Z.return=X,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case rp:return W=Op(Z.type,Z.key,Z.props,null,X.mode,W),W.ref=th(X,null,Z),W.return=X,W;case nc:return Z=Cg(Z,X.mode,W),Z.return=X,Z;case Na:var ve=Z._init;return L(X,ve(Z._payload),W)}if(ah(Z)||Ku(Z))return Z=Qo(Z,X.mode,W,null),Z.return=X,Z;mp(X,Z)}return null}function B(X,Z,W,ve){var Se=Z!==null?Z.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return Se!==null?null:c(X,Z,""+W,ve);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case rp:return W.key===Se?A(X,Z,W,ve):null;case nc:return W.key===Se?D(X,Z,W,ve):null;case Na:return Se=W._init,B(X,Z,Se(W._payload),ve)}if(ah(W)||Ku(W))return Se!==null?null:V(X,Z,W,ve,null);mp(X,W)}return null}function se(X,Z,W,ve,Se){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return X=X.get(W)||null,c(Z,X,""+ve,Se);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case rp:return X=X.get(ve.key===null?W:ve.key)||null,A(Z,X,ve,Se);case nc:return X=X.get(ve.key===null?W:ve.key)||null,D(Z,X,ve,Se);case Na:var ke=ve._init;return se(X,Z,W,ke(ve._payload),Se)}if(ah(ve)||Ku(ve))return X=X.get(W)||null,V(Z,X,ve,Se,null);mp(Z,ve)}return null}function ce(X,Z,W,ve){for(var Se=null,ke=null,Ae=Z,Me=Z=0,ot=null;Ae!==null&&Me<W.length;Me++){Ae.index>Me?(ot=Ae,Ae=null):ot=Ae.sibling;var at=B(X,Ae,W[Me],ve);if(at===null){Ae===null&&(Ae=ot);break}e&&Ae&&at.alternate===null&&n(X,Ae),Z=x(at,Z,Me),ke===null?Se=at:ke.sibling=at,ke=at,Ae=ot}if(Me===W.length)return o(X,Ae),di&&Go(X,Me),Se;if(Ae===null){for(;Me<W.length;Me++)Ae=L(X,W[Me],ve),Ae!==null&&(Z=x(Ae,Z,Me),ke===null?Se=Ae:ke.sibling=Ae,ke=Ae);return di&&Go(X,Me),Se}for(Ae=u(X,Ae);Me<W.length;Me++)ot=se(Ae,X,Me,W[Me],ve),ot!==null&&(e&&ot.alternate!==null&&Ae.delete(ot.key===null?Me:ot.key),Z=x(ot,Z,Me),ke===null?Se=ot:ke.sibling=ot,ke=ot);return e&&Ae.forEach(function(pt){return n(X,pt)}),di&&Go(X,Me),Se}function ge(X,Z,W,ve){var Se=Ku(W);if(typeof Se!="function")throw Error(Be(150));if(W=Se.call(W),W==null)throw Error(Be(151));for(var ke=Se=null,Ae=Z,Me=Z=0,ot=null,at=W.next();Ae!==null&&!at.done;Me++,at=W.next()){Ae.index>Me?(ot=Ae,Ae=null):ot=Ae.sibling;var pt=B(X,Ae,at.value,ve);if(pt===null){Ae===null&&(Ae=ot);break}e&&Ae&&pt.alternate===null&&n(X,Ae),Z=x(pt,Z,Me),ke===null?Se=pt:ke.sibling=pt,ke=pt,Ae=ot}if(at.done)return o(X,Ae),di&&Go(X,Me),Se;if(Ae===null){for(;!at.done;Me++,at=W.next())at=L(X,at.value,ve),at!==null&&(Z=x(at,Z,Me),ke===null?Se=at:ke.sibling=at,ke=at);return di&&Go(X,Me),Se}for(Ae=u(X,Ae);!at.done;Me++,at=W.next())at=se(Ae,X,Me,at.value,ve),at!==null&&(e&&at.alternate!==null&&Ae.delete(at.key===null?Me:at.key),Z=x(at,Z,Me),ke===null?Se=at:ke.sibling=at,ke=at);return e&&Ae.forEach(function(Vi){return n(X,Vi)}),di&&Go(X,Me),Se}function Ce(X,Z,W,ve){if(typeof W=="object"&&W!==null&&W.type===rc&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case rp:e:{for(var Se=W.key,ke=Z;ke!==null;){if(ke.key===Se){if(Se=W.type,Se===rc){if(ke.tag===7){o(X,ke.sibling),Z=g(ke,W.props.children),Z.return=X,X=Z;break e}}else if(ke.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===Na&&J0(Se)===ke.type){o(X,ke.sibling),Z=g(ke,W.props),Z.ref=th(X,ke,W),Z.return=X,X=Z;break e}o(X,ke);break}else n(X,ke);ke=ke.sibling}W.type===rc?(Z=Qo(W.props.children,X.mode,ve,W.key),Z.return=X,X=Z):(ve=Op(W.type,W.key,W.props,null,X.mode,ve),ve.ref=th(X,Z,W),ve.return=X,X=ve)}return v(X);case nc:e:{for(ke=W.key;Z!==null;){if(Z.key===ke)if(Z.tag===4&&Z.stateNode.containerInfo===W.containerInfo&&Z.stateNode.implementation===W.implementation){o(X,Z.sibling),Z=g(Z,W.children||[]),Z.return=X,X=Z;break e}else{o(X,Z);break}else n(X,Z);Z=Z.sibling}Z=Cg(W,X.mode,ve),Z.return=X,X=Z}return v(X);case Na:return ke=W._init,Ce(X,Z,ke(W._payload),ve)}if(ah(W))return ce(X,Z,W,ve);if(Ku(W))return ge(X,Z,W,ve);mp(X,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,Z!==null&&Z.tag===6?(o(X,Z.sibling),Z=g(Z,W),Z.return=X,X=Z):(o(X,Z),Z=kg(W,X.mode,ve),Z.return=X,X=Z),v(X)):o(X,Z)}return Ce}var Mc=Yb(!0),Jb=Yb(!1),nf=oo(null),rf=null,dc=null,I_=null;function A_(){I_=dc=rf=null}function M_(e){var n=nf.current;oi(nf),e._currentValue=n}function xy(e,n,o){for(;e!==null;){var u=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,u!==null&&(u.childLanes|=n)):u!==null&&(u.childLanes&n)!==n&&(u.childLanes|=n),e===o)break;e=e.return}}function Sc(e,n){rf=e,I_=dc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(Yn=!0),e.firstContext=null)}function Vr(e){var n=e._currentValue;if(I_!==e)if(e={context:e,memoizedValue:n,next:null},dc===null){if(rf===null)throw Error(Be(308));dc=e,rf.dependencies={lanes:0,firstContext:e}}else dc=dc.next=e;return n}var Wo=null;function E_(e){Wo===null?Wo=[e]:Wo.push(e)}function Qb(e,n,o,u){var g=n.interleaved;return g===null?(o.next=o,E_(n)):(o.next=g.next,g.next=o),n.interleaved=o,ea(e,u)}function ea(e,n){e.lanes|=n;var o=e.alternate;for(o!==null&&(o.lanes|=n),o=e,e=e.return;e!==null;)e.childLanes|=n,o=e.alternate,o!==null&&(o.childLanes|=n),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Ua=!1;function z_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e2(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ks(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Ja(e,n,o){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,Ot&2){var g=u.pending;return g===null?n.next=n:(n.next=g.next,g.next=n),u.pending=n,ea(e,o)}return g=u.interleaved,g===null?(n.next=n,E_(u)):(n.next=g.next,g.next=n),u.interleaved=n,ea(e,o)}function zp(e,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var u=n.lanes;u&=e.pendingLanes,o|=u,n.lanes=o,y_(e,o)}}function Q0(e,n){var o=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var g=null,x=null;if(o=o.firstBaseUpdate,o!==null){do{var v={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};x===null?g=x=v:x=x.next=v,o=o.next}while(o!==null);x===null?g=x=n:x=x.next=n}else g=x=n;o={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:u.shared,effects:u.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=n:e.next=n,o.lastBaseUpdate=n}function sf(e,n,o,u){var g=e.updateQueue;Ua=!1;var x=g.firstBaseUpdate,v=g.lastBaseUpdate,c=g.shared.pending;if(c!==null){g.shared.pending=null;var A=c,D=A.next;A.next=null,v===null?x=D:v.next=D,v=A;var V=e.alternate;V!==null&&(V=V.updateQueue,c=V.lastBaseUpdate,c!==v&&(c===null?V.firstBaseUpdate=D:c.next=D,V.lastBaseUpdate=A))}if(x!==null){var L=g.baseState;v=0,V=D=A=null,c=x;do{var B=c.lane,se=c.eventTime;if((u&B)===B){V!==null&&(V=V.next={eventTime:se,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var ce=e,ge=c;switch(B=n,se=o,ge.tag){case 1:if(ce=ge.payload,typeof ce=="function"){L=ce.call(se,L,B);break e}L=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=ge.payload,B=typeof ce=="function"?ce.call(se,L,B):ce,B==null)break e;L=vi({},L,B);break e;case 2:Ua=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,B=g.effects,B===null?g.effects=[c]:B.push(c))}else se={eventTime:se,lane:B,tag:c.tag,payload:c.payload,callback:c.callback,next:null},V===null?(D=V=se,A=L):V=V.next=se,v|=B;if(c=c.next,c===null){if(c=g.shared.pending,c===null)break;B=c,c=B.next,B.next=null,g.lastBaseUpdate=B,g.shared.pending=null}}while(!0);if(V===null&&(A=L),g.baseState=A,g.firstBaseUpdate=D,g.lastBaseUpdate=V,n=g.shared.interleaved,n!==null){g=n;do v|=g.lane,g=g.next;while(g!==n)}else x===null&&(g.shared.lanes=0);rl|=v,e.lanes=v,e.memoizedState=L}}function e1(e,n,o){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var u=e[n],g=u.callback;if(g!==null){if(u.callback=null,u=o,typeof g!="function")throw Error(Be(191,g));g.call(u)}}}var Kh={},Ss=oo(Kh),Rh=oo(Kh),Bh=oo(Kh);function Xo(e){if(e===Kh)throw Error(Be(174));return e}function D_(e,n){switch(ii(Bh,n),ii(Rh,e),ii(Ss,Kh),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:ey(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=ey(n,e)}oi(Ss),ii(Ss,n)}function Ec(){oi(Ss),oi(Rh),oi(Bh)}function t2(e){Xo(Bh.current);var n=Xo(Ss.current),o=ey(n,e.type);n!==o&&(ii(Rh,e),ii(Ss,o))}function L_(e){Rh.current===e&&(oi(Ss),oi(Rh))}var gi=oo(0);function af(e){for(var n=e;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var vg=[];function R_(){for(var e=0;e<vg.length;e++)vg[e]._workInProgressVersionPrimary=null;vg.length=0}var Dp=na.ReactCurrentDispatcher,xg=na.ReactCurrentBatchConfig,nl=0,_i=null,Oi=null,Ki=null,of=!1,gh=!1,Fh=0,xI=0;function wn(){throw Error(Be(321))}function B_(e,n){if(n===null)return!1;for(var o=0;o<n.length&&o<e.length;o++)if(!rs(e[o],n[o]))return!1;return!0}function F_(e,n,o,u,g,x){if(nl=x,_i=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Dp.current=e===null||e.memoizedState===null?TI:kI,e=o(u,g),gh){x=0;do{if(gh=!1,Fh=0,25<=x)throw Error(Be(301));x+=1,Ki=Oi=null,n.updateQueue=null,Dp.current=CI,e=o(u,g)}while(gh)}if(Dp.current=lf,n=Oi!==null&&Oi.next!==null,nl=0,Ki=Oi=_i=null,of=!1,n)throw Error(Be(300));return e}function O_(){var e=Fh!==0;return Fh=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ki===null?_i.memoizedState=Ki=e:Ki=Ki.next=e,Ki}function Nr(){if(Oi===null){var e=_i.alternate;e=e!==null?e.memoizedState:null}else e=Oi.next;var n=Ki===null?_i.memoizedState:Ki.next;if(n!==null)Ki=n,Oi=e;else{if(e===null)throw Error(Be(310));Oi=e,e={memoizedState:Oi.memoizedState,baseState:Oi.baseState,baseQueue:Oi.baseQueue,queue:Oi.queue,next:null},Ki===null?_i.memoizedState=Ki=e:Ki=Ki.next=e}return Ki}function Oh(e,n){return typeof n=="function"?n(e):n}function wg(e){var n=Nr(),o=n.queue;if(o===null)throw Error(Be(311));o.lastRenderedReducer=e;var u=Oi,g=u.baseQueue,x=o.pending;if(x!==null){if(g!==null){var v=g.next;g.next=x.next,x.next=v}u.baseQueue=g=x,o.pending=null}if(g!==null){x=g.next,u=u.baseState;var c=v=null,A=null,D=x;do{var V=D.lane;if((nl&V)===V)A!==null&&(A=A.next={lane:0,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null}),u=D.hasEagerState?D.eagerState:e(u,D.action);else{var L={lane:V,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null};A===null?(c=A=L,v=u):A=A.next=L,_i.lanes|=V,rl|=V}D=D.next}while(D!==null&&D!==x);A===null?v=u:A.next=c,rs(u,n.memoizedState)||(Yn=!0),n.memoizedState=u,n.baseState=v,n.baseQueue=A,o.lastRenderedState=u}if(e=o.interleaved,e!==null){g=e;do x=g.lane,_i.lanes|=x,rl|=x,g=g.next;while(g!==e)}else g===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function bg(e){var n=Nr(),o=n.queue;if(o===null)throw Error(Be(311));o.lastRenderedReducer=e;var u=o.dispatch,g=o.pending,x=n.memoizedState;if(g!==null){o.pending=null;var v=g=g.next;do x=e(x,v.action),v=v.next;while(v!==g);rs(x,n.memoizedState)||(Yn=!0),n.memoizedState=x,n.baseQueue===null&&(n.baseState=x),o.lastRenderedState=x}return[x,u]}function i2(){}function n2(e,n){var o=_i,u=Nr(),g=n(),x=!rs(u.memoizedState,g);if(x&&(u.memoizedState=g,Yn=!0),u=u.queue,j_(a2.bind(null,o,u,e),[e]),u.getSnapshot!==n||x||Ki!==null&&Ki.memoizedState.tag&1){if(o.flags|=2048,jh(9,s2.bind(null,o,u,g,n),void 0,null),Yi===null)throw Error(Be(349));nl&30||r2(o,n,g)}return g}function r2(e,n,o){e.flags|=16384,e={getSnapshot:n,value:o},n=_i.updateQueue,n===null?(n={lastEffect:null,stores:null},_i.updateQueue=n,n.stores=[e]):(o=n.stores,o===null?n.stores=[e]:o.push(e))}function s2(e,n,o,u){n.value=o,n.getSnapshot=u,o2(n)&&l2(e)}function a2(e,n,o){return o(function(){o2(n)&&l2(e)})}function o2(e){var n=e.getSnapshot;e=e.value;try{var o=n();return!rs(e,o)}catch{return!0}}function l2(e){var n=ea(e,1);n!==null&&ns(n,e,1,-1)}function t1(e){var n=vs();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oh,lastRenderedState:e},n.queue=e,e=e.dispatch=SI.bind(null,_i,e),[n.memoizedState,e]}function jh(e,n,o,u){return e={tag:e,create:n,destroy:o,deps:u,next:null},n=_i.updateQueue,n===null?(n={lastEffect:null,stores:null},_i.updateQueue=n,n.lastEffect=e.next=e):(o=n.lastEffect,o===null?n.lastEffect=e.next=e:(u=o.next,o.next=e,e.next=u,n.lastEffect=e)),e}function c2(){return Nr().memoizedState}function Lp(e,n,o,u){var g=vs();_i.flags|=e,g.memoizedState=jh(1|n,o,void 0,u===void 0?null:u)}function Pf(e,n,o,u){var g=Nr();u=u===void 0?null:u;var x=void 0;if(Oi!==null){var v=Oi.memoizedState;if(x=v.destroy,u!==null&&B_(u,v.deps)){g.memoizedState=jh(n,o,x,u);return}}_i.flags|=e,g.memoizedState=jh(1|n,o,x,u)}function i1(e,n){return Lp(8390656,8,e,n)}function j_(e,n){return Pf(2048,8,e,n)}function u2(e,n){return Pf(4,2,e,n)}function h2(e,n){return Pf(4,4,e,n)}function d2(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function p2(e,n,o){return o=o!=null?o.concat([e]):null,Pf(4,4,d2.bind(null,n,e),o)}function V_(){}function f2(e,n){var o=Nr();n=n===void 0?null:n;var u=o.memoizedState;return u!==null&&n!==null&&B_(n,u[1])?u[0]:(o.memoizedState=[e,n],e)}function m2(e,n){var o=Nr();n=n===void 0?null:n;var u=o.memoizedState;return u!==null&&n!==null&&B_(n,u[1])?u[0]:(e=e(),o.memoizedState=[e,n],e)}function g2(e,n,o){return nl&21?(rs(o,n)||(o=wb(),_i.lanes|=o,rl|=o,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,Yn=!0),e.memoizedState=o)}function wI(e,n){var o=Wt;Wt=o!==0&&4>o?o:4,e(!0);var u=xg.transition;xg.transition={};try{e(!1),n()}finally{Wt=o,xg.transition=u}}function y2(){return Nr().memoizedState}function bI(e,n,o){var u=eo(e);if(o={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null},_2(e))v2(n,o);else if(o=Qb(e,n,o,u),o!==null){var g=On();ns(o,e,u,g),x2(o,n,u)}}function SI(e,n,o){var u=eo(e),g={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null};if(_2(e))v2(n,g);else{var x=e.alternate;if(e.lanes===0&&(x===null||x.lanes===0)&&(x=n.lastRenderedReducer,x!==null))try{var v=n.lastRenderedState,c=x(v,o);if(g.hasEagerState=!0,g.eagerState=c,rs(c,v)){var A=n.interleaved;A===null?(g.next=g,E_(n)):(g.next=A.next,A.next=g),n.interleaved=g;return}}catch{}finally{}o=Qb(e,n,g,u),o!==null&&(g=On(),ns(o,e,u,g),x2(o,n,u))}}function _2(e){var n=e.alternate;return e===_i||n!==null&&n===_i}function v2(e,n){gh=of=!0;var o=e.pending;o===null?n.next=n:(n.next=o.next,o.next=n),e.pending=n}function x2(e,n,o){if(o&4194240){var u=n.lanes;u&=e.pendingLanes,o|=u,n.lanes=o,y_(e,o)}}var lf={readContext:Vr,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useInsertionEffect:wn,useLayoutEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useMutableSource:wn,useSyncExternalStore:wn,useId:wn,unstable_isNewReconciler:!1},TI={readContext:Vr,useCallback:function(e,n){return vs().memoizedState=[e,n===void 0?null:n],e},useContext:Vr,useEffect:i1,useImperativeHandle:function(e,n,o){return o=o!=null?o.concat([e]):null,Lp(4194308,4,d2.bind(null,n,e),o)},useLayoutEffect:function(e,n){return Lp(4194308,4,e,n)},useInsertionEffect:function(e,n){return Lp(4,2,e,n)},useMemo:function(e,n){var o=vs();return n=n===void 0?null:n,e=e(),o.memoizedState=[e,n],e},useReducer:function(e,n,o){var u=vs();return n=o!==void 0?o(n):n,u.memoizedState=u.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},u.queue=e,e=e.dispatch=bI.bind(null,_i,e),[u.memoizedState,e]},useRef:function(e){var n=vs();return e={current:e},n.memoizedState=e},useState:t1,useDebugValue:V_,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=t1(!1),n=e[0];return e=wI.bind(null,e[1]),vs().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,o){var u=_i,g=vs();if(di){if(o===void 0)throw Error(Be(407));o=o()}else{if(o=n(),Yi===null)throw Error(Be(349));nl&30||r2(u,n,o)}g.memoizedState=o;var x={value:o,getSnapshot:n};return g.queue=x,i1(a2.bind(null,u,x,e),[e]),u.flags|=2048,jh(9,s2.bind(null,u,x,o,n),void 0,null),o},useId:function(){var e=vs(),n=Yi.identifierPrefix;if(di){var o=Xs,u=Ws;o=(u&~(1<<32-is(u)-1)).toString(32)+o,n=":"+n+"R"+o,o=Fh++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=xI++,n=":"+n+"r"+o.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},kI={readContext:Vr,useCallback:f2,useContext:Vr,useEffect:j_,useImperativeHandle:p2,useInsertionEffect:u2,useLayoutEffect:h2,useMemo:m2,useReducer:wg,useRef:c2,useState:function(){return wg(Oh)},useDebugValue:V_,useDeferredValue:function(e){var n=Nr();return g2(n,Oi.memoizedState,e)},useTransition:function(){var e=wg(Oh)[0],n=Nr().memoizedState;return[e,n]},useMutableSource:i2,useSyncExternalStore:n2,useId:y2,unstable_isNewReconciler:!1},CI={readContext:Vr,useCallback:f2,useContext:Vr,useEffect:j_,useImperativeHandle:p2,useInsertionEffect:u2,useLayoutEffect:h2,useMemo:m2,useReducer:bg,useRef:c2,useState:function(){return bg(Oh)},useDebugValue:V_,useDeferredValue:function(e){var n=Nr();return Oi===null?n.memoizedState=e:g2(n,Oi.memoizedState,e)},useTransition:function(){var e=bg(Oh)[0],n=Nr().memoizedState;return[e,n]},useMutableSource:i2,useSyncExternalStore:n2,useId:y2,unstable_isNewReconciler:!1};function Qr(e,n){if(e&&e.defaultProps){n=vi({},n),e=e.defaultProps;for(var o in e)n[o]===void 0&&(n[o]=e[o]);return n}return n}function wy(e,n,o,u){n=e.memoizedState,o=o(u,n),o=o==null?n:vi({},n,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var If={isMounted:function(e){return(e=e._reactInternals)?ol(e)===e:!1},enqueueSetState:function(e,n,o){e=e._reactInternals;var u=On(),g=eo(e),x=Ks(u,g);x.payload=n,o!=null&&(x.callback=o),n=Ja(e,x,g),n!==null&&(ns(n,e,g,u),zp(n,e,g))},enqueueReplaceState:function(e,n,o){e=e._reactInternals;var u=On(),g=eo(e),x=Ks(u,g);x.tag=1,x.payload=n,o!=null&&(x.callback=o),n=Ja(e,x,g),n!==null&&(ns(n,e,g,u),zp(n,e,g))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var o=On(),u=eo(e),g=Ks(o,u);g.tag=2,n!=null&&(g.callback=n),n=Ja(e,g,u),n!==null&&(ns(n,e,u,o),zp(n,e,u))}};function n1(e,n,o,u,g,x,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,x,v):n.prototype&&n.prototype.isPureReactComponent?!Eh(o,u)||!Eh(g,x):!0}function w2(e,n,o){var u=!1,g=no,x=n.contextType;return typeof x=="object"&&x!==null?x=Vr(x):(g=Qn(n)?tl:kn.current,u=n.contextTypes,x=(u=u!=null)?Ic(e,g):no),n=new n(o,x),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=If,e.stateNode=n,n._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=g,e.__reactInternalMemoizedMaskedChildContext=x),n}function r1(e,n,o,u){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,u),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,u),n.state!==e&&If.enqueueReplaceState(n,n.state,null)}function by(e,n,o,u){var g=e.stateNode;g.props=o,g.state=e.memoizedState,g.refs={},z_(e);var x=n.contextType;typeof x=="object"&&x!==null?g.context=Vr(x):(x=Qn(n)?tl:kn.current,g.context=Ic(e,x)),g.state=e.memoizedState,x=n.getDerivedStateFromProps,typeof x=="function"&&(wy(e,n,x,o),g.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(n=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),n!==g.state&&If.enqueueReplaceState(g,g.state,null),sf(e,o,g,u),g.state=e.memoizedState),typeof g.componentDidMount=="function"&&(e.flags|=4194308)}function zc(e,n){try{var o="",u=n;do o+=eP(u),u=u.return;while(u);var g=o}catch(x){g=`
Error generating stack: `+x.message+`
`+x.stack}return{value:e,source:n,stack:g,digest:null}}function Sg(e,n,o){return{value:e,source:null,stack:o??null,digest:n??null}}function Sy(e,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var PI=typeof WeakMap=="function"?WeakMap:Map;function b2(e,n,o){o=Ks(-1,o),o.tag=3,o.payload={element:null};var u=n.value;return o.callback=function(){uf||(uf=!0,Dy=u),Sy(e,n)},o}function S2(e,n,o){o=Ks(-1,o),o.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var g=n.value;o.payload=function(){return u(g)},o.callback=function(){Sy(e,n)}}var x=e.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(o.callback=function(){Sy(e,n),typeof u!="function"&&(Qa===null?Qa=new Set([this]):Qa.add(this));var v=n.stack;this.componentDidCatch(n.value,{componentStack:v!==null?v:""})}),o}function s1(e,n,o){var u=e.pingCache;if(u===null){u=e.pingCache=new PI;var g=new Set;u.set(n,g)}else g=u.get(n),g===void 0&&(g=new Set,u.set(n,g));g.has(o)||(g.add(o),e=NI.bind(null,e,n,o),n.then(e,e))}function a1(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function o1(e,n,o,u,g){return e.mode&1?(e.flags|=65536,e.lanes=g,e):(e===n?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=Ks(-1,1),n.tag=2,Ja(o,n,1))),o.lanes|=1),e)}var II=na.ReactCurrentOwner,Yn=!1;function Ln(e,n,o,u){n.child=e===null?Jb(n,null,o,u):Mc(n,e.child,o,u)}function l1(e,n,o,u,g){o=o.render;var x=n.ref;return Sc(n,g),u=F_(e,n,o,u,x,g),o=O_(),e!==null&&!Yn?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~g,ta(e,n,g)):(di&&o&&k_(n),n.flags|=1,Ln(e,n,u,g),n.child)}function c1(e,n,o,u,g){if(e===null){var x=o.type;return typeof x=="function"&&!W_(x)&&x.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=x,T2(e,n,x,u,g)):(e=Op(o.type,null,u,n,n.mode,g),e.ref=n.ref,e.return=n,n.child=e)}if(x=e.child,!(e.lanes&g)){var v=x.memoizedProps;if(o=o.compare,o=o!==null?o:Eh,o(v,u)&&e.ref===n.ref)return ta(e,n,g)}return n.flags|=1,e=to(x,u),e.ref=n.ref,e.return=n,n.child=e}function T2(e,n,o,u,g){if(e!==null){var x=e.memoizedProps;if(Eh(x,u)&&e.ref===n.ref)if(Yn=!1,n.pendingProps=u=x,(e.lanes&g)!==0)e.flags&131072&&(Yn=!0);else return n.lanes=e.lanes,ta(e,n,g)}return Ty(e,n,o,u,g)}function k2(e,n,o){var u=n.pendingProps,g=u.children,x=e!==null?e.memoizedState:null;if(u.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},ii(fc,yr),yr|=o;else{if(!(o&1073741824))return e=x!==null?x.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,ii(fc,yr),yr|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=x!==null?x.baseLanes:o,ii(fc,yr),yr|=u}else x!==null?(u=x.baseLanes|o,n.memoizedState=null):u=o,ii(fc,yr),yr|=u;return Ln(e,n,g,o),n.child}function C2(e,n){var o=n.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function Ty(e,n,o,u,g){var x=Qn(o)?tl:kn.current;return x=Ic(n,x),Sc(n,g),o=F_(e,n,o,u,x,g),u=O_(),e!==null&&!Yn?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~g,ta(e,n,g)):(di&&u&&k_(n),n.flags|=1,Ln(e,n,o,g),n.child)}function u1(e,n,o,u,g){if(Qn(o)){var x=!0;Qp(n)}else x=!1;if(Sc(n,g),n.stateNode===null)Rp(e,n),w2(n,o,u),by(n,o,u,g),u=!0;else if(e===null){var v=n.stateNode,c=n.memoizedProps;v.props=c;var A=v.context,D=o.contextType;typeof D=="object"&&D!==null?D=Vr(D):(D=Qn(o)?tl:kn.current,D=Ic(n,D));var V=o.getDerivedStateFromProps,L=typeof V=="function"||typeof v.getSnapshotBeforeUpdate=="function";L||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==u||A!==D)&&r1(n,v,u,D),Ua=!1;var B=n.memoizedState;v.state=B,sf(n,u,v,g),A=n.memoizedState,c!==u||B!==A||Jn.current||Ua?(typeof V=="function"&&(wy(n,o,V,u),A=n.memoizedState),(c=Ua||n1(n,o,c,u,B,A,D))?(L||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(n.flags|=4194308)):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=u,n.memoizedState=A),v.props=u,v.state=A,v.context=D,u=c):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),u=!1)}else{v=n.stateNode,e2(e,n),c=n.memoizedProps,D=n.type===n.elementType?c:Qr(n.type,c),v.props=D,L=n.pendingProps,B=v.context,A=o.contextType,typeof A=="object"&&A!==null?A=Vr(A):(A=Qn(o)?tl:kn.current,A=Ic(n,A));var se=o.getDerivedStateFromProps;(V=typeof se=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==L||B!==A)&&r1(n,v,u,A),Ua=!1,B=n.memoizedState,v.state=B,sf(n,u,v,g);var ce=n.memoizedState;c!==L||B!==ce||Jn.current||Ua?(typeof se=="function"&&(wy(n,o,se,u),ce=n.memoizedState),(D=Ua||n1(n,o,D,u,B,ce,A)||!1)?(V||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,ce,A),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,ce,A)),typeof v.componentDidUpdate=="function"&&(n.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof v.componentDidUpdate!="function"||c===e.memoizedProps&&B===e.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&B===e.memoizedState||(n.flags|=1024),n.memoizedProps=u,n.memoizedState=ce),v.props=u,v.state=ce,v.context=A,u=D):(typeof v.componentDidUpdate!="function"||c===e.memoizedProps&&B===e.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&B===e.memoizedState||(n.flags|=1024),u=!1)}return ky(e,n,o,u,x,g)}function ky(e,n,o,u,g,x){C2(e,n);var v=(n.flags&128)!==0;if(!u&&!v)return g&&X0(n,o,!1),ta(e,n,x);u=n.stateNode,II.current=n;var c=v&&typeof o.getDerivedStateFromError!="function"?null:u.render();return n.flags|=1,e!==null&&v?(n.child=Mc(n,e.child,null,x),n.child=Mc(n,null,c,x)):Ln(e,n,c,x),n.memoizedState=u.state,g&&X0(n,o,!0),n.child}function P2(e){var n=e.stateNode;n.pendingContext?W0(e,n.pendingContext,n.pendingContext!==n.context):n.context&&W0(e,n.context,!1),D_(e,n.containerInfo)}function h1(e,n,o,u,g){return Ac(),P_(g),n.flags|=256,Ln(e,n,o,u),n.child}var Cy={dehydrated:null,treeContext:null,retryLane:0};function Py(e){return{baseLanes:e,cachePool:null,transitions:null}}function I2(e,n,o){var u=n.pendingProps,g=gi.current,x=!1,v=(n.flags&128)!==0,c;if((c=v)||(c=e!==null&&e.memoizedState===null?!1:(g&2)!==0),c?(x=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(g|=1),ii(gi,g&1),e===null)return vy(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(v=u.children,e=u.fallback,x?(u=n.mode,x=n.child,v={mode:"hidden",children:v},!(u&1)&&x!==null?(x.childLanes=0,x.pendingProps=v):x=Ef(v,u,0,null),e=Qo(e,u,o,null),x.return=n,e.return=n,x.sibling=e,n.child=x,n.child.memoizedState=Py(o),n.memoizedState=Cy,e):N_(n,v));if(g=e.memoizedState,g!==null&&(c=g.dehydrated,c!==null))return AI(e,n,v,u,c,g,o);if(x){x=u.fallback,v=n.mode,g=e.child,c=g.sibling;var A={mode:"hidden",children:u.children};return!(v&1)&&n.child!==g?(u=n.child,u.childLanes=0,u.pendingProps=A,n.deletions=null):(u=to(g,A),u.subtreeFlags=g.subtreeFlags&14680064),c!==null?x=to(c,x):(x=Qo(x,v,o,null),x.flags|=2),x.return=n,u.return=n,u.sibling=x,n.child=u,u=x,x=n.child,v=e.child.memoizedState,v=v===null?Py(o):{baseLanes:v.baseLanes|o,cachePool:null,transitions:v.transitions},x.memoizedState=v,x.childLanes=e.childLanes&~o,n.memoizedState=Cy,u}return x=e.child,e=x.sibling,u=to(x,{mode:"visible",children:u.children}),!(n.mode&1)&&(u.lanes=o),u.return=n,u.sibling=null,e!==null&&(o=n.deletions,o===null?(n.deletions=[e],n.flags|=16):o.push(e)),n.child=u,n.memoizedState=null,u}function N_(e,n){return n=Ef({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function gp(e,n,o,u){return u!==null&&P_(u),Mc(n,e.child,null,o),e=N_(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function AI(e,n,o,u,g,x,v){if(o)return n.flags&256?(n.flags&=-257,u=Sg(Error(Be(422))),gp(e,n,v,u)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(x=u.fallback,g=n.mode,u=Ef({mode:"visible",children:u.children},g,0,null),x=Qo(x,g,v,null),x.flags|=2,u.return=n,x.return=n,u.sibling=x,n.child=u,n.mode&1&&Mc(n,e.child,null,v),n.child.memoizedState=Py(v),n.memoizedState=Cy,x);if(!(n.mode&1))return gp(e,n,v,null);if(g.data==="$!"){if(u=g.nextSibling&&g.nextSibling.dataset,u)var c=u.dgst;return u=c,x=Error(Be(419)),u=Sg(x,u,void 0),gp(e,n,v,u)}if(c=(v&e.childLanes)!==0,Yn||c){if(u=Yi,u!==null){switch(v&-v){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(u.suspendedLanes|v)?0:g,g!==0&&g!==x.retryLane&&(x.retryLane=g,ea(e,g),ns(u,e,g,-1))}return Z_(),u=Sg(Error(Be(421))),gp(e,n,v,u)}return g.data==="$?"?(n.flags|=128,n.child=e.child,n=UI.bind(null,e),g._reactRetry=n,null):(e=x.treeContext,_r=Ya(g.nextSibling),vr=n,di=!0,ts=null,e!==null&&(Lr[Rr++]=Ws,Lr[Rr++]=Xs,Lr[Rr++]=il,Ws=e.id,Xs=e.overflow,il=n),n=N_(n,u.children),n.flags|=4096,n)}function d1(e,n,o){e.lanes|=n;var u=e.alternate;u!==null&&(u.lanes|=n),xy(e.return,n,o)}function Tg(e,n,o,u,g){var x=e.memoizedState;x===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:g}:(x.isBackwards=n,x.rendering=null,x.renderingStartTime=0,x.last=u,x.tail=o,x.tailMode=g)}function A2(e,n,o){var u=n.pendingProps,g=u.revealOrder,x=u.tail;if(Ln(e,n,u.children,o),u=gi.current,u&2)u=u&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&d1(e,o,n);else if(e.tag===19)d1(e,o,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(ii(gi,u),!(n.mode&1))n.memoizedState=null;else switch(g){case"forwards":for(o=n.child,g=null;o!==null;)e=o.alternate,e!==null&&af(e)===null&&(g=o),o=o.sibling;o=g,o===null?(g=n.child,n.child=null):(g=o.sibling,o.sibling=null),Tg(n,!1,g,o,x);break;case"backwards":for(o=null,g=n.child,n.child=null;g!==null;){if(e=g.alternate,e!==null&&af(e)===null){n.child=g;break}e=g.sibling,g.sibling=o,o=g,g=e}Tg(n,!0,o,null,x);break;case"together":Tg(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Rp(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function ta(e,n,o){if(e!==null&&(n.dependencies=e.dependencies),rl|=n.lanes,!(o&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(Be(153));if(n.child!==null){for(e=n.child,o=to(e,e.pendingProps),n.child=o,o.return=n;e.sibling!==null;)e=e.sibling,o=o.sibling=to(e,e.pendingProps),o.return=n;o.sibling=null}return n.child}function MI(e,n,o){switch(n.tag){case 3:P2(n),Ac();break;case 5:t2(n);break;case 1:Qn(n.type)&&Qp(n);break;case 4:D_(n,n.stateNode.containerInfo);break;case 10:var u=n.type._context,g=n.memoizedProps.value;ii(nf,u._currentValue),u._currentValue=g;break;case 13:if(u=n.memoizedState,u!==null)return u.dehydrated!==null?(ii(gi,gi.current&1),n.flags|=128,null):o&n.child.childLanes?I2(e,n,o):(ii(gi,gi.current&1),e=ta(e,n,o),e!==null?e.sibling:null);ii(gi,gi.current&1);break;case 19:if(u=(o&n.childLanes)!==0,e.flags&128){if(u)return A2(e,n,o);n.flags|=128}if(g=n.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ii(gi,gi.current),u)break;return null;case 22:case 23:return n.lanes=0,k2(e,n,o)}return ta(e,n,o)}var M2,Iy,E2,z2;M2=function(e,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Iy=function(){};E2=function(e,n,o,u){var g=e.memoizedProps;if(g!==u){e=n.stateNode,Xo(Ss.current);var x=null;switch(o){case"input":g=Kg(e,g),u=Kg(e,u),x=[];break;case"select":g=vi({},g,{value:void 0}),u=vi({},u,{value:void 0}),x=[];break;case"textarea":g=Qg(e,g),u=Qg(e,u),x=[];break;default:typeof g.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=Yp)}ty(o,u);var v;o=null;for(D in g)if(!u.hasOwnProperty(D)&&g.hasOwnProperty(D)&&g[D]!=null)if(D==="style"){var c=g[D];for(v in c)c.hasOwnProperty(v)&&(o||(o={}),o[v]="")}else D!=="dangerouslySetInnerHTML"&&D!=="children"&&D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(Th.hasOwnProperty(D)?x||(x=[]):(x=x||[]).push(D,null));for(D in u){var A=u[D];if(c=g!=null?g[D]:void 0,u.hasOwnProperty(D)&&A!==c&&(A!=null||c!=null))if(D==="style")if(c){for(v in c)!c.hasOwnProperty(v)||A&&A.hasOwnProperty(v)||(o||(o={}),o[v]="");for(v in A)A.hasOwnProperty(v)&&c[v]!==A[v]&&(o||(o={}),o[v]=A[v])}else o||(x||(x=[]),x.push(D,o)),o=A;else D==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,c=c?c.__html:void 0,A!=null&&c!==A&&(x=x||[]).push(D,A)):D==="children"?typeof A!="string"&&typeof A!="number"||(x=x||[]).push(D,""+A):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&(Th.hasOwnProperty(D)?(A!=null&&D==="onScroll"&&ai("scroll",e),x||c===A||(x=[])):(x=x||[]).push(D,A))}o&&(x=x||[]).push("style",o);var D=x;(n.updateQueue=D)&&(n.flags|=4)}};z2=function(e,n,o,u){o!==u&&(n.flags|=4)};function ih(e,n){if(!di)switch(e.tailMode){case"hidden":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function bn(e){var n=e.alternate!==null&&e.alternate.child===e.child,o=0,u=0;if(n)for(var g=e.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags&14680064,u|=g.flags&14680064,g.return=e,g=g.sibling;else for(g=e.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=e,g=g.sibling;return e.subtreeFlags|=u,e.childLanes=o,n}function EI(e,n,o){var u=n.pendingProps;switch(C_(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(n),null;case 1:return Qn(n.type)&&Jp(),bn(n),null;case 3:return u=n.stateNode,Ec(),oi(Jn),oi(kn),R_(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(fp(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,ts!==null&&(By(ts),ts=null))),Iy(e,n),bn(n),null;case 5:L_(n);var g=Xo(Bh.current);if(o=n.type,e!==null&&n.stateNode!=null)E2(e,n,o,u,g),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!u){if(n.stateNode===null)throw Error(Be(166));return bn(n),null}if(e=Xo(Ss.current),fp(n)){u=n.stateNode,o=n.type;var x=n.memoizedProps;switch(u[xs]=n,u[Lh]=x,e=(n.mode&1)!==0,o){case"dialog":ai("cancel",u),ai("close",u);break;case"iframe":case"object":case"embed":ai("load",u);break;case"video":case"audio":for(g=0;g<lh.length;g++)ai(lh[g],u);break;case"source":ai("error",u);break;case"img":case"image":case"link":ai("error",u),ai("load",u);break;case"details":ai("toggle",u);break;case"input":w0(u,x),ai("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!x.multiple},ai("invalid",u);break;case"textarea":S0(u,x),ai("invalid",u)}ty(o,x),g=null;for(var v in x)if(x.hasOwnProperty(v)){var c=x[v];v==="children"?typeof c=="string"?u.textContent!==c&&(x.suppressHydrationWarning!==!0&&pp(u.textContent,c,e),g=["children",c]):typeof c=="number"&&u.textContent!==""+c&&(x.suppressHydrationWarning!==!0&&pp(u.textContent,c,e),g=["children",""+c]):Th.hasOwnProperty(v)&&c!=null&&v==="onScroll"&&ai("scroll",u)}switch(o){case"input":sp(u),b0(u,x,!0);break;case"textarea":sp(u),T0(u);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(u.onclick=Yp)}u=g,n.updateQueue=u,u!==null&&(n.flags|=4)}else{v=g.nodeType===9?g:g.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ab(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=v.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=v.createElement(o,{is:u.is}):(e=v.createElement(o),o==="select"&&(v=e,u.multiple?v.multiple=!0:u.size&&(v.size=u.size))):e=v.createElementNS(e,o),e[xs]=n,e[Lh]=u,M2(e,n,!1,!1),n.stateNode=e;e:{switch(v=iy(o,u),o){case"dialog":ai("cancel",e),ai("close",e),g=u;break;case"iframe":case"object":case"embed":ai("load",e),g=u;break;case"video":case"audio":for(g=0;g<lh.length;g++)ai(lh[g],e);g=u;break;case"source":ai("error",e),g=u;break;case"img":case"image":case"link":ai("error",e),ai("load",e),g=u;break;case"details":ai("toggle",e),g=u;break;case"input":w0(e,u),g=Kg(e,u),ai("invalid",e);break;case"option":g=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},g=vi({},u,{value:void 0}),ai("invalid",e);break;case"textarea":S0(e,u),g=Qg(e,u),ai("invalid",e);break;default:g=u}ty(o,g),c=g;for(x in c)if(c.hasOwnProperty(x)){var A=c[x];x==="style"?cb(e,A):x==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,A!=null&&ob(e,A)):x==="children"?typeof A=="string"?(o!=="textarea"||A!=="")&&kh(e,A):typeof A=="number"&&kh(e,""+A):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(Th.hasOwnProperty(x)?A!=null&&x==="onScroll"&&ai("scroll",e):A!=null&&h_(e,x,A,v))}switch(o){case"input":sp(e),b0(e,u,!1);break;case"textarea":sp(e),T0(e);break;case"option":u.value!=null&&e.setAttribute("value",""+io(u.value));break;case"select":e.multiple=!!u.multiple,x=u.value,x!=null?vc(e,!!u.multiple,x,!1):u.defaultValue!=null&&vc(e,!!u.multiple,u.defaultValue,!0);break;default:typeof g.onClick=="function"&&(e.onclick=Yp)}switch(o){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return bn(n),null;case 6:if(e&&n.stateNode!=null)z2(e,n,e.memoizedProps,u);else{if(typeof u!="string"&&n.stateNode===null)throw Error(Be(166));if(o=Xo(Bh.current),Xo(Ss.current),fp(n)){if(u=n.stateNode,o=n.memoizedProps,u[xs]=n,(x=u.nodeValue!==o)&&(e=vr,e!==null))switch(e.tag){case 3:pp(u.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pp(u.nodeValue,o,(e.mode&1)!==0)}x&&(n.flags|=4)}else u=(o.nodeType===9?o:o.ownerDocument).createTextNode(u),u[xs]=n,n.stateNode=u}return bn(n),null;case 13:if(oi(gi),u=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(di&&_r!==null&&n.mode&1&&!(n.flags&128))Kb(),Ac(),n.flags|=98560,x=!1;else if(x=fp(n),u!==null&&u.dehydrated!==null){if(e===null){if(!x)throw Error(Be(318));if(x=n.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(Be(317));x[xs]=n}else Ac(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;bn(n),x=!1}else ts!==null&&(By(ts),ts=null),x=!0;if(!x)return n.flags&65536?n:null}return n.flags&128?(n.lanes=o,n):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(n.child.flags|=8192,n.mode&1&&(e===null||gi.current&1?ji===0&&(ji=3):Z_())),n.updateQueue!==null&&(n.flags|=4),bn(n),null);case 4:return Ec(),Iy(e,n),e===null&&zh(n.stateNode.containerInfo),bn(n),null;case 10:return M_(n.type._context),bn(n),null;case 17:return Qn(n.type)&&Jp(),bn(n),null;case 19:if(oi(gi),x=n.memoizedState,x===null)return bn(n),null;if(u=(n.flags&128)!==0,v=x.rendering,v===null)if(u)ih(x,!1);else{if(ji!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(v=af(e),v!==null){for(n.flags|=128,ih(x,!1),u=v.updateQueue,u!==null&&(n.updateQueue=u,n.flags|=4),n.subtreeFlags=0,u=o,o=n.child;o!==null;)x=o,e=u,x.flags&=14680066,v=x.alternate,v===null?(x.childLanes=0,x.lanes=e,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=v.childLanes,x.lanes=v.lanes,x.child=v.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=v.memoizedProps,x.memoizedState=v.memoizedState,x.updateQueue=v.updateQueue,x.type=v.type,e=v.dependencies,x.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return ii(gi,gi.current&1|2),n.child}e=e.sibling}x.tail!==null&&Ci()>Dc&&(n.flags|=128,u=!0,ih(x,!1),n.lanes=4194304)}else{if(!u)if(e=af(v),e!==null){if(n.flags|=128,u=!0,o=e.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),ih(x,!0),x.tail===null&&x.tailMode==="hidden"&&!v.alternate&&!di)return bn(n),null}else 2*Ci()-x.renderingStartTime>Dc&&o!==1073741824&&(n.flags|=128,u=!0,ih(x,!1),n.lanes=4194304);x.isBackwards?(v.sibling=n.child,n.child=v):(o=x.last,o!==null?o.sibling=v:n.child=v,x.last=v)}return x.tail!==null?(n=x.tail,x.rendering=n,x.tail=n.sibling,x.renderingStartTime=Ci(),n.sibling=null,o=gi.current,ii(gi,u?o&1|2:o&1),n):(bn(n),null);case 22:case 23:return q_(),u=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(n.flags|=8192),u&&n.mode&1?yr&1073741824&&(bn(n),n.subtreeFlags&6&&(n.flags|=8192)):bn(n),null;case 24:return null;case 25:return null}throw Error(Be(156,n.tag))}function zI(e,n){switch(C_(n),n.tag){case 1:return Qn(n.type)&&Jp(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Ec(),oi(Jn),oi(kn),R_(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return L_(n),null;case 13:if(oi(gi),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(Be(340));Ac()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return oi(gi),null;case 4:return Ec(),null;case 10:return M_(n.type._context),null;case 22:case 23:return q_(),null;case 24:return null;default:return null}}var yp=!1,Sn=!1,DI=typeof WeakSet=="function"?WeakSet:Set,st=null;function pc(e,n){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(u){Ti(e,n,u)}else o.current=null}function Ay(e,n,o){try{o()}catch(u){Ti(e,n,u)}}var p1=!1;function LI(e,n){if(dy=Wp,e=Fb(),T_(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var g=u.anchorOffset,x=u.focusNode;u=u.focusOffset;try{o.nodeType,x.nodeType}catch{o=null;break e}var v=0,c=-1,A=-1,D=0,V=0,L=e,B=null;t:for(;;){for(var se;L!==o||g!==0&&L.nodeType!==3||(c=v+g),L!==x||u!==0&&L.nodeType!==3||(A=v+u),L.nodeType===3&&(v+=L.nodeValue.length),(se=L.firstChild)!==null;)B=L,L=se;for(;;){if(L===e)break t;if(B===o&&++D===g&&(c=v),B===x&&++V===u&&(A=v),(se=L.nextSibling)!==null)break;L=B,B=L.parentNode}L=se}o=c===-1||A===-1?null:{start:c,end:A}}else o=null}o=o||{start:0,end:0}}else o=null;for(py={focusedElem:e,selectionRange:o},Wp=!1,st=n;st!==null;)if(n=st,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,st=e;else for(;st!==null;){n=st;try{var ce=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(ce!==null){var ge=ce.memoizedProps,Ce=ce.memoizedState,X=n.stateNode,Z=X.getSnapshotBeforeUpdate(n.elementType===n.type?ge:Qr(n.type,ge),Ce);X.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var W=n.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(ve){Ti(n,n.return,ve)}if(e=n.sibling,e!==null){e.return=n.return,st=e;break}st=n.return}return ce=p1,p1=!1,ce}function yh(e,n,o){var u=n.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var g=u=u.next;do{if((g.tag&e)===e){var x=g.destroy;g.destroy=void 0,x!==void 0&&Ay(n,o,x)}g=g.next}while(g!==u)}}function Af(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var u=o.create;o.destroy=u()}o=o.next}while(o!==n)}}function My(e){var n=e.ref;if(n!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof n=="function"?n(e):n.current=e}}function D2(e){var n=e.alternate;n!==null&&(e.alternate=null,D2(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[xs],delete n[Lh],delete n[gy],delete n[gI],delete n[yI])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function L2(e){return e.tag===5||e.tag===3||e.tag===4}function f1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||L2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ey(e,n,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(e,n):o.insertBefore(e,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(e,o)):(n=o,n.appendChild(e)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Yp));else if(u!==4&&(e=e.child,e!==null))for(Ey(e,n,o),e=e.sibling;e!==null;)Ey(e,n,o),e=e.sibling}function zy(e,n,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?o.insertBefore(e,n):o.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(zy(e,n,o),e=e.sibling;e!==null;)zy(e,n,o),e=e.sibling}var sn=null,es=!1;function ja(e,n,o){for(o=o.child;o!==null;)R2(e,n,o),o=o.sibling}function R2(e,n,o){if(bs&&typeof bs.onCommitFiberUnmount=="function")try{bs.onCommitFiberUnmount(wf,o)}catch{}switch(o.tag){case 5:Sn||pc(o,n);case 6:var u=sn,g=es;sn=null,ja(e,n,o),sn=u,es=g,sn!==null&&(es?(e=sn,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):sn.removeChild(o.stateNode));break;case 18:sn!==null&&(es?(e=sn,o=o.stateNode,e.nodeType===8?yg(e.parentNode,o):e.nodeType===1&&yg(e,o),Ah(e)):yg(sn,o.stateNode));break;case 4:u=sn,g=es,sn=o.stateNode.containerInfo,es=!0,ja(e,n,o),sn=u,es=g;break;case 0:case 11:case 14:case 15:if(!Sn&&(u=o.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){g=u=u.next;do{var x=g,v=x.destroy;x=x.tag,v!==void 0&&(x&2||x&4)&&Ay(o,n,v),g=g.next}while(g!==u)}ja(e,n,o);break;case 1:if(!Sn&&(pc(o,n),u=o.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=o.memoizedProps,u.state=o.memoizedState,u.componentWillUnmount()}catch(c){Ti(o,n,c)}ja(e,n,o);break;case 21:ja(e,n,o);break;case 22:o.mode&1?(Sn=(u=Sn)||o.memoizedState!==null,ja(e,n,o),Sn=u):ja(e,n,o);break;default:ja(e,n,o)}}function m1(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new DI),n.forEach(function(u){var g=$I.bind(null,e,u);o.has(u)||(o.add(u),u.then(g,g))})}}function Kr(e,n){var o=n.deletions;if(o!==null)for(var u=0;u<o.length;u++){var g=o[u];try{var x=e,v=n,c=v;e:for(;c!==null;){switch(c.tag){case 5:sn=c.stateNode,es=!1;break e;case 3:sn=c.stateNode.containerInfo,es=!0;break e;case 4:sn=c.stateNode.containerInfo,es=!0;break e}c=c.return}if(sn===null)throw Error(Be(160));R2(x,v,g),sn=null,es=!1;var A=g.alternate;A!==null&&(A.return=null),g.return=null}catch(D){Ti(g,n,D)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)B2(n,e),n=n.sibling}function B2(e,n){var o=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Kr(n,e),_s(e),u&4){try{yh(3,e,e.return),Af(3,e)}catch(ge){Ti(e,e.return,ge)}try{yh(5,e,e.return)}catch(ge){Ti(e,e.return,ge)}}break;case 1:Kr(n,e),_s(e),u&512&&o!==null&&pc(o,o.return);break;case 5:if(Kr(n,e),_s(e),u&512&&o!==null&&pc(o,o.return),e.flags&32){var g=e.stateNode;try{kh(g,"")}catch(ge){Ti(e,e.return,ge)}}if(u&4&&(g=e.stateNode,g!=null)){var x=e.memoizedProps,v=o!==null?o.memoizedProps:x,c=e.type,A=e.updateQueue;if(e.updateQueue=null,A!==null)try{c==="input"&&x.type==="radio"&&x.name!=null&&rb(g,x),iy(c,v);var D=iy(c,x);for(v=0;v<A.length;v+=2){var V=A[v],L=A[v+1];V==="style"?cb(g,L):V==="dangerouslySetInnerHTML"?ob(g,L):V==="children"?kh(g,L):h_(g,V,L,D)}switch(c){case"input":Yg(g,x);break;case"textarea":sb(g,x);break;case"select":var B=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!x.multiple;var se=x.value;se!=null?vc(g,!!x.multiple,se,!1):B!==!!x.multiple&&(x.defaultValue!=null?vc(g,!!x.multiple,x.defaultValue,!0):vc(g,!!x.multiple,x.multiple?[]:"",!1))}g[Lh]=x}catch(ge){Ti(e,e.return,ge)}}break;case 6:if(Kr(n,e),_s(e),u&4){if(e.stateNode===null)throw Error(Be(162));g=e.stateNode,x=e.memoizedProps;try{g.nodeValue=x}catch(ge){Ti(e,e.return,ge)}}break;case 3:if(Kr(n,e),_s(e),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Ah(n.containerInfo)}catch(ge){Ti(e,e.return,ge)}break;case 4:Kr(n,e),_s(e);break;case 13:Kr(n,e),_s(e),g=e.child,g.flags&8192&&(x=g.memoizedState!==null,g.stateNode.isHidden=x,!x||g.alternate!==null&&g.alternate.memoizedState!==null||(G_=Ci())),u&4&&m1(e);break;case 22:if(V=o!==null&&o.memoizedState!==null,e.mode&1?(Sn=(D=Sn)||V,Kr(n,e),Sn=D):Kr(n,e),_s(e),u&8192){if(D=e.memoizedState!==null,(e.stateNode.isHidden=D)&&!V&&e.mode&1)for(st=e,V=e.child;V!==null;){for(L=st=V;st!==null;){switch(B=st,se=B.child,B.tag){case 0:case 11:case 14:case 15:yh(4,B,B.return);break;case 1:pc(B,B.return);var ce=B.stateNode;if(typeof ce.componentWillUnmount=="function"){u=B,o=B.return;try{n=u,ce.props=n.memoizedProps,ce.state=n.memoizedState,ce.componentWillUnmount()}catch(ge){Ti(u,o,ge)}}break;case 5:pc(B,B.return);break;case 22:if(B.memoizedState!==null){y1(L);continue}}se!==null?(se.return=B,st=se):y1(L)}V=V.sibling}e:for(V=null,L=e;;){if(L.tag===5){if(V===null){V=L;try{g=L.stateNode,D?(x=g.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(c=L.stateNode,A=L.memoizedProps.style,v=A!=null&&A.hasOwnProperty("display")?A.display:null,c.style.display=lb("display",v))}catch(ge){Ti(e,e.return,ge)}}}else if(L.tag===6){if(V===null)try{L.stateNode.nodeValue=D?"":L.memoizedProps}catch(ge){Ti(e,e.return,ge)}}else if((L.tag!==22&&L.tag!==23||L.memoizedState===null||L===e)&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===e)break e;for(;L.sibling===null;){if(L.return===null||L.return===e)break e;V===L&&(V=null),L=L.return}V===L&&(V=null),L.sibling.return=L.return,L=L.sibling}}break;case 19:Kr(n,e),_s(e),u&4&&m1(e);break;case 21:break;default:Kr(n,e),_s(e)}}function _s(e){var n=e.flags;if(n&2){try{e:{for(var o=e.return;o!==null;){if(L2(o)){var u=o;break e}o=o.return}throw Error(Be(160))}switch(u.tag){case 5:var g=u.stateNode;u.flags&32&&(kh(g,""),u.flags&=-33);var x=f1(e);zy(e,x,g);break;case 3:case 4:var v=u.stateNode.containerInfo,c=f1(e);Ey(e,c,v);break;default:throw Error(Be(161))}}catch(A){Ti(e,e.return,A)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function RI(e,n,o){st=e,F2(e)}function F2(e,n,o){for(var u=(e.mode&1)!==0;st!==null;){var g=st,x=g.child;if(g.tag===22&&u){var v=g.memoizedState!==null||yp;if(!v){var c=g.alternate,A=c!==null&&c.memoizedState!==null||Sn;c=yp;var D=Sn;if(yp=v,(Sn=A)&&!D)for(st=g;st!==null;)v=st,A=v.child,v.tag===22&&v.memoizedState!==null?_1(g):A!==null?(A.return=v,st=A):_1(g);for(;x!==null;)st=x,F2(x),x=x.sibling;st=g,yp=c,Sn=D}g1(e)}else g.subtreeFlags&8772&&x!==null?(x.return=g,st=x):g1(e)}}function g1(e){for(;st!==null;){var n=st;if(n.flags&8772){var o=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Sn||Af(5,n);break;case 1:var u=n.stateNode;if(n.flags&4&&!Sn)if(o===null)u.componentDidMount();else{var g=n.elementType===n.type?o.memoizedProps:Qr(n.type,o.memoizedProps);u.componentDidUpdate(g,o.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var x=n.updateQueue;x!==null&&e1(n,x,u);break;case 3:var v=n.updateQueue;if(v!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}e1(n,v,o)}break;case 5:var c=n.stateNode;if(o===null&&n.flags&4){o=c;var A=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":A.autoFocus&&o.focus();break;case"img":A.src&&(o.src=A.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var D=n.alternate;if(D!==null){var V=D.memoizedState;if(V!==null){var L=V.dehydrated;L!==null&&Ah(L)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Sn||n.flags&512&&My(n)}catch(B){Ti(n,n.return,B)}}if(n===e){st=null;break}if(o=n.sibling,o!==null){o.return=n.return,st=o;break}st=n.return}}function y1(e){for(;st!==null;){var n=st;if(n===e){st=null;break}var o=n.sibling;if(o!==null){o.return=n.return,st=o;break}st=n.return}}function _1(e){for(;st!==null;){var n=st;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{Af(4,n)}catch(A){Ti(n,o,A)}break;case 1:var u=n.stateNode;if(typeof u.componentDidMount=="function"){var g=n.return;try{u.componentDidMount()}catch(A){Ti(n,g,A)}}var x=n.return;try{My(n)}catch(A){Ti(n,x,A)}break;case 5:var v=n.return;try{My(n)}catch(A){Ti(n,v,A)}}}catch(A){Ti(n,n.return,A)}if(n===e){st=null;break}var c=n.sibling;if(c!==null){c.return=n.return,st=c;break}st=n.return}}var BI=Math.ceil,cf=na.ReactCurrentDispatcher,U_=na.ReactCurrentOwner,Or=na.ReactCurrentBatchConfig,Ot=0,Yi=null,Di=null,on=0,yr=0,fc=oo(0),ji=0,Vh=null,rl=0,Mf=0,$_=0,_h=null,Kn=null,G_=0,Dc=1/0,qs=null,uf=!1,Dy=null,Qa=null,_p=!1,qa=null,hf=0,vh=0,Ly=null,Bp=-1,Fp=0;function On(){return Ot&6?Ci():Bp!==-1?Bp:Bp=Ci()}function eo(e){return e.mode&1?Ot&2&&on!==0?on&-on:vI.transition!==null?(Fp===0&&(Fp=wb()),Fp):(e=Wt,e!==0||(e=window.event,e=e===void 0?16:Ib(e.type)),e):1}function ns(e,n,o,u){if(50<vh)throw vh=0,Ly=null,Error(Be(185));Zh(e,o,u),(!(Ot&2)||e!==Yi)&&(e===Yi&&(!(Ot&2)&&(Mf|=o),ji===4&&Ga(e,on)),er(e,u),o===1&&Ot===0&&!(n.mode&1)&&(Dc=Ci()+500,Cf&&lo()))}function er(e,n){var o=e.callbackNode;vP(e,n);var u=Zp(e,e===Yi?on:0);if(u===0)o!==null&&P0(o),e.callbackNode=null,e.callbackPriority=0;else if(n=u&-u,e.callbackPriority!==n){if(o!=null&&P0(o),n===1)e.tag===0?_I(v1.bind(null,e)):Zb(v1.bind(null,e)),fI(function(){!(Ot&6)&&lo()}),o=null;else{switch(bb(u)){case 1:o=g_;break;case 4:o=vb;break;case 16:o=qp;break;case 536870912:o=xb;break;default:o=qp}o=H2(o,O2.bind(null,e))}e.callbackPriority=n,e.callbackNode=o}}function O2(e,n){if(Bp=-1,Fp=0,Ot&6)throw Error(Be(327));var o=e.callbackNode;if(Tc()&&e.callbackNode!==o)return null;var u=Zp(e,e===Yi?on:0);if(u===0)return null;if(u&30||u&e.expiredLanes||n)n=df(e,u);else{n=u;var g=Ot;Ot|=2;var x=V2();(Yi!==e||on!==n)&&(qs=null,Dc=Ci()+500,Jo(e,n));do try{jI();break}catch(c){j2(e,c)}while(!0);A_(),cf.current=x,Ot=g,Di!==null?n=0:(Yi=null,on=0,n=ji)}if(n!==0){if(n===2&&(g=oy(e),g!==0&&(u=g,n=Ry(e,g))),n===1)throw o=Vh,Jo(e,0),Ga(e,u),er(e,Ci()),o;if(n===6)Ga(e,u);else{if(g=e.current.alternate,!(u&30)&&!FI(g)&&(n=df(e,u),n===2&&(x=oy(e),x!==0&&(u=x,n=Ry(e,x))),n===1))throw o=Vh,Jo(e,0),Ga(e,u),er(e,Ci()),o;switch(e.finishedWork=g,e.finishedLanes=u,n){case 0:case 1:throw Error(Be(345));case 2:Ho(e,Kn,qs);break;case 3:if(Ga(e,u),(u&130023424)===u&&(n=G_+500-Ci(),10<n)){if(Zp(e,0)!==0)break;if(g=e.suspendedLanes,(g&u)!==u){On(),e.pingedLanes|=e.suspendedLanes&g;break}e.timeoutHandle=my(Ho.bind(null,e,Kn,qs),n);break}Ho(e,Kn,qs);break;case 4:if(Ga(e,u),(u&4194240)===u)break;for(n=e.eventTimes,g=-1;0<u;){var v=31-is(u);x=1<<v,v=n[v],v>g&&(g=v),u&=~x}if(u=g,u=Ci()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*BI(u/1960))-u,10<u){e.timeoutHandle=my(Ho.bind(null,e,Kn,qs),u);break}Ho(e,Kn,qs);break;case 5:Ho(e,Kn,qs);break;default:throw Error(Be(329))}}}return er(e,Ci()),e.callbackNode===o?O2.bind(null,e):null}function Ry(e,n){var o=_h;return e.current.memoizedState.isDehydrated&&(Jo(e,n).flags|=256),e=df(e,n),e!==2&&(n=Kn,Kn=o,n!==null&&By(n)),e}function By(e){Kn===null?Kn=e:Kn.push.apply(Kn,e)}function FI(e){for(var n=e;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var u=0;u<o.length;u++){var g=o[u],x=g.getSnapshot;g=g.value;try{if(!rs(x(),g))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ga(e,n){for(n&=~$_,n&=~Mf,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var o=31-is(n),u=1<<o;e[o]=-1,n&=~u}}function v1(e){if(Ot&6)throw Error(Be(327));Tc();var n=Zp(e,0);if(!(n&1))return er(e,Ci()),null;var o=df(e,n);if(e.tag!==0&&o===2){var u=oy(e);u!==0&&(n=u,o=Ry(e,u))}if(o===1)throw o=Vh,Jo(e,0),Ga(e,n),er(e,Ci()),o;if(o===6)throw Error(Be(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,Ho(e,Kn,qs),er(e,Ci()),null}function H_(e,n){var o=Ot;Ot|=1;try{return e(n)}finally{Ot=o,Ot===0&&(Dc=Ci()+500,Cf&&lo())}}function sl(e){qa!==null&&qa.tag===0&&!(Ot&6)&&Tc();var n=Ot;Ot|=1;var o=Or.transition,u=Wt;try{if(Or.transition=null,Wt=1,e)return e()}finally{Wt=u,Or.transition=o,Ot=n,!(Ot&6)&&lo()}}function q_(){yr=fc.current,oi(fc)}function Jo(e,n){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,pI(o)),Di!==null)for(o=Di.return;o!==null;){var u=o;switch(C_(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&Jp();break;case 3:Ec(),oi(Jn),oi(kn),R_();break;case 5:L_(u);break;case 4:Ec();break;case 13:oi(gi);break;case 19:oi(gi);break;case 10:M_(u.type._context);break;case 22:case 23:q_()}o=o.return}if(Yi=e,Di=e=to(e.current,null),on=yr=n,ji=0,Vh=null,$_=Mf=rl=0,Kn=_h=null,Wo!==null){for(n=0;n<Wo.length;n++)if(o=Wo[n],u=o.interleaved,u!==null){o.interleaved=null;var g=u.next,x=o.pending;if(x!==null){var v=x.next;x.next=g,u.next=v}o.pending=u}Wo=null}return e}function j2(e,n){do{var o=Di;try{if(A_(),Dp.current=lf,of){for(var u=_i.memoizedState;u!==null;){var g=u.queue;g!==null&&(g.pending=null),u=u.next}of=!1}if(nl=0,Ki=Oi=_i=null,gh=!1,Fh=0,U_.current=null,o===null||o.return===null){ji=1,Vh=n,Di=null;break}e:{var x=e,v=o.return,c=o,A=n;if(n=on,c.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){var D=A,V=c,L=V.tag;if(!(V.mode&1)&&(L===0||L===11||L===15)){var B=V.alternate;B?(V.updateQueue=B.updateQueue,V.memoizedState=B.memoizedState,V.lanes=B.lanes):(V.updateQueue=null,V.memoizedState=null)}var se=a1(v);if(se!==null){se.flags&=-257,o1(se,v,c,x,n),se.mode&1&&s1(x,D,n),n=se,A=D;var ce=n.updateQueue;if(ce===null){var ge=new Set;ge.add(A),n.updateQueue=ge}else ce.add(A);break e}else{if(!(n&1)){s1(x,D,n),Z_();break e}A=Error(Be(426))}}else if(di&&c.mode&1){var Ce=a1(v);if(Ce!==null){!(Ce.flags&65536)&&(Ce.flags|=256),o1(Ce,v,c,x,n),P_(zc(A,c));break e}}x=A=zc(A,c),ji!==4&&(ji=2),_h===null?_h=[x]:_h.push(x),x=v;do{switch(x.tag){case 3:x.flags|=65536,n&=-n,x.lanes|=n;var X=b2(x,A,n);Q0(x,X);break e;case 1:c=A;var Z=x.type,W=x.stateNode;if(!(x.flags&128)&&(typeof Z.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(Qa===null||!Qa.has(W)))){x.flags|=65536,n&=-n,x.lanes|=n;var ve=S2(x,c,n);Q0(x,ve);break e}}x=x.return}while(x!==null)}U2(o)}catch(Se){n=Se,Di===o&&o!==null&&(Di=o=o.return);continue}break}while(!0)}function V2(){var e=cf.current;return cf.current=lf,e===null?lf:e}function Z_(){(ji===0||ji===3||ji===2)&&(ji=4),Yi===null||!(rl&268435455)&&!(Mf&268435455)||Ga(Yi,on)}function df(e,n){var o=Ot;Ot|=2;var u=V2();(Yi!==e||on!==n)&&(qs=null,Jo(e,n));do try{OI();break}catch(g){j2(e,g)}while(!0);if(A_(),Ot=o,cf.current=u,Di!==null)throw Error(Be(261));return Yi=null,on=0,ji}function OI(){for(;Di!==null;)N2(Di)}function jI(){for(;Di!==null&&!uP();)N2(Di)}function N2(e){var n=G2(e.alternate,e,yr);e.memoizedProps=e.pendingProps,n===null?U2(e):Di=n,U_.current=null}function U2(e){var n=e;do{var o=n.alternate;if(e=n.return,n.flags&32768){if(o=zI(o,n),o!==null){o.flags&=32767,Di=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ji=6,Di=null;return}}else if(o=EI(o,n,yr),o!==null){Di=o;return}if(n=n.sibling,n!==null){Di=n;return}Di=n=e}while(n!==null);ji===0&&(ji=5)}function Ho(e,n,o){var u=Wt,g=Or.transition;try{Or.transition=null,Wt=1,VI(e,n,o,u)}finally{Or.transition=g,Wt=u}return null}function VI(e,n,o,u){do Tc();while(qa!==null);if(Ot&6)throw Error(Be(327));o=e.finishedWork;var g=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(Be(177));e.callbackNode=null,e.callbackPriority=0;var x=o.lanes|o.childLanes;if(xP(e,x),e===Yi&&(Di=Yi=null,on=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||_p||(_p=!0,H2(qp,function(){return Tc(),null})),x=(o.flags&15990)!==0,o.subtreeFlags&15990||x){x=Or.transition,Or.transition=null;var v=Wt;Wt=1;var c=Ot;Ot|=4,U_.current=null,LI(e,o),B2(o,e),aI(py),Wp=!!dy,py=dy=null,e.current=o,RI(o),hP(),Ot=c,Wt=v,Or.transition=x}else e.current=o;if(_p&&(_p=!1,qa=e,hf=g),x=e.pendingLanes,x===0&&(Qa=null),fP(o.stateNode),er(e,Ci()),n!==null)for(u=e.onRecoverableError,o=0;o<n.length;o++)g=n[o],u(g.value,{componentStack:g.stack,digest:g.digest});if(uf)throw uf=!1,e=Dy,Dy=null,e;return hf&1&&e.tag!==0&&Tc(),x=e.pendingLanes,x&1?e===Ly?vh++:(vh=0,Ly=e):vh=0,lo(),null}function Tc(){if(qa!==null){var e=bb(hf),n=Or.transition,o=Wt;try{if(Or.transition=null,Wt=16>e?16:e,qa===null)var u=!1;else{if(e=qa,qa=null,hf=0,Ot&6)throw Error(Be(331));var g=Ot;for(Ot|=4,st=e.current;st!==null;){var x=st,v=x.child;if(st.flags&16){var c=x.deletions;if(c!==null){for(var A=0;A<c.length;A++){var D=c[A];for(st=D;st!==null;){var V=st;switch(V.tag){case 0:case 11:case 15:yh(8,V,x)}var L=V.child;if(L!==null)L.return=V,st=L;else for(;st!==null;){V=st;var B=V.sibling,se=V.return;if(D2(V),V===D){st=null;break}if(B!==null){B.return=se,st=B;break}st=se}}}var ce=x.alternate;if(ce!==null){var ge=ce.child;if(ge!==null){ce.child=null;do{var Ce=ge.sibling;ge.sibling=null,ge=Ce}while(ge!==null)}}st=x}}if(x.subtreeFlags&2064&&v!==null)v.return=x,st=v;else e:for(;st!==null;){if(x=st,x.flags&2048)switch(x.tag){case 0:case 11:case 15:yh(9,x,x.return)}var X=x.sibling;if(X!==null){X.return=x.return,st=X;break e}st=x.return}}var Z=e.current;for(st=Z;st!==null;){v=st;var W=v.child;if(v.subtreeFlags&2064&&W!==null)W.return=v,st=W;else e:for(v=Z;st!==null;){if(c=st,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Af(9,c)}}catch(Se){Ti(c,c.return,Se)}if(c===v){st=null;break e}var ve=c.sibling;if(ve!==null){ve.return=c.return,st=ve;break e}st=c.return}}if(Ot=g,lo(),bs&&typeof bs.onPostCommitFiberRoot=="function")try{bs.onPostCommitFiberRoot(wf,e)}catch{}u=!0}return u}finally{Wt=o,Or.transition=n}}return!1}function x1(e,n,o){n=zc(o,n),n=b2(e,n,1),e=Ja(e,n,1),n=On(),e!==null&&(Zh(e,1,n),er(e,n))}function Ti(e,n,o){if(e.tag===3)x1(e,e,o);else for(;n!==null;){if(n.tag===3){x1(n,e,o);break}else if(n.tag===1){var u=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Qa===null||!Qa.has(u))){e=zc(o,e),e=S2(n,e,1),n=Ja(n,e,1),e=On(),n!==null&&(Zh(n,1,e),er(n,e));break}}n=n.return}}function NI(e,n,o){var u=e.pingCache;u!==null&&u.delete(n),n=On(),e.pingedLanes|=e.suspendedLanes&o,Yi===e&&(on&o)===o&&(ji===4||ji===3&&(on&130023424)===on&&500>Ci()-G_?Jo(e,0):$_|=o),er(e,n)}function $2(e,n){n===0&&(e.mode&1?(n=lp,lp<<=1,!(lp&130023424)&&(lp=4194304)):n=1);var o=On();e=ea(e,n),e!==null&&(Zh(e,n,o),er(e,o))}function UI(e){var n=e.memoizedState,o=0;n!==null&&(o=n.retryLane),$2(e,o)}function $I(e,n){var o=0;switch(e.tag){case 13:var u=e.stateNode,g=e.memoizedState;g!==null&&(o=g.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(Be(314))}u!==null&&u.delete(n),$2(e,o)}var G2;G2=function(e,n,o){if(e!==null)if(e.memoizedProps!==n.pendingProps||Jn.current)Yn=!0;else{if(!(e.lanes&o)&&!(n.flags&128))return Yn=!1,MI(e,n,o);Yn=!!(e.flags&131072)}else Yn=!1,di&&n.flags&1048576&&Wb(n,tf,n.index);switch(n.lanes=0,n.tag){case 2:var u=n.type;Rp(e,n),e=n.pendingProps;var g=Ic(n,kn.current);Sc(n,o),g=F_(null,n,u,e,g,o);var x=O_();return n.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Qn(u)?(x=!0,Qp(n)):x=!1,n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,z_(n),g.updater=If,n.stateNode=g,g._reactInternals=n,by(n,u,e,o),n=ky(null,n,u,!0,x,o)):(n.tag=0,di&&x&&k_(n),Ln(null,n,g,o),n=n.child),n;case 16:u=n.elementType;e:{switch(Rp(e,n),e=n.pendingProps,g=u._init,u=g(u._payload),n.type=u,g=n.tag=HI(u),e=Qr(u,e),g){case 0:n=Ty(null,n,u,e,o);break e;case 1:n=u1(null,n,u,e,o);break e;case 11:n=l1(null,n,u,e,o);break e;case 14:n=c1(null,n,u,Qr(u.type,e),o);break e}throw Error(Be(306,u,""))}return n;case 0:return u=n.type,g=n.pendingProps,g=n.elementType===u?g:Qr(u,g),Ty(e,n,u,g,o);case 1:return u=n.type,g=n.pendingProps,g=n.elementType===u?g:Qr(u,g),u1(e,n,u,g,o);case 3:e:{if(P2(n),e===null)throw Error(Be(387));u=n.pendingProps,x=n.memoizedState,g=x.element,e2(e,n),sf(n,u,null,o);var v=n.memoizedState;if(u=v.element,x.isDehydrated)if(x={element:u,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},n.updateQueue.baseState=x,n.memoizedState=x,n.flags&256){g=zc(Error(Be(423)),n),n=h1(e,n,u,o,g);break e}else if(u!==g){g=zc(Error(Be(424)),n),n=h1(e,n,u,o,g);break e}else for(_r=Ya(n.stateNode.containerInfo.firstChild),vr=n,di=!0,ts=null,o=Jb(n,null,u,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ac(),u===g){n=ta(e,n,o);break e}Ln(e,n,u,o)}n=n.child}return n;case 5:return t2(n),e===null&&vy(n),u=n.type,g=n.pendingProps,x=e!==null?e.memoizedProps:null,v=g.children,fy(u,g)?v=null:x!==null&&fy(u,x)&&(n.flags|=32),C2(e,n),Ln(e,n,v,o),n.child;case 6:return e===null&&vy(n),null;case 13:return I2(e,n,o);case 4:return D_(n,n.stateNode.containerInfo),u=n.pendingProps,e===null?n.child=Mc(n,null,u,o):Ln(e,n,u,o),n.child;case 11:return u=n.type,g=n.pendingProps,g=n.elementType===u?g:Qr(u,g),l1(e,n,u,g,o);case 7:return Ln(e,n,n.pendingProps,o),n.child;case 8:return Ln(e,n,n.pendingProps.children,o),n.child;case 12:return Ln(e,n,n.pendingProps.children,o),n.child;case 10:e:{if(u=n.type._context,g=n.pendingProps,x=n.memoizedProps,v=g.value,ii(nf,u._currentValue),u._currentValue=v,x!==null)if(rs(x.value,v)){if(x.children===g.children&&!Jn.current){n=ta(e,n,o);break e}}else for(x=n.child,x!==null&&(x.return=n);x!==null;){var c=x.dependencies;if(c!==null){v=x.child;for(var A=c.firstContext;A!==null;){if(A.context===u){if(x.tag===1){A=Ks(-1,o&-o),A.tag=2;var D=x.updateQueue;if(D!==null){D=D.shared;var V=D.pending;V===null?A.next=A:(A.next=V.next,V.next=A),D.pending=A}}x.lanes|=o,A=x.alternate,A!==null&&(A.lanes|=o),xy(x.return,o,n),c.lanes|=o;break}A=A.next}}else if(x.tag===10)v=x.type===n.type?null:x.child;else if(x.tag===18){if(v=x.return,v===null)throw Error(Be(341));v.lanes|=o,c=v.alternate,c!==null&&(c.lanes|=o),xy(v,o,n),v=x.sibling}else v=x.child;if(v!==null)v.return=x;else for(v=x;v!==null;){if(v===n){v=null;break}if(x=v.sibling,x!==null){x.return=v.return,v=x;break}v=v.return}x=v}Ln(e,n,g.children,o),n=n.child}return n;case 9:return g=n.type,u=n.pendingProps.children,Sc(n,o),g=Vr(g),u=u(g),n.flags|=1,Ln(e,n,u,o),n.child;case 14:return u=n.type,g=Qr(u,n.pendingProps),g=Qr(u.type,g),c1(e,n,u,g,o);case 15:return T2(e,n,n.type,n.pendingProps,o);case 17:return u=n.type,g=n.pendingProps,g=n.elementType===u?g:Qr(u,g),Rp(e,n),n.tag=1,Qn(u)?(e=!0,Qp(n)):e=!1,Sc(n,o),w2(n,u,g),by(n,u,g,o),ky(null,n,u,!0,e,o);case 19:return A2(e,n,o);case 22:return k2(e,n,o)}throw Error(Be(156,n.tag))};function H2(e,n){return _b(e,n)}function GI(e,n,o,u){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Br(e,n,o,u){return new GI(e,n,o,u)}function W_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function HI(e){if(typeof e=="function")return W_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===p_)return 11;if(e===f_)return 14}return 2}function to(e,n){var o=e.alternate;return o===null?(o=Br(e.tag,n,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=n,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,n=e.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Op(e,n,o,u,g,x){var v=2;if(u=e,typeof e=="function")W_(e)&&(v=1);else if(typeof e=="string")v=5;else e:switch(e){case rc:return Qo(o.children,g,x,n);case d_:v=8,g|=8;break;case qg:return e=Br(12,o,n,g|2),e.elementType=qg,e.lanes=x,e;case Zg:return e=Br(13,o,n,g),e.elementType=Zg,e.lanes=x,e;case Wg:return e=Br(19,o,n,g),e.elementType=Wg,e.lanes=x,e;case tb:return Ef(o,g,x,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Qw:v=10;break e;case eb:v=9;break e;case p_:v=11;break e;case f_:v=14;break e;case Na:v=16,u=null;break e}throw Error(Be(130,e==null?e:typeof e,""))}return n=Br(v,o,n,g),n.elementType=e,n.type=u,n.lanes=x,n}function Qo(e,n,o,u){return e=Br(7,e,u,n),e.lanes=o,e}function Ef(e,n,o,u){return e=Br(22,e,u,n),e.elementType=tb,e.lanes=o,e.stateNode={isHidden:!1},e}function kg(e,n,o){return e=Br(6,e,null,n),e.lanes=o,e}function Cg(e,n,o){return n=Br(4,e.children!==null?e.children:[],e.key,n),n.lanes=o,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function qI(e,n,o,u,g){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ag(0),this.expirationTimes=ag(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ag(0),this.identifierPrefix=u,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function X_(e,n,o,u,g,x,v,c,A){return e=new qI(e,n,o,c,A),n===1?(n=1,x===!0&&(n|=8)):n=0,x=Br(3,null,null,n),e.current=x,x.stateNode=e,x.memoizedState={element:u,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},z_(x),e}function ZI(e,n,o){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nc,key:u==null?null:""+u,children:e,containerInfo:n,implementation:o}}function q2(e){if(!e)return no;e=e._reactInternals;e:{if(ol(e)!==e||e.tag!==1)throw Error(Be(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Qn(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(Be(171))}if(e.tag===1){var o=e.type;if(Qn(o))return qb(e,o,n)}return n}function Z2(e,n,o,u,g,x,v,c,A){return e=X_(o,u,!0,e,g,x,v,c,A),e.context=q2(null),o=e.current,u=On(),g=eo(o),x=Ks(u,g),x.callback=n??null,Ja(o,x,g),e.current.lanes=g,Zh(e,g,u),er(e,u),e}function zf(e,n,o,u){var g=n.current,x=On(),v=eo(g);return o=q2(o),n.context===null?n.context=o:n.pendingContext=o,n=Ks(x,v),n.payload={element:e},u=u===void 0?null:u,u!==null&&(n.callback=u),e=Ja(g,n,v),e!==null&&(ns(e,g,v,x),zp(e,g,v)),v}function pf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function w1(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<n?o:n}}function K_(e,n){w1(e,n),(e=e.alternate)&&w1(e,n)}function WI(){return null}var W2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Y_(e){this._internalRoot=e}Df.prototype.render=Y_.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(Be(409));zf(e,n,null,null)};Df.prototype.unmount=Y_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;sl(function(){zf(null,e,null,null)}),n[Qs]=null}};function Df(e){this._internalRoot=e}Df.prototype.unstable_scheduleHydration=function(e){if(e){var n=kb();e={blockedOn:null,target:e,priority:n};for(var o=0;o<$a.length&&n!==0&&n<$a[o].priority;o++);$a.splice(o,0,e),o===0&&Pb(e)}};function J_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Lf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function b1(){}function XI(e,n,o,u,g){if(g){if(typeof u=="function"){var x=u;u=function(){var D=pf(v);x.call(D)}}var v=Z2(n,u,e,0,null,!1,!1,"",b1);return e._reactRootContainer=v,e[Qs]=v.current,zh(e.nodeType===8?e.parentNode:e),sl(),v}for(;g=e.lastChild;)e.removeChild(g);if(typeof u=="function"){var c=u;u=function(){var D=pf(A);c.call(D)}}var A=X_(e,0,!1,null,null,!1,!1,"",b1);return e._reactRootContainer=A,e[Qs]=A.current,zh(e.nodeType===8?e.parentNode:e),sl(function(){zf(n,A,o,u)}),A}function Rf(e,n,o,u,g){var x=o._reactRootContainer;if(x){var v=x;if(typeof g=="function"){var c=g;g=function(){var A=pf(v);c.call(A)}}zf(n,v,e,g)}else v=XI(o,n,e,g,u);return pf(v)}Sb=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var o=oh(n.pendingLanes);o!==0&&(y_(n,o|1),er(n,Ci()),!(Ot&6)&&(Dc=Ci()+500,lo()))}break;case 13:sl(function(){var u=ea(e,1);if(u!==null){var g=On();ns(u,e,1,g)}}),K_(e,1)}};__=function(e){if(e.tag===13){var n=ea(e,134217728);if(n!==null){var o=On();ns(n,e,134217728,o)}K_(e,134217728)}};Tb=function(e){if(e.tag===13){var n=eo(e),o=ea(e,n);if(o!==null){var u=On();ns(o,e,n,u)}K_(e,n)}};kb=function(){return Wt};Cb=function(e,n){var o=Wt;try{return Wt=e,n()}finally{Wt=o}};ry=function(e,n,o){switch(n){case"input":if(Yg(e,o),n=o.name,o.type==="radio"&&n!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var u=o[n];if(u!==e&&u.form===e.form){var g=kf(u);if(!g)throw Error(Be(90));nb(u),Yg(u,g)}}}break;case"textarea":sb(e,o);break;case"select":n=o.value,n!=null&&vc(e,!!o.multiple,n,!1)}};db=H_;pb=sl;var KI={usingClientEntryPoint:!1,Events:[Xh,lc,kf,ub,hb,H_]},nh={findFiberByHostInstance:Zo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YI={bundleType:nh.bundleType,version:nh.version,rendererPackageName:nh.rendererPackageName,rendererConfig:nh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:na.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gb(e),e===null?null:e.stateNode},findFiberByHostInstance:nh.findFiberByHostInstance||WI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vp.isDisabled&&vp.supportsFiber)try{wf=vp.inject(YI),bs=vp}catch{}}wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KI;wr.createPortal=function(e,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!J_(n))throw Error(Be(200));return ZI(e,n,null,o)};wr.createRoot=function(e,n){if(!J_(e))throw Error(Be(299));var o=!1,u="",g=W2;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(g=n.onRecoverableError)),n=X_(e,1,!1,null,null,o,!1,u,g),e[Qs]=n.current,zh(e.nodeType===8?e.parentNode:e),new Y_(n)};wr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(Be(188)):(e=Object.keys(e).join(","),Error(Be(268,e)));return e=gb(n),e=e===null?null:e.stateNode,e};wr.flushSync=function(e){return sl(e)};wr.hydrate=function(e,n,o){if(!Lf(n))throw Error(Be(200));return Rf(null,e,n,!0,o)};wr.hydrateRoot=function(e,n,o){if(!J_(e))throw Error(Be(405));var u=o!=null&&o.hydratedSources||null,g=!1,x="",v=W2;if(o!=null&&(o.unstable_strictMode===!0&&(g=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onRecoverableError!==void 0&&(v=o.onRecoverableError)),n=Z2(n,null,e,1,o??null,g,!1,x,v),e[Qs]=n.current,zh(e),u)for(e=0;e<u.length;e++)o=u[e],g=o._getVersion,g=g(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,g]:n.mutableSourceEagerHydrationData.push(o,g);return new Df(n)};wr.render=function(e,n,o){if(!Lf(n))throw Error(Be(200));return Rf(null,e,n,!1,o)};wr.unmountComponentAtNode=function(e){if(!Lf(e))throw Error(Be(40));return e._reactRootContainer?(sl(function(){Rf(null,null,e,!1,function(){e._reactRootContainer=null,e[Qs]=null})}),!0):!1};wr.unstable_batchedUpdates=H_;wr.unstable_renderSubtreeIntoContainer=function(e,n,o,u){if(!Lf(o))throw Error(Be(200));if(e==null||e._reactInternals===void 0)throw Error(Be(38));return Rf(e,n,o,!1,u)};wr.version="18.3.1-next-f1338f8080-20240426";function X2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X2)}catch(e){console.error(e)}}X2(),Xw.exports=wr;var JI=Xw.exports,K2,S1=JI;K2=S1.createRoot,S1.hydrateRoot;const Q_=De.createContext({});function ev(e){const n=De.useRef(null);return n.current===null&&(n.current=e()),n.current}const tv=typeof window<"u",Y2=tv?De.useLayoutEffect:De.useEffect,Bf=De.createContext(null);function iv(e,n){e.indexOf(n)===-1&&e.push(n)}function nv(e,n){const o=e.indexOf(n);o>-1&&e.splice(o,1)}const ks=(e,n,o)=>o>n?n:o<e?e:o;let rv=()=>{};const ia={},J2=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Q2(e){return typeof e=="object"&&e!==null}const eS=e=>/^0[^.\s]+$/u.test(e);function sv(e){let n;return()=>(n===void 0&&(n=e()),n)}const jr=e=>e,QI=(e,n)=>o=>n(e(o)),Yh=(...e)=>e.reduce(QI),Nh=(e,n,o)=>{const u=n-e;return u===0?1:(o-e)/u};class av{constructor(){this.subscriptions=[]}add(n){return iv(this.subscriptions,n),()=>nv(this.subscriptions,n)}notify(n,o,u){const g=this.subscriptions.length;if(g)if(g===1)this.subscriptions[0](n,o,u);else for(let x=0;x<g;x++){const v=this.subscriptions[x];v&&v(n,o,u)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ys=e=>e*1e3,Fr=e=>e/1e3;function tS(e,n){return n?e*(1e3/n):0}const iS=(e,n,o)=>(((1-3*o+3*n)*e+(3*o-6*n))*e+3*n)*e,eA=1e-7,tA=12;function iA(e,n,o,u,g){let x,v,c=0;do v=n+(o-n)/2,x=iS(v,u,g)-e,x>0?o=v:n=v;while(Math.abs(x)>eA&&++c<tA);return v}function Jh(e,n,o,u){if(e===n&&o===u)return jr;const g=x=>iA(x,0,1,e,o);return x=>x===0||x===1?x:iS(g(x),n,u)}const nS=e=>n=>n<=.5?e(2*n)/2:(2-e(2*(1-n)))/2,rS=e=>n=>1-e(1-n),sS=Jh(.33,1.53,.69,.99),ov=rS(sS),aS=nS(ov),oS=e=>(e*=2)<1?.5*ov(e):.5*(2-Math.pow(2,-10*(e-1))),lv=e=>1-Math.sin(Math.acos(e)),lS=rS(lv),cS=nS(lv),nA=Jh(.42,0,1,1),rA=Jh(0,0,.58,1),uS=Jh(.42,0,.58,1),sA=e=>Array.isArray(e)&&typeof e[0]!="number",hS=e=>Array.isArray(e)&&typeof e[0]=="number",aA={linear:jr,easeIn:nA,easeInOut:uS,easeOut:rA,circIn:lv,circInOut:cS,circOut:lS,backIn:ov,backInOut:aS,backOut:sS,anticipate:oS},oA=e=>typeof e=="string",T1=e=>{if(hS(e)){rv(e.length===4);const[n,o,u,g]=e;return Jh(n,o,u,g)}else if(oA(e))return aA[e];return e},xp=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function lA(e,n){let o=new Set,u=new Set,g=!1,x=!1;const v=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function A(V){v.has(V)&&(D.schedule(V),e()),V(c)}const D={schedule:(V,L=!1,B=!1)=>{const ce=B&&g?o:u;return L&&v.add(V),ce.has(V)||ce.add(V),V},cancel:V=>{u.delete(V),v.delete(V)},process:V=>{if(c=V,g){x=!0;return}g=!0,[o,u]=[u,o],o.forEach(A),o.clear(),g=!1,x&&(x=!1,D.process(V))}};return D}const cA=40;function dS(e,n){let o=!1,u=!0;const g={delta:0,timestamp:0,isProcessing:!1},x=()=>o=!0,v=xp.reduce((W,ve)=>(W[ve]=lA(x),W),{}),{setup:c,read:A,resolveKeyframes:D,preUpdate:V,update:L,preRender:B,render:se,postRender:ce}=v,ge=()=>{const W=ia.useManualTiming?g.timestamp:performance.now();o=!1,ia.useManualTiming||(g.delta=u?1e3/60:Math.max(Math.min(W-g.timestamp,cA),1)),g.timestamp=W,g.isProcessing=!0,c.process(g),A.process(g),D.process(g),V.process(g),L.process(g),B.process(g),se.process(g),ce.process(g),g.isProcessing=!1,o&&n&&(u=!1,e(ge))},Ce=()=>{o=!0,u=!0,g.isProcessing||e(ge)};return{schedule:xp.reduce((W,ve)=>{const Se=v[ve];return W[ve]=(ke,Ae=!1,Me=!1)=>(o||Ce(),Se.schedule(ke,Ae,Me)),W},{}),cancel:W=>{for(let ve=0;ve<xp.length;ve++)v[xp[ve]].cancel(W)},state:g,steps:v}}const{schedule:li,cancel:ro,state:an,steps:Pg}=dS(typeof requestAnimationFrame<"u"?requestAnimationFrame:jr,!0);let jp;function uA(){jp=void 0}const Bn={now:()=>(jp===void 0&&Bn.set(an.isProcessing||ia.useManualTiming?an.timestamp:performance.now()),jp),set:e=>{jp=e,queueMicrotask(uA)}},pS=e=>n=>typeof n=="string"&&n.startsWith(e),fS=pS("--"),hA=pS("var(--"),cv=e=>hA(e)?dA.test(e.split("/*")[0].trim()):!1,dA=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function k1(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const jc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Uh={...jc,transform:e=>ks(0,1,e)},wp={...jc,default:1},xh=e=>Math.round(e*1e5)/1e5,uv=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function pA(e){return e==null}const fA=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,hv=(e,n)=>o=>!!(typeof o=="string"&&fA.test(o)&&o.startsWith(e)||n&&!pA(o)&&Object.prototype.hasOwnProperty.call(o,n)),mS=(e,n,o)=>u=>{if(typeof u!="string")return u;const[g,x,v,c]=u.match(uv);return{[e]:parseFloat(g),[n]:parseFloat(x),[o]:parseFloat(v),alpha:c!==void 0?parseFloat(c):1}},mA=e=>ks(0,255,e),Ig={...jc,transform:e=>Math.round(mA(e))},Ko={test:hv("rgb","red"),parse:mS("red","green","blue"),transform:({red:e,green:n,blue:o,alpha:u=1})=>"rgba("+Ig.transform(e)+", "+Ig.transform(n)+", "+Ig.transform(o)+", "+xh(Uh.transform(u))+")"};function gA(e){let n="",o="",u="",g="";return e.length>5?(n=e.substring(1,3),o=e.substring(3,5),u=e.substring(5,7),g=e.substring(7,9)):(n=e.substring(1,2),o=e.substring(2,3),u=e.substring(3,4),g=e.substring(4,5),n+=n,o+=o,u+=u,g+=g),{red:parseInt(n,16),green:parseInt(o,16),blue:parseInt(u,16),alpha:g?parseInt(g,16)/255:1}}const Fy={test:hv("#"),parse:gA,transform:Ko.transform},Qh=e=>({test:n=>typeof n=="string"&&n.endsWith(e)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${e}`}),Va=Qh("deg"),Ts=Qh("%"),nt=Qh("px"),yA=Qh("vh"),_A=Qh("vw"),C1={...Ts,parse:e=>Ts.parse(e)/100,transform:e=>Ts.transform(e*100)},mc={test:hv("hsl","hue"),parse:mS("hue","saturation","lightness"),transform:({hue:e,saturation:n,lightness:o,alpha:u=1})=>"hsla("+Math.round(e)+", "+Ts.transform(xh(n))+", "+Ts.transform(xh(o))+", "+xh(Uh.transform(u))+")"},zi={test:e=>Ko.test(e)||Fy.test(e)||mc.test(e),parse:e=>Ko.test(e)?Ko.parse(e):mc.test(e)?mc.parse(e):Fy.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ko.transform(e):mc.transform(e),getAnimatableNone:e=>{const n=zi.parse(e);return n.alpha=0,zi.transform(n)}},vA=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function xA(e){var n,o;return isNaN(e)&&typeof e=="string"&&(((n=e.match(uv))==null?void 0:n.length)||0)+(((o=e.match(vA))==null?void 0:o.length)||0)>0}const gS="number",yS="color",wA="var",bA="var(",P1="${}",SA=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function $h(e){const n=e.toString(),o=[],u={color:[],number:[],var:[]},g=[];let x=0;const c=n.replace(SA,A=>(zi.test(A)?(u.color.push(x),g.push(yS),o.push(zi.parse(A))):A.startsWith(bA)?(u.var.push(x),g.push(wA),o.push(A)):(u.number.push(x),g.push(gS),o.push(parseFloat(A))),++x,P1)).split(P1);return{values:o,split:c,indexes:u,types:g}}function _S(e){return $h(e).values}function vS(e){const{split:n,types:o}=$h(e),u=n.length;return g=>{let x="";for(let v=0;v<u;v++)if(x+=n[v],g[v]!==void 0){const c=o[v];c===gS?x+=xh(g[v]):c===yS?x+=zi.transform(g[v]):x+=g[v]}return x}}const TA=e=>typeof e=="number"?0:zi.test(e)?zi.getAnimatableNone(e):e;function kA(e){const n=_S(e);return vS(e)(n.map(TA))}const so={test:xA,parse:_S,createTransformer:vS,getAnimatableNone:kA};function Ag(e,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(n-e)*6*o:o<1/2?n:o<2/3?e+(n-e)*(2/3-o)*6:e}function CA({hue:e,saturation:n,lightness:o,alpha:u}){e/=360,n/=100,o/=100;let g=0,x=0,v=0;if(!n)g=x=v=o;else{const c=o<.5?o*(1+n):o+n-o*n,A=2*o-c;g=Ag(A,c,e+1/3),x=Ag(A,c,e),v=Ag(A,c,e-1/3)}return{red:Math.round(g*255),green:Math.round(x*255),blue:Math.round(v*255),alpha:u}}function ff(e,n){return o=>o>0?n:e}const yi=(e,n,o)=>e+(n-e)*o,Mg=(e,n,o)=>{const u=e*e,g=o*(n*n-u)+u;return g<0?0:Math.sqrt(g)},PA=[Fy,Ko,mc],IA=e=>PA.find(n=>n.test(e));function I1(e){const n=IA(e);if(!n)return!1;let o=n.parse(e);return n===mc&&(o=CA(o)),o}const A1=(e,n)=>{const o=I1(e),u=I1(n);if(!o||!u)return ff(e,n);const g={...o};return x=>(g.red=Mg(o.red,u.red,x),g.green=Mg(o.green,u.green,x),g.blue=Mg(o.blue,u.blue,x),g.alpha=yi(o.alpha,u.alpha,x),Ko.transform(g))},Oy=new Set(["none","hidden"]);function AA(e,n){return Oy.has(e)?o=>o<=0?e:n:o=>o>=1?n:e}function MA(e,n){return o=>yi(e,n,o)}function dv(e){return typeof e=="number"?MA:typeof e=="string"?cv(e)?ff:zi.test(e)?A1:DA:Array.isArray(e)?xS:typeof e=="object"?zi.test(e)?A1:EA:ff}function xS(e,n){const o=[...e],u=o.length,g=e.map((x,v)=>dv(x)(x,n[v]));return x=>{for(let v=0;v<u;v++)o[v]=g[v](x);return o}}function EA(e,n){const o={...e,...n},u={};for(const g in o)e[g]!==void 0&&n[g]!==void 0&&(u[g]=dv(e[g])(e[g],n[g]));return g=>{for(const x in u)o[x]=u[x](g);return o}}function zA(e,n){const o=[],u={color:0,var:0,number:0};for(let g=0;g<n.values.length;g++){const x=n.types[g],v=e.indexes[x][u[x]],c=e.values[v]??0;o[g]=c,u[x]++}return o}const DA=(e,n)=>{const o=so.createTransformer(n),u=$h(e),g=$h(n);return u.indexes.var.length===g.indexes.var.length&&u.indexes.color.length===g.indexes.color.length&&u.indexes.number.length>=g.indexes.number.length?Oy.has(e)&&!g.values.length||Oy.has(n)&&!u.values.length?AA(e,n):Yh(xS(zA(u,g),g.values),o):ff(e,n)};function wS(e,n,o){return typeof e=="number"&&typeof n=="number"&&typeof o=="number"?yi(e,n,o):dv(e)(e,n)}const LA=e=>{const n=({timestamp:o})=>e(o);return{start:(o=!0)=>li.update(n,o),stop:()=>ro(n),now:()=>an.isProcessing?an.timestamp:Bn.now()}},bS=(e,n,o=10)=>{let u="";const g=Math.max(Math.round(n/o),2);for(let x=0;x<g;x++)u+=Math.round(e(x/(g-1))*1e4)/1e4+", ";return`linear(${u.substring(0,u.length-2)})`},mf=2e4;function pv(e){let n=0;const o=50;let u=e.next(n);for(;!u.done&&n<mf;)n+=o,u=e.next(n);return n>=mf?1/0:n}function RA(e,n=100,o){const u=o({...e,keyframes:[0,n]}),g=Math.min(pv(u),mf);return{type:"keyframes",ease:x=>u.next(g*x).value/n,duration:Fr(g)}}const BA=5;function SS(e,n,o){const u=Math.max(n-BA,0);return tS(o-e(u),n-u)}const Si={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Eg=.001;function FA({duration:e=Si.duration,bounce:n=Si.bounce,velocity:o=Si.velocity,mass:u=Si.mass}){let g,x,v=1-n;v=ks(Si.minDamping,Si.maxDamping,v),e=ks(Si.minDuration,Si.maxDuration,Fr(e)),v<1?(g=D=>{const V=D*v,L=V*e,B=V-o,se=jy(D,v),ce=Math.exp(-L);return Eg-B/se*ce},x=D=>{const L=D*v*e,B=L*o+o,se=Math.pow(v,2)*Math.pow(D,2)*e,ce=Math.exp(-L),ge=jy(Math.pow(D,2),v);return(-g(D)+Eg>0?-1:1)*((B-se)*ce)/ge}):(g=D=>{const V=Math.exp(-D*e),L=(D-o)*e+1;return-Eg+V*L},x=D=>{const V=Math.exp(-D*e),L=(o-D)*(e*e);return V*L});const c=5/e,A=jA(g,x,c);if(e=Ys(e),isNaN(A))return{stiffness:Si.stiffness,damping:Si.damping,duration:e};{const D=Math.pow(A,2)*u;return{stiffness:D,damping:v*2*Math.sqrt(u*D),duration:e}}}const OA=12;function jA(e,n,o){let u=o;for(let g=1;g<OA;g++)u=u-e(u)/n(u);return u}function jy(e,n){return e*Math.sqrt(1-n*n)}const VA=["duration","bounce"],NA=["stiffness","damping","mass"];function M1(e,n){return n.some(o=>e[o]!==void 0)}function UA(e){let n={velocity:Si.velocity,stiffness:Si.stiffness,damping:Si.damping,mass:Si.mass,isResolvedFromDuration:!1,...e};if(!M1(e,NA)&&M1(e,VA))if(e.visualDuration){const o=e.visualDuration,u=2*Math.PI/(o*1.2),g=u*u,x=2*ks(.05,1,1-(e.bounce||0))*Math.sqrt(g);n={...n,mass:Si.mass,stiffness:g,damping:x}}else{const o=FA(e);n={...n,...o,mass:Si.mass},n.isResolvedFromDuration=!0}return n}function gf(e=Si.visualDuration,n=Si.bounce){const o=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:n}:e;let{restSpeed:u,restDelta:g}=o;const x=o.keyframes[0],v=o.keyframes[o.keyframes.length-1],c={done:!1,value:x},{stiffness:A,damping:D,mass:V,duration:L,velocity:B,isResolvedFromDuration:se}=UA({...o,velocity:-Fr(o.velocity||0)}),ce=B||0,ge=D/(2*Math.sqrt(A*V)),Ce=v-x,X=Fr(Math.sqrt(A/V)),Z=Math.abs(Ce)<5;u||(u=Z?Si.restSpeed.granular:Si.restSpeed.default),g||(g=Z?Si.restDelta.granular:Si.restDelta.default);let W;if(ge<1){const Se=jy(X,ge);W=ke=>{const Ae=Math.exp(-ge*X*ke);return v-Ae*((ce+ge*X*Ce)/Se*Math.sin(Se*ke)+Ce*Math.cos(Se*ke))}}else if(ge===1)W=Se=>v-Math.exp(-X*Se)*(Ce+(ce+X*Ce)*Se);else{const Se=X*Math.sqrt(ge*ge-1);W=ke=>{const Ae=Math.exp(-ge*X*ke),Me=Math.min(Se*ke,300);return v-Ae*((ce+ge*X*Ce)*Math.sinh(Me)+Se*Ce*Math.cosh(Me))/Se}}const ve={calculatedDuration:se&&L||null,next:Se=>{const ke=W(Se);if(se)c.done=Se>=L;else{let Ae=Se===0?ce:0;ge<1&&(Ae=Se===0?Ys(ce):SS(W,Se,ke));const Me=Math.abs(Ae)<=u,ot=Math.abs(v-ke)<=g;c.done=Me&&ot}return c.value=c.done?v:ke,c},toString:()=>{const Se=Math.min(pv(ve),mf),ke=bS(Ae=>ve.next(Se*Ae).value,Se,30);return Se+"ms "+ke},toTransition:()=>{}};return ve}gf.applyToOptions=e=>{const n=RA(e,100,gf);return e.ease=n.ease,e.duration=Ys(n.duration),e.type="keyframes",e};function Vy({keyframes:e,velocity:n=0,power:o=.8,timeConstant:u=325,bounceDamping:g=10,bounceStiffness:x=500,modifyTarget:v,min:c,max:A,restDelta:D=.5,restSpeed:V}){const L=e[0],B={done:!1,value:L},se=Me=>c!==void 0&&Me<c||A!==void 0&&Me>A,ce=Me=>c===void 0?A:A===void 0||Math.abs(c-Me)<Math.abs(A-Me)?c:A;let ge=o*n;const Ce=L+ge,X=v===void 0?Ce:v(Ce);X!==Ce&&(ge=X-L);const Z=Me=>-ge*Math.exp(-Me/u),W=Me=>X+Z(Me),ve=Me=>{const ot=Z(Me),at=W(Me);B.done=Math.abs(ot)<=D,B.value=B.done?X:at};let Se,ke;const Ae=Me=>{se(B.value)&&(Se=Me,ke=gf({keyframes:[B.value,ce(B.value)],velocity:SS(W,Me,B.value),damping:g,stiffness:x,restDelta:D,restSpeed:V}))};return Ae(0),{calculatedDuration:null,next:Me=>{let ot=!1;return!ke&&Se===void 0&&(ot=!0,ve(Me),Ae(Me)),Se!==void 0&&Me>=Se?ke.next(Me-Se):(!ot&&ve(Me),B)}}}function $A(e,n,o){const u=[],g=o||ia.mix||wS,x=e.length-1;for(let v=0;v<x;v++){let c=g(e[v],e[v+1]);if(n){const A=Array.isArray(n)?n[v]||jr:n;c=Yh(A,c)}u.push(c)}return u}function GA(e,n,{clamp:o=!0,ease:u,mixer:g}={}){const x=e.length;if(rv(x===n.length),x===1)return()=>n[0];if(x===2&&n[0]===n[1])return()=>n[1];const v=e[0]===e[1];e[0]>e[x-1]&&(e=[...e].reverse(),n=[...n].reverse());const c=$A(n,u,g),A=c.length,D=V=>{if(v&&V<e[0])return n[0];let L=0;if(A>1)for(;L<e.length-2&&!(V<e[L+1]);L++);const B=Nh(e[L],e[L+1],V);return c[L](B)};return o?V=>D(ks(e[0],e[x-1],V)):D}function HA(e,n){const o=e[e.length-1];for(let u=1;u<=n;u++){const g=Nh(0,n,u);e.push(yi(o,1,g))}}function qA(e){const n=[0];return HA(n,e.length-1),n}function ZA(e,n){return e.map(o=>o*n)}function WA(e,n){return e.map(()=>n||uS).splice(0,e.length-1)}function wh({duration:e=300,keyframes:n,times:o,ease:u="easeInOut"}){const g=sA(u)?u.map(T1):T1(u),x={done:!1,value:n[0]},v=ZA(o&&o.length===n.length?o:qA(n),e),c=GA(v,n,{ease:Array.isArray(g)?g:WA(n,g)});return{calculatedDuration:e,next:A=>(x.value=c(A),x.done=A>=e,x)}}const XA=e=>e!==null;function fv(e,{repeat:n,repeatType:o="loop"},u,g=1){const x=e.filter(XA),c=g<0||n&&o!=="loop"&&n%2===1?0:x.length-1;return!c||u===void 0?x[c]:u}const KA={decay:Vy,inertia:Vy,tween:wh,keyframes:wh,spring:gf};function TS(e){typeof e.type=="string"&&(e.type=KA[e.type])}class mv{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(n=>{this.resolve=n})}notifyFinished(){this.resolve()}then(n,o){return this.finished.then(n,o)}}const YA=e=>e/100;class gv extends mv{constructor(n){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var u,g;const{motionValue:o}=this.options;o&&o.updatedAt!==Bn.now()&&this.tick(Bn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(g=(u=this.options).onStop)==null||g.call(u))},this.options=n,this.initAnimation(),this.play(),n.autoplay===!1&&this.pause()}initAnimation(){const{options:n}=this;TS(n);const{type:o=wh,repeat:u=0,repeatDelay:g=0,repeatType:x,velocity:v=0}=n;let{keyframes:c}=n;const A=o||wh;A!==wh&&typeof c[0]!="number"&&(this.mixKeyframes=Yh(YA,wS(c[0],c[1])),c=[0,100]);const D=A({...n,keyframes:c});x==="mirror"&&(this.mirroredGenerator=A({...n,keyframes:[...c].reverse(),velocity:-v})),D.calculatedDuration===null&&(D.calculatedDuration=pv(D));const{calculatedDuration:V}=D;this.calculatedDuration=V,this.resolvedDuration=V+g,this.totalDuration=this.resolvedDuration*(u+1)-g,this.generator=D}updateTime(n){const o=Math.round(n-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=o}tick(n,o=!1){const{generator:u,totalDuration:g,mixKeyframes:x,mirroredGenerator:v,resolvedDuration:c,calculatedDuration:A}=this;if(this.startTime===null)return u.next(0);const{delay:D=0,keyframes:V,repeat:L,repeatType:B,repeatDelay:se,type:ce,onUpdate:ge,finalKeyframe:Ce}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-g/this.speed,this.startTime)),o?this.currentTime=n:this.updateTime(n);const X=this.currentTime-D*(this.playbackSpeed>=0?1:-1),Z=this.playbackSpeed>=0?X<0:X>g;this.currentTime=Math.max(X,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=g);let W=this.currentTime,ve=u;if(L){const Me=Math.min(this.currentTime,g)/c;let ot=Math.floor(Me),at=Me%1;!at&&Me>=1&&(at=1),at===1&&ot--,ot=Math.min(ot,L+1),!!(ot%2)&&(B==="reverse"?(at=1-at,se&&(at-=se/c)):B==="mirror"&&(ve=v)),W=ks(0,1,at)*c}const Se=Z?{done:!1,value:V[0]}:ve.next(W);x&&(Se.value=x(Se.value));let{done:ke}=Se;!Z&&A!==null&&(ke=this.playbackSpeed>=0?this.currentTime>=g:this.currentTime<=0);const Ae=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ke);return Ae&&ce!==Vy&&(Se.value=fv(V,this.options,Ce,this.speed)),ge&&ge(Se.value),Ae&&this.finish(),Se}then(n,o){return this.finished.then(n,o)}get duration(){return Fr(this.calculatedDuration)}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+Fr(n)}get time(){return Fr(this.currentTime)}set time(n){var o;n=Ys(n),this.currentTime=n,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.playbackSpeed),(o=this.driver)==null||o.start(!1)}get speed(){return this.playbackSpeed}set speed(n){this.updateTime(Bn.now());const o=this.playbackSpeed!==n;this.playbackSpeed=n,o&&(this.time=Fr(this.currentTime))}play(){var g,x;if(this.isStopped)return;const{driver:n=LA,startTime:o}=this.options;this.driver||(this.driver=n(v=>this.tick(v))),(x=(g=this.options).onPlay)==null||x.call(g);const u=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=u):this.holdTime!==null?this.startTime=u-this.holdTime:this.startTime||(this.startTime=o??u),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Bn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var n,o;this.notifyFinished(),this.teardown(),this.state="finished",(o=(n=this.options).onComplete)==null||o.call(n)}cancel(){var n,o;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(o=(n=this.options).onCancel)==null||o.call(n)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}attachTimeline(n){var o;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(o=this.driver)==null||o.stop(),n.observe(this)}}function JA(e){for(let n=1;n<e.length;n++)e[n]??(e[n]=e[n-1])}const Yo=e=>e*180/Math.PI,Ny=e=>{const n=Yo(Math.atan2(e[1],e[0]));return Uy(n)},QA={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Ny,rotateZ:Ny,skewX:e=>Yo(Math.atan(e[1])),skewY:e=>Yo(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Uy=e=>(e=e%360,e<0&&(e+=360),e),E1=Ny,z1=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),D1=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),eM={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:z1,scaleY:D1,scale:e=>(z1(e)+D1(e))/2,rotateX:e=>Uy(Yo(Math.atan2(e[6],e[5]))),rotateY:e=>Uy(Yo(Math.atan2(-e[2],e[0]))),rotateZ:E1,rotate:E1,skewX:e=>Yo(Math.atan(e[4])),skewY:e=>Yo(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function $y(e){return e.includes("scale")?1:0}function Gy(e,n){if(!e||e==="none")return $y(n);const o=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let u,g;if(o)u=eM,g=o;else{const c=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);u=QA,g=c}if(!g)return $y(n);const x=u[n],v=g[1].split(",").map(iM);return typeof x=="function"?x(v):v[x]}const tM=(e,n)=>{const{transform:o="none"}=getComputedStyle(e);return Gy(o,n)};function iM(e){return parseFloat(e.trim())}const Vc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Nc=new Set(Vc),L1=e=>e===jc||e===nt,nM=new Set(["x","y","z"]),rM=Vc.filter(e=>!nM.has(e));function sM(e){const n=[];return rM.forEach(o=>{const u=e.getValue(o);u!==void 0&&(n.push([o,u.get()]),u.set(o.startsWith("scale")?1:0))}),n}const Za={width:({x:e},{paddingLeft:n="0",paddingRight:o="0"})=>e.max-e.min-parseFloat(n)-parseFloat(o),height:({y:e},{paddingTop:n="0",paddingBottom:o="0"})=>e.max-e.min-parseFloat(n)-parseFloat(o),top:(e,{top:n})=>parseFloat(n),left:(e,{left:n})=>parseFloat(n),bottom:({y:e},{top:n})=>parseFloat(n)+(e.max-e.min),right:({x:e},{left:n})=>parseFloat(n)+(e.max-e.min),x:(e,{transform:n})=>Gy(n,"x"),y:(e,{transform:n})=>Gy(n,"y")};Za.translateX=Za.x;Za.translateY=Za.y;const el=new Set;let Hy=!1,qy=!1,Zy=!1;function kS(){if(qy){const e=Array.from(el).filter(u=>u.needsMeasurement),n=new Set(e.map(u=>u.element)),o=new Map;n.forEach(u=>{const g=sM(u);g.length&&(o.set(u,g),u.render())}),e.forEach(u=>u.measureInitialState()),n.forEach(u=>{u.render();const g=o.get(u);g&&g.forEach(([x,v])=>{var c;(c=u.getValue(x))==null||c.set(v)})}),e.forEach(u=>u.measureEndState()),e.forEach(u=>{u.suspendedScrollY!==void 0&&window.scrollTo(0,u.suspendedScrollY)})}qy=!1,Hy=!1,el.forEach(e=>e.complete(Zy)),el.clear()}function CS(){el.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(qy=!0)})}function aM(){Zy=!0,CS(),kS(),Zy=!1}class yv{constructor(n,o,u,g,x,v=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...n],this.onComplete=o,this.name=u,this.motionValue=g,this.element=x,this.isAsync=v}scheduleResolve(){this.state="scheduled",this.isAsync?(el.add(this),Hy||(Hy=!0,li.read(CS),li.resolveKeyframes(kS))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:o,element:u,motionValue:g}=this;if(n[0]===null){const x=g==null?void 0:g.get(),v=n[n.length-1];if(x!==void 0)n[0]=x;else if(u&&o){const c=u.readValue(o,v);c!=null&&(n[0]=c)}n[0]===void 0&&(n[0]=v),g&&x===void 0&&g.set(n[0])}JA(n)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(n=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,n),el.delete(this)}cancel(){this.state==="scheduled"&&(el.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const oM=e=>e.startsWith("--");function lM(e,n,o){oM(n)?e.style.setProperty(n,o):e.style[n]=o}const cM=sv(()=>window.ScrollTimeline!==void 0),uM={};function hM(e,n){const o=sv(e);return()=>uM[n]??o()}const PS=hM(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ch=([e,n,o,u])=>`cubic-bezier(${e}, ${n}, ${o}, ${u})`,R1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ch([0,.65,.55,1]),circOut:ch([.55,0,1,.45]),backIn:ch([.31,.01,.66,-.59]),backOut:ch([.33,1.53,.69,.99])};function IS(e,n){if(e)return typeof e=="function"?PS()?bS(e,n):"ease-out":hS(e)?ch(e):Array.isArray(e)?e.map(o=>IS(o,n)||R1.easeOut):R1[e]}function dM(e,n,o,{delay:u=0,duration:g=300,repeat:x=0,repeatType:v="loop",ease:c="easeOut",times:A}={},D=void 0){const V={[n]:o};A&&(V.offset=A);const L=IS(c,g);Array.isArray(L)&&(V.easing=L);const B={delay:u,duration:g,easing:Array.isArray(L)?"linear":L,fill:"both",iterations:x+1,direction:v==="reverse"?"alternate":"normal"};return D&&(B.pseudoElement=D),e.animate(V,B)}function AS(e){return typeof e=="function"&&"applyToOptions"in e}function pM({type:e,...n}){return AS(e)&&PS()?e.applyToOptions(n):(n.duration??(n.duration=300),n.ease??(n.ease="easeOut"),n)}class fM extends mv{constructor(n){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!n)return;const{element:o,name:u,keyframes:g,pseudoElement:x,allowFlatten:v=!1,finalKeyframe:c,onComplete:A}=n;this.isPseudoElement=!!x,this.allowFlatten=v,this.options=n,rv(typeof n.type!="string");const D=pM(n);this.animation=dM(o,u,g,D,x),D.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!x){const V=fv(g,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(V):lM(o,u,V),this.animation.cancel()}A==null||A(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var n,o;(o=(n=this.animation).finish)==null||o.call(n)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:n}=this;n==="idle"||n==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var n,o;this.isPseudoElement||(o=(n=this.animation).commitStyles)==null||o.call(n)}get duration(){var o,u;const n=((u=(o=this.animation.effect)==null?void 0:o.getComputedTiming)==null?void 0:u.call(o).duration)||0;return Fr(Number(n))}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+Fr(n)}get time(){return Fr(Number(this.animation.currentTime)||0)}set time(n){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Ys(n)}get speed(){return this.animation.playbackRate}set speed(n){n<0&&(this.finishedTime=null),this.animation.playbackRate=n}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(n){this.manualStartTime=this.animation.startTime=n}attachTimeline({timeline:n,observe:o}){var u;return this.allowFlatten&&((u=this.animation.effect)==null||u.updateTiming({easing:"linear"})),this.animation.onfinish=null,n&&cM()?(this.animation.timeline=n,jr):o(this)}}const MS={anticipate:oS,backInOut:aS,circInOut:cS};function mM(e){return e in MS}function gM(e){typeof e.ease=="string"&&mM(e.ease)&&(e.ease=MS[e.ease])}const zg=10;class yM extends fM{constructor(n){gM(n),TS(n),super(n),n.startTime!==void 0&&(this.startTime=n.startTime),this.options=n}updateMotionValue(n){const{motionValue:o,onUpdate:u,onComplete:g,element:x,...v}=this.options;if(!o)return;if(n!==void 0){o.set(n);return}const c=new gv({...v,autoplay:!1}),A=Math.max(zg,Bn.now()-this.startTime),D=ks(0,zg,A-zg);o.setWithVelocity(c.sample(Math.max(0,A-D)).value,c.sample(A).value,D),c.stop()}}const B1=(e,n)=>n==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(so.test(e)||e==="0")&&!e.startsWith("url("));function _M(e){const n=e[0];if(e.length===1)return!0;for(let o=0;o<e.length;o++)if(e[o]!==n)return!0}function vM(e,n,o,u){const g=e[0];if(g===null)return!1;if(n==="display"||n==="visibility")return!0;const x=e[e.length-1],v=B1(g,n),c=B1(x,n);return!v||!c?!1:_M(e)||(o==="spring"||AS(o))&&u}function Wy(e){e.duration=0,e.type="keyframes"}const xM=new Set(["opacity","clipPath","filter","transform"]),wM=sv(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function bM(e){var V;const{motionValue:n,name:o,repeatDelay:u,repeatType:g,damping:x,type:v}=e;if(!(((V=n==null?void 0:n.owner)==null?void 0:V.current)instanceof HTMLElement))return!1;const{onUpdate:A,transformTemplate:D}=n.owner.getProps();return wM()&&o&&xM.has(o)&&(o!=="transform"||!D)&&!A&&!u&&g!=="mirror"&&x!==0&&v!=="inertia"}const SM=40;class TM extends mv{constructor({autoplay:n=!0,delay:o=0,type:u="keyframes",repeat:g=0,repeatDelay:x=0,repeatType:v="loop",keyframes:c,name:A,motionValue:D,element:V,...L}){var ce;super(),this.stop=()=>{var ge,Ce;this._animation&&(this._animation.stop(),(ge=this.stopTimeline)==null||ge.call(this)),(Ce=this.keyframeResolver)==null||Ce.cancel()},this.createdAt=Bn.now();const B={autoplay:n,delay:o,type:u,repeat:g,repeatDelay:x,repeatType:v,name:A,motionValue:D,element:V,...L},se=(V==null?void 0:V.KeyframeResolver)||yv;this.keyframeResolver=new se(c,(ge,Ce,X)=>this.onKeyframesResolved(ge,Ce,B,!X),A,D,V),(ce=this.keyframeResolver)==null||ce.scheduleResolve()}onKeyframesResolved(n,o,u,g){this.keyframeResolver=void 0;const{name:x,type:v,velocity:c,delay:A,isHandoff:D,onUpdate:V}=u;this.resolvedAt=Bn.now(),vM(n,x,v,c)||((ia.instantAnimations||!A)&&(V==null||V(fv(n,u,o))),n[0]=n[n.length-1],Wy(u),u.repeat=0);const B={startTime:g?this.resolvedAt?this.resolvedAt-this.createdAt>SM?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:o,...u,keyframes:n},se=!D&&bM(B)?new yM({...B,element:B.motionValue.owner.current}):new gv(B);se.finished.then(()=>this.notifyFinished()).catch(jr),this.pendingTimeline&&(this.stopTimeline=se.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=se}get finished(){return this._animation?this.animation.finished:this._finished}then(n,o){return this.finished.finally(n).then(()=>{})}get animation(){var n;return this._animation||((n=this.keyframeResolver)==null||n.resume(),aM()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(n){this.animation.time=n}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(n){this.animation.speed=n}get startTime(){return this.animation.startTime}attachTimeline(n){return this._animation?this.stopTimeline=this.animation.attachTimeline(n):this.pendingTimeline=n,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var n;this._animation&&this.animation.cancel(),(n=this.keyframeResolver)==null||n.cancel()}}const kM=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function CM(e){const n=kM.exec(e);if(!n)return[,];const[,o,u,g]=n;return[`--${o??u}`,g]}function ES(e,n,o=1){const[u,g]=CM(e);if(!u)return;const x=window.getComputedStyle(n).getPropertyValue(u);if(x){const v=x.trim();return J2(v)?parseFloat(v):v}return cv(g)?ES(g,n,o+1):g}function _v(e,n){return(e==null?void 0:e[n])??(e==null?void 0:e.default)??e}const zS=new Set(["width","height","top","left","right","bottom",...Vc]),PM={test:e=>e==="auto",parse:e=>e},DS=e=>n=>n.test(e),LS=[jc,nt,Ts,Va,_A,yA,PM],F1=e=>LS.find(DS(e));function IM(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||eS(e):!0}const AM=new Set(["brightness","contrast","saturate","opacity"]);function MM(e){const[n,o]=e.slice(0,-1).split("(");if(n==="drop-shadow")return e;const[u]=o.match(uv)||[];if(!u)return e;const g=o.replace(u,"");let x=AM.has(n)?1:0;return u!==o&&(x*=100),n+"("+x+g+")"}const EM=/\b([a-z-]*)\(.*?\)/gu,Xy={...so,getAnimatableNone:e=>{const n=e.match(EM);return n?n.map(MM).join(" "):e}},O1={...jc,transform:Math.round},zM={rotate:Va,rotateX:Va,rotateY:Va,rotateZ:Va,scale:wp,scaleX:wp,scaleY:wp,scaleZ:wp,skew:Va,skewX:Va,skewY:Va,distance:nt,translateX:nt,translateY:nt,translateZ:nt,x:nt,y:nt,z:nt,perspective:nt,transformPerspective:nt,opacity:Uh,originX:C1,originY:C1,originZ:nt},vv={borderWidth:nt,borderTopWidth:nt,borderRightWidth:nt,borderBottomWidth:nt,borderLeftWidth:nt,borderRadius:nt,radius:nt,borderTopLeftRadius:nt,borderTopRightRadius:nt,borderBottomRightRadius:nt,borderBottomLeftRadius:nt,width:nt,maxWidth:nt,height:nt,maxHeight:nt,top:nt,right:nt,bottom:nt,left:nt,inset:nt,insetBlock:nt,insetBlockStart:nt,insetBlockEnd:nt,insetInline:nt,insetInlineStart:nt,insetInlineEnd:nt,padding:nt,paddingTop:nt,paddingRight:nt,paddingBottom:nt,paddingLeft:nt,paddingBlock:nt,paddingBlockStart:nt,paddingBlockEnd:nt,paddingInline:nt,paddingInlineStart:nt,paddingInlineEnd:nt,margin:nt,marginTop:nt,marginRight:nt,marginBottom:nt,marginLeft:nt,marginBlock:nt,marginBlockStart:nt,marginBlockEnd:nt,marginInline:nt,marginInlineStart:nt,marginInlineEnd:nt,backgroundPositionX:nt,backgroundPositionY:nt,...zM,zIndex:O1,fillOpacity:Uh,strokeOpacity:Uh,numOctaves:O1},DM={...vv,color:zi,backgroundColor:zi,outlineColor:zi,fill:zi,stroke:zi,borderColor:zi,borderTopColor:zi,borderRightColor:zi,borderBottomColor:zi,borderLeftColor:zi,filter:Xy,WebkitFilter:Xy},RS=e=>DM[e];function BS(e,n){let o=RS(e);return o!==Xy&&(o=so),o.getAnimatableNone?o.getAnimatableNone(n):void 0}const LM=new Set(["auto","none","0"]);function RM(e,n,o){let u=0,g;for(;u<e.length&&!g;){const x=e[u];typeof x=="string"&&!LM.has(x)&&$h(x).values.length&&(g=e[u]),u++}if(g&&o)for(const x of n)e[x]=BS(o,g)}class BM extends yv{constructor(n,o,u,g,x){super(n,o,u,g,x,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:o,name:u}=this;if(!o||!o.current)return;super.readKeyframes();for(let V=0;V<n.length;V++){let L=n[V];if(typeof L=="string"&&(L=L.trim(),cv(L))){const B=ES(L,o.current);B!==void 0&&(n[V]=B),V===n.length-1&&(this.finalKeyframe=L)}}if(this.resolveNoneKeyframes(),!zS.has(u)||n.length!==2)return;const[g,x]=n,v=F1(g),c=F1(x),A=k1(g),D=k1(x);if(A!==D&&Za[u]){this.needsMeasurement=!0;return}if(v!==c)if(L1(v)&&L1(c))for(let V=0;V<n.length;V++){const L=n[V];typeof L=="string"&&(n[V]=parseFloat(L))}else Za[u]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:o}=this,u=[];for(let g=0;g<n.length;g++)(n[g]===null||IM(n[g]))&&u.push(g);u.length&&RM(n,u,o)}measureInitialState(){const{element:n,unresolvedKeyframes:o,name:u}=this;if(!n||!n.current)return;u==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Za[u](n.measureViewportBox(),window.getComputedStyle(n.current)),o[0]=this.measuredOrigin;const g=o[o.length-1];g!==void 0&&n.getValue(u,g).jump(g,!1)}measureEndState(){var c;const{element:n,name:o,unresolvedKeyframes:u}=this;if(!n||!n.current)return;const g=n.getValue(o);g&&g.jump(this.measuredOrigin,!1);const x=u.length-1,v=u[x];u[x]=Za[o](n.measureViewportBox(),window.getComputedStyle(n.current)),v!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=v),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([A,D])=>{n.getValue(A).set(D)}),this.resolveNoneKeyframes()}}function FM(e,n,o){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let u=document;const g=(o==null?void 0:o[e])??u.querySelectorAll(e);return g?Array.from(g):[]}return Array.from(e)}const FS=(e,n)=>n&&typeof e=="number"?n.transform(e):e;function OS(e){return Q2(e)&&"offsetHeight"in e}const j1=30,OM=e=>!isNaN(parseFloat(e));class jM{constructor(n,o={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=u=>{var x;const g=Bn.now();if(this.updatedAt!==g&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(u),this.current!==this.prev&&((x=this.events.change)==null||x.notify(this.current),this.dependents))for(const v of this.dependents)v.dirty()},this.hasAnimated=!1,this.setCurrent(n),this.owner=o.owner}setCurrent(n){this.current=n,this.updatedAt=Bn.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=OM(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,o){this.events[n]||(this.events[n]=new av);const u=this.events[n].add(o);return n==="change"?()=>{u(),li.read(()=>{this.events.change.getSize()||this.stop()})}:u}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,o){this.passiveEffect=n,this.stopPassiveEffect=o}set(n){this.passiveEffect?this.passiveEffect(n,this.updateAndNotify):this.updateAndNotify(n)}setWithVelocity(n,o,u){this.set(o),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-u}jump(n,o=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,o&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var n;(n=this.events.change)==null||n.notify(this.current)}addDependent(n){this.dependents||(this.dependents=new Set),this.dependents.add(n)}removeDependent(n){this.dependents&&this.dependents.delete(n)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=Bn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>j1)return 0;const o=Math.min(this.updatedAt-this.prevUpdatedAt,j1);return tS(parseFloat(this.current)-parseFloat(this.prevFrameValue),o)}start(n){return this.stop(),new Promise(o=>{this.hasAnimated=!0,this.animation=n(o),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var n,o;(n=this.dependents)==null||n.clear(),(o=this.events.destroy)==null||o.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Lc(e,n){return new jM(e,n)}const{schedule:xv}=dS(queueMicrotask,!1),Jr={x:!1,y:!1};function jS(){return Jr.x||Jr.y}function VM(e){return e==="x"||e==="y"?Jr[e]?null:(Jr[e]=!0,()=>{Jr[e]=!1}):Jr.x||Jr.y?null:(Jr.x=Jr.y=!0,()=>{Jr.x=Jr.y=!1})}function VS(e,n){const o=FM(e),u=new AbortController,g={passive:!0,...n,signal:u.signal};return[o,g,()=>u.abort()]}function V1(e){return!(e.pointerType==="touch"||jS())}function NM(e,n,o={}){const[u,g,x]=VS(e,o),v=c=>{if(!V1(c))return;const{target:A}=c,D=n(A,c);if(typeof D!="function"||!A)return;const V=L=>{V1(L)&&(D(L),A.removeEventListener("pointerleave",V))};A.addEventListener("pointerleave",V,g)};return u.forEach(c=>{c.addEventListener("pointerenter",v,g)}),x}const NS=(e,n)=>n?e===n?!0:NS(e,n.parentElement):!1,wv=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,UM=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function US(e){return UM.has(e.tagName)||e.isContentEditable===!0}const Vp=new WeakSet;function N1(e){return n=>{n.key==="Enter"&&e(n)}}function Dg(e,n){e.dispatchEvent(new PointerEvent("pointer"+n,{isPrimary:!0,bubbles:!0}))}const $M=(e,n)=>{const o=e.currentTarget;if(!o)return;const u=N1(()=>{if(Vp.has(o))return;Dg(o,"down");const g=N1(()=>{Dg(o,"up")}),x=()=>Dg(o,"cancel");o.addEventListener("keyup",g,n),o.addEventListener("blur",x,n)});o.addEventListener("keydown",u,n),o.addEventListener("blur",()=>o.removeEventListener("keydown",u),n)};function U1(e){return wv(e)&&!jS()}function GM(e,n,o={}){const[u,g,x]=VS(e,o),v=c=>{const A=c.currentTarget;if(!U1(c))return;Vp.add(A);const D=n(A,c),V=(se,ce)=>{window.removeEventListener("pointerup",L),window.removeEventListener("pointercancel",B),Vp.has(A)&&Vp.delete(A),U1(se)&&typeof D=="function"&&D(se,{success:ce})},L=se=>{V(se,A===window||A===document||o.useGlobalTarget||NS(A,se.target))},B=se=>{V(se,!1)};window.addEventListener("pointerup",L,g),window.addEventListener("pointercancel",B,g)};return u.forEach(c=>{(o.useGlobalTarget?window:c).addEventListener("pointerdown",v,g),OS(c)&&(c.addEventListener("focus",D=>$M(D,g)),!US(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),x}function $S(e){return Q2(e)&&"ownerSVGElement"in e}function HM(e){return $S(e)&&e.tagName==="svg"}const Tn=e=>!!(e&&e.getVelocity),qM=[...LS,zi,so],ZM=e=>qM.find(DS(e)),bv=De.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function $1(e,n){if(typeof e=="function")return e(n);e!=null&&(e.current=n)}function WM(...e){return n=>{let o=!1;const u=e.map(g=>{const x=$1(g,n);return!o&&typeof x=="function"&&(o=!0),x});if(o)return()=>{for(let g=0;g<u.length;g++){const x=u[g];typeof x=="function"?x():$1(e[g],null)}}}}function XM(...e){return De.useCallback(WM(...e),e)}class KM extends De.Component{getSnapshotBeforeUpdate(n){const o=this.props.childRef.current;if(o&&n.isPresent&&!this.props.isPresent){const u=o.offsetParent,g=OS(u)&&u.offsetWidth||0,x=this.props.sizeRef.current;x.height=o.offsetHeight||0,x.width=o.offsetWidth||0,x.top=o.offsetTop,x.left=o.offsetLeft,x.right=g-x.width-x.left}return null}componentDidUpdate(){}render(){return this.props.children}}function YM({children:e,isPresent:n,anchorX:o,root:u}){var V;const g=De.useId(),x=De.useRef(null),v=De.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=De.useContext(bv),A=((V=e.props)==null?void 0:V.ref)??(e==null?void 0:e.ref),D=XM(x,A);return De.useInsertionEffect(()=>{const{width:L,height:B,top:se,left:ce,right:ge}=v.current;if(n||!x.current||!L||!B)return;const Ce=o==="left"?`left: ${ce}`:`right: ${ge}`;x.current.dataset.motionPopId=g;const X=document.createElement("style");c&&(X.nonce=c);const Z=u??document.head;return Z.appendChild(X),X.sheet&&X.sheet.insertRule(`
          [data-motion-pop-id="${g}"] {
            position: absolute !important;
            width: ${L}px !important;
            height: ${B}px !important;
            ${Ce}px !important;
            top: ${se}px !important;
          }
        `),()=>{Z.contains(X)&&Z.removeChild(X)}},[n]),_e.jsx(KM,{isPresent:n,childRef:x,sizeRef:v,children:De.cloneElement(e,{ref:D})})}const JM=({children:e,initial:n,isPresent:o,onExitComplete:u,custom:g,presenceAffectsLayout:x,mode:v,anchorX:c,root:A})=>{const D=ev(QM),V=De.useId();let L=!0,B=De.useMemo(()=>(L=!1,{id:V,initial:n,isPresent:o,custom:g,onExitComplete:se=>{D.set(se,!0);for(const ce of D.values())if(!ce)return;u&&u()},register:se=>(D.set(se,!1),()=>D.delete(se))}),[o,D,u]);return x&&L&&(B={...B}),De.useMemo(()=>{D.forEach((se,ce)=>D.set(ce,!1))},[o]),De.useEffect(()=>{!o&&!D.size&&u&&u()},[o]),v==="popLayout"&&(e=_e.jsx(YM,{isPresent:o,anchorX:c,root:A,children:e})),_e.jsx(Bf.Provider,{value:B,children:e})};function QM(){return new Map}function GS(e=!0){const n=De.useContext(Bf);if(n===null)return[!0,null];const{isPresent:o,onExitComplete:u,register:g}=n,x=De.useId();De.useEffect(()=>{if(e)return g(x)},[e]);const v=De.useCallback(()=>e&&u&&u(x),[x,u,e]);return!o&&u?[!1,v]:[!0]}const bp=e=>e.key||"";function G1(e){const n=[];return De.Children.forEach(e,o=>{De.isValidElement(o)&&n.push(o)}),n}const kc=({children:e,custom:n,initial:o=!0,onExitComplete:u,presenceAffectsLayout:g=!0,mode:x="sync",propagate:v=!1,anchorX:c="left",root:A})=>{const[D,V]=GS(v),L=De.useMemo(()=>G1(e),[e]),B=v&&!D?[]:L.map(bp),se=De.useRef(!0),ce=De.useRef(L),ge=ev(()=>new Map),Ce=De.useRef(new Set),[X,Z]=De.useState(L),[W,ve]=De.useState(L);Y2(()=>{se.current=!1,ce.current=L;for(let Ae=0;Ae<W.length;Ae++){const Me=bp(W[Ae]);B.includes(Me)?(ge.delete(Me),Ce.current.delete(Me)):ge.get(Me)!==!0&&ge.set(Me,!1)}},[W,B.length,B.join("-")]);const Se=[];if(L!==X){let Ae=[...L];for(let Me=0;Me<W.length;Me++){const ot=W[Me],at=bp(ot);B.includes(at)||(Ae.splice(Me,0,ot),Se.push(ot))}return x==="wait"&&Se.length&&(Ae=Se),ve(G1(Ae)),Z(L),null}const{forceRender:ke}=De.useContext(Q_);return _e.jsx(_e.Fragment,{children:W.map(Ae=>{const Me=bp(Ae),ot=v&&!D?!1:L===W||B.includes(Me),at=()=>{if(Ce.current.has(Me))return;if(Ce.current.add(Me),ge.has(Me))ge.set(Me,!0);else return;let pt=!0;ge.forEach(Vi=>{Vi||(pt=!1)}),pt&&(ke==null||ke(),ve(ce.current),v&&(V==null||V()),u&&u())};return _e.jsx(JM,{isPresent:ot,initial:!se.current||o?void 0:!1,custom:n,presenceAffectsLayout:g,mode:x,root:A,onExitComplete:ot?void 0:at,anchorX:c,children:Ae},Me)})})},HS=De.createContext({strict:!1}),H1={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Rc={};for(const e in H1)Rc[e]={isEnabled:n=>H1[e].some(o=>!!n[o])};function eE(e){for(const n in e)Rc[n]={...Rc[n],...e[n]}}const tE=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function yf(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||tE.has(e)}let qS=e=>!yf(e);function iE(e){typeof e=="function"&&(qS=n=>n.startsWith("on")?!yf(n):e(n))}try{iE(require("@emotion/is-prop-valid").default)}catch{}function nE(e,n,o){const u={};for(const g in e)g==="values"&&typeof e.values=="object"||(qS(g)||o===!0&&yf(g)||!n&&!yf(g)||e.draggable&&g.startsWith("onDrag"))&&(u[g]=e[g]);return u}const Ff=De.createContext({});function Of(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Gh(e){return typeof e=="string"||Array.isArray(e)}const Sv=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Tv=["initial",...Sv];function jf(e){return Of(e.animate)||Tv.some(n=>Gh(e[n]))}function ZS(e){return!!(jf(e)||e.variants)}function rE(e,n){if(jf(e)){const{initial:o,animate:u}=e;return{initial:o===!1||Gh(o)?o:void 0,animate:Gh(u)?u:void 0}}return e.inherit!==!1?n:{}}function sE(e){const{initial:n,animate:o}=rE(e,De.useContext(Ff));return De.useMemo(()=>({initial:n,animate:o}),[q1(n),q1(o)])}function q1(e){return Array.isArray(e)?e.join(" "):e}function Z1(e,n){return n.max===n.min?0:e/(n.max-n.min)*100}const rh={correct:(e,n)=>{if(!n.target)return e;if(typeof e=="string")if(nt.test(e))e=parseFloat(e);else return e;const o=Z1(e,n.target.x),u=Z1(e,n.target.y);return`${o}% ${u}%`}},aE={correct:(e,{treeScale:n,projectionDelta:o})=>{const u=e,g=so.parse(e);if(g.length>5)return u;const x=so.createTransformer(e),v=typeof g[0]!="number"?1:0,c=o.x.scale*n.x,A=o.y.scale*n.y;g[0+v]/=c,g[1+v]/=A;const D=yi(c,A,.5);return typeof g[2+v]=="number"&&(g[2+v]/=D),typeof g[3+v]=="number"&&(g[3+v]/=D),x(g)}},Ky={borderRadius:{...rh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:rh,borderTopRightRadius:rh,borderBottomLeftRadius:rh,borderBottomRightRadius:rh,boxShadow:aE};function WS(e,{layout:n,layoutId:o}){return Nc.has(e)||e.startsWith("origin")||(n||o!==void 0)&&(!!Ky[e]||e==="opacity")}const oE={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lE=Vc.length;function cE(e,n,o){let u="",g=!0;for(let x=0;x<lE;x++){const v=Vc[x],c=e[v];if(c===void 0)continue;let A=!0;if(typeof c=="number"?A=c===(v.startsWith("scale")?1:0):A=parseFloat(c)===0,!A||o){const D=FS(c,vv[v]);if(!A){g=!1;const V=oE[v]||v;u+=`${V}(${D}) `}o&&(n[v]=D)}}return u=u.trim(),o?u=o(n,g?"":u):g&&(u="none"),u}function kv(e,n,o){const{style:u,vars:g,transformOrigin:x}=e;let v=!1,c=!1;for(const A in n){const D=n[A];if(Nc.has(A)){v=!0;continue}else if(fS(A)){g[A]=D;continue}else{const V=FS(D,vv[A]);A.startsWith("origin")?(c=!0,x[A]=V):u[A]=V}}if(n.transform||(v||o?u.transform=cE(n,e.transform,o):u.transform&&(u.transform="none")),c){const{originX:A="50%",originY:D="50%",originZ:V=0}=x;u.transformOrigin=`${A} ${D} ${V}`}}const Cv=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function XS(e,n,o){for(const u in n)!Tn(n[u])&&!WS(u,o)&&(e[u]=n[u])}function uE({transformTemplate:e},n){return De.useMemo(()=>{const o=Cv();return kv(o,n,e),Object.assign({},o.vars,o.style)},[n])}function hE(e,n){const o=e.style||{},u={};return XS(u,o,e),Object.assign(u,uE(e,n)),u}function dE(e,n){const o={},u=hE(e,n);return e.drag&&e.dragListener!==!1&&(o.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(o.tabIndex=0),o.style=u,o}const pE={offset:"stroke-dashoffset",array:"stroke-dasharray"},fE={offset:"strokeDashoffset",array:"strokeDasharray"};function mE(e,n,o=1,u=0,g=!0){e.pathLength=1;const x=g?pE:fE;e[x.offset]=nt.transform(-u);const v=nt.transform(n),c=nt.transform(o);e[x.array]=`${v} ${c}`}const gE=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function KS(e,{attrX:n,attrY:o,attrScale:u,pathLength:g,pathSpacing:x=1,pathOffset:v=0,...c},A,D,V){if(kv(e,c,D),A){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:L,style:B}=e;L.transform&&(B.transform=L.transform,delete L.transform),(B.transform||L.transformOrigin)&&(B.transformOrigin=L.transformOrigin??"50% 50%",delete L.transformOrigin),B.transform&&(B.transformBox=(V==null?void 0:V.transformBox)??"fill-box",delete L.transformBox);for(const se of gE)L[se]!==void 0&&(B[se]=L[se],delete L[se]);n!==void 0&&(L.x=n),o!==void 0&&(L.y=o),u!==void 0&&(L.scale=u),g!==void 0&&mE(L,g,x,v,!1)}const YS=()=>({...Cv(),attrs:{}}),JS=e=>typeof e=="string"&&e.toLowerCase()==="svg";function yE(e,n,o,u){const g=De.useMemo(()=>{const x=YS();return KS(x,n,JS(u),e.transformTemplate,e.style),{...x.attrs,style:{...x.style}}},[n]);if(e.style){const x={};XS(x,e.style,e),g.style={...x,...g.style}}return g}const _E=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Pv(e){return typeof e!="string"||e.includes("-")?!1:!!(_E.indexOf(e)>-1||/[A-Z]/u.test(e))}function vE(e,n,o,{latestValues:u},g,x=!1,v){const A=(v??Pv(e)?yE:dE)(n,u,g,e),D=nE(n,typeof e=="string",x),V=e!==De.Fragment?{...D,...A,ref:o}:{},{children:L}=n,B=De.useMemo(()=>Tn(L)?L.get():L,[L]);return De.createElement(e,{...V,children:B})}function W1(e){const n=[{},{}];return e==null||e.values.forEach((o,u)=>{n[0][u]=o.get(),n[1][u]=o.getVelocity()}),n}function Iv(e,n,o,u){if(typeof n=="function"){const[g,x]=W1(u);n=n(o!==void 0?o:e.custom,g,x)}if(typeof n=="string"&&(n=e.variants&&e.variants[n]),typeof n=="function"){const[g,x]=W1(u);n=n(o!==void 0?o:e.custom,g,x)}return n}function Np(e){return Tn(e)?e.get():e}function xE({scrapeMotionValuesFromProps:e,createRenderState:n},o,u,g){return{latestValues:wE(o,u,g,e),renderState:n()}}function wE(e,n,o,u){const g={},x=u(e,{});for(const B in x)g[B]=Np(x[B]);let{initial:v,animate:c}=e;const A=jf(e),D=ZS(e);n&&D&&!A&&e.inherit!==!1&&(v===void 0&&(v=n.initial),c===void 0&&(c=n.animate));let V=o?o.initial===!1:!1;V=V||v===!1;const L=V?c:v;if(L&&typeof L!="boolean"&&!Of(L)){const B=Array.isArray(L)?L:[L];for(let se=0;se<B.length;se++){const ce=Iv(e,B[se]);if(ce){const{transitionEnd:ge,transition:Ce,...X}=ce;for(const Z in X){let W=X[Z];if(Array.isArray(W)){const ve=V?W.length-1:0;W=W[ve]}W!==null&&(g[Z]=W)}for(const Z in ge)g[Z]=ge[Z]}}}return g}const QS=e=>(n,o)=>{const u=De.useContext(Ff),g=De.useContext(Bf),x=()=>xE(e,n,u,g);return o?x():ev(x)};function Av(e,n,o){var x;const{style:u}=e,g={};for(const v in u)(Tn(u[v])||n.style&&Tn(n.style[v])||WS(v,e)||((x=o==null?void 0:o.getValue(v))==null?void 0:x.liveStyle)!==void 0)&&(g[v]=u[v]);return g}const bE=QS({scrapeMotionValuesFromProps:Av,createRenderState:Cv});function eT(e,n,o){const u=Av(e,n,o);for(const g in e)if(Tn(e[g])||Tn(n[g])){const x=Vc.indexOf(g)!==-1?"attr"+g.charAt(0).toUpperCase()+g.substring(1):g;u[x]=e[g]}return u}const SE=QS({scrapeMotionValuesFromProps:eT,createRenderState:YS}),TE=Symbol.for("motionComponentSymbol");function kE(e,n,o){const u=De.useRef(o);De.useInsertionEffect(()=>{u.current=o});const g=De.useRef(null);return De.useCallback(x=>{var c;x&&((c=e.onMount)==null||c.call(e,x)),n&&(x?n.mount(x):n.unmount());const v=u.current;if(typeof v=="function")if(x){const A=v(x);typeof A=="function"&&(g.current=A)}else g.current?(g.current(),g.current=null):v(x);else v&&(v.current=x)},[n])}const Mv=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),CE="framerAppearId",tT="data-"+Mv(CE),iT=De.createContext({});function uh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function PE(e,n,o,u,g,x){var Ce,X;const{visualElement:v}=De.useContext(Ff),c=De.useContext(HS),A=De.useContext(Bf),D=De.useContext(bv).reducedMotion,V=De.useRef(null);u=u||c.renderer,!V.current&&u&&(V.current=u(e,{visualState:n,parent:v,props:o,presenceContext:A,blockInitialAnimation:A?A.initial===!1:!1,reducedMotionConfig:D,isSVG:x}));const L=V.current,B=De.useContext(iT);L&&!L.projection&&g&&(L.type==="html"||L.type==="svg")&&IE(V.current,o,g,B);const se=De.useRef(!1);De.useInsertionEffect(()=>{L&&se.current&&L.update(o,A)});const ce=o[tT],ge=De.useRef(!!ce&&!((Ce=window.MotionHandoffIsComplete)!=null&&Ce.call(window,ce))&&((X=window.MotionHasOptimisedAnimation)==null?void 0:X.call(window,ce)));return Y2(()=>{L&&(se.current=!0,window.MotionIsMounted=!0,L.updateFeatures(),L.scheduleRenderMicrotask(),ge.current&&L.animationState&&L.animationState.animateChanges())}),De.useEffect(()=>{L&&(!ge.current&&L.animationState&&L.animationState.animateChanges(),ge.current&&(queueMicrotask(()=>{var Z;(Z=window.MotionHandoffMarkAsComplete)==null||Z.call(window,ce)}),ge.current=!1),L.enteringChildren=void 0)}),L}function IE(e,n,o,u){const{layoutId:g,layout:x,drag:v,dragConstraints:c,layoutScroll:A,layoutRoot:D,layoutCrossfade:V}=n;e.projection=new o(e.latestValues,n["data-framer-portal-id"]?void 0:nT(e.parent)),e.projection.setOptions({layoutId:g,layout:x,alwaysMeasureLayout:!!v||c&&uh(c),visualElement:e,animationType:typeof x=="string"?x:"both",initialPromotionConfig:u,crossfade:V,layoutScroll:A,layoutRoot:D})}function nT(e){if(e)return e.options.allowProjection!==!1?e.projection:nT(e.parent)}function Lg(e,{forwardMotionProps:n=!1,type:o}={},u,g){u&&eE(u);const x=o?o==="svg":Pv(e),v=x?SE:bE;function c(D,V){let L;const B={...De.useContext(bv),...D,layoutId:AE(D)},{isStatic:se}=B,ce=sE(D),ge=v(D,se);if(!se&&tv){ME();const Ce=EE(B);L=Ce.MeasureLayout,ce.visualElement=PE(e,ge,B,g,Ce.ProjectionNode,x)}return _e.jsxs(Ff.Provider,{value:ce,children:[L&&ce.visualElement?_e.jsx(L,{visualElement:ce.visualElement,...B}):null,vE(e,D,kE(ge,ce.visualElement,V),ge,se,n,x)]})}c.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const A=De.forwardRef(c);return A[TE]=e,A}function AE({layoutId:e}){const n=De.useContext(Q_).id;return n&&e!==void 0?n+"-"+e:e}function ME(e,n){De.useContext(HS).strict}function EE(e){const{drag:n,layout:o}=Rc;if(!n&&!o)return{};const u={...n,...o};return{MeasureLayout:n!=null&&n.isEnabled(e)||o!=null&&o.isEnabled(e)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}function zE(e,n){if(typeof Proxy>"u")return Lg;const o=new Map,u=(x,v)=>Lg(x,v,e,n),g=(x,v)=>u(x,v);return new Proxy(g,{get:(x,v)=>v==="create"?u:(o.has(v)||o.set(v,Lg(v,void 0,e,n)),o.get(v))})}function rT({top:e,left:n,right:o,bottom:u}){return{x:{min:n,max:o},y:{min:e,max:u}}}function DE({x:e,y:n}){return{top:n.min,right:e.max,bottom:n.max,left:e.min}}function LE(e,n){if(!n)return e;const o=n({x:e.left,y:e.top}),u=n({x:e.right,y:e.bottom});return{top:o.y,left:o.x,bottom:u.y,right:u.x}}function Rg(e){return e===void 0||e===1}function Yy({scale:e,scaleX:n,scaleY:o}){return!Rg(e)||!Rg(n)||!Rg(o)}function qo(e){return Yy(e)||sT(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function sT(e){return X1(e.x)||X1(e.y)}function X1(e){return e&&e!=="0%"}function _f(e,n,o){const u=e-o,g=n*u;return o+g}function K1(e,n,o,u,g){return g!==void 0&&(e=_f(e,g,u)),_f(e,o,u)+n}function Jy(e,n=0,o=1,u,g){e.min=K1(e.min,n,o,u,g),e.max=K1(e.max,n,o,u,g)}function aT(e,{x:n,y:o}){Jy(e.x,n.translate,n.scale,n.originPoint),Jy(e.y,o.translate,o.scale,o.originPoint)}const Y1=.999999999999,J1=1.0000000000001;function RE(e,n,o,u=!1){const g=o.length;if(!g)return;n.x=n.y=1;let x,v;for(let c=0;c<g;c++){x=o[c],v=x.projectionDelta;const{visualElement:A}=x.options;A&&A.props.style&&A.props.style.display==="contents"||(u&&x.options.layoutScroll&&x.scroll&&x!==x.root&&yc(e,{x:-x.scroll.offset.x,y:-x.scroll.offset.y}),v&&(n.x*=v.x.scale,n.y*=v.y.scale,aT(e,v)),u&&qo(x.latestValues)&&yc(e,x.latestValues))}n.x<J1&&n.x>Y1&&(n.x=1),n.y<J1&&n.y>Y1&&(n.y=1)}function gc(e,n){e.min=e.min+n,e.max=e.max+n}function Q1(e,n,o,u,g=.5){const x=yi(e.min,e.max,g);Jy(e,n,o,x,u)}function yc(e,n){Q1(e.x,n.x,n.scaleX,n.scale,n.originX),Q1(e.y,n.y,n.scaleY,n.scale,n.originY)}function oT(e,n){return rT(LE(e.getBoundingClientRect(),n))}function BE(e,n,o){const u=oT(e,o),{scroll:g}=n;return g&&(gc(u.x,g.offset.x),gc(u.y,g.offset.y)),u}const ew=()=>({translate:0,scale:1,origin:0,originPoint:0}),_c=()=>({x:ew(),y:ew()}),tw=()=>({min:0,max:0}),Fi=()=>({x:tw(),y:tw()}),Qy={current:null},lT={current:!1};function FE(){if(lT.current=!0,!!tv)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),n=()=>Qy.current=e.matches;e.addEventListener("change",n),n()}else Qy.current=!1}const OE=new WeakMap;function jE(e,n,o){for(const u in n){const g=n[u],x=o[u];if(Tn(g))e.addValue(u,g);else if(Tn(x))e.addValue(u,Lc(g,{owner:e}));else if(x!==g)if(e.hasValue(u)){const v=e.getValue(u);v.liveStyle===!0?v.jump(g):v.hasAnimated||v.set(g)}else{const v=e.getStaticValue(u);e.addValue(u,Lc(v!==void 0?v:g,{owner:e}))}}for(const u in o)n[u]===void 0&&e.removeValue(u);return n}const iw=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VE{scrapeMotionValuesFromProps(n,o,u){return{}}constructor({parent:n,props:o,presenceContext:u,reducedMotionConfig:g,blockInitialAnimation:x,visualState:v},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=yv,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const B=Bn.now();this.renderScheduledAt<B&&(this.renderScheduledAt=B,li.render(this.render,!1,!0))};const{latestValues:A,renderState:D}=v;this.latestValues=A,this.baseTarget={...A},this.initialValues=o.initial?{...A}:{},this.renderState=D,this.parent=n,this.props=o,this.presenceContext=u,this.depth=n?n.depth+1:0,this.reducedMotionConfig=g,this.options=c,this.blockInitialAnimation=!!x,this.isControllingVariants=jf(o),this.isVariantNode=ZS(o),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:V,...L}=this.scrapeMotionValuesFromProps(o,{},this);for(const B in L){const se=L[B];A[B]!==void 0&&Tn(se)&&se.set(A[B])}}mount(n){var o;this.current=n,OE.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((u,g)=>this.bindToMotionValue(g,u)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(lT.current||FE(),this.shouldReduceMotion=Qy.current),(o=this.parent)==null||o.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var n;this.projection&&this.projection.unmount(),ro(this.notifyUpdate),ro(this.render),this.valueSubscriptions.forEach(o=>o()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(n=this.parent)==null||n.removeChild(this);for(const o in this.events)this.events[o].clear();for(const o in this.features){const u=this.features[o];u&&(u.unmount(),u.isMounted=!1)}this.current=null}addChild(n){this.children.add(n),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(n)}removeChild(n){this.children.delete(n),this.enteringChildren&&this.enteringChildren.delete(n)}bindToMotionValue(n,o){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const u=Nc.has(n);u&&this.onBindTransform&&this.onBindTransform();const g=o.on("change",v=>{this.latestValues[n]=v,this.props.onUpdate&&li.preRender(this.notifyUpdate),u&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let x;window.MotionCheckAppearSync&&(x=window.MotionCheckAppearSync(this,n,o)),this.valueSubscriptions.set(n,()=>{g(),x&&x(),o.owner&&o.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in Rc){const o=Rc[n];if(!o)continue;const{isEnabled:u,Feature:g}=o;if(!this.features[n]&&g&&u(this.props)&&(this.features[n]=new g(this)),this.features[n]){const x=this.features[n];x.isMounted?x.update():(x.mount(),x.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Fi()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,o){this.latestValues[n]=o}update(n,o){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=o;for(let u=0;u<iw.length;u++){const g=iw[u];this.propEventSubscriptions[g]&&(this.propEventSubscriptions[g](),delete this.propEventSubscriptions[g]);const x="on"+g,v=n[x];v&&(this.propEventSubscriptions[g]=this.on(g,v))}this.prevMotionValues=jE(this,this.scrapeMotionValuesFromProps(n,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const o=this.getClosestVariantNode();if(o)return o.variantChildren&&o.variantChildren.add(n),()=>o.variantChildren.delete(n)}addValue(n,o){const u=this.values.get(n);o!==u&&(u&&this.removeValue(n),this.bindToMotionValue(n,o),this.values.set(n,o),this.latestValues[n]=o.get())}removeValue(n){this.values.delete(n);const o=this.valueSubscriptions.get(n);o&&(o(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,o){if(this.props.values&&this.props.values[n])return this.props.values[n];let u=this.values.get(n);return u===void 0&&o!==void 0&&(u=Lc(o===null?void 0:o,{owner:this}),this.addValue(n,u)),u}readValue(n,o){let u=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:this.getBaseTargetFromProps(this.props,n)??this.readValueFromInstance(this.current,n,this.options);return u!=null&&(typeof u=="string"&&(J2(u)||eS(u))?u=parseFloat(u):!ZM(u)&&so.test(o)&&(u=BS(n,o)),this.setBaseTarget(n,Tn(u)?u.get():u)),Tn(u)?u.get():u}setBaseTarget(n,o){this.baseTarget[n]=o}getBaseTarget(n){var x;const{initial:o}=this.props;let u;if(typeof o=="string"||typeof o=="object"){const v=Iv(this.props,o,(x=this.presenceContext)==null?void 0:x.custom);v&&(u=v[n])}if(o&&u!==void 0)return u;const g=this.getBaseTargetFromProps(this.props,n);return g!==void 0&&!Tn(g)?g:this.initialValues[n]!==void 0&&u===void 0?void 0:this.baseTarget[n]}on(n,o){return this.events[n]||(this.events[n]=new av),this.events[n].add(o)}notify(n,...o){this.events[n]&&this.events[n].notify(...o)}scheduleRenderMicrotask(){xv.render(this.render)}}class cT extends VE{constructor(){super(...arguments),this.KeyframeResolver=BM}sortInstanceNodePosition(n,o){return n.compareDocumentPosition(o)&2?1:-1}getBaseTargetFromProps(n,o){return n.style?n.style[o]:void 0}removeValueFromRenderState(n,{vars:o,style:u}){delete o[n],delete u[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;Tn(n)&&(this.childSubscription=n.on("change",o=>{this.current&&(this.current.textContent=`${o}`)}))}}function uT(e,{style:n,vars:o},u,g){const x=e.style;let v;for(v in n)x[v]=n[v];g==null||g.applyProjectionStyles(x,u);for(v in o)x.setProperty(v,o[v])}function NE(e){return window.getComputedStyle(e)}class UE extends cT{constructor(){super(...arguments),this.type="html",this.renderInstance=uT}readValueFromInstance(n,o){var u;if(Nc.has(o))return(u=this.projection)!=null&&u.isProjecting?$y(o):tM(n,o);{const g=NE(n),x=(fS(o)?g.getPropertyValue(o):g[o])||0;return typeof x=="string"?x.trim():x}}measureInstanceViewportBox(n,{transformPagePoint:o}){return oT(n,o)}build(n,o,u){kv(n,o,u.transformTemplate)}scrapeMotionValuesFromProps(n,o,u){return Av(n,o,u)}}const hT=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function $E(e,n,o,u){uT(e,n,void 0,u);for(const g in n.attrs)e.setAttribute(hT.has(g)?g:Mv(g),n.attrs[g])}class GE extends cT{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Fi}getBaseTargetFromProps(n,o){return n[o]}readValueFromInstance(n,o){if(Nc.has(o)){const u=RS(o);return u&&u.default||0}return o=hT.has(o)?o:Mv(o),n.getAttribute(o)}scrapeMotionValuesFromProps(n,o,u){return eT(n,o,u)}build(n,o,u){KS(n,o,this.isSVGTag,u.transformTemplate,u.style)}renderInstance(n,o,u,g){$E(n,o,u,g)}mount(n){this.isSVGTag=JS(n.tagName),super.mount(n)}}const HE=(e,n)=>n.isSVG??Pv(e)?new GE(n):new UE(n,{allowProjection:e!==De.Fragment});function Cc(e,n,o){const u=e.getProps();return Iv(u,n,o!==void 0?o:u.custom,e)}const e_=e=>Array.isArray(e);function qE(e,n,o){e.hasValue(n)?e.getValue(n).set(o):e.addValue(n,Lc(o))}function ZE(e){return e_(e)?e[e.length-1]||0:e}function WE(e,n){const o=Cc(e,n);let{transitionEnd:u={},transition:g={},...x}=o||{};x={...x,...u};for(const v in x){const c=ZE(x[v]);qE(e,v,c)}}function XE(e){return!!(Tn(e)&&e.add)}function t_(e,n){const o=e.getValue("willChange");if(XE(o))return o.add(n);if(!o&&ia.WillChange){const u=new ia.WillChange("auto");e.addValue("willChange",u),u.add(n)}}function dT(e){return e.props[tT]}const KE=e=>e!==null;function YE(e,{repeat:n,repeatType:o="loop"},u){const g=e.filter(KE),x=n&&o!=="loop"&&n%2===1?0:g.length-1;return g[x]}const JE={type:"spring",stiffness:500,damping:25,restSpeed:10},QE=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),ez={type:"keyframes",duration:.8},tz={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},iz=(e,{keyframes:n})=>n.length>2?ez:Nc.has(e)?e.startsWith("scale")?QE(n[1]):JE:tz;function nz({when:e,delay:n,delayChildren:o,staggerChildren:u,staggerDirection:g,repeat:x,repeatType:v,repeatDelay:c,from:A,elapsed:D,...V}){return!!Object.keys(V).length}const Ev=(e,n,o,u={},g,x)=>v=>{const c=_v(u,e)||{},A=c.delay||u.delay||0;let{elapsed:D=0}=u;D=D-Ys(A);const V={keyframes:Array.isArray(o)?o:[null,o],ease:"easeOut",velocity:n.getVelocity(),...c,delay:-D,onUpdate:B=>{n.set(B),c.onUpdate&&c.onUpdate(B)},onComplete:()=>{v(),c.onComplete&&c.onComplete()},name:e,motionValue:n,element:x?void 0:g};nz(c)||Object.assign(V,iz(e,V)),V.duration&&(V.duration=Ys(V.duration)),V.repeatDelay&&(V.repeatDelay=Ys(V.repeatDelay)),V.from!==void 0&&(V.keyframes[0]=V.from);let L=!1;if((V.type===!1||V.duration===0&&!V.repeatDelay)&&(Wy(V),V.delay===0&&(L=!0)),(ia.instantAnimations||ia.skipAnimations)&&(L=!0,Wy(V),V.delay=0),V.allowFlatten=!c.type&&!c.ease,L&&!x&&n.get()!==void 0){const B=YE(V.keyframes,c);if(B!==void 0){li.update(()=>{V.onUpdate(B),V.onComplete()});return}}return c.isSync?new gv(V):new TM(V)};function rz({protectedKeys:e,needsAnimating:n},o){const u=e.hasOwnProperty(o)&&n[o]!==!0;return n[o]=!1,u}function pT(e,n,{delay:o=0,transitionOverride:u,type:g}={}){let{transition:x=e.getDefaultTransition(),transitionEnd:v,...c}=n;u&&(x=u);const A=[],D=g&&e.animationState&&e.animationState.getState()[g];for(const V in c){const L=e.getValue(V,e.latestValues[V]??null),B=c[V];if(B===void 0||D&&rz(D,V))continue;const se={delay:o,..._v(x||{},V)},ce=L.get();if(ce!==void 0&&!L.isAnimating&&!Array.isArray(B)&&B===ce&&!se.velocity)continue;let ge=!1;if(window.MotionHandoffAnimation){const X=dT(e);if(X){const Z=window.MotionHandoffAnimation(X,V,li);Z!==null&&(se.startTime=Z,ge=!0)}}t_(e,V),L.start(Ev(V,L,B,e.shouldReduceMotion&&zS.has(V)?{type:!1}:se,e,ge));const Ce=L.animation;Ce&&A.push(Ce)}return v&&Promise.all(A).then(()=>{li.update(()=>{v&&WE(e,v)})}),A}function fT(e,n,o,u=0,g=1){const x=Array.from(e).sort((D,V)=>D.sortNodePosition(V)).indexOf(n),v=e.size,c=(v-1)*u;return typeof o=="function"?o(x,v):g===1?x*u:c-x*u}function i_(e,n,o={}){var A;const u=Cc(e,n,o.type==="exit"?(A=e.presenceContext)==null?void 0:A.custom:void 0);let{transition:g=e.getDefaultTransition()||{}}=u||{};o.transitionOverride&&(g=o.transitionOverride);const x=u?()=>Promise.all(pT(e,u,o)):()=>Promise.resolve(),v=e.variantChildren&&e.variantChildren.size?(D=0)=>{const{delayChildren:V=0,staggerChildren:L,staggerDirection:B}=g;return sz(e,n,D,V,L,B,o)}:()=>Promise.resolve(),{when:c}=g;if(c){const[D,V]=c==="beforeChildren"?[x,v]:[v,x];return D().then(()=>V())}else return Promise.all([x(),v(o.delay)])}function sz(e,n,o=0,u=0,g=0,x=1,v){const c=[];for(const A of e.variantChildren)A.notify("AnimationStart",n),c.push(i_(A,n,{...v,delay:o+(typeof u=="function"?0:u)+fT(e.variantChildren,A,u,g,x)}).then(()=>A.notify("AnimationComplete",n)));return Promise.all(c)}function az(e,n,o={}){e.notify("AnimationStart",n);let u;if(Array.isArray(n)){const g=n.map(x=>i_(e,x,o));u=Promise.all(g)}else if(typeof n=="string")u=i_(e,n,o);else{const g=typeof n=="function"?Cc(e,n,o.custom):n;u=Promise.all(pT(e,g,o))}return u.then(()=>{e.notify("AnimationComplete",n)})}function mT(e,n){if(!Array.isArray(n))return!1;const o=n.length;if(o!==e.length)return!1;for(let u=0;u<o;u++)if(n[u]!==e[u])return!1;return!0}const oz=Tv.length;function gT(e){if(!e)return;if(!e.isControllingVariants){const o=e.parent?gT(e.parent)||{}:{};return e.props.initial!==void 0&&(o.initial=e.props.initial),o}const n={};for(let o=0;o<oz;o++){const u=Tv[o],g=e.props[u];(Gh(g)||g===!1)&&(n[u]=g)}return n}const lz=[...Sv].reverse(),cz=Sv.length;function uz(e){return n=>Promise.all(n.map(({animation:o,options:u})=>az(e,o,u)))}function hz(e){let n=uz(e),o=nw(),u=!0;const g=A=>(D,V)=>{var B;const L=Cc(e,V,A==="exit"?(B=e.presenceContext)==null?void 0:B.custom:void 0);if(L){const{transition:se,transitionEnd:ce,...ge}=L;D={...D,...ge,...ce}}return D};function x(A){n=A(e)}function v(A){const{props:D}=e,V=gT(e.parent)||{},L=[],B=new Set;let se={},ce=1/0;for(let Ce=0;Ce<cz;Ce++){const X=lz[Ce],Z=o[X],W=D[X]!==void 0?D[X]:V[X],ve=Gh(W),Se=X===A?Z.isActive:null;Se===!1&&(ce=Ce);let ke=W===V[X]&&W!==D[X]&&ve;if(ke&&u&&e.manuallyAnimateOnMount&&(ke=!1),Z.protectedKeys={...se},!Z.isActive&&Se===null||!W&&!Z.prevProp||Of(W)||typeof W=="boolean")continue;const Ae=dz(Z.prevProp,W);let Me=Ae||X===A&&Z.isActive&&!ke&&ve||Ce>ce&&ve,ot=!1;const at=Array.isArray(W)?W:[W];let pt=at.reduce(g(X),{});Se===!1&&(pt={});const{prevResolvedValues:Vi={}}=Z,Xt={...Vi,...pt},pi=Bt=>{Me=!0,B.has(Bt)&&(ot=!0,B.delete(Bt)),Z.needsAnimating[Bt]=!0;const Ge=e.getValue(Bt);Ge&&(Ge.liveStyle=!1)};for(const Bt in Xt){const Ge=pt[Bt],ut=Vi[Bt];if(se.hasOwnProperty(Bt))continue;let dt=!1;e_(Ge)&&e_(ut)?dt=!mT(Ge,ut):dt=Ge!==ut,dt?Ge!=null?pi(Bt):B.add(Bt):Ge!==void 0&&B.has(Bt)?pi(Bt):Z.protectedKeys[Bt]=!0}Z.prevProp=W,Z.prevResolvedValues=pt,Z.isActive&&(se={...se,...pt}),u&&e.blockInitialAnimation&&(Me=!1);const cn=ke&&Ae;Me&&(!cn||ot)&&L.push(...at.map(Bt=>{const Ge={type:X};if(typeof Bt=="string"&&u&&!cn&&e.manuallyAnimateOnMount&&e.parent){const{parent:ut}=e,dt=Cc(ut,Bt);if(ut.enteringChildren&&dt){const{delayChildren:Ct}=dt.transition||{};Ge.delay=fT(ut.enteringChildren,e,Ct)}}return{animation:Bt,options:Ge}}))}if(B.size){const Ce={};if(typeof D.initial!="boolean"){const X=Cc(e,Array.isArray(D.initial)?D.initial[0]:D.initial);X&&X.transition&&(Ce.transition=X.transition)}B.forEach(X=>{const Z=e.getBaseTarget(X),W=e.getValue(X);W&&(W.liveStyle=!0),Ce[X]=Z??null}),L.push({animation:Ce})}let ge=!!L.length;return u&&(D.initial===!1||D.initial===D.animate)&&!e.manuallyAnimateOnMount&&(ge=!1),u=!1,ge?n(L):Promise.resolve()}function c(A,D){var L;if(o[A].isActive===D)return Promise.resolve();(L=e.variantChildren)==null||L.forEach(B=>{var se;return(se=B.animationState)==null?void 0:se.setActive(A,D)}),o[A].isActive=D;const V=v(A);for(const B in o)o[B].protectedKeys={};return V}return{animateChanges:v,setActive:c,setAnimateFunction:x,getState:()=>o,reset:()=>{o=nw()}}}function dz(e,n){return typeof n=="string"?n!==e:Array.isArray(n)?!mT(n,e):!1}function $o(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function nw(){return{animate:$o(!0),whileInView:$o(),whileHover:$o(),whileTap:$o(),whileDrag:$o(),whileFocus:$o(),exit:$o()}}class co{constructor(n){this.isMounted=!1,this.node=n}update(){}}class pz extends co{constructor(n){super(n),n.animationState||(n.animationState=hz(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();Of(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:o}=this.node.prevProps||{};n!==o&&this.updateAnimationControlsSubscription()}unmount(){var n;this.node.animationState.reset(),(n=this.unmountControls)==null||n.call(this)}}let fz=0;class mz extends co{constructor(){super(...arguments),this.id=fz++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:o}=this.node.presenceContext,{isPresent:u}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===u)return;const g=this.node.animationState.setActive("exit",!n);o&&!n&&g.then(()=>{o(this.id)})}mount(){const{register:n,onExitComplete:o}=this.node.presenceContext||{};o&&o(this.id),n&&(this.unmount=n(this.id))}unmount(){}}const gz={animation:{Feature:pz},exit:{Feature:mz}};function Hh(e,n,o,u={passive:!0}){return e.addEventListener(n,o,u),()=>e.removeEventListener(n,o)}function ed(e){return{point:{x:e.pageX,y:e.pageY}}}const yz=e=>n=>wv(n)&&e(n,ed(n));function bh(e,n,o,u){return Hh(e,n,yz(o),u)}const yT=1e-4,_z=1-yT,vz=1+yT,_T=.01,xz=0-_T,wz=0+_T;function Fn(e){return e.max-e.min}function bz(e,n,o){return Math.abs(e-n)<=o}function rw(e,n,o,u=.5){e.origin=u,e.originPoint=yi(n.min,n.max,e.origin),e.scale=Fn(o)/Fn(n),e.translate=yi(o.min,o.max,e.origin)-e.originPoint,(e.scale>=_z&&e.scale<=vz||isNaN(e.scale))&&(e.scale=1),(e.translate>=xz&&e.translate<=wz||isNaN(e.translate))&&(e.translate=0)}function Sh(e,n,o,u){rw(e.x,n.x,o.x,u?u.originX:void 0),rw(e.y,n.y,o.y,u?u.originY:void 0)}function sw(e,n,o){e.min=o.min+n.min,e.max=e.min+Fn(n)}function Sz(e,n,o){sw(e.x,n.x,o.x),sw(e.y,n.y,o.y)}function aw(e,n,o){e.min=n.min-o.min,e.max=e.min+Fn(n)}function vf(e,n,o){aw(e.x,n.x,o.x),aw(e.y,n.y,o.y)}function Dr(e){return[e("x"),e("y")]}const vT=({current:e})=>e?e.ownerDocument.defaultView:null,ow=(e,n)=>Math.abs(e-n);function Tz(e,n){const o=ow(e.x,n.x),u=ow(e.y,n.y);return Math.sqrt(o**2+u**2)}const lw=new Set(["auto","scroll"]);class xT{constructor(n,o,{transformPagePoint:u,contextWindow:g=window,dragSnapToOrigin:x=!1,distanceThreshold:v=3,element:c}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=se=>{this.handleScroll(se.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const se=Fg(this.lastMoveEventInfo,this.history),ce=this.startEvent!==null,ge=Tz(se.offset,{x:0,y:0})>=this.distanceThreshold;if(!ce&&!ge)return;const{point:Ce}=se,{timestamp:X}=an;this.history.push({...Ce,timestamp:X});const{onStart:Z,onMove:W}=this.handlers;ce||(Z&&Z(this.lastMoveEvent,se),this.startEvent=this.lastMoveEvent),W&&W(this.lastMoveEvent,se)},this.handlePointerMove=(se,ce)=>{this.lastMoveEvent=se,this.lastMoveEventInfo=Bg(ce,this.transformPagePoint),li.update(this.updatePoint,!0)},this.handlePointerUp=(se,ce)=>{this.end();const{onEnd:ge,onSessionEnd:Ce,resumeAnimation:X}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&X&&X(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const Z=Fg(se.type==="pointercancel"?this.lastMoveEventInfo:Bg(ce,this.transformPagePoint),this.history);this.startEvent&&ge&&ge(se,Z),Ce&&Ce(se,Z)},!wv(n))return;this.dragSnapToOrigin=x,this.handlers=o,this.transformPagePoint=u,this.distanceThreshold=v,this.contextWindow=g||window;const A=ed(n),D=Bg(A,this.transformPagePoint),{point:V}=D,{timestamp:L}=an;this.history=[{...V,timestamp:L}];const{onSessionStart:B}=o;B&&B(n,Fg(D,this.history)),this.removeListeners=Yh(bh(this.contextWindow,"pointermove",this.handlePointerMove),bh(this.contextWindow,"pointerup",this.handlePointerUp),bh(this.contextWindow,"pointercancel",this.handlePointerUp)),c&&this.startScrollTracking(c)}startScrollTracking(n){let o=n.parentElement;for(;o;){const u=getComputedStyle(o);(lw.has(u.overflowX)||lw.has(u.overflowY))&&this.scrollPositions.set(o,{x:o.scrollLeft,y:o.scrollTop}),o=o.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(n){const o=this.scrollPositions.get(n);if(!o)return;const u=n===window,g=u?{x:window.scrollX,y:window.scrollY}:{x:n.scrollLeft,y:n.scrollTop},x={x:g.x-o.x,y:g.y-o.y};x.x===0&&x.y===0||(u?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=x.x,this.lastMoveEventInfo.point.y+=x.y):this.history.length>0&&(this.history[0].x-=x.x,this.history[0].y-=x.y),this.scrollPositions.set(n,g),li.update(this.updatePoint,!0))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),ro(this.updatePoint)}}function Bg(e,n){return n?{point:n(e.point)}:e}function cw(e,n){return{x:e.x-n.x,y:e.y-n.y}}function Fg({point:e},n){return{point:e,delta:cw(e,wT(n)),offset:cw(e,kz(n)),velocity:Cz(n,.1)}}function kz(e){return e[0]}function wT(e){return e[e.length-1]}function Cz(e,n){if(e.length<2)return{x:0,y:0};let o=e.length-1,u=null;const g=wT(e);for(;o>=0&&(u=e[o],!(g.timestamp-u.timestamp>Ys(n)));)o--;if(!u)return{x:0,y:0};const x=Fr(g.timestamp-u.timestamp);if(x===0)return{x:0,y:0};const v={x:(g.x-u.x)/x,y:(g.y-u.y)/x};return v.x===1/0&&(v.x=0),v.y===1/0&&(v.y=0),v}function Pz(e,{min:n,max:o},u){return n!==void 0&&e<n?e=u?yi(n,e,u.min):Math.max(e,n):o!==void 0&&e>o&&(e=u?yi(o,e,u.max):Math.min(e,o)),e}function uw(e,n,o){return{min:n!==void 0?e.min+n:void 0,max:o!==void 0?e.max+o-(e.max-e.min):void 0}}function Iz(e,{top:n,left:o,bottom:u,right:g}){return{x:uw(e.x,o,g),y:uw(e.y,n,u)}}function hw(e,n){let o=n.min-e.min,u=n.max-e.max;return n.max-n.min<e.max-e.min&&([o,u]=[u,o]),{min:o,max:u}}function Az(e,n){return{x:hw(e.x,n.x),y:hw(e.y,n.y)}}function Mz(e,n){let o=.5;const u=Fn(e),g=Fn(n);return g>u?o=Nh(n.min,n.max-u,e.min):u>g&&(o=Nh(e.min,e.max-g,n.min)),ks(0,1,o)}function Ez(e,n){const o={};return n.min!==void 0&&(o.min=n.min-e.min),n.max!==void 0&&(o.max=n.max-e.min),o}const n_=.35;function zz(e=n_){return e===!1?e=0:e===!0&&(e=n_),{x:dw(e,"left","right"),y:dw(e,"top","bottom")}}function dw(e,n,o){return{min:pw(e,n),max:pw(e,o)}}function pw(e,n){return typeof e=="number"?e:e[n]||0}const Dz=new WeakMap;class Lz{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Fi(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=n}start(n,{snapToCursor:o=!1,distanceThreshold:u}={}){const{presenceContext:g}=this.visualElement;if(g&&g.isPresent===!1)return;const x=L=>{o?(this.stopAnimation(),this.snapToCursor(ed(L).point)):this.pauseAnimation()},v=(L,B)=>{this.stopAnimation();const{drag:se,dragPropagation:ce,onDragStart:ge}=this.getProps();if(se&&!ce&&(this.openDragLock&&this.openDragLock(),this.openDragLock=VM(se),!this.openDragLock))return;this.latestPointerEvent=L,this.latestPanInfo=B,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Dr(X=>{let Z=this.getAxisMotionValue(X).get()||0;if(Ts.test(Z)){const{projection:W}=this.visualElement;if(W&&W.layout){const ve=W.layout.layoutBox[X];ve&&(Z=Fn(ve)*(parseFloat(Z)/100))}}this.originPoint[X]=Z}),ge&&li.postRender(()=>ge(L,B)),t_(this.visualElement,"transform");const{animationState:Ce}=this.visualElement;Ce&&Ce.setActive("whileDrag",!0)},c=(L,B)=>{this.latestPointerEvent=L,this.latestPanInfo=B;const{dragPropagation:se,dragDirectionLock:ce,onDirectionLock:ge,onDrag:Ce}=this.getProps();if(!se&&!this.openDragLock)return;const{offset:X}=B;if(ce&&this.currentDirection===null){this.currentDirection=Rz(X),this.currentDirection!==null&&ge&&ge(this.currentDirection);return}this.updateAxis("x",B.point,X),this.updateAxis("y",B.point,X),this.visualElement.render(),Ce&&Ce(L,B)},A=(L,B)=>{this.latestPointerEvent=L,this.latestPanInfo=B,this.stop(L,B),this.latestPointerEvent=null,this.latestPanInfo=null},D=()=>Dr(L=>{var B;return this.getAnimationState(L)==="paused"&&((B=this.getAxisMotionValue(L).animation)==null?void 0:B.play())}),{dragSnapToOrigin:V}=this.getProps();this.panSession=new xT(n,{onSessionStart:x,onStart:v,onMove:c,onSessionEnd:A,resumeAnimation:D},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:V,distanceThreshold:u,contextWindow:vT(this.visualElement),element:this.visualElement.current})}stop(n,o){const u=n||this.latestPointerEvent,g=o||this.latestPanInfo,x=this.isDragging;if(this.cancel(),!x||!g||!u)return;const{velocity:v}=g;this.startAnimation(v);const{onDragEnd:c}=this.getProps();c&&li.postRender(()=>c(u,g))}cancel(){this.isDragging=!1;const{projection:n,animationState:o}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:u}=this.getProps();!u&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),o&&o.setActive("whileDrag",!1)}updateAxis(n,o,u){const{drag:g}=this.getProps();if(!u||!Sp(n,g,this.currentDirection))return;const x=this.getAxisMotionValue(n);let v=this.originPoint[n]+u[n];this.constraints&&this.constraints[n]&&(v=Pz(v,this.constraints[n],this.elastic[n])),x.set(v)}resolveConstraints(){var x;const{dragConstraints:n,dragElastic:o}=this.getProps(),u=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(x=this.visualElement.projection)==null?void 0:x.layout,g=this.constraints;n&&uh(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&u?this.constraints=Iz(u.layoutBox,n):this.constraints=!1,this.elastic=zz(o),g!==this.constraints&&u&&this.constraints&&!this.hasMutatedConstraints&&Dr(v=>{this.constraints!==!1&&this.getAxisMotionValue(v)&&(this.constraints[v]=Ez(u.layoutBox[v],this.constraints[v]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:o}=this.getProps();if(!n||!uh(n))return!1;const u=n.current,{projection:g}=this.visualElement;if(!g||!g.layout)return!1;const x=BE(u,g.root,this.visualElement.getTransformPagePoint());let v=Az(g.layout.layoutBox,x);if(o){const c=o(DE(v));this.hasMutatedConstraints=!!c,c&&(v=rT(c))}return v}startAnimation(n){const{drag:o,dragMomentum:u,dragElastic:g,dragTransition:x,dragSnapToOrigin:v,onDragTransitionEnd:c}=this.getProps(),A=this.constraints||{},D=Dr(V=>{if(!Sp(V,o,this.currentDirection))return;let L=A&&A[V]||{};v&&(L={min:0,max:0});const B=g?200:1e6,se=g?40:1e7,ce={type:"inertia",velocity:u?n[V]:0,bounceStiffness:B,bounceDamping:se,timeConstant:750,restDelta:1,restSpeed:10,...x,...L};return this.startAxisValueAnimation(V,ce)});return Promise.all(D).then(c)}startAxisValueAnimation(n,o){const u=this.getAxisMotionValue(n);return t_(this.visualElement,n),u.start(Ev(n,u,0,o,this.visualElement,!1))}stopAnimation(){Dr(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){Dr(n=>{var o;return(o=this.getAxisMotionValue(n).animation)==null?void 0:o.pause()})}getAnimationState(n){var o;return(o=this.getAxisMotionValue(n).animation)==null?void 0:o.state}getAxisMotionValue(n){const o=`_drag${n.toUpperCase()}`,u=this.visualElement.getProps(),g=u[o];return g||this.visualElement.getValue(n,(u.initial?u.initial[n]:void 0)||0)}snapToCursor(n){Dr(o=>{const{drag:u}=this.getProps();if(!Sp(o,u,this.currentDirection))return;const{projection:g}=this.visualElement,x=this.getAxisMotionValue(o);if(g&&g.layout){const{min:v,max:c}=g.layout.layoutBox[o],A=x.get()||0;x.set(n[o]-yi(v,c,.5)+A)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:o}=this.getProps(),{projection:u}=this.visualElement;if(!uh(o)||!u||!this.constraints)return;this.stopAnimation();const g={x:0,y:0};Dr(v=>{const c=this.getAxisMotionValue(v);if(c&&this.constraints!==!1){const A=c.get();g[v]=Mz({min:A,max:A},this.constraints[v])}});const{transformTemplate:x}=this.visualElement.getProps();this.visualElement.current.style.transform=x?x({},""):"none",u.root&&u.root.updateScroll(),u.updateLayout(),this.resolveConstraints(),Dr(v=>{if(!Sp(v,n,null))return;const c=this.getAxisMotionValue(v),{min:A,max:D}=this.constraints[v];c.set(yi(A,D,g[v]))})}addListeners(){if(!this.visualElement.current)return;Dz.set(this.visualElement,this);const n=this.visualElement.current,o=bh(n,"pointerdown",A=>{const{drag:D,dragListener:V=!0}=this.getProps();D&&V&&!US(A.target)&&this.start(A)}),u=()=>{const{dragConstraints:A}=this.getProps();uh(A)&&A.current&&(this.constraints=this.resolveRefConstraints())},{projection:g}=this.visualElement,x=g.addEventListener("measure",u);g&&!g.layout&&(g.root&&g.root.updateScroll(),g.updateLayout()),li.read(u);const v=Hh(window,"resize",()=>this.scalePositionWithinConstraints()),c=g.addEventListener("didUpdate",({delta:A,hasLayoutChanged:D})=>{this.isDragging&&D&&(Dr(V=>{const L=this.getAxisMotionValue(V);L&&(this.originPoint[V]+=A[V].translate,L.set(L.get()+A[V].translate))}),this.visualElement.render())});return()=>{v(),o(),x(),c&&c()}}getProps(){const n=this.visualElement.getProps(),{drag:o=!1,dragDirectionLock:u=!1,dragPropagation:g=!1,dragConstraints:x=!1,dragElastic:v=n_,dragMomentum:c=!0}=n;return{...n,drag:o,dragDirectionLock:u,dragPropagation:g,dragConstraints:x,dragElastic:v,dragMomentum:c}}}function Sp(e,n,o){return(n===!0||n===e)&&(o===null||o===e)}function Rz(e,n=10){let o=null;return Math.abs(e.y)>n?o="y":Math.abs(e.x)>n&&(o="x"),o}class Bz extends co{constructor(n){super(n),this.removeGroupControls=jr,this.removeListeners=jr,this.controls=new Lz(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||jr}update(){const{dragControls:n}=this.node.getProps(),{dragControls:o}=this.node.prevProps||{};n!==o&&(this.removeGroupControls(),n&&(this.removeGroupControls=n.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const fw=e=>(n,o)=>{e&&li.postRender(()=>e(n,o))};class Fz extends co{constructor(){super(...arguments),this.removePointerDownListener=jr}onPointerDown(n){this.session=new xT(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:vT(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:o,onPan:u,onPanEnd:g}=this.node.getProps();return{onSessionStart:fw(n),onStart:fw(o),onMove:u,onEnd:(x,v)=>{delete this.session,g&&li.postRender(()=>g(x,v))}}}mount(){this.removePointerDownListener=bh(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Up={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let Og=!1;class Oz extends De.Component{componentDidMount(){const{visualElement:n,layoutGroup:o,switchLayoutGroup:u,layoutId:g}=this.props,{projection:x}=n;x&&(o.group&&o.group.add(x),u&&u.register&&g&&u.register(x),Og&&x.root.didUpdate(),x.addEventListener("animationComplete",()=>{this.safeToRemove()}),x.setOptions({...x.options,onExitComplete:()=>this.safeToRemove()})),Up.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:o,visualElement:u,drag:g,isPresent:x}=this.props,{projection:v}=u;return v&&(v.isPresent=x,Og=!0,g||n.layoutDependency!==o||o===void 0||n.isPresent!==x?v.willUpdate():this.safeToRemove(),n.isPresent!==x&&(x?v.promote():v.relegate()||li.postRender(()=>{const c=v.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),xv.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:o,switchLayoutGroup:u}=this.props,{projection:g}=n;Og=!0,g&&(g.scheduleCheckAfterUnmount(),o&&o.group&&o.group.remove(g),u&&u.deregister&&u.deregister(g))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function bT(e){const[n,o]=GS(),u=De.useContext(Q_);return _e.jsx(Oz,{...e,layoutGroup:u,switchLayoutGroup:De.useContext(iT),isPresent:n,safeToRemove:o})}function jz(e,n,o){const u=Tn(e)?e:Lc(e);return u.start(Ev("",u,n,o)),u.animation}const Vz=(e,n)=>e.depth-n.depth;class Nz{constructor(){this.children=[],this.isDirty=!1}add(n){iv(this.children,n),this.isDirty=!0}remove(n){nv(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(Vz),this.isDirty=!1,this.children.forEach(n)}}function Uz(e,n){const o=Bn.now(),u=({timestamp:g})=>{const x=g-o;x>=n&&(ro(u),e(x-n))};return li.setup(u,!0),()=>ro(u)}const ST=["TopLeft","TopRight","BottomLeft","BottomRight"],$z=ST.length,mw=e=>typeof e=="string"?parseFloat(e):e,gw=e=>typeof e=="number"||nt.test(e);function Gz(e,n,o,u,g,x){g?(e.opacity=yi(0,o.opacity??1,Hz(u)),e.opacityExit=yi(n.opacity??1,0,qz(u))):x&&(e.opacity=yi(n.opacity??1,o.opacity??1,u));for(let v=0;v<$z;v++){const c=`border${ST[v]}Radius`;let A=yw(n,c),D=yw(o,c);if(A===void 0&&D===void 0)continue;A||(A=0),D||(D=0),A===0||D===0||gw(A)===gw(D)?(e[c]=Math.max(yi(mw(A),mw(D),u),0),(Ts.test(D)||Ts.test(A))&&(e[c]+="%")):e[c]=D}(n.rotate||o.rotate)&&(e.rotate=yi(n.rotate||0,o.rotate||0,u))}function yw(e,n){return e[n]!==void 0?e[n]:e.borderRadius}const Hz=TT(0,.5,lS),qz=TT(.5,.95,jr);function TT(e,n,o){return u=>u<e?0:u>n?1:o(Nh(e,n,u))}function _w(e,n){e.min=n.min,e.max=n.max}function Yr(e,n){_w(e.x,n.x),_w(e.y,n.y)}function vw(e,n){e.translate=n.translate,e.scale=n.scale,e.originPoint=n.originPoint,e.origin=n.origin}function xw(e,n,o,u,g){return e-=n,e=_f(e,1/o,u),g!==void 0&&(e=_f(e,1/g,u)),e}function Zz(e,n=0,o=1,u=.5,g,x=e,v=e){if(Ts.test(n)&&(n=parseFloat(n),n=yi(v.min,v.max,n/100)-v.min),typeof n!="number")return;let c=yi(x.min,x.max,u);e===x&&(c-=n),e.min=xw(e.min,n,o,c,g),e.max=xw(e.max,n,o,c,g)}function ww(e,n,[o,u,g],x,v){Zz(e,n[o],n[u],n[g],n.scale,x,v)}const Wz=["x","scaleX","originX"],Xz=["y","scaleY","originY"];function bw(e,n,o,u){ww(e.x,n,Wz,o?o.x:void 0,u?u.x:void 0),ww(e.y,n,Xz,o?o.y:void 0,u?u.y:void 0)}function Sw(e){return e.translate===0&&e.scale===1}function kT(e){return Sw(e.x)&&Sw(e.y)}function Tw(e,n){return e.min===n.min&&e.max===n.max}function Kz(e,n){return Tw(e.x,n.x)&&Tw(e.y,n.y)}function kw(e,n){return Math.round(e.min)===Math.round(n.min)&&Math.round(e.max)===Math.round(n.max)}function CT(e,n){return kw(e.x,n.x)&&kw(e.y,n.y)}function Cw(e){return Fn(e.x)/Fn(e.y)}function Pw(e,n){return e.translate===n.translate&&e.scale===n.scale&&e.originPoint===n.originPoint}class Yz{constructor(){this.members=[]}add(n){iv(this.members,n),n.scheduleRender()}remove(n){if(nv(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const o=this.members[this.members.length-1];o&&this.promote(o)}}relegate(n){const o=this.members.findIndex(g=>n===g);if(o===0)return!1;let u;for(let g=o;g>=0;g--){const x=this.members[g];if(x.isPresent!==!1){u=x;break}}return u?(this.promote(u),!0):!1}promote(n,o){const u=this.lead;if(n!==u&&(this.prevLead=u,this.lead=n,n.show(),u)){u.instance&&u.scheduleRender(),n.scheduleRender(),n.resumeFrom=u,o&&(n.resumeFrom.preserveOpacity=!0),u.snapshot&&(n.snapshot=u.snapshot,n.snapshot.latestValues=u.animationValues||u.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:g}=n.options;g===!1&&u.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:o,resumingFrom:u}=n;o.onExitComplete&&o.onExitComplete(),u&&u.options.onExitComplete&&u.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Jz(e,n,o){let u="";const g=e.x.translate/n.x,x=e.y.translate/n.y,v=(o==null?void 0:o.z)||0;if((g||x||v)&&(u=`translate3d(${g}px, ${x}px, ${v}px) `),(n.x!==1||n.y!==1)&&(u+=`scale(${1/n.x}, ${1/n.y}) `),o){const{transformPerspective:D,rotate:V,rotateX:L,rotateY:B,skewX:se,skewY:ce}=o;D&&(u=`perspective(${D}px) ${u}`),V&&(u+=`rotate(${V}deg) `),L&&(u+=`rotateX(${L}deg) `),B&&(u+=`rotateY(${B}deg) `),se&&(u+=`skewX(${se}deg) `),ce&&(u+=`skewY(${ce}deg) `)}const c=e.x.scale*n.x,A=e.y.scale*n.y;return(c!==1||A!==1)&&(u+=`scale(${c}, ${A})`),u||"none"}const jg=["","X","Y","Z"],Qz=1e3;let eD=0;function Vg(e,n,o,u){const{latestValues:g}=n;g[e]&&(o[e]=g[e],n.setStaticValue(e,0),u&&(u[e]=0))}function PT(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:n}=e.options;if(!n)return;const o=dT(n);if(window.MotionHasOptimisedAnimation(o,"transform")){const{layout:g,layoutId:x}=e.options;window.MotionCancelOptimisedAnimation(o,"transform",li,!(g||x))}const{parent:u}=e;u&&!u.hasCheckedOptimisedAppear&&PT(u)}function IT({attachResizeListener:e,defaultParent:n,measureScroll:o,checkIsScrollRoot:u,resetTransform:g}){return class{constructor(v={},c=n==null?void 0:n()){this.id=eD++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(nD),this.nodes.forEach(oD),this.nodes.forEach(lD),this.nodes.forEach(rD)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=v,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let A=0;A<this.path.length;A++)this.path[A].shouldResetTransform=!0;this.root===this&&(this.nodes=new Nz)}addEventListener(v,c){return this.eventHandlers.has(v)||this.eventHandlers.set(v,new av),this.eventHandlers.get(v).add(c)}notifyListeners(v,...c){const A=this.eventHandlers.get(v);A&&A.notify(...c)}hasListeners(v){return this.eventHandlers.has(v)}mount(v){if(this.instance)return;this.isSVG=$S(v)&&!HM(v),this.instance=v;const{layoutId:c,layout:A,visualElement:D}=this.options;if(D&&!D.current&&D.mount(v),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(A||c)&&(this.isLayoutDirty=!0),e){let V,L=0;const B=()=>this.root.updateBlockedByResize=!1;li.read(()=>{L=window.innerWidth}),e(v,()=>{const se=window.innerWidth;se!==L&&(L=se,this.root.updateBlockedByResize=!0,V&&V(),V=Uz(B,250),Up.hasAnimatedSinceResize&&(Up.hasAnimatedSinceResize=!1,this.nodes.forEach(Mw)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&D&&(c||A)&&this.addEventListener("didUpdate",({delta:V,hasLayoutChanged:L,hasRelativeLayoutChanged:B,layout:se})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const ce=this.options.transition||D.getDefaultTransition()||pD,{onLayoutAnimationStart:ge,onLayoutAnimationComplete:Ce}=D.getProps(),X=!this.targetLayout||!CT(this.targetLayout,se),Z=!L&&B;if(this.options.layoutRoot||this.resumeFrom||Z||L&&(X||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const W={..._v(ce,"layout"),onPlay:ge,onComplete:Ce};(D.shouldReduceMotion||this.options.layoutRoot)&&(W.delay=0,W.type=!1),this.startAnimation(W),this.setAnimationOrigin(V,Z)}else L||Mw(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=se})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const v=this.getStack();v&&v.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ro(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(cD),this.animationId++)}getTransformTemplate(){const{visualElement:v}=this.options;return v&&v.getProps().transformTemplate}willUpdate(v=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&PT(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let V=0;V<this.path.length;V++){const L=this.path[V];L.shouldResetTransform=!0,L.updateScroll("snapshot"),L.options.layoutRoot&&L.willUpdate(!1)}const{layoutId:c,layout:A}=this.options;if(c===void 0&&!A)return;const D=this.getTransformTemplate();this.prevTransformTemplateValue=D?D(this.latestValues,""):void 0,this.updateSnapshot(),v&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Iw);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Aw);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(aD),this.nodes.forEach(tD),this.nodes.forEach(iD)):this.nodes.forEach(Aw),this.clearAllSnapshots();const c=Bn.now();an.delta=ks(0,1e3/60,c-an.timestamp),an.timestamp=c,an.isProcessing=!0,Pg.update.process(an),Pg.preRender.process(an),Pg.render.process(an),an.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,xv.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(sD),this.sharedNodes.forEach(uD)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,li.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){li.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Fn(this.snapshot.measuredBox.x)&&!Fn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let A=0;A<this.path.length;A++)this.path[A].updateScroll();const v=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Fi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,v?v.layoutBox:void 0)}updateScroll(v="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===v&&(c=!1),c&&this.instance){const A=u(this.instance);this.scroll={animationId:this.root.animationId,phase:v,isRoot:A,offset:o(this.instance),wasRoot:this.scroll?this.scroll.isRoot:A}}}resetTransform(){if(!g)return;const v=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!kT(this.projectionDelta),A=this.getTransformTemplate(),D=A?A(this.latestValues,""):void 0,V=D!==this.prevTransformTemplateValue;v&&this.instance&&(c||qo(this.latestValues)||V)&&(g(this.instance,D),this.shouldResetTransform=!1,this.scheduleRender())}measure(v=!0){const c=this.measurePageBox();let A=this.removeElementScroll(c);return v&&(A=this.removeTransform(A)),fD(A),{animationId:this.root.animationId,measuredBox:c,layoutBox:A,latestValues:{},source:this.id}}measurePageBox(){var D;const{visualElement:v}=this.options;if(!v)return Fi();const c=v.measureViewportBox();if(!(((D=this.scroll)==null?void 0:D.wasRoot)||this.path.some(mD))){const{scroll:V}=this.root;V&&(gc(c.x,V.offset.x),gc(c.y,V.offset.y))}return c}removeElementScroll(v){var A;const c=Fi();if(Yr(c,v),(A=this.scroll)!=null&&A.wasRoot)return c;for(let D=0;D<this.path.length;D++){const V=this.path[D],{scroll:L,options:B}=V;V!==this.root&&L&&B.layoutScroll&&(L.wasRoot&&Yr(c,v),gc(c.x,L.offset.x),gc(c.y,L.offset.y))}return c}applyTransform(v,c=!1){const A=Fi();Yr(A,v);for(let D=0;D<this.path.length;D++){const V=this.path[D];!c&&V.options.layoutScroll&&V.scroll&&V!==V.root&&yc(A,{x:-V.scroll.offset.x,y:-V.scroll.offset.y}),qo(V.latestValues)&&yc(A,V.latestValues)}return qo(this.latestValues)&&yc(A,this.latestValues),A}removeTransform(v){const c=Fi();Yr(c,v);for(let A=0;A<this.path.length;A++){const D=this.path[A];if(!D.instance||!qo(D.latestValues))continue;Yy(D.latestValues)&&D.updateSnapshot();const V=Fi(),L=D.measurePageBox();Yr(V,L),bw(c,D.latestValues,D.snapshot?D.snapshot.layoutBox:void 0,V)}return qo(this.latestValues)&&bw(c,this.latestValues),c}setTargetDelta(v){this.targetDelta=v,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(v){this.options={...this.options,...v,crossfade:v.crossfade!==void 0?v.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==an.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(v=!1){var se;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const A=!!this.resumingFrom||this!==c;if(!(v||A&&this.isSharedProjectionDirty||this.isProjectionDirty||(se=this.parent)!=null&&se.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:V,layoutId:L}=this.options;if(!this.layout||!(V||L))return;this.resolvedRelativeTargetAt=an.timestamp;const B=this.getClosestProjectingParent();B&&this.linkedParentVersion!==B.layoutVersion&&!B.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(B&&B.layout?this.createRelativeTarget(B,this.layout.layoutBox,B.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Fi(),this.targetWithTransforms=Fi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Sz(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Yr(this.target,this.layout.layoutBox),aT(this.target,this.targetDelta)):Yr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,B&&!!B.resumingFrom==!!this.resumingFrom&&!B.options.layoutScroll&&B.target&&this.animationProgress!==1?this.createRelativeTarget(B,this.target,B.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Yy(this.parent.latestValues)||sT(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(v,c,A){this.relativeParent=v,this.linkedParentVersion=v.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Fi(),this.relativeTargetOrigin=Fi(),vf(this.relativeTargetOrigin,c,A),Yr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var ce;const v=this.getLead(),c=!!this.resumingFrom||this!==v;let A=!0;if((this.isProjectionDirty||(ce=this.parent)!=null&&ce.isProjectionDirty)&&(A=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(A=!1),this.resolvedRelativeTargetAt===an.timestamp&&(A=!1),A)return;const{layout:D,layoutId:V}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(D||V))return;Yr(this.layoutCorrected,this.layout.layoutBox);const L=this.treeScale.x,B=this.treeScale.y;RE(this.layoutCorrected,this.treeScale,this.path,c),v.layout&&!v.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(v.target=v.layout.layoutBox,v.targetWithTransforms=Fi());const{target:se}=v;if(!se){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(vw(this.prevProjectionDelta.x,this.projectionDelta.x),vw(this.prevProjectionDelta.y,this.projectionDelta.y)),Sh(this.projectionDelta,this.layoutCorrected,se,this.latestValues),(this.treeScale.x!==L||this.treeScale.y!==B||!Pw(this.projectionDelta.x,this.prevProjectionDelta.x)||!Pw(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",se))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(v=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),v){const A=this.getStack();A&&A.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_c(),this.projectionDelta=_c(),this.projectionDeltaWithTransform=_c()}setAnimationOrigin(v,c=!1){const A=this.snapshot,D=A?A.latestValues:{},V={...this.latestValues},L=_c();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const B=Fi(),se=A?A.source:void 0,ce=this.layout?this.layout.source:void 0,ge=se!==ce,Ce=this.getStack(),X=!Ce||Ce.members.length<=1,Z=!!(ge&&!X&&this.options.crossfade===!0&&!this.path.some(dD));this.animationProgress=0;let W;this.mixTargetDelta=ve=>{const Se=ve/1e3;Ew(L.x,v.x,Se),Ew(L.y,v.y,Se),this.setTargetDelta(L),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(vf(B,this.layout.layoutBox,this.relativeParent.layout.layoutBox),hD(this.relativeTarget,this.relativeTargetOrigin,B,Se),W&&Kz(this.relativeTarget,W)&&(this.isProjectionDirty=!1),W||(W=Fi()),Yr(W,this.relativeTarget)),ge&&(this.animationValues=V,Gz(V,D,this.latestValues,Se,Z,X)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Se},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(v){var c,A,D;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(D=(A=this.resumingFrom)==null?void 0:A.currentAnimation)==null||D.stop(),this.pendingAnimation&&(ro(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=li.update(()=>{Up.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Lc(0)),this.currentAnimation=jz(this.motionValue,[0,1e3],{...v,velocity:0,isSync:!0,onUpdate:V=>{this.mixTargetDelta(V),v.onUpdate&&v.onUpdate(V)},onStop:()=>{},onComplete:()=>{v.onComplete&&v.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const v=this.getStack();v&&v.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Qz),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const v=this.getLead();let{targetWithTransforms:c,target:A,layout:D,latestValues:V}=v;if(!(!c||!A||!D)){if(this!==v&&this.layout&&D&&AT(this.options.animationType,this.layout.layoutBox,D.layoutBox)){A=this.target||Fi();const L=Fn(this.layout.layoutBox.x);A.x.min=v.target.x.min,A.x.max=A.x.min+L;const B=Fn(this.layout.layoutBox.y);A.y.min=v.target.y.min,A.y.max=A.y.min+B}Yr(c,A),yc(c,V),Sh(this.projectionDeltaWithTransform,this.layoutCorrected,c,V)}}registerSharedNode(v,c){this.sharedNodes.has(v)||this.sharedNodes.set(v,new Yz),this.sharedNodes.get(v).add(c);const D=c.options.initialPromotionConfig;c.promote({transition:D?D.transition:void 0,preserveFollowOpacity:D&&D.shouldPreserveFollowOpacity?D.shouldPreserveFollowOpacity(c):void 0})}isLead(){const v=this.getStack();return v?v.lead===this:!0}getLead(){var c;const{layoutId:v}=this.options;return v?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:v}=this.options;return v?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:v}=this.options;if(v)return this.root.sharedNodes.get(v)}promote({needsReset:v,transition:c,preserveFollowOpacity:A}={}){const D=this.getStack();D&&D.promote(this,A),v&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const v=this.getStack();return v?v.relegate(this):!1}resetSkewAndRotation(){const{visualElement:v}=this.options;if(!v)return;let c=!1;const{latestValues:A}=v;if((A.z||A.rotate||A.rotateX||A.rotateY||A.rotateZ||A.skewX||A.skewY)&&(c=!0),!c)return;const D={};A.z&&Vg("z",v,D,this.animationValues);for(let V=0;V<jg.length;V++)Vg(`rotate${jg[V]}`,v,D,this.animationValues),Vg(`skew${jg[V]}`,v,D,this.animationValues);v.render();for(const V in D)v.setStaticValue(V,D[V]),this.animationValues&&(this.animationValues[V]=D[V]);v.scheduleRender()}applyProjectionStyles(v,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){v.visibility="hidden";return}const A=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,v.visibility="",v.opacity="",v.pointerEvents=Np(c==null?void 0:c.pointerEvents)||"",v.transform=A?A(this.latestValues,""):"none";return}const D=this.getLead();if(!this.projectionDelta||!this.layout||!D.target){this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=Np(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!qo(this.latestValues)&&(v.transform=A?A({},""):"none",this.hasProjected=!1);return}v.visibility="";const V=D.animationValues||D.latestValues;this.applyTransformsToTarget();let L=Jz(this.projectionDeltaWithTransform,this.treeScale,V);A&&(L=A(V,L)),v.transform=L;const{x:B,y:se}=this.projectionDelta;v.transformOrigin=`${B.origin*100}% ${se.origin*100}% 0`,D.animationValues?v.opacity=D===this?V.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:V.opacityExit:v.opacity=D===this?V.opacity!==void 0?V.opacity:"":V.opacityExit!==void 0?V.opacityExit:0;for(const ce in Ky){if(V[ce]===void 0)continue;const{correct:ge,applyTo:Ce,isCSSVariable:X}=Ky[ce],Z=L==="none"?V[ce]:ge(V[ce],D);if(Ce){const W=Ce.length;for(let ve=0;ve<W;ve++)v[Ce[ve]]=Z}else X?this.options.visualElement.renderState.vars[ce]=Z:v[ce]=Z}this.options.layoutId&&(v.pointerEvents=D===this?Np(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(v=>{var c;return(c=v.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(Iw),this.root.sharedNodes.clear()}}}function tD(e){e.updateLayout()}function iD(e){var o;const n=((o=e.resumeFrom)==null?void 0:o.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:u,measuredBox:g}=e.layout,{animationType:x}=e.options,v=n.source!==e.layout.source;x==="size"?Dr(L=>{const B=v?n.measuredBox[L]:n.layoutBox[L],se=Fn(B);B.min=u[L].min,B.max=B.min+se}):AT(x,n.layoutBox,u)&&Dr(L=>{const B=v?n.measuredBox[L]:n.layoutBox[L],se=Fn(u[L]);B.max=B.min+se,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[L].max=e.relativeTarget[L].min+se)});const c=_c();Sh(c,u,n.layoutBox);const A=_c();v?Sh(A,e.applyTransform(g,!0),n.measuredBox):Sh(A,u,n.layoutBox);const D=!kT(c);let V=!1;if(!e.resumeFrom){const L=e.getClosestProjectingParent();if(L&&!L.resumeFrom){const{snapshot:B,layout:se}=L;if(B&&se){const ce=Fi();vf(ce,n.layoutBox,B.layoutBox);const ge=Fi();vf(ge,u,se.layoutBox),CT(ce,ge)||(V=!0),L.options.layoutRoot&&(e.relativeTarget=ge,e.relativeTargetOrigin=ce,e.relativeParent=L)}}}e.notifyListeners("didUpdate",{layout:u,snapshot:n,delta:A,layoutDelta:c,hasLayoutChanged:D,hasRelativeLayoutChanged:V})}else if(e.isLead()){const{onExitComplete:u}=e.options;u&&u()}e.options.transition=void 0}function nD(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function rD(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function sD(e){e.clearSnapshot()}function Iw(e){e.clearMeasurements()}function Aw(e){e.isLayoutDirty=!1}function aD(e){const{visualElement:n}=e.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),e.resetTransform()}function Mw(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function oD(e){e.resolveTargetDelta()}function lD(e){e.calcProjection()}function cD(e){e.resetSkewAndRotation()}function uD(e){e.removeLeadSnapshot()}function Ew(e,n,o){e.translate=yi(n.translate,0,o),e.scale=yi(n.scale,1,o),e.origin=n.origin,e.originPoint=n.originPoint}function zw(e,n,o,u){e.min=yi(n.min,o.min,u),e.max=yi(n.max,o.max,u)}function hD(e,n,o,u){zw(e.x,n.x,o.x,u),zw(e.y,n.y,o.y,u)}function dD(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const pD={duration:.45,ease:[.4,0,.1,1]},Dw=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Lw=Dw("applewebkit/")&&!Dw("chrome/")?Math.round:jr;function Rw(e){e.min=Lw(e.min),e.max=Lw(e.max)}function fD(e){Rw(e.x),Rw(e.y)}function AT(e,n,o){return e==="position"||e==="preserve-aspect"&&!bz(Cw(n),Cw(o),.2)}function mD(e){var n;return e!==e.root&&((n=e.scroll)==null?void 0:n.wasRoot)}const gD=IT({attachResizeListener:(e,n)=>Hh(e,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ng={current:void 0},MT=IT({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ng.current){const e=new gD({});e.mount(window),e.setOptions({layoutScroll:!0}),Ng.current=e}return Ng.current},resetTransform:(e,n)=>{e.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),yD={pan:{Feature:Fz},drag:{Feature:Bz,ProjectionNode:MT,MeasureLayout:bT}};function Bw(e,n,o){const{props:u}=e;e.animationState&&u.whileHover&&e.animationState.setActive("whileHover",o==="Start");const g="onHover"+o,x=u[g];x&&li.postRender(()=>x(n,ed(n)))}class _D extends co{mount(){const{current:n}=this.node;n&&(this.unmount=NM(n,(o,u)=>(Bw(this.node,u,"Start"),g=>Bw(this.node,g,"End"))))}unmount(){}}class vD extends co{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Yh(Hh(this.node.current,"focus",()=>this.onFocus()),Hh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Fw(e,n,o){const{props:u}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&u.whileTap&&e.animationState.setActive("whileTap",o==="Start");const g="onTap"+(o==="End"?"":o),x=u[g];x&&li.postRender(()=>x(n,ed(n)))}class xD extends co{mount(){const{current:n}=this.node;n&&(this.unmount=GM(n,(o,u)=>(Fw(this.node,u,"Start"),(g,{success:x})=>Fw(this.node,g,x?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const r_=new WeakMap,Ug=new WeakMap,wD=e=>{const n=r_.get(e.target);n&&n(e)},bD=e=>{e.forEach(wD)};function SD({root:e,...n}){const o=e||document;Ug.has(o)||Ug.set(o,{});const u=Ug.get(o),g=JSON.stringify(n);return u[g]||(u[g]=new IntersectionObserver(bD,{root:e,...n})),u[g]}function TD(e,n,o){const u=SD(n);return r_.set(e,o),u.observe(e),()=>{r_.delete(e),u.unobserve(e)}}const kD={some:0,all:1};class CD extends co{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:o,margin:u,amount:g="some",once:x}=n,v={root:o?o.current:void 0,rootMargin:u,threshold:typeof g=="number"?g:kD[g]},c=A=>{const{isIntersecting:D}=A;if(this.isInView===D||(this.isInView=D,x&&!D&&this.hasEnteredView))return;D&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",D);const{onViewportEnter:V,onViewportLeave:L}=this.node.getProps(),B=D?V:L;B&&B(A)};return TD(this.node.current,v,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:o}=this.node;["amount","margin","root"].some(PD(n,o))&&this.startObserver()}unmount(){}}function PD({viewport:e={}},{viewport:n={}}={}){return o=>e[o]!==n[o]}const ID={inView:{Feature:CD},tap:{Feature:xD},focus:{Feature:vD},hover:{Feature:_D}},AD={layout:{ProjectionNode:MT,MeasureLayout:bT}},MD={...gz,...ID,...yD,...AD},ws=zE(MD,HE),ED=({selectedRecord:e,onClose:n})=>{const[o,u]=De.useState(0),[g,x]=De.useState(!0),v=De.useRef(null),[c,A]=De.useState(!1),D=window.innerWidth<=768,V={hidden:D?{y:"100%"}:{x:"100%"},visible:{y:0,x:0,transition:{type:"spring",stiffness:300,damping:30}},exit:D?{y:"100%"}:{x:"100%"}},L=e.images&&Array.isArray(e.images)?e.images:[e.image];De.useEffect(()=>{u(0),x(!0),v.current&&(v.current.scrollTop=0),window.innerWidth<=768&&A(!0)},[e]);const B=W=>{W.stopPropagation(),u(ve=>(ve+1)%L.length),x(!0)},se=W=>{W.stopPropagation(),u(ve=>(ve-1+L.length)%L.length),x(!0)},ce=()=>{v.current&&v.current.scrollTop>50&&A(!1)},ge=()=>{v.current&&v.current.scrollTo({top:v.current.scrollTop+300,behavior:"smooth"})},Ce=async()=>{const W=`${window.location.origin}${window.location.pathname}?site=${encodeURIComponent(e.id)}`,ve={title:`${e.title} - Kala Ghoda Heritage Map`,text:e.description,url:W};if(navigator.share)try{await navigator.share(ve)}catch(Se){Se.name!=="AbortError"&&X(W)}else X(W)},X=W=>{navigator.clipboard.writeText(W).then(()=>{alert("Link copied to clipboard!")})},Z=`https://www.google.com/maps/dir/?api=1&destination=${e.location.center[1]},${e.location.center[0]}&travelmode=walking`;return _e.jsxs(ws.div,{id:"side-panel",variants:V,initial:"hidden",animate:"visible",exit:"exit",children:[_e.jsx("button",{id:"panel-close-btn",className:"mobile-close-btn",onClick:n,children:_e.jsx("i",{className:"fa-solid fa-xmark"})}),_e.jsx("div",{id:"panel-handle"}),_e.jsx("div",{id:"panel-scroll-area",ref:v,onScroll:ce,children:_e.jsxs("div",{id:"panel-inner",children:[_e.jsxs("div",{className:`panel-img-container ${g?"skeleton":""}`,children:[_e.jsx("img",{src:L[o],alt:e.title,className:`panel-img ${g?"loading":""}`,onLoad:()=>x(!1)}),L.length>1&&_e.jsxs(_e.Fragment,{children:[_e.jsx("div",{className:"gallery-dots",children:L.map((W,ve)=>_e.jsx("span",{className:`gallery-dot ${ve===o?"active":""}`,onClick:Se=>{Se.stopPropagation(),u(ve),x(!0)}},ve))}),_e.jsx("button",{className:"gallery-arrow gallery-prev",onClick:se,children:_e.jsx("i",{className:"fa-solid fa-chevron-left"})}),_e.jsx("button",{className:"gallery-arrow gallery-next",onClick:B,children:_e.jsx("i",{className:"fa-solid fa-chevron-right"})}),_e.jsxs("div",{className:"gallery-counter",children:[o+1," / ",L.length]})]})]}),_e.jsxs("div",{className:"panel-content",children:[_e.jsx("div",{className:"panel-header",children:_e.jsx("span",{className:"panel-cat",style:{backgroundColor:e.color||"#333"},children:e.category})}),_e.jsx("h2",{className:"panel-title",children:e.title}),_e.jsx("p",{className:"panel-desc",children:e.description}),_e.jsxs("div",{className:"panel-info",children:[_e.jsxs("div",{className:"panel-info-row",children:[_e.jsx("i",{className:"fa-solid fa-calendar"}),_e.jsx("span",{className:"panel-info-label",children:"Year"}),_e.jsx("span",{className:"panel-info-val",children:e.year})]}),_e.jsxs("div",{className:"panel-info-row",children:[_e.jsx("i",{className:"fa-solid fa-pencil-ruler"}),_e.jsx("span",{className:"panel-info-label",children:"Architect"}),_e.jsx("span",{className:"panel-info-val",children:e.architect||"Unknown"})]}),_e.jsxs("div",{className:"panel-info-row",children:[_e.jsx("i",{className:"fa-solid fa-hammer"}),_e.jsx("span",{className:"panel-info-label",children:"Builder"}),_e.jsx("span",{className:"panel-info-val",children:e.builder||"Unknown"})]})]}),_e.jsxs("div",{className:"panel-quick-actions",children:[_e.jsxs("a",{href:Z,target:"_blank",rel:"noopener noreferrer",className:"panel-action-btn primary",children:[_e.jsx("i",{className:"fa-solid fa-diamond-turn-right"}),_e.jsx("span",{children:"Navigate"})]}),_e.jsxs("button",{className:"panel-action-btn secondary",onClick:Ce,children:[_e.jsx("i",{className:"fa-solid fa-share-nodes"}),_e.jsx("span",{children:"Share"})]})]})]})]})}),c&&_e.jsx("button",{id:"scroll-hint-btn",className:"scroll-hint-btn",onClick:ge,"aria-label":"Scroll down for more",children:_e.jsx("i",{className:"fa-solid fa-chevron-down"})})]})};var ET={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,n){(function(o,u){e.exports=u()})(kC,function(){var o={},u={};function g(v,c,A){if(u[v]=A,v==="index"){var D="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",V={};return u.shared(V),u.index(o,V),typeof window<"u"&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([D],{type:"text/javascript"}))),o}}g("shared",["exports"],function(v){function c(r,i,s,l){return new(s||(s=Promise))(function(p,y){function _(C){try{S(l.next(C))}catch(P){y(P)}}function w(C){try{S(l.throw(C))}catch(P){y(P)}}function S(C){var P;C.done?p(C.value):(P=C.value,P instanceof s?P:new s(function(M){M(P)})).then(_,w)}S((l=l.apply(r,i||[])).next())})}function A(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var D=V;function V(r,i){this.x=r,this.y=i}V.prototype={clone:function(){return new V(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,i){return this.clone()._rotateAround(r,i)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var i=r.x-this.x,s=r.y-this.y;return i*i+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,i){return Math.atan2(this.x*i-this.y*r,this.x*r+this.y*i)},_matMult:function(r){var i=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=i,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var i=Math.cos(r),s=Math.sin(r),l=s*this.x+i*this.y;return this.x=i*this.x-s*this.y,this.y=l,this},_rotateAround:function(r,i){var s=Math.cos(r),l=Math.sin(r),p=i.y+l*(this.x-i.x)+s*(this.y-i.y);return this.x=i.x+s*(this.x-i.x)-l*(this.y-i.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},V.convert=function(r){return r instanceof V?r:Array.isArray(r)?new V(r[0],r[1]):r};var L=A(D),B=se;function se(r,i,s,l){this.cx=3*r,this.bx=3*(s-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(l-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=i,this.p2x=s,this.p2y=l}se.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,i){if(i===void 0&&(i=1e-6),r<0)return 0;if(r>1)return 1;for(var s=r,l=0;l<8;l++){var p=this.sampleCurveX(s)-r;if(Math.abs(p)<i)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=p/y}var _=0,w=1;for(s=r,l=0;l<20&&(p=this.sampleCurveX(s),!(Math.abs(p-r)<i));l++)r>p?_=s:w=s,s=.5*(w-_)+_;return s},solve:function(r,i){return this.sampleCurveY(this.solveCurveX(r,i))}};var ce=A(B);let ge,Ce;function X(){return ge==null&&(ge=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ge}function Z(){if(Ce==null&&(Ce=!1,X())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let l=0;l<5*5;l++){const p=4*l;i.fillStyle=`rgb(${p},${p+1},${p+2})`,i.fillRect(l%5,Math.floor(l/5),1,1)}const s=i.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&s[l]!==l){Ce=!0;break}}}return Ce||!1}function W(r,i,s,l){const p=new ce(r,i,s,l);return y=>p.solve(y)}const ve=W(.25,.1,.25,1);function Se(r,i,s){return Math.min(s,Math.max(i,r))}function ke(r,i,s){const l=s-i,p=((r-i)%l+l)%l+i;return p===i?s:p}function Ae(r,...i){for(const s of i)for(const l in s)r[l]=s[l];return r}let Me=1;function ot(r,i,s){const l={};for(const p in r)l[p]=i.call(this,r[p],p,r);return l}function at(r,i,s){const l={};for(const p in r)i.call(this,r[p],p,r)&&(l[p]=r[p]);return l}function pt(r){return Array.isArray(r)?r.map(pt):typeof r=="object"&&r?ot(r,pt):r}const Vi={};function Xt(r){Vi[r]||(typeof console<"u"&&console.warn(r),Vi[r]=!0)}function pi(r,i,s){return(s.y-r.y)*(i.x-r.x)>(i.y-r.y)*(s.x-r.x)}function cn(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let tr=null;function Bt(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ut(r,i,s,l,p){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(r,{timestamp:0});try{const _=y==null?void 0:y.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const w=_.startsWith("BGR"),S=new Uint8ClampedArray(l*p*4);if(yield y.copyTo(S,function(C,P,M,R,j){const U=4*Math.max(-P,0),$=(Math.max(0,M)-M)*R*4+U,Y=4*R,te=Math.max(0,P),me=Math.max(0,M);return{rect:{x:te,y:me,width:Math.min(C.width,P+R)-te,height:Math.min(C.height,M+j)-me},layout:[{offset:$,stride:Y}]}}(r,i,s,l,p)),w)for(let C=0;C<S.length;C+=4){const P=S[C];S[C]=S[C+2],S[C+2]=P}return S}finally{y.close()}})}let dt,Ct;const jt="AbortError";function ir(){return new Error(jt)}const Ni={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function un(r){return Ni.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const hn="global-dispatcher";class Pi extends Error{constructor(i,s,l,p){super(`AJAXError: ${s} (${i}): ${l}`),this.status=i,this.statusText=s,this.url=l,this.body=p}}const nr=()=>cn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Cs=function(r,i){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const l=un(r.url);if(l)return l(r,i);if(cn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:hn},i)}if(!(/^file:/.test(s=r.url)||/^file:/.test(nr())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,p){return c(this,void 0,void 0,function*(){const y=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:nr(),signal:p.signal});l.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const _=yield fetch(y);if(!_.ok){const C=yield _.blob();throw new Pi(_.status,_.statusText,l.url,C)}let w;w=l.type==="arrayBuffer"||l.type==="image"?_.arrayBuffer():l.type==="json"?_.json():_.text();const S=yield w;if(p.signal.aborted)throw ir();return{data:S,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(r,i);if(cn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:hn},i)}var s;return function(l,p){return new Promise((y,_)=>{var w;const S=new XMLHttpRequest;S.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(S.responseType="arraybuffer");for(const C in l.headers)S.setRequestHeader(C,l.headers[C]);l.type==="json"&&(S.responseType="text",!((w=l.headers)===null||w===void 0)&&w.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=l.credentials==="include",S.onerror=()=>{_(new Error(S.statusText))},S.onload=()=>{if(!p.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let C=S.response;if(l.type==="json")try{C=JSON.parse(S.response)}catch(P){return void _(P)}y({data:C,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const C=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});_(new Pi(S.status,S.statusText,l.url,C))}},p.signal.addEventListener("abort",()=>{S.abort(),_(ir())}),S.send(l.body)})}(r,i)};function Ps(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const i=new URL(r),s=window.location;return i.protocol===s.protocol&&i.host===s.host}function uo(r,i,s){s[r]&&s[r].indexOf(i)!==-1||(s[r]=s[r]||[],s[r].push(i))}function Ur(r,i,s){if(s&&s[r]){const l=s[r].indexOf(i);l!==-1&&s[r].splice(l,1)}}class ss{constructor(i,s={}){Ae(this,s),this.type=i}}class as extends ss{constructor(i,s={}){super("error",Ae({error:i},s))}}class ra{on(i,s){return this._listeners=this._listeners||{},uo(i,s,this._listeners),this}off(i,s){return Ur(i,s,this._listeners),Ur(i,s,this._oneTimeListeners),this}once(i,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},uo(i,s,this._oneTimeListeners),this):new Promise(l=>this.once(i,l))}fire(i,s){typeof i=="string"&&(i=new ss(i,s||{}));const l=i.type;if(this.listens(l)){i.target=this;const p=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const w of p)w.call(this,i);const y=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const w of y)Ur(l,w,this._oneTimeListeners),w.call(this,i);const _=this._eventedParent;_&&(Ae(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(i))}else i instanceof as&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,s){return this._eventedParent=i,this._eventedParentData=s,this}}var we={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Is=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ho(r,i){const s={};for(const l in r)l!=="ref"&&(s[l]=r[l]);return Is.forEach(l=>{l in i&&(s[l]=i[l])}),s}function Lt(r,i){if(Array.isArray(r)){if(!Array.isArray(i)||r.length!==i.length)return!1;for(let s=0;s<r.length;s++)if(!Lt(r[s],i[s]))return!1;return!0}if(typeof r=="object"&&r!==null&&i!==null){if(typeof i!="object"||Object.keys(r).length!==Object.keys(i).length)return!1;for(const s in r)if(!Lt(r[s],i[s]))return!1;return!0}return r===i}function ni(r,i){r.push(i)}function po(r,i,s){ni(s,{command:"addSource",args:[r,i[r]]})}function os(r,i,s){ni(i,{command:"removeSource",args:[r]}),s[r]=!0}function $r(r,i,s,l){os(r,s,l),po(r,i,s)}function sa(r,i,s){let l;for(l in r[s])if(Object.prototype.hasOwnProperty.call(r[s],l)&&l!=="data"&&!Lt(r[s][l],i[s][l]))return!1;for(l in i[s])if(Object.prototype.hasOwnProperty.call(i[s],l)&&l!=="data"&&!Lt(r[s][l],i[s][l]))return!1;return!0}function Nn(r,i,s,l,p,y){r=r||{},i=i||{};for(const _ in r)Object.prototype.hasOwnProperty.call(r,_)&&(Lt(r[_],i[_])||s.push({command:y,args:[l,_,i[_],p]}));for(const _ in i)Object.prototype.hasOwnProperty.call(i,_)&&!Object.prototype.hasOwnProperty.call(r,_)&&(Lt(r[_],i[_])||s.push({command:y,args:[l,_,i[_],p]}))}function fo(r){return r.id}function mo(r,i){return r[i.id]=i,r}class Re{constructor(i,s,l,p){this.message=(i?`${i}: `:"")+l,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function Sr(r,...i){for(const s of i)for(const l in s)r[l]=s[l];return r}class Ji extends Error{constructor(i,s){super(s),this.message=s,this.key=i}}class Tr{constructor(i,s=[]){this.parent=i,this.bindings={};for(const[l,p]of s)this.bindings[l]=p}concat(i){return new Tr(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ls={kind:"null"},Ve={kind:"number"},wt={kind:"string"},ft={kind:"boolean"},dn={kind:"color"},rr={kind:"object"},_t={kind:"value"},kr={kind:"collator"},Gr={kind:"formatted"},cs={kind:"padding"},Cr={kind:"resolvedImage"},ee={kind:"variableAnchorOffsetCollection"};function O(r,i){return{kind:"array",itemType:r,N:i}}function F(r){if(r.kind==="array"){const i=F(r.itemType);return typeof r.N=="number"?`array<${i}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${i}>`}return r.kind}const G=[ls,Ve,wt,ft,dn,Gr,rr,O(_t),cs,Cr,ee];function J(r,i){if(i.kind==="error")return null;if(r.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!J(r.itemType,i.itemType))&&(typeof r.N!="number"||r.N===i.N))return null}else{if(r.kind===i.kind)return null;if(r.kind==="value"){for(const s of G)if(!J(s,i))return null}}return`Expected ${F(r)} but found ${F(i)} instead.`}function le(r,i){return i.some(s=>s.kind===r.kind)}function he(r,i){return i.some(s=>s==="null"?r===null:s==="array"?Array.isArray(r):s==="object"?r&&!Array.isArray(r)&&typeof r=="object":s===typeof r)}function fe(r,i){return r.kind==="array"&&i.kind==="array"?r.itemType.kind===i.itemType.kind&&typeof r.N=="number":r.kind===i.kind}const re=.96422,Te=.82521,Ee=4/29,xe=6/29,Fe=3*xe*xe,rt=xe*xe*xe,lt=Math.PI/180,At=180/Math.PI;function vt(r){return(r%=360)<0&&(r+=360),r}function Mt([r,i,s,l]){let p,y;const _=xi((.2225045*(r=Tt(r))+.7168786*(i=Tt(i))+.0606169*(s=Tt(s)))/1);r===i&&i===s?p=y=_:(p=xi((.4360747*r+.3850649*i+.1430804*s)/re),y=xi((.0139322*r+.0971045*i+.7141733*s)/Te));const w=116*_-16;return[w<0?0:w,500*(p-_),200*(_-y),l]}function Tt(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function xi(r){return r>rt?Math.pow(r,1/3):r/Fe+Ee}function ri([r,i,s,l]){let p=(r+16)/116,y=isNaN(i)?p:p+i/500,_=isNaN(s)?p:p-s/200;return p=1*Vt(p),y=re*Vt(y),_=Te*Vt(_),[bt(3.1338561*y-1.6168667*p-.4906146*_),bt(-.9787684*y+1.9161415*p+.033454*_),bt(.0719453*y-.2289914*p+1.4052427*_),l]}function bt(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function Vt(r){return r>xe?r*r*r:Fe*(r-Ee)}function ti(r){return parseInt(r.padEnd(2,r),16)/255}function Ii(r,i){return Li(i?r/100:r,0,1)}function Li(r,i,s){return Math.min(Math.max(i,r),s)}function Qi(r){return!r.some(Number.isNaN)}const aa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Nt{constructor(i,s,l,p=1,y=!0){this.r=i,this.g=s,this.b=l,this.a=p,y||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[i,s,l,p]))}static parse(i){if(i instanceof Nt)return i;if(typeof i!="string")return;const s=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=aa[l];if(p){const[_,w,S]=p;return[_/255,w/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const _=l.length<6?1:2;let w=1;return[ti(l.slice(w,w+=_)),ti(l.slice(w,w+=_)),ti(l.slice(w,w+=_)),ti(l.slice(w,w+_)||"ff")]}if(l.startsWith("rgb")){const _=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[w,S,C,P,M,R,j,U,$,Y,te,me]=_,oe=[P||" ",j||" ",Y].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const pe=[C,R,$].join(""),be=pe==="%%%"?100:pe===""?255:0;if(be){const ze=[Li(+S/be,0,1),Li(+M/be,0,1),Li(+U/be,0,1),te?Ii(+te,me):1];if(Qi(ze))return ze}}return}}const y=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[_,w,S,C,P,M,R,j,U]=y,$=[S||" ",P||" ",R].join("");if($==="  "||$==="  /"||$===",,"||$===",,,"){const Y=[+w,Li(+C,0,100),Li(+M,0,100),j?Ii(+j,U):1];if(Qi(Y))return function([te,me,oe,pe]){function be(ze){const Ze=(ze+te/30)%12,ct=me*Math.min(oe,1-oe);return oe-ct*Math.max(-1,Math.min(Ze-3,9-Ze,1))}return te=vt(te),me/=100,oe/=100,[be(0),be(8),be(4),pe]}(Y)}}}(i);return s?new Nt(...s,!1):void 0}get rgb(){const{r:i,g:s,b:l,a:p}=this,y=p||1/0;return this.overwriteGetter("rgb",[i/y,s/y,l/y,p])}get hcl(){return this.overwriteGetter("hcl",function(i){const[s,l,p,y]=Mt(i),_=Math.sqrt(l*l+p*p);return[Math.round(1e4*_)?vt(Math.atan2(p,l)*At):NaN,_,s,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Mt(this.rgb))}overwriteGetter(i,s){return Object.defineProperty(this,i,{value:s}),s}toString(){const[i,s,l,p]=this.rgb;return`rgba(${[i,s,l].map(y=>Math.round(255*y)).join(",")},${p})`}}Nt.black=new Nt(0,0,0,1),Nt.white=new Nt(1,1,1,1),Nt.transparent=new Nt(0,0,0,0),Nt.red=new Nt(1,0,0,1);class Uc{constructor(i,s,l){this.sensitivity=i?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,s){return this.collator.compare(i,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class $c{constructor(i,s,l,p,y){this.text=i,this.image=s,this.scale=l,this.fontStack=p,this.textColor=y}}class Cn{constructor(i){this.sections=i}static fromString(i){return new Cn([new $c(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof Cn?i:Cn.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class Pn{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Pn)return i;if(typeof i=="number")return new Pn([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const s of i)if(typeof s!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new Pn(i)}}toString(){return JSON.stringify(this.values)}}const Vf=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Un{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Un)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let s=0;s<i.length;s+=2){const l=i[s],p=i[s+1];if(typeof l!="string"||!Vf.has(l)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Un(i)}}toString(){return JSON.stringify(this.values)}}class In{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new In({name:i,available:!1}):null}}function oa(r,i,s,l){return typeof r=="number"&&r>=0&&r<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof s=="number"&&s>=0&&s<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,i,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,i,s,l]:[r,i,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function As(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Nt||r instanceof Uc||r instanceof Cn||r instanceof Pn||r instanceof Un||r instanceof In)return!0;if(Array.isArray(r)){for(const i of r)if(!As(i))return!1;return!0}if(typeof r=="object"){for(const i in r)if(!As(r[i]))return!1;return!0}return!1}function wi(r){if(r===null)return ls;if(typeof r=="string")return wt;if(typeof r=="boolean")return ft;if(typeof r=="number")return Ve;if(r instanceof Nt)return dn;if(r instanceof Uc)return kr;if(r instanceof Cn)return Gr;if(r instanceof Pn)return cs;if(r instanceof Un)return ee;if(r instanceof In)return Cr;if(Array.isArray(r)){const i=r.length;let s;for(const l of r){const p=wi(l);if(s){if(s===p)continue;s=_t;break}s=p}return O(s||_t,i)}return rr}function go(r){const i=typeof r;return r===null?"":i==="string"||i==="number"||i==="boolean"?String(r):r instanceof Nt||r instanceof Cn||r instanceof Pn||r instanceof Un||r instanceof In?r.toString():JSON.stringify(r)}class sr{constructor(i,s){this.type=i,this.value=s}static parse(i,s){if(i.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!As(i[1]))return s.error("invalid value");const l=i[1];let p=wi(l);const y=s.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new sr(p,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class fi{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const ll={string:wt,number:Ve,boolean:ft,object:rr};class ar{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");let l,p=1;const y=i[0];if(y==="array"){let w,S;if(i.length>2){const C=i[1];if(typeof C!="string"||!(C in ll)||C==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);w=ll[C],p++}else w=_t;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=i[2],p++}l=O(w,S)}else{if(!ll[y])throw new Error(`Types doesn't contain name = ${y}`);l=ll[y]}const _=[];for(;p<i.length;p++){const w=s.parse(i[p],p,_t);if(!w)return null;_.push(w)}return new ar(l,_)}evaluate(i){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(i);if(!J(this.type,wi(l)))return l;if(s===this.args.length-1)throw new fi(`Expected value to be of type ${F(this.type)}, but found ${F(wi(l))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Gc={"to-boolean":ft,"to-color":dn,"to-number":Ve,"to-string":wt};class or{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const l=i[0];if(!Gc[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&i.length!==2)return s.error("Expected one argument.");const p=Gc[l],y=[];for(let _=1;_<i.length;_++){const w=s.parse(i[_],_,_t);if(!w)return null;y.push(w)}return new or(p,y)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let s,l;for(const p of this.args){if(s=p.evaluate(i),l=null,s instanceof Nt)return s;if(typeof s=="string"){const y=i.parseColor(s);if(y)return y}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:oa(s[0],s[1],s[2],s[3]),!l))return new Nt(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new fi(l||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const l of this.args){s=l.evaluate(i);const p=Pn.parse(s);if(p)return p}throw new fi(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const l of this.args){s=l.evaluate(i);const p=Un.parse(s);if(p)return p}throw new fi(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const l of this.args){if(s=l.evaluate(i),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new fi(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return Cn.fromString(go(this.args[0].evaluate(i)));case"resolvedImage":return In.fromString(go(this.args[0].evaluate(i)));default:return go(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Nf=["Unknown","Point","LineString","Polygon"];class cl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Nf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let s=this._parseColorCache[i];return s||(s=this._parseColorCache[i]=Nt.parse(i)),s}}class Ms{constructor(i,s,l=[],p,y=new Tr,_=[]){this.registry=i,this.path=l,this.key=l.map(w=>`[${w}]`).join(""),this.scope=y,this.errors=_,this.expectedType=p,this._isConstant=s}parse(i,s,l,p,y={}){return s?this.concat(s,l,p)._parse(i,y):this._parse(i,y)}_parse(i,s){function l(p,y,_){return _==="assert"?new ar(y,[p]):_==="coerce"?new or(y,[p]):p}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=i[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[p];if(y){let _=y.parse(i,this);if(!_)return null;if(this.expectedType){const w=this.expectedType,S=_.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||S.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(w.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(w,S))return null}else _=l(_,w,s.typeAnnotation||"coerce");else _=l(_,w,s.typeAnnotation||"coerce");else _=l(_,w,s.typeAnnotation||"coerce");else _=l(_,w,s.typeAnnotation||"assert")}if(!(_ instanceof sr)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const w=new cl;try{_=new sr(_.type,_.evaluate(w))}catch(S){return this.error(S.message),null}}return _}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,s,l){const p=typeof i=="number"?this.path.concat(i):this.path,y=l?this.scope.concat(l):this.scope;return new Ms(this.registry,this._isConstant,p,s||null,y,this.errors)}error(i,...s){const l=`${this.key}${s.map(p=>`[${p}]`).join("")}`;this.errors.push(new Ji(l,i))}checkSubtype(i,s){const l=J(i,s);return l&&this.error(l),l}}class us{constructor(i,s){this.type=s.type,this.bindings=[].concat(i),this.result=s}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const s of this.bindings)i(s[1]);i(this.result)}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const l=[];for(let y=1;y<i.length-1;y+=2){const _=i[y];if(typeof _!="string")return s.error(`Expected string, but found ${typeof _} instead.`,y);if(/[^a-zA-Z0-9_]/.test(_))return s.error("Variable names must contain only alphanumeric characters or '_'.",y);const w=s.parse(i[y+1],y+1);if(!w)return null;l.push([_,w])}const p=s.parse(i[i.length-1],i.length-1,s.expectedType,l);return p?new us(l,p):null}outputDefined(){return this.result.outputDefined()}}class Rt{constructor(i,s){this.type=s.type,this.name=i,this.boundExpression=s}static parse(i,s){if(i.length!==2||typeof i[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const l=i[1];return s.scope.has(l)?new Rt(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Hc{constructor(i,s,l){this.type=i,this.index=s,this.input=l}static parse(i,s){if(i.length!==3)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,Ve),p=s.parse(i[2],2,O(s.expectedType||_t));return l&&p?new Hc(p.type.itemType,l,p):null}evaluate(i){const s=this.index.evaluate(i),l=this.input.evaluate(i);if(s<0)throw new fi(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new fi(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new fi(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class qc{constructor(i,s){this.type=ft,this.needle=i,this.haystack=s}static parse(i,s){if(i.length!==3)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,_t),p=s.parse(i[2],2,_t);return l&&p?le(l.type,[ft,wt,Ve,ls,_t])?new qc(l,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${F(l.type)} instead`):null}evaluate(i){const s=this.needle.evaluate(i),l=this.haystack.evaluate(i);if(!l)return!1;if(!he(s,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${F(wi(s))} instead.`);if(!he(l,["string","array"]))throw new fi(`Expected second argument to be of type array or string, but found ${F(wi(l))} instead.`);return l.indexOf(s)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class la{constructor(i,s,l){this.type=Ve,this.needle=i,this.haystack=s,this.fromIndex=l}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,_t),p=s.parse(i[2],2,_t);if(!l||!p)return null;if(!le(l.type,[ft,wt,Ve,ls,_t]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${F(l.type)} instead`);if(i.length===4){const y=s.parse(i[3],3,Ve);return y?new la(l,p,y):null}return new la(l,p)}evaluate(i){const s=this.needle.evaluate(i),l=this.haystack.evaluate(i);if(!he(s,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${F(wi(s))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(i)),he(l,["string"])){const y=l.indexOf(s,p);return y===-1?-1:[...l.slice(0,y)].length}if(he(l,["array"]))return l.indexOf(s,p);throw new fi(`Expected second argument to be of type array or string, but found ${F(wi(l))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Zc{constructor(i,s,l,p,y,_){this.inputType=i,this.type=s,this.input=l,this.cases=p,this.outputs=y,this.otherwise=_}static parse(i,s){if(i.length<5)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return s.error("Expected an even number of arguments.");let l,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const y={},_=[];for(let C=2;C<i.length-1;C+=2){let P=i[C];const M=i[C+1];Array.isArray(P)||(P=[P]);const R=s.concat(C);if(P.length===0)return R.error("Expected at least one branch label.");for(const U of P){if(typeof U!="number"&&typeof U!="string")return R.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof U=="number"&&Math.floor(U)!==U)return R.error("Numeric branch labels must be integer values.");if(l){if(R.checkSubtype(l,wi(U)))return null}else l=wi(U);if(y[String(U)]!==void 0)return R.error("Branch labels must be unique.");y[String(U)]=_.length}const j=s.parse(M,C,p);if(!j)return null;p=p||j.type,_.push(j)}const w=s.parse(i[1],1,_t);if(!w)return null;const S=s.parse(i[i.length-1],i.length-1,p);return S?w.type.kind!=="value"&&s.concat(1).checkSubtype(l,w.type)?null:new Zc(l,p,w,y,_,S):null}evaluate(i){const s=this.input.evaluate(i);return(wi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class ul{constructor(i,s,l){this.type=i,this.branches=s,this.otherwise=l}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&s.expectedType.kind!=="value"&&(l=s.expectedType);const p=[];for(let _=1;_<i.length-1;_+=2){const w=s.parse(i[_],_,ft);if(!w)return null;const S=s.parse(i[_+1],_+1,l);if(!S)return null;p.push([w,S]),l=l||S.type}const y=s.parse(i[i.length-1],i.length-1,l);if(!y)return null;if(!l)throw new Error("Can't infer output type");return new ul(l,p,y)}evaluate(i){for(const[s,l]of this.branches)if(s.evaluate(i))return l.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[s,l]of this.branches)i(s),i(l);i(this.otherwise)}outputDefined(){return this.branches.every(([i,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class yo{constructor(i,s,l,p){this.type=i,this.input=s,this.beginIndex=l,this.endIndex=p}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,_t),p=s.parse(i[2],2,Ve);if(!l||!p)return null;if(!le(l.type,[O(_t),wt,_t]))return s.error(`Expected first argument to be of type array or string, but found ${F(l.type)} instead`);if(i.length===4){const y=s.parse(i[3],3,Ve);return y?new yo(l.type,l,p,y):null}return new yo(l.type,l,p)}evaluate(i){const s=this.input.evaluate(i),l=this.beginIndex.evaluate(i);let p;if(this.endIndex&&(p=this.endIndex.evaluate(i)),he(s,["string"]))return[...s].slice(l,p).join("");if(he(s,["array"]))return s.slice(l,p);throw new fi(`Expected first argument to be of type array or string, but found ${F(wi(s))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function hl(r,i){const s=r.length-1;let l,p,y=0,_=s,w=0;for(;y<=_;)if(w=Math.floor((y+_)/2),l=r[w],p=r[w+1],l<=i){if(w===s||i<p)return w;y=w+1}else{if(!(l>i))throw new fi("Input is not a number.");_=w-1}return 0}class ca{constructor(i,s,l){this.type=i,this.input=s,this.labels=[],this.outputs=[];for(const[p,y]of l)this.labels.push(p),this.outputs.push(y)}static parse(i,s){if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(i[1],1,Ve);if(!l)return null;const p=[];let y=null;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);for(let _=1;_<i.length;_+=2){const w=_===1?-1/0:i[_],S=i[_+1],C=_,P=_+1;if(typeof w!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(p.length&&p[p.length-1][0]>=w)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const M=s.parse(S,P,y);if(!M)return null;y=y||M.type,p.push([w,M])}return new ca(y,l,p)}evaluate(i){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(i);const p=this.input.evaluate(i);if(p<=s[0])return l[0].evaluate(i);const y=s.length;return p>=s[y-1]?l[y-1].evaluate(i):l[hl(s,p)].evaluate(i)}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function td(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Uf=id;function id(r,i,s,l){this.cx=3*r,this.bx=3*(s-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(l-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=i,this.p2x=s,this.p2y=l}id.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,i){if(i===void 0&&(i=1e-6),r<0)return 0;if(r>1)return 1;for(var s=r,l=0;l<8;l++){var p=this.sampleCurveX(s)-r;if(Math.abs(p)<i)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=p/y}var _=0,w=1;for(s=r,l=0;l<20&&(p=this.sampleCurveX(s),!(Math.abs(p-r)<i));l++)r>p?_=s:w=s,s=.5*(w-_)+_;return s},solve:function(r,i){return this.sampleCurveY(this.solveCurveX(r,i))}};var $f=td(Uf);function Es(r,i,s){return r+s*(i-r)}function _o(r,i,s){return r.map((l,p)=>Es(l,i[p],s))}const pn={number:Es,color:function(r,i,s,l="rgb"){switch(l){case"rgb":{const[p,y,_,w]=_o(r.rgb,i.rgb,s);return new Nt(p,y,_,w,!1)}case"hcl":{const[p,y,_,w]=r.hcl,[S,C,P,M]=i.hcl;let R,j;if(isNaN(p)||isNaN(S))isNaN(p)?isNaN(S)?R=NaN:(R=S,_!==1&&_!==0||(j=C)):(R=p,P!==1&&P!==0||(j=y));else{let me=S-p;S>p&&me>180?me-=360:S<p&&p-S>180&&(me+=360),R=p+s*me}const[U,$,Y,te]=function([me,oe,pe,be]){return me=isNaN(me)?0:me*lt,ri([pe,Math.cos(me)*oe,Math.sin(me)*oe,be])}([R,j??Es(y,C,s),Es(_,P,s),Es(w,M,s)]);return new Nt(U,$,Y,te,!1)}case"lab":{const[p,y,_,w]=ri(_o(r.lab,i.lab,s));return new Nt(p,y,_,w,!1)}}},array:_o,padding:function(r,i,s){return new Pn(_o(r.values,i.values,s))},variableAnchorOffsetCollection:function(r,i,s){const l=r.values,p=i.values;if(l.length!==p.length)throw new fi(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${i.toString()}`);const y=[];for(let _=0;_<l.length;_+=2){if(l[_]!==p[_])throw new fi(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${l[_]}, to[${_}]: ${p[_]}`);y.push(l[_]);const[w,S]=l[_+1],[C,P]=p[_+1];y.push([Es(w,C,s),Es(S,P,s)])}return new Un(y)}};class fn{constructor(i,s,l,p,y){this.type=i,this.operator=s,this.interpolation=l,this.input=p,this.labels=[],this.outputs=[];for(const[_,w]of y)this.labels.push(_),this.outputs.push(w)}static interpolationFactor(i,s,l,p){let y=0;if(i.name==="exponential")y=dl(s,i.base,l,p);else if(i.name==="linear")y=dl(s,1,l,p);else if(i.name==="cubic-bezier"){const _=i.controlPoints;y=new $f(_[0],_[1],_[2],_[3]).solve(dl(s,1,l,p))}return y}static parse(i,s){let[l,p,y,..._]=i;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const C=p[1];if(typeof C!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:C}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const C=p.slice(1);if(C.length!==4||C.some(P=>typeof P!="number"||P<0||P>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:C}}}if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(y=s.parse(y,2,Ve),!y)return null;const w=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=dn:s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType);for(let C=0;C<_.length;C+=2){const P=_[C],M=_[C+1],R=C+3,j=C+4;if(typeof P!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(w.length&&w[w.length-1][0]>=P)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const U=s.parse(M,j,S);if(!U)return null;S=S||U.type,w.push([P,U])}return fe(S,Ve)||fe(S,dn)||fe(S,cs)||fe(S,ee)||fe(S,O(Ve))?new fn(S,l,p,y,w):s.error(`Type ${F(S)} is not interpolatable.`)}evaluate(i){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(i);const p=this.input.evaluate(i);if(p<=s[0])return l[0].evaluate(i);const y=s.length;if(p>=s[y-1])return l[y-1].evaluate(i);const _=hl(s,p),w=fn.interpolationFactor(this.interpolation,p,s[_],s[_+1]),S=l[_].evaluate(i),C=l[_+1].evaluate(i);switch(this.operator){case"interpolate":return pn[this.type.kind](S,C,w);case"interpolate-hcl":return pn.color(S,C,w,"hcl");case"interpolate-lab":return pn.color(S,C,w,"lab")}}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function dl(r,i,s,l){const p=l-s,y=r-s;return p===0?0:i===1?y/p:(Math.pow(i,y)-1)/(Math.pow(i,p)-1)}class pl{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expectected at least one argument.");let l=null;const p=s.expectedType;p&&p.kind!=="value"&&(l=p);const y=[];for(const w of i.slice(1)){const S=s.parse(w,1+y.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,y.push(S)}if(!l)throw new Error("No output type");const _=p&&y.some(w=>J(p,w.type));return new pl(_?_t:l,y)}evaluate(i){let s,l=null,p=0;for(const y of this.args)if(p++,l=y.evaluate(i),l&&l instanceof In&&!l.available&&(s||(s=l.name),l=null,p===this.args.length&&(l=s)),l!==null)break;return l}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function fl(r,i){return r==="=="||r==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function nd(r,i,s,l){return l.compare(i,s)===0}function ua(r,i,s){const l=r!=="=="&&r!=="!=";return class zT{constructor(y,_,w){this.type=ft,this.lhs=y,this.rhs=_,this.collator=w,this.hasUntypedArgument=y.type.kind==="value"||_.type.kind==="value"}static parse(y,_){if(y.length!==3&&y.length!==4)return _.error("Expected two or three arguments.");const w=y[0];let S=_.parse(y[1],1,_t);if(!S)return null;if(!fl(w,S.type))return _.concat(1).error(`"${w}" comparisons are not supported for type '${F(S.type)}'.`);let C=_.parse(y[2],2,_t);if(!C)return null;if(!fl(w,C.type))return _.concat(2).error(`"${w}" comparisons are not supported for type '${F(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return _.error(`Cannot compare types '${F(S.type)}' and '${F(C.type)}'.`);l&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new ar(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new ar(S.type,[C])));let P=null;if(y.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(P=_.parse(y[3],3,kr),!P)return null}return new zT(S,C,P)}evaluate(y){const _=this.lhs.evaluate(y),w=this.rhs.evaluate(y);if(l&&this.hasUntypedArgument){const S=wi(_),C=wi(w);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new fi(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=wi(_),C=wi(w);if(S.kind!=="string"||C.kind!=="string")return i(y,_,w)}return this.collator?s(y,_,w,this.collator.evaluate(y)):i(y,_,w)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Gf=ua("==",function(r,i,s){return i===s},nd),rd=ua("!=",function(r,i,s){return i!==s},function(r,i,s,l){return!nd(0,i,s,l)}),sd=ua("<",function(r,i,s){return i<s},function(r,i,s,l){return l.compare(i,s)<0}),Hf=ua(">",function(r,i,s){return i>s},function(r,i,s,l){return l.compare(i,s)>0}),qf=ua("<=",function(r,i,s){return i<=s},function(r,i,s,l){return l.compare(i,s)<=0}),ad=ua(">=",function(r,i,s){return i>=s},function(r,i,s,l){return l.compare(i,s)>=0});class vo{constructor(i,s,l){this.type=kr,this.locale=l,this.caseSensitive=i,this.diacriticSensitive=s}static parse(i,s){if(i.length!==2)return s.error("Expected one argument.");const l=i[1];if(typeof l!="object"||Array.isArray(l))return s.error("Collator options argument must be an object.");const p=s.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,ft);if(!p)return null;const y=s.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,ft);if(!y)return null;let _=null;return l.locale&&(_=s.parse(l.locale,1,wt),!_)?null:new vo(p,y,_)}evaluate(i){return new Uc(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class Wc{constructor(i,s,l,p,y){this.type=wt,this.number=i,this.locale=s,this.currency=l,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(i,s){if(i.length!==3)return s.error("Expected two arguments.");const l=s.parse(i[1],1,Ve);if(!l)return null;const p=i[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=s.parse(p.locale,1,wt),!y))return null;let _=null;if(p.currency&&(_=s.parse(p.currency,1,wt),!_))return null;let w=null;if(p["min-fraction-digits"]&&(w=s.parse(p["min-fraction-digits"],1,Ve),!w))return null;let S=null;return p["max-fraction-digits"]&&(S=s.parse(p["max-fraction-digits"],1,Ve),!S)?null:new Wc(l,y,_,w,S)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class ml{constructor(i){this.type=Gr,this.sections=i}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const l=i[1];if(!Array.isArray(l)&&typeof l=="object")return s.error("First argument must be an image or text section.");const p=[];let y=!1;for(let _=1;_<=i.length-1;++_){const w=i[_];if(y&&typeof w=="object"&&!Array.isArray(w)){y=!1;let S=null;if(w["font-scale"]&&(S=s.parse(w["font-scale"],1,Ve),!S))return null;let C=null;if(w["text-font"]&&(C=s.parse(w["text-font"],1,O(wt)),!C))return null;let P=null;if(w["text-color"]&&(P=s.parse(w["text-color"],1,dn),!P))return null;const M=p[p.length-1];M.scale=S,M.font=C,M.textColor=P}else{const S=s.parse(i[_],1,_t);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:S,scale:null,font:null,textColor:null})}}return new ml(p)}evaluate(i){return new Cn(this.sections.map(s=>{const l=s.content.evaluate(i);return wi(l)===Cr?new $c("",l,null,null,null):new $c(go(l),null,s.scale?s.scale.evaluate(i):null,s.font?s.font.evaluate(i).join(","):null,s.textColor?s.textColor.evaluate(i):null)}))}eachChild(i){for(const s of this.sections)i(s.content),s.scale&&i(s.scale),s.font&&i(s.font),s.textColor&&i(s.textColor)}outputDefined(){return!1}}class Xc{constructor(i){this.type=Cr,this.input=i}static parse(i,s){if(i.length!==2)return s.error("Expected two arguments.");const l=s.parse(i[1],1,wt);return l?new Xc(l):s.error("No image name provided.")}evaluate(i){const s=this.input.evaluate(i),l=In.fromString(s);return l&&i.availableImages&&(l.available=i.availableImages.indexOf(s)>-1),l}eachChild(i){i(this.input)}outputDefined(){return!1}}class Kc{constructor(i){this.type=Ve,this.input=i}static parse(i,s){if(i.length!==2)return s.error(`Expected 1 argument, but found ${i.length-1} instead.`);const l=s.parse(i[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${F(l.type)} instead.`):new Kc(l):null}evaluate(i){const s=this.input.evaluate(i);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new fi(`Expected value to be of type string or array, but found ${F(wi(s))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const Pr=8192;function Zf(r,i){const s=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,p=Math.pow(2,i.z);return[Math.round(s*p*Pr),Math.round(l*p*Pr)]}function Yc(r,i){const s=Math.pow(2,i.z);return[(p=(r[0]/Pr+i.x)/s,360*p-180),(l=(r[1]/Pr+i.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,p}function zs(r,i){r[0]=Math.min(r[0],i[0]),r[1]=Math.min(r[1],i[1]),r[2]=Math.max(r[2],i[0]),r[3]=Math.max(r[3],i[1])}function hs(r,i){return!(r[0]<=i[0]||r[2]>=i[2]||r[1]<=i[1]||r[3]>=i[3])}function Ft(r,i,s){const l=r[0]-i[0],p=r[1]-i[1],y=r[0]-s[0],_=r[1]-s[1];return l*_-y*p==0&&l*y<=0&&p*_<=0}function gl(r,i,s,l){return(p=[l[0]-s[0],l[1]-s[1]])[0]*(y=[i[0]-r[0],i[1]-r[1]])[1]-p[1]*y[0]!=0&&!(!ld(r,i,s,l)||!ld(s,l,r,i));var p,y}function Wf(r,i,s){for(const l of s)for(let p=0;p<l.length-1;++p)if(gl(r,i,l[p],l[p+1]))return!0;return!1}function ha(r,i,s=!1){let l=!1;for(const w of i)for(let S=0;S<w.length-1;S++){if(Ft(r,w[S],w[S+1]))return s;(y=w[S])[1]>(p=r)[1]!=(_=w[S+1])[1]>p[1]&&p[0]<(_[0]-y[0])*(p[1]-y[1])/(_[1]-y[1])+y[0]&&(l=!l)}var p,y,_;return l}function Xf(r,i){for(const s of i)if(ha(r,s))return!0;return!1}function od(r,i){for(const s of r)if(!ha(s,i))return!1;for(let s=0;s<r.length-1;++s)if(Wf(r[s],r[s+1],i))return!1;return!0}function Kf(r,i){for(const s of i)if(od(r,s))return!0;return!1}function ld(r,i,s,l){const p=l[0]-s[0],y=l[1]-s[1],_=(r[0]-s[0])*y-p*(r[1]-s[1]),w=(i[0]-s[0])*y-p*(i[1]-s[1]);return _>0&&w<0||_<0&&w>0}function Jc(r,i,s){const l=[];for(let p=0;p<r.length;p++){const y=[];for(let _=0;_<r[p].length;_++){const w=Zf(r[p][_],s);zs(i,w),y.push(w)}l.push(y)}return l}function cd(r,i,s){const l=[];for(let p=0;p<r.length;p++){const y=Jc(r[p],i,s);l.push(y)}return l}function ud(r,i,s,l){if(r[0]<s[0]||r[0]>s[2]){const p=.5*l;let y=r[0]-s[0]>p?-l:s[0]-r[0]>p?l:0;y===0&&(y=r[0]-s[2]>p?-l:s[2]-r[0]>p?l:0),r[0]+=y}zs(i,r)}function hd(r,i,s,l){const p=Math.pow(2,l.z)*Pr,y=[l.x*Pr,l.y*Pr],_=[];for(const w of r)for(const S of w){const C=[S.x+y[0],S.y+y[1]];ud(C,i,s,p),_.push(C)}return _}function dd(r,i,s,l){const p=Math.pow(2,l.z)*Pr,y=[l.x*Pr,l.y*Pr],_=[];for(const S of r){const C=[];for(const P of S){const M=[P.x+y[0],P.y+y[1]];zs(i,M),C.push(M)}_.push(C)}if(i[2]-i[0]<=p/2){(w=i)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const S of _)for(const C of S)ud(C,i,s,p)}var w;return _}class Ds{constructor(i,s){this.type=ft,this.geojson=i,this.geometries=s}static parse(i,s){if(i.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(As(i[1])){const l=i[1];if(l.type==="FeatureCollection"){const p=[];for(const y of l.features){const{type:_,coordinates:w}=y.geometry;_==="Polygon"&&p.push(w),_==="MultiPolygon"&&p.push(...w)}if(p.length)return new Ds(l,{type:"MultiPolygon",coordinates:p})}else if(l.type==="Feature"){const p=l.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Ds(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ds(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(s,l){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const w=Jc(l.coordinates,y,_),S=hd(s.geometry(),p,y,_);if(!hs(p,y))return!1;for(const C of S)if(!ha(C,w))return!1}if(l.type==="MultiPolygon"){const w=cd(l.coordinates,y,_),S=hd(s.geometry(),p,y,_);if(!hs(p,y))return!1;for(const C of S)if(!Xf(C,w))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(s,l){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const w=Jc(l.coordinates,y,_),S=dd(s.geometry(),p,y,_);if(!hs(p,y))return!1;for(const C of S)if(!od(C,w))return!1}if(l.type==="MultiPolygon"){const w=cd(l.coordinates,y,_),S=dd(s.geometry(),p,y,_);if(!hs(p,y))return!1;for(const C of S)if(!Kf(C,w))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let pd=class{constructor(r=[],i=(s,l)=>s<l?-1:s>l?1:0){if(this.data=r,this.length=this.data.length,this.compare=i,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:i,compare:s}=this,l=i[r];for(;r>0;){const p=r-1>>1,y=i[p];if(s(l,y)>=0)break;i[r]=y,r=p}i[r]=l}_down(r){const{data:i,compare:s}=this,l=this.length>>1,p=i[r];for(;r<l;){let y=1+(r<<1);const _=y+1;if(_<this.length&&s(i[_],i[y])<0&&(y=_),s(i[y],p)>=0)break;i[r]=i[y],r=y}i[r]=p}};function Yf(r,i,s,l,p){fd(r,i,s,l||r.length-1,p||Jf)}function fd(r,i,s,l,p){for(;l>s;){if(l-s>600){var y=l-s+1,_=i-s+1,w=Math.log(y),S=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*S*(y-S)/y)*(_-y/2<0?-1:1);fd(r,i,Math.max(s,Math.floor(i-_*S/y+C)),Math.min(l,Math.floor(i+(y-_)*S/y+C)),p)}var P=r[i],M=s,R=l;for(xo(r,s,i),p(r[l],P)>0&&xo(r,s,l);M<R;){for(xo(r,M,R),M++,R--;p(r[M],P)<0;)M++;for(;p(r[R],P)>0;)R--}p(r[s],P)===0?xo(r,s,R):xo(r,++R,l),R<=i&&(s=R+1),i<=R&&(l=R-1)}}function xo(r,i,s){var l=r[i];r[i]=r[s],r[s]=l}function Jf(r,i){return r<i?-1:r>i?1:0}function yl(r,i){if(r.length<=1)return[r];const s=[];let l,p;for(const y of r){const _=em(y);_!==0&&(y.area=Math.abs(_),p===void 0&&(p=_<0),p===_<0?(l&&s.push(l),l=[y]):l.push(y))}if(l&&s.push(l),i>1)for(let y=0;y<s.length;y++)s[y].length<=i||(Yf(s[y],i,1,s[y].length-1,Qf),s[y]=s[y].slice(0,i));return s}function Qf(r,i){return i.area-r.area}function em(r){let i=0;for(let s,l,p=0,y=r.length,_=y-1;p<y;_=p++)s=r[p],l=r[_],i+=(l.x-s.x)*(s.y+l.y);return i}const md=1/298.257223563,gd=md*(2-md),yd=Math.PI/180;class Qc{constructor(i){const s=6378.137*yd*1e3,l=Math.cos(i*yd),p=1/(1-gd*(1-l*l)),y=Math.sqrt(p);this.kx=s*y*l,this.ky=s*y*p*(1-gd)}distance(i,s){const l=this.wrap(i[0]-s[0])*this.kx,p=(i[1]-s[1])*this.ky;return Math.sqrt(l*l+p*p)}pointOnLine(i,s){let l,p,y,_,w=1/0;for(let S=0;S<i.length-1;S++){let C=i[S][0],P=i[S][1],M=this.wrap(i[S+1][0]-C)*this.kx,R=(i[S+1][1]-P)*this.ky,j=0;M===0&&R===0||(j=(this.wrap(s[0]-C)*this.kx*M+(s[1]-P)*this.ky*R)/(M*M+R*R),j>1?(C=i[S+1][0],P=i[S+1][1]):j>0&&(C+=M/this.kx*j,P+=R/this.ky*j)),M=this.wrap(s[0]-C)*this.kx,R=(s[1]-P)*this.ky;const U=M*M+R*R;U<w&&(w=U,l=C,p=P,y=S,_=j)}return{point:[l,p],index:y,t:Math.max(0,Math.min(1,_))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function _d(r,i){return i[0]-r[0]}function _l(r){return r[1]-r[0]+1}function Hr(r,i){return r[1]>=r[0]&&r[1]<i}function eu(r,i){if(r[0]>r[1])return[null,null];const s=_l(r);if(i){if(s===2)return[r,null];const p=Math.floor(s/2);return[[r[0],r[0]+p],[r[0]+p,r[1]]]}if(s===1)return[r,null];const l=Math.floor(s/2)-1;return[[r[0],r[0]+l],[r[0]+l+1,r[1]]]}function tu(r,i){if(!Hr(i,r.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let l=i[0];l<=i[1];++l)zs(s,r[l]);return s}function iu(r){const i=[1/0,1/0,-1/0,-1/0];for(const s of r)for(const l of s)zs(i,l);return i}function vl(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function nu(r,i,s){if(!vl(r)||!vl(i))return NaN;let l=0,p=0;return r[2]<i[0]&&(l=i[0]-r[2]),r[0]>i[2]&&(l=r[0]-i[2]),r[1]>i[3]&&(p=r[1]-i[3]),r[3]<i[1]&&(p=i[1]-r[3]),s.distance([0,0],[l,p])}function Ls(r,i,s){const l=s.pointOnLine(i,r);return s.distance(r,l.point)}function ru(r,i,s,l,p){const y=Math.min(Ls(r,[s,l],p),Ls(i,[s,l],p)),_=Math.min(Ls(s,[r,i],p),Ls(l,[r,i],p));return Math.min(y,_)}function tm(r,i,s,l,p){if(!Hr(i,r.length)||!Hr(l,s.length))return 1/0;let y=1/0;for(let _=i[0];_<i[1];++_){const w=r[_],S=r[_+1];for(let C=l[0];C<l[1];++C){const P=s[C],M=s[C+1];if(gl(w,S,P,M))return 0;y=Math.min(y,ru(w,S,P,M,p))}}return y}function ci(r,i,s,l,p){if(!Hr(i,r.length)||!Hr(l,s.length))return NaN;let y=1/0;for(let _=i[0];_<=i[1];++_)for(let w=l[0];w<=l[1];++w)if(y=Math.min(y,p.distance(r[_],s[w])),y===0)return y;return y}function im(r,i,s){if(ha(r,i,!0))return 0;let l=1/0;for(const p of i){const y=p[0],_=p[p.length-1];if(y!==_&&(l=Math.min(l,Ls(r,[_,y],s)),l===0))return l;const w=s.pointOnLine(p,r);if(l=Math.min(l,s.distance(r,w.point)),l===0)return l}return l}function St(r,i,s,l){if(!Hr(i,r.length))return NaN;for(let y=i[0];y<=i[1];++y)if(ha(r[y],s,!0))return 0;let p=1/0;for(let y=i[0];y<i[1];++y){const _=r[y],w=r[y+1];for(const S of s)for(let C=0,P=S.length,M=P-1;C<P;M=C++){const R=S[M],j=S[C];if(gl(_,w,R,j))return 0;p=Math.min(p,ru(_,w,R,j,l))}}return p}function xl(r,i){for(const s of r)for(const l of s)if(ha(l,i,!0))return!0;return!1}function qt(r,i,s,l=1/0){const p=iu(r),y=iu(i);if(l!==1/0&&nu(p,y,s)>=l)return l;if(hs(p,y)){if(xl(r,i))return 0}else if(xl(i,r))return 0;let _=1/0;for(const w of r)for(let S=0,C=w.length,P=C-1;S<C;P=S++){const M=w[P],R=w[S];for(const j of i)for(let U=0,$=j.length,Y=$-1;U<$;Y=U++){const te=j[Y],me=j[U];if(gl(M,R,te,me))return 0;_=Math.min(_,ru(M,R,te,me,s))}}return _}function Ut(r,i,s,l,p,y){if(!y)return;const _=nu(tu(l,y),p,s);_<i&&r.push([_,y,[0,0]])}function Rs(r,i,s,l,p,y,_){if(!y||!_)return;const w=nu(tu(l,y),tu(p,_),s);w<i&&r.push([w,y,_])}function wo(r,i,s,l,p=1/0){let y=Math.min(l.distance(r[0],s[0][0]),p);if(y===0)return y;const _=new pd([[0,[0,r.length-1],[0,0]]],_d),w=iu(s);for(;_.length>0;){const S=_.pop();if(S[0]>=y)continue;const C=S[1],P=i?50:100;if(_l(C)<=P){if(!Hr(C,r.length))return NaN;if(i){const M=St(r,C,s,l);if(isNaN(M)||M===0)return M;y=Math.min(y,M)}else for(let M=C[0];M<=C[1];++M){const R=im(r[M],s,l);if(y=Math.min(y,R),y===0)return 0}}else{const M=eu(C,i);Ut(_,y,l,r,w,M[0]),Ut(_,y,l,r,w,M[1])}}return y}function bo(r,i,s,l,p,y=1/0){let _=Math.min(y,p.distance(r[0],s[0]));if(_===0)return _;const w=new pd([[0,[0,r.length-1],[0,s.length-1]]],_d);for(;w.length>0;){const S=w.pop();if(S[0]>=_)continue;const C=S[1],P=S[2],M=i?50:100,R=l?50:100;if(_l(C)<=M&&_l(P)<=R){if(!Hr(C,r.length)&&Hr(P,s.length))return NaN;let j;if(i&&l)j=tm(r,C,s,P,p),_=Math.min(_,j);else if(i&&!l){const U=r.slice(C[0],C[1]+1);for(let $=P[0];$<=P[1];++$)if(j=Ls(s[$],U,p),_=Math.min(_,j),_===0)return _}else if(!i&&l){const U=s.slice(P[0],P[1]+1);for(let $=C[0];$<=C[1];++$)if(j=Ls(r[$],U,p),_=Math.min(_,j),_===0)return _}else j=ci(r,C,s,P,p),_=Math.min(_,j)}else{const j=eu(C,i),U=eu(P,l);Rs(w,_,p,r,s,j[0],U[0]),Rs(w,_,p,r,s,j[0],U[1]),Rs(w,_,p,r,s,j[1],U[0]),Rs(w,_,p,r,s,j[1],U[1])}}return _}function su(r){return r.type==="MultiPolygon"?r.coordinates.map(i=>({type:"Polygon",coordinates:i})):r.type==="MultiLineString"?r.coordinates.map(i=>({type:"LineString",coordinates:i})):r.type==="MultiPoint"?r.coordinates.map(i=>({type:"Point",coordinates:i})):[r]}class Bs{constructor(i,s){this.type=Ve,this.geojson=i,this.geometries=s}static parse(i,s){if(i.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(As(i[1])){const l=i[1];if(l.type==="FeatureCollection")return new Bs(l,l.features.map(p=>su(p.geometry)).flat());if(l.type==="Feature")return new Bs(l,su(l.geometry));if("type"in l&&"coordinates"in l)return new Bs(l,su(l))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(s,l){const p=s.geometry(),y=p.flat().map(S=>Yc([S.x,S.y],s.canonical));if(p.length===0)return NaN;const _=new Qc(y[0][1]);let w=1/0;for(const S of l){switch(S.type){case"Point":w=Math.min(w,bo(y,!1,[S.coordinates],!1,_,w));break;case"LineString":w=Math.min(w,bo(y,!1,S.coordinates,!0,_,w));break;case"Polygon":w=Math.min(w,wo(y,!1,S.coordinates,_,w))}if(w===0)return w}return w}(i,this.geometries);if(i.geometryType()==="LineString")return function(s,l){const p=s.geometry(),y=p.flat().map(S=>Yc([S.x,S.y],s.canonical));if(p.length===0)return NaN;const _=new Qc(y[0][1]);let w=1/0;for(const S of l){switch(S.type){case"Point":w=Math.min(w,bo(y,!0,[S.coordinates],!1,_,w));break;case"LineString":w=Math.min(w,bo(y,!0,S.coordinates,!0,_,w));break;case"Polygon":w=Math.min(w,wo(y,!0,S.coordinates,_,w))}if(w===0)return w}return w}(i,this.geometries);if(i.geometryType()==="Polygon")return function(s,l){const p=s.geometry();if(p.length===0||p[0].length===0)return NaN;const y=yl(p,0).map(S=>S.map(C=>C.map(P=>Yc([P.x,P.y],s.canonical)))),_=new Qc(y[0][0][0][1]);let w=1/0;for(const S of l)for(const C of y){switch(S.type){case"Point":w=Math.min(w,wo([S.coordinates],!1,C,_,w));break;case"LineString":w=Math.min(w,wo(S.coordinates,!0,C,_,w));break;case"Polygon":w=Math.min(w,qt(C,S.coordinates,_,w))}if(w===0)return w}return w}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const da={"==":Gf,"!=":rd,">":Hf,"<":sd,">=":ad,"<=":qf,array:ar,at:Hc,boolean:ar,case:ul,coalesce:pl,collator:vo,format:ml,image:Xc,in:qc,"index-of":la,interpolate:fn,"interpolate-hcl":fn,"interpolate-lab":fn,length:Kc,let:us,literal:sr,match:Zc,number:ar,"number-format":Wc,object:ar,slice:yo,step:ca,string:ar,"to-boolean":or,"to-color":or,"to-number":or,"to-string":or,var:Rt,within:Ds,distance:Bs};class $n{constructor(i,s,l,p){this.name=i,this.type=s,this._evaluate=l,this.args=p}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,s){const l=i[0],p=$n.definitions[l];if(!p)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=_.filter(([C])=>!Array.isArray(C)||C.length===i.length-1);let S=null;for(const[C,P]of w){S=new Ms(s.registry,So,s.path,null,s.scope);const M=[];let R=!1;for(let j=1;j<i.length;j++){const U=i[j],$=Array.isArray(C)?C[j-1]:C.type,Y=S.parse(U,1+M.length,$);if(!Y){R=!0;break}M.push(Y)}if(!R)if(Array.isArray(C)&&C.length!==M.length)S.error(`Expected ${C.length} arguments, but found ${M.length} instead.`);else{for(let j=0;j<M.length;j++){const U=Array.isArray(C)?C[j]:C.type,$=M[j];S.concat(j+1).checkSubtype(U,$.type)}if(S.errors.length===0)return new $n(l,y,P,M)}}if(w.length===1)s.errors.push(...S.errors);else{const C=(w.length?w:_).map(([M])=>{return R=M,Array.isArray(R)?`(${R.map(F).join(", ")})`:`(${F(R.type)}...)`;var R}).join(" | "),P=[];for(let M=1;M<i.length;M++){const R=s.parse(i[M],1+P.length);if(!R)return null;P.push(F(R.type))}s.error(`Expected arguments of type ${C}, but found (${P.join(", ")}) instead.`)}return null}static register(i,s){$n.definitions=s;for(const l in s)i[l]=$n}}function au(r,[i,s,l,p]){i=i.evaluate(r),s=s.evaluate(r),l=l.evaluate(r);const y=p?p.evaluate(r):1,_=oa(i,s,l,y);if(_)throw new fi(_);return new Nt(i/255,s/255,l/255,y,!1)}function ou(r,i){return r in i}function lu(r,i){const s=i[r];return s===void 0?null:s}function Fs(r){return{type:r}}function So(r){if(r instanceof Rt)return So(r.boundExpression);if(r instanceof $n&&r.name==="error"||r instanceof vo||r instanceof Ds||r instanceof Bs)return!1;const i=r instanceof or||r instanceof ar;let s=!0;return r.eachChild(l=>{s=i?s&&So(l):s&&l instanceof sr}),!!s&&To(r)&&ko(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function To(r){if(r instanceof $n&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Ds||r instanceof Bs)return!1;let i=!0;return r.eachChild(s=>{i&&!To(s)&&(i=!1)}),i}function pa(r){if(r instanceof $n&&r.name==="feature-state")return!1;let i=!0;return r.eachChild(s=>{i&&!pa(s)&&(i=!1)}),i}function ko(r,i){if(r instanceof $n&&i.indexOf(r.name)>=0)return!1;let s=!0;return r.eachChild(l=>{s&&!ko(l,i)&&(s=!1)}),s}function wl(r){return{result:"success",value:r}}function fa(r){return{result:"error",value:r}}function ma(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function vd(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function cu(r){return!!r.expression&&r.expression.interpolated}function zt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function bl(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function nm(r){return r}function xd(r,i){const s=i.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",p=l||!(l||r.property!==void 0),y=r.type||(cu(i)?"exponential":"interval");if(s||i.type==="padding"){const P=s?Nt.parse:Pn.parse;(r=Sr({},r)).stops&&(r.stops=r.stops.map(M=>[M[0],P(M[1])])),r.default=P(r.default?r.default:i.default)}if(r.colorSpace&&(_=r.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var _;let w,S,C;if(y==="exponential")w=bd;else if(y==="interval")w=Sl;else if(y==="categorical"){w=wd,S=Object.create(null);for(const P of r.stops)S[P[0]]=P[1];C=typeof r.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);w=Sd}if(l){const P={},M=[];for(let U=0;U<r.stops.length;U++){const $=r.stops[U],Y=$[0].zoom;P[Y]===void 0&&(P[Y]={zoom:Y,type:r.type,property:r.property,default:r.default,stops:[]},M.push(Y)),P[Y].stops.push([$[0].value,$[1]])}const R=[];for(const U of M)R.push([P[U].zoom,xd(P[U],i)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:fn.interpolationFactor.bind(void 0,j),zoomStops:R.map(U=>U[0]),evaluate:({zoom:U},$)=>bd({stops:R,base:r.base},i,U).evaluate(U,$)}}if(p){const P=y==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:fn.interpolationFactor.bind(void 0,P),zoomStops:r.stops.map(M=>M[0]),evaluate:({zoom:M})=>w(r,i,M,S,C)}}return{kind:"source",evaluate(P,M){const R=M&&M.properties?M.properties[r.property]:void 0;return R===void 0?ga(r.default,i.default):w(r,i,R,S,C)}}}function ga(r,i,s){return r!==void 0?r:i!==void 0?i:s!==void 0?s:void 0}function wd(r,i,s,l,p){return ga(typeof s===p?l[s]:void 0,r.default,i.default)}function Sl(r,i,s){if(zt(s)!=="number")return ga(r.default,i.default);const l=r.stops.length;if(l===1||s<=r.stops[0][0])return r.stops[0][1];if(s>=r.stops[l-1][0])return r.stops[l-1][1];const p=hl(r.stops.map(y=>y[0]),s);return r.stops[p][1]}function bd(r,i,s){const l=r.base!==void 0?r.base:1;if(zt(s)!=="number")return ga(r.default,i.default);const p=r.stops.length;if(p===1||s<=r.stops[0][0])return r.stops[0][1];if(s>=r.stops[p-1][0])return r.stops[p-1][1];const y=hl(r.stops.map(P=>P[0]),s),_=function(P,M,R,j){const U=j-R,$=P-R;return U===0?0:M===1?$/U:(Math.pow(M,$)-1)/(Math.pow(M,U)-1)}(s,l,r.stops[y][0],r.stops[y+1][0]),w=r.stops[y][1],S=r.stops[y+1][1],C=pn[i.type]||nm;return typeof w.evaluate=="function"?{evaluate(...P){const M=w.evaluate.apply(void 0,P),R=S.evaluate.apply(void 0,P);if(M!==void 0&&R!==void 0)return C(M,R,_,r.colorSpace)}}:C(w,S,_,r.colorSpace)}function Sd(r,i,s){switch(i.type){case"color":s=Nt.parse(s);break;case"formatted":s=Cn.fromString(s.toString());break;case"resolvedImage":s=In.fromString(s.toString());break;case"padding":s=Pn.parse(s);break;default:zt(s)===i.type||i.type==="enum"&&i.values[s]||(s=void 0)}return ga(s,r.default,i.default)}$n.register(da,{error:[{kind:"error"},[wt],(r,[i])=>{throw new fi(i.evaluate(r))}],typeof:[wt,[_t],(r,[i])=>F(wi(i.evaluate(r)))],"to-rgba":[O(Ve,4),[dn],(r,[i])=>{const[s,l,p,y]=i.evaluate(r).rgb;return[255*s,255*l,255*p,y]}],rgb:[dn,[Ve,Ve,Ve],au],rgba:[dn,[Ve,Ve,Ve,Ve],au],has:{type:ft,overloads:[[[wt],(r,[i])=>ou(i.evaluate(r),r.properties())],[[wt,rr],(r,[i,s])=>ou(i.evaluate(r),s.evaluate(r))]]},get:{type:_t,overloads:[[[wt],(r,[i])=>lu(i.evaluate(r),r.properties())],[[wt,rr],(r,[i,s])=>lu(i.evaluate(r),s.evaluate(r))]]},"feature-state":[_t,[wt],(r,[i])=>lu(i.evaluate(r),r.featureState||{})],properties:[rr,[],r=>r.properties()],"geometry-type":[wt,[],r=>r.geometryType()],id:[_t,[],r=>r.id()],zoom:[Ve,[],r=>r.globals.zoom],"heatmap-density":[Ve,[],r=>r.globals.heatmapDensity||0],"line-progress":[Ve,[],r=>r.globals.lineProgress||0],accumulated:[_t,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Ve,Fs(Ve),(r,i)=>{let s=0;for(const l of i)s+=l.evaluate(r);return s}],"*":[Ve,Fs(Ve),(r,i)=>{let s=1;for(const l of i)s*=l.evaluate(r);return s}],"-":{type:Ve,overloads:[[[Ve,Ve],(r,[i,s])=>i.evaluate(r)-s.evaluate(r)],[[Ve],(r,[i])=>-i.evaluate(r)]]},"/":[Ve,[Ve,Ve],(r,[i,s])=>i.evaluate(r)/s.evaluate(r)],"%":[Ve,[Ve,Ve],(r,[i,s])=>i.evaluate(r)%s.evaluate(r)],ln2:[Ve,[],()=>Math.LN2],pi:[Ve,[],()=>Math.PI],e:[Ve,[],()=>Math.E],"^":[Ve,[Ve,Ve],(r,[i,s])=>Math.pow(i.evaluate(r),s.evaluate(r))],sqrt:[Ve,[Ve],(r,[i])=>Math.sqrt(i.evaluate(r))],log10:[Ve,[Ve],(r,[i])=>Math.log(i.evaluate(r))/Math.LN10],ln:[Ve,[Ve],(r,[i])=>Math.log(i.evaluate(r))],log2:[Ve,[Ve],(r,[i])=>Math.log(i.evaluate(r))/Math.LN2],sin:[Ve,[Ve],(r,[i])=>Math.sin(i.evaluate(r))],cos:[Ve,[Ve],(r,[i])=>Math.cos(i.evaluate(r))],tan:[Ve,[Ve],(r,[i])=>Math.tan(i.evaluate(r))],asin:[Ve,[Ve],(r,[i])=>Math.asin(i.evaluate(r))],acos:[Ve,[Ve],(r,[i])=>Math.acos(i.evaluate(r))],atan:[Ve,[Ve],(r,[i])=>Math.atan(i.evaluate(r))],min:[Ve,Fs(Ve),(r,i)=>Math.min(...i.map(s=>s.evaluate(r)))],max:[Ve,Fs(Ve),(r,i)=>Math.max(...i.map(s=>s.evaluate(r)))],abs:[Ve,[Ve],(r,[i])=>Math.abs(i.evaluate(r))],round:[Ve,[Ve],(r,[i])=>{const s=i.evaluate(r);return s<0?-Math.round(-s):Math.round(s)}],floor:[Ve,[Ve],(r,[i])=>Math.floor(i.evaluate(r))],ceil:[Ve,[Ve],(r,[i])=>Math.ceil(i.evaluate(r))],"filter-==":[ft,[wt,_t],(r,[i,s])=>r.properties()[i.value]===s.value],"filter-id-==":[ft,[_t],(r,[i])=>r.id()===i.value],"filter-type-==":[ft,[wt],(r,[i])=>r.geometryType()===i.value],"filter-<":[ft,[wt,_t],(r,[i,s])=>{const l=r.properties()[i.value],p=s.value;return typeof l==typeof p&&l<p}],"filter-id-<":[ft,[_t],(r,[i])=>{const s=r.id(),l=i.value;return typeof s==typeof l&&s<l}],"filter->":[ft,[wt,_t],(r,[i,s])=>{const l=r.properties()[i.value],p=s.value;return typeof l==typeof p&&l>p}],"filter-id->":[ft,[_t],(r,[i])=>{const s=r.id(),l=i.value;return typeof s==typeof l&&s>l}],"filter-<=":[ft,[wt,_t],(r,[i,s])=>{const l=r.properties()[i.value],p=s.value;return typeof l==typeof p&&l<=p}],"filter-id-<=":[ft,[_t],(r,[i])=>{const s=r.id(),l=i.value;return typeof s==typeof l&&s<=l}],"filter->=":[ft,[wt,_t],(r,[i,s])=>{const l=r.properties()[i.value],p=s.value;return typeof l==typeof p&&l>=p}],"filter-id->=":[ft,[_t],(r,[i])=>{const s=r.id(),l=i.value;return typeof s==typeof l&&s>=l}],"filter-has":[ft,[_t],(r,[i])=>i.value in r.properties()],"filter-has-id":[ft,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[ft,[O(wt)],(r,[i])=>i.value.indexOf(r.geometryType())>=0],"filter-id-in":[ft,[O(_t)],(r,[i])=>i.value.indexOf(r.id())>=0],"filter-in-small":[ft,[wt,O(_t)],(r,[i,s])=>s.value.indexOf(r.properties()[i.value])>=0],"filter-in-large":[ft,[wt,O(_t)],(r,[i,s])=>function(l,p,y,_){for(;y<=_;){const w=y+_>>1;if(p[w]===l)return!0;p[w]>l?_=w-1:y=w+1}return!1}(r.properties()[i.value],s.value,0,s.value.length-1)],all:{type:ft,overloads:[[[ft,ft],(r,[i,s])=>i.evaluate(r)&&s.evaluate(r)],[Fs(ft),(r,i)=>{for(const s of i)if(!s.evaluate(r))return!1;return!0}]]},any:{type:ft,overloads:[[[ft,ft],(r,[i,s])=>i.evaluate(r)||s.evaluate(r)],[Fs(ft),(r,i)=>{for(const s of i)if(s.evaluate(r))return!0;return!1}]]},"!":[ft,[ft],(r,[i])=>!i.evaluate(r)],"is-supported-script":[ft,[wt],(r,[i])=>{const s=r.globals&&r.globals.isSupportedScript;return!s||s(i.evaluate(r))}],upcase:[wt,[wt],(r,[i])=>i.evaluate(r).toUpperCase()],downcase:[wt,[wt],(r,[i])=>i.evaluate(r).toLowerCase()],concat:[wt,Fs(_t),(r,i)=>i.map(s=>go(s.evaluate(r))).join("")],"resolved-locale":[wt,[kr],(r,[i])=>i.evaluate(r).resolvedLocale()]});class Tl{constructor(i,s){var l;this.expression=i,this._warningHistory={},this._evaluator=new cl,this._defaultValue=s?(l=s).type==="color"&&bl(l.default)?new Nt(0,0,0,0):l.type==="color"?Nt.parse(l.default)||null:l.type==="padding"?Pn.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Un.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(i,s,l,p,y,_){return this._evaluator.globals=i,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(i,s,l,p,y,_){this._evaluator.globals=i,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new fi(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function kl(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in da}function ya(r,i){const s=new Ms(da,So,[],i?function(p){const y={color:dn,string:wt,number:Ve,enum:wt,boolean:ft,formatted:Gr,padding:cs,resolvedImage:Cr,variableAnchorOffsetCollection:ee};return p.type==="array"?O(y[p.value]||_t,p.length):y[p.type]}(i):void 0),l=s.parse(r,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?wl(new Tl(l,i)):fa(s.errors)}class _a{constructor(i,s){this.kind=i,this._styleExpression=s,this.isStateDependent=i!=="constant"&&!pa(s.expression)}evaluateWithoutErrorHandling(i,s,l,p,y,_){return this._styleExpression.evaluateWithoutErrorHandling(i,s,l,p,y,_)}evaluate(i,s,l,p,y,_){return this._styleExpression.evaluate(i,s,l,p,y,_)}}class va{constructor(i,s,l,p){this.kind=i,this.zoomStops=l,this._styleExpression=s,this.isStateDependent=i!=="camera"&&!pa(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(i,s,l,p,y,_){return this._styleExpression.evaluateWithoutErrorHandling(i,s,l,p,y,_)}evaluate(i,s,l,p,y,_){return this._styleExpression.evaluate(i,s,l,p,y,_)}interpolationFactor(i,s,l){return this.interpolationType?fn.interpolationFactor(this.interpolationType,i,s,l):0}}function uu(r,i){const s=ya(r,i);if(s.result==="error")return s;const l=s.value.expression,p=To(l);if(!p&&!ma(i))return fa([new Ji("","data expressions not supported")]);const y=ko(l,["zoom"]);if(!y&&!vd(i))return fa([new Ji("","zoom expressions not supported")]);const _=Co(l);return _||y?_ instanceof Ji?fa([_]):_ instanceof fn&&!cu(i)?fa([new Ji("",'"interpolate" expressions cannot be used with this property')]):wl(_?new va(p?"camera":"composite",s.value,_.labels,_ instanceof fn?_.interpolation:void 0):new _a(p?"constant":"source",s.value)):fa([new Ji("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class xa{constructor(i,s){this._parameters=i,this._specification=s,Sr(this,xd(this._parameters,this._specification))}static deserialize(i){return new xa(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Co(r){let i=null;if(r instanceof us)i=Co(r.result);else if(r instanceof pl){for(const s of r.args)if(i=Co(s),i)break}else(r instanceof ca||r instanceof fn)&&r.input instanceof $n&&r.input.name==="zoom"&&(i=r);return i instanceof Ji||r.eachChild(s=>{const l=Co(s);l instanceof Ji?i=l:!i&&l?i=new Ji("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&l&&i!==l&&(i=new Ji("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Cl(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const i of r.slice(1))if(!Cl(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const Pl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hu(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Cl(r)||(r=Il(r));const i=ya(r,Pl);if(i.result==="error")throw new Error(i.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,l,p)=>i.value.evaluate(s,l,{},p),needGeometry:Td(r)}}function rm(r,i){return r<i?-1:r>i?1:0}function Td(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let i=1;i<r.length;i++)if(Td(r[i]))return!0;return!1}function Il(r){if(!r)return!0;const i=r[0];return r.length<=1?i!=="any":i==="=="?du(r[1],r[2],"=="):i==="!="?Ui(du(r[1],r[2],"==")):i==="<"||i===">"||i==="<="||i===">="?du(r[1],r[2],i):i==="any"?(s=r.slice(1),["any"].concat(s.map(Il))):i==="all"?["all"].concat(r.slice(1).map(Il)):i==="none"?["all"].concat(r.slice(1).map(Il).map(Ui)):i==="in"?Po(r[1],r.slice(2)):i==="!in"?Ui(Po(r[1],r.slice(2))):i==="has"?Io(r[1]):i!=="!has"||Ui(Io(r[1]));var s}function du(r,i,s){switch(r){case"$type":return[`filter-type-${s}`,i];case"$id":return[`filter-id-${s}`,i];default:return[`filter-${s}`,r,i]}}function Po(r,i){if(i.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(s=>typeof s!=typeof i[0])?["filter-in-large",r,["literal",i.sort(rm)]]:["filter-in-small",r,["literal",i]]}}function Io(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Ui(r){return["!",r]}function Os(r){const i=typeof r;if(i==="number"||i==="boolean"||i==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let p="[";for(const y of r)p+=`${Os(y)},`;return`${p}]`}const s=Object.keys(r).sort();let l="{";for(let p=0;p<s.length;p++)l+=`${JSON.stringify(s[p])}:${Os(r[s[p]])},`;return`${l}}`}function kd(r){let i="";for(const s of Is)i+=`/${Os(r[s])}`;return i}function Cd(r){const i=r.value;return i?[new Re(r.key,i,"constants have been deprecated as of v8")]:[]}function ui(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function lr(r){if(Array.isArray(r))return r.map(lr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const i={};for(const s in r)i[s]=lr(r[s]);return i}return ui(r)}function An(r){const i=r.key,s=r.value,l=r.valueSpec||{},p=r.objectElementValidators||{},y=r.style,_=r.styleSpec,w=r.validateSpec;let S=[];const C=zt(s);if(C!=="object")return[new Re(i,s,`object expected, ${C} found`)];for(const P in s){const M=P.split(".")[0],R=l[M]||l["*"];let j;if(p[M])j=p[M];else if(l[M])j=w;else if(p["*"])j=p["*"];else{if(!l["*"]){S.push(new Re(i,s[P],`unknown property "${P}"`));continue}j=w}S=S.concat(j({key:(i&&`${i}.`)+P,value:s[P],valueSpec:R,style:y,styleSpec:_,object:s,objectKey:P,validateSpec:w},s))}for(const P in l)p[P]||l[P].required&&l[P].default===void 0&&s[P]===void 0&&S.push(new Re(i,s,`missing required property "${P}"`));return S}function Ao(r){const i=r.value,s=r.valueSpec,l=r.style,p=r.styleSpec,y=r.key,_=r.arrayElementValidator||r.validateSpec;if(zt(i)!=="array")return[new Re(y,i,`array expected, ${zt(i)} found`)];if(s.length&&i.length!==s.length)return[new Re(y,i,`array length ${s.length} expected, length ${i.length} found`)];if(s["min-length"]&&i.length<s["min-length"])return[new Re(y,i,`array length at least ${s["min-length"]} expected, length ${i.length} found`)];let w={type:s.value,values:s.values};p.$version<7&&(w.function=s.function),zt(s.value)==="object"&&(w=s.value);let S=[];for(let C=0;C<i.length;C++)S=S.concat(_({array:i,arrayIndex:C,value:i[C],valueSpec:w,validateSpec:r.validateSpec,style:l,styleSpec:p,key:`${y}[${C}]`}));return S}function pu(r){const i=r.key,s=r.value,l=r.valueSpec;let p=zt(s);return p==="number"&&s!=s&&(p="NaN"),p!=="number"?[new Re(i,s,`number expected, ${p} found`)]:"minimum"in l&&s<l.minimum?[new Re(i,s,`${s} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&s>l.maximum?[new Re(i,s,`${s} is greater than the maximum value ${l.maximum}`)]:[]}function Al(r){const i=r.valueSpec,s=ui(r.value.type);let l,p,y,_={};const w=s!=="categorical"&&r.value.property===void 0,S=!w,C=zt(r.value.stops)==="array"&&zt(r.value.stops[0])==="array"&&zt(r.value.stops[0][0])==="object",P=An({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(j){if(s==="identity")return[new Re(j.key,j.value,'identity function may not have a "stops" property')];let U=[];const $=j.value;return U=U.concat(Ao({key:j.key,value:$,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:M})),zt($)==="array"&&$.length===0&&U.push(new Re(j.key,$,"array must have at least one stop")),U},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:i,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return s==="identity"&&w&&P.push(new Re(r.key,r.value,'missing required property "property"')),s==="identity"||r.value.stops||P.push(new Re(r.key,r.value,'missing required property "stops"')),s==="exponential"&&r.valueSpec.expression&&!cu(r.valueSpec)&&P.push(new Re(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(S&&!ma(r.valueSpec)?P.push(new Re(r.key,r.value,"property functions not supported")):w&&!vd(r.valueSpec)&&P.push(new Re(r.key,r.value,"zoom functions not supported"))),s!=="categorical"&&!C||r.value.property!==void 0||P.push(new Re(r.key,r.value,'"property" property is required')),P;function M(j){let U=[];const $=j.value,Y=j.key;if(zt($)!=="array")return[new Re(Y,$,`array expected, ${zt($)} found`)];if($.length!==2)return[new Re(Y,$,`array length 2 expected, length ${$.length} found`)];if(C){if(zt($[0])!=="object")return[new Re(Y,$,`object expected, ${zt($[0])} found`)];if($[0].zoom===void 0)return[new Re(Y,$,"object stop key must have zoom")];if($[0].value===void 0)return[new Re(Y,$,"object stop key must have value")];if(y&&y>ui($[0].zoom))return[new Re(Y,$[0].zoom,"stop zoom values must appear in ascending order")];ui($[0].zoom)!==y&&(y=ui($[0].zoom),p=void 0,_={}),U=U.concat(An({key:`${Y}[0]`,value:$[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:pu,value:R}}))}else U=U.concat(R({key:`${Y}[0]`,value:$[0],validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},$));return kl(lr($[1]))?U.concat([new Re(`${Y}[1]`,$[1],"expressions are not allowed in function stops.")]):U.concat(j.validateSpec({key:`${Y}[1]`,value:$[1],valueSpec:i,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function R(j,U){const $=zt(j.value),Y=ui(j.value),te=j.value!==null?j.value:U;if(l){if($!==l)return[new Re(j.key,te,`${$} stop domain type must match previous stop domain type ${l}`)]}else l=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new Re(j.key,te,"stop domain value must be a number, string, or boolean")];if($!=="number"&&s!=="categorical"){let me=`number expected, ${$} found`;return ma(i)&&s===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Re(j.key,te,me)]}return s!=="categorical"||$!=="number"||isFinite(Y)&&Math.floor(Y)===Y?s!=="categorical"&&$==="number"&&p!==void 0&&Y<p?[new Re(j.key,te,"stop domain values must appear in ascending order")]:(p=Y,s==="categorical"&&Y in _?[new Re(j.key,te,"stop domain values must be unique")]:(_[Y]=!0,[])):[new Re(j.key,te,`integer expected, found ${Y}`)]}}function wa(r){const i=(r.expressionContext==="property"?uu:ya)(lr(r.value),r.valueSpec);if(i.result==="error")return i.value.map(l=>new Re(`${r.key}${l.key}`,r.value,l.message));const s=i.value.expression||i.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!s.outputDefined())return[new Re(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!pa(s))return[new Re(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!pa(s))return[new Re(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!ko(s,["zoom","feature-state"]))return[new Re(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!To(s))return[new Re(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qr(r){const i=r.key,s=r.value,l=r.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(ui(s))===-1&&p.push(new Re(i,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(l.values).indexOf(ui(s))===-1&&p.push(new Re(i,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function fu(r){return Cl(lr(r.value))?wa(Sr({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ml(r)}function Ml(r){const i=r.value,s=r.key;if(zt(i)!=="array")return[new Re(s,i,`array expected, ${zt(i)} found`)];const l=r.styleSpec;let p,y=[];if(i.length<1)return[new Re(s,i,"filter array must have at least 1 element")];switch(y=y.concat(qr({key:`${s}[0]`,value:i[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),ui(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&ui(i[1])==="$type"&&y.push(new Re(s,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&y.push(new Re(s,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(p=zt(i[1]),p!=="string"&&y.push(new Re(`${s}[1]`,i[1],`string expected, ${p} found`)));for(let _=2;_<i.length;_++)p=zt(i[_]),ui(i[1])==="$type"?y=y.concat(qr({key:`${s}[${_}]`,value:i[_],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new Re(`${s}[${_}]`,i[_],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let _=1;_<i.length;_++)y=y.concat(Ml({key:`${s}[${_}]`,value:i[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":p=zt(i[1]),i.length!==2?y.push(new Re(s,i,`filter array for "${i[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new Re(`${s}[1]`,i[1],`string expected, ${p} found`))}return y}function mu(r,i){const s=r.key,l=r.validateSpec,p=r.style,y=r.styleSpec,_=r.value,w=r.objectKey,S=y[`${i}_${r.layerType}`];if(!S)return[];const C=w.match(/^(.*)-transition$/);if(i==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return l({key:s,value:_,valueSpec:y.transition,style:p,styleSpec:y});const P=r.valueSpec||S[w];if(!P)return[new Re(s,_,`unknown property "${w}"`)];let M;if(zt(_)==="string"&&ma(P)&&!P.tokens&&(M=/^{([^}]+)}$/.exec(_)))return[new Re(s,_,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const R=[];return r.layerType==="symbol"&&(w==="text-field"&&p&&!p.glyphs&&R.push(new Re(s,_,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&bl(lr(_))&&ui(_.type)==="identity"&&R.push(new Re(s,_,'"text-font" does not support identity functions'))),R.concat(l({key:r.key,value:_,valueSpec:P,style:p,styleSpec:y,expressionContext:"property",propertyType:i,propertyKey:w}))}function El(r){return mu(r,"paint")}function gu(r){return mu(r,"layout")}function yu(r){let i=[];const s=r.value,l=r.key,p=r.style,y=r.styleSpec;s.type||s.ref||i.push(new Re(l,s,'either "type" or "ref" is required'));let _=ui(s.type);const w=ui(s.ref);if(s.id){const S=ui(s.id);for(let C=0;C<r.arrayIndex;C++){const P=p.layers[C];ui(P.id)===S&&i.push(new Re(l,s.id,`duplicate layer id "${s.id}", previously used at line ${P.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in s&&i.push(new Re(l,s[C],`"${C}" is prohibited for ref layers`))}),p.layers.forEach(C=>{ui(C.id)===w&&(S=C)}),S?S.ref?i.push(new Re(l,s.ref,"ref cannot reference another ref layer")):_=ui(S.type):i.push(new Re(l,s.ref,`ref layer "${w}" not found`))}else if(_!=="background")if(s.source){const S=p.sources&&p.sources[s.source],C=S&&ui(S.type);S?C==="vector"&&_==="raster"?i.push(new Re(l,s.source,`layer "${s.id}" requires a raster source`)):C!=="raster-dem"&&_==="hillshade"?i.push(new Re(l,s.source,`layer "${s.id}" requires a raster-dem source`)):C==="raster"&&_!=="raster"?i.push(new Re(l,s.source,`layer "${s.id}" requires a vector source`)):C!=="vector"||s["source-layer"]?C==="raster-dem"&&_!=="hillshade"?i.push(new Re(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!s.paint||!s.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||i.push(new Re(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new Re(l,s,`layer "${s.id}" must specify a "source-layer"`)):i.push(new Re(l,s.source,`source "${s.source}" not found`))}else i.push(new Re(l,s,'missing required property "source"'));return i=i.concat(An({key:l,value:s,valueSpec:y.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${l}.type`,value:s.type,valueSpec:y.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:s,objectKey:"type"}),filter:fu,layout:S=>An({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>gu(Sr({layerType:_},C))}}),paint:S=>An({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>El(Sr({layerType:_},C))}})}})),i}function js(r){const i=r.value,s=r.key,l=zt(i);return l!=="string"?[new Re(s,i,`string expected, ${l} found`)]:[]}const zl={promoteId:function({key:r,value:i}){if(zt(i)==="string")return js({key:r,value:i});{const s=[];for(const l in i)s.push(...js({key:`${r}.${l}`,value:i[l]}));return s}}};function Mo(r){const i=r.value,s=r.key,l=r.styleSpec,p=r.style,y=r.validateSpec;if(!i.type)return[new Re(s,i,'"type" is required')];const _=ui(i.type);let w;switch(_){case"vector":case"raster":return w=An({key:s,value:i,valueSpec:l[`source_${_.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:zl,validateSpec:y}),w;case"raster-dem":return w=function(S){var C;const P=(C=S.sourceName)!==null&&C!==void 0?C:"",M=S.value,R=S.styleSpec,j=R.source_raster_dem,U=S.style;let $=[];const Y=zt(M);if(M===void 0)return $;if(Y!=="object")return $.push(new Re("source_raster_dem",M,`object expected, ${Y} found`)),$;const te=ui(M.encoding)==="custom",me=["redFactor","greenFactor","blueFactor","baseShift"],oe=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const pe in M)!te&&me.includes(pe)?$.push(new Re(pe,M[pe],`In "${P}": "${pe}" is only valid when "encoding" is set to "custom". ${oe} encoding found`)):j[pe]?$=$.concat(S.validateSpec({key:pe,value:M[pe],valueSpec:j[pe],validateSpec:S.validateSpec,style:U,styleSpec:R})):$.push(new Re(pe,M[pe],`unknown property "${pe}"`));return $}({sourceName:s,value:i,style:r.style,styleSpec:l,validateSpec:y}),w;case"geojson":if(w=An({key:s,value:i,valueSpec:l.source_geojson,style:p,styleSpec:l,validateSpec:y,objectElementValidators:zl}),i.cluster)for(const S in i.clusterProperties){const[C,P]=i.clusterProperties[S],M=typeof C=="string"?[C,["accumulated"],["get",S]]:C;w.push(...wa({key:`${s}.${S}.map`,value:P,expressionContext:"cluster-map"})),w.push(...wa({key:`${s}.${S}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return w;case"video":return An({key:s,value:i,valueSpec:l.source_video,style:p,validateSpec:y,styleSpec:l});case"image":return An({key:s,value:i,valueSpec:l.source_image,style:p,validateSpec:y,styleSpec:l});case"canvas":return[new Re(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qr({key:`${s}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function _u(r){const i=r.value,s=r.styleSpec,l=s.light,p=r.style;let y=[];const _=zt(i);if(i===void 0)return y;if(_!=="object")return y=y.concat([new Re("light",i,`object expected, ${_} found`)]),y;for(const w in i){const S=w.match(/^(.*)-transition$/);y=y.concat(S&&l[S[1]]&&l[S[1]].transition?r.validateSpec({key:w,value:i[w],valueSpec:s.transition,validateSpec:r.validateSpec,style:p,styleSpec:s}):l[w]?r.validateSpec({key:w,value:i[w],valueSpec:l[w],validateSpec:r.validateSpec,style:p,styleSpec:s}):[new Re(w,i[w],`unknown property "${w}"`)])}return y}function vu(r){const i=r.value,s=r.styleSpec,l=s.sky,p=r.style,y=zt(i);if(i===void 0)return[];if(y!=="object")return[new Re("sky",i,`object expected, ${y} found`)];let _=[];for(const w in i)_=_.concat(l[w]?r.validateSpec({key:w,value:i[w],valueSpec:l[w],style:p,styleSpec:s}):[new Re(w,i[w],`unknown property "${w}"`)]);return _}function xu(r){const i=r.value,s=r.styleSpec,l=s.terrain,p=r.style;let y=[];const _=zt(i);if(i===void 0)return y;if(_!=="object")return y=y.concat([new Re("terrain",i,`object expected, ${_} found`)]),y;for(const w in i)y=y.concat(l[w]?r.validateSpec({key:w,value:i[w],valueSpec:l[w],validateSpec:r.validateSpec,style:p,styleSpec:s}):[new Re(w,i[w],`unknown property "${w}"`)]);return y}function wu(r){let i=[];const s=r.value,l=r.key;if(Array.isArray(s)){const p=[],y=[];for(const _ in s)s[_].id&&p.includes(s[_].id)&&i.push(new Re(l,s,`all the sprites' ids must be unique, but ${s[_].id} is duplicated`)),p.push(s[_].id),s[_].url&&y.includes(s[_].url)&&i.push(new Re(l,s,`all the sprites' URLs must be unique, but ${s[_].url} is duplicated`)),y.push(s[_].url),i=i.concat(An({key:`${l}[${_}]`,value:s[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return i}return js({key:l,value:s})}const Dl={"*":()=>[],array:Ao,boolean:function(r){const i=r.value,s=r.key,l=zt(i);return l!=="boolean"?[new Re(s,i,`boolean expected, ${l} found`)]:[]},number:pu,color:function(r){const i=r.key,s=r.value,l=zt(s);return l!=="string"?[new Re(i,s,`color expected, ${l} found`)]:Nt.parse(String(s))?[]:[new Re(i,s,`color expected, "${s}" found`)]},constants:Cd,enum:qr,filter:fu,function:Al,layer:yu,object:An,source:Mo,light:_u,sky:vu,terrain:xu,projection:function(r){const i=r.value,s=r.styleSpec,l=s.projection,p=r.style,y=zt(i);if(i===void 0)return[];if(y!=="object")return[new Re("projection",i,`object expected, ${y} found`)];let _=[];for(const w in i)_=_.concat(l[w]?r.validateSpec({key:w,value:i[w],valueSpec:l[w],style:p,styleSpec:s}):[new Re(w,i[w],`unknown property "${w}"`)]);return _},string:js,formatted:function(r){return js(r).length===0?[]:wa(r)},resolvedImage:function(r){return js(r).length===0?[]:wa(r)},padding:function(r){const i=r.key,s=r.value;if(zt(s)==="array"){if(s.length<1||s.length>4)return[new Re(i,s,`padding requires 1 to 4 values; ${s.length} values found`)];const l={type:"number"};let p=[];for(let y=0;y<s.length;y++)p=p.concat(r.validateSpec({key:`${i}[${y}]`,value:s[y],validateSpec:r.validateSpec,valueSpec:l}));return p}return pu({key:i,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const i=r.key,s=r.value,l=zt(s),p=r.styleSpec;if(l!=="array"||s.length<1||s.length%2!=0)return[new Re(i,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let _=0;_<s.length;_+=2)y=y.concat(qr({key:`${i}[${_}]`,value:s[_],valueSpec:p.layout_symbol["text-anchor"]})),y=y.concat(Ao({key:`${i}[${_+1}]`,value:s[_+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:p}));return y},sprite:wu};function Eo(r){const i=r.value,s=r.valueSpec,l=r.styleSpec;return r.validateSpec=Eo,s.expression&&bl(ui(i))?Al(r):s.expression&&kl(lr(i))?wa(r):s.type&&Dl[s.type]?Dl[s.type](r):An(Sr({},r,{valueSpec:s.type?l[s.type]:s}))}function Pd(r){const i=r.value,s=r.key,l=js(r);return l.length||(i.indexOf("{fontstack}")===-1&&l.push(new Re(s,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&l.push(new Re(s,i,'"glyphs" url must include a "{range}" token'))),l}function Gn(r,i=we){let s=[];return s=s.concat(Eo({key:"",value:r,valueSpec:i.$root,styleSpec:i,style:r,validateSpec:Eo,objectElementValidators:{glyphs:Pd,"*":()=>[]}})),r.constants&&(s=s.concat(Cd({key:"constants",value:r.constants}))),bu(s)}function Ir(r){return function(i){return r({...i,validateSpec:Eo})}}function bu(r){return[].concat(r).sort((i,s)=>i.line-s.line)}function cr(r){return function(...i){return bu(r.apply(this,i))}}Gn.source=cr(Ir(Mo)),Gn.sprite=cr(Ir(wu)),Gn.glyphs=cr(Ir(Pd)),Gn.light=cr(Ir(_u)),Gn.sky=cr(Ir(vu)),Gn.terrain=cr(Ir(xu)),Gn.layer=cr(Ir(yu)),Gn.filter=cr(Ir(fu)),Gn.paintProperty=cr(Ir(El)),Gn.layoutProperty=cr(Ir(gu));const Vs=Gn,sm=Vs.light,am=Vs.sky,Id=Vs.paintProperty,Ad=Vs.layoutProperty;function Su(r,i){let s=!1;if(i&&i.length)for(const l of i)r.fire(new as(new Error(l.message))),s=!0;return s}class ba{constructor(i,s,l){const p=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const _=new Int32Array(this.arrayBuffer);i=_[0],this.d=(s=_[1])+2*(l=_[2]);for(let S=0;S<this.d*this.d;S++){const C=_[3+S],P=_[3+S+1];p.push(C===P?null:_.subarray(C,P))}const w=_[3+p.length+1];this.keys=_.subarray(_[3+p.length],w),this.bboxes=_.subarray(w),this.insert=this._insertReadonly}else{this.d=s+2*l;for(let _=0;_<this.d*this.d;_++)p.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=i,this.padding=l,this.scale=s/i,this.uid=0;const y=l/s*i;this.min=-y,this.max=i+y}insert(i,s,l,p,y){this._forEachCell(s,l,p,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,s,l,p,y,_){this.cells[y].push(_)}query(i,s,l,p,y){const _=this.min,w=this.max;if(i<=_&&s<=_&&w<=l&&w<=p&&!y)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(i,s,l,p,this._queryCell,S,{},y),S}}_queryCell(i,s,l,p,y,_,w,S){const C=this.cells[y];if(C!==null){const P=this.keys,M=this.bboxes;for(let R=0;R<C.length;R++){const j=C[R];if(w[j]===void 0){const U=4*j;(S?S(M[U+0],M[U+1],M[U+2],M[U+3]):i<=M[U+2]&&s<=M[U+3]&&l>=M[U+0]&&p>=M[U+1])?(w[j]=!0,_.push(P[j])):w[j]=!1}}}}_forEachCell(i,s,l,p,y,_,w,S){const C=this._convertToCellCoord(i),P=this._convertToCellCoord(s),M=this._convertToCellCoord(l),R=this._convertToCellCoord(p);for(let j=C;j<=M;j++)for(let U=P;U<=R;U++){const $=this.d*U+j;if((!S||S(this._convertFromCellCoord(j),this._convertFromCellCoord(U),this._convertFromCellCoord(j+1),this._convertFromCellCoord(U+1)))&&y.call(this,i,s,l,p,$,_,w,S))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,s=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const p=new Int32Array(s+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let y=s;for(let _=0;_<i.length;_++){const w=i[_];p[3+_]=y,p.set(w,y),y+=w.length}return p[3+i.length]=y,p.set(this.keys,y),y+=this.keys.length,p[3+i.length+1]=y,p.set(this.bboxes,y),y+=this.bboxes.length,p.buffer}static serialize(i,s){const l=i.toArrayBuffer();return s&&s.push(l),{buffer:l}}static deserialize(i){return new ba(i.buffer)}}const Hn={};function Ke(r,i,s={}){if(Hn[r])throw new Error(`${r} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:r,writeable:!1}),Hn[r]={klass:i,omit:s.omit||[],shallow:s.shallow||[]}}Ke("Object",Object),Ke("TransferableGridIndex",ba),Ke("Color",Nt),Ke("Error",Error),Ke("AJAXError",Pi),Ke("ResolvedImage",In),Ke("StylePropertyFunction",xa),Ke("StyleExpression",Tl,{omit:["_evaluator"]}),Ke("ZoomDependentExpression",va),Ke("ZoomConstantExpression",_a),Ke("CompoundExpression",$n,{omit:["_evaluate"]});for(const r in da)da[r]._classRegistryKey||Ke(`Expression_${r}`,da[r]);function Ll(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Tu(r){return r.$name||r.constructor._classRegistryKey}function Md(r){return!function(i){if(i===null||typeof i!="object")return!1;const s=Tu(i);return!(!s||s==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Ll(r)||Bt(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function Sa(r,i){if(Md(r))return(Ll(r)||Bt(r))&&i&&i.push(r),ArrayBuffer.isView(r)&&i&&i.push(r.buffer),r instanceof ImageData&&i&&i.push(r.data.buffer),r;if(Array.isArray(r)){const y=[];for(const _ of r)y.push(Sa(_,i));return y}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const s=Tu(r);if(!s)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Hn[s])throw new Error(`${s} is not registered.`);const{klass:l}=Hn[s],p=l.serialize?l.serialize(r,i):{};if(l.serialize){if(i&&p===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in r){if(!r.hasOwnProperty(y)||Hn[s].omit.indexOf(y)>=0)continue;const _=r[y];p[y]=Hn[s].shallow.indexOf(y)>=0?_:Sa(_,i)}r instanceof Error&&(p.message=r.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(p.$name=s),p}function Ta(r){if(Md(r))return r;if(Array.isArray(r))return r.map(Ta);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const i=Tu(r)||"Object";if(!Hn[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:s}=Hn[i];if(!s)throw new Error(`can't deserialize unregistered class ${i}`);if(s.deserialize)return s.deserialize(r);const l=Object.create(s.prototype);for(const p of Object.keys(r)){if(p==="$name")continue;const y=r[p];l[p]=Hn[i].shallow.indexOf(p)>=0?y:Ta(y)}return l}class ku{constructor(){this.first=!0}update(i,s){const l=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=s),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=l,!0))}}const Pt={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Cu(r){for(const i of r)if(Iu(i.charCodeAt(0)))return!0;return!1}function om(r){for(const i of r)if(!ka(i.charCodeAt(0)))return!1;return!0}function Pu(r){const i=r.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(i.join("|"),"u")}const lm=Pu(["Arab","Dupl","Mong","Ougr","Syrc"]);function ka(r){return!lm.test(String.fromCodePoint(r))}const Ed=Pu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Iu(r){return!(r!==746&&r!==747&&(r<4352||!(Pt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Pt["CJK Compatibility"](r)||Pt["CJK Strokes"](r)||!(!Pt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Pt["Enclosed CJK Letters and Months"](r)||Pt["Ideographic Description Characters"](r)||Pt.Kanbun(r)||Pt.Katakana(r)&&r!==12540||!(!Pt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Pt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Pt["Vertical Forms"](r)||Pt["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||Ed.test(String.fromCodePoint(r)))))}function zd(r){return!(Iu(r)||function(i){return!!(Pt["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Pt["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Pt["Letterlike Symbols"](i)||Pt["Number Forms"](i)||Pt["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Pt["Control Pictures"](i)&&i!==9251||Pt["Optical Character Recognition"](i)||Pt["Enclosed Alphanumerics"](i)||Pt["Geometric Shapes"](i)||Pt["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Pt["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Pt["CJK Symbols and Punctuation"](i)||Pt.Katakana(i)||Pt["Private Use Area"](i)||Pt["CJK Compatibility Forms"](i)||Pt["Small Form Variants"](i)||Pt["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(r))}const cm=Pu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Au(r){return cm.test(String.fromCodePoint(r))}function um(r,i){return!(!i&&Au(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Pt.Khmer(r))}function hm(r){for(const i of r)if(Au(i.charCodeAt(0)))return!0;return!1}const Mn=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Kt{constructor(i,s){this.zoom=i,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ku,this.transition={})}isSupportedScript(i){return function(s,l){for(const p of s)if(!um(p.charCodeAt(0),l))return!1;return!0}(i,Mn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,s=i-Math.floor(i),l=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*s}}}class Ca{constructor(i,s){this.property=i,this.value=s,this.expression=function(l,p){if(bl(l))return new xa(l,p);if(kl(l)){const y=uu(l,p);if(y.result==="error")throw new Error(y.value.map(_=>`${_.key}: ${_.message}`).join(", "));return y.value}{let y=l;return p.type==="color"&&typeof l=="string"?y=Nt.parse(l):p.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(y=Un.parse(l)):y=Pn.parse(l),{kind:"constant",evaluate:()=>y}}}(s===void 0?i.specification.default:s,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,s,l){return this.property.possiblyEvaluate(this,i,s,l)}}class Rl{constructor(i){this.property=i,this.value=new Ca(i,void 0)}transitioned(i,s){return new Dd(this.property,this.value,s,Ae({},i.transition,this.transition),i.now)}untransitioned(){return new Dd(this.property,this.value,null,{},0)}}class Bl{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return pt(this._values[i].value.value)}setValue(i,s){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Rl(this._values[i].property)),this._values[i].value=new Ca(this._values[i].property,s===null?void 0:pt(s))}getTransition(i){return pt(this._values[i].transition)}setTransition(i,s){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Rl(this._values[i].property)),this._values[i].transition=pt(s)||void 0}serialize(){const i={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(i[s]=l);const p=this.getTransition(s);p!==void 0&&(i[`${s}-transition`]=p)}return i}transitioned(i,s){const l=new zo(this._properties);for(const p of Object.keys(this._values))l._values[p]=this._values[p].transitioned(i,s._values[p]);return l}untransitioned(){const i=new zo(this._properties);for(const s of Object.keys(this._values))i._values[s]=this._values[s].untransitioned();return i}}class Dd{constructor(i,s,l,p,y){this.property=i,this.value=s,this.begin=y+p.delay||0,this.end=this.begin+p.duration||0,i.specification.transition&&(p.delay||p.duration)&&(this.prior=l)}possiblyEvaluate(i,s,l){const p=i.now||0,y=this.value.possiblyEvaluate(i,s,l),_=this.prior;if(_){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return _.possiblyEvaluate(i,s,l);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(i,s,l),y,function(S){if(S<=0)return 0;if(S>=1)return 1;const C=S*S,P=C*S;return 4*(S<.5?P:3*(S-C)+P-.75)}(w))}}return y}}class zo{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,s,l){const p=new Lo(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(i,s,l);return p}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Do{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}hasValue(i){return this._values[i].value!==void 0}getValue(i){return pt(this._values[i].value)}setValue(i,s){this._values[i]=new Ca(this._values[i].property,s===null?void 0:pt(s))}serialize(){const i={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(i[s]=l)}return i}possiblyEvaluate(i,s,l){const p=new Lo(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(i,s,l);return p}}class Ar{constructor(i,s,l){this.property=i,this.value=s,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,s,l,p){return this.property.evaluate(this.value,this.parameters,i,s,l,p)}}class Lo{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Je{constructor(i){this.specification=i}possiblyEvaluate(i,s){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(s)}interpolate(i,s,l){const p=pn[this.specification.type];return p?p(i,s,l):i}}class ht{constructor(i,s){this.specification=i,this.overrides=s}possiblyEvaluate(i,s,l,p){return new Ar(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(s,null,{},l,p)}:i.expression,s)}interpolate(i,s,l){if(i.value.kind!=="constant"||s.value.kind!=="constant")return i;if(i.value.value===void 0||s.value.value===void 0)return new Ar(this,{kind:"constant",value:void 0},i.parameters);const p=pn[this.specification.type];if(p){const y=p(i.value.value,s.value.value,l);return new Ar(this,{kind:"constant",value:y},i.parameters)}return i}evaluate(i,s,l,p,y,_){return i.kind==="constant"?i.value:i.evaluate(s,l,p,y,_)}}class Fl extends ht{possiblyEvaluate(i,s,l,p){if(i.value===void 0)return new Ar(this,{kind:"constant",value:void 0},s);if(i.expression.kind==="constant"){const y=i.expression.evaluate(s,null,{},l,p),_=i.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,w=this._calculate(_,_,_,s);return new Ar(this,{kind:"constant",value:w},s)}if(i.expression.kind==="camera"){const y=this._calculate(i.expression.evaluate({zoom:s.zoom-1}),i.expression.evaluate({zoom:s.zoom}),i.expression.evaluate({zoom:s.zoom+1}),s);return new Ar(this,{kind:"constant",value:y},s)}return new Ar(this,i.expression,s)}evaluate(i,s,l,p,y,_){if(i.kind==="source"){const w=i.evaluate(s,l,p,y,_);return this._calculate(w,w,w,s)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(s.zoom)-1},l,p),i.evaluate({zoom:Math.floor(s.zoom)},l,p),i.evaluate({zoom:Math.floor(s.zoom)+1},l,p),s):i.value}_calculate(i,s,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:s}:{from:l,to:s}}interpolate(i){return i}}class Ol{constructor(i){this.specification=i}possiblyEvaluate(i,s,l,p){if(i.value!==void 0){if(i.expression.kind==="constant"){const y=i.expression.evaluate(s,null,{},l,p);return this._calculate(y,y,y,s)}return this._calculate(i.expression.evaluate(new Kt(Math.floor(s.zoom-1),s)),i.expression.evaluate(new Kt(Math.floor(s.zoom),s)),i.expression.evaluate(new Kt(Math.floor(s.zoom+1),s)),s)}}_calculate(i,s,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:s}:{from:l,to:s}}interpolate(i){return i}}class Mu{constructor(i){this.specification=i}possiblyEvaluate(i,s,l,p){return!!i.expression.evaluate(s,null,{},l,p)}interpolate(){return!1}}class m{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in i){const l=i[s];l.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new Ca(l,void 0),y=this.defaultTransitionablePropertyValues[s]=new Rl(l);this.defaultTransitioningPropertyValues[s]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate({})}}}Ke("DataDrivenProperty",ht),Ke("DataConstantProperty",Je),Ke("CrossFadedDataDrivenProperty",Fl),Ke("CrossFadedProperty",Ol),Ke("ColorRampProperty",Mu);const t="-transition";class a extends ra{constructor(i,s){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),s.layout&&(this._unevaluatedLayout=new Do(s.layout)),s.paint)){this._transitionablePaint=new Bl(s.paint);for(const l in i.paint)this.setPaintProperty(l,i.paint[l],{validate:!1});for(const l in i.layout)this.setLayoutProperty(l,i.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Lo(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,s,l={}){s!=null&&this._validate(Ad,`layers.${this.id}.layout.${i}`,i,s,l)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,s):this.visibility=s)}getPaintProperty(i){return i.endsWith(t)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,s,l={}){if(s!=null&&this._validate(Id,`layers.${this.id}.paint.${i}`,i,s,l))return!1;if(i.endsWith(t))return this._transitionablePaint.setTransition(i.slice(0,-11),s||void 0),!1;{const p=this._transitionablePaint._values[i],y=p.property.specification["property-type"]==="cross-faded-data-driven",_=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(i,s),this._handleSpecialPaintPropertyUpdate(i);const S=this._transitionablePaint._values[i].value;return S.isDataDriven()||_||y||this._handleOverridablePaintPropertyUpdate(i,w,S)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,s,l){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,s){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,s)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),at(i,(s,l)=>!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length))}_validate(i,s,l,p,y={}){return(!y||y.validate!==!1)&&Su(this,i.call(Vs,{key:s,layerType:this.type,objectKey:l,value:p,styleSpec:we,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const s=this.paint.get(i);if(s instanceof Ar&&ma(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const h={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class d{constructor(i,s){this._structArray=i,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class f{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,s){return i._trim(),s&&(i.isTransferred=!0,s.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const s=Object.create(this.prototype);return s.arrayBuffer=i.arrayBuffer,s.length=i.length,s.capacity=i.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function b(r,i=1){let s=0,l=0;return{members:r.map(p=>{const y=h[p.type].BYTES_PER_ELEMENT,_=s=T(s,Math.max(i,y)),w=p.components||1;return l=Math.max(l,y),s+=y*w,{name:p.name,type:p.type,components:w,offset:_}}),size:T(s,Math.max(l,i)),alignment:i}}function T(r,i){return Math.ceil(r/i)*i}class k extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s){const l=this.length;return this.resize(l+1),this.emplace(l,i,s)}emplace(i,s,l){const p=2*i;return this.int16[p+0]=s,this.int16[p+1]=l,i}}k.prototype.bytesPerElement=4,Ke("StructArrayLayout2i4",k);class I extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,s,l)}emplace(i,s,l,p){const y=3*i;return this.int16[y+0]=s,this.int16[y+1]=l,this.int16[y+2]=p,i}}I.prototype.bytesPerElement=6,Ke("StructArrayLayout3i6",I);class E extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,i,s,l,p)}emplace(i,s,l,p,y){const _=4*i;return this.int16[_+0]=s,this.int16[_+1]=l,this.int16[_+2]=p,this.int16[_+3]=y,i}}E.prototype.bytesPerElement=8,Ke("StructArrayLayout4i8",E);class z extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,s,l,p,y,_)}emplace(i,s,l,p,y,_,w){const S=6*i;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=y,this.int16[S+4]=_,this.int16[S+5]=w,i}}z.prototype.bytesPerElement=12,Ke("StructArrayLayout2i4i12",z);class N extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,s,l,p,y,_)}emplace(i,s,l,p,y,_,w){const S=4*i,C=8*i;return this.int16[S+0]=s,this.int16[S+1]=l,this.uint8[C+4]=p,this.uint8[C+5]=y,this.uint8[C+6]=_,this.uint8[C+7]=w,i}}N.prototype.bytesPerElement=8,Ke("StructArrayLayout2i4ub8",N);class H extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s){const l=this.length;return this.resize(l+1),this.emplace(l,i,s)}emplace(i,s,l){const p=2*i;return this.float32[p+0]=s,this.float32[p+1]=l,i}}H.prototype.bytesPerElement=8,Ke("StructArrayLayout2f8",H);class q extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_,w,S,C,P){const M=this.length;return this.resize(M+1),this.emplace(M,i,s,l,p,y,_,w,S,C,P)}emplace(i,s,l,p,y,_,w,S,C,P,M){const R=10*i;return this.uint16[R+0]=s,this.uint16[R+1]=l,this.uint16[R+2]=p,this.uint16[R+3]=y,this.uint16[R+4]=_,this.uint16[R+5]=w,this.uint16[R+6]=S,this.uint16[R+7]=C,this.uint16[R+8]=P,this.uint16[R+9]=M,i}}q.prototype.bytesPerElement=20,Ke("StructArrayLayout10ui20",q);class Q extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_,w,S,C,P,M,R){const j=this.length;return this.resize(j+1),this.emplace(j,i,s,l,p,y,_,w,S,C,P,M,R)}emplace(i,s,l,p,y,_,w,S,C,P,M,R,j){const U=12*i;return this.int16[U+0]=s,this.int16[U+1]=l,this.int16[U+2]=p,this.int16[U+3]=y,this.uint16[U+4]=_,this.uint16[U+5]=w,this.uint16[U+6]=S,this.uint16[U+7]=C,this.int16[U+8]=P,this.int16[U+9]=M,this.int16[U+10]=R,this.int16[U+11]=j,i}}Q.prototype.bytesPerElement=24,Ke("StructArrayLayout4i4ui4i24",Q);class ie extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,s,l)}emplace(i,s,l,p){const y=3*i;return this.float32[y+0]=s,this.float32[y+1]=l,this.float32[y+2]=p,i}}ie.prototype.bytesPerElement=12,Ke("StructArrayLayout3f12",ie);class ne extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint32[1*i+0]=s,i}}ne.prototype.bytesPerElement=4,Ke("StructArrayLayout1ul4",ne);class ae extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_,w,S,C){const P=this.length;return this.resize(P+1),this.emplace(P,i,s,l,p,y,_,w,S,C)}emplace(i,s,l,p,y,_,w,S,C,P){const M=10*i,R=5*i;return this.int16[M+0]=s,this.int16[M+1]=l,this.int16[M+2]=p,this.int16[M+3]=y,this.int16[M+4]=_,this.int16[M+5]=w,this.uint32[R+3]=S,this.uint16[M+8]=C,this.uint16[M+9]=P,i}}ae.prototype.bytesPerElement=20,Ke("StructArrayLayout6i1ul2ui20",ae);class K extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,s,l,p,y,_)}emplace(i,s,l,p,y,_,w){const S=6*i;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=y,this.int16[S+4]=_,this.int16[S+5]=w,i}}K.prototype.bytesPerElement=12,Ke("StructArrayLayout2i2i2i12",K);class ue extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y){const _=this.length;return this.resize(_+1),this.emplace(_,i,s,l,p,y)}emplace(i,s,l,p,y,_){const w=4*i,S=8*i;return this.float32[w+0]=s,this.float32[w+1]=l,this.float32[w+2]=p,this.int16[S+6]=y,this.int16[S+7]=_,i}}ue.prototype.bytesPerElement=16,Ke("StructArrayLayout2f1f2i16",ue);class de extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,s,l,p,y,_)}emplace(i,s,l,p,y,_,w){const S=16*i,C=4*i,P=8*i;return this.uint8[S+0]=s,this.uint8[S+1]=l,this.float32[C+1]=p,this.float32[C+2]=y,this.int16[P+6]=_,this.int16[P+7]=w,i}}de.prototype.bytesPerElement=16,Ke("StructArrayLayout2ub2f2i16",de);class ye extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,s,l)}emplace(i,s,l,p){const y=3*i;return this.uint16[y+0]=s,this.uint16[y+1]=l,this.uint16[y+2]=p,i}}ye.prototype.bytesPerElement=6,Ke("StructArrayLayout3ui6",ye);class Ie extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_,w,S,C,P,M,R,j,U,$,Y,te){const me=this.length;return this.resize(me+1),this.emplace(me,i,s,l,p,y,_,w,S,C,P,M,R,j,U,$,Y,te)}emplace(i,s,l,p,y,_,w,S,C,P,M,R,j,U,$,Y,te,me){const oe=24*i,pe=12*i,be=48*i;return this.int16[oe+0]=s,this.int16[oe+1]=l,this.uint16[oe+2]=p,this.uint16[oe+3]=y,this.uint32[pe+2]=_,this.uint32[pe+3]=w,this.uint32[pe+4]=S,this.uint16[oe+10]=C,this.uint16[oe+11]=P,this.uint16[oe+12]=M,this.float32[pe+7]=R,this.float32[pe+8]=j,this.uint8[be+36]=U,this.uint8[be+37]=$,this.uint8[be+38]=Y,this.uint32[pe+10]=te,this.int16[oe+22]=me,i}}Ie.prototype.bytesPerElement=48,Ke("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ie);class Le extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,p,y,_,w,S,C,P,M,R,j,U,$,Y,te,me,oe,pe,be,ze,Ze,ct,He,Ue,tt,Ye){const Xe=this.length;return this.resize(Xe+1),this.emplace(Xe,i,s,l,p,y,_,w,S,C,P,M,R,j,U,$,Y,te,me,oe,pe,be,ze,Ze,ct,He,Ue,tt,Ye)}emplace(i,s,l,p,y,_,w,S,C,P,M,R,j,U,$,Y,te,me,oe,pe,be,ze,Ze,ct,He,Ue,tt,Ye,Xe){const Pe=32*i,it=16*i;return this.int16[Pe+0]=s,this.int16[Pe+1]=l,this.int16[Pe+2]=p,this.int16[Pe+3]=y,this.int16[Pe+4]=_,this.int16[Pe+5]=w,this.int16[Pe+6]=S,this.int16[Pe+7]=C,this.uint16[Pe+8]=P,this.uint16[Pe+9]=M,this.uint16[Pe+10]=R,this.uint16[Pe+11]=j,this.uint16[Pe+12]=U,this.uint16[Pe+13]=$,this.uint16[Pe+14]=Y,this.uint16[Pe+15]=te,this.uint16[Pe+16]=me,this.uint16[Pe+17]=oe,this.uint16[Pe+18]=pe,this.uint16[Pe+19]=be,this.uint16[Pe+20]=ze,this.uint16[Pe+21]=Ze,this.uint16[Pe+22]=ct,this.uint32[it+12]=He,this.float32[it+13]=Ue,this.float32[it+14]=tt,this.uint16[Pe+30]=Ye,this.uint16[Pe+31]=Xe,i}}Le.prototype.bytesPerElement=64,Ke("StructArrayLayout8i15ui1ul2f2ui64",Le);class $e extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.float32[1*i+0]=s,i}}$e.prototype.bytesPerElement=4,Ke("StructArrayLayout1f4",$e);class We extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,s,l)}emplace(i,s,l,p){const y=3*i;return this.uint16[6*i+0]=s,this.float32[y+1]=l,this.float32[y+2]=p,i}}We.prototype.bytesPerElement=12,Ke("StructArrayLayout1ui2f12",We);class je extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,s,l)}emplace(i,s,l,p){const y=4*i;return this.uint32[2*i+0]=s,this.uint16[y+2]=l,this.uint16[y+3]=p,i}}je.prototype.bytesPerElement=8,Ke("StructArrayLayout1ul2ui8",je);class Oe extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s){const l=this.length;return this.resize(l+1),this.emplace(l,i,s)}emplace(i,s,l){const p=2*i;return this.uint16[p+0]=s,this.uint16[p+1]=l,i}}Oe.prototype.bytesPerElement=4,Ke("StructArrayLayout2ui4",Oe);class Qe extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint16[1*i+0]=s,i}}Qe.prototype.bytesPerElement=2,Ke("StructArrayLayout1ui2",Qe);class yt extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,i,s,l,p)}emplace(i,s,l,p,y){const _=4*i;return this.float32[_+0]=s,this.float32[_+1]=l,this.float32[_+2]=p,this.float32[_+3]=y,i}}yt.prototype.bytesPerElement=16,Ke("StructArrayLayout4f16",yt);class Ne extends d{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new L(this.anchorPointX,this.anchorPointY)}}Ne.prototype.size=20;class qe extends ae{get(i){return new Ne(this,i)}}Ke("CollisionBoxArray",qe);class mt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}mt.prototype.size=48;class Yt extends Ie{get(i){return new mt(this,i)}}Ke("PlacedSymbolArray",Yt);class xt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}xt.prototype.size=64;class kt extends Le{get(i){return new xt(this,i)}}Ke("SymbolInstanceArray",kt);class Jt extends $e{getoffsetX(i){return this.float32[1*i+0]}}Ke("GlyphOffsetArray",Jt);class $i extends I{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Ke("SymbolLineVertexArray",$i);class ur extends d{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ur.prototype.size=12;class Qt extends We{get(i){return new ur(this,i)}}Ke("TextAnchorOffsetArray",Qt);class mn extends d{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}mn.prototype.size=8;class en extends je{get(i){return new mn(this,i)}}Ke("FeatureIndexArray",en);class Gi extends k{}class tn extends k{}class Mr extends k{}class Pa extends z{}class jl extends N{}class Ia extends H{}class qn extends q{}class Vl extends Q{}class Eu extends ie{}class Zn extends ne{}class Wn extends K{}class ds extends de{}class hr extends ye{}class Ri extends Oe{}const Hi=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:En}=Hi;class It{constructor(i=[]){this.segments=i}prepareSegment(i,s,l,p){let y=this.segments[this.segments.length-1];return i>It.MAX_VERTEX_ARRAY_LENGTH&&Xt(`Max vertices per segment is ${It.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!y||y.vertexLength+i>It.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:s.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const i of this.segments)for(const s in i.vaos)i.vaos[s].destroy()}static simpleSegment(i,s,l,p){return new It([{vertexOffset:i,primitiveOffset:s,vertexLength:l,primitiveLength:p,vaos:{},sortKey:0}])}}function Ns(r,i){return 256*(r=Se(Math.floor(r),0,255))+Se(Math.floor(i),0,255)}It.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ke("SegmentVector",It);const Aa=b([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ma={exports:{}},Ld={exports:{}};Ld.exports=function(r,i){var s,l,p,y,_,w,S,C;for(l=r.length-(s=3&r.length),p=i,_=3432918353,w=461845907,C=0;C<l;)S=255&r.charCodeAt(C)|(255&r.charCodeAt(++C))<<8|(255&r.charCodeAt(++C))<<16|(255&r.charCodeAt(++C))<<24,++C,p=27492+(65535&(y=5*(65535&(p=(p^=S=(65535&(S=(S=(65535&S)*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(S=0,s){case 3:S^=(255&r.charCodeAt(C+2))<<16;case 2:S^=(255&r.charCodeAt(C+1))<<8;case 1:p^=S=(65535&(S=(S=(65535&(S^=255&r.charCodeAt(C)))*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295}return p^=r.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var dm=Ld.exports,Rd={exports:{}};Rd.exports=function(r,i){for(var s,l=r.length,p=i^l,y=0;l>=4;)s=1540483477*(65535&(s=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),l-=4,++y;switch(l){case 3:p^=(255&r.charCodeAt(y+2))<<16;case 2:p^=(255&r.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&r.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var ps=dm,Bd=Rd.exports;Ma.exports=ps,Ma.exports.murmur3=ps,Ma.exports.murmur2=Bd;var Nl=A(Ma.exports);class Ro{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,s,l,p){this.ids.push(Ul(i)),this.positions.push(s,l,p)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Ul(i);let l=0,p=this.ids.length-1;for(;l<p;){const _=l+p>>1;this.ids[_]>=s?p=_:l=_+1}const y=[];for(;this.ids[l]===s;)y.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return y}static serialize(i,s){const l=new Float64Array(i.ids),p=new Uint32Array(i.positions);return $l(l,p,0,l.length-1),s&&s.push(l.buffer,p.buffer),{ids:l,positions:p}}static deserialize(i){const s=new Ro;return s.ids=i.ids,s.positions=i.positions,s.indexed=!0,s}}function Ul(r){const i=+r;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:Nl(String(r))}function $l(r,i,s,l){for(;s<l;){const p=r[s+l>>1];let y=s-1,_=l+1;for(;;){do y++;while(r[y]<p);do _--;while(r[_]>p);if(y>=_)break;Ea(r,y,_),Ea(i,3*y,3*_),Ea(i,3*y+1,3*_+1),Ea(i,3*y+2,3*_+2)}_-s<l-_?($l(r,i,s,_),s=_+1):($l(r,i,_+1,l),l=_)}}function Ea(r,i,s){const l=r[i];r[i]=r[s],r[s]=l}Ke("FeaturePositionMap",Ro);class Bo{constructor(i,s){this.gl=i.gl,this.location=s}}class Fd extends Bo{constructor(i,s){super(i,s),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class zv extends Bo{constructor(i,s){super(i,s),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Dv extends Bo{constructor(i,s){super(i,s),this.current=Nt.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const DT=new Float32Array(16);function pm(r){return[Ns(255*r.r,255*r.g),Ns(255*r.b,255*r.a)]}class zu{constructor(i,s,l){this.value=i,this.uniformNames=s.map(p=>`u_${p}`),this.type=l}setUniform(i,s,l){i.set(l.constantOr(this.value))}getBinding(i,s,l){return this.type==="color"?new Dv(i,s):new Fd(i,s)}}class Gl{constructor(i,s){this.uniformNames=s.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=i.tlbr}setUniform(i,s,l,p){const y=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&i.set(y)}getBinding(i,s,l){return l.substr(0,9)==="u_pattern"?new zv(i,s):new Fd(i,s)}}class Us{constructor(i,s,l,p){this.expression=i,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(i,s,l,p,y){const _=this.paintVertexArray.length,w=this.expression.evaluate(new Kt(0),s,{},p,[],y);this.paintVertexArray.resize(i),this._setPaintValue(_,i,w)}updatePaintArray(i,s,l,p){const y=this.expression.evaluate({zoom:0},l,p);this._setPaintValue(i,s,y)}_setPaintValue(i,s,l){if(this.type==="color"){const p=pm(l);for(let y=i;y<s;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=i;p<s;p++)this.paintVertexArray.emplace(p,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zr{constructor(i,s,l,p,y,_){this.expression=i,this.uniformNames=s.map(w=>`u_${w}_t`),this.type=l,this.useIntegerZoom=p,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=s.map(w=>({name:`a_${w}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(i,s,l,p,y){const _=this.expression.evaluate(new Kt(this.zoom),s,{},p,[],y),w=this.expression.evaluate(new Kt(this.zoom+1),s,{},p,[],y),S=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(S,i,_,w)}updatePaintArray(i,s,l,p){const y=this.expression.evaluate({zoom:this.zoom},l,p),_=this.expression.evaluate({zoom:this.zoom+1},l,p);this._setPaintValue(i,s,y,_)}_setPaintValue(i,s,l,p){if(this.type==="color"){const y=pm(l),_=pm(p);for(let w=i;w<s;w++)this.paintVertexArray.emplace(w,y[0],y[1],_[0],_[1])}else{for(let y=i;y<s;y++)this.paintVertexArray.emplace(y,l,p);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,s){const l=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,p=Se(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);i.set(p)}getBinding(i,s,l){return new Fd(i,s)}}class za{constructor(i,s,l,p,y,_){this.expression=i,this.type=s,this.useIntegerZoom=l,this.zoom=p,this.layerId=_,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(i,s,l){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(p,i,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(i,s,l,p,y){this._setPaintValues(i,s,l.patterns&&l.patterns[this.layerId],y)}_setPaintValues(i,s,l,p){if(!p||!l)return;const{min:y,mid:_,max:w}=l,S=p[y],C=p[_],P=p[w];if(S&&C&&P)for(let M=i;M<s;M++)this.zoomInPaintVertexArray.emplace(M,C.tl[0],C.tl[1],C.br[0],C.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],C.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(M,C.tl[0],C.tl[1],C.br[0],C.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],C.pixelRatio,P.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,Aa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,Aa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Lv{constructor(i,s,l){this.binders={},this._buffers=[];const p=[];for(const y in i.paint._values){if(!l(y))continue;const _=i.paint.get(y);if(!(_ instanceof Ar&&ma(_.property.specification)))continue;const w=LT(y,i.type),S=_.value,C=_.property.specification.type,P=_.property.useIntegerZoom,M=_.property.specification["property-type"],R=M==="cross-faded"||M==="cross-faded-data-driven";if(S.kind==="constant")this.binders[y]=R?new Gl(S.value,w):new zu(S.value,w,C),p.push(`/u_${y}`);else if(S.kind==="source"||R){const j=Rv(y,C,"source");this.binders[y]=R?new za(S,C,P,s,j,i.id):new Us(S,w,C,j),p.push(`/a_${y}`)}else{const j=Rv(y,C,"composite");this.binders[y]=new Zr(S,w,C,P,s,j),p.push(`/z_${y}`)}}this.cacheKey=p.sort().join("")}getMaxValue(i){const s=this.binders[i];return s instanceof Us||s instanceof Zr?s.maxValue:0}populatePaintArrays(i,s,l,p,y){for(const _ in this.binders){const w=this.binders[_];(w instanceof Us||w instanceof Zr||w instanceof za)&&w.populatePaintArray(i,s,l,p,y)}}setConstantPatternPositions(i,s){for(const l in this.binders){const p=this.binders[l];p instanceof Gl&&p.setConstantPatternPositions(i,s)}}updatePaintArrays(i,s,l,p,y){let _=!1;for(const w in i){const S=s.getPositions(w);for(const C of S){const P=l.feature(C.index);for(const M in this.binders){const R=this.binders[M];if((R instanceof Us||R instanceof Zr||R instanceof za)&&R.expression.isStateDependent===!0){const j=p.paint.get(M);R.expression=j.value,R.updatePaintArray(C.start,C.end,P,i[w],y),_=!0}}}}return _}defines(){const i=[];for(const s in this.binders){const l=this.binders[s];(l instanceof zu||l instanceof Gl)&&i.push(...l.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return i}getBinderAttributes(){const i=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Us||l instanceof Zr)for(let p=0;p<l.paintVertexAttributes.length;p++)i.push(l.paintVertexAttributes[p].name);else if(l instanceof za)for(let p=0;p<Aa.members.length;p++)i.push(Aa.members[p].name)}return i}getBinderUniforms(){const i=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof zu||l instanceof Gl||l instanceof Zr)for(const p of l.uniformNames)i.push(p)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,s){const l=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof zu||y instanceof Gl||y instanceof Zr){for(const _ of y.uniformNames)if(s[_]){const w=y.getBinding(i,s[_],_);l.push({name:_,property:p,binding:w})}}}return l}setUniforms(i,s,l,p){for(const{name:y,property:_,binding:w}of s)this.binders[_].setUniform(w,p,l.get(_),y)}updatePaintBuffers(i){this._buffers=[];for(const s in this.binders){const l=this.binders[s];if(i&&l instanceof za){const p=i.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(l instanceof Us||l instanceof Zr)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(i){for(const s in this.binders){const l=this.binders[s];(l instanceof Us||l instanceof Zr||l instanceof za)&&l.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const s=this.binders[i];(s instanceof Us||s instanceof Zr||s instanceof za)&&s.destroy()}}}class Fo{constructor(i,s,l=()=>!0){this.programConfigurations={};for(const p of i)this.programConfigurations[p.id]=new Lv(p,s,l);this.needsUpload=!1,this._featureMap=new Ro,this._bufferOffset=0}populatePaintArrays(i,s,l,p,y,_){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(i,s,p,y,_);s.id!==void 0&&this._featureMap.add(s.id,l,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,s,l,p){for(const y of l)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(i,this._featureMap,s,y,p)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function LT(r,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${i}-`,"").replace(/-/g,"_")]}function Rv(r,i,s){const l={color:{source:H,composite:yt},number:{source:$e,composite:H}},p=function(y){return{"line-pattern":{source:qn,composite:qn},"fill-pattern":{source:qn,composite:qn},"fill-extrusion-pattern":{source:qn,composite:qn}}[y]}(r);return p&&p[s]||l[i][s]}Ke("ConstantBinder",zu),Ke("CrossFadedConstantBinder",Gl),Ke("SourceExpressionBinder",Us),Ke("CrossFadedCompositeBinder",za),Ke("CompositeExpressionBinder",Zr),Ke("ProgramConfiguration",Lv,{omit:["_buffers"]}),Ke("ProgramConfigurationSet",Fo);const bi=8192,fm=Math.pow(2,14)-1,Bv=-fm-1;function Oo(r){const i=bi/r.extent,s=r.loadGeometry();for(let l=0;l<s.length;l++){const p=s[l];for(let y=0;y<p.length;y++){const _=p[y],w=Math.round(_.x*i),S=Math.round(_.y*i);_.x=Se(w,Bv,fm),_.y=Se(S,Bv,fm),(w<_.x||w>_.x+1||S<_.y||S>_.y+1)&&Xt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function jo(r,i){return{type:r.type,id:r.id,properties:r.properties,geometry:i?Oo(r):[]}}function Od(r,i,s,l,p){r.emplaceBack(2*i+(l+1)/2,2*s+(p+1)/2)}class mm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new tn,this.indexArray=new hr,this.segments=new It,this.programConfigurations=new Fo(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,l){const p=this.layers[0],y=[];let _=null,w=!1;p.type==="circle"&&(_=p.layout.get("circle-sort-key"),w=!_.isConstant());for(const{feature:S,id:C,index:P,sourceLayerIndex:M}of i){const R=this.layers[0]._featureFilter.needGeometry,j=jo(S,R);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),j,l))continue;const U=w?_.evaluate(j,{},l):void 0,$={id:C,properties:S.properties,type:S.type,sourceLayerIndex:M,index:P,geometry:R?j.geometry:Oo(S),patterns:{},sortKey:U};y.push($)}w&&y.sort((S,C)=>S.sortKey-C.sortKey);for(const S of y){const{geometry:C,index:P,sourceLayerIndex:M}=S,R=i[P].feature;this.addFeature(S,C,P,l),s.featureIndex.insert(R,C,P,M,this.index)}}update(i,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,En),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,s,l,p){for(const y of s)for(const _ of y){const w=_.x,S=_.y;if(w<0||w>=bi||S<0||S>=bi)continue;const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),P=C.vertexLength;Od(this.layoutVertexArray,w,S,-1,-1),Od(this.layoutVertexArray,w,S,1,-1),Od(this.layoutVertexArray,w,S,1,1),Od(this.layoutVertexArray,w,S,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,{},p)}}function Fv(r,i){for(let s=0;s<r.length;s++)if(Hl(i,r[s]))return!0;for(let s=0;s<i.length;s++)if(Hl(r,i[s]))return!0;return!!gm(r,i)}function RT(r,i,s){return!!Hl(r,i)||!!ym(i,r,s)}function Ov(r,i){if(r.length===1)return Vv(i,r[0]);for(let s=0;s<i.length;s++){const l=i[s];for(let p=0;p<l.length;p++)if(Hl(r,l[p]))return!0}for(let s=0;s<r.length;s++)if(Vv(i,r[s]))return!0;for(let s=0;s<i.length;s++)if(gm(r,i[s]))return!0;return!1}function BT(r,i,s){if(r.length>1){if(gm(r,i))return!0;for(let l=0;l<i.length;l++)if(ym(i[l],r,s))return!0}for(let l=0;l<r.length;l++)if(ym(r[l],i,s))return!0;return!1}function gm(r,i){if(r.length===0||i.length===0)return!1;for(let s=0;s<r.length-1;s++){const l=r[s],p=r[s+1];for(let y=0;y<i.length-1;y++)if(FT(l,p,i[y],i[y+1]))return!0}return!1}function FT(r,i,s,l){return pi(r,s,l)!==pi(i,s,l)&&pi(r,i,s)!==pi(r,i,l)}function ym(r,i,s){const l=s*s;if(i.length===1)return r.distSqr(i[0])<l;for(let p=1;p<i.length;p++)if(jv(r,i[p-1],i[p])<l)return!0;return!1}function jv(r,i,s){const l=i.distSqr(s);if(l===0)return r.distSqr(i);const p=((r.x-i.x)*(s.x-i.x)+(r.y-i.y)*(s.y-i.y))/l;return r.distSqr(p<0?i:p>1?s:s.sub(i)._mult(p)._add(i))}function Vv(r,i){let s,l,p,y=!1;for(let _=0;_<r.length;_++){s=r[_];for(let w=0,S=s.length-1;w<s.length;S=w++)l=s[w],p=s[S],l.y>i.y!=p.y>i.y&&i.x<(p.x-l.x)*(i.y-l.y)/(p.y-l.y)+l.x&&(y=!y)}return y}function Hl(r,i){let s=!1;for(let l=0,p=r.length-1;l<r.length;p=l++){const y=r[l],_=r[p];y.y>i.y!=_.y>i.y&&i.x<(_.x-y.x)*(i.y-y.y)/(_.y-y.y)+y.x&&(s=!s)}return s}function OT(r,i,s){const l=s[0],p=s[2];if(r.x<l.x&&i.x<l.x||r.x>p.x&&i.x>p.x||r.y<l.y&&i.y<l.y||r.y>p.y&&i.y>p.y)return!1;const y=pi(r,i,s[0]);return y!==pi(r,i,s[1])||y!==pi(r,i,s[2])||y!==pi(r,i,s[3])}function Du(r,i,s){const l=i.paint.get(r).value;return l.kind==="constant"?l.value:s.programConfigurations.get(i.id).getMaxValue(r)}function jd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Vd(r,i,s,l,p){if(!i[0]&&!i[1])return r;const y=L.convert(i)._mult(p);s==="viewport"&&y._rotate(-l);const _=[];for(let w=0;w<r.length;w++)_.push(r[w].sub(y));return _}let Nv,Uv;Ke("CircleBucket",mm,{omit:["layers"]});var jT={get paint(){return Uv=Uv||new m({"circle-radius":new ht(we.paint_circle["circle-radius"]),"circle-color":new ht(we.paint_circle["circle-color"]),"circle-blur":new ht(we.paint_circle["circle-blur"]),"circle-opacity":new ht(we.paint_circle["circle-opacity"]),"circle-translate":new Je(we.paint_circle["circle-translate"]),"circle-translate-anchor":new Je(we.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Je(we.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Je(we.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ht(we.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ht(we.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ht(we.paint_circle["circle-stroke-opacity"])})},get layout(){return Nv=Nv||new m({"circle-sort-key":new ht(we.layout_circle["circle-sort-key"])})}},gn=1e-6,ql=typeof Float32Array<"u"?Float32Array:Array;function _m(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function $v(r,i,s){var l=i[0],p=i[1],y=i[2],_=i[3],w=i[4],S=i[5],C=i[6],P=i[7],M=i[8],R=i[9],j=i[10],U=i[11],$=i[12],Y=i[13],te=i[14],me=i[15],oe=s[0],pe=s[1],be=s[2],ze=s[3];return r[0]=oe*l+pe*w+be*M+ze*$,r[1]=oe*p+pe*S+be*R+ze*Y,r[2]=oe*y+pe*C+be*j+ze*te,r[3]=oe*_+pe*P+be*U+ze*me,r[4]=(oe=s[4])*l+(pe=s[5])*w+(be=s[6])*M+(ze=s[7])*$,r[5]=oe*p+pe*S+be*R+ze*Y,r[6]=oe*y+pe*C+be*j+ze*te,r[7]=oe*_+pe*P+be*U+ze*me,r[8]=(oe=s[8])*l+(pe=s[9])*w+(be=s[10])*M+(ze=s[11])*$,r[9]=oe*p+pe*S+be*R+ze*Y,r[10]=oe*y+pe*C+be*j+ze*te,r[11]=oe*_+pe*P+be*U+ze*me,r[12]=(oe=s[12])*l+(pe=s[13])*w+(be=s[14])*M+(ze=s[15])*$,r[13]=oe*p+pe*S+be*R+ze*Y,r[14]=oe*y+pe*C+be*j+ze*te,r[15]=oe*_+pe*P+be*U+ze*me,r}Math.hypot||(Math.hypot=function(){for(var r=0,i=arguments.length;i--;)r+=arguments[i]*arguments[i];return Math.sqrt(r)});var Lu,VT=$v;function Nd(r,i,s){var l=i[0],p=i[1],y=i[2],_=i[3];return r[0]=s[0]*l+s[4]*p+s[8]*y+s[12]*_,r[1]=s[1]*l+s[5]*p+s[9]*y+s[13]*_,r[2]=s[2]*l+s[6]*p+s[10]*y+s[14]*_,r[3]=s[3]*l+s[7]*p+s[11]*y+s[15]*_,r}Lu=new ql(4),ql!=Float32Array&&(Lu[0]=0,Lu[1]=0,Lu[2]=0,Lu[3]=0);class NT extends a{constructor(i){super(i,jT)}createBucket(i){return new mm(i)}queryRadius(i){const s=i;return Du("circle-radius",this,s)+Du("circle-stroke-width",this,s)+jd(this.paint.get("circle-translate"))}queryIntersectsFeature(i,s,l,p,y,_,w,S){const C=Vd(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,w),P=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),M=this.paint.get("circle-pitch-alignment")==="map",R=M?C:function(U,$){return U.map(Y=>Gv(Y,$))}(C,S),j=M?P*w:P;for(const U of p)for(const $ of U){const Y=M?$:Gv($,S);let te=j;const me=Nd([],[$.x,$.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?te*=me[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(te*=_.cameraToCenterDistance/me[3]),RT(R,Y,te))return!0}return!1}}function Gv(r,i){const s=Nd([],[r.x,r.y,0,1],i);return new L(s[0]/s[3],s[1]/s[3])}class Hv extends mm{}let qv;Ke("HeatmapBucket",Hv,{omit:["layers"]});var UT={get paint(){return qv=qv||new m({"heatmap-radius":new ht(we.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ht(we.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Je(we.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mu(we.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Je(we.paint_heatmap["heatmap-opacity"])})}};function vm(r,{width:i,height:s},l,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==i*s*l)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${i*s*l}`)}else p=new Uint8Array(i*s*l);return r.width=i,r.height=s,r.data=p,r}function Zv(r,{width:i,height:s},l){if(i===r.width&&s===r.height)return;const p=vm({},{width:i,height:s},l);xm(r,p,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,i),height:Math.min(r.height,s)},l),r.width=i,r.height=s,r.data=p.data}function xm(r,i,s,l,p,y){if(p.width===0||p.height===0)return i;if(p.width>r.width||p.height>r.height||s.x>r.width-p.width||s.y>r.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>i.width||p.height>i.height||l.x>i.width-p.width||l.y>i.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const _=r.data,w=i.data;if(_===w)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<p.height;S++){const C=((s.y+S)*r.width+s.x)*y,P=((l.y+S)*i.width+l.x)*y;for(let M=0;M<p.width*y;M++)w[P+M]=_[C+M]}return i}class Ru{constructor(i,s){vm(this,i,1,s)}resize(i){Zv(this,i,1)}clone(){return new Ru({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,l,p,y){xm(i,s,l,p,y,1)}}class dr{constructor(i,s){vm(this,i,4,s)}resize(i){Zv(this,i,4)}replace(i,s){s?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new dr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,l,p,y){xm(i,s,l,p,y,4)}}function Wv(r){const i={},s=r.resolution||256,l=r.clips?r.clips.length:1,p=r.image||new dr({width:s,height:l});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const y=(_,w,S)=>{i[r.evaluationKey]=S;const C=r.expression.evaluate(i);p.data[_+w+0]=Math.floor(255*C.r/C.a),p.data[_+w+1]=Math.floor(255*C.g/C.a),p.data[_+w+2]=Math.floor(255*C.b/C.a),p.data[_+w+3]=Math.floor(255*C.a)};if(r.clips)for(let _=0,w=0;_<l;++_,w+=4*s)for(let S=0,C=0;S<s;S++,C+=4){const P=S/(s-1),{start:M,end:R}=r.clips[_];y(w,C,M*(1-P)+R*P)}else for(let _=0,w=0;_<s;_++,w+=4)y(0,w,_/(s-1));return p}Ke("AlphaImage",Ru),Ke("RGBAImage",dr);const wm="big-fb";class $T extends a{createBucket(i){return new Hv(i)}constructor(i){super(i,UT),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Wv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(wm)&&this.heatmapFbos.delete(wm)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xv;var GT={get paint(){return Xv=Xv||new m({"hillshade-illumination-direction":new Je(we.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Je(we.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Je(we.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Je(we.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Je(we.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Je(we.paint_hillshade["hillshade-accent-color"])})}};class HT extends a{constructor(i){super(i,GT)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const qT=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:ZT}=qT;function Kv(r,i,s=2){const l=i&&i.length,p=l?i[0]*s:r.length;let y=Yv(r,0,p,s,!0);const _=[];if(!y||y.next===y.prev)return _;let w,S,C;if(l&&(y=function(P,M,R,j){const U=[];for(let $=0,Y=M.length;$<Y;$++){const te=Yv(P,M[$]*j,$<Y-1?M[$+1]*j:P.length,j,!1);te===te.next&&(te.steiner=!0),U.push(tk(te))}U.sort(JT);for(let $=0;$<U.length;$++)R=QT(U[$],R);return R}(r,i,y,s)),r.length>80*s){w=1/0,S=1/0;let P=-1/0,M=-1/0;for(let R=s;R<p;R+=s){const j=r[R],U=r[R+1];j<w&&(w=j),U<S&&(S=U),j>P&&(P=j),U>M&&(M=U)}C=Math.max(P-w,M-S),C=C!==0?32767/C:0}return Bu(y,_,s,w,S,C,0),_}function Yv(r,i,s,l,p){let y;if(p===function(_,w,S,C){let P=0;for(let M=w,R=S-C;M<S;M+=C)P+=(_[R]-_[M])*(_[M+1]+_[R+1]),R=M;return P}(r,i,s,l)>0)for(let _=i;_<s;_+=l)y=ex(_/l|0,r[_],r[_+1],y);else for(let _=s-l;_>=i;_-=l)y=ex(_/l|0,r[_],r[_+1],y);return y&&Ud(y,y.next)&&(Ou(y),y=y.next),y}function Vo(r,i){if(!r)return r;i||(i=r);let s,l=r;do if(s=!1,l.steiner||!Ud(l,l.next)&&mi(l.prev,l,l.next)!==0)l=l.next;else{if(Ou(l),l=i=l.prev,l===l.next)break;s=!0}while(s||l!==i);return i}function Bu(r,i,s,l,p,y,_){if(!r)return;!_&&y&&function(S,C,P,M){let R=S;do R.z===0&&(R.z=bm(R.x,R.y,C,P,M)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==S);R.prevZ.nextZ=null,R.prevZ=null,function(j){let U,$=1;do{let Y,te=j;j=null;let me=null;for(U=0;te;){U++;let oe=te,pe=0;for(let ze=0;ze<$&&(pe++,oe=oe.nextZ,oe);ze++);let be=$;for(;pe>0||be>0&&oe;)pe!==0&&(be===0||!oe||te.z<=oe.z)?(Y=te,te=te.nextZ,pe--):(Y=oe,oe=oe.nextZ,be--),me?me.nextZ=Y:j=Y,Y.prevZ=me,me=Y;te=oe}me.nextZ=null,$*=2}while(U>1)}(R)}(r,l,p,y);let w=r;for(;r.prev!==r.next;){const S=r.prev,C=r.next;if(y?XT(r,l,p,y):WT(r))i.push(S.i,r.i,C.i),Ou(r),r=C.next,w=C.next;else if((r=C)===w){_?_===1?Bu(r=KT(Vo(r),i),i,s,l,p,y,2):_===2&&YT(r,i,s,l,p,y):Bu(Vo(r),i,s,l,p,y,1);break}}}function WT(r){const i=r.prev,s=r,l=r.next;if(mi(i,s,l)>=0)return!1;const p=i.x,y=s.x,_=l.x,w=i.y,S=s.y,C=l.y,P=p<y?p<_?p:_:y<_?y:_,M=w<S?w<C?w:C:S<C?S:C,R=p>y?p>_?p:_:y>_?y:_,j=w>S?w>C?w:C:S>C?S:C;let U=l.next;for(;U!==i;){if(U.x>=P&&U.x<=R&&U.y>=M&&U.y<=j&&Zl(p,w,y,S,_,C,U.x,U.y)&&mi(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function XT(r,i,s,l){const p=r.prev,y=r,_=r.next;if(mi(p,y,_)>=0)return!1;const w=p.x,S=y.x,C=_.x,P=p.y,M=y.y,R=_.y,j=w<S?w<C?w:C:S<C?S:C,U=P<M?P<R?P:R:M<R?M:R,$=w>S?w>C?w:C:S>C?S:C,Y=P>M?P>R?P:R:M>R?M:R,te=bm(j,U,i,s,l),me=bm($,Y,i,s,l);let oe=r.prevZ,pe=r.nextZ;for(;oe&&oe.z>=te&&pe&&pe.z<=me;){if(oe.x>=j&&oe.x<=$&&oe.y>=U&&oe.y<=Y&&oe!==p&&oe!==_&&Zl(w,P,S,M,C,R,oe.x,oe.y)&&mi(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,pe.x>=j&&pe.x<=$&&pe.y>=U&&pe.y<=Y&&pe!==p&&pe!==_&&Zl(w,P,S,M,C,R,pe.x,pe.y)&&mi(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;oe&&oe.z>=te;){if(oe.x>=j&&oe.x<=$&&oe.y>=U&&oe.y<=Y&&oe!==p&&oe!==_&&Zl(w,P,S,M,C,R,oe.x,oe.y)&&mi(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;pe&&pe.z<=me;){if(pe.x>=j&&pe.x<=$&&pe.y>=U&&pe.y<=Y&&pe!==p&&pe!==_&&Zl(w,P,S,M,C,R,pe.x,pe.y)&&mi(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function KT(r,i){let s=r;do{const l=s.prev,p=s.next.next;!Ud(l,p)&&Jv(l,s,s.next,p)&&Fu(l,p)&&Fu(p,l)&&(i.push(l.i,s.i,p.i),Ou(s),Ou(s.next),s=r=p),s=s.next}while(s!==r);return Vo(s)}function YT(r,i,s,l,p,y){let _=r;do{let w=_.next.next;for(;w!==_.prev;){if(_.i!==w.i&&ik(_,w)){let S=Qv(_,w);return _=Vo(_,_.next),S=Vo(S,S.next),Bu(_,i,s,l,p,y,0),void Bu(S,i,s,l,p,y,0)}w=w.next}_=_.next}while(_!==r)}function JT(r,i){return r.x-i.x}function QT(r,i){const s=function(p,y){let _=y;const w=p.x,S=p.y;let C,P=-1/0;do{if(S<=_.y&&S>=_.next.y&&_.next.y!==_.y){const $=_.x+(S-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if($<=w&&$>P&&(P=$,C=_.x<_.next.x?_:_.next,$===w))return C}_=_.next}while(_!==y);if(!C)return null;const M=C,R=C.x,j=C.y;let U=1/0;_=C;do{if(w>=_.x&&_.x>=R&&w!==_.x&&Zl(S<j?w:P,S,R,j,S<j?P:w,S,_.x,_.y)){const $=Math.abs(S-_.y)/(w-_.x);Fu(_,p)&&($<U||$===U&&(_.x>C.x||_.x===C.x&&ek(C,_)))&&(C=_,U=$)}_=_.next}while(_!==M);return C}(r,i);if(!s)return i;const l=Qv(s,r);return Vo(l,l.next),Vo(s,s.next)}function ek(r,i){return mi(r.prev,r,i.prev)<0&&mi(i.next,r,r.next)<0}function bm(r,i,s,l,p){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-s)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-l)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function tk(r){let i=r,s=r;do(i.x<s.x||i.x===s.x&&i.y<s.y)&&(s=i),i=i.next;while(i!==r);return s}function Zl(r,i,s,l,p,y,_,w){return(p-_)*(i-w)>=(r-_)*(y-w)&&(r-_)*(l-w)>=(s-_)*(i-w)&&(s-_)*(y-w)>=(p-_)*(l-w)}function ik(r,i){return r.next.i!==i.i&&r.prev.i!==i.i&&!function(s,l){let p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==l.i&&p.next.i!==l.i&&Jv(p,p.next,s,l))return!0;p=p.next}while(p!==s);return!1}(r,i)&&(Fu(r,i)&&Fu(i,r)&&function(s,l){let p=s,y=!1;const _=(s.x+l.x)/2,w=(s.y+l.y)/2;do p.y>w!=p.next.y>w&&p.next.y!==p.y&&_<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==s);return y}(r,i)&&(mi(r.prev,r,i.prev)||mi(r,i.prev,i))||Ud(r,i)&&mi(r.prev,r,r.next)>0&&mi(i.prev,i,i.next)>0)}function mi(r,i,s){return(i.y-r.y)*(s.x-i.x)-(i.x-r.x)*(s.y-i.y)}function Ud(r,i){return r.x===i.x&&r.y===i.y}function Jv(r,i,s,l){const p=Gd(mi(r,i,s)),y=Gd(mi(r,i,l)),_=Gd(mi(s,l,r)),w=Gd(mi(s,l,i));return p!==y&&_!==w||!(p!==0||!$d(r,s,i))||!(y!==0||!$d(r,l,i))||!(_!==0||!$d(s,r,l))||!(w!==0||!$d(s,i,l))}function $d(r,i,s){return i.x<=Math.max(r.x,s.x)&&i.x>=Math.min(r.x,s.x)&&i.y<=Math.max(r.y,s.y)&&i.y>=Math.min(r.y,s.y)}function Gd(r){return r>0?1:r<0?-1:0}function Fu(r,i){return mi(r.prev,r,r.next)<0?mi(r,i,r.next)>=0&&mi(r,r.prev,i)>=0:mi(r,i,r.prev)<0||mi(r,r.next,i)<0}function Qv(r,i){const s=Sm(r.i,r.x,r.y),l=Sm(i.i,i.x,i.y),p=r.next,y=i.prev;return r.next=i,i.prev=r,s.next=p,p.prev=s,l.next=s,s.prev=l,y.next=l,l.prev=y,l}function ex(r,i,s,l){const p=Sm(r,i,s);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function Ou(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Sm(r,i,s){return{i:r,x:i,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Tm(r,i,s){const l=s.patternDependencies;let p=!1;for(const y of i){const _=y.paint.get(`${r}-pattern`);_.isConstant()||(p=!0);const w=_.constantOr(null);w&&(p=!0,l[w.to]=!0,l[w.from]=!0)}return p}function km(r,i,s,l,p){const y=p.patternDependencies;for(const _ of i){const w=_.paint.get(`${r}-pattern`).value;if(w.kind!=="constant"){let S=w.evaluate({zoom:l-1},s,{},p.availableImages),C=w.evaluate({zoom:l},s,{},p.availableImages),P=w.evaluate({zoom:l+1},s,{},p.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,P=P&&P.name?P.name:P,y[S]=!0,y[C]=!0,y[P]=!0,s.patterns[_.id]={min:S,mid:C,max:P}}}return s}class Cm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Mr,this.indexArray=new hr,this.indexArray2=new Ri,this.programConfigurations=new Fo(i.layers,i.zoom),this.segments=new It,this.segments2=new It,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,l){this.hasPattern=Tm("fill",this.layers,s);const p=this.layers[0].layout.get("fill-sort-key"),y=!p.isConstant(),_=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:P}of i){const M=this.layers[0]._featureFilter.needGeometry,R=jo(w,M);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),R,l))continue;const j=y?p.evaluate(R,{},l,s.availableImages):void 0,U={id:S,properties:w.properties,type:w.type,sourceLayerIndex:P,index:C,geometry:M?R.geometry:Oo(w),patterns:{},sortKey:j};_.push(U)}y&&_.sort((w,S)=>w.sortKey-S.sortKey);for(const w of _){const{geometry:S,index:C,sourceLayerIndex:P}=w;if(this.hasPattern){const M=km("fill",this.layers,w,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(w,S,C,l,{});s.featureIndex.insert(i[C].feature,S,C,P,this.index)}}update(i,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,l)}addFeatures(i,s,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ZT),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,s,l,p,y){for(const _ of yl(s,500)){let w=0;for(const j of _)w+=j.length;const S=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),C=S.vertexLength,P=[],M=[];for(const j of _){if(j.length===0)continue;j!==_[0]&&M.push(P.length/2);const U=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),$=U.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack($+j.length-1,$),P.push(j[0].x),P.push(j[0].y);for(let Y=1;Y<j.length;Y++)this.layoutVertexArray.emplaceBack(j[Y].x,j[Y].y),this.indexArray2.emplaceBack($+Y-1,$+Y),P.push(j[Y].x),P.push(j[Y].y);U.vertexLength+=j.length,U.primitiveLength+=j.length}const R=Kv(P,M);for(let j=0;j<R.length;j+=3)this.indexArray.emplaceBack(C+R[j],C+R[j+1],C+R[j+2]);S.vertexLength+=w,S.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,y,p)}}let tx,ix;Ke("FillBucket",Cm,{omit:["layers","patternFeatures"]});var nk={get paint(){return ix=ix||new m({"fill-antialias":new Je(we.paint_fill["fill-antialias"]),"fill-opacity":new ht(we.paint_fill["fill-opacity"]),"fill-color":new ht(we.paint_fill["fill-color"]),"fill-outline-color":new ht(we.paint_fill["fill-outline-color"]),"fill-translate":new Je(we.paint_fill["fill-translate"]),"fill-translate-anchor":new Je(we.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fl(we.paint_fill["fill-pattern"])})},get layout(){return tx=tx||new m({"fill-sort-key":new ht(we.layout_fill["fill-sort-key"])})}};class rk extends a{constructor(i){super(i,nk)}recalculate(i,s){super.recalculate(i,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Cm(i)}queryRadius(){return jd(this.paint.get("fill-translate"))}queryIntersectsFeature(i,s,l,p,y,_,w){return Ov(Vd(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,w),p)}isTileClipped(){return!0}}const sk=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),ak=b([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ok}=sk;var Da={},lk=D,nx=Wl;function Wl(r,i,s,l,p){this.properties={},this.extent=s,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=p,r.readFields(ck,this,i)}function ck(r,i,s){r==1?i.id=s.readVarint():r==2?function(l,p){for(var y=l.readVarint()+l.pos;l.pos<y;){var _=p._keys[l.readVarint()],w=p._values[l.readVarint()];p.properties[_]=w}}(s,i):r==3?i.type=s.readVarint():r==4&&(i._geometry=s.pos)}function uk(r){for(var i,s,l=0,p=0,y=r.length,_=y-1;p<y;_=p++)l+=((s=r[_]).x-(i=r[p]).x)*(i.y+s.y);return l}Wl.types=["Unknown","Point","LineString","Polygon"],Wl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var i,s=r.readVarint()+r.pos,l=1,p=0,y=0,_=0,w=[];r.pos<s;){if(p<=0){var S=r.readVarint();l=7&S,p=S>>3}if(p--,l===1||l===2)y+=r.readSVarint(),_+=r.readSVarint(),l===1&&(i&&w.push(i),i=[]),i.push(new lk(y,_));else{if(l!==7)throw new Error("unknown command "+l);i&&i.push(i[0].clone())}}return i&&w.push(i),w},Wl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var i=r.readVarint()+r.pos,s=1,l=0,p=0,y=0,_=1/0,w=-1/0,S=1/0,C=-1/0;r.pos<i;){if(l<=0){var P=r.readVarint();s=7&P,l=P>>3}if(l--,s===1||s===2)(p+=r.readSVarint())<_&&(_=p),p>w&&(w=p),(y+=r.readSVarint())<S&&(S=y),y>C&&(C=y);else if(s!==7)throw new Error("unknown command "+s)}return[_,S,w,C]},Wl.prototype.toGeoJSON=function(r,i,s){var l,p,y=this.extent*Math.pow(2,s),_=this.extent*r,w=this.extent*i,S=this.loadGeometry(),C=Wl.types[this.type];function P(j){for(var U=0;U<j.length;U++){var $=j[U];j[U]=[360*($.x+_)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+w)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(l=0;l<S.length;l++)M[l]=S[l][0];P(S=M);break;case 2:for(l=0;l<S.length;l++)P(S[l]);break;case 3:for(S=function(j){var U=j.length;if(U<=1)return[j];for(var $,Y,te=[],me=0;me<U;me++){var oe=uk(j[me]);oe!==0&&(Y===void 0&&(Y=oe<0),Y===oe<0?($&&te.push($),$=[j[me]]):$.push(j[me]))}return $&&te.push($),te}(S),l=0;l<S.length;l++)for(p=0;p<S[l].length;p++)P(S[l][p])}S.length===1?S=S[0]:C="Multi"+C;var R={type:"Feature",geometry:{type:C,coordinates:S},properties:this.properties};return"id"in this&&(R.id=this.id),R};var hk=nx,rx=sx;function sx(r,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(dk,this,i),this.length=this._features.length}function dk(r,i,s){r===15?i.version=s.readVarint():r===1?i.name=s.readString():r===5?i.extent=s.readVarint():r===2?i._features.push(s.pos):r===3?i._keys.push(s.readString()):r===4&&i._values.push(function(l){for(var p=null,y=l.readVarint()+l.pos;l.pos<y;){var _=l.readVarint()>>3;p=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return p}(s))}sx.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var i=this._pbf.readVarint()+this._pbf.pos;return new hk(this._pbf,i,this.extent,this._keys,this._values)};var pk=rx;function fk(r,i,s){if(r===3){var l=new pk(s,s.readVarint()+s.pos);l.length&&(i[l.name]=l)}}Da.VectorTile=function(r,i){this.layers=r.readFields(fk,{},i)},Da.VectorTileFeature=nx,Da.VectorTileLayer=rx;const mk=Da.VectorTileFeature.types,Pm=Math.pow(2,13);function ju(r,i,s,l,p,y,_,w){r.emplaceBack(i,s,2*Math.floor(l*Pm)+_,p*Pm*2,y*Pm*2,Math.round(w))}class Im{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Pa,this.centroidVertexArray=new Gi,this.indexArray=new hr,this.programConfigurations=new Fo(i.layers,i.zoom),this.segments=new It,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,l){this.features=[],this.hasPattern=Tm("fill-extrusion",this.layers,s);for(const{feature:p,id:y,index:_,sourceLayerIndex:w}of i){const S=this.layers[0]._featureFilter.needGeometry,C=jo(p,S);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),C,l))continue;const P={id:y,sourceLayerIndex:w,index:_,geometry:S?C.geometry:Oo(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(km("fill-extrusion",this.layers,P,this.zoom,s)):this.addFeature(P,P.geometry,_,l,{}),s.featureIndex.insert(p,P.geometry,_,w,this.index,!0)}}addFeatures(i,s,l){for(const p of this.features){const{geometry:y}=p;this.addFeature(p,y,p.index,s,l)}}update(i,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ok),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,ak.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,s,l,p,y){for(const _ of yl(s,500)){const w={x:0,y:0,vertexCount:0};let S=0;for(const U of _)S+=U.length;let C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const U of _){if(U.length===0||yk(U))continue;let $=0;for(let Y=0;Y<U.length;Y++){const te=U[Y];if(Y>=1){const me=U[Y-1];if(!gk(te,me)){C.vertexLength+4>It.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const oe=te.sub(me)._perp()._unit(),pe=me.dist(te);$+pe>32768&&($=0),ju(this.layoutVertexArray,te.x,te.y,oe.x,oe.y,0,0,$),ju(this.layoutVertexArray,te.x,te.y,oe.x,oe.y,0,1,$),w.x+=2*te.x,w.y+=2*te.y,w.vertexCount+=2,$+=pe,ju(this.layoutVertexArray,me.x,me.y,oe.x,oe.y,0,0,$),ju(this.layoutVertexArray,me.x,me.y,oe.x,oe.y,0,1,$),w.x+=2*me.x,w.y+=2*me.y,w.vertexCount+=2;const be=C.vertexLength;this.indexArray.emplaceBack(be,be+2,be+1),this.indexArray.emplaceBack(be+1,be+2,be+3),C.vertexLength+=4,C.primitiveLength+=2}}}}if(C.vertexLength+S>It.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),mk[i.type]!=="Polygon")continue;const P=[],M=[],R=C.vertexLength;for(const U of _)if(U.length!==0){U!==_[0]&&M.push(P.length/2);for(let $=0;$<U.length;$++){const Y=U[$];ju(this.layoutVertexArray,Y.x,Y.y,0,0,1,1,0),w.x+=Y.x,w.y+=Y.y,w.vertexCount+=1,P.push(Y.x),P.push(Y.y)}}const j=Kv(P,M);for(let U=0;U<j.length;U+=3)this.indexArray.emplaceBack(R+j[U],R+j[U+2],R+j[U+1]);C.primitiveLength+=j.length/3,C.vertexLength+=S;for(let U=0;U<w.vertexCount;U++){const $=Math.floor(w.x/w.vertexCount),Y=Math.floor(w.y/w.vertexCount);this.centroidVertexArray.emplaceBack($,Y)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,y,p)}}function gk(r,i){return r.x===i.x&&(r.x<0||r.x>bi)||r.y===i.y&&(r.y<0||r.y>bi)}function yk(r){return r.every(i=>i.x<0)||r.every(i=>i.x>bi)||r.every(i=>i.y<0)||r.every(i=>i.y>bi)}let ax;Ke("FillExtrusionBucket",Im,{omit:["layers","features"]});var _k={get paint(){return ax=ax||new m({"fill-extrusion-opacity":new Je(we["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ht(we["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Je(we["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Je(we["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fl(we["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ht(we["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ht(we["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Je(we["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class vk extends a{constructor(i){super(i,_k)}createBucket(i){return new Im(i)}queryRadius(){return jd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,s,l,p,y,_,w,S){const C=Vd(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,w),P=this.paint.get("fill-extrusion-height").evaluate(s,l),M=this.paint.get("fill-extrusion-base").evaluate(s,l),R=function(U,$,Y,te){const me=[];for(const oe of U){const pe=[oe.x,oe.y,0,1];Nd(pe,pe,$),me.push(new L(pe[0]/pe[3],pe[1]/pe[3]))}return me}(C,S),j=function(U,$,Y,te){const me=[],oe=[],pe=te[8]*$,be=te[9]*$,ze=te[10]*$,Ze=te[11]*$,ct=te[8]*Y,He=te[9]*Y,Ue=te[10]*Y,tt=te[11]*Y;for(const Ye of U){const Xe=[],Pe=[];for(const it of Ye){const et=it.x,gt=it.y,Ht=te[0]*et+te[4]*gt+te[12],Gt=te[1]*et+te[5]*gt+te[13],Ai=te[2]*et+te[6]*gt+te[14],Er=te[3]*et+te[7]*gt+te[15],Zi=Ai+ze,Mi=Er+Ze,yn=Ht+ct,_n=Gt+He,vn=Ai+Ue,hi=Er+tt,Ei=new L((Ht+pe)/Mi,(Gt+be)/Mi);Ei.z=Zi/Mi,Xe.push(Ei);const nn=new L(yn/hi,_n/hi);nn.z=vn/hi,Pe.push(nn)}me.push(Xe),oe.push(Pe)}return[me,oe]}(p,M,P,S);return function(U,$,Y){let te=1/0;Ov(Y,$)&&(te=ox(Y,$[0]));for(let me=0;me<$.length;me++){const oe=$[me],pe=U[me];for(let be=0;be<oe.length-1;be++){const ze=oe[be],Ze=[ze,oe[be+1],pe[be+1],pe[be],ze];Fv(Y,Ze)&&(te=Math.min(te,ox(Y,Ze)))}}return te!==1/0&&te}(j[0],j[1],R)}}function Vu(r,i){return r.x*i.x+r.y*i.y}function ox(r,i){if(r.length===1){let s=0;const l=i[s++];let p;for(;!p||l.equals(p);)if(p=i[s++],!p)return 1/0;for(;s<i.length;s++){const y=i[s],_=r[0],w=p.sub(l),S=y.sub(l),C=_.sub(l),P=Vu(w,w),M=Vu(w,S),R=Vu(S,S),j=Vu(C,w),U=Vu(C,S),$=P*R-M*M,Y=(R*j-M*U)/$,te=(P*U-M*j)/$,me=l.z*(1-Y-te)+p.z*Y+y.z*te;if(isFinite(me))return me}return 1/0}{let s=1/0;for(const l of i)s=Math.min(s,l.z);return s}}const xk=b([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:wk}=xk,bk=b([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Sk}=bk,Tk=Da.VectorTileFeature.types,kk=Math.cos(Math.PI/180*37.5),lx=Math.pow(2,14)/.5;class Am{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new jl,this.layoutVertexArray2=new Ia,this.indexArray=new hr,this.programConfigurations=new Fo(i.layers,i.zoom),this.segments=new It,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,l){this.hasPattern=Tm("line",this.layers,s);const p=this.layers[0].layout.get("line-sort-key"),y=!p.isConstant(),_=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:P}of i){const M=this.layers[0]._featureFilter.needGeometry,R=jo(w,M);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),R,l))continue;const j=y?p.evaluate(R,{},l):void 0,U={id:S,properties:w.properties,type:w.type,sourceLayerIndex:P,index:C,geometry:M?R.geometry:Oo(w),patterns:{},sortKey:j};_.push(U)}y&&_.sort((w,S)=>w.sortKey-S.sortKey);for(const w of _){const{geometry:S,index:C,sourceLayerIndex:P}=w;if(this.hasPattern){const M=km("line",this.layers,w,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(w,S,C,l,{});s.featureIndex.insert(i[C].feature,S,C,P,this.index)}}update(i,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,l)}addFeatures(i,s,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Sk)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,wk),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,s,l,p,y){const _=this.layers[0].layout,w=_.get("line-join").evaluate(i,{}),S=_.get("line-cap"),C=_.get("line-miter-limit"),P=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const M of s)this.addLine(M,i,w,S,C,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,y,p)}addLine(i,s,l,p,y,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let te=0;te<i.length-1;te++)this.totalDistance+=i[te].dist(i[te+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=Tk[s.type]==="Polygon";let S=i.length;for(;S>=2&&i[S-1].equals(i[S-2]);)S--;let C=0;for(;C<S-1&&i[C].equals(i[C+1]);)C++;if(S<(w?3:2))return;l==="bevel"&&(y=1.05);const P=this.overscaling<=16?15*bi/(512*this.overscaling):0,M=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let R,j,U,$,Y;this.e1=this.e2=-1,w&&(R=i[S-2],Y=i[C].sub(R)._unit()._perp());for(let te=C;te<S;te++){if(U=te===S-1?w?i[C+1]:void 0:i[te+1],U&&i[te].equals(U))continue;Y&&($=Y),R&&(j=R),R=i[te],Y=U?U.sub(R)._unit()._perp():$,$=$||Y;let me=$.add(Y);me.x===0&&me.y===0||me._unit();const oe=$.x*Y.x+$.y*Y.y,pe=me.x*Y.x+me.y*Y.y,be=pe!==0?1/pe:1/0,ze=2*Math.sqrt(2-2*pe),Ze=pe<kk&&j&&U,ct=$.x*Y.y-$.y*Y.x>0;if(Ze&&te>C){const tt=R.dist(j);if(tt>2*P){const Ye=R.sub(R.sub(j)._mult(P/tt)._round());this.updateDistance(j,Ye),this.addCurrentVertex(Ye,$,0,0,M),j=Ye}}const He=j&&U;let Ue=He?l:w?"butt":p;if(He&&Ue==="round"&&(be<_?Ue="miter":be<=2&&(Ue="fakeround")),Ue==="miter"&&be>y&&(Ue="bevel"),Ue==="bevel"&&(be>2&&(Ue="flipbevel"),be<y&&(Ue="miter")),j&&this.updateDistance(j,R),Ue==="miter")me._mult(be),this.addCurrentVertex(R,me,0,0,M);else if(Ue==="flipbevel"){if(be>100)me=Y.mult(-1);else{const tt=be*$.add(Y).mag()/$.sub(Y).mag();me._perp()._mult(tt*(ct?-1:1))}this.addCurrentVertex(R,me,0,0,M),this.addCurrentVertex(R,me.mult(-1),0,0,M)}else if(Ue==="bevel"||Ue==="fakeround"){const tt=-Math.sqrt(be*be-1),Ye=ct?tt:0,Xe=ct?0:tt;if(j&&this.addCurrentVertex(R,$,Ye,Xe,M),Ue==="fakeround"){const Pe=Math.round(180*ze/Math.PI/20);for(let it=1;it<Pe;it++){let et=it/Pe;if(et!==.5){const Ht=et-.5;et+=et*Ht*(et-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*Ht*Ht+(.848013+oe*(.215638*oe-1.06021)))}const gt=Y.sub($)._mult(et)._add($)._unit()._mult(ct?-1:1);this.addHalfVertex(R,gt.x,gt.y,!1,ct,0,M)}}U&&this.addCurrentVertex(R,Y,-Ye,-Xe,M)}else if(Ue==="butt")this.addCurrentVertex(R,me,0,0,M);else if(Ue==="square"){const tt=j?1:-1;this.addCurrentVertex(R,me,tt,tt,M)}else Ue==="round"&&(j&&(this.addCurrentVertex(R,$,0,0,M),this.addCurrentVertex(R,$,1,1,M,!0)),U&&(this.addCurrentVertex(R,Y,-1,-1,M,!0),this.addCurrentVertex(R,Y,0,0,M)));if(Ze&&te<S-1){const tt=R.dist(U);if(tt>2*P){const Ye=R.add(U.sub(R)._mult(P/tt)._round());this.updateDistance(R,Ye),this.addCurrentVertex(Ye,Y,0,0,M),R=Ye}}}}addCurrentVertex(i,s,l,p,y,_=!1){const w=s.y*p-s.x,S=-s.y-s.x*p;this.addHalfVertex(i,s.x+s.y*l,s.y-s.x*l,_,!1,l,y),this.addHalfVertex(i,w,S,_,!0,-p,y),this.distance>lx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,s,l,p,y,_))}addHalfVertex({x:i,y:s},l,p,y,_,w,S){const C=.5*(this.lineClips?this.scaledDistance*(lx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(y?1:0),(s<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*p)+128,1+(w===0?0:w<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),S.primitiveLength++),_?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,s){this.distance+=i.dist(s),this.updateScaledDistance()}}let cx,ux;Ke("LineBucket",Am,{omit:["layers","patternFeatures"]});var hx={get paint(){return ux=ux||new m({"line-opacity":new ht(we.paint_line["line-opacity"]),"line-color":new ht(we.paint_line["line-color"]),"line-translate":new Je(we.paint_line["line-translate"]),"line-translate-anchor":new Je(we.paint_line["line-translate-anchor"]),"line-width":new ht(we.paint_line["line-width"]),"line-gap-width":new ht(we.paint_line["line-gap-width"]),"line-offset":new ht(we.paint_line["line-offset"]),"line-blur":new ht(we.paint_line["line-blur"]),"line-dasharray":new Ol(we.paint_line["line-dasharray"]),"line-pattern":new Fl(we.paint_line["line-pattern"]),"line-gradient":new Mu(we.paint_line["line-gradient"])})},get layout(){return cx=cx||new m({"line-cap":new Je(we.layout_line["line-cap"]),"line-join":new ht(we.layout_line["line-join"]),"line-miter-limit":new Je(we.layout_line["line-miter-limit"]),"line-round-limit":new Je(we.layout_line["line-round-limit"]),"line-sort-key":new ht(we.layout_line["line-sort-key"])})}};class Ck extends ht{possiblyEvaluate(i,s){return s=new Kt(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(i,s)}evaluate(i,s,l,p){return s=Ae({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(i,s,l,p)}}let Hd;class Pk extends a{constructor(i){super(i,hx),this.gradientVersion=0,Hd||(Hd=new Ck(hx.paint.properties["line-width"].specification),Hd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof ca,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,s){super.recalculate(i,s),this.paint._values["line-floorwidth"]=Hd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Am(i)}queryRadius(i){const s=i,l=dx(Du("line-width",this,s),Du("line-gap-width",this,s)),p=Du("line-offset",this,s);return l/2+Math.abs(p)+jd(this.paint.get("line-translate"))}queryIntersectsFeature(i,s,l,p,y,_,w){const S=Vd(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,w),C=w/2*dx(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),P=this.paint.get("line-offset").evaluate(s,l);return P&&(p=function(M,R){const j=[];for(let U=0;U<M.length;U++){const $=M[U],Y=[];for(let te=0;te<$.length;te++){const me=$[te-1],oe=$[te],pe=$[te+1],be=te===0?new L(0,0):oe.sub(me)._unit()._perp(),ze=te===$.length-1?new L(0,0):pe.sub(oe)._unit()._perp(),Ze=be._add(ze)._unit(),ct=Ze.x*ze.x+Ze.y*ze.y;ct!==0&&Ze._mult(1/ct),Y.push(Ze._mult(R)._add(oe))}j.push(Y)}return j}(p,P*w)),function(M,R,j){for(let U=0;U<R.length;U++){const $=R[U];if(M.length>=3){for(let Y=0;Y<$.length;Y++)if(Hl(M,$[Y]))return!0}if(BT(M,$,j))return!0}return!1}(S,p,C)}isTileClipped(){return!0}}function dx(r,i){return i>0?i+2*r:r}const Ik=b([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ak=b([{name:"a_projected_pos",components:3,type:"Float32"}],4);b([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Mk=b([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);b([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const px=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ek=b([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zk(r,i,s){return r.sections.forEach(l=>{l.text=function(p,y,_){const w=y.layout.get("text-transform").evaluate(_,{});return w==="uppercase"?p=p.toLocaleUpperCase():w==="lowercase"&&(p=p.toLocaleLowerCase()),Mn.applyArabicShaping&&(p=Mn.applyArabicShaping(p)),p}(l.text,i,s)}),r}b([{name:"triangle",components:3,type:"Uint16"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),b([{type:"Float32",name:"offsetX"}]),b([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),b([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Nu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ki=24,fx=$t,mx=function(r,i,s,l,p){var y,_,w=8*p-l-1,S=(1<<w)-1,C=S>>1,P=-7,M=p-1,R=-1,j=r[i+M];for(M+=R,y=j&(1<<-P)-1,j>>=-P,P+=w;P>0;y=256*y+r[i+M],M+=R,P-=8);for(_=y&(1<<-P)-1,y>>=-P,P+=l;P>0;_=256*_+r[i+M],M+=R,P-=8);if(y===0)y=1-C;else{if(y===S)return _?NaN:1/0*(j?-1:1);_+=Math.pow(2,l),y-=C}return(j?-1:1)*_*Math.pow(2,y-l)},gx=function(r,i,s,l,p,y){var _,w,S,C=8*y-p-1,P=(1<<C)-1,M=P>>1,R=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=0,U=1,$=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(w=isNaN(i)?1:0,_=P):(_=Math.floor(Math.log(i)/Math.LN2),i*(S=Math.pow(2,-_))<1&&(_--,S*=2),(i+=_+M>=1?R/S:R*Math.pow(2,1-M))*S>=2&&(_++,S/=2),_+M>=P?(w=0,_=P):_+M>=1?(w=(i*S-1)*Math.pow(2,p),_+=M):(w=i*Math.pow(2,M-1)*Math.pow(2,p),_=0));p>=8;r[s+j]=255&w,j+=U,w/=256,p-=8);for(_=_<<p|w,C+=p;C>0;r[s+j]=255&_,j+=U,_/=256,C-=8);r[s+j-U]|=128*$};function $t(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}$t.Varint=0,$t.Fixed64=1,$t.Bytes=2,$t.Fixed32=5;var Mm=4294967296,yx=1/Mm,_x=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function $s(r){return r.type===$t.Bytes?r.readVarint()+r.pos:r.pos+1}function Xl(r,i,s){return s?4294967296*i+(r>>>0):4294967296*(i>>>0)+(r>>>0)}function vx(r,i,s){var l=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));s.realloc(l);for(var p=s.pos-1;p>=r;p--)s.buf[p+l]=s.buf[p]}function Dk(r,i){for(var s=0;s<r.length;s++)i.writeVarint(r[s])}function Lk(r,i){for(var s=0;s<r.length;s++)i.writeSVarint(r[s])}function Rk(r,i){for(var s=0;s<r.length;s++)i.writeFloat(r[s])}function Bk(r,i){for(var s=0;s<r.length;s++)i.writeDouble(r[s])}function Fk(r,i){for(var s=0;s<r.length;s++)i.writeBoolean(r[s])}function Ok(r,i){for(var s=0;s<r.length;s++)i.writeFixed32(r[s])}function jk(r,i){for(var s=0;s<r.length;s++)i.writeSFixed32(r[s])}function Vk(r,i){for(var s=0;s<r.length;s++)i.writeFixed64(r[s])}function Nk(r,i){for(var s=0;s<r.length;s++)i.writeSFixed64(r[s])}function qd(r,i){return(r[i]|r[i+1]<<8|r[i+2]<<16)+16777216*r[i+3]}function Kl(r,i,s){r[s]=i,r[s+1]=i>>>8,r[s+2]=i>>>16,r[s+3]=i>>>24}function xx(r,i){return(r[i]|r[i+1]<<8|r[i+2]<<16)+(r[i+3]<<24)}$t.prototype={destroy:function(){this.buf=null},readFields:function(r,i,s){for(s=s||this.length;this.pos<s;){var l=this.readVarint(),p=l>>3,y=this.pos;this.type=7&l,r(p,i,this),this.pos===y&&this.skip(l)}return i},readMessage:function(r,i){return this.readFields(r,i,this.readVarint()+this.pos)},readFixed32:function(){var r=qd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=xx(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=qd(this.buf,this.pos)+qd(this.buf,this.pos+4)*Mm;return this.pos+=8,r},readSFixed64:function(){var r=qd(this.buf,this.pos)+xx(this.buf,this.pos+4)*Mm;return this.pos+=8,r},readFloat:function(){var r=mx(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=mx(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var i,s,l=this.buf;return i=127&(s=l[this.pos++]),s<128?i:(i|=(127&(s=l[this.pos++]))<<7,s<128?i:(i|=(127&(s=l[this.pos++]))<<14,s<128?i:(i|=(127&(s=l[this.pos++]))<<21,s<128?i:function(p,y,_){var w,S,C=_.buf;if(w=(112&(S=C[_.pos++]))>>4,S<128||(w|=(127&(S=C[_.pos++]))<<3,S<128)||(w|=(127&(S=C[_.pos++]))<<10,S<128)||(w|=(127&(S=C[_.pos++]))<<17,S<128)||(w|=(127&(S=C[_.pos++]))<<24,S<128)||(w|=(1&(S=C[_.pos++]))<<31,S<128))return Xl(p,w,y);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(s=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,i=this.pos;return this.pos=r,r-i>=12&&_x?function(s,l,p){return _x.decode(s.subarray(l,p))}(this.buf,i,r):function(s,l,p){for(var y="",_=l;_<p;){var w,S,C,P=s[_],M=null,R=P>239?4:P>223?3:P>191?2:1;if(_+R>p)break;R===1?P<128&&(M=P):R===2?(192&(w=s[_+1]))==128&&(M=(31&P)<<6|63&w)<=127&&(M=null):R===3?(S=s[_+2],(192&(w=s[_+1]))==128&&(192&S)==128&&((M=(15&P)<<12|(63&w)<<6|63&S)<=2047||M>=55296&&M<=57343)&&(M=null)):R===4&&(S=s[_+2],C=s[_+3],(192&(w=s[_+1]))==128&&(192&S)==128&&(192&C)==128&&((M=(15&P)<<18|(63&w)<<12|(63&S)<<6|63&C)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,R=1):M>65535&&(M-=65536,y+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),y+=String.fromCharCode(M),_+=R}return y}(this.buf,i,r)},readBytes:function(){var r=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,r);return this.pos=r,i},readPackedVarint:function(r,i){if(this.type!==$t.Bytes)return r.push(this.readVarint(i));var s=$s(this);for(r=r||[];this.pos<s;)r.push(this.readVarint(i));return r},readPackedSVarint:function(r){if(this.type!==$t.Bytes)return r.push(this.readSVarint());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==$t.Bytes)return r.push(this.readBoolean());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==$t.Bytes)return r.push(this.readFloat());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==$t.Bytes)return r.push(this.readDouble());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==$t.Bytes)return r.push(this.readFixed32());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==$t.Bytes)return r.push(this.readSFixed32());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==$t.Bytes)return r.push(this.readFixed64());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==$t.Bytes)return r.push(this.readSFixed64());var i=$s(this);for(r=r||[];this.pos<i;)r.push(this.readSFixed64());return r},skip:function(r){var i=7&r;if(i===$t.Varint)for(;this.buf[this.pos++]>127;);else if(i===$t.Bytes)this.pos=this.readVarint()+this.pos;else if(i===$t.Fixed32)this.pos+=4;else{if(i!==$t.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(r,i){this.writeVarint(r<<3|i)},realloc:function(r){for(var i=this.length||16;i<this.pos+r;)i*=2;if(i!==this.length){var s=new Uint8Array(i);s.set(this.buf),this.buf=s,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Kl(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Kl(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Kl(this.buf,-1&r,this.pos),Kl(this.buf,Math.floor(r*yx),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Kl(this.buf,-1&r,this.pos),Kl(this.buf,Math.floor(r*yx),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(i,s){var l,p;if(i>=0?(l=i%4294967296|0,p=i/4294967296|0):(p=~(-i/4294967296),4294967295^(l=~(-i%4294967296))?l=l+1|0:(l=0,p=p+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(y,_,w){w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,w.buf[w.pos]=127&(y>>>=7)}(l,0,s),function(y,_){var w=(7&y)<<4;_.buf[_.pos++]|=w|((y>>>=3)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y)))))}(p,s)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var i=this.pos;this.pos=function(l,p,y){for(var _,w,S=0;S<p.length;S++){if((_=p.charCodeAt(S))>55295&&_<57344){if(!w){_>56319||S+1===p.length?(l[y++]=239,l[y++]=191,l[y++]=189):w=_;continue}if(_<56320){l[y++]=239,l[y++]=191,l[y++]=189,w=_;continue}_=w-55296<<10|_-56320|65536,w=null}else w&&(l[y++]=239,l[y++]=191,l[y++]=189,w=null);_<128?l[y++]=_:(_<2048?l[y++]=_>>6|192:(_<65536?l[y++]=_>>12|224:(l[y++]=_>>18|240,l[y++]=_>>12&63|128),l[y++]=_>>6&63|128),l[y++]=63&_|128)}return y}(this.buf,r,this.pos);var s=this.pos-i;s>=128&&vx(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeFloat:function(r){this.realloc(4),gx(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),gx(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var i=r.length;this.writeVarint(i),this.realloc(i);for(var s=0;s<i;s++)this.buf[this.pos++]=r[s]},writeRawMessage:function(r,i){this.pos++;var s=this.pos;r(i,this);var l=this.pos-s;l>=128&&vx(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,i,s){this.writeTag(r,$t.Bytes),this.writeRawMessage(i,s)},writePackedVarint:function(r,i){i.length&&this.writeMessage(r,Dk,i)},writePackedSVarint:function(r,i){i.length&&this.writeMessage(r,Lk,i)},writePackedBoolean:function(r,i){i.length&&this.writeMessage(r,Fk,i)},writePackedFloat:function(r,i){i.length&&this.writeMessage(r,Rk,i)},writePackedDouble:function(r,i){i.length&&this.writeMessage(r,Bk,i)},writePackedFixed32:function(r,i){i.length&&this.writeMessage(r,Ok,i)},writePackedSFixed32:function(r,i){i.length&&this.writeMessage(r,jk,i)},writePackedFixed64:function(r,i){i.length&&this.writeMessage(r,Vk,i)},writePackedSFixed64:function(r,i){i.length&&this.writeMessage(r,Nk,i)},writeBytesField:function(r,i){this.writeTag(r,$t.Bytes),this.writeBytes(i)},writeFixed32Field:function(r,i){this.writeTag(r,$t.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(r,i){this.writeTag(r,$t.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(r,i){this.writeTag(r,$t.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(r,i){this.writeTag(r,$t.Fixed64),this.writeSFixed64(i)},writeVarintField:function(r,i){this.writeTag(r,$t.Varint),this.writeVarint(i)},writeSVarintField:function(r,i){this.writeTag(r,$t.Varint),this.writeSVarint(i)},writeStringField:function(r,i){this.writeTag(r,$t.Bytes),this.writeString(i)},writeFloatField:function(r,i){this.writeTag(r,$t.Fixed32),this.writeFloat(i)},writeDoubleField:function(r,i){this.writeTag(r,$t.Fixed64),this.writeDouble(i)},writeBooleanField:function(r,i){this.writeVarintField(r,!!i)}};var Em=A(fx);const zm=3;function Uk(r,i,s){r===1&&s.readMessage($k,i)}function $k(r,i,s){if(r===3){const{id:l,bitmap:p,width:y,height:_,left:w,top:S,advance:C}=s.readMessage(Gk,{});i.push({id:l,bitmap:new Ru({width:y+2*zm,height:_+2*zm},p),metrics:{width:y,height:_,left:w,top:S,advance:C}})}}function Gk(r,i,s){r===1?i.id=s.readVarint():r===2?i.bitmap=s.readBytes():r===3?i.width=s.readVarint():r===4?i.height=s.readVarint():r===5?i.left=s.readSVarint():r===6?i.top=s.readSVarint():r===7&&(i.advance=s.readVarint())}const wx=zm;function bx(r){let i=0,s=0;for(const _ of r)i+=_.w*_.h,s=Math.max(s,_.w);r.sort((_,w)=>w.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),s),h:1/0}];let p=0,y=0;for(const _ of r)for(let w=l.length-1;w>=0;w--){const S=l[w];if(!(_.w>S.w||_.h>S.h)){if(_.x=S.x,_.y=S.y,y=Math.max(y,_.y+_.h),p=Math.max(p,_.x+_.w),_.w===S.w&&_.h===S.h){const C=l.pop();w<l.length&&(l[w]=C)}else _.h===S.h?(S.x+=_.w,S.w-=_.w):_.w===S.w?(S.y+=_.h,S.h-=_.h):(l.push({x:S.x+_.w,y:S.y,w:S.w-_.w,h:_.h}),S.y+=_.h,S.h-=_.h);break}}return{w:p,h:y,fill:i/(p*y)||0}}const zn=1;class Dm{constructor(i,{pixelRatio:s,version:l,stretchX:p,stretchY:y,content:_,textFitWidth:w,textFitHeight:S}){this.paddedRect=i,this.pixelRatio=s,this.stretchX=p,this.stretchY=y,this.content=_,this.version=l,this.textFitWidth=w,this.textFitHeight=S}get tl(){return[this.paddedRect.x+zn,this.paddedRect.y+zn]}get br(){return[this.paddedRect.x+this.paddedRect.w-zn,this.paddedRect.y+this.paddedRect.h-zn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*zn)/this.pixelRatio,(this.paddedRect.h-2*zn)/this.pixelRatio]}}class Sx{constructor(i,s){const l={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(i,l,y),this.addImages(s,p,y);const{w:_,h:w}=bx(y),S=new dr({width:_||1,height:w||1});for(const C in i){const P=i[C],M=l[C].paddedRect;dr.copy(P.data,S,{x:0,y:0},{x:M.x+zn,y:M.y+zn},P.data)}for(const C in s){const P=s[C],M=p[C].paddedRect,R=M.x+zn,j=M.y+zn,U=P.data.width,$=P.data.height;dr.copy(P.data,S,{x:0,y:0},{x:R,y:j},P.data),dr.copy(P.data,S,{x:0,y:$-1},{x:R,y:j-1},{width:U,height:1}),dr.copy(P.data,S,{x:0,y:0},{x:R,y:j+$},{width:U,height:1}),dr.copy(P.data,S,{x:U-1,y:0},{x:R-1,y:j},{width:1,height:$}),dr.copy(P.data,S,{x:0,y:0},{x:R+U,y:j},{width:1,height:$})}this.image=S,this.iconPositions=l,this.patternPositions=p}addImages(i,s,l){for(const p in i){const y=i[p],_={x:0,y:0,w:y.data.width+2*zn,h:y.data.height+2*zn};l.push(_),s[p]=new Dm(_,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(i,s){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in i.updatedImages)this.patchUpdatedImage(this.iconPositions[l],i.getImage(l),s),this.patchUpdatedImage(this.patternPositions[l],i.getImage(l),s)}patchUpdatedImage(i,s,l){if(!i||!s||i.version===s.version)return;i.version=s.version;const[p,y]=i.tl;l.update(s.data,void 0,{x:p,y})}}var La;Ke("ImagePosition",Dm),Ke("ImageAtlas",Sx),v.ah=void 0,(La=v.ah||(v.ah={}))[La.none=0]="none",La[La.horizontal=1]="horizontal",La[La.vertical=2]="vertical",La[La.horizontalOnly=3]="horizontalOnly";const Uu=-17;class $u{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,s){const l=new $u;return l.scale=i||1,l.fontStack=s,l}static forImage(i){const s=new $u;return s.imageName=i,s}}class Yl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,s){const l=new Yl;for(let p=0;p<i.sections.length;p++){const y=i.sections[p];y.image?l.addImageSection(y):l.addTextSection(y,s)}return l}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let s="";for(let l=0;l<i.length;l++){const p=i.charCodeAt(l+1)||null,y=i.charCodeAt(l-1)||null;s+=p&&zd(p)&&!Nu[i[l+1]]||y&&zd(y)&&!Nu[i[l-1]]||!Nu[i[l]]?i[l]:Nu[i[l]]}return s}(this.text)}trim(){let i=0;for(let l=0;l<this.text.length&&Wd[this.text.charCodeAt(l)];l++)i++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=i&&Wd[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(i,s),this.sectionIndex=this.sectionIndex.slice(i,s)}substring(i,s){const l=new Yl;return l.text=this.text.substring(i,s),l.sectionIndex=this.sectionIndex.slice(i,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,s)=>Math.max(i,this.sections[s].scale),0)}addTextSection(i,s){this.text+=i.text,this.sections.push($u.forText(i.scale,i.fontStack||s));const l=this.sections.length-1;for(let p=0;p<i.text.length;++p)this.sectionIndex.push(l)}addImageSection(i){const s=i.image?i.image.name:"";if(s.length===0)return void Xt("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push($u.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Xt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zd(r,i,s,l,p,y,_,w,S,C,P,M,R,j,U){const $=Yl.fromFeature(r,p);let Y;M===v.ah.vertical&&$.verticalizePunctuation();const{processBidirectionalText:te,processStyledBidirectionalText:me}=Mn;if(te&&$.sections.length===1){Y=[];const be=te($.toString(),Lm($,C,y,i,l,j));for(const ze of be){const Ze=new Yl;Ze.text=ze,Ze.sections=$.sections;for(let ct=0;ct<ze.length;ct++)Ze.sectionIndex.push(0);Y.push(Ze)}}else if(me){Y=[];const be=me($.text,$.sectionIndex,Lm($,C,y,i,l,j));for(const ze of be){const Ze=new Yl;Ze.text=ze[0],Ze.sectionIndex=ze[1],Ze.sections=$.sections,Y.push(Ze)}}else Y=function(be,ze){const Ze=[],ct=be.text;let He=0;for(const Ue of ze)Ze.push(be.substring(He,Ue)),He=Ue;return He<ct.length&&Ze.push(be.substring(He,ct.length)),Ze}($,Lm($,C,y,i,l,j));const oe=[],pe={positionedLines:oe,text:$.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:M,iconsInText:!1,verticalizable:!1};return function(be,ze,Ze,ct,He,Ue,tt,Ye,Xe,Pe,it,et){let gt=0,Ht=Uu,Gt=0,Ai=0;const Er=Ye==="right"?1:Ye==="left"?0:.5;let Zi=0;for(const hi of He){hi.trim();const Ei=hi.getMaxScale(),nn=(Ei-1)*ki,Wi={positionedGlyphs:[],lineOffset:0};be.positionedLines[Zi]=Wi;const xn=Wi.positionedGlyphs;let Xi=0;if(!hi.length()){Ht+=Ue,++Zi;continue}for(let Dn=0;Dn<hi.length();Dn++){const Dt=hi.getSection(Dn),Zt=hi.getSectionIndex(Dn),ei=hi.getCharCode(Dn);let Xn=0,si=null,tc=null,ms=null,gs=ki;const zr=!(Xe===v.ah.horizontal||!it&&!Iu(ei)||it&&(Wd[ei]||(Mi=ei,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Mi)))));if(Dt.imageName){const mr=ct[Dt.imageName];if(!mr)continue;ms=Dt.imageName,be.iconsInText=be.iconsInText||!0,tc=mr.paddedRect;const Bi=mr.displaySize;Dt.scale=Dt.scale*ki/et,si={width:Bi[0],height:Bi[1],left:zn,top:-wx,advance:zr?Bi[1]:Bi[0]},Xn=nn+(ki-Bi[1]*Dt.scale),gs=si.advance;const Gs=zr?Bi[0]*Dt.scale-ki*Ei:Bi[1]*Dt.scale-ki*Ei;Gs>0&&Gs>Xi&&(Xi=Gs)}else{const mr=Ze[Dt.fontStack],Bi=mr&&mr[ei];if(Bi&&Bi.rect)tc=Bi.rect,si=Bi.metrics;else{const Gs=ze[Dt.fontStack],Xu=Gs&&Gs[ei];if(!Xu)continue;si=Xu.metrics}Xn=(Ei-Dt.scale)*ki}zr?(be.verticalizable=!0,xn.push({glyph:ei,imageName:ms,x:gt,y:Ht+Xn,vertical:zr,scale:Dt.scale,fontStack:Dt.fontStack,sectionIndex:Zt,metrics:si,rect:tc}),gt+=gs*Dt.scale+Pe):(xn.push({glyph:ei,imageName:ms,x:gt,y:Ht+Xn,vertical:zr,scale:Dt.scale,fontStack:Dt.fontStack,sectionIndex:Zt,metrics:si,rect:tc}),gt+=si.advance*Dt.scale+Pe)}xn.length!==0&&(Gt=Math.max(gt-Pe,Gt),Wk(xn,0,xn.length-1,Er,Xi)),gt=0;const fr=Ue*Ei+Xi;Wi.lineOffset=Math.max(Xi,nn),Ht+=fr,Ai=Math.max(fr,Ai),++Zi}var Mi;const yn=Ht-Uu,{horizontalAlign:_n,verticalAlign:vn}=Rm(tt);(function(hi,Ei,nn,Wi,xn,Xi,fr,Dn,Dt){const Zt=(Ei-nn)*xn;let ei=0;ei=Xi!==fr?-Dn*Wi-Uu:(-Wi*Dt+.5)*fr;for(const Xn of hi)for(const si of Xn.positionedGlyphs)si.x+=Zt,si.y+=ei})(be.positionedLines,Er,_n,vn,Gt,Ai,Ue,yn,He.length),be.top+=-vn*yn,be.bottom=be.top+yn,be.left+=-_n*Gt,be.right=be.left+Gt}(pe,i,s,l,Y,_,w,S,M,C,R,U),!function(be){for(const ze of be)if(ze.positionedGlyphs.length!==0)return!1;return!0}(oe)&&pe}const Wd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Hk={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},qk={40:!0};function Tx(r,i,s,l,p,y){if(i.imageName){const _=l[i.imageName];return _?_.displaySize[0]*i.scale*ki/y+p:0}{const _=s[i.fontStack],w=_&&_[r];return w?w.metrics.advance*i.scale+p:0}}function kx(r,i,s,l){const p=Math.pow(r-i,2);return l?r<i?p/2:2*p:p+Math.abs(s)*s}function Zk(r,i,s){let l=0;return r===10&&(l-=1e4),s&&(l+=150),r!==40&&r!==65288||(l+=50),i!==41&&i!==65289||(l+=50),l}function Cx(r,i,s,l,p,y){let _=null,w=kx(i,s,p,y);for(const S of l){const C=kx(i-S.x,s,p,y)+S.badness;C<=w&&(_=S,w=C)}return{index:r,x:i,priorBreak:_,badness:w}}function Px(r){return r?Px(r.priorBreak).concat(r.index):[]}function Lm(r,i,s,l,p,y){if(!r)return[];const _=[],w=function(M,R,j,U,$,Y){let te=0;for(let me=0;me<M.length();me++){const oe=M.getSection(me);te+=Tx(M.getCharCode(me),oe,U,$,R,Y)}return te/Math.max(1,Math.ceil(te/j))}(r,i,s,l,p,y),S=r.text.indexOf("")>=0;let C=0;for(let M=0;M<r.length();M++){const R=r.getSection(M),j=r.getCharCode(M);if(Wd[j]||(C+=Tx(j,R,l,p,i,y)),M<r.length()-1){const U=!((P=j)<11904)&&(!!Pt["CJK Compatibility Forms"](P)||!!Pt["CJK Compatibility"](P)||!!Pt["CJK Strokes"](P)||!!Pt["CJK Symbols and Punctuation"](P)||!!Pt["Enclosed CJK Letters and Months"](P)||!!Pt["Halfwidth and Fullwidth Forms"](P)||!!Pt["Ideographic Description Characters"](P)||!!Pt["Vertical Forms"](P)||Ed.test(String.fromCodePoint(P)));(Hk[j]||U||R.imageName||M!==r.length()-2&&qk[r.getCharCode(M+1)])&&_.push(Cx(M+1,C,w,_,Zk(j,r.getCharCode(M+1),U&&S),!1))}}var P;return Px(Cx(r.length(),C,w,_,0,!0))}function Rm(r){let i=.5,s=.5;switch(r){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:i,verticalAlign:s}}function Wk(r,i,s,l,p){if(!l&&!p)return;const y=r[s],_=(r[s].x+y.metrics.advance*y.scale)*l;for(let w=i;w<=s;w++)r[w].x-=_,r[w].y+=p}function Xk(r,i,s){const{horizontalAlign:l,verticalAlign:p}=Rm(s),y=i[0]-r.displaySize[0]*l,_=i[1]-r.displaySize[1]*p;return{image:r,top:_,bottom:_+r.displaySize[1],left:y,right:y+r.displaySize[0]}}function Ix(r){var i,s;let l=r.left,p=r.top,y=r.right-l,_=r.bottom-p;const w=(i=r.image.textFitWidth)!==null&&i!==void 0?i:"stretchOrShrink",S=(s=r.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",C=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(S==="proportional"){if(w==="stretchOnly"&&y/_<C||w==="proportional"){const P=Math.ceil(_*C);l*=P/y,y=P}}else if(w==="proportional"&&S==="stretchOnly"&&C!==0&&y/_>C){const P=Math.ceil(y/C);p*=P/_,_=P}return{x1:l,y1:p,x2:l+y,y2:p+_}}function Ax(r,i,s,l,p,y){const _=r.image;let w;if(_.content){const Y=_.content,te=_.pixelRatio||1;w=[Y[0]/te,Y[1]/te,_.displaySize[0]-Y[2]/te,_.displaySize[1]-Y[3]/te]}const S=i.left*y,C=i.right*y;let P,M,R,j;s==="width"||s==="both"?(j=p[0]+S-l[3],M=p[0]+C+l[1]):(j=p[0]+(S+C-_.displaySize[0])/2,M=j+_.displaySize[0]);const U=i.top*y,$=i.bottom*y;return s==="height"||s==="both"?(P=p[1]+U-l[0],R=p[1]+$+l[2]):(P=p[1]+(U+$-_.displaySize[1])/2,R=P+_.displaySize[1]),{image:_,top:P,right:M,bottom:R,left:j,collisionPadding:w}}const Gu=255,fs=128,Ra=Gu*fs;function Mx(r,i){const{expression:s}=i;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Kt(r+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:p}=s;let y=0;for(;y<l.length&&l[y]<=r;)y++;y=Math.max(0,y-1);let _=y;for(;_<l.length&&l[_]<r+1;)_++;_=Math.min(l.length-1,_);const w=l[y],S=l[_];return s.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:S,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:S,minSize:s.evaluate(new Kt(w)),maxSize:s.evaluate(new Kt(S)),interpolationType:p}}}function Bm(r,i,s){let l="never";const p=r.get(i);return p?l=p:r.get(s)&&(l="always"),l}const Kk=Da.VectorTileFeature.types,Yk=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Xd(r,i,s,l,p,y,_,w,S,C,P,M,R){const j=w?Math.min(Ra,Math.round(w[0])):0,U=w?Math.min(Ra,Math.round(w[1])):0;r.emplaceBack(i,s,Math.round(32*l),Math.round(32*p),y,_,(j<<1)+(S?1:0),U,16*C,16*P,256*M,256*R)}function Fm(r,i,s){r.emplaceBack(i.x,i.y,s),r.emplaceBack(i.x,i.y,s),r.emplaceBack(i.x,i.y,s),r.emplaceBack(i.x,i.y,s)}function Jk(r){for(const i of r.sections)if(hm(i.text))return!0;return!1}class Om{constructor(i){this.layoutVertexArray=new Vl,this.indexArray=new hr,this.programConfigurations=i,this.segments=new It,this.dynamicLayoutVertexArray=new Eu,this.opacityVertexArray=new Zn,this.hasVisibleVertices=!1,this.placedSymbolArray=new Yt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,s,l,p){this.isEmpty()||(l&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Ik.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,Ak.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Yk,!0),this.opacityVertexBuffer.itemSize=1),(l||p)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ke("SymbolBuffers",Om);class jm{constructor(i,s,l){this.layoutVertexArray=new i,this.layoutAttributes=s,this.indexArray=new l,this.segments=new It,this.collisionVertexArray=new ds}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Mk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ke("CollisionBuffers",jm);class Jl{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(_=>_.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=_m([]),this.placementViewportMatrix=_m([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mx(this.zoom,s["text-size"]),this.iconSizeData=Mx(this.zoom,s["icon-size"]);const l=this.layers[0].layout,p=l.get("symbol-sort-key"),y=l.get("symbol-z-order");this.canOverlap=Bm(l,"text-overlap","text-allow-overlap")!=="never"||Bm(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>v.ah[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=i.sourceID}createArrays(){this.text=new Om(new Fo(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new Om(new Fo(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Jt,this.lineVertexArray=new $i,this.symbolInstances=new kt,this.textAnchorOffsets=new Qt}calculateGlyphDependencies(i,s,l,p,y){for(let _=0;_<i.length;_++)if(s[i.charCodeAt(_)]=!0,(l||p)&&y){const w=Nu[i.charAt(_)];w&&(s[w.charCodeAt(0)]=!0)}}populate(i,s,l){const p=this.layers[0],y=p.layout,_=y.get("text-font"),w=y.get("text-field"),S=y.get("icon-image"),C=(w.value.kind!=="constant"||w.value.value instanceof Cn&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),P=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,M=y.get("symbol-sort-key");if(this.features=[],!C&&!P)return;const R=s.iconDependencies,j=s.glyphDependencies,U=s.availableImages,$=new Kt(this.zoom);for(const{feature:Y,id:te,index:me,sourceLayerIndex:oe}of i){const pe=p._featureFilter.needGeometry,be=jo(Y,pe);if(!p._featureFilter.filter($,be,l))continue;let ze,Ze;if(pe||(be.geometry=Oo(Y)),C){const He=p.getValueAndResolveTokens("text-field",be,l,U),Ue=Cn.factory(He),tt=this.hasRTLText=this.hasRTLText||Jk(Ue);(!tt||Mn.getRTLTextPluginStatus()==="unavailable"||tt&&Mn.isParsed())&&(ze=zk(Ue,p,be))}if(P){const He=p.getValueAndResolveTokens("icon-image",be,l,U);Ze=He instanceof In?He:In.fromString(He)}if(!ze&&!Ze)continue;const ct=this.sortFeaturesByKey?M.evaluate(be,{},l):void 0;if(this.features.push({id:te,text:ze,icon:Ze,index:me,sourceLayerIndex:oe,geometry:be.geometry,properties:Y.properties,type:Kk[Y.type],sortKey:ct}),Ze&&(R[Ze.name]=!0),ze){const He=_.evaluate(be,{},l).join(","),Ue=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ah.vertical)>=0;for(const tt of ze.sections)if(tt.image)R[tt.image.name]=!0;else{const Ye=Cu(ze.toString()),Xe=tt.fontStack||He,Pe=j[Xe]=j[Xe]||{};this.calculateGlyphDependencies(tt.text,Pe,Ue,this.allowVerticalPlacement,Ye)}}}y.get("symbol-placement")==="line"&&(this.features=function(Y){const te={},me={},oe=[];let pe=0;function be(He){oe.push(Y[He]),pe++}function ze(He,Ue,tt){const Ye=me[He];return delete me[He],me[Ue]=Ye,oe[Ye].geometry[0].pop(),oe[Ye].geometry[0]=oe[Ye].geometry[0].concat(tt[0]),Ye}function Ze(He,Ue,tt){const Ye=te[Ue];return delete te[Ue],te[He]=Ye,oe[Ye].geometry[0].shift(),oe[Ye].geometry[0]=tt[0].concat(oe[Ye].geometry[0]),Ye}function ct(He,Ue,tt){const Ye=tt?Ue[0][Ue[0].length-1]:Ue[0][0];return`${He}:${Ye.x}:${Ye.y}`}for(let He=0;He<Y.length;He++){const Ue=Y[He],tt=Ue.geometry,Ye=Ue.text?Ue.text.toString():null;if(!Ye){be(He);continue}const Xe=ct(Ye,tt),Pe=ct(Ye,tt,!0);if(Xe in me&&Pe in te&&me[Xe]!==te[Pe]){const it=Ze(Xe,Pe,tt),et=ze(Xe,Pe,oe[it].geometry);delete te[Xe],delete me[Pe],me[ct(Ye,oe[et].geometry,!0)]=et,oe[it].geometry=null}else Xe in me?ze(Xe,Pe,tt):Pe in te?Ze(Xe,Pe,tt):(be(He),te[Xe]=pe-1,me[Pe]=pe-1)}return oe.filter(He=>He.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Y,te)=>Y.sortKey-te.sortKey)}update(i,s,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,s,this.layers,l),this.icon.programConfigurations.updatePaintArrays(i,s,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,s){const l=this.lineVertexArray.length;if(i.segment!==void 0){let p=i.dist(s[i.segment+1]),y=i.dist(s[i.segment]);const _={};for(let w=i.segment+1;w<s.length;w++)_[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:p},w<s.length-1&&(p+=s[w+1].dist(s[w]));for(let w=i.segment||0;w>=0;w--)_[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:y},w>0&&(y+=s[w-1].dist(s[w]));for(let w=0;w<s.length;w++){const S=_[w];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(i,s,l,p,y,_,w,S,C,P,M,R){const j=i.indexArray,U=i.layoutVertexArray,$=i.segments.prepareSegment(4*s.length,U,j,this.canOverlap?_.sortKey:void 0),Y=this.glyphOffsetArray.length,te=$.vertexLength,me=this.allowVerticalPlacement&&w===v.ah.vertical?Math.PI/2:0,oe=_.text&&_.text.sections;for(let pe=0;pe<s.length;pe++){const{tl:be,tr:ze,bl:Ze,br:ct,tex:He,pixelOffsetTL:Ue,pixelOffsetBR:tt,minFontScaleX:Ye,minFontScaleY:Xe,glyphOffset:Pe,isSDF:it,sectionIndex:et}=s[pe],gt=$.vertexLength,Ht=Pe[1];Xd(U,S.x,S.y,be.x,Ht+be.y,He.x,He.y,l,it,Ue.x,Ue.y,Ye,Xe),Xd(U,S.x,S.y,ze.x,Ht+ze.y,He.x+He.w,He.y,l,it,tt.x,Ue.y,Ye,Xe),Xd(U,S.x,S.y,Ze.x,Ht+Ze.y,He.x,He.y+He.h,l,it,Ue.x,tt.y,Ye,Xe),Xd(U,S.x,S.y,ct.x,Ht+ct.y,He.x+He.w,He.y+He.h,l,it,tt.x,tt.y,Ye,Xe),Fm(i.dynamicLayoutVertexArray,S,me),j.emplaceBack(gt,gt+1,gt+2),j.emplaceBack(gt+1,gt+2,gt+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pe[0]),pe!==s.length-1&&et===s[pe+1].sectionIndex||i.programConfigurations.populatePaintArrays(U.length,_,_.index,{},R,oe&&oe[et])}i.placedSymbolArray.emplaceBack(S.x,S.y,Y,this.glyphOffsetArray.length-Y,te,C,P,S.segment,l?l[0]:0,l?l[1]:0,p[0],p[1],w,0,!1,0,M)}_addCollisionDebugVertex(i,s,l,p,y,_){return s.emplaceBack(0,0),i.emplaceBack(l.x,l.y,p,y,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(i,s,l,p,y,_,w){const S=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),C=S.vertexLength,P=y.layoutVertexArray,M=y.collisionVertexArray,R=w.anchorX,j=w.anchorY;this._addCollisionDebugVertex(P,M,_,R,j,new L(i,s)),this._addCollisionDebugVertex(P,M,_,R,j,new L(l,s)),this._addCollisionDebugVertex(P,M,_,R,j,new L(l,p)),this._addCollisionDebugVertex(P,M,_,R,j,new L(i,p)),S.vertexLength+=4;const U=y.indexArray;U.emplaceBack(C,C+1),U.emplaceBack(C+1,C+2),U.emplaceBack(C+2,C+3),U.emplaceBack(C+3,C),S.primitiveLength+=4}addDebugCollisionBoxes(i,s,l,p){for(let y=i;y<s;y++){const _=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,p?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new jm(Wn,px.members,Ri),this.iconCollisionBox=new jm(Wn,px.members,Ri);for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(i,s,l,p,y,_,w,S,C){const P={};for(let M=s;M<l;M++){const R=i.get(M);P.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},P.textFeatureIndex=R.featureIndex;break}for(let M=p;M<y;M++){const R=i.get(M);P.verticalTextBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},P.verticalTextFeatureIndex=R.featureIndex;break}for(let M=_;M<w;M++){const R=i.get(M);P.iconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},P.iconFeatureIndex=R.featureIndex;break}for(let M=S;M<C;M++){const R=i.get(M);P.verticalIconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},P.verticalIconFeatureIndex=R.featureIndex;break}return P}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,s){const l=i.placedSymbolArray.get(s),p=l.vertexStartIndex+4*l.numGlyphs;for(let y=l.vertexStartIndex;y<p;y+=4)i.indexArray.emplaceBack(y,y+1,y+2),i.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(i),l=Math.cos(i),p=[],y=[],_=[];for(let w=0;w<this.symbolInstances.length;++w){_.push(w);const S=this.symbolInstances.get(w);p.push(0|Math.round(s*S.anchorX+l*S.anchorY)),y.push(S.featureIndex)}return _.sort((w,S)=>p[w]-p[S]||y[S]-y[w]),_}addToSortKeyRanges(i,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((p,y,_)=>{p>=0&&_.indexOf(p)===y&&this.addIndicesForPlacedSymbol(this.text,p)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Ex,zx;Ke("SymbolBucket",Jl,{omit:["layers","collisionBoxArray","features","compareText"]}),Jl.MAX_GLYPHS=65535,Jl.addDynamicAttributes=Fm;var Vm={get paint(){return zx=zx||new m({"icon-opacity":new ht(we.paint_symbol["icon-opacity"]),"icon-color":new ht(we.paint_symbol["icon-color"]),"icon-halo-color":new ht(we.paint_symbol["icon-halo-color"]),"icon-halo-width":new ht(we.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ht(we.paint_symbol["icon-halo-blur"]),"icon-translate":new Je(we.paint_symbol["icon-translate"]),"icon-translate-anchor":new Je(we.paint_symbol["icon-translate-anchor"]),"text-opacity":new ht(we.paint_symbol["text-opacity"]),"text-color":new ht(we.paint_symbol["text-color"],{runtimeType:dn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ht(we.paint_symbol["text-halo-color"]),"text-halo-width":new ht(we.paint_symbol["text-halo-width"]),"text-halo-blur":new ht(we.paint_symbol["text-halo-blur"]),"text-translate":new Je(we.paint_symbol["text-translate"]),"text-translate-anchor":new Je(we.paint_symbol["text-translate-anchor"])})},get layout(){return Ex=Ex||new m({"symbol-placement":new Je(we.layout_symbol["symbol-placement"]),"symbol-spacing":new Je(we.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Je(we.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ht(we.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Je(we.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Je(we.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Je(we.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Je(we.layout_symbol["icon-ignore-placement"]),"icon-optional":new Je(we.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Je(we.layout_symbol["icon-rotation-alignment"]),"icon-size":new ht(we.layout_symbol["icon-size"]),"icon-text-fit":new Je(we.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Je(we.layout_symbol["icon-text-fit-padding"]),"icon-image":new ht(we.layout_symbol["icon-image"]),"icon-rotate":new ht(we.layout_symbol["icon-rotate"]),"icon-padding":new ht(we.layout_symbol["icon-padding"]),"icon-keep-upright":new Je(we.layout_symbol["icon-keep-upright"]),"icon-offset":new ht(we.layout_symbol["icon-offset"]),"icon-anchor":new ht(we.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Je(we.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Je(we.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Je(we.layout_symbol["text-rotation-alignment"]),"text-field":new ht(we.layout_symbol["text-field"]),"text-font":new ht(we.layout_symbol["text-font"]),"text-size":new ht(we.layout_symbol["text-size"]),"text-max-width":new ht(we.layout_symbol["text-max-width"]),"text-line-height":new Je(we.layout_symbol["text-line-height"]),"text-letter-spacing":new ht(we.layout_symbol["text-letter-spacing"]),"text-justify":new ht(we.layout_symbol["text-justify"]),"text-radial-offset":new ht(we.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Je(we.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ht(we.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ht(we.layout_symbol["text-anchor"]),"text-max-angle":new Je(we.layout_symbol["text-max-angle"]),"text-writing-mode":new Je(we.layout_symbol["text-writing-mode"]),"text-rotate":new ht(we.layout_symbol["text-rotate"]),"text-padding":new Je(we.layout_symbol["text-padding"]),"text-keep-upright":new Je(we.layout_symbol["text-keep-upright"]),"text-transform":new ht(we.layout_symbol["text-transform"]),"text-offset":new ht(we.layout_symbol["text-offset"]),"text-allow-overlap":new Je(we.layout_symbol["text-allow-overlap"]),"text-overlap":new Je(we.layout_symbol["text-overlap"]),"text-ignore-placement":new Je(we.layout_symbol["text-ignore-placement"]),"text-optional":new Je(we.layout_symbol["text-optional"])})}};class Dx{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:ls,this.defaultValue=i}evaluate(i){if(i.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(i.formattedSection))return s.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ke("FormatSectionOverride",Dx,{omit:["defaultValue"]});class Kd extends a{constructor(i){super(i,Vm)}recalculate(i,s){if(super.recalculate(i,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const p=[];for(const y of l)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,s,l,p){const y=this.layout.get(i).evaluate(s,{},l,p),_=this._unevaluatedLayout._values[i];return _.isDataDriven()||kl(_.value)||!y?y:function(w,S){return S.replace(/{([^{}]+)}/g,(C,P)=>w&&P in w?String(w[P]):"")}(s.properties,y)}createBucket(i){return new Jl(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of Vm.paint.overridableProperties){if(!Kd.hasPaintOverride(this.layout,i))continue;const s=this.paint.get(i),l=new Dx(s),p=new Tl(l,s.property.specification);let y=null;y=s.value.kind==="constant"||s.value.kind==="source"?new _a("source",p):new va("composite",p,s.value.zoomStops),this.paint._values[i]=new Ar(s.property,y,s.parameters)}}_handleOverridablePaintPropertyUpdate(i,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&Kd.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,s){const l=i.get("text-field"),p=Vm.paint.properties[s];let y=!1;const _=w=>{for(const S of w)if(p.overrides&&p.overrides.hasOverride(S))return void(y=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Cn)_(l.value.value.sections);else if(l.value.kind==="source"){const w=C=>{y||(C instanceof sr&&wi(C.value)===Gr?_(C.value.sections):C instanceof ml?_(C.sections):C.eachChild(w))},S=l.value;S._styleExpression&&w(S._styleExpression.expression)}return y}}let Lx;var Qk={get paint(){return Lx=Lx||new m({"background-color":new Je(we.paint_background["background-color"]),"background-pattern":new Ol(we.paint_background["background-pattern"]),"background-opacity":new Je(we.paint_background["background-opacity"])})}};class eC extends a{constructor(i){super(i,Qk)}}let Rx;var tC={get paint(){return Rx=Rx||new m({"raster-opacity":new Je(we.paint_raster["raster-opacity"]),"raster-hue-rotate":new Je(we.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Je(we.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Je(we.paint_raster["raster-brightness-max"]),"raster-saturation":new Je(we.paint_raster["raster-saturation"]),"raster-contrast":new Je(we.paint_raster["raster-contrast"]),"raster-resampling":new Je(we.paint_raster["raster-resampling"]),"raster-fade-duration":new Je(we.paint_raster["raster-fade-duration"])})}};class iC extends a{constructor(i){super(i,tC)}}class nC extends a{constructor(i){super(i,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class rC{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Nm=63710088e-1;class Ba{constructor(i,s){if(isNaN(i)||isNaN(s))throw new Error(`Invalid LngLat object: (${i}, ${s})`);if(this.lng=+i,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ba(ke(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const s=Math.PI/180,l=this.lat*s,p=i.lat*s,y=Math.sin(l)*Math.sin(p)+Math.cos(l)*Math.cos(p)*Math.cos((i.lng-this.lng)*s);return Nm*Math.acos(Math.min(y,1))}static convert(i){if(i instanceof Ba)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Ba(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Ba(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Bx=2*Math.PI*Nm;function Fx(r){return Bx*Math.cos(r*Math.PI/180)}function Ox(r){return(180+r)/360}function jx(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Vx(r,i){return r/Fx(i)}function Um(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Hu{constructor(i,s,l=0){this.x=+i,this.y=+s,this.z=+l}static fromLngLat(i,s=0){const l=Ba.convert(i);return new Hu(Ox(l.lng),jx(l.lat),Vx(s,l.lat))}toLngLat(){return new Ba(360*this.x-180,Um(this.y))}toAltitude(){return this.z*Fx(Um(this.y))}meterInMercatorCoordinateUnits(){return 1/Bx*(i=Um(this.y),1/Math.cos(i*Math.PI/180));var i}}function Nx(r,i,s){var l=2*Math.PI*6378137/256/Math.pow(2,s);return[r*l-2*Math.PI*6378137/2,i*l-2*Math.PI*6378137/2]}class $m{constructor(i,s,l){if(!function(p,y,_){return!(p<0||p>25||_<0||_>=Math.pow(2,p)||y<0||y>=Math.pow(2,p))}(i,s,l))throw new Error(`x=${s}, y=${l}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=s,this.y=l,this.key=qu(0,i,i,s,l)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,s,l){const p=(_=this.y,w=this.z,S=Nx(256*(y=this.x),256*(_=Math.pow(2,w)-_-1),w),C=Nx(256*(y+1),256*(_+1),w),S[0]+","+S[1]+","+C[0]+","+C[1]);var y,_,w,S,C;const P=function(M,R,j){let U,$="";for(let Y=M;Y>0;Y--)U=1<<Y-1,$+=(R&U?1:0)+(j&U?2:0);return $}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,p)}isChildOf(i){const s=this.z-i.z;return s>0&&i.x===this.x>>s&&i.y===this.y>>s}getTilePoint(i){const s=Math.pow(2,this.z);return new L((i.x*s-this.x)*bi,(i.y*s-this.y)*bi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ux{constructor(i,s){this.wrap=i,this.canonical=s,this.key=qu(i,s.z,s.z,s.x,s.y)}}class pr{constructor(i,s,l,p,y){if(i<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${l}`);this.overscaledZ=i,this.wrap=s,this.canonical=new $m(l,+p,+y),this.key=qu(s,i,l,p,y)}clone(){return new pr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-i;return i>this.canonical.z?new pr(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pr(i,this.wrap,i,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(i,s){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-i;return i>this.canonical.z?qu(this.wrap*+s,i,this.canonical.z,this.canonical.x,this.canonical.y):qu(this.wrap*+s,i,i,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const s=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>s&&i.canonical.y===this.canonical.y>>s}children(i){if(this.overscaledZ>=i)return[new pr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,p=2*this.canonical.y;return[new pr(s,this.wrap,s,l,p),new pr(s,this.wrap,s,l+1,p),new pr(s,this.wrap,s,l,p+1),new pr(s,this.wrap,s,l+1,p+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new pr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new pr(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ux(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Hu(i.x-this.wrap,i.y))}}function qu(r,i,s,l,p){(r*=2)<0&&(r=-1*r-1);const y=1<<s;return(y*y*r+y*p+l).toString(36)+s.toString(36)+i.toString(36)}Ke("CanonicalTileID",$m),Ke("OverscaledTileID",pr,{omit:["posMatrix"]});class $x{constructor(i,s,l,p=1,y=1,_=1,w=0){if(this.uid=i,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Xt(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const S=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=y,this.blueFactor=_,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<S;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(S,C)]=this.data[this._idx(S-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,S)]=this.data[this._idx(C,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<S;C++)for(let P=0;P<S;P++){const M=this.get(C,P);M>this.max&&(this.max=M),M<this.min&&(this.min=M)}}get(i,s){const l=new Uint8Array(this.data.buffer),p=4*this._idx(i,s);return this.unpack(l[p],l[p+1],l[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,s){if(i<-1||i>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(i+1)}unpack(i,s,l){return i*this.redFactor+s*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new dr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,s,l){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,y=s*this.dim+this.dim,_=l*this.dim,w=l*this.dim+this.dim;switch(s){case-1:p=y-1;break;case 1:y=p+1}switch(l){case-1:_=w-1;break;case 1:w=_+1}const S=-s*this.dim,C=-l*this.dim;for(let P=_;P<w;P++)for(let M=p;M<y;M++)this.data[this._idx(M,P)]=i.data[this._idx(M+S,P+C)]}}Ke("DEMData",$x);class Gx{constructor(i){this._stringToNumber={},this._numberToString=[];for(let s=0;s<i.length;s++){const l=i[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class Hx{constructor(i,s,l,p,y){this.type="Feature",this._vectorTileFeature=i,i._z=s,i._x=l,i._y=p,this.properties=i.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(i[s]=this[s]);return i}}class qx{constructor(i,s){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new ba(bi,16,0),this.grid3D=new ba(bi,16,0),this.featureIndexArray=new en,this.promoteId=s}insert(i,s,l,p,y,_){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,p,y);const S=_?this.grid3D:this.grid;for(let C=0;C<s.length;C++){const P=s[C],M=[1/0,1/0,-1/0,-1/0];for(let R=0;R<P.length;R++){const j=P[R];M[0]=Math.min(M[0],j.x),M[1]=Math.min(M[1],j.y),M[2]=Math.max(M[2],j.x),M[3]=Math.max(M[3],j.y)}M[0]<bi&&M[1]<bi&&M[2]>=0&&M[3]>=0&&S.insert(w,M[0],M[1],M[2],M[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Da.VectorTile(new Em(this.rawTileData)).layers,this.sourceLayerCoder=new Gx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,s,l,p){this.loadVTLayers();const y=i.params||{},_=bi/i.tileSize/i.scale,w=hu(y.filter),S=i.queryGeometry,C=i.queryPadding*_,P=Wx(S),M=this.grid.query(P.minX-C,P.minY-C,P.maxX+C,P.maxY+C),R=Wx(i.cameraQueryGeometry),j=this.grid3D.query(R.minX-C,R.minY-C,R.maxX+C,R.maxY+C,(Y,te,me,oe)=>function(pe,be,ze,Ze,ct){for(const Ue of pe)if(be<=Ue.x&&ze<=Ue.y&&Ze>=Ue.x&&ct>=Ue.y)return!0;const He=[new L(be,ze),new L(be,ct),new L(Ze,ct),new L(Ze,ze)];if(pe.length>2){for(const Ue of He)if(Hl(pe,Ue))return!0}for(let Ue=0;Ue<pe.length-1;Ue++)if(OT(pe[Ue],pe[Ue+1],He))return!0;return!1}(i.cameraQueryGeometry,Y-C,te-C,me+C,oe+C));for(const Y of j)M.push(Y);M.sort(sC);const U={};let $;for(let Y=0;Y<M.length;Y++){const te=M[Y];if(te===$)continue;$=te;const me=this.featureIndexArray.get(te);let oe=null;this.loadMatchingFeature(U,me.bucketIndex,me.sourceLayerIndex,me.featureIndex,w,y.layers,y.availableImages,s,l,p,(pe,be,ze)=>(oe||(oe=Oo(pe)),be.queryIntersectsFeature(S,pe,ze,oe,this.z,i.transform,_,i.pixelPosMatrix)))}return U}loadMatchingFeature(i,s,l,p,y,_,w,S,C,P,M){const R=this.bucketLayerIDs[s];if(_&&!function(Y,te){for(let me=0;me<Y.length;me++)if(te.indexOf(Y[me])>=0)return!0;return!1}(_,R))return;const j=this.sourceLayerCoder.decode(l),U=this.vtLayers[j].feature(p);if(y.needGeometry){const Y=jo(U,!0);if(!y.filter(new Kt(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!y.filter(new Kt(this.tileID.overscaledZ),U))return;const $=this.getId(U,j);for(let Y=0;Y<R.length;Y++){const te=R[Y];if(_&&_.indexOf(te)<0)continue;const me=S[te];if(!me)continue;let oe={};$&&P&&(oe=P.getState(me.sourceLayer||"_geojsonTileLayer",$));const pe=Ae({},C[te]);pe.paint=Zx(pe.paint,me.paint,U,oe,w),pe.layout=Zx(pe.layout,me.layout,U,oe,w);const be=!M||M(U,me,oe);if(!be)continue;const ze=new Hx(U,this.z,this.x,this.y,$);ze.layer=pe;let Ze=i[te];Ze===void 0&&(Ze=i[te]=[]),Ze.push({featureIndex:p,feature:ze,intersectionZ:be})}}lookupSymbolFeatures(i,s,l,p,y,_,w,S){const C={};this.loadVTLayers();const P=hu(y);for(const M of i)this.loadMatchingFeature(C,l,p,M,P,_,w,S,s);return C}hasLayer(i){for(const s of this.bucketLayerIDs)for(const l of s)if(i===l)return!0;return!1}getId(i,s){let l=i.id;return this.promoteId&&(l=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof l=="boolean"&&(l=Number(l))),l}}function Zx(r,i,s,l,p){return ot(r,(y,_)=>{const w=i instanceof Lo?i.get(_):null;return w&&w.evaluate?w.evaluate(s,l,p):w})}function Wx(r){let i=1/0,s=1/0,l=-1/0,p=-1/0;for(const y of r)i=Math.min(i,y.x),s=Math.min(s,y.y),l=Math.max(l,y.x),p=Math.max(p,y.y);return{minX:i,minY:s,maxX:l,maxY:p}}function sC(r,i){return i-r}function Xx(r,i,s,l,p){const y=[];for(let _=0;_<r.length;_++){const w=r[_];let S;for(let C=0;C<w.length-1;C++){let P=w[C],M=w[C+1];P.x<i&&M.x<i||(P.x<i?P=new L(i,P.y+(i-P.x)/(M.x-P.x)*(M.y-P.y))._round():M.x<i&&(M=new L(i,P.y+(i-P.x)/(M.x-P.x)*(M.y-P.y))._round()),P.y<s&&M.y<s||(P.y<s?P=new L(P.x+(s-P.y)/(M.y-P.y)*(M.x-P.x),s)._round():M.y<s&&(M=new L(P.x+(s-P.y)/(M.y-P.y)*(M.x-P.x),s)._round()),P.x>=l&&M.x>=l||(P.x>=l?P=new L(l,P.y+(l-P.x)/(M.x-P.x)*(M.y-P.y))._round():M.x>=l&&(M=new L(l,P.y+(l-P.x)/(M.x-P.x)*(M.y-P.y))._round()),P.y>=p&&M.y>=p||(P.y>=p?P=new L(P.x+(p-P.y)/(M.y-P.y)*(M.x-P.x),p)._round():M.y>=p&&(M=new L(P.x+(p-P.y)/(M.y-P.y)*(M.x-P.x),p)._round()),S&&P.equals(S[S.length-1])||(S=[P],y.push(S)),S.push(M)))))}}return y}Ke("FeatureIndex",qx,{omit:["rawTileData","sourceLayerCoder"]});class Fa extends L{constructor(i,s,l,p){super(i,s),this.angle=l,p!==void 0&&(this.segment=p)}clone(){return new Fa(this.x,this.y,this.angle,this.segment)}}function Kx(r,i,s,l,p){if(i.segment===void 0||s===0)return!0;let y=i,_=i.segment+1,w=0;for(;w>-s/2;){if(_--,_<0)return!1;w-=r[_].dist(y),y=r[_]}w+=r[_].dist(r[_+1]),_++;const S=[];let C=0;for(;w<s/2;){const P=r[_],M=r[_+1];if(!M)return!1;let R=r[_-1].angleTo(P)-P.angleTo(M);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:w,angleDelta:R}),C+=R;w-S[0].distance>l;)C-=S.shift().angleDelta;if(C>p)return!1;_++,w+=P.dist(M)}return!0}function Yx(r){let i=0;for(let s=0;s<r.length-1;s++)i+=r[s].dist(r[s+1]);return i}function Jx(r,i,s){return r?.6*i*s:0}function Qx(r,i){return Math.max(r?r.right-r.left:0,i?i.right-i.left:0)}function aC(r,i,s,l,p,y){const _=Jx(s,p,y),w=Qx(s,l)*y;let S=0;const C=Yx(r)/2;for(let P=0;P<r.length-1;P++){const M=r[P],R=r[P+1],j=M.dist(R);if(S+j>C){const U=(C-S)/j,$=pn.number(M.x,R.x,U),Y=pn.number(M.y,R.y,U),te=new Fa($,Y,R.angleTo(M),P);return te._round(),!_||Kx(r,te,w,_,i)?te:void 0}S+=j}}function oC(r,i,s,l,p,y,_,w,S){const C=Jx(l,y,_),P=Qx(l,p),M=P*_,R=r[0].x===0||r[0].x===S||r[0].y===0||r[0].y===S;return i-M<i/4&&(i=M+i/4),e0(r,R?i/2*w%i:(P/2+2*y)*_*w%i,i,C,s,M,R,!1,S)}function e0(r,i,s,l,p,y,_,w,S){const C=y/2,P=Yx(r);let M=0,R=i-s,j=[];for(let U=0;U<r.length-1;U++){const $=r[U],Y=r[U+1],te=$.dist(Y),me=Y.angleTo($);for(;R+s<M+te;){R+=s;const oe=(R-M)/te,pe=pn.number($.x,Y.x,oe),be=pn.number($.y,Y.y,oe);if(pe>=0&&pe<S&&be>=0&&be<S&&R-C>=0&&R+C<=P){const ze=new Fa(pe,be,me,U);ze._round(),l&&!Kx(r,ze,y,l,p)||j.push(ze)}}M+=te}return w||j.length||_||(j=e0(r,M/2,s,l,p,y,_,!0,S)),j}Ke("Anchor",Fa);const Ql=zn;function t0(r,i,s,l){const p=[],y=r.image,_=y.pixelRatio,w=y.paddedRect.w-2*Ql,S=y.paddedRect.h-2*Ql;let C={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const P=y.stretchX||[[0,w]],M=y.stretchY||[[0,S]],R=(Pe,it)=>Pe+it[1]-it[0],j=P.reduce(R,0),U=M.reduce(R,0),$=w-j,Y=S-U;let te=0,me=j,oe=0,pe=U,be=0,ze=$,Ze=0,ct=Y;if(y.content&&l){const Pe=y.content,it=Pe[2]-Pe[0],et=Pe[3]-Pe[1];(y.textFitWidth||y.textFitHeight)&&(C=Ix(r)),te=Yd(P,0,Pe[0]),oe=Yd(M,0,Pe[1]),me=Yd(P,Pe[0],Pe[2]),pe=Yd(M,Pe[1],Pe[3]),be=Pe[0]-te,Ze=Pe[1]-oe,ze=it-me,ct=et-pe}const He=C.x1,Ue=C.y1,tt=C.x2-He,Ye=C.y2-Ue,Xe=(Pe,it,et,gt)=>{const Ht=Jd(Pe.stretch-te,me,tt,He),Gt=Qd(Pe.fixed-be,ze,Pe.stretch,j),Ai=Jd(it.stretch-oe,pe,Ye,Ue),Er=Qd(it.fixed-Ze,ct,it.stretch,U),Zi=Jd(et.stretch-te,me,tt,He),Mi=Qd(et.fixed-be,ze,et.stretch,j),yn=Jd(gt.stretch-oe,pe,Ye,Ue),_n=Qd(gt.fixed-Ze,ct,gt.stretch,U),vn=new L(Ht,Ai),hi=new L(Zi,Ai),Ei=new L(Zi,yn),nn=new L(Ht,yn),Wi=new L(Gt/_,Er/_),xn=new L(Mi/_,_n/_),Xi=i*Math.PI/180;if(Xi){const Dt=Math.sin(Xi),Zt=Math.cos(Xi),ei=[Zt,-Dt,Dt,Zt];vn._matMult(ei),hi._matMult(ei),nn._matMult(ei),Ei._matMult(ei)}const fr=Pe.stretch+Pe.fixed,Dn=it.stretch+it.fixed;return{tl:vn,tr:hi,bl:nn,br:Ei,tex:{x:y.paddedRect.x+Ql+fr,y:y.paddedRect.y+Ql+Dn,w:et.stretch+et.fixed-fr,h:gt.stretch+gt.fixed-Dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wi,pixelOffsetBR:xn,minFontScaleX:ze/_/tt,minFontScaleY:ct/_/Ye,isSDF:s}};if(l&&(y.stretchX||y.stretchY)){const Pe=i0(P,$,j),it=i0(M,Y,U);for(let et=0;et<Pe.length-1;et++){const gt=Pe[et],Ht=Pe[et+1];for(let Gt=0;Gt<it.length-1;Gt++)p.push(Xe(gt,it[Gt],Ht,it[Gt+1]))}}else p.push(Xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:S+1}));return p}function Yd(r,i,s){let l=0;for(const p of r)l+=Math.max(i,Math.min(s,p[1]))-Math.max(i,Math.min(s,p[0]));return l}function i0(r,i,s){const l=[{fixed:-Ql,stretch:0}];for(const[p,y]of r){const _=l[l.length-1];l.push({fixed:p-_.stretch,stretch:_.stretch}),l.push({fixed:p-_.stretch,stretch:_.stretch+(y-p)})}return l.push({fixed:i+Ql,stretch:s}),l}function Jd(r,i,s,l){return r/i*s+l}function Qd(r,i,s,l){return r-i*s/l}class ep{constructor(i,s,l,p,y,_,w,S,C,P){var M;if(this.boxStartIndex=i.length,C){let R=_.top,j=_.bottom;const U=_.collisionPadding;U&&(R-=U[1],j+=U[3]);let $=j-R;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{const R=!((M=_.image)===null||M===void 0)&&M.content&&(_.image.textFitWidth||_.image.textFitHeight)?Ix(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};R.y1=R.y1*w-S[0],R.y2=R.y2*w+S[2],R.x1=R.x1*w-S[3],R.x2=R.x2*w+S[1];const j=_.collisionPadding;if(j&&(R.x1-=j[0]*w,R.y1-=j[1]*w,R.x2+=j[2]*w,R.y2+=j[3]*w),P){const U=new L(R.x1,R.y1),$=new L(R.x2,R.y1),Y=new L(R.x1,R.y2),te=new L(R.x2,R.y2),me=P*Math.PI/180;U._rotate(me),$._rotate(me),Y._rotate(me),te._rotate(me),R.x1=Math.min(U.x,$.x,Y.x,te.x),R.x2=Math.max(U.x,$.x,Y.x,te.x),R.y1=Math.min(U.y,$.y,Y.y,te.y),R.y2=Math.max(U.y,$.y,Y.y,te.y)}i.emplaceBack(s.x,s.y,R.x1,R.y1,R.x2,R.y2,l,p,y)}this.boxEndIndex=i.length}}class lC{constructor(i=[],s=(l,p)=>l<p?-1:l>p?1:0){if(this.data=i,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:s,compare:l}=this,p=s[i];for(;i>0;){const y=i-1>>1,_=s[y];if(l(p,_)>=0)break;s[i]=_,i=y}s[i]=p}_down(i){const{data:s,compare:l}=this,p=this.length>>1,y=s[i];for(;i<p;){let _=1+(i<<1);const w=_+1;if(w<this.length&&l(s[w],s[_])<0&&(_=w),l(s[_],y)>=0)break;s[i]=s[_],i=_}s[i]=y}}function cC(r,i=1,s=!1){let l=1/0,p=1/0,y=-1/0,_=-1/0;const w=r[0];for(let j=0;j<w.length;j++){const U=w[j];(!j||U.x<l)&&(l=U.x),(!j||U.y<p)&&(p=U.y),(!j||U.x>y)&&(y=U.x),(!j||U.y>_)&&(_=U.y)}const S=Math.min(y-l,_-p);let C=S/2;const P=new lC([],uC);if(S===0)return new L(l,p);for(let j=l;j<y;j+=S)for(let U=p;U<_;U+=S)P.push(new ec(j+C,U+C,C,r));let M=function(j){let U=0,$=0,Y=0;const te=j[0];for(let me=0,oe=te.length,pe=oe-1;me<oe;pe=me++){const be=te[me],ze=te[pe],Ze=be.x*ze.y-ze.x*be.y;$+=(be.x+ze.x)*Ze,Y+=(be.y+ze.y)*Ze,U+=3*Ze}return new ec($/U,Y/U,0,j)}(r),R=P.length;for(;P.length;){const j=P.pop();(j.d>M.d||!M.d)&&(M=j,s&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,R)),j.max-M.d<=i||(C=j.h/2,P.push(new ec(j.p.x-C,j.p.y-C,C,r)),P.push(new ec(j.p.x+C,j.p.y-C,C,r)),P.push(new ec(j.p.x-C,j.p.y+C,C,r)),P.push(new ec(j.p.x+C,j.p.y+C,C,r)),R+=4)}return s&&(console.log(`num probes: ${R}`),console.log(`best distance: ${M.d}`)),M.p}function uC(r,i){return i.max-r.max}function ec(r,i,s,l){this.p=new L(r,i),this.h=s,this.d=function(p,y){let _=!1,w=1/0;for(let S=0;S<y.length;S++){const C=y[S];for(let P=0,M=C.length,R=M-1;P<M;R=P++){const j=C[P],U=C[R];j.y>p.y!=U.y>p.y&&p.x<(U.x-j.x)*(p.y-j.y)/(U.y-j.y)+j.x&&(_=!_),w=Math.min(w,jv(p,j,U))}}return(_?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var qi;v.aq=void 0,(qi=v.aq||(v.aq={}))[qi.center=1]="center",qi[qi.left=2]="left",qi[qi.right=3]="right",qi[qi.top=4]="top",qi[qi.bottom=5]="bottom",qi[qi["top-left"]=6]="top-left",qi[qi["top-right"]=7]="top-right",qi[qi["bottom-left"]=8]="bottom-left",qi[qi["bottom-right"]=9]="bottom-right";const Oa=7,Gm=Number.POSITIVE_INFINITY;function n0(r,i){return i[1]!==Gm?function(s,l,p){let y=0,_=0;switch(l=Math.abs(l),p=Math.abs(p),s){case"top-right":case"top-left":case"top":_=p-Oa;break;case"bottom-right":case"bottom-left":case"bottom":_=-p+Oa}switch(s){case"top-right":case"bottom-right":case"right":y=-l;break;case"top-left":case"bottom-left":case"left":y=l}return[y,_]}(r,i[0],i[1]):function(s,l){let p=0,y=0;l<0&&(l=0);const _=l/Math.SQRT2;switch(s){case"top-right":case"top-left":y=_-Oa;break;case"bottom-right":case"bottom-left":y=-_+Oa;break;case"bottom":y=-l+Oa;break;case"top":y=l-Oa}switch(s){case"top-right":case"bottom-right":p=-_;break;case"top-left":case"bottom-left":p=_;break;case"left":p=l;break;case"right":p=-l}return[p,y]}(r,i[0])}function r0(r,i,s){var l;const p=r.layout,y=(l=p.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(i,{},s);if(y){const w=y.values,S=[];for(let C=0;C<w.length;C+=2){const P=S[C]=w[C],M=w[C+1].map(R=>R*ki);P.startsWith("top")?M[1]-=Oa:P.startsWith("bottom")&&(M[1]+=Oa),S[C+1]=M}return new Un(S)}const _=p.get("text-variable-anchor");if(_){let w;w=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(i,{},s)*ki,Gm]:p.get("text-offset").evaluate(i,{},s).map(C=>C*ki);const S=[];for(const C of _)S.push(C,n0(C,w));return new Un(S)}return null}function Hm(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function hC(r,i,s,l,p,y,_,w,S,C,P){let M=y.textMaxSize.evaluate(i,{});M===void 0&&(M=_);const R=r.layers[0].layout,j=R.get("icon-offset").evaluate(i,{},P),U=a0(s.horizontal),$=_/24,Y=r.tilePixelRatio*$,te=r.tilePixelRatio*M/24,me=r.tilePixelRatio*w,oe=r.tilePixelRatio*R.get("symbol-spacing"),pe=R.get("text-padding")*r.tilePixelRatio,be=function(Pe,it,et,gt=1){const Ht=Pe.get("icon-padding").evaluate(it,{},et),Gt=Ht&&Ht.values;return[Gt[0]*gt,Gt[1]*gt,Gt[2]*gt,Gt[3]*gt]}(R,i,P,r.tilePixelRatio),ze=R.get("text-max-angle")/180*Math.PI,Ze=R.get("text-rotation-alignment")!=="viewport"&&R.get("symbol-placement")!=="point",ct=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",He=R.get("symbol-placement"),Ue=oe/2,tt=R.get("icon-text-fit");let Ye;l&&tt!=="none"&&(r.allowVerticalPlacement&&s.vertical&&(Ye=Ax(l,s.vertical,tt,R.get("icon-text-fit-padding"),j,$)),U&&(l=Ax(l,U,tt,R.get("icon-text-fit-padding"),j,$)));const Xe=(Pe,it)=>{it.x<0||it.x>=bi||it.y<0||it.y>=bi||function(et,gt,Ht,Gt,Ai,Er,Zi,Mi,yn,_n,vn,hi,Ei,nn,Wi,xn,Xi,fr,Dn,Dt,Zt,ei,Xn,si,tc){const ms=et.addToLineVertexArray(gt,Ht);let gs,zr,mr,Bi,Gs=0,Xu=0,u0=0,h0=0,Qm=-1,eg=-1;const Hs={};let d0=Nl("");if(et.allowVerticalPlacement&&Gt.vertical){const rn=Mi.layout.get("text-rotate").evaluate(Zt,{},si)+90;mr=new ep(yn,gt,_n,vn,hi,Gt.vertical,Ei,nn,Wi,rn),Zi&&(Bi=new ep(yn,gt,_n,vn,hi,Zi,Xi,fr,Wi,rn))}if(Ai){const rn=Mi.layout.get("icon-rotate").evaluate(Zt,{}),gr=Mi.layout.get("icon-text-fit")!=="none",No=t0(Ai,rn,Xn,gr),Xr=Zi?t0(Zi,rn,Xn,gr):void 0;zr=new ep(yn,gt,_n,vn,hi,Ai,Xi,fr,!1,rn),Gs=4*No.length;const Uo=et.iconSizeData;let ys=null;Uo.kind==="source"?(ys=[fs*Mi.layout.get("icon-size").evaluate(Zt,{})],ys[0]>Ra&&Xt(`${et.layerIds[0]}: Value for "icon-size" is >= ${Gu}. Reduce your "icon-size".`)):Uo.kind==="composite"&&(ys=[fs*ei.compositeIconSizes[0].evaluate(Zt,{},si),fs*ei.compositeIconSizes[1].evaluate(Zt,{},si)],(ys[0]>Ra||ys[1]>Ra)&&Xt(`${et.layerIds[0]}: Value for "icon-size" is >= ${Gu}. Reduce your "icon-size".`)),et.addSymbols(et.icon,No,ys,Dt,Dn,Zt,v.ah.none,gt,ms.lineStartIndex,ms.lineLength,-1,si),Qm=et.icon.placedSymbolArray.length-1,Xr&&(Xu=4*Xr.length,et.addSymbols(et.icon,Xr,ys,Dt,Dn,Zt,v.ah.vertical,gt,ms.lineStartIndex,ms.lineLength,-1,si),eg=et.icon.placedSymbolArray.length-1)}const p0=Object.keys(Gt.horizontal);for(const rn of p0){const gr=Gt.horizontal[rn];if(!gs){d0=Nl(gr.text);const Xr=Mi.layout.get("text-rotate").evaluate(Zt,{},si);gs=new ep(yn,gt,_n,vn,hi,gr,Ei,nn,Wi,Xr)}const No=gr.positionedLines.length===1;if(u0+=s0(et,gt,gr,Er,Mi,Wi,Zt,xn,ms,Gt.vertical?v.ah.horizontal:v.ah.horizontalOnly,No?p0:[rn],Hs,Qm,ei,si),No)break}Gt.vertical&&(h0+=s0(et,gt,Gt.vertical,Er,Mi,Wi,Zt,xn,ms,v.ah.vertical,["vertical"],Hs,eg,ei,si));const fC=gs?gs.boxStartIndex:et.collisionBoxArray.length,mC=gs?gs.boxEndIndex:et.collisionBoxArray.length,gC=mr?mr.boxStartIndex:et.collisionBoxArray.length,yC=mr?mr.boxEndIndex:et.collisionBoxArray.length,_C=zr?zr.boxStartIndex:et.collisionBoxArray.length,vC=zr?zr.boxEndIndex:et.collisionBoxArray.length,xC=Bi?Bi.boxStartIndex:et.collisionBoxArray.length,wC=Bi?Bi.boxEndIndex:et.collisionBoxArray.length;let Wr=-1;const ip=(rn,gr)=>rn&&rn.circleDiameter?Math.max(rn.circleDiameter,gr):gr;Wr=ip(gs,Wr),Wr=ip(mr,Wr),Wr=ip(zr,Wr),Wr=ip(Bi,Wr);const f0=Wr>-1?1:0;f0&&(Wr*=tc/ki),et.glyphOffsetArray.length>=Jl.MAX_GLYPHS&&Xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zt.sortKey!==void 0&&et.addToSortKeyRanges(et.symbolInstances.length,Zt.sortKey);const bC=r0(Mi,Zt,si),[SC,TC]=function(rn,gr){const No=rn.length,Xr=gr==null?void 0:gr.values;if((Xr==null?void 0:Xr.length)>0)for(let Uo=0;Uo<Xr.length;Uo+=2){const ys=Xr[Uo+1];rn.emplaceBack(v.aq[Xr[Uo]],ys[0],ys[1])}return[No,rn.length]}(et.textAnchorOffsets,bC);et.symbolInstances.emplaceBack(gt.x,gt.y,Hs.right>=0?Hs.right:-1,Hs.center>=0?Hs.center:-1,Hs.left>=0?Hs.left:-1,Hs.vertical||-1,Qm,eg,d0,fC,mC,gC,yC,_C,vC,xC,wC,_n,u0,h0,Gs,Xu,f0,0,Ei,Wr,SC,TC)}(r,it,Pe,s,l,p,Ye,r.layers[0],r.collisionBoxArray,i.index,i.sourceLayerIndex,r.index,Y,[pe,pe,pe,pe],Ze,S,me,be,ct,j,i,y,C,P,_)};if(He==="line")for(const Pe of Xx(i.geometry,0,0,bi,bi)){const it=oC(Pe,oe,ze,s.vertical||U,l,24,te,r.overscaling,bi);for(const et of it)U&&dC(r,U.text,Ue,et)||Xe(Pe,et)}else if(He==="line-center"){for(const Pe of i.geometry)if(Pe.length>1){const it=aC(Pe,ze,s.vertical||U,l,24,te);it&&Xe(Pe,it)}}else if(i.type==="Polygon")for(const Pe of yl(i.geometry,0)){const it=cC(Pe,16);Xe(Pe[0],new Fa(it.x,it.y,0))}else if(i.type==="LineString")for(const Pe of i.geometry)Xe(Pe,new Fa(Pe[0].x,Pe[0].y,0));else if(i.type==="Point")for(const Pe of i.geometry)for(const it of Pe)Xe([it],new Fa(it.x,it.y,0))}function s0(r,i,s,l,p,y,_,w,S,C,P,M,R,j,U){const $=function(me,oe,pe,be,ze,Ze,ct,He){const Ue=be.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,tt=[];for(const Ye of oe.positionedLines)for(const Xe of Ye.positionedGlyphs){if(!Xe.rect)continue;const Pe=Xe.rect||{};let it=wx+1,et=!0,gt=1,Ht=0;const Gt=(ze||He)&&Xe.vertical,Ai=Xe.metrics.advance*Xe.scale/2;if(He&&oe.verticalizable&&(Ht=Ye.lineOffset/2-(Xe.imageName?-(ki-Xe.metrics.width*Xe.scale)/2:(Xe.scale-1)*ki)),Xe.imageName){const Dt=ct[Xe.imageName];et=Dt.sdf,gt=Dt.pixelRatio,it=zn/gt}const Er=ze?[Xe.x+Ai,Xe.y]:[0,0];let Zi=ze?[0,0]:[Xe.x+Ai+pe[0],Xe.y+pe[1]-Ht],Mi=[0,0];Gt&&(Mi=Zi,Zi=[0,0]);const yn=Xe.metrics.isDoubleResolution?2:1,_n=(Xe.metrics.left-it)*Xe.scale-Ai+Zi[0],vn=(-Xe.metrics.top-it)*Xe.scale+Zi[1],hi=_n+Pe.w/yn*Xe.scale/gt,Ei=vn+Pe.h/yn*Xe.scale/gt,nn=new L(_n,vn),Wi=new L(hi,vn),xn=new L(_n,Ei),Xi=new L(hi,Ei);if(Gt){const Dt=new L(-Ai,Ai-Uu),Zt=-Math.PI/2,ei=ki/2-Ai,Xn=new L(5-Uu-ei,-(Xe.imageName?ei:0)),si=new L(...Mi);nn._rotateAround(Zt,Dt)._add(Xn)._add(si),Wi._rotateAround(Zt,Dt)._add(Xn)._add(si),xn._rotateAround(Zt,Dt)._add(Xn)._add(si),Xi._rotateAround(Zt,Dt)._add(Xn)._add(si)}if(Ue){const Dt=Math.sin(Ue),Zt=Math.cos(Ue),ei=[Zt,-Dt,Dt,Zt];nn._matMult(ei),Wi._matMult(ei),xn._matMult(ei),Xi._matMult(ei)}const fr=new L(0,0),Dn=new L(0,0);tt.push({tl:nn,tr:Wi,bl:xn,br:Xi,tex:Pe,writingMode:oe.writingMode,glyphOffset:Er,sectionIndex:Xe.sectionIndex,isSDF:et,pixelOffsetTL:fr,pixelOffsetBR:Dn,minFontScaleX:0,minFontScaleY:0})}return tt}(0,s,w,p,y,_,l,r.allowVerticalPlacement),Y=r.textSizeData;let te=null;Y.kind==="source"?(te=[fs*p.layout.get("text-size").evaluate(_,{})],te[0]>Ra&&Xt(`${r.layerIds[0]}: Value for "text-size" is >= ${Gu}. Reduce your "text-size".`)):Y.kind==="composite"&&(te=[fs*j.compositeTextSizes[0].evaluate(_,{},U),fs*j.compositeTextSizes[1].evaluate(_,{},U)],(te[0]>Ra||te[1]>Ra)&&Xt(`${r.layerIds[0]}: Value for "text-size" is >= ${Gu}. Reduce your "text-size".`)),r.addSymbols(r.text,$,te,w,y,_,C,i,S.lineStartIndex,S.lineLength,R,U);for(const me of P)M[me]=r.text.placedSymbolArray.length-1;return 4*$.length}function a0(r){for(const i in r)return r[i];return null}function dC(r,i,s,l){const p=r.compareText;if(i in p){const y=p[i];for(let _=y.length-1;_>=0;_--)if(l.dist(y[_])<s)return!0}else p[i]=[];return p[i].push(l),!1}const o0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class qm{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(i,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=l>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=o0[15&l];if(!y)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(i,2,1),[w]=new Uint32Array(i,4,1);return new qm(w,_,y,i)}constructor(i,s=64,l=Float64Array,p){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const y=o0.indexOf(this.ArrayType),_=2*i*this.ArrayType.BYTES_PER_ELEMENT,w=i*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-w%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${l}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+w+S,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+_+w+S),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+w+S,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=i)}add(i,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=i,this.coords[this._pos++]=s,l}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return Zm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,s,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:_,nodeSize:w}=this,S=[0,y.length-1,0],C=[];for(;S.length;){const P=S.pop()||0,M=S.pop()||0,R=S.pop()||0;if(M-R<=w){for(let Y=R;Y<=M;Y++){const te=_[2*Y],me=_[2*Y+1];te>=i&&te<=l&&me>=s&&me<=p&&C.push(y[Y])}continue}const j=R+M>>1,U=_[2*j],$=_[2*j+1];U>=i&&U<=l&&$>=s&&$<=p&&C.push(y[j]),(P===0?i<=U:s<=$)&&(S.push(R),S.push(j-1),S.push(1-P)),(P===0?l>=U:p>=$)&&(S.push(j+1),S.push(M),S.push(1-P))}return C}within(i,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:_}=this,w=[0,p.length-1,0],S=[],C=l*l;for(;w.length;){const P=w.pop()||0,M=w.pop()||0,R=w.pop()||0;if(M-R<=_){for(let Y=R;Y<=M;Y++)c0(y[2*Y],y[2*Y+1],i,s)<=C&&S.push(p[Y]);continue}const j=R+M>>1,U=y[2*j],$=y[2*j+1];c0(U,$,i,s)<=C&&S.push(p[j]),(P===0?i-l<=U:s-l<=$)&&(w.push(R),w.push(j-1),w.push(1-P)),(P===0?i+l>=U:s+l>=$)&&(w.push(j+1),w.push(M),w.push(1-P))}return S}}function Zm(r,i,s,l,p,y){if(p-l<=s)return;const _=l+p>>1;l0(r,i,_,l,p,y),Zm(r,i,s,l,_-1,1-y),Zm(r,i,s,_+1,p,1-y)}function l0(r,i,s,l,p,y){for(;p>l;){if(p-l>600){const C=p-l+1,P=s-l+1,M=Math.log(C),R=.5*Math.exp(2*M/3),j=.5*Math.sqrt(M*R*(C-R)/C)*(P-C/2<0?-1:1);l0(r,i,s,Math.max(l,Math.floor(s-P*R/C+j)),Math.min(p,Math.floor(s+(C-P)*R/C+j)),y)}const _=i[2*s+y];let w=l,S=p;for(Zu(r,i,l,s),i[2*p+y]>_&&Zu(r,i,l,p);w<S;){for(Zu(r,i,w,S),w++,S--;i[2*w+y]<_;)w++;for(;i[2*S+y]>_;)S--}i[2*l+y]===_?Zu(r,i,l,S):(S++,Zu(r,i,S,p)),S<=s&&(l=S+1),s<=S&&(p=S-1)}}function Zu(r,i,s,l){Wm(r,s,l),Wm(i,2*s,2*l),Wm(i,2*s+1,2*l+1)}function Wm(r,i,s){const l=r[i];r[i]=r[s],r[s]=l}function c0(r,i,s,l){const p=r-s,y=i-l;return p*p+y*y}var Xm;v.bg=void 0,(Xm=v.bg||(v.bg={})).create="create",Xm.load="load",Xm.fullLoad="fullLoad";let tp=null,Wu=[];const Km=1e3/60,Ym="loadTime",Jm="fullLoadTime",pC={mark(r){performance.mark(r)},frame(r){const i=r;tp!=null&&Wu.push(i-tp),tp=i},clearMetrics(){tp=null,Wu=[],performance.clearMeasures(Ym),performance.clearMeasures(Jm);for(const r in v.bg)performance.clearMarks(v.bg[r])},getPerformanceMetrics(){performance.measure(Ym,v.bg.create,v.bg.load),performance.measure(Jm,v.bg.create,v.bg.fullLoad);const r=performance.getEntriesByName(Ym)[0].duration,i=performance.getEntriesByName(Jm)[0].duration,s=Wu.length,l=1/(Wu.reduce((y,_)=>y+_,0)/s/1e3),p=Wu.filter(y=>y>Km).reduce((y,_)=>y+(_-Km)/Km,0);return{loadTime:r,fullLoadTime:i,fps:l,percentDroppedFrames:p/(s+p)*100,totalFrames:s}}};v.$=class extends E{},v.A=ql,v.B=am,v.C=function(r){if(tr==null){const i=r.navigator?r.navigator.userAgent:null;tr=!!r.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return tr},v.D=Je,v.E=ra,v.F=class{constructor(r,i){this.target=r,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new rC(()=>this.process()),this.subscription=function(s,l,p,y){return s.addEventListener(l,p,!1),{unsubscribe:()=>{s.removeEventListener(l,p,!1)}}}(this.target,"message",s=>this.receive(s)),this.globalScope=cn(self)?r:window}registerMessageHandler(r,i){this.messageHandlers[r]=i}sendAsync(r,i){return new Promise((s,l)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[p]={resolve:s,reject:l},i&&i.signal.addEventListener("abort",()=>{delete this.resolveRejects[p];const w={id:p,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},{once:!0});const y=[],_=Object.assign(Object.assign({},r),{id:p,sourceMapId:this.mapId,origin:location.origin,data:Sa(r.data,y)});this.target.postMessage(_,{transfer:y})})}receive(r){const i=r.data,s=i.id;if(!(i.origin!=="file://"&&location.origin!=="file://"&&i.origin!=="resource://android"&&location.origin!=="resource://android"&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if(i.type==="<cancel>"){delete this.tasks[s];const l=this.abortControllers[s];return delete this.abortControllers[s],void(l&&l.abort())}if(cn(self)||i.mustQueue)return this.tasks[s]=i,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,i)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),i=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(r,i)}processTask(r,i){return c(this,void 0,void 0,function*(){if(i.type==="<response>"){const p=this.resolveRejects[r];return delete this.resolveRejects[r],p?void(i.error?p.reject(Ta(i.error)):p.resolve(Ta(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=Ta(i.data),l=new AbortController;this.abortControllers[r]=l;try{const p=yield this.messageHandlers[i.type](i.sourceMapId,s,l);this.completeTask(r,null,p)}catch(p){this.completeTask(r,p)}})}completeTask(r,i,s){const l=[];delete this.abortControllers[r];const p={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?Sa(i):null,data:Sa(s,l)};this.target.postMessage(p,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.G=hn,v.H=function(){var r=new ql(16);return ql!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},v.I=Dm,v.J=function(r,i,s){var l,p,y,_,w,S,C,P,M,R,j,U,$=s[0],Y=s[1],te=s[2];return i===r?(r[12]=i[0]*$+i[4]*Y+i[8]*te+i[12],r[13]=i[1]*$+i[5]*Y+i[9]*te+i[13],r[14]=i[2]*$+i[6]*Y+i[10]*te+i[14],r[15]=i[3]*$+i[7]*Y+i[11]*te+i[15]):(p=i[1],y=i[2],_=i[3],w=i[4],S=i[5],C=i[6],P=i[7],M=i[8],R=i[9],j=i[10],U=i[11],r[0]=l=i[0],r[1]=p,r[2]=y,r[3]=_,r[4]=w,r[5]=S,r[6]=C,r[7]=P,r[8]=M,r[9]=R,r[10]=j,r[11]=U,r[12]=l*$+w*Y+M*te+i[12],r[13]=p*$+S*Y+R*te+i[13],r[14]=y*$+C*Y+j*te+i[14],r[15]=_*$+P*Y+U*te+i[15]),r},v.K=function(r,i,s){var l=s[0],p=s[1],y=s[2];return r[0]=i[0]*l,r[1]=i[1]*l,r[2]=i[2]*l,r[3]=i[3]*l,r[4]=i[4]*p,r[5]=i[5]*p,r[6]=i[6]*p,r[7]=i[7]*p,r[8]=i[8]*y,r[9]=i[9]*y,r[10]=i[10]*y,r[11]=i[11]*y,r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r},v.L=$v,v.M=function(r,i){const s={};for(let l=0;l<i.length;l++){const p=i[l];p in r&&(s[p]=r[p])}return s},v.N=Ba,v.O=Ox,v.P=L,v.Q=jx,v.R=dr,v.S=pr,v.T=Bl,v.U=X,v.V=Z,v.W=ut,v.X=bi,v.Y=b,v.Z=Hu,v._=c,v.a=Ni,v.a$=function(r,i){var s=r[0],l=r[1],p=r[2],y=r[3],_=r[4],w=r[5],S=r[6],C=r[7],P=r[8],M=r[9],R=r[10],j=r[11],U=r[12],$=r[13],Y=r[14],te=r[15],me=i[0],oe=i[1],pe=i[2],be=i[3],ze=i[4],Ze=i[5],ct=i[6],He=i[7],Ue=i[8],tt=i[9],Ye=i[10],Xe=i[11],Pe=i[12],it=i[13],et=i[14],gt=i[15];return Math.abs(s-me)<=gn*Math.max(1,Math.abs(s),Math.abs(me))&&Math.abs(l-oe)<=gn*Math.max(1,Math.abs(l),Math.abs(oe))&&Math.abs(p-pe)<=gn*Math.max(1,Math.abs(p),Math.abs(pe))&&Math.abs(y-be)<=gn*Math.max(1,Math.abs(y),Math.abs(be))&&Math.abs(_-ze)<=gn*Math.max(1,Math.abs(_),Math.abs(ze))&&Math.abs(w-Ze)<=gn*Math.max(1,Math.abs(w),Math.abs(Ze))&&Math.abs(S-ct)<=gn*Math.max(1,Math.abs(S),Math.abs(ct))&&Math.abs(C-He)<=gn*Math.max(1,Math.abs(C),Math.abs(He))&&Math.abs(P-Ue)<=gn*Math.max(1,Math.abs(P),Math.abs(Ue))&&Math.abs(M-tt)<=gn*Math.max(1,Math.abs(M),Math.abs(tt))&&Math.abs(R-Ye)<=gn*Math.max(1,Math.abs(R),Math.abs(Ye))&&Math.abs(j-Xe)<=gn*Math.max(1,Math.abs(j),Math.abs(Xe))&&Math.abs(U-Pe)<=gn*Math.max(1,Math.abs(U),Math.abs(Pe))&&Math.abs($-it)<=gn*Math.max(1,Math.abs($),Math.abs(it))&&Math.abs(Y-et)<=gn*Math.max(1,Math.abs(Y),Math.abs(et))&&Math.abs(te-gt)<=gn*Math.max(1,Math.abs(te),Math.abs(gt))},v.a0=It,v.a1=$m,v.a2=Re,v.a3=r=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(s=>{i.onloadstart=()=>{s(i)};for(const l of r){const p=window.document.createElement("source");Ps(l)||(i.crossOrigin="Anonymous"),p.src=l,i.appendChild(p)}})},v.a4=function(){return Me++},v.a5=qe,v.a6=Jl,v.a7=hu,v.a8=jo,v.a9=Hx,v.aA=function(r){if(r.type==="custom")return new nC(r);switch(r.type){case"background":return new eC(r);case"circle":return new NT(r);case"fill":return new rk(r);case"fill-extrusion":return new vk(r);case"heatmap":return new $T(r);case"hillshade":return new HT(r);case"line":return new Pk(r);case"raster":return new iC(r);case"symbol":return new Kd(r)}},v.aB=pt,v.aC=function(r,i){if(!r)return[{command:"setStyle",args:[i]}];let s=[];try{if(!Lt(r.version,i.version))return[{command:"setStyle",args:[i]}];Lt(r.center,i.center)||s.push({command:"setCenter",args:[i.center]}),Lt(r.zoom,i.zoom)||s.push({command:"setZoom",args:[i.zoom]}),Lt(r.bearing,i.bearing)||s.push({command:"setBearing",args:[i.bearing]}),Lt(r.pitch,i.pitch)||s.push({command:"setPitch",args:[i.pitch]}),Lt(r.sprite,i.sprite)||s.push({command:"setSprite",args:[i.sprite]}),Lt(r.glyphs,i.glyphs)||s.push({command:"setGlyphs",args:[i.glyphs]}),Lt(r.transition,i.transition)||s.push({command:"setTransition",args:[i.transition]}),Lt(r.light,i.light)||s.push({command:"setLight",args:[i.light]}),Lt(r.terrain,i.terrain)||s.push({command:"setTerrain",args:[i.terrain]}),Lt(r.sky,i.sky)||s.push({command:"setSky",args:[i.sky]}),Lt(r.projection,i.projection)||s.push({command:"setProjection",args:[i.projection]});const l={},p=[];(function(_,w,S,C){let P;for(P in w=w||{},_=_||{})Object.prototype.hasOwnProperty.call(_,P)&&(Object.prototype.hasOwnProperty.call(w,P)||os(P,S,C));for(P in w)Object.prototype.hasOwnProperty.call(w,P)&&(Object.prototype.hasOwnProperty.call(_,P)?Lt(_[P],w[P])||(_[P].type==="geojson"&&w[P].type==="geojson"&&sa(_,w,P)?ni(S,{command:"setGeoJSONSourceData",args:[P,w[P].data]}):$r(P,w,S,C)):po(P,w,S))})(r.sources,i.sources,p,l);const y=[];r.layers&&r.layers.forEach(_=>{"source"in _&&l[_.source]?s.push({command:"removeLayer",args:[_.id]}):y.push(_)}),s=s.concat(p),function(_,w,S){w=w||[];const C=(_=_||[]).map(fo),P=w.map(fo),M=_.reduce(mo,{}),R=w.reduce(mo,{}),j=C.slice(),U=Object.create(null);let $,Y,te,me,oe;for(let pe=0,be=0;pe<C.length;pe++)$=C[pe],Object.prototype.hasOwnProperty.call(R,$)?be++:(ni(S,{command:"removeLayer",args:[$]}),j.splice(j.indexOf($,be),1));for(let pe=0,be=0;pe<P.length;pe++)$=P[P.length-1-pe],j[j.length-1-pe]!==$&&(Object.prototype.hasOwnProperty.call(M,$)?(ni(S,{command:"removeLayer",args:[$]}),j.splice(j.lastIndexOf($,j.length-be),1)):be++,me=j[j.length-pe],ni(S,{command:"addLayer",args:[R[$],me]}),j.splice(j.length-pe,0,$),U[$]=!0);for(let pe=0;pe<P.length;pe++)if($=P[pe],Y=M[$],te=R[$],!U[$]&&!Lt(Y,te))if(Lt(Y.source,te.source)&&Lt(Y["source-layer"],te["source-layer"])&&Lt(Y.type,te.type)){for(oe in Nn(Y.layout,te.layout,S,$,null,"setLayoutProperty"),Nn(Y.paint,te.paint,S,$,null,"setPaintProperty"),Lt(Y.filter,te.filter)||ni(S,{command:"setFilter",args:[$,te.filter]}),Lt(Y.minzoom,te.minzoom)&&Lt(Y.maxzoom,te.maxzoom)||ni(S,{command:"setLayerZoomRange",args:[$,te.minzoom,te.maxzoom]}),Y)Object.prototype.hasOwnProperty.call(Y,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?Nn(Y[oe],te[oe],S,$,oe.slice(6),"setPaintProperty"):Lt(Y[oe],te[oe])||ni(S,{command:"setLayerProperty",args:[$,oe,te[oe]]}));for(oe in te)Object.prototype.hasOwnProperty.call(te,oe)&&!Object.prototype.hasOwnProperty.call(Y,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?Nn(Y[oe],te[oe],S,$,oe.slice(6),"setPaintProperty"):Lt(Y[oe],te[oe])||ni(S,{command:"setLayerProperty",args:[$,oe,te[oe]]}))}else ni(S,{command:"removeLayer",args:[$]}),me=j[j.lastIndexOf($)+1],ni(S,{command:"addLayer",args:[te,me]})}(y,i.layers,s)}catch(l){console.warn("Unable to compute style diff:",l),s=[{command:"setStyle",args:[i]}]}return s},v.aD=function(r){const i=[],s=r.id;return s===void 0&&i.push({message:`layers.${s}: missing required property "id"`}),r.render===void 0&&i.push({message:`layers.${s}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&i.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),i},v.aE=function r(i,s){if(Array.isArray(i)){if(!Array.isArray(s)||i.length!==s.length)return!1;for(let l=0;l<i.length;l++)if(!r(i[l],s[l]))return!1;return!0}if(typeof i=="object"&&i!==null&&s!==null){if(typeof s!="object"||Object.keys(i).length!==Object.keys(s).length)return!1;for(const l in i)if(!r(i[l],s[l]))return!1;return!0}return i===s},v.aF=ot,v.aG=at,v.aH=class extends Bo{constructor(r,i){super(r,i),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},v.aI=Fd,v.aJ=class extends Bo{constructor(r,i){super(r,i),this.current=DT}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let i=1;i<16;i++)if(r[i]!==this.current[i]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},v.aK=zv,v.aL=Dv,v.aM=Nt,v.aN=class extends Bo{constructor(r,i){super(r,i),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},v.aO=class extends Bo{constructor(r,i){super(r,i),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},v.aP=function(r,i,s,l,p,y,_){var w=1/(i-s),S=1/(l-p),C=1/(y-_);return r[0]=-2*w,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*S,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*C,r[11]=0,r[12]=(i+s)*w,r[13]=(p+l)*S,r[14]=(_+y)*C,r[15]=1,r},v.aQ=VT,v.aR=class extends ue{},v.aS=Ek,v.aT=class extends ye{},v.aU=wm,v.aV=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},v.aW=Wv,v.aX=Gi,v.aY=hr,v.aZ=class extends Qe{},v.a_=function(r,i){return r[0]===i[0]&&r[1]===i[1]&&r[2]===i[2]&&r[3]===i[3]&&r[4]===i[4]&&r[5]===i[5]&&r[6]===i[6]&&r[7]===i[7]&&r[8]===i[8]&&r[9]===i[9]&&r[10]===i[10]&&r[11]===i[11]&&r[12]===i[12]&&r[13]===i[13]&&r[14]===i[14]&&r[15]===i[15]},v.aa=function(r){const i={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,p,y)=>{const _=p||y;return i[l]=!_||_.toLowerCase(),""}),i["max-age"]){const s=parseInt(i["max-age"],10);isNaN(s)?delete i["max-age"]:i["max-age"]=s}return i},v.ab=function(r,i){const s=[];for(const l in r)l in i||s.push(l);return s},v.ac=Se,v.ad=function(r,i,s){var l=Math.sin(s),p=Math.cos(s),y=i[0],_=i[1],w=i[2],S=i[3],C=i[4],P=i[5],M=i[6],R=i[7];return i!==r&&(r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15]),r[0]=y*p+C*l,r[1]=_*p+P*l,r[2]=w*p+M*l,r[3]=S*p+R*l,r[4]=C*p-y*l,r[5]=P*p-_*l,r[6]=M*p-w*l,r[7]=R*p-S*l,r},v.ae=function(r){var i=new ql(16);return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},v.af=Nd,v.ag=function(r,i){let s=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:p,minZoom:y,maxZoom:_}=r,w=p?Se(fn.interpolationFactor(p,i,y,_),0,1):0;r.kind==="camera"?l=pn.number(r.minSize,r.maxSize,w):s=w}return{uSizeT:s,uSize:l}},v.ai=function(r,{uSize:i,uSizeT:s},{lowerSize:l,upperSize:p}){return r.kind==="source"?l/fs:r.kind==="composite"?pn.number(l/fs,p/fs,s):i},v.aj=Fm,v.ak=function(r,i,s,l){const p=i.y-r.y,y=i.x-r.x,_=l.y-s.y,w=l.x-s.x,S=_*y-w*p;if(S===0)return null;const C=(w*(r.y-s.y)-_*(r.x-s.x))/S;return new L(r.x+C*y,r.y+C*p)},v.al=Xx,v.am=Fv,v.an=_m,v.ao=function(r){let i=1/0,s=1/0,l=-1/0,p=-1/0;for(const y of r)i=Math.min(i,y.x),s=Math.min(s,y.y),l=Math.max(l,y.x),p=Math.max(p,y.y);return[i,s,l,p]},v.ap=ki,v.ar=Bm,v.as=function(r,i){var s=i[0],l=i[1],p=i[2],y=i[3],_=i[4],w=i[5],S=i[6],C=i[7],P=i[8],M=i[9],R=i[10],j=i[11],U=i[12],$=i[13],Y=i[14],te=i[15],me=s*w-l*_,oe=s*S-p*_,pe=s*C-y*_,be=l*S-p*w,ze=l*C-y*w,Ze=p*C-y*S,ct=P*$-M*U,He=P*Y-R*U,Ue=P*te-j*U,tt=M*Y-R*$,Ye=M*te-j*$,Xe=R*te-j*Y,Pe=me*Xe-oe*Ye+pe*tt+be*Ue-ze*He+Ze*ct;return Pe?(r[0]=(w*Xe-S*Ye+C*tt)*(Pe=1/Pe),r[1]=(p*Ye-l*Xe-y*tt)*Pe,r[2]=($*Ze-Y*ze+te*be)*Pe,r[3]=(R*ze-M*Ze-j*be)*Pe,r[4]=(S*Ue-_*Xe-C*He)*Pe,r[5]=(s*Xe-p*Ue+y*He)*Pe,r[6]=(Y*pe-U*Ze-te*oe)*Pe,r[7]=(P*Ze-R*pe+j*oe)*Pe,r[8]=(_*Ye-w*Ue+C*ct)*Pe,r[9]=(l*Ue-s*Ye-y*ct)*Pe,r[10]=(U*ze-$*pe+te*me)*Pe,r[11]=(M*pe-P*ze-j*me)*Pe,r[12]=(w*He-_*tt-S*ct)*Pe,r[13]=(s*tt-l*He+p*ct)*Pe,r[14]=($*oe-U*be-Y*me)*Pe,r[15]=(P*be-M*oe+R*me)*Pe,r):null},v.at=Hm,v.au=Rm,v.av=qm,v.aw=function(){const r={},i=we.$version;for(const s in we.$root){const l=we.$root[s];if(l.required){let p=null;p=s==="version"?i:l.type==="array"?[]:{},p!=null&&(r[s]=p)}}return r},v.ax=ku,v.ay=nr,v.az=function(r){r=r.slice();const i=Object.create(null);for(let s=0;s<r.length;s++)i[r[s].id]=r[s];for(let s=0;s<r.length;s++)"ref"in r[s]&&(r[s]=ho(r[s],i[r[s].ref]));return r},v.b=Bt,v.b0=function(r,i){return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r},v.b1=function(r,i,s){return r[0]=i[0]*s[0],r[1]=i[1]*s[1],r[2]=i[2]*s[2],r[3]=i[3]*s[3],r},v.b2=function(r,i){return r[0]*i[0]+r[1]*i[1]+r[2]*i[2]+r[3]*i[3]},v.b3=ke,v.b4=Ux,v.b5=Vx,v.b6=function(r,i,s,l,p){var y,_=1/Math.tan(i/2);return r[0]=_/s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,p!=null&&p!==1/0?(r[10]=(p+l)*(y=1/(l-p)),r[14]=2*p*l*y):(r[10]=-1,r[14]=-2*l),r},v.b7=function(r,i,s){var l=Math.sin(s),p=Math.cos(s),y=i[4],_=i[5],w=i[6],S=i[7],C=i[8],P=i[9],M=i[10],R=i[11];return i!==r&&(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15]),r[4]=y*p+C*l,r[5]=_*p+P*l,r[6]=w*p+M*l,r[7]=S*p+R*l,r[8]=C*p-y*l,r[9]=P*p-_*l,r[10]=M*p-w*l,r[11]=R*p-S*l,r},v.b8=W,v.b9=ve,v.bA=fx,v.bB=function(r){return r.message===jt},v.bC=ya,v.bD=Mn,v.ba=function(r){return r*Math.PI/180},v.bb=function(r,i){const{x:s,y:l}=Hu.fromLngLat(i);return!(r<0||r>25||l<0||l>=1||s<0||s>=1)},v.bc=function(r,i){return r[0]=i[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=i[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},v.bd=class extends I{},v.be=Nm,v.bf=pC,v.bh=Pi,v.bi=function(r,i){Ni.REGISTERED_PROTOCOLS[r]=i},v.bj=function(r){delete Ni.REGISTERED_PROTOCOLS[r]},v.bk=function(r,i){const s={};for(let p=0;p<r.length;p++){const y=i&&i[r[p].id]||kd(r[p]);i&&(i[r[p].id]=y);let _=s[y];_||(_=s[y]=[]),_.push(r[p])}const l=[];for(const p in s)l.push(s[p]);return l},v.bl=Ke,v.bm=Gx,v.bn=qx,v.bo=Sx,v.bp=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=bi/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const i=r.bucket.layers[0],s=i.layout,l=i._unevaluatedLayout._values,p={layoutIconSize:l["icon-size"].possiblyEvaluate(new Kt(r.bucket.zoom+1),r.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Kt(r.bucket.zoom+1),r.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Kt(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:P}=r.bucket.textSizeData;p.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Kt(C),r.canonical),l["text-size"].possiblyEvaluate(new Kt(P),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:P}=r.bucket.iconSizeData;p.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Kt(C),r.canonical),l["icon-size"].possiblyEvaluate(new Kt(P),r.canonical)]}const y=s.get("text-line-height")*ki,_=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",w=s.get("text-keep-upright"),S=s.get("text-size");for(const C of r.bucket.features){const P=s.get("text-font").evaluate(C,{},r.canonical).join(","),M=S.evaluate(C,{},r.canonical),R=p.layoutTextSize.evaluate(C,{},r.canonical),j=p.layoutIconSize.evaluate(C,{},r.canonical),U={horizontal:{},vertical:void 0},$=C.text;let Y,te=[0,0];if($){const pe=$.toString(),be=s.get("text-letter-spacing").evaluate(C,{},r.canonical)*ki,ze=om(pe)?be:0,Ze=s.get("text-anchor").evaluate(C,{},r.canonical),ct=r0(i,C,r.canonical);if(!ct){const Ye=s.get("text-radial-offset").evaluate(C,{},r.canonical);te=Ye?n0(Ze,[Ye*ki,Gm]):s.get("text-offset").evaluate(C,{},r.canonical).map(Xe=>Xe*ki)}let He=_?"center":s.get("text-justify").evaluate(C,{},r.canonical);const Ue=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(C,{},r.canonical)*ki:1/0,tt=()=>{r.bucket.allowVerticalPlacement&&Cu(pe)&&(U.vertical=Zd($,r.glyphMap,r.glyphPositions,r.imagePositions,P,Ue,y,Ze,"left",ze,te,v.ah.vertical,!0,R,M))};if(!_&&ct){const Ye=new Set;if(He==="auto")for(let Pe=0;Pe<ct.values.length;Pe+=2)Ye.add(Hm(ct.values[Pe]));else Ye.add(He);let Xe=!1;for(const Pe of Ye)if(!U.horizontal[Pe])if(Xe)U.horizontal[Pe]=U.horizontal[0];else{const it=Zd($,r.glyphMap,r.glyphPositions,r.imagePositions,P,Ue,y,"center",Pe,ze,te,v.ah.horizontal,!1,R,M);it&&(U.horizontal[Pe]=it,Xe=it.positionedLines.length===1)}tt()}else{He==="auto"&&(He=Hm(Ze));const Ye=Zd($,r.glyphMap,r.glyphPositions,r.imagePositions,P,Ue,y,Ze,He,ze,te,v.ah.horizontal,!1,R,M);Ye&&(U.horizontal[He]=Ye),tt(),Cu(pe)&&_&&w&&(U.vertical=Zd($,r.glyphMap,r.glyphPositions,r.imagePositions,P,Ue,y,Ze,He,ze,te,v.ah.vertical,!1,R,M))}}let me=!1;if(C.icon&&C.icon.name){const pe=r.imageMap[C.icon.name];pe&&(Y=Xk(r.imagePositions[C.icon.name],s.get("icon-offset").evaluate(C,{},r.canonical),s.get("icon-anchor").evaluate(C,{},r.canonical)),me=!!pe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=me:r.bucket.sdfIcons!==me&&Xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==r.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const oe=a0(U.horizontal)||U.vertical;r.bucket.iconsInText=!!oe&&oe.iconsInText,(oe||Y)&&hC(r.bucket,C,U,Y,r.imageMap,p,R,j,te,me,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},v.bq=Am,v.br=Cm,v.bs=Im,v.bt=Da,v.bu=Em,v.bv=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},v.bw=function(r,i,s,l,p){return c(this,void 0,void 0,function*(){if(Z())try{return yield ut(r,i,s,l,p)}catch{}return function(y,_,w,S,C){const P=y.width,M=y.height;dt&&Ct||(dt=new OffscreenCanvas(P,M),Ct=dt.getContext("2d",{willReadFrequently:!0})),dt.width=P,dt.height=M,Ct.drawImage(y,0,0,P,M);const R=Ct.getImageData(_,w,S,C);return Ct.clearRect(0,0,P,M),R.data}(r,i,s,l,p)})},v.bx=$x,v.by=A,v.bz=D,v.c=ir,v.d=r=>c(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(i)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.e=Ae,v.f=r=>new Promise((i,s)=>{const l=new Image;l.onload=()=>{i(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Ge})},l.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(r)],{type:"image/png"});l.src=r.byteLength?URL.createObjectURL(p):Ge}),v.g=un,v.h=(r,i)=>Cs(Ae(r,{type:"json"}),i),v.i=cn,v.j=as,v.k=ss,v.l=(r,i)=>Cs(Ae(r,{type:"arrayBuffer"}),i),v.m=Cs,v.n=function(r){return new Em(r).readFields(Uk,[])},v.o=Ru,v.p=bx,v.q=m,v.r=sm,v.s=Ps,v.t=Su,v.u=Vs,v.v=we,v.w=Xt,v.x=function([r,i,s]){return i+=90,i*=Math.PI/180,s*=Math.PI/180,{x:r*Math.cos(i)*Math.sin(s),y:r*Math.sin(i)*Math.sin(s),z:r*Math.cos(s)}},v.y=pn,v.z=Kt}),g("worker",["./shared"],function(v){class c{constructor(O){this.keyCache={},O&&this.replace(O)}replace(O){this._layerConfigs={},this._layers={},this.update(O,[])}update(O,F){for(const J of O){this._layerConfigs[J.id]=J;const le=this._layers[J.id]=v.aA(J);le._featureFilter=v.a7(le.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of F)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const G=v.bk(Object.values(this._layerConfigs),this.keyCache);for(const J of G){const le=J.map(xe=>this._layers[xe.id]),he=le[0];if(he.visibility==="none")continue;const fe=he.source||"";let re=this.familiesBySource[fe];re||(re=this.familiesBySource[fe]={});const Te=he.sourceLayer||"_geojsonTileLayer";let Ee=re[Te];Ee||(Ee=re[Te]=[]),Ee.push(le)}}}class A{constructor(O){const F={},G=[];for(const fe in O){const re=O[fe],Te=F[fe]={};for(const Ee in re){const xe=re[+Ee];if(!xe||xe.bitmap.width===0||xe.bitmap.height===0)continue;const Fe={x:0,y:0,w:xe.bitmap.width+2,h:xe.bitmap.height+2};G.push(Fe),Te[Ee]={rect:Fe,metrics:xe.metrics}}}const{w:J,h:le}=v.p(G),he=new v.o({width:J||1,height:le||1});for(const fe in O){const re=O[fe];for(const Te in re){const Ee=re[+Te];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const xe=F[fe][Te].rect;v.o.copy(Ee.bitmap,he,{x:0,y:0},{x:xe.x+1,y:xe.y+1},Ee.bitmap)}}this.image=he,this.positions=F}}v.bl("GlyphAtlas",A);class D{constructor(O){this.tileID=new v.S(O.tileID.overscaledZ,O.tileID.wrap,O.tileID.canonical.z,O.tileID.canonical.x,O.tileID.canonical.y),this.uid=O.uid,this.zoom=O.zoom,this.pixelRatio=O.pixelRatio,this.tileSize=O.tileSize,this.source=O.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=O.showCollisionBoxes,this.collectResourceTiming=!!O.collectResourceTiming,this.returnDependencies=!!O.returnDependencies,this.promoteId=O.promoteId,this.inFlightDependencies=[]}parse(O,F,G,J){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=O,this.collisionBoxArray=new v.a5;const le=new v.bm(Object.keys(O.layers).sort()),he=new v.bn(this.tileID,this.promoteId);he.bucketLayerIDs=[];const fe={},re={featureIndex:he,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:G},Te=F.familiesBySource[this.source];for(const bt in Te){const Vt=O.layers[bt];if(!Vt)continue;Vt.version===1&&v.w(`Vector tile source "${this.source}" layer "${bt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ti=le.encode(bt),Ii=[];for(let Li=0;Li<Vt.length;Li++){const Qi=Vt.feature(Li),aa=he.getId(Qi,bt);Ii.push({feature:Qi,id:aa,index:Li,sourceLayerIndex:ti})}for(const Li of Te[bt]){const Qi=Li[0];Qi.source!==this.source&&v.w(`layer.source = ${Qi.source} does not equal this.source = ${this.source}`),Qi.minzoom&&this.zoom<Math.floor(Qi.minzoom)||Qi.maxzoom&&this.zoom>=Qi.maxzoom||Qi.visibility!=="none"&&(V(Li,this.zoom,G),(fe[Qi.id]=Qi.createBucket({index:he.bucketLayerIDs.length,layers:Li,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ti,sourceID:this.source})).populate(Ii,re,this.tileID.canonical),he.bucketLayerIDs.push(Li.map(aa=>aa.id)))}}const Ee=v.aF(re.glyphDependencies,bt=>Object.keys(bt).map(Number));this.inFlightDependencies.forEach(bt=>bt==null?void 0:bt.abort()),this.inFlightDependencies=[];let xe=Promise.resolve({});if(Object.keys(Ee).length){const bt=new AbortController;this.inFlightDependencies.push(bt),xe=J.sendAsync({type:"GG",data:{stacks:Ee,source:this.source,tileID:this.tileID,type:"glyphs"}},bt)}const Fe=Object.keys(re.iconDependencies);let rt=Promise.resolve({});if(Fe.length){const bt=new AbortController;this.inFlightDependencies.push(bt),rt=J.sendAsync({type:"GI",data:{icons:Fe,source:this.source,tileID:this.tileID,type:"icons"}},bt)}const lt=Object.keys(re.patternDependencies);let At=Promise.resolve({});if(lt.length){const bt=new AbortController;this.inFlightDependencies.push(bt),At=J.sendAsync({type:"GI",data:{icons:lt,source:this.source,tileID:this.tileID,type:"patterns"}},bt)}const[vt,Mt,Tt]=yield Promise.all([xe,rt,At]),xi=new A(vt),ri=new v.bo(Mt,Tt);for(const bt in fe){const Vt=fe[bt];Vt instanceof v.a6?(V(Vt.layers,this.zoom,G),v.bp({bucket:Vt,glyphMap:vt,glyphPositions:xi.positions,imageMap:Mt,imagePositions:ri.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Vt.hasPattern&&(Vt instanceof v.bq||Vt instanceof v.br||Vt instanceof v.bs)&&(V(Vt.layers,this.zoom,G),Vt.addFeatures(re,this.tileID.canonical,ri.patternPositions))}return this.status="done",{buckets:Object.values(fe).filter(bt=>!bt.isEmpty()),featureIndex:he,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:xi.image,imageAtlas:ri,glyphMap:this.returnDependencies?vt:null,iconMap:this.returnDependencies?Mt:null,glyphPositions:this.returnDependencies?xi.positions:null}})}}function V(ee,O,F){const G=new v.z(O);for(const J of ee)J.recalculate(G,F)}class L{constructor(O,F,G){this.actor=O,this.layerIndex=F,this.availableImages=G,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(O,F){return v._(this,void 0,void 0,function*(){const G=yield v.l(O.request,F);try{return{vectorTile:new v.bt.VectorTile(new v.bu(G.data)),rawData:G.data,cacheControl:G.cacheControl,expires:G.expires}}catch(J){const le=new Uint8Array(G.data);let he=`Unable to parse the tile at ${O.request.url}, `;throw he+=le[0]===31&&le[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${J.message}`,new Error(he)}})}loadTile(O){return v._(this,void 0,void 0,function*(){const F=O.uid,G=!!(O&&O.request&&O.request.collectResourceTiming)&&new v.bv(O.request),J=new D(O);this.loading[F]=J;const le=new AbortController;J.abort=le;try{const he=yield this.loadVectorTile(O,le);if(delete this.loading[F],!he)return null;const fe=he.rawData,re={};he.expires&&(re.expires=he.expires),he.cacheControl&&(re.cacheControl=he.cacheControl);const Te={};if(G){const xe=G.finish();xe&&(Te.resourceTiming=JSON.parse(JSON.stringify(xe)))}J.vectorTile=he.vectorTile;const Ee=J.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[F]=J,this.fetching[F]={rawTileData:fe,cacheControl:re,resourceTiming:Te};try{const xe=yield Ee;return v.e({rawTileData:fe.slice(0)},xe,re,Te)}finally{delete this.fetching[F]}}catch(he){throw delete this.loading[F],J.status="done",this.loaded[F]=J,he}})}reloadTile(O){return v._(this,void 0,void 0,function*(){const F=O.uid;if(!this.loaded||!this.loaded[F])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const G=this.loaded[F];if(G.showCollisionBoxes=O.showCollisionBoxes,G.status==="parsing"){const J=yield G.parse(G.vectorTile,this.layerIndex,this.availableImages,this.actor);let le;if(this.fetching[F]){const{rawTileData:he,cacheControl:fe,resourceTiming:re}=this.fetching[F];delete this.fetching[F],le=v.e({rawTileData:he.slice(0)},J,fe,re)}else le=J;return le}if(G.status==="done"&&G.vectorTile)return G.parse(G.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(O){return v._(this,void 0,void 0,function*(){const F=this.loading,G=O.uid;F&&F[G]&&F[G].abort&&(F[G].abort.abort(),delete F[G])})}removeTile(O){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[O.uid]&&delete this.loaded[O.uid]})}}class B{constructor(){this.loaded={}}loadTile(O){return v._(this,void 0,void 0,function*(){const{uid:F,encoding:G,rawImageData:J,redFactor:le,greenFactor:he,blueFactor:fe,baseShift:re}=O,Te=J.width+2,Ee=J.height+2,xe=v.b(J)?new v.R({width:Te,height:Ee},yield v.bw(J,-1,-1,Te,Ee)):J,Fe=new v.bx(F,xe,G,le,he,fe,re);return this.loaded=this.loaded||{},this.loaded[F]=Fe,Fe})}removeTile(O){const F=this.loaded,G=O.uid;F&&F[G]&&delete F[G]}}function se(ee,O){if(ee.length!==0){ce(ee[0],O);for(var F=1;F<ee.length;F++)ce(ee[F],!O)}}function ce(ee,O){for(var F=0,G=0,J=0,le=ee.length,he=le-1;J<le;he=J++){var fe=(ee[J][0]-ee[he][0])*(ee[he][1]+ee[J][1]),re=F+fe;G+=Math.abs(F)>=Math.abs(fe)?F-re+fe:fe-re+F,F=re}F+G>=0!=!!O&&ee.reverse()}var ge=v.by(function ee(O,F){var G,J=O&&O.type;if(J==="FeatureCollection")for(G=0;G<O.features.length;G++)ee(O.features[G],F);else if(J==="GeometryCollection")for(G=0;G<O.geometries.length;G++)ee(O.geometries[G],F);else if(J==="Feature")ee(O.geometry,F);else if(J==="Polygon")se(O.coordinates,F);else if(J==="MultiPolygon")for(G=0;G<O.coordinates.length;G++)se(O.coordinates[G],F);return O});const Ce=v.bt.VectorTileFeature.prototype.toGeoJSON;var X={exports:{}},Z=v.bz,W=v.bt.VectorTileFeature,ve=Se;function Se(ee,O){this.options=O||{},this.features=ee,this.length=ee.length}function ke(ee,O){this.id=typeof ee.id=="number"?ee.id:void 0,this.type=ee.type,this.rawGeometry=ee.type===1?[ee.geometry]:ee.geometry,this.properties=ee.tags,this.extent=O||4096}Se.prototype.feature=function(ee){return new ke(this.features[ee],this.options.extent)},ke.prototype.loadGeometry=function(){var ee=this.rawGeometry;this.geometry=[];for(var O=0;O<ee.length;O++){for(var F=ee[O],G=[],J=0;J<F.length;J++)G.push(new Z(F[J][0],F[J][1]));this.geometry.push(G)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ee=this.geometry,O=1/0,F=-1/0,G=1/0,J=-1/0,le=0;le<ee.length;le++)for(var he=ee[le],fe=0;fe<he.length;fe++){var re=he[fe];O=Math.min(O,re.x),F=Math.max(F,re.x),G=Math.min(G,re.y),J=Math.max(J,re.y)}return[O,G,F,J]},ke.prototype.toGeoJSON=W.prototype.toGeoJSON;var Ae=v.bA,Me=ve;function ot(ee){var O=new Ae;return function(F,G){for(var J in F.layers)G.writeMessage(3,at,F.layers[J])}(ee,O),O.finish()}function at(ee,O){var F;O.writeVarintField(15,ee.version||1),O.writeStringField(1,ee.name||""),O.writeVarintField(5,ee.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<ee.length;F++)G.feature=ee.feature(F),O.writeMessage(2,pt,G);var J=G.keys;for(F=0;F<J.length;F++)O.writeStringField(3,J[F]);var le=G.values;for(F=0;F<le.length;F++)O.writeMessage(4,tr,le[F])}function pt(ee,O){var F=ee.feature;F.id!==void 0&&O.writeVarintField(1,F.id),O.writeMessage(2,Vi,ee),O.writeVarintField(3,F.type),O.writeMessage(4,cn,F)}function Vi(ee,O){var F=ee.feature,G=ee.keys,J=ee.values,le=ee.keycache,he=ee.valuecache;for(var fe in F.properties){var re=F.properties[fe],Te=le[fe];if(re!==null){Te===void 0&&(G.push(fe),le[fe]=Te=G.length-1),O.writeVarint(Te);var Ee=typeof re;Ee!=="string"&&Ee!=="boolean"&&Ee!=="number"&&(re=JSON.stringify(re));var xe=Ee+":"+re,Fe=he[xe];Fe===void 0&&(J.push(re),he[xe]=Fe=J.length-1),O.writeVarint(Fe)}}}function Xt(ee,O){return(O<<3)+(7&ee)}function pi(ee){return ee<<1^ee>>31}function cn(ee,O){for(var F=ee.loadGeometry(),G=ee.type,J=0,le=0,he=F.length,fe=0;fe<he;fe++){var re=F[fe],Te=1;G===1&&(Te=re.length),O.writeVarint(Xt(1,Te));for(var Ee=G===3?re.length-1:re.length,xe=0;xe<Ee;xe++){xe===1&&G!==1&&O.writeVarint(Xt(2,Ee-1));var Fe=re[xe].x-J,rt=re[xe].y-le;O.writeVarint(pi(Fe)),O.writeVarint(pi(rt)),J+=Fe,le+=rt}G===3&&O.writeVarint(Xt(7,1))}}function tr(ee,O){var F=typeof ee;F==="string"?O.writeStringField(1,ee):F==="boolean"?O.writeBooleanField(7,ee):F==="number"&&(ee%1!=0?O.writeDoubleField(3,ee):ee<0?O.writeSVarintField(6,ee):O.writeVarintField(5,ee))}X.exports=ot,X.exports.fromVectorTileJs=ot,X.exports.fromGeojsonVt=function(ee,O){O=O||{};var F={};for(var G in ee)F[G]=new Me(ee[G].features,O),F[G].name=G,F[G].version=O.version,F[G].extent=O.extent;return ot({layers:F})},X.exports.GeoJSONWrapper=Me;var Bt=v.by(X.exports);const Ge={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ee=>ee},ut=Math.fround||(dt=new Float32Array(1),ee=>(dt[0]=+ee,dt[0]));var dt;const Ct=3,jt=5,ir=6;class Ni{constructor(O){this.options=Object.assign(Object.create(Ge),O),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(O){const{log:F,minZoom:G,maxZoom:J}=this.options;F&&console.time("total time");const le=`prepare ${O.length} points`;F&&console.time(le),this.points=O;const he=[];for(let re=0;re<O.length;re++){const Te=O[re];if(!Te.geometry)continue;const[Ee,xe]=Te.geometry.coordinates,Fe=ut(Pi(Ee)),rt=ut(nr(xe));he.push(Fe,rt,1/0,re,-1,1),this.options.reduce&&he.push(0)}let fe=this.trees[J+1]=this._createTree(he);F&&console.timeEnd(le);for(let re=J;re>=G;re--){const Te=+Date.now();fe=this.trees[re]=this._createTree(this._cluster(fe,re)),F&&console.log("z%d: %d clusters in %dms",re,fe.numItems,+Date.now()-Te)}return F&&console.timeEnd("total time"),this}getClusters(O,F){let G=((O[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,O[1]));let le=O[2]===180?180:((O[2]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,O[3]));if(O[2]-O[0]>=360)G=-180,le=180;else if(G>le){const xe=this.getClusters([G,J,180,he],F),Fe=this.getClusters([-180,J,le,he],F);return xe.concat(Fe)}const fe=this.trees[this._limitZoom(F)],re=fe.range(Pi(G),nr(he),Pi(le),nr(J)),Te=fe.data,Ee=[];for(const xe of re){const Fe=this.stride*xe;Ee.push(Te[Fe+jt]>1?un(Te,Fe,this.clusterProps):this.points[Te[Fe+Ct]])}return Ee}getChildren(O){const F=this._getOriginId(O),G=this._getOriginZoom(O),J="No cluster with the specified id.",le=this.trees[G];if(!le)throw new Error(J);const he=le.data;if(F*this.stride>=he.length)throw new Error(J);const fe=this.options.radius/(this.options.extent*Math.pow(2,G-1)),re=le.within(he[F*this.stride],he[F*this.stride+1],fe),Te=[];for(const Ee of re){const xe=Ee*this.stride;he[xe+4]===O&&Te.push(he[xe+jt]>1?un(he,xe,this.clusterProps):this.points[he[xe+Ct]])}if(Te.length===0)throw new Error(J);return Te}getLeaves(O,F,G){const J=[];return this._appendLeaves(J,O,F=F||10,G=G||0,0),J}getTile(O,F,G){const J=this.trees[this._limitZoom(O)],le=Math.pow(2,O),{extent:he,radius:fe}=this.options,re=fe/he,Te=(G-re)/le,Ee=(G+1+re)/le,xe={features:[]};return this._addTileFeatures(J.range((F-re)/le,Te,(F+1+re)/le,Ee),J.data,F,G,le,xe),F===0&&this._addTileFeatures(J.range(1-re/le,Te,1,Ee),J.data,le,G,le,xe),F===le-1&&this._addTileFeatures(J.range(0,Te,re/le,Ee),J.data,-1,G,le,xe),xe.features.length?xe:null}getClusterExpansionZoom(O){let F=this._getOriginZoom(O)-1;for(;F<=this.options.maxZoom;){const G=this.getChildren(O);if(F++,G.length!==1)break;O=G[0].properties.cluster_id}return F}_appendLeaves(O,F,G,J,le){const he=this.getChildren(F);for(const fe of he){const re=fe.properties;if(re&&re.cluster?le+re.point_count<=J?le+=re.point_count:le=this._appendLeaves(O,re.cluster_id,G,J,le):le<J?le++:O.push(fe),O.length===G)break}return le}_createTree(O){const F=new v.av(O.length/this.stride|0,this.options.nodeSize,Float32Array);for(let G=0;G<O.length;G+=this.stride)F.add(O[G],O[G+1]);return F.finish(),F.data=O,F}_addTileFeatures(O,F,G,J,le,he){for(const fe of O){const re=fe*this.stride,Te=F[re+jt]>1;let Ee,xe,Fe;if(Te)Ee=hn(F,re,this.clusterProps),xe=F[re],Fe=F[re+1];else{const At=this.points[F[re+Ct]];Ee=At.properties;const[vt,Mt]=At.geometry.coordinates;xe=Pi(vt),Fe=nr(Mt)}const rt={type:1,geometry:[[Math.round(this.options.extent*(xe*le-G)),Math.round(this.options.extent*(Fe*le-J))]],tags:Ee};let lt;lt=Te||this.options.generateId?F[re+Ct]:this.points[F[re+Ct]].id,lt!==void 0&&(rt.id=lt),he.features.push(rt)}}_limitZoom(O){return Math.max(this.options.minZoom,Math.min(Math.floor(+O),this.options.maxZoom+1))}_cluster(O,F){const{radius:G,extent:J,reduce:le,minPoints:he}=this.options,fe=G/(J*Math.pow(2,F)),re=O.data,Te=[],Ee=this.stride;for(let xe=0;xe<re.length;xe+=Ee){if(re[xe+2]<=F)continue;re[xe+2]=F;const Fe=re[xe],rt=re[xe+1],lt=O.within(re[xe],re[xe+1],fe),At=re[xe+jt];let vt=At;for(const Mt of lt){const Tt=Mt*Ee;re[Tt+2]>F&&(vt+=re[Tt+jt])}if(vt>At&&vt>=he){let Mt,Tt=Fe*At,xi=rt*At,ri=-1;const bt=((xe/Ee|0)<<5)+(F+1)+this.points.length;for(const Vt of lt){const ti=Vt*Ee;if(re[ti+2]<=F)continue;re[ti+2]=F;const Ii=re[ti+jt];Tt+=re[ti]*Ii,xi+=re[ti+1]*Ii,re[ti+4]=bt,le&&(Mt||(Mt=this._map(re,xe,!0),ri=this.clusterProps.length,this.clusterProps.push(Mt)),le(Mt,this._map(re,ti)))}re[xe+4]=bt,Te.push(Tt/vt,xi/vt,1/0,bt,-1,vt),le&&Te.push(ri)}else{for(let Mt=0;Mt<Ee;Mt++)Te.push(re[xe+Mt]);if(vt>1)for(const Mt of lt){const Tt=Mt*Ee;if(!(re[Tt+2]<=F)){re[Tt+2]=F;for(let xi=0;xi<Ee;xi++)Te.push(re[Tt+xi])}}}}return Te}_getOriginId(O){return O-this.points.length>>5}_getOriginZoom(O){return(O-this.points.length)%32}_map(O,F,G){if(O[F+jt]>1){const he=this.clusterProps[O[F+ir]];return G?Object.assign({},he):he}const J=this.points[O[F+Ct]].properties,le=this.options.map(J);return G&&le===J?Object.assign({},le):le}}function un(ee,O,F){return{type:"Feature",id:ee[O+Ct],properties:hn(ee,O,F),geometry:{type:"Point",coordinates:[(G=ee[O],360*(G-.5)),Cs(ee[O+1])]}};var G}function hn(ee,O,F){const G=ee[O+jt],J=G>=1e4?`${Math.round(G/1e3)}k`:G>=1e3?Math.round(G/100)/10+"k":G,le=ee[O+ir],he=le===-1?{}:Object.assign({},F[le]);return Object.assign(he,{cluster:!0,cluster_id:ee[O+Ct],point_count:G,point_count_abbreviated:J})}function Pi(ee){return ee/360+.5}function nr(ee){const O=Math.sin(ee*Math.PI/180),F=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return F<0?0:F>1?1:F}function Cs(ee){const O=(180-360*ee)*Math.PI/180;return 360*Math.atan(Math.exp(O))/Math.PI-90}function Ps(ee,O,F,G){let J=G;const le=O+(F-O>>1);let he,fe=F-O;const re=ee[O],Te=ee[O+1],Ee=ee[F],xe=ee[F+1];for(let Fe=O+3;Fe<F;Fe+=3){const rt=uo(ee[Fe],ee[Fe+1],re,Te,Ee,xe);if(rt>J)he=Fe,J=rt;else if(rt===J){const lt=Math.abs(Fe-le);lt<fe&&(he=Fe,fe=lt)}}J>G&&(he-O>3&&Ps(ee,O,he,G),ee[he+2]=J,F-he>3&&Ps(ee,he,F,G))}function uo(ee,O,F,G,J,le){let he=J-F,fe=le-G;if(he!==0||fe!==0){const re=((ee-F)*he+(O-G)*fe)/(he*he+fe*fe);re>1?(F=J,G=le):re>0&&(F+=he*re,G+=fe*re)}return he=ee-F,fe=O-G,he*he+fe*fe}function Ur(ee,O,F,G){const J={id:ee??null,type:O,geometry:F,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(O==="Point"||O==="MultiPoint"||O==="LineString")ss(J,F);else if(O==="Polygon")ss(J,F[0]);else if(O==="MultiLineString")for(const le of F)ss(J,le);else if(O==="MultiPolygon")for(const le of F)ss(J,le[0]);return J}function ss(ee,O){for(let F=0;F<O.length;F+=3)ee.minX=Math.min(ee.minX,O[F]),ee.minY=Math.min(ee.minY,O[F+1]),ee.maxX=Math.max(ee.maxX,O[F]),ee.maxY=Math.max(ee.maxY,O[F+1])}function as(ee,O,F,G){if(!O.geometry)return;const J=O.geometry.coordinates;if(J&&J.length===0)return;const le=O.geometry.type,he=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2);let fe=[],re=O.id;if(F.promoteId?re=O.properties[F.promoteId]:F.generateId&&(re=G||0),le==="Point")ra(J,fe);else if(le==="MultiPoint")for(const Te of J)ra(Te,fe);else if(le==="LineString")we(J,fe,he,!1);else if(le==="MultiLineString"){if(F.lineMetrics){for(const Te of J)fe=[],we(Te,fe,he,!1),ee.push(Ur(re,"LineString",fe,O.properties));return}Is(J,fe,he,!1)}else if(le==="Polygon")Is(J,fe,he,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(const Te of O.geometry.geometries)as(ee,{id:re,geometry:Te,properties:O.properties},F,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Te of J){const Ee=[];Is(Te,Ee,he,!0),fe.push(Ee)}}ee.push(Ur(re,le,fe,O.properties))}function ra(ee,O){O.push(ho(ee[0]),Lt(ee[1]),0)}function we(ee,O,F,G){let J,le,he=0;for(let re=0;re<ee.length;re++){const Te=ho(ee[re][0]),Ee=Lt(ee[re][1]);O.push(Te,Ee,0),re>0&&(he+=G?(J*Ee-Te*le)/2:Math.sqrt(Math.pow(Te-J,2)+Math.pow(Ee-le,2))),J=Te,le=Ee}const fe=O.length-3;O[2]=1,Ps(O,0,fe,F),O[fe+2]=1,O.size=Math.abs(he),O.start=0,O.end=O.size}function Is(ee,O,F,G){for(let J=0;J<ee.length;J++){const le=[];we(ee[J],le,F,G),O.push(le)}}function ho(ee){return ee/360+.5}function Lt(ee){const O=Math.sin(ee*Math.PI/180),F=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return F<0?0:F>1?1:F}function ni(ee,O,F,G,J,le,he,fe){if(G/=O,le>=(F/=O)&&he<G)return ee;if(he<F||le>=G)return null;const re=[];for(const Te of ee){const Ee=Te.geometry;let xe=Te.type;const Fe=J===0?Te.minX:Te.minY,rt=J===0?Te.maxX:Te.maxY;if(Fe>=F&&rt<G){re.push(Te);continue}if(rt<F||Fe>=G)continue;let lt=[];if(xe==="Point"||xe==="MultiPoint")po(Ee,lt,F,G,J);else if(xe==="LineString")os(Ee,lt,F,G,J,!1,fe.lineMetrics);else if(xe==="MultiLineString")sa(Ee,lt,F,G,J,!1);else if(xe==="Polygon")sa(Ee,lt,F,G,J,!0);else if(xe==="MultiPolygon")for(const At of Ee){const vt=[];sa(At,vt,F,G,J,!0),vt.length&&lt.push(vt)}if(lt.length){if(fe.lineMetrics&&xe==="LineString"){for(const At of lt)re.push(Ur(Te.id,xe,At,Te.tags));continue}xe!=="LineString"&&xe!=="MultiLineString"||(lt.length===1?(xe="LineString",lt=lt[0]):xe="MultiLineString"),xe!=="Point"&&xe!=="MultiPoint"||(xe=lt.length===3?"Point":"MultiPoint"),re.push(Ur(Te.id,xe,lt,Te.tags))}}return re.length?re:null}function po(ee,O,F,G,J){for(let le=0;le<ee.length;le+=3){const he=ee[le+J];he>=F&&he<=G&&Nn(O,ee[le],ee[le+1],ee[le+2])}}function os(ee,O,F,G,J,le,he){let fe=$r(ee);const re=J===0?fo:mo;let Te,Ee,xe=ee.start;for(let vt=0;vt<ee.length-3;vt+=3){const Mt=ee[vt],Tt=ee[vt+1],xi=ee[vt+2],ri=ee[vt+3],bt=ee[vt+4],Vt=J===0?Mt:Tt,ti=J===0?ri:bt;let Ii=!1;he&&(Te=Math.sqrt(Math.pow(Mt-ri,2)+Math.pow(Tt-bt,2))),Vt<F?ti>F&&(Ee=re(fe,Mt,Tt,ri,bt,F),he&&(fe.start=xe+Te*Ee)):Vt>G?ti<G&&(Ee=re(fe,Mt,Tt,ri,bt,G),he&&(fe.start=xe+Te*Ee)):Nn(fe,Mt,Tt,xi),ti<F&&Vt>=F&&(Ee=re(fe,Mt,Tt,ri,bt,F),Ii=!0),ti>G&&Vt<=G&&(Ee=re(fe,Mt,Tt,ri,bt,G),Ii=!0),!le&&Ii&&(he&&(fe.end=xe+Te*Ee),O.push(fe),fe=$r(ee)),he&&(xe+=Te)}let Fe=ee.length-3;const rt=ee[Fe],lt=ee[Fe+1],At=J===0?rt:lt;At>=F&&At<=G&&Nn(fe,rt,lt,ee[Fe+2]),Fe=fe.length-3,le&&Fe>=3&&(fe[Fe]!==fe[0]||fe[Fe+1]!==fe[1])&&Nn(fe,fe[0],fe[1],fe[2]),fe.length&&O.push(fe)}function $r(ee){const O=[];return O.size=ee.size,O.start=ee.start,O.end=ee.end,O}function sa(ee,O,F,G,J,le){for(const he of ee)os(he,O,F,G,J,le,!1)}function Nn(ee,O,F,G){ee.push(O,F,G)}function fo(ee,O,F,G,J,le){const he=(le-O)/(G-O);return Nn(ee,le,F+(J-F)*he,1),he}function mo(ee,O,F,G,J,le){const he=(le-F)/(J-F);return Nn(ee,O+(G-O)*he,le,1),he}function Re(ee,O){const F=[];for(let G=0;G<ee.length;G++){const J=ee[G],le=J.type;let he;if(le==="Point"||le==="MultiPoint"||le==="LineString")he=Sr(J.geometry,O);else if(le==="MultiLineString"||le==="Polygon"){he=[];for(const fe of J.geometry)he.push(Sr(fe,O))}else if(le==="MultiPolygon"){he=[];for(const fe of J.geometry){const re=[];for(const Te of fe)re.push(Sr(Te,O));he.push(re)}}F.push(Ur(J.id,le,he,J.tags))}return F}function Sr(ee,O){const F=[];F.size=ee.size,ee.start!==void 0&&(F.start=ee.start,F.end=ee.end);for(let G=0;G<ee.length;G+=3)F.push(ee[G]+O,ee[G+1],ee[G+2]);return F}function Ji(ee,O){if(ee.transformed)return ee;const F=1<<ee.z,G=ee.x,J=ee.y;for(const le of ee.features){const he=le.geometry,fe=le.type;if(le.geometry=[],fe===1)for(let re=0;re<he.length;re+=2)le.geometry.push(Tr(he[re],he[re+1],O,F,G,J));else for(let re=0;re<he.length;re++){const Te=[];for(let Ee=0;Ee<he[re].length;Ee+=2)Te.push(Tr(he[re][Ee],he[re][Ee+1],O,F,G,J));le.geometry.push(Te)}}return ee.transformed=!0,ee}function Tr(ee,O,F,G,J,le){return[Math.round(F*(ee*G-J)),Math.round(F*(O*G-le))]}function ls(ee,O,F,G,J){const le=O===J.maxZoom?0:J.tolerance/((1<<O)*J.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:ee.length,source:null,x:F,y:G,z:O,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const fe of ee)Ve(he,fe,le,J);return he}function Ve(ee,O,F,G){const J=O.geometry,le=O.type,he=[];if(ee.minX=Math.min(ee.minX,O.minX),ee.minY=Math.min(ee.minY,O.minY),ee.maxX=Math.max(ee.maxX,O.maxX),ee.maxY=Math.max(ee.maxY,O.maxY),le==="Point"||le==="MultiPoint")for(let fe=0;fe<J.length;fe+=3)he.push(J[fe],J[fe+1]),ee.numPoints++,ee.numSimplified++;else if(le==="LineString")wt(he,J,ee,F,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(let fe=0;fe<J.length;fe++)wt(he,J[fe],ee,F,le==="Polygon",fe===0);else if(le==="MultiPolygon")for(let fe=0;fe<J.length;fe++){const re=J[fe];for(let Te=0;Te<re.length;Te++)wt(he,re[Te],ee,F,!0,Te===0)}if(he.length){let fe=O.tags||null;if(le==="LineString"&&G.lineMetrics){fe={};for(const Te in O.tags)fe[Te]=O.tags[Te];fe.mapbox_clip_start=J.start/J.size,fe.mapbox_clip_end=J.end/J.size}const re={geometry:he,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:fe};O.id!==null&&(re.id=O.id),ee.features.push(re)}}function wt(ee,O,F,G,J,le){const he=G*G;if(G>0&&O.size<(J?he:G))return void(F.numPoints+=O.length/3);const fe=[];for(let re=0;re<O.length;re+=3)(G===0||O[re+2]>he)&&(F.numSimplified++,fe.push(O[re],O[re+1])),F.numPoints++;J&&function(re,Te){let Ee=0;for(let xe=0,Fe=re.length,rt=Fe-2;xe<Fe;rt=xe,xe+=2)Ee+=(re[xe]-re[rt])*(re[xe+1]+re[rt+1]);if(Ee>0===Te)for(let xe=0,Fe=re.length;xe<Fe/2;xe+=2){const rt=re[xe],lt=re[xe+1];re[xe]=re[Fe-2-xe],re[xe+1]=re[Fe-1-xe],re[Fe-2-xe]=rt,re[Fe-1-xe]=lt}}(fe,le),ee.push(fe)}const ft={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class dn{constructor(O,F){const G=(F=this.options=function(le,he){for(const fe in he)le[fe]=he[fe];return le}(Object.create(ft),F)).debug;if(G&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");let J=function(le,he){const fe=[];if(le.type==="FeatureCollection")for(let re=0;re<le.features.length;re++)as(fe,le.features[re],he,re);else as(fe,le.type==="Feature"?le:{geometry:le},he);return fe}(O,F);this.tiles={},this.tileCoords=[],G&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),J=function(le,he){const fe=he.buffer/he.extent;let re=le;const Te=ni(le,1,-1-fe,fe,0,-1,2,he),Ee=ni(le,1,1-fe,2+fe,0,-1,2,he);return(Te||Ee)&&(re=ni(le,1,-fe,1+fe,0,-1,2,he)||[],Te&&(re=Re(Te,1).concat(re)),Ee&&(re=re.concat(Re(Ee,-1)))),re}(J,F),J.length&&this.splitTile(J,0,0,0),G&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(O,F,G,J,le,he,fe){const re=[O,F,G,J],Te=this.options,Ee=Te.debug;for(;re.length;){J=re.pop(),G=re.pop(),F=re.pop(),O=re.pop();const xe=1<<F,Fe=rr(F,G,J);let rt=this.tiles[Fe];if(!rt&&(Ee>1&&console.time("creation"),rt=this.tiles[Fe]=ls(O,F,G,J,Te),this.tileCoords.push({z:F,x:G,y:J}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,G,J,rt.numFeatures,rt.numPoints,rt.numSimplified),console.timeEnd("creation"));const Ii=`z${F}`;this.stats[Ii]=(this.stats[Ii]||0)+1,this.total++}if(rt.source=O,le==null){if(F===Te.indexMaxZoom||rt.numPoints<=Te.indexMaxPoints)continue}else{if(F===Te.maxZoom||F===le)continue;if(le!=null){const Ii=le-F;if(G!==he>>Ii||J!==fe>>Ii)continue}}if(rt.source=null,O.length===0)continue;Ee>1&&console.time("clipping");const lt=.5*Te.buffer/Te.extent,At=.5-lt,vt=.5+lt,Mt=1+lt;let Tt=null,xi=null,ri=null,bt=null,Vt=ni(O,xe,G-lt,G+vt,0,rt.minX,rt.maxX,Te),ti=ni(O,xe,G+At,G+Mt,0,rt.minX,rt.maxX,Te);O=null,Vt&&(Tt=ni(Vt,xe,J-lt,J+vt,1,rt.minY,rt.maxY,Te),xi=ni(Vt,xe,J+At,J+Mt,1,rt.minY,rt.maxY,Te),Vt=null),ti&&(ri=ni(ti,xe,J-lt,J+vt,1,rt.minY,rt.maxY,Te),bt=ni(ti,xe,J+At,J+Mt,1,rt.minY,rt.maxY,Te),ti=null),Ee>1&&console.timeEnd("clipping"),re.push(Tt||[],F+1,2*G,2*J),re.push(xi||[],F+1,2*G,2*J+1),re.push(ri||[],F+1,2*G+1,2*J),re.push(bt||[],F+1,2*G+1,2*J+1)}}getTile(O,F,G){O=+O,F=+F,G=+G;const J=this.options,{extent:le,debug:he}=J;if(O<0||O>24)return null;const fe=1<<O,re=rr(O,F=F+fe&fe-1,G);if(this.tiles[re])return Ji(this.tiles[re],le);he>1&&console.log("drilling down to z%d-%d-%d",O,F,G);let Te,Ee=O,xe=F,Fe=G;for(;!Te&&Ee>0;)Ee--,xe>>=1,Fe>>=1,Te=this.tiles[rr(Ee,xe,Fe)];return Te&&Te.source?(he>1&&(console.log("found parent tile z%d-%d-%d",Ee,xe,Fe),console.time("drilling down")),this.splitTile(Te.source,Ee,xe,Fe,O,F,G),he>1&&console.timeEnd("drilling down"),this.tiles[re]?Ji(this.tiles[re],le):null):null}}function rr(ee,O,F){return 32*((1<<ee)*F+O)+ee}function _t(ee,O){return O?ee.properties[O]:ee.id}function kr(ee,O){if(ee==null)return!0;if(ee.type==="Feature")return _t(ee,O)!=null;if(ee.type==="FeatureCollection"){const F=new Set;for(const G of ee.features){const J=_t(G,O);if(J==null||F.has(J))return!1;F.add(J)}return!0}return!1}function Gr(ee,O){const F=new Map;if(ee!=null)if(ee.type==="Feature")F.set(_t(ee,O),ee);else for(const G of ee.features)F.set(_t(G,O),G);return F}class cs extends L{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(O,F){return v._(this,void 0,void 0,function*(){const G=O.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const J=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!J)return null;const le=new class{constructor(fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.X,this.length=fe.length,this._features=fe}feature(fe){return new class{constructor(re){this._feature=re,this.extent=v.X,this.type=re.type,this.properties=re.tags,"id"in re&&!isNaN(re.id)&&(this.id=parseInt(re.id,10))}loadGeometry(){if(this._feature.type===1){const re=[];for(const Te of this._feature.geometry)re.push([new v.P(Te[0],Te[1])]);return re}{const re=[];for(const Te of this._feature.geometry){const Ee=[];for(const xe of Te)Ee.push(new v.P(xe[0],xe[1]));re.push(Ee)}return re}}toGeoJSON(re,Te,Ee){return Ce.call(this,re,Te,Ee)}}(this._features[fe])}}(J.features);let he=Bt(le);return he.byteOffset===0&&he.byteLength===he.buffer.byteLength||(he=new Uint8Array(he)),{vectorTile:le,rawData:he.buffer}})}loadData(O){return v._(this,void 0,void 0,function*(){var F;(F=this._pendingRequest)===null||F===void 0||F.abort();const G=!!(O&&O.request&&O.request.collectResourceTiming)&&new v.bv(O.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(O,this._pendingRequest),this._geoJSONIndex=O.cluster?new Ni(function({superclusterOptions:he,clusterProperties:fe}){if(!fe||!he)return he;const re={},Te={},Ee={accumulated:null,zoom:0},xe={properties:null},Fe=Object.keys(fe);for(const rt of Fe){const[lt,At]=fe[rt],vt=v.bC(At),Mt=v.bC(typeof lt=="string"?[lt,["accumulated"],["get",rt]]:lt);re[rt]=vt.value,Te[rt]=Mt.value}return he.map=rt=>{xe.properties=rt;const lt={};for(const At of Fe)lt[At]=re[At].evaluate(Ee,xe);return lt},he.reduce=(rt,lt)=>{xe.properties=lt;for(const At of Fe)Ee.accumulated=rt[At],rt[At]=Te[At].evaluate(Ee,xe)},he}(O)).load((yield this._pendingData).features):(J=yield this._pendingData,new dn(J,O.geojsonVtOptions)),this.loaded={};const le={};if(G){const he=G.finish();he&&(le.resourceTiming={},le.resourceTiming[O.source]=JSON.parse(JSON.stringify(he)))}return le}catch(le){if(delete this._pendingRequest,v.bB(le))return{abandoned:!0};throw le}var J})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(O){const F=this.loaded;return F&&F[O.uid]?super.reloadTile(O):this.loadTile(O)}loadAndProcessGeoJSON(O,F){return v._(this,void 0,void 0,function*(){let G=yield this.loadGeoJSON(O,F);if(delete this._pendingRequest,typeof G!="object")throw new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`);if(ge(G,!0),O.filter){const J=v.bC(O.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(he=>`${he.key}: ${he.message}`).join(", "));G={type:"FeatureCollection",features:G.features.filter(he=>J.value.evaluate({zoom:0},he))}}return G})}loadGeoJSON(O,F){return v._(this,void 0,void 0,function*(){const{promoteId:G}=O;if(O.request){const J=yield v.h(O.request,F);return this._dataUpdateable=kr(J.data,G)?Gr(J.data,G):void 0,J.data}if(typeof O.data=="string")try{const J=JSON.parse(O.data);return this._dataUpdateable=kr(J,G)?Gr(J,G):void 0,J}catch{throw new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`)}if(!O.dataDiff)throw new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${O.source}`);return function(J,le,he){var fe,re,Te,Ee;if(le.removeAll&&J.clear(),le.remove)for(const xe of le.remove)J.delete(xe);if(le.add)for(const xe of le.add){const Fe=_t(xe,he);Fe!=null&&J.set(Fe,xe)}if(le.update)for(const xe of le.update){let Fe=J.get(xe.id);if(Fe==null)continue;const rt=!xe.removeAllProperties&&(((fe=xe.removeProperties)===null||fe===void 0?void 0:fe.length)>0||((re=xe.addOrUpdateProperties)===null||re===void 0?void 0:re.length)>0);if((xe.newGeometry||xe.removeAllProperties||rt)&&(Fe=Object.assign({},Fe),J.set(xe.id,Fe),rt&&(Fe.properties=Object.assign({},Fe.properties))),xe.newGeometry&&(Fe.geometry=xe.newGeometry),xe.removeAllProperties)Fe.properties={};else if(((Te=xe.removeProperties)===null||Te===void 0?void 0:Te.length)>0)for(const lt of xe.removeProperties)Object.prototype.hasOwnProperty.call(Fe.properties,lt)&&delete Fe.properties[lt];if(((Ee=xe.addOrUpdateProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(const{key:lt,value:At}of xe.addOrUpdateProperties)Fe.properties[lt]=At}}(this._dataUpdateable,O.dataDiff,G),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(O){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(O){return this._geoJSONIndex.getClusterExpansionZoom(O.clusterId)}getClusterChildren(O){return this._geoJSONIndex.getChildren(O.clusterId)}getClusterLeaves(O){return this._geoJSONIndex.getLeaves(O.clusterId,O.limit,O.offset)}}class Cr{constructor(O){this.self=O,this.actor=new v.F(O),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(F,G)=>{if(this.externalWorkerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.externalWorkerSourceTypes[F]=G},this.self.addProtocol=v.bi,this.self.removeProtocol=v.bj,this.self.registerRTLTextPlugin=F=>{if(v.bD.isParsed())throw new Error("RTL text plugin already registered.");v.bD.setMethods(F)},this.actor.registerMessageHandler("LDT",(F,G)=>this._getDEMWorkerSource(F,G.source).loadTile(G)),this.actor.registerMessageHandler("RDT",(F,G)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(F,G.source).removeTile(G)})),this.actor.registerMessageHandler("GCEZ",(F,G)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(F,G.type,G.source).getClusterExpansionZoom(G)})),this.actor.registerMessageHandler("GCC",(F,G)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(F,G.type,G.source).getClusterChildren(G)})),this.actor.registerMessageHandler("GCL",(F,G)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(F,G.type,G.source).getClusterLeaves(G)})),this.actor.registerMessageHandler("LD",(F,G)=>this._getWorkerSource(F,G.type,G.source).loadData(G)),this.actor.registerMessageHandler("GD",(F,G)=>this._getWorkerSource(F,G.type,G.source).getData()),this.actor.registerMessageHandler("LT",(F,G)=>this._getWorkerSource(F,G.type,G.source).loadTile(G)),this.actor.registerMessageHandler("RT",(F,G)=>this._getWorkerSource(F,G.type,G.source).reloadTile(G)),this.actor.registerMessageHandler("AT",(F,G)=>this._getWorkerSource(F,G.type,G.source).abortTile(G)),this.actor.registerMessageHandler("RMT",(F,G)=>this._getWorkerSource(F,G.type,G.source).removeTile(G)),this.actor.registerMessageHandler("RS",(F,G)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[F]||!this.workerSources[F][G.type]||!this.workerSources[F][G.type][G.source])return;const J=this.workerSources[F][G.type][G.source];delete this.workerSources[F][G.type][G.source],J.removeSource!==void 0&&J.removeSource(G)})),this.actor.registerMessageHandler("RM",F=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[F],delete this.availableImages[F],delete this.workerSources[F],delete this.demWorkerSources[F]})),this.actor.registerMessageHandler("SR",(F,G)=>v._(this,void 0,void 0,function*(){this.referrer=G})),this.actor.registerMessageHandler("SRPS",(F,G)=>this._syncRTLPluginState(F,G)),this.actor.registerMessageHandler("IS",(F,G)=>v._(this,void 0,void 0,function*(){this.self.importScripts(G)})),this.actor.registerMessageHandler("SI",(F,G)=>this._setImages(F,G)),this.actor.registerMessageHandler("UL",(F,G)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(F).update(G.layers,G.removedIds)})),this.actor.registerMessageHandler("SL",(F,G)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(F).replace(G)}))}_setImages(O,F){return v._(this,void 0,void 0,function*(){this.availableImages[O]=F;for(const G in this.workerSources[O]){const J=this.workerSources[O][G];for(const le in J)J[le].availableImages=F}})}_syncRTLPluginState(O,F){return v._(this,void 0,void 0,function*(){if(v.bD.isParsed())return v.bD.getState();if(F.pluginStatus!=="loading")return v.bD.setState(F),F;const G=F.pluginURL;if(this.self.importScripts(G),v.bD.isParsed()){const J={pluginStatus:"loaded",pluginURL:G};return v.bD.setState(J),J}throw v.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${G}`)})}_getAvailableImages(O){let F=this.availableImages[O];return F||(F=[]),F}_getLayerIndex(O){let F=this.layerIndexes[O];return F||(F=this.layerIndexes[O]=new c),F}_getWorkerSource(O,F,G){if(this.workerSources[O]||(this.workerSources[O]={}),this.workerSources[O][F]||(this.workerSources[O][F]={}),!this.workerSources[O][F][G]){const J={sendAsync:(le,he)=>(le.targetMapId=O,this.actor.sendAsync(le,he))};switch(F){case"vector":this.workerSources[O][F][G]=new L(J,this._getLayerIndex(O),this._getAvailableImages(O));break;case"geojson":this.workerSources[O][F][G]=new cs(J,this._getLayerIndex(O),this._getAvailableImages(O));break;default:this.workerSources[O][F][G]=new this.externalWorkerSourceTypes[F](J,this._getLayerIndex(O),this._getAvailableImages(O))}}return this.workerSources[O][F][G]}_getDEMWorkerSource(O,F){return this.demWorkerSources[O]||(this.demWorkerSources[O]={}),this.demWorkerSources[O][F]||(this.demWorkerSources[O][F]=new B),this.demWorkerSources[O][F]}}return v.i(self)&&(self.worker=new Cr(self)),Cr}),g("index",["exports","./shared"],function(v,c){var A="4.7.1";let D,V;const L={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:m=>new Promise((t,a)=>{const h=requestAnimationFrame(t);m.signal.addEventListener("abort",()=>{cancelAnimationFrame(h),a(c.c())})}),getImageData(m,t=0){return this.getImageCanvasContext(m).getImageData(-t,-t,m.width+2*t,m.height+2*t)},getImageCanvasContext(m){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=m.width,t.height=m.height,a.drawImage(m,0,0,m.width,m.height),a},resolveURL:m=>(D||(D=document.createElement("a")),D.href=m,D.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(V==null&&(V=matchMedia("(prefers-reduced-motion: reduce)")),V.matches)}};class B{static testProp(t){if(!B.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in B.docStyle)return t[a];return t[0]}static create(t,a,h){const d=window.document.createElement(t);return a!==void 0&&(d.className=a),h&&h.appendChild(d),d}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){B.docStyle&&B.selectProp&&(B.userSelect=B.docStyle[B.selectProp],B.docStyle[B.selectProp]="none")}static enableDrag(){B.docStyle&&B.selectProp&&(B.docStyle[B.selectProp]=B.userSelect)}static setTransform(t,a){t.style[B.transformProp]=a}static addEventListener(t,a,h,d={}){t.addEventListener(a,h,"passive"in d?d:d.capture)}static removeEventListener(t,a,h,d={}){t.removeEventListener(a,h,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",B.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",B.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",B.suppressClickInternal,!0)},0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,h){const d=a.boundingClientRect;return new c.P((h.clientX-d.left)/a.x-t.clientLeft,(h.clientY-d.top)/a.y-t.clientTop)}static mousePos(t,a){const h=B.getScale(t);return B.getPoint(t,h,a)}static touchPos(t,a){const h=[],d=B.getScale(t);for(let f=0;f<a.length;f++)h.push(B.getPoint(t,d,a[f]));return h}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}B.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,B.selectProp=B.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),B.transformProp=B.testProp(["transform","WebkitTransform"]);const se={supported:!1,testSupport:function(m){!Ce&&ge&&(X?Z(m):ce=m)}};let ce,ge,Ce=!1,X=!1;function Z(m){const t=m.createTexture();m.bindTexture(m.TEXTURE_2D,t);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,ge),m.isContextLost())return;se.supported=!0}catch{}m.deleteTexture(t),Ce=!0}var W;typeof document<"u"&&(ge=document.createElement("img"),ge.onload=()=>{ce&&Z(ce),ce=null,X=!0},ge.onerror=()=>{Ce=!0,ce=null},ge.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let t,a,h,d;m.resetRequestQueue=()=>{t=[],a=0,h=0,d={}},m.addThrottleControl=k=>{const I=h++;return d[I]=k,I},m.removeThrottleControl=k=>{delete d[k],b()},m.getImage=(k,I,E=!0)=>new Promise((z,N)=>{se.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),c.e(k,{type:"image"}),t.push({abortController:I,requestParameters:k,supportImageRefresh:E,state:"queued",onError:H=>{N(H)},onSuccess:H=>{z(H)}}),b()});const f=k=>c._(this,void 0,void 0,function*(){k.state="running";const{requestParameters:I,supportImageRefresh:E,onError:z,onSuccess:N,abortController:H}=k,q=E===!1&&!c.i(self)&&!c.g(I.url)&&(!I.headers||Object.keys(I.headers).reduce((ne,ae)=>ne&&ae==="accept",!0));a++;const Q=q?T(I,H):c.m(I,H);try{const ne=yield Q;delete k.abortController,k.state="completed",ne.data instanceof HTMLImageElement||c.b(ne.data)?N(ne):ne.data&&N({data:yield(ie=ne.data,typeof createImageBitmap=="function"?c.d(ie):c.f(ie)),cacheControl:ne.cacheControl,expires:ne.expires})}catch(ne){delete k.abortController,z(ne)}finally{a--,b()}var ie}),b=()=>{const k=(()=>{for(const I of Object.keys(d))if(d[I]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=a;I<k&&t.length>0;I++){const E=t.shift();E.abortController.signal.aborted?I--:f(E)}},T=(k,I)=>new Promise((E,z)=>{const N=new Image,H=k.url,q=k.credentials;q&&q==="include"?N.crossOrigin="use-credentials":(q&&q==="same-origin"||!c.s(H))&&(N.crossOrigin="anonymous"),I.signal.addEventListener("abort",()=>{N.src="",z(c.c())}),N.fetchPriority="high",N.onload=()=>{N.onerror=N.onload=null,E({data:N})},N.onerror=()=>{N.onerror=N.onload=null,I.signal.aborted||z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},N.src=H})}(W||(W={})),W.resetRequestQueue();class ve{constructor(t){this._transformRequestFn=t}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Se(m){var t=new c.A(3);return t[0]=m[0],t[1]=m[1],t[2]=m[2],t}var ke,Ae=function(m,t,a){return m[0]=t[0]-a[0],m[1]=t[1]-a[1],m[2]=t[2]-a[2],m};ke=new c.A(3),c.A!=Float32Array&&(ke[0]=0,ke[1]=0,ke[2]=0);var Me=function(m){var t=m[0],a=m[1];return t*t+a*a};function ot(m){const t=[];if(typeof m=="string")t.push({id:"default",url:m});else if(m&&m.length>0){const a=[];for(const{id:h,url:d}of m){const f=`${h}${d}`;a.indexOf(f)===-1&&(a.push(f),t.push({id:h,url:d}))}}return t}function at(m,t,a){const h=m.split("?");return h[0]+=`${t}${a}`,h.join("?")}(function(){var m=new c.A(2);c.A!=Float32Array&&(m[0]=0,m[1]=0)})();class pt{constructor(t,a,h,d){this.context=t,this.format=h,this.texture=t.gl.createTexture(),this.update(a,d)}update(t,a,h){const{width:d,height:f}=t,b=!(this.size&&this.size[0]===d&&this.size[1]===f||h),{context:T}=this,{gl:k}=T;if(this.useMipmap=!!(a&&a.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!a||a.premultiply!==!1)),b)this.size=[d,f],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,t):k.texImage2D(k.TEXTURE_2D,0,this.format,d,f,0,this.format,k.UNSIGNED_BYTE,t.data);else{const{x:I,y:E}=h||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?k.texSubImage2D(k.TEXTURE_2D,0,I,E,k.RGBA,k.UNSIGNED_BYTE,t):k.texSubImage2D(k.TEXTURE_2D,0,I,E,d,f,k.RGBA,k.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(t,a,h){const{context:d}=this,{gl:f}=d;f.bindTexture(f.TEXTURE_2D,this.texture),h!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=f.LINEAR),t!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,h||t),this.filter=t),a!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,a),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Vi(m){const{userImage:t}=m;return!!(t&&t.render&&t.render())&&(m.data.replace(new Uint8Array(t.data.buffer)),!0)}class Xt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:h}of this.requestors)h(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const h=a.spriteData;a.data=new c.R({width:h.width,height:h.height},h.context.getImageData(h.x,h.y,h.width,h.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let h=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchX" value`))),h=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchY" value`))),h=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "content" value`))),h=!1),h}_validateStretch(t,a){if(!t)return!0;let h=0;for(const d of t){if(d[0]<h||d[1]<d[0]||a<d[1])return!1;h=d[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const h=a.spriteData,d=h&&h.width||a.data.width,f=h&&h.height||a.data.height;return!(t[0]<0||d<t[0]||t[1]<0||f<t[1]||t[2]<0||d<t[2]||t[3]<0||f<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,h=!0){const d=this.getImage(t);if(h&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((a,h)=>{let d=!0;if(!this.isLoaded())for(const f of t)this.images[f]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})})}_getImagesForIds(t){const a={};for(const h of t){let d=this.getImage(h);d||(this.fire(new c.k("styleimagemissing",{id:h})),d=this.getImage(h)),d?a[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:c.w(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],h=this.getImage(t);if(!h)return null;if(a&&a.position.version===h.version)return a.position;if(a)a.position.version=h.version;else{const d={w:h.data.width+2,h:h.data.height+2,x:0,y:0},f=new c.I(d,h);this.patterns[t]={bin:d,position:f}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new pt(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const f in this.patterns)t.push(this.patterns[f].bin);const{w:a,h}=c.p(t),d=this.atlasImage;d.resize({width:a||1,height:h||1});for(const f in this.patterns){const{bin:b}=this.patterns[f],T=b.x+1,k=b.y+1,I=this.getImage(f).data,E=I.width,z=I.height;c.R.copy(I,d,{x:0,y:0},{x:T,y:k},{width:E,height:z}),c.R.copy(I,d,{x:0,y:z-1},{x:T,y:k-1},{width:E,height:1}),c.R.copy(I,d,{x:0,y:0},{x:T,y:k+z},{width:E,height:1}),c.R.copy(I,d,{x:E-1,y:0},{x:T-1,y:k},{width:1,height:z}),c.R.copy(I,d,{x:0,y:0},{x:T+E,y:k},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const h=this.getImage(a);h||c.w(`Image with ID: "${a}" was not found`),Vi(h)&&this.updateImage(a,h)}}}const pi=1e20;function cn(m,t,a,h,d,f,b,T,k){for(let I=t;I<t+h;I++)tr(m,a*f+I,f,d,b,T,k);for(let I=a;I<a+d;I++)tr(m,I*f+t,1,h,b,T,k)}function tr(m,t,a,h,d,f,b){f[0]=0,b[0]=-pi,b[1]=pi,d[0]=m[t];for(let T=1,k=0,I=0;T<h;T++){d[T]=m[t+T*a];const E=T*T;do{const z=f[k];I=(d[T]-d[z]+E-z*z)/(T-z)/2}while(I<=b[k]&&--k>-1);k++,f[k]=T,b[k]=I,b[k+1]=pi}for(let T=0,k=0;T<h;T++){for(;b[k+1]<T;)k++;const I=f[k],E=T-I;m[t+T*a]=d[I]+E*E}}class Bt{constructor(t,a){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,function*(){const a=[];for(const f in t)for(const b of t[f])a.push(this._getAndCacheGlyphsPromise(f,b));const h=yield Promise.all(a),d={};for(const{stack:f,id:b,glyph:T}of h)d[f]||(d[f]={}),d[f][b]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return d})}_getAndCacheGlyphsPromise(t,a){return c._(this,void 0,void 0,function*(){let h=this.entries[t];h||(h=this.entries[t]={glyphs:{},requests:{},ranges:{}});let d=h.glyphs[a];if(d!==void 0)return{stack:t,id:a,glyph:d};if(d=this._tinySDF(h,t,a),d)return h.glyphs[a]=d,{stack:t,id:a,glyph:d};const f=Math.floor(a/256);if(256*f>65535)throw new Error("glyphs > 65535 not supported");if(h.ranges[f])return{stack:t,id:a,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!h.requests[f]){const T=Bt.loadGlyphRange(t,f,this.url,this.requestManager);h.requests[f]=T}const b=yield h.requests[f];for(const T in b)this._doesCharSupportLocalGlyph(+T)||(h.glyphs[+T]=b[+T]);return h.ranges[f]=!0,{stack:t,id:a,glyph:b[a]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))}_tinySDF(t,a,h){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(h))return;let f=t.tinySDF;if(!f){let T="400";/bold/i.test(a)?T="900":/medium/i.test(a)?T="500":/light/i.test(a)&&(T="200"),f=t.tinySDF=new Bt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:T})}const b=f.draw(String.fromCharCode(h));return{id:h,bitmap:new c.o({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}Bt.loadGlyphRange=function(m,t,a,h){return c._(this,void 0,void 0,function*(){const d=256*t,f=d+255,b=h.transformRequest(a.replace("{fontstack}",m).replace("{range}",`${d}-${f}`),"Glyphs"),T=yield c.l(b,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${t}, ${d}-${f}`);const k={};for(const I of c.n(T.data))k[I.id]=I;return k})},Bt.TinySDF=class{constructor({fontSize:m=24,buffer:t=3,radius:a=8,cutoff:h=.25,fontFamily:d="sans-serif",fontWeight:f="normal",fontStyle:b="normal"}={}){this.buffer=t,this.cutoff=h,this.radius=a;const T=this.size=m+4*t,k=this._createCanvas(T),I=this.ctx=k.getContext("2d",{willReadFrequently:!0});I.font=`${b} ${f} ${m}px ${d}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(m){const t=document.createElement("canvas");return t.width=t.height=m,t}draw(m){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:d,actualBoundingBoxRight:f}=this.ctx.measureText(m),b=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-d))),k=Math.min(this.size-this.buffer,b+Math.ceil(h)),I=T+2*this.buffer,E=k+2*this.buffer,z=Math.max(I*E,0),N=new Uint8ClampedArray(z),H={data:N,width:I,height:E,glyphWidth:T,glyphHeight:k,glyphTop:b,glyphLeft:0,glyphAdvance:t};if(T===0||k===0)return H;const{ctx:q,buffer:Q,gridInner:ie,gridOuter:ne}=this;q.clearRect(Q,Q,T,k),q.fillText(m,Q,Q+b);const ae=q.getImageData(Q,Q,T,k);ne.fill(pi,0,z),ie.fill(0,0,z);for(let K=0;K<k;K++)for(let ue=0;ue<T;ue++){const de=ae.data[4*(K*T+ue)+3]/255;if(de===0)continue;const ye=(K+Q)*I+ue+Q;if(de===1)ne[ye]=0,ie[ye]=pi;else{const Ie=.5-de;ne[ye]=Ie>0?Ie*Ie:0,ie[ye]=Ie<0?Ie*Ie:0}}cn(ne,0,0,I,E,I,this.f,this.v,this.z),cn(ie,Q,Q,T,k,I,this.f,this.v,this.z);for(let K=0;K<z;K++){const ue=Math.sqrt(ne[K])-Math.sqrt(ie[K]);N[K]=Math.round(255-255*(ue/this.radius+this.cutoff))}return H}};class Ge{constructor(){this.specification=c.v.light.position}possiblyEvaluate(t,a){return c.x(t.expression.evaluate(a))}interpolate(t,a,h){return{x:c.y.number(t.x,a.x,h),y:c.y.number(t.y,a.y,h),z:c.y.number(t.z,a.z,h)}}}let ut;class dt extends c.E{constructor(t){super(),ut=ut||new c.q({anchor:new c.D(c.v.light.anchor),position:new Ge,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(ut),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(c.r,t,a))for(const h in t){const d=t[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,h){return(!h||h.validate!==!1)&&c.t(this,t.call(c.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Ct=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class jt extends c.E{constructor(t){super(),this._transitionable=new c.T(Ct),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(t,a={}){if(!this._validate(c.B,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const h in t){const d=t[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,h={}){return(h==null?void 0:h.validate)!==!1&&c.t(this,t.call(c.u,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class ir{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const h=t.join(",")+String(a);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(t,a)),this.dashEntry[h]}getDashRanges(t,a,h){const d=[];let f=t.length%2==1?-t[t.length-1]*h:0,b=t[0]*h,T=!0;d.push({left:f,right:b,isDash:T,zeroLength:t[0]===0});let k=t[0];for(let I=1;I<t.length;I++){T=!T;const E=t[I];f=k*h,k+=E,b=k*h,d.push({left:f,right:b,isDash:T,zeroLength:E===0})}return d}addRoundDash(t,a,h){const d=a/2;for(let f=-h;f<=h;f++){const b=this.width*(this.nextRow+h+f);let T=0,k=t[T];for(let I=0;I<this.width;I++){I/k.right>1&&(k=t[++T]);const E=Math.abs(I-k.left),z=Math.abs(I-k.right),N=Math.min(E,z);let H;const q=f/h*(d+1);if(k.isDash){const Q=d-Math.abs(q);H=Math.sqrt(N*N+Q*Q)}else H=d-Math.sqrt(N*N+q*q);this.data[b+I]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(t){for(let T=t.length-1;T>=0;--T){const k=t[T],I=t[T+1];k.zeroLength?t.splice(T,1):I&&I.isDash===k.isDash&&(I.left=k.left,t.splice(T,1))}const a=t[0],h=t[t.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const d=this.width*this.nextRow;let f=0,b=t[f];for(let T=0;T<this.width;T++){T/b.right>1&&(b=t[++f]);const k=Math.abs(T-b.left),I=Math.abs(T-b.right),E=Math.min(k,I);this.data[d+T]=Math.max(0,Math.min(255,(b.isDash?E:-E)+128))}}addDash(t,a){const h=a?7:0,d=2*h+1;if(this.nextRow+d>this.height)return c.w("LineAtlas out of space"),null;let f=0;for(let T=0;T<t.length;T++)f+=t[T];if(f!==0){const T=this.width/f,k=this.getDashRanges(t,this.width,T);a?this.addRoundDash(k,T,h):this.addRegularDash(k)}const b={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:f};return this.nextRow+=d,this.dirty=!0,b}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Ni="maplibre_preloaded_worker_pool";class un{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<un.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ni]}numActive(){return Object.keys(this.active).length}}const hn=Math.floor(L.hardwareConcurrency/2);let Pi,nr;function Cs(){return Pi||(Pi=new un),Pi}un.workerCount=c.C(globalThis)?Math.max(Math.min(hn,3),1):1;class Ps{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const h=this.workerPool.acquire(a);for(let d=0;d<h.length;d++){const f=new c.F(h[d],a);f.name=`Worker ${d}`,this.actors.push(f)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const h=[];for(const d of this.actors)h.push(d.sendAsync({type:t,data:a}));return Promise.all(h)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const h of this.actors)h.registerMessageHandler(t,a)}}function uo(){return nr||(nr=new Ps(Cs(),c.G),nr.registerMessageHandler("GR",(m,t,a)=>c.m(t,a))),nr}function Ur(m,t){const a=c.H();return c.J(a,a,[1,1,0]),c.K(a,a,[.5*m.width,.5*m.height,1]),c.L(a,a,m.calculatePosMatrix(t.toUnwrapped()))}function ss(m,t,a,h,d,f){const b=function(z,N,H){if(z)for(const q of z){const Q=N[q];if(Q&&Q.source===H&&Q.type==="fill-extrusion")return!0}else for(const q in N){const Q=N[q];if(Q.source===H&&Q.type==="fill-extrusion")return!0}return!1}(d&&d.layers,t,m.id),T=f.maxPitchScaleFactor(),k=m.tilesIn(h,T,b);k.sort(as);const I=[];for(const z of k)I.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(t,a,m._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,d,f,T,Ur(m.transform,z.tileID))});const E=function(z){const N={},H={};for(const q of z){const Q=q.queryResults,ie=q.wrappedTileID,ne=H[ie]=H[ie]||{};for(const ae in Q){const K=Q[ae],ue=ne[ae]=ne[ae]||{},de=N[ae]=N[ae]||[];for(const ye of K)ue[ye.featureIndex]||(ue[ye.featureIndex]=!0,de.push(ye))}}return N}(I);for(const z in E)E[z].forEach(N=>{const H=N.feature,q=m.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=q});return E}function as(m,t){const a=m.tileID,h=t.tileID;return a.overscaledZ-h.overscaledZ||a.canonical.y-h.canonical.y||a.wrap-h.wrap||a.canonical.x-h.canonical.x}function ra(m,t,a){return c._(this,void 0,void 0,function*(){let h=m;if(m.url?h=(yield c.h(t.transformRequest(m.url,"Source"),a)).data:yield L.frameAsync(a),!h)return null;const d=c.M(c.e(h,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in h&&h.vector_layers&&(d.vectorLayerIds=h.vector_layers.map(f=>f.id)),d})}class we{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}extend(t){const a=this._sw,h=this._ne;let d,f;if(t instanceof c.N)d=t,f=t;else{if(!(t instanceof we))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(we.convert(t)):this.extend(c.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.N.convert(t)):this;if(d=t._sw,f=t._ne,!d||!f)return this}return a||h?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),h.lng=Math.max(f.lng,h.lng),h.lat=Math.max(f.lat,h.lat)):(this._sw=new c.N(d.lng,d.lat),this._ne=new c.N(f.lng,f.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:h}=c.N.convert(t);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&d}static convert(t){return t instanceof we?t:t&&new we(t)}static fromLngLat(t,a=0){const h=360*a/40075017,d=h/Math.cos(Math.PI/180*t.lat);return new we(new c.N(t.lng-d,t.lat-h),new c.N(t.lng+d,t.lat+h))}adjustAntiMeridian(){const t=new c.N(this._sw.lng,this._sw.lat),a=new c.N(this._ne.lng,this._ne.lat);return new we(t,t.lng>a.lng?new c.N(a.lng+360,a.lat):a)}}class Is{constructor(t,a,h){this.bounds=we.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=h||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),h=Math.floor(c.O(this.bounds.getWest())*a),d=Math.floor(c.Q(this.bounds.getNorth())*a),f=Math.ceil(c.O(this.bounds.getEast())*a),b=Math.ceil(c.Q(this.bounds.getSouth())*a);return t.x>=h&&t.x<f&&t.y>=d&&t.y<b}}class ho extends c.E{constructor(t,a,h,d){if(super(),this.id=t,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield ra(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Is(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};h.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((f,b)=>{t.reloadPromise={resolve:f,reject:b}})}else t.actor=this.dispatcher.getActor(),d="LT";t.abortController=new AbortController;try{const f=yield t.actor.sendAsync({type:d,data:h},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,f)}catch(f){if(delete t.abortController,t.aborted)return;if(f&&f.status!==404)throw f;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const h=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(h.resolve).catch(h.reject)}}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Lt extends c.E{constructor(t,a,h,d){super(),this.id=t,this.dispatcher=h,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.M(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield ra(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Is(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const h=yield W.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(h&&h.data){this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&t.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const d=this.map.painter.context,f=d.gl,b=h.data;t.texture=this.map.painter.getTileTexture(b.width),t.texture?t.texture.update(b,{useMipmap:!0}):(t.texture=new pt(d,b,f.RGBA,{useMipmap:!0}),t.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(h){if(delete t.abortController,t.aborted)t.state="unloaded";else if(h)throw t.state="errored",h}})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class ni extends Lt{constructor(t,a,h,d){super(t,a,h,d),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const d=yield W.getImage(h,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){const f=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const b=c.b(f)&&c.U()?f:yield this.readImageNow(f),T={type:this.type,uid:t.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const k=yield t.actor.sendAsync({type:"LDT",data:T});t.dem=k,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}})}readImageNow(t){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const a=t.width+2,h=t.height+2;try{return new c.R({width:a,height:h},yield c.W(t,-1,-1,a,h))}catch{}}return L.getImageData(t,1)})}_getNeighboringTiles(t){const a=t.canonical,h=Math.pow(2,a.z),d=(a.x-1+h)%h,f=a.x===0?t.wrap-1:t.wrap,b=(a.x+1+h)%h,T=a.x+1===h?t.wrap+1:t.wrap,k={};return k[new c.S(t.overscaledZ,f,a.z,d,a.y).key]={backfilled:!1},k[new c.S(t.overscaledZ,T,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(k[new c.S(t.overscaledZ,f,a.z,d,a.y-1).key]={backfilled:!1},k[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},k[new c.S(t.overscaledZ,T,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<h&&(k[new c.S(t.overscaledZ,f,a.z,d,a.y+1).key]={backfilled:!1},k[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},k[new c.S(t.overscaledZ,T,a.z,b,a.y+1).key]={backfilled:!1}),k}unloadTile(t){return c._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class po extends c.E{constructor(t,a,h,d){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=h.getActor(),this.setEventedParent(d),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const f=c.X/this.tileSize;a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*f,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*f,extent:c.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.X,radius:(a.clusterRadius||50)*f,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return c._(this,void 0,void 0,function*(){const t=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,h){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:h}})}_updateWorkerData(t){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);t?a.dataDiff=t:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(L.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const h=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||h.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let d=null;h.resourceTiming&&h.resourceTiming[this.id]&&(d=h.resourceTiming[this.id].slice(0));const f={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&c.e(f,{resourceTiming:d}),this.fire(new c.k("data",Object.assign(Object.assign({},f),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},f),{sourceDataType:"content"})))}catch(h){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(h))}})}loaded(){return this._pendingLoads===0}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const h={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:h},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(d,this.map.painter,a==="RT")})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var os=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class $r extends c.E{constructor(t,a,h,d){super(),this.id=t,this.dispatcher=h,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(t){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(c.Z.fromLngLat);this.tileID=function(d){let f=1/0,b=1/0,T=-1/0,k=-1/0;for(const N of d)f=Math.min(f,N.x),b=Math.min(b,N.y),T=Math.max(T,N.x),k=Math.max(k,N.y);const I=Math.max(T-f,k-b),E=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),z=Math.pow(2,E);return new c.a1(E,Math.floor((f+T)/2*z),Math.floor((b+k)/2*z))}(a),this.minzoom=this.maxzoom=this.tileID.z;const h=a.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(h[0].x,h[0].y,0,0),this._boundsArray.emplaceBack(h[1].x,h[1].y,c.X,0),this._boundsArray.emplaceBack(h[3].x,h[3].y,0,c.X),this._boundsArray.emplaceBack(h[2].x,h[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,os.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new pt(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const f=this.tiles[d];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,h=!0)}h&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class sa extends $r{constructor(t,a,h,d){super(t,a,h,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,os.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new pt(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const f=this.tiles[d];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,h=!0)}h&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Nn extends $r{constructor(t,a,h,d){super(t,a,h,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(f=>!Array.isArray(f)||f.length!==2||f.some(b=>typeof b!="number"))||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,h=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,os.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new pt(a,this.canvas,h.RGBA,{premultiply:!0});let d=!1;for(const f in this.tiles){const b=this.tiles[f];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const fo={},mo=m=>{switch(m){case"geojson":return po;case"image":return $r;case"raster":return Lt;case"raster-dem":return ni;case"vector":return ho;case"video":return sa;case"canvas":return Nn}return fo[m]},Re="RTLPluginLoaded";class Sr extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=uo()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return c._(this,arguments,void 0,function*(a,h=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=L.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!h)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Re))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ji=null;function Tr(){return Ji||(Ji=new Sr),Ji}class ls{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=c.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const a=t+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,f){const b={};if(!f)return b;for(const T of d){const k=T.layerIds.map(I=>f.getLayer(I)).filter(Boolean);if(k.length!==0){T.layers=k,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(I=>k.filter(E=>E.id===I)[0]));for(const I of k)b[I.id]=T}}return b}(t.buckets,a.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const f=this.buckets[d];if(f instanceof c.a6){if(this.hasSymbolBuckets=!0,!h)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const f=this.buckets[d];if(f instanceof c.a6&&f.hasRTLText){this.hasRTLText=!0,Tr().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const f=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(f))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const h in this.buckets){const d=this.buckets[h];d.uploadPending()&&d.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new pt(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new pt(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,h,d,f,b,T,k,I,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:f,scale:b,tileSize:this.tileSize,pixelPosMatrix:E,transform:k,params:T,queryPadding:this.queryPadding*I},t,a,h):{}}querySourceFeatures(t,a){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const d=h.loadVTLayers(),f=a&&a.sourceLayer?a.sourceLayer:"",b=d._geojsonTileLayer||d[f];if(!b)return;const T=c.a7(a&&a.filter),{z:k,x:I,y:E}=this.tileID.canonical,z={z:k,x:I,y:E};for(let N=0;N<b.length;N++){const H=b.feature(N);if(T.needGeometry){const ie=c.a8(H,!0);if(!T.filter(new c.z(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!T.filter(new c.z(this.tileID.overscaledZ),H))continue;const q=h.getId(H,f),Q=new c.a9(H,k,I,E,q);Q.tile=z,t.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const h=c.aa(t.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const h=Date.now();let d=!1;if(this.expirationTime>h)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const f=this.expirationTime-a;f?this.expirationTime=h+Math.max(f,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const f=this.buckets[d],b=f.layers[0].sourceLayer||"_geojsonTileLayer",T=h[b],k=t[b];if(!T||!k||Object.keys(k).length===0)continue;f.update(k,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const I=a&&a.style&&a.style.getLayer(d);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(f)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<L.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=L.now()+t}setDependencies(t,a){const h={};for(const d of a)h[d]=!0;this.dependencies[t]=h}hasDependency(t,a){for(const h of t){const d=this.dependencies[h];if(d){for(const f of a)if(d[f])return!0}}return!1}}class Ve{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(const t in this.data)for(const a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,h){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const f={value:a,timeout:void 0};if(h!==void 0&&(f.timeout=setTimeout(()=>{this.remove(t,f)},h)),this.data[d].push(f),this.order.push(d),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){const a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;const h=t.wrapped().key,d=a===void 0?0:this.data[h].indexOf(a),f=this.data[h][d];return this.data[h].splice(d,1),f.timeout&&clearTimeout(f.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(f.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){const a=[];for(const h in this.data)for(const d of this.data[h])t(d.value)||a.push(d);for(const h of a)this.remove(h.value.tileID,h)}}class wt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,h){const d=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},c.e(this.stateChanges[t][d],h),this.deletedStates[t]===null){this.deletedStates[t]={};for(const f in this.state[t])f!==d&&(this.deletedStates[t][f]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const f in this.state[t][d])h[f]||(this.deletedStates[t][d][f]=null)}else for(const f in h)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][f]===null&&delete this.deletedStates[t][d][f]}removeFeatureState(t,a,h){if(this.deletedStates[t]===null)return;const d=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},h&&a!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][h]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(h in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][h]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,a){const h=String(a),d=c.e({},(this.state[t]||{})[h],(this.stateChanges[t]||{})[h]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const f=this.deletedStates[t][a];if(f===null)return{};for(const b in f)delete d[b]}return d}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const h={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const f={};for(const b in this.stateChanges[d])this.state[d][b]||(this.state[d][b]={}),c.e(this.state[d][b],this.stateChanges[d][b]),f[b]=this.state[d][b];h[d]=f}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const f={};if(this.deletedStates[d]===null)for(const b in this.state[d])f[b]={},this.state[d][b]={};else for(const b in this.deletedStates[d]){if(this.deletedStates[d][b]===null)this.state[d][b]={};else for(const T of Object.keys(this.deletedStates[d][b]))delete this.state[d][b][T];f[b]=this.state[d][b]}h[d]=h[d]||{},c.e(h[d],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const d in t)t[d].setFeatureState(h,a)}}class ft extends c.E{constructor(t,a,h){super(),this.id=t,this.dispatcher=h,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,f,b,T)=>{const k=new(mo(f.type))(d,f,b,T);if(k.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${k.id}`);return k})(t,a,h,this),this._tiles={},this._cache=new Ve(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new wt,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,h){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,h)}catch(d){t.state="errored",d.status!==404?this._source.fire(new c.j(d,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const h=this._tiles[a];h.upload(t),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(dn).map(t=>t.key)}getRenderableIds(t){const a=[];for(const h in this._tiles)this._isIdRenderable(h,t)&&a.push(this._tiles[h]);return t?a.sort((h,d)=>{const f=h.tileID,b=d.tileID,T=new c.P(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),k=new c.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-b.overscaledZ||k.y-T.y||k.x-T.x}).map(h=>h.tileID.key):a.map(h=>h.tileID).sort(dn).map(h=>h.key)}hasRenderableParent(t){const a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,a){return c._(this,void 0,void 0,function*(){const h=this._tiles[t];h&&(h.state!=="loading"&&(h.state=a),yield this._loadTile(h,t,a))})}_tileLoaded(t,a,h){t.timeAdded=L.now(),h==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const f=a[d];if(t.neighboringTiles&&t.neighboringTiles[f]){const b=this.getTileByID(f);h(t,b),h(b,t)}}function h(d,f){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let b=f.tileID.canonical.x-d.tileID.canonical.x;const T=f.tileID.canonical.y-d.tileID.canonical.y,k=Math.pow(2,d.tileID.canonical.z),I=f.tileID.key;b===0&&T===0||Math.abs(T)>1||(Math.abs(b)>1&&(Math.abs(b+k)===1?b+=k:Math.abs(b-k)===1&&(b-=k)),f.dem&&d.dem&&(d.dem.backfillBorder(f.dem,b,T),d.neighboringTiles&&d.neighboringTiles[I]&&(d.neighboringTiles[I].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,h,d){for(const f in this._tiles){let b=this._tiles[f];if(d[f]||!b.hasData()||b.tileID.overscaledZ<=a||b.tileID.overscaledZ>h)continue;let T=b.tileID;for(;b&&b.tileID.overscaledZ>a+1;){const I=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[I.key],b&&b.hasData()&&(T=I)}let k=T;for(;k.overscaledZ>a;)if(k=k.scaledTo(k.overscaledZ-1),t[k.key]){d[T.key]=T;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){const h=this._loadedParentTiles[t.key];return h&&h.tileID.overscaledZ>=a?h:null}for(let h=t.overscaledZ-1;h>=a;h--){const d=t.scaledTo(h),f=this._getLoadedTile(d);if(f)return f}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,h=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(a*h*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(f)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){const h={};for(const d in this._tiles){const f=this._tiles[d];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+a),h[f.tileID.key]=f}this._tiles=h;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(t,a,h,d,f,b){const T={},k={},I=Object.keys(t),E=L.now();for(const z of I){const N=t[z],H=this._tiles[z];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=E)continue;const q=this.findLoadedParent(N,a),Q=this.findLoadedSibling(N),ie=q||Q||null;ie&&(this._addTile(ie.tileID),T[ie.tileID.key]=ie.tileID),k[z]=N}this._retainLoadedChildren(k,d,h,t);for(const z in T)t[z]||(this._coveredTiles[z]=!0,t[z]=T[z]);if(b){const z={},N={};for(const H of f)this._tiles[H.key].hasData()?z[H.key]=H:N[H.key]=H;for(const H in N){const q=N[H].children(this._source.maxzoom);this._tiles[q[0].key]&&this._tiles[q[1].key]&&this._tiles[q[2].key]&&this._tiles[q[3].key]&&(z[q[0].key]=t[q[0].key]=q[0],z[q[1].key]=t[q[1].key]=q[1],z[q[2].key]=t[q[2].key]=q[2],z[q[3].key]=t[q[3].key]=q[3],delete N[H])}for(const H in N){const q=N[H],Q=this.findLoadedParent(q,this._source.minzoom),ie=this.findLoadedSibling(q),ne=Q||ie||null;if(ne){z[ne.tileID.key]=t[ne.tileID.key]=ne.tileID;for(const ae in z)z[ae].isChildOf(ne.tileID)&&delete z[ae]}}for(const H in this._tiles)z[H]||(this._coveredTiles[H]=!0)}}update(t,a){if(!this._sourceLoaded||this._paused)return;let h;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new c.S(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(h=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(h=h.filter(E=>this._source.hasTile(E)))):h=[];const d=t.coveringZoomLevel(this._source),f=Math.max(d-ft.maxOverzooming,this._source.minzoom),b=Math.max(d+ft.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const E={};for(const z of h)if(z.canonical.z>this._source.minzoom){const N=z.scaledTo(z.canonical.z-1);E[N.key]=N;const H=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));E[H.key]=H}h=h.concat(Object.values(E))}const T=h.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(h,d);rr(this._source.type)&&this._updateCoveredAndRetainedTiles(k,f,b,d,h,a);for(const E in k)this._tiles[E].clearFadeHold();const I=c.ab(this._tiles,k);for(const E of I){const z=this._tiles[E];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(E)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var h;const d={},f={},b=Math.max(a-ft.maxOverzooming,this._source.minzoom),T=Math.max(a+ft.maxUnderzooming,this._source.minzoom),k={};for(const I of t){const E=this._addTile(I);d[I.key]=I,E.hasData()||a<this._source.maxzoom&&(k[I.key]=I)}this._retainLoadedChildren(k,a,T,d);for(const I of t){let E=this._tiles[I.key];if(E.hasData())continue;if(a+1>this._source.maxzoom){const N=I.children(this._source.maxzoom)[0],H=this.getTile(N);if(H&&H.hasData()){d[N.key]=N;continue}}else{const N=I.children(this._source.maxzoom);if(d[N[0].key]&&d[N[1].key]&&d[N[2].key]&&d[N[3].key])continue}let z=E.wasRequested();for(let N=I.overscaledZ-1;N>=b;--N){const H=I.scaledTo(N);if(f[H.key])break;if(f[H.key]=!0,E=this.getTile(H),!E&&z&&(E=this._addTile(H)),E){const q=E.hasData();if((q||!(!((h=this.map)===null||h===void 0)&&h.cancelPendingTileRequestsWhileZooming)||z)&&(d[H.key]=H),z=E.wasRequested(),q)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const a=[];let h,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){h=this._loadedParentTiles[d.key];break}a.push(d.key);const f=d.scaledTo(d.overscaledZ-1);if(h=this._getLoadedTile(f),h)break;d=f}for(const f of a)this._loadedParentTiles[f]=h}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const a=this._tiles[t].tileID,h=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=h}}_addTile(t){let a=this._tiles[t.key];if(a)return a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));const h=a;return a||(a=new ls(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._tiles[t.key]=a,h||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const h=a.getExpiryTimeout();h&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},h))}_removeTile(t){const a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){const a=t.sourceDataType;t.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,a,h){const d=[],f=this.transform;if(!f)return d;const b=h?f.getCameraQueryGeometry(t):t,T=t.map(q=>f.pointCoordinate(q,this.terrain)),k=b.map(q=>f.pointCoordinate(q,this.terrain)),I=this.getIds();let E=1/0,z=1/0,N=-1/0,H=-1/0;for(const q of k)E=Math.min(E,q.x),z=Math.min(z,q.y),N=Math.max(N,q.x),H=Math.max(H,q.y);for(let q=0;q<I.length;q++){const Q=this._tiles[I[q]];if(Q.holdingForFade())continue;const ie=Q.tileID,ne=Math.pow(2,f.zoom-Q.tileID.overscaledZ),ae=a*Q.queryPadding*c.X/Q.tileSize/ne,K=[ie.getTilePoint(new c.Z(E,z)),ie.getTilePoint(new c.Z(N,H))];if(K[0].x-ae<c.X&&K[0].y-ae<c.X&&K[1].x+ae>=0&&K[1].y+ae>=0){const ue=T.map(ye=>ie.getTilePoint(ye)),de=k.map(ye=>ie.getTilePoint(ye));d.push({tile:Q,tileID:ie,queryGeometry:ue,cameraQueryGeometry:de,scale:ne})}}return d}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map(h=>this._tiles[h].tileID);for(const h of a)h.posMatrix=this.transform.calculatePosMatrix(h.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(rr(this._source.type)){const t=L.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=t)return!0}return!1}setFeatureState(t,a,h){this._state.updateState(t=t||"_geojsonTileLayer",a,h)}removeFeatureState(t,a,h){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,h)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,h){const d=this._tiles[t];d&&d.setDependencies(a,h)}reloadTilesForDependencies(t,a){for(const h in this._tiles)this._tiles[h].hasDependency(t,a)&&this._reloadTile(h,"reloading");this._cache.filter(h=>!h.hasDependency(t,a))}}function dn(m,t){const a=Math.abs(2*m.wrap)-+(m.wrap<0),h=Math.abs(2*t.wrap)-+(t.wrap<0);return m.overscaledZ-t.overscaledZ||h-a||t.canonical.y-m.canonical.y||t.canonical.x-m.canonical.x}function rr(m){return m==="raster"||m==="image"||m==="video"}ft.maxOverzooming=10,ft.maxUnderzooming=3;class _t{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.ac(t,0,1);let a=1,h=this._distances[a];const d=t*this.paddedLength+this.padding;for(;h<d&&a<this._distances.length;)h=this._distances[++a];const f=a-1,b=this._distances[f],T=h-b,k=T>0?(d-b)/T:0;return this.points[f].mult(1-k).add(this.points[a].mult(k))}}function kr(m,t){let a=!0;return m==="always"||m!=="never"&&t!=="never"||(a=!1),a}class Gr{constructor(t,a,h){const d=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(t/h),this.yCellCount=Math.ceil(a/h);for(let b=0;b<this.xCellCount*this.yCellCount;b++)d.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,h,d,f){this._forEachCell(a,h,d,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(f)}insertCircle(t,a,h,d){this._forEachCell(a-d,h-d,a+d,h+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(h),this.circles.push(d)}_insertBoxCell(t,a,h,d,f,b){this.boxCells[f].push(b)}_insertCircleCell(t,a,h,d,f,b){this.circleCells[f].push(b)}_query(t,a,h,d,f,b,T){if(h<0||t>this.width||d<0||a>this.height)return[];const k=[];if(t<=0&&a<=0&&this.width<=h&&this.height<=d){if(f)return[{key:null,x1:t,y1:a,x2:h,y2:d}];for(let I=0;I<this.boxKeys.length;I++)k.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const E=this.circles[3*I],z=this.circles[3*I+1],N=this.circles[3*I+2];k.push({key:this.circleKeys[I],x1:E-N,y1:z-N,x2:E+N,y2:z+N})}}else this._forEachCell(t,a,h,d,this._queryCell,k,{hitTest:f,overlapMode:b,seenUids:{box:{},circle:{}}},T);return k}query(t,a,h,d){return this._query(t,a,h,d,!1,null)}hitTest(t,a,h,d,f,b){return this._query(t,a,h,d,!0,f,b).length>0}hitTestCircle(t,a,h,d,f){const b=t-h,T=t+h,k=a-h,I=a+h;if(T<0||b>this.width||I<0||k>this.height)return!1;const E=[];return this._forEachCell(b,k,T,I,this._queryCellCircle,E,{hitTest:!0,overlapMode:d,circle:{x:t,y:a,radius:h},seenUids:{box:{},circle:{}}},f),E.length>0}_queryCell(t,a,h,d,f,b,T,k){const{seenUids:I,hitTest:E,overlapMode:z}=T,N=this.boxCells[f];if(N!==null){const q=this.bboxes;for(const Q of N)if(!I.box[Q]){I.box[Q]=!0;const ie=4*Q,ne=this.boxKeys[Q];if(t<=q[ie+2]&&a<=q[ie+3]&&h>=q[ie+0]&&d>=q[ie+1]&&(!k||k(ne))&&(!E||!kr(z,ne.overlapMode))&&(b.push({key:ne,x1:q[ie],y1:q[ie+1],x2:q[ie+2],y2:q[ie+3]}),E))return!0}}const H=this.circleCells[f];if(H!==null){const q=this.circles;for(const Q of H)if(!I.circle[Q]){I.circle[Q]=!0;const ie=3*Q,ne=this.circleKeys[Q];if(this._circleAndRectCollide(q[ie],q[ie+1],q[ie+2],t,a,h,d)&&(!k||k(ne))&&(!E||!kr(z,ne.overlapMode))){const ae=q[ie],K=q[ie+1],ue=q[ie+2];if(b.push({key:ne,x1:ae-ue,y1:K-ue,x2:ae+ue,y2:K+ue}),E)return!0}}}return!1}_queryCellCircle(t,a,h,d,f,b,T,k){const{circle:I,seenUids:E,overlapMode:z}=T,N=this.boxCells[f];if(N!==null){const q=this.bboxes;for(const Q of N)if(!E.box[Q]){E.box[Q]=!0;const ie=4*Q,ne=this.boxKeys[Q];if(this._circleAndRectCollide(I.x,I.y,I.radius,q[ie+0],q[ie+1],q[ie+2],q[ie+3])&&(!k||k(ne))&&!kr(z,ne.overlapMode))return b.push(!0),!0}}const H=this.circleCells[f];if(H!==null){const q=this.circles;for(const Q of H)if(!E.circle[Q]){E.circle[Q]=!0;const ie=3*Q,ne=this.circleKeys[Q];if(this._circlesCollide(q[ie],q[ie+1],q[ie+2],I.x,I.y,I.radius)&&(!k||k(ne))&&!kr(z,ne.overlapMode))return b.push(!0),!0}}}_forEachCell(t,a,h,d,f,b,T,k){const I=this._convertToXCellCoord(t),E=this._convertToYCellCoord(a),z=this._convertToXCellCoord(h),N=this._convertToYCellCoord(d);for(let H=I;H<=z;H++)for(let q=E;q<=N;q++)if(f.call(this,t,a,h,d,this.xCellCount*q+H,b,T,k))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,h,d,f,b){const T=d-t,k=f-a,I=h+b;return I*I>T*T+k*k}_circleAndRectCollide(t,a,h,d,f,b,T){const k=(b-d)/2,I=Math.abs(t-(d+k));if(I>k+h)return!1;const E=(T-f)/2,z=Math.abs(a-(f+E));if(z>E+h)return!1;if(I<=k||z<=E)return!0;const N=I-k,H=z-E;return N*N+H*H<=h*h}}function cs(m,t,a,h,d){const f=c.H();return t?(c.K(f,f,[1/d,1/d,1]),a||c.ad(f,f,h.angle)):c.L(f,h.labelPlaneMatrix,m),f}function Cr(m,t,a,h,d){if(t){const f=c.ae(m);return c.K(f,f,[d,d,1]),a||c.ad(f,f,-h.angle),f}return h.glCoordMatrix}function ee(m,t,a,h){let d;h?(d=[m,t,h(m,t),1],c.af(d,d,a)):(d=[m,t,0,1],At(d,d,a));const f=d[3];return{point:new c.P(d[0]/f,d[1]/f),signedDistanceFromCamera:f,isOccluded:!1}}function O(m,t){return .5+m/t*.5}function F(m,t){return m.x>=-t[0]&&m.x<=t[0]&&m.y>=-t[1]&&m.y<=t[1]}function G(m,t,a,h,d,f,b,T,k,I,E,z,N,H,q){const Q=h?m.textSizeData:m.iconSizeData,ie=c.ag(Q,a.transform.zoom),ne=[256/a.width*2+1,256/a.height*2+1],ae=h?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ae.clear();const K=m.lineVertexArray,ue=h?m.text.placedSymbolArray:m.icon.placedSymbolArray,de=a.transform.width/a.transform.height;let ye=!1;for(let Ie=0;Ie<ue.length;Ie++){const Le=ue.get(Ie);if(Le.hidden||Le.writingMode===c.ah.vertical&&!ye){lt(Le.numGlyphs,ae);continue}ye=!1;const $e=ee(Le.anchorX,Le.anchorY,t,q);if(!F($e.point,ne)){lt(Le.numGlyphs,ae);continue}const We=O(a.transform.cameraToCenterDistance,$e.signedDistanceFromCamera),je=c.ai(Q,ie,Le),Oe=b?je/We:je*We,Qe={getElevation:q,labelPlaneMatrix:d,lineVertexArray:K,pitchWithMap:b,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:I,tileAnchorPoint:new c.P(Le.anchorX,Le.anchorY),unwrappedTileID:E,width:z,height:N,translation:H},yt=he(Qe,Le,Oe,!1,T,t,f,m.glyphOffsetArray,ae,de,k);ye=yt.useVertical,(yt.notEnoughRoom||ye||yt.needsFlipping&&he(Qe,Le,Oe,!0,T,t,f,m.glyphOffsetArray,ae,de,k).notEnoughRoom)&&lt(Le.numGlyphs,ae)}h?m.text.dynamicLayoutVertexBuffer.updateData(ae):m.icon.dynamicLayoutVertexBuffer.updateData(ae)}function J(m,t,a,h,d,f,b,T){const k=f.glyphStartIndex+f.numGlyphs,I=f.lineStartIndex,E=f.lineStartIndex+f.lineLength,z=t.getoffsetX(f.glyphStartIndex),N=t.getoffsetX(k-1),H=Fe(m*z,a,h,d,f.segment,I,E,T,b);if(!H)return null;const q=Fe(m*N,a,h,d,f.segment,I,E,T,b);return q?T.projectionCache.anyProjectionOccluded?null:{first:H,last:q}:null}function le(m,t,a,h){return m===c.ah.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*h?{useVertical:!0}:(m===c.ah.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function he(m,t,a,h,d,f,b,T,k,I,E){const z=a/24,N=t.lineOffsetX*z,H=t.lineOffsetY*z;let q;if(t.numGlyphs>1){const Q=t.glyphStartIndex+t.numGlyphs,ie=t.lineStartIndex,ne=t.lineStartIndex+t.lineLength,ae=J(z,T,N,H,h,t,E,m);if(!ae)return{notEnoughRoom:!0};const K=ee(ae.first.point.x,ae.first.point.y,b,m.getElevation).point,ue=ee(ae.last.point.x,ae.last.point.y,b,m.getElevation).point;if(d&&!h){const de=le(t.writingMode,K,ue,I);if(de)return de}q=[ae.first];for(let de=t.glyphStartIndex+1;de<Q-1;de++)q.push(Fe(z*T.getoffsetX(de),N,H,h,t.segment,ie,ne,m,E));q.push(ae.last)}else{if(d&&!h){const ie=ee(m.tileAnchorPoint.x,m.tileAnchorPoint.y,f,m.getElevation).point,ne=t.lineStartIndex+t.segment+1,ae=new c.P(m.lineVertexArray.getx(ne),m.lineVertexArray.gety(ne)),K=ee(ae.x,ae.y,f,m.getElevation),ue=K.signedDistanceFromCamera>0?K.point:function(ye,Ie,Le,$e,We,je){return fe(ye,Ie,Le,1,We,je)}(m.tileAnchorPoint,ae,ie,0,f,m),de=le(t.writingMode,ie,ue,I);if(de)return de}const Q=Fe(z*T.getoffsetX(t.glyphStartIndex),N,H,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,m,E);if(!Q||m.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};q=[Q]}for(const Q of q)c.aj(k,Q.point,Q.angle);return{}}function fe(m,t,a,h,d,f){const b=m.add(m.sub(t)._unit()),T=d!==void 0?ee(b.x,b.y,d,f.getElevation).point:Te(b.x,b.y,f).point,k=a.sub(T);return a.add(k._mult(h/k.mag()))}function re(m,t,a){const h=t.projectionCache;if(h.projections[m])return h.projections[m];const d=new c.P(t.lineVertexArray.getx(m),t.lineVertexArray.gety(m)),f=Te(d.x,d.y,t);if(f.signedDistanceFromCamera>0)return h.projections[m]=f.point,h.anyProjectionOccluded=h.anyProjectionOccluded||f.isOccluded,f.point;const b=m-a.direction;return function(T,k,I,E,z){return fe(T,k,I,E,void 0,z)}(a.distanceFromAnchor===0?t.tileAnchorPoint:new c.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),d,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function Te(m,t,a){const h=m+a.translation[0],d=t+a.translation[1];let f;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(f=a.projection.projectTileCoordinates(h,d,a.unwrappedTileID,a.getElevation),f.point.x=(.5*f.point.x+.5)*a.width,f.point.y=(.5*-f.point.y+.5)*a.height):(f=ee(h,d,a.labelPlaneMatrix,a.getElevation),f.isOccluded=!1),f}function Ee(m,t,a){return m._unit()._perp()._mult(t*a)}function xe(m,t,a,h,d,f,b,T,k){if(T.projectionCache.offsets[m])return T.projectionCache.offsets[m];const I=a.add(t);if(m+k.direction<h||m+k.direction>=d)return T.projectionCache.offsets[m]=I,I;const E=re(m+k.direction,T,k),z=Ee(E.sub(a),b,k.direction),N=a.add(z),H=E.add(z);return T.projectionCache.offsets[m]=c.ak(f,I,N,H)||I,T.projectionCache.offsets[m]}function Fe(m,t,a,h,d,f,b,T,k){const I=h?m-t:m+t;let E=I>0?1:-1,z=0;h&&(E*=-1,z=Math.PI),E<0&&(z+=Math.PI);let N,H=E>0?f+d:f+d+1;T.projectionCache.cachedAnchorPoint?N=T.projectionCache.cachedAnchorPoint:(N=Te(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=N);let q,Q,ie=N,ne=N,ae=0,K=0;const ue=Math.abs(I),de=[];let ye;for(;ae+K<=ue;){if(H+=E,H<f||H>=b)return null;ae+=K,ne=ie,Q=q;const $e={absOffsetX:ue,direction:E,distanceFromAnchor:ae,previousVertex:ne};if(ie=re(H,T,$e),a===0)de.push(ne),ye=ie.sub(ne);else{let We;const je=ie.sub(ne);We=je.mag()===0?Ee(re(H+E,T,$e).sub(ie),a,E):Ee(je,a,E),Q||(Q=ne.add(We)),q=xe(H,We,ie,f,b,Q,a,T,$e),de.push(Q),ye=q.sub(Q)}K=ye.mag()}const Ie=ye._mult((ue-ae)/K)._add(Q||ne),Le=z+Math.atan2(ie.y-ne.y,ie.x-ne.x);return de.push(Ie),{point:Ie,angle:k?Le:0,path:de}}const rt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function lt(m,t){for(let a=0;a<m;a++){const h=t.length;t.resize(h+4),t.float32.set(rt,3*h)}}function At(m,t,a){const h=t[0],d=t[1];return m[0]=a[0]*h+a[4]*d+a[12],m[1]=a[1]*h+a[5]*d+a[13],m[3]=a[3]*h+a[7]*d+a[15],m}const vt=100;class Mt{constructor(t,a,h=new Gr(t.width+200,t.height+200,25),d=new Gr(t.width+200,t.height+200,25)){this.transform=t,this.mapProjection=a,this.grid=h,this.ignoredGrid=d,this.pitchFactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+vt,this.screenBottomBoundary=t.height+vt,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,h,d,f,b,T,k,I,E,z){const N=t.anchorPointX+k[0],H=t.anchorPointY+k[1],q=this.projectAndGetPerspectiveRatio(d,N,H,f,E),Q=h*q.perspectiveRatio;let ie;if(b||T)ie=this._projectCollisionBox(t,Q,d,f,b,T,k,q,E,z);else{const de=q.point.x+(z?z.x*Q:0),ye=q.point.y+(z?z.y*Q:0);ie={allPointsOccluded:!1,box:[de+t.x1*Q,ye+t.y1*Q,de+t.x2*Q,ye+t.y2*Q]}}const[ne,ae,K,ue]=ie.box;return this.mapProjection.useSpecialProjectionForSymbols&&(b?ie.allPointsOccluded:this.mapProjection.isOccluded(N,H,f))||q.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ne,ae,K,ue)||a!=="always"&&this.grid.hitTest(ne,ae,K,ue,a,I)?{box:[ne,ae,K,ue],placeable:!1,offscreen:!1}:{box:[ne,ae,K,ue],placeable:!0,offscreen:this.isOffscreen(ne,ae,K,ue)}}placeCollisionCircles(t,a,h,d,f,b,T,k,I,E,z,N,H,q,Q,ie){const ne=[],ae=new c.P(a.anchorX,a.anchorY),K=this.getPerspectiveRatio(b,ae.x,ae.y,T,ie),ue=(z?f/K:f*K)/c.ap,de={getElevation:ie,labelPlaneMatrix:k,lineVertexArray:h,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ae,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:Q},ye=J(ue,d,a.lineOffsetX*ue,a.lineOffsetY*ue,!1,a,!1,de);let Ie=!1,Le=!1,$e=!0;if(ye){const We=.5*H*K+q,je=new c.P(-100,-100),Oe=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Qe=new _t,yt=ye.first,Ne=ye.last;let qe=[];for(let xt=yt.path.length-1;xt>=1;xt--)qe.push(yt.path[xt]);for(let xt=1;xt<Ne.path.length;xt++)qe.push(Ne.path[xt]);const mt=2.5*We;if(I){const xt=this.projectPathToScreenSpace(qe,de,I);qe=xt.some(kt=>kt.signedDistanceFromCamera<=0)?[]:xt.map(kt=>kt.point)}let Yt=[];if(qe.length>0){const xt=qe[0].clone(),kt=qe[0].clone();for(let Jt=1;Jt<qe.length;Jt++)xt.x=Math.min(xt.x,qe[Jt].x),xt.y=Math.min(xt.y,qe[Jt].y),kt.x=Math.max(kt.x,qe[Jt].x),kt.y=Math.max(kt.y,qe[Jt].y);Yt=xt.x>=je.x&&kt.x<=Oe.x&&xt.y>=je.y&&kt.y<=Oe.y?[qe]:kt.x<je.x||xt.x>Oe.x||kt.y<je.y||xt.y>Oe.y?[]:c.al([qe],je.x,je.y,Oe.x,Oe.y)}for(const xt of Yt){Qe.reset(xt,.25*We);let kt=0;kt=Qe.length<=.5*We?1:Math.ceil(Qe.paddedLength/mt)+1;for(let Jt=0;Jt<kt;Jt++){const $i=Jt/Math.max(kt-1,1),ur=Qe.lerp($i),Qt=ur.x+vt,mn=ur.y+vt;ne.push(Qt,mn,We,0);const en=Qt-We,Gi=mn-We,tn=Qt+We,Mr=mn+We;if($e=$e&&this.isOffscreen(en,Gi,tn,Mr),Le=Le||this.isInsideGrid(en,Gi,tn,Mr),t!=="always"&&this.grid.hitTestCircle(Qt,mn,We,t,N)&&(Ie=!0,!E))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!E&&Ie||!Le||K<this.perspectiveRatioCutoff?[]:ne,offscreen:$e,collisionDetected:Ie}}projectPathToScreenSpace(t,a,h){return t.map(d=>ee(d.x,d.y,h,a.getElevation))}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let h=1/0,d=1/0,f=-1/0,b=-1/0;for(const E of t){const z=new c.P(E.x+vt,E.y+vt);h=Math.min(h,z.x),d=Math.min(d,z.y),f=Math.max(f,z.x),b=Math.max(b,z.y),a.push(z)}const T=this.grid.query(h,d,f,b).concat(this.ignoredGrid.query(h,d,f,b)),k={},I={};for(const E of T){const z=E.key;if(k[z.bucketInstanceId]===void 0&&(k[z.bucketInstanceId]={}),k[z.bucketInstanceId][z.featureIndex])continue;const N=[new c.P(E.x1,E.y1),new c.P(E.x2,E.y1),new c.P(E.x2,E.y2),new c.P(E.x1,E.y2)];c.am(a,N)&&(k[z.bucketInstanceId][z.featureIndex]=!0,I[z.bucketInstanceId]===void 0&&(I[z.bucketInstanceId]=[]),I[z.bucketInstanceId].push(z.featureIndex))}return I}insertCollisionBox(t,a,h,d,f,b){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:f,collisionGroupID:b,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,h,d,f,b){const T=h?this.ignoredGrid:this.grid,k={bucketInstanceId:d,featureIndex:f,collisionGroupID:b,overlapMode:a};for(let I=0;I<t.length;I+=4)T.insertCircle(k,t[I],t[I+1],t[I+2])}projectAndGetPerspectiveRatio(t,a,h,d,f){let b;f?(b=[a,h,f(a,h),1],c.af(b,b,t)):(b=[a,h,0,1],At(b,b,t));const T=b[3];return{point:new c.P((b[0]/T+1)/2*this.transform.width+vt,(-b[1]/T+1)/2*this.transform.height+vt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}getPerspectiveRatio(t,a,h,d,f){const b=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,h,d,f):ee(a,h,t,f);return .5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(t,a,h,d){return h<vt||t>=this.screenRightBoundary||d<vt||a>this.screenBottomBoundary}isInsideGrid(t,a,h,d){return h>=0&&t<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=c.an([]);return c.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,h,d,f,b,T,k,I,E){let z=new c.P(1,0),N=new c.P(0,1);const H=new c.P(t.anchorPointX+T[0],t.anchorPointY+T[1]);if(b&&!f){const $e=this.projectAndGetPerspectiveRatio(h,H.x+1,H.y,d,I).point.sub(k.point).unit(),We=Math.atan($e.y/$e.x)+($e.x<0?Math.PI:0),je=Math.sin(We),Oe=Math.cos(We);z=new c.P(Oe,je),N=new c.P(-je,Oe)}else if(!b&&f){const $e=-this.transform.angle,We=Math.sin($e),je=Math.cos($e);z=new c.P(je,We),N=new c.P(-We,je)}let q=k.point,Q=a;if(f){q=H;const $e=this.transform.zoom-Math.floor(this.transform.zoom);Q=Math.pow(2,-$e),Q*=this.mapProjection.getPitchedTextCorrection(this.transform,H,d),E||(Q*=c.ac(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}E&&(q=q.add(z.mult(E.x*Q)).add(N.mult(E.y*Q)));const ie=t.x1*Q,ne=t.x2*Q,ae=(ie+ne)/2,K=t.y1*Q,ue=t.y2*Q,de=(K+ue)/2,ye=[{offsetX:ie,offsetY:K},{offsetX:ae,offsetY:K},{offsetX:ne,offsetY:K},{offsetX:ne,offsetY:de},{offsetX:ne,offsetY:ue},{offsetX:ae,offsetY:ue},{offsetX:ie,offsetY:ue},{offsetX:ie,offsetY:de}];let Ie=[];for(const{offsetX:$e,offsetY:We}of ye)Ie.push(new c.P(q.x+z.x*$e+N.x*We,q.y+z.y*$e+N.y*We));let Le=!1;if(f){const $e=Ie.map(We=>this.projectAndGetPerspectiveRatio(h,We.x,We.y,d,I));Le=$e.some(We=>!We.isOccluded),Ie=$e.map(We=>We.point)}else Le=!0;return{box:c.ao(Ie),allPointsOccluded:!Le}}}function Tt(m,t,a){return t*(c.X/(m.tileSize*Math.pow(2,a-m.tileID.overscaledZ)))}class xi{constructor(t,a,h,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):d&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class ri{constructor(t,a,h,d,f){this.text=new xi(t?t.text:null,a,h,f),this.icon=new xi(t?t.icon:null,a,d,f)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bt{constructor(t,a,h){this.text=t,this.icon=a,this.skipFade=h}}class Vt{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class ti{constructor(t,a,h,d,f){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=h,this.bucketIndex=d,this.tileID=f}}class Ii{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:h=>h.collisionGroupID===a}}return this.collisionGroups[t]}}function Li(m,t,a,h,d){const{horizontalAlign:f,verticalAlign:b}=c.au(m);return new c.P(-(f-.5)*t+h[0]*d,-(b-.5)*a+h[1]*d)}class Qi{constructor(t,a,h,d,f,b){this.transform=t.clone(),this.terrain=h,this.collisionIndex=new Mt(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Ii(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(h,d)=>a.getElevation(t,h,d):null}getBucketParts(t,a,h,d){const f=h.getBucket(a),b=h.latestFeatureIndex;if(!f||!b||a.id!==f.layerIds[0])return;const T=h.collisionBoxArray,k=f.layers[0].layout,I=f.layers[0].paint,E=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),z=h.tileSize/c.X,N=h.tileID.toUnwrapped(),H=this.transform.calculatePosMatrix(N),q=k.get("text-pitch-alignment")==="map",Q=k.get("text-rotation-alignment")==="map",ie=Tt(h,1,this.transform.zoom),ne=this.collisionIndex.mapProjection.translatePosition(this.transform,h,I.get("text-translate"),I.get("text-translate-anchor")),ae=this.collisionIndex.mapProjection.translatePosition(this.transform,h,I.get("icon-translate"),I.get("icon-translate-anchor")),K=cs(H,q,Q,this.transform,ie);let ue=null;if(q){const ye=Cr(H,q,Q,this.transform,ie);ue=c.L([],this.transform.labelPlaneMatrix,ye)}this.retainedQueryData[f.bucketInstanceId]=new ti(f.bucketInstanceId,b,f.sourceLayerIndex,f.index,h.tileID);const de={bucket:f,layout:k,translationText:ne,translationIcon:ae,posMatrix:H,unwrappedTileID:N,textLabelPlaneMatrix:K,labelToScreenMatrix:ue,scale:E,textPixelRatio:z,holdingForFade:h.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:c.ag(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(d)for(const ye of f.sortKeyRanges){const{sortKey:Ie,symbolInstanceStart:Le,symbolInstanceEnd:$e}=ye;t.push({sortKey:Ie,symbolInstanceStart:Le,symbolInstanceEnd:$e,parameters:de})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:de})}attemptAnchorPlacement(t,a,h,d,f,b,T,k,I,E,z,N,H,q,Q,ie,ne,ae,K){const ue=c.aq[t.textAnchor],de=[t.textOffset0,t.textOffset1],ye=Li(ue,h,d,de,f),Ie=this.collisionIndex.placeCollisionBox(a,N,k,I,E,T,b,ie,z.predicate,K,ye);if((!ae||this.collisionIndex.placeCollisionBox(ae,N,k,I,E,T,b,ne,z.predicate,K,ye).placeable)&&Ie.placeable){let Le;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Le=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:de,width:h,height:d,anchor:ue,textBoxScale:f,prevAnchor:Le},this.markUsedJustification(q,ue,H,Q),q.allowVerticalPlacement&&(this.markUsedOrientation(q,Q,H),this.placedOrientations[H.crossTileID]=Q),{shift:ye,placedGlyphBoxes:Ie}}}placeLayerBucketPart(t,a,h){const{bucket:d,layout:f,translationText:b,translationIcon:T,posMatrix:k,unwrappedTileID:I,textLabelPlaneMatrix:E,labelToScreenMatrix:z,textPixelRatio:N,holdingForFade:H,collisionBoxArray:q,partiallyEvaluatedTextSize:Q,collisionGroup:ie}=t.parameters,ne=f.get("text-optional"),ae=f.get("icon-optional"),K=c.ar(f,"text-overlap","text-allow-overlap"),ue=K==="always",de=c.ar(f,"icon-overlap","icon-allow-overlap"),ye=de==="always",Ie=f.get("text-rotation-alignment")==="map",Le=f.get("text-pitch-alignment")==="map",$e=f.get("icon-text-fit")!=="none",We=f.get("symbol-z-order")==="viewport-y",je=ue&&(ye||!d.hasIconData()||ae),Oe=ye&&(ue||!d.hasTextData()||ne);!d.collisionArrays&&q&&d.deserializeCollisionBoxes(q);const Qe=this._getTerrainElevationFunc(this.retainedQueryData[d.bucketInstanceId].tileID),yt=(Ne,qe,mt)=>{var Yt,xt;if(a[Ne.crossTileID])return;if(H)return void(this.placements[Ne.crossTileID]=new bt(!1,!1,!1));let kt=!1,Jt=!1,$i=!0,ur=null,Qt={box:null,placeable:!1,offscreen:null},mn={placeable:!1},en=null,Gi=null,tn=null,Mr=0,Pa=0,jl=0;qe.textFeatureIndex?Mr=qe.textFeatureIndex:Ne.useRuntimeCollisionCircles&&(Mr=Ne.featureIndex),qe.verticalTextFeatureIndex&&(Pa=qe.verticalTextFeatureIndex);const Ia=qe.textBox;if(Ia){const Zn=Ri=>{let Hi=c.ah.horizontal;if(d.allowVerticalPlacement&&!Ri&&this.prevPlacement){const En=this.prevPlacement.placedOrientations[Ne.crossTileID];En&&(this.placedOrientations[Ne.crossTileID]=En,Hi=En,this.markUsedOrientation(d,Hi,Ne))}return Hi},Wn=(Ri,Hi)=>{if(d.allowVerticalPlacement&&Ne.numVerticalGlyphVertices>0&&qe.verticalTextBox){for(const En of d.writingModes)if(En===c.ah.vertical?(Qt=Hi(),mn=Qt):Qt=Ri(),Qt&&Qt.placeable)break}else Qt=Ri()},ds=Ne.textAnchorOffsetStartIndex,hr=Ne.textAnchorOffsetEndIndex;if(hr===ds){const Ri=(Hi,En)=>{const It=this.collisionIndex.placeCollisionBox(Hi,K,N,k,I,Le,Ie,b,ie.predicate,Qe);return It&&It.placeable&&(this.markUsedOrientation(d,En,Ne),this.placedOrientations[Ne.crossTileID]=En),It};Wn(()=>Ri(Ia,c.ah.horizontal),()=>{const Hi=qe.verticalTextBox;return d.allowVerticalPlacement&&Ne.numVerticalGlyphVertices>0&&Hi?Ri(Hi,c.ah.vertical):{box:null,offscreen:null}}),Zn(Qt&&Qt.placeable)}else{let Ri=c.aq[(xt=(Yt=this.prevPlacement)===null||Yt===void 0?void 0:Yt.variableOffsets[Ne.crossTileID])===null||xt===void 0?void 0:xt.anchor];const Hi=(It,Ns,Aa)=>{const Ma=It.x2-It.x1,Ld=It.y2-It.y1,dm=Ne.textBoxScale,Rd=$e&&de==="never"?Ns:null;let ps=null,Bd=K==="never"?1:2,Nl="never";Ri&&Bd++;for(let Ro=0;Ro<Bd;Ro++){for(let Ul=ds;Ul<hr;Ul++){const $l=d.textAnchorOffsets.get(Ul);if(Ri&&$l.textAnchor!==Ri)continue;const Ea=this.attemptAnchorPlacement($l,It,Ma,Ld,dm,Ie,Le,N,k,I,ie,Nl,Ne,d,Aa,b,T,Rd,Qe);if(Ea&&(ps=Ea.placedGlyphBoxes,ps&&ps.placeable))return kt=!0,ur=Ea.shift,ps}Ri?Ri=null:Nl=K}return h&&!ps&&(ps={box:this.collisionIndex.placeCollisionBox(Ia,"always",N,k,I,Le,Ie,b,ie.predicate,Qe,new c.P(0,0)).box,offscreen:!1,placeable:!1}),ps};Wn(()=>Hi(Ia,qe.iconBox,c.ah.horizontal),()=>{const It=qe.verticalTextBox;return d.allowVerticalPlacement&&(!Qt||!Qt.placeable)&&Ne.numVerticalGlyphVertices>0&&It?Hi(It,qe.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Qt&&(kt=Qt.placeable,$i=Qt.offscreen);const En=Zn(Qt&&Qt.placeable);if(!kt&&this.prevPlacement){const It=this.prevPlacement.variableOffsets[Ne.crossTileID];It&&(this.variableOffsets[Ne.crossTileID]=It,this.markUsedJustification(d,It.anchor,Ne,En))}}}if(en=Qt,kt=en&&en.placeable,$i=en&&en.offscreen,Ne.useRuntimeCollisionCircles){const Zn=d.text.placedSymbolArray.get(Ne.centerJustifiedTextSymbolIndex),Wn=c.ai(d.textSizeData,Q,Zn),ds=f.get("text-padding");Gi=this.collisionIndex.placeCollisionCircles(K,Zn,d.lineVertexArray,d.glyphOffsetArray,Wn,k,I,E,z,h,Le,ie.predicate,Ne.collisionCircleDiameter,ds,b,Qe),Gi.circles.length&&Gi.collisionDetected&&!h&&c.w("Collisions detected, but collision boxes are not shown"),kt=ue||Gi.circles.length>0&&!Gi.collisionDetected,$i=$i&&Gi.offscreen}if(qe.iconFeatureIndex&&(jl=qe.iconFeatureIndex),qe.iconBox){const Zn=Wn=>this.collisionIndex.placeCollisionBox(Wn,de,N,k,I,Le,Ie,T,ie.predicate,Qe,$e&&ur?ur:void 0);mn&&mn.placeable&&qe.verticalIconBox?(tn=Zn(qe.verticalIconBox),Jt=tn.placeable):(tn=Zn(qe.iconBox),Jt=tn.placeable),$i=$i&&tn.offscreen}const qn=ne||Ne.numHorizontalGlyphVertices===0&&Ne.numVerticalGlyphVertices===0,Vl=ae||Ne.numIconVertices===0;qn||Vl?Vl?qn||(Jt=Jt&&kt):kt=Jt&&kt:Jt=kt=Jt&&kt;const Eu=Jt&&tn.placeable;if(kt&&en.placeable&&this.collisionIndex.insertCollisionBox(en.box,K,f.get("text-ignore-placement"),d.bucketInstanceId,mn&&mn.placeable&&Pa?Pa:Mr,ie.ID),Eu&&this.collisionIndex.insertCollisionBox(tn.box,de,f.get("icon-ignore-placement"),d.bucketInstanceId,jl,ie.ID),Gi&&kt&&this.collisionIndex.insertCollisionCircles(Gi.circles,K,f.get("text-ignore-placement"),d.bucketInstanceId,Mr,ie.ID),h&&this.storeCollisionData(d.bucketInstanceId,mt,qe,en,tn,Gi),Ne.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ne.crossTileID]=new bt(kt||je,Jt||Oe,$i||d.justReloaded),a[Ne.crossTileID]=!0};if(We){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ne=d.getSortedSymbolIndexes(this.transform.angle);for(let qe=Ne.length-1;qe>=0;--qe){const mt=Ne[qe];yt(d.symbolInstances.get(mt),d.collisionArrays[mt],mt)}}else for(let Ne=t.symbolInstanceStart;Ne<t.symbolInstanceEnd;Ne++)yt(d.symbolInstances.get(Ne),d.collisionArrays[Ne],Ne);if(h&&d.bucketInstanceId in this.collisionCircleArrays){const Ne=this.collisionCircleArrays[d.bucketInstanceId];c.as(Ne.invProjMatrix,k),Ne.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}storeCollisionData(t,a,h,d,f,b){if(h.textBox||h.iconBox){let T,k;this.collisionBoxArrays.has(t)?T=this.collisionBoxArrays.get(t):(T=new Map,this.collisionBoxArrays.set(t,T)),T.has(a)?k=T.get(a):(k={text:null,icon:null},T.set(a,k)),h.textBox&&(k.text=d.box),h.iconBox&&(k.icon=f.box)}if(b){let T=this.collisionCircleArrays[t];T===void 0&&(T=this.collisionCircleArrays[t]=new Vt);for(let k=0;k<b.circles.length;k+=4)T.circles.push(b.circles[k+0]),T.circles.push(b.circles[k+1]),T.circles.push(b.circles[k+2]),T.circles.push(b.collisionDetected?1:0)}}markUsedJustification(t,a,h,d){let f;f=d===c.ah.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[c.at(a)];const b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const T of b)T>=0&&(t.text.placedSymbolArray.get(T).crossTileID=f>=0&&T!==f?0:h.crossTileID)}markUsedOrientation(t,a,h){const d=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,f=a===c.ah.vertical?a:0,b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const T of b)t.text.placedSymbolArray.get(T).placedOrientation=d;h.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=f)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let h=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(t):1,f=a?a.opacities:{},b=a?a.variableOffsets:{},T=a?a.placedOrientations:{};for(const k in this.placements){const I=this.placements[k],E=f[k];E?(this.opacities[k]=new ri(E,d,I.text,I.icon),h=h||I.text!==E.text.placed||I.icon!==E.icon.placed):(this.opacities[k]=new ri(null,d,I.text,I.icon,I.skipFade),h=h||I.text||I.icon)}for(const k in f){const I=f[k];if(!this.opacities[k]){const E=new ri(I,d,!1,!1);E.isHidden()||(this.opacities[k]=E,h=h||I.text.placed||I.icon.placed)}}for(const k in b)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=b[k]);for(const k in T)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=T[k]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const h={};for(const d of a){const f=d.getBucket(t);f&&d.latestFeatureIndex&&t.id===f.layerIds[0]&&this.updateBucketOpacities(f,d.tileID,h,d.collisionBoxArray)}}updateBucketOpacities(t,a,h,d){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const f=t.layers[0],b=f.layout,T=new ri(null,0,!1,!1,!0),k=b.get("text-allow-overlap"),I=b.get("icon-allow-overlap"),E=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),z=b.get("text-rotation-alignment")==="map",N=b.get("text-pitch-alignment")==="map",H=b.get("icon-text-fit")!=="none",q=new ri(null,0,k&&(I||!t.hasIconData()||b.get("icon-optional")),I&&(k||!t.hasTextData()||b.get("text-optional")),!0);!t.collisionArrays&&d&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(d);const Q=(ne,ae,K)=>{for(let ue=0;ue<ae/4;ue++)ne.opacityVertexArray.emplaceBack(K);ne.hasVisibleVertices=ne.hasVisibleVertices||K!==oa},ie=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ne=0;ne<t.symbolInstances.length;ne++){const ae=t.symbolInstances.get(ne),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:ue,crossTileID:de}=ae;let ye=this.opacities[de];h[de]?ye=T:ye||(ye=q,this.opacities[de]=ye),h[de]=!0;const Ie=ae.numIconVertices>0,Le=this.placedOrientations[ae.crossTileID],$e=Le===c.ah.vertical,We=Le===c.ah.horizontal||Le===c.ah.horizontalOnly;if(K>0||ue>0){const Oe=In(ye.text);Q(t.text,K,$e?oa:Oe),Q(t.text,ue,We?oa:Oe);const Qe=ye.text.isHidden();[ae.rightJustifiedTextSymbolIndex,ae.centerJustifiedTextSymbolIndex,ae.leftJustifiedTextSymbolIndex].forEach(qe=>{qe>=0&&(t.text.placedSymbolArray.get(qe).hidden=Qe||$e?1:0)}),ae.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(ae.verticalPlacedTextSymbolIndex).hidden=Qe||We?1:0);const yt=this.variableOffsets[ae.crossTileID];yt&&this.markUsedJustification(t,yt.anchor,ae,Le);const Ne=this.placedOrientations[ae.crossTileID];Ne&&(this.markUsedJustification(t,"left",ae,Ne),this.markUsedOrientation(t,Ne,ae))}if(Ie){const Oe=In(ye.icon),Qe=!(H&&ae.verticalPlacedIconSymbolIndex&&$e);ae.placedIconSymbolIndex>=0&&(Q(t.icon,ae.numIconVertices,Qe?Oe:oa),t.icon.placedSymbolArray.get(ae.placedIconSymbolIndex).hidden=ye.icon.isHidden()),ae.verticalPlacedIconSymbolIndex>=0&&(Q(t.icon,ae.numVerticalIconVertices,Qe?oa:Oe),t.icon.placedSymbolArray.get(ae.verticalPlacedIconSymbolIndex).hidden=ye.icon.isHidden())}const je=ie&&ie.has(ne)?ie.get(ne):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Oe=t.collisionArrays[ne];if(Oe){let Qe=new c.P(0,0);if(Oe.textBox||Oe.verticalTextBox){let yt=!0;if(E){const Ne=this.variableOffsets[de];Ne?(Qe=Li(Ne.anchor,Ne.width,Ne.height,Ne.textOffset,Ne.textBoxScale),z&&Qe._rotate(N?this.transform.angle:-this.transform.angle)):yt=!1}if(Oe.textBox||Oe.verticalTextBox){let Ne;Oe.textBox&&(Ne=$e),Oe.verticalTextBox&&(Ne=We),aa(t.textCollisionBox.collisionVertexArray,ye.text.placed,!yt||Ne,je.text,Qe.x,Qe.y)}}if(Oe.iconBox||Oe.verticalIconBox){const yt=!!(!We&&Oe.verticalIconBox);let Ne;Oe.iconBox&&(Ne=yt),Oe.verticalIconBox&&(Ne=!yt),aa(t.iconCollisionBox.collisionVertexArray,ye.icon.placed,Ne,je.icon,H?Qe.x:0,H?Qe.y:0)}}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const ne=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ne.invProjMatrix,t.placementViewportMatrix=ne.viewportMatrix,t.collisionCircleArray=ne.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const h=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*h>t}setStale(){this.stale=!0}}function aa(m,t,a,h,d,f){h&&h.length!==0||(h=[0,0,0,0]);const b=h[0]-vt,T=h[1]-vt,k=h[2]-vt,I=h[3]-vt;m.emplaceBack(t?1:0,a?1:0,d||0,f||0,b,T),m.emplaceBack(t?1:0,a?1:0,d||0,f||0,k,T),m.emplaceBack(t?1:0,a?1:0,d||0,f||0,k,I),m.emplaceBack(t?1:0,a?1:0,d||0,f||0,b,I)}const Nt=Math.pow(2,25),Uc=Math.pow(2,24),$c=Math.pow(2,17),Cn=Math.pow(2,16),Pn=Math.pow(2,9),Vf=Math.pow(2,8),Un=Math.pow(2,1);function In(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const t=m.placed?1:0,a=Math.floor(127*m.opacity);return a*Nt+t*Uc+a*$c+t*Cn+a*Pn+t*Vf+a*Un+t}const oa=0;function As(){return{isOccluded:(m,t,a)=>!1,getPitchedTextCorrection:(m,t,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(m,t,a,h){throw new Error("Not implemented.")},translatePosition:(m,t,a,h)=>function(d,f,b,T,k=!1){if(!b[0]&&!b[1])return[0,0];const I=k?T==="map"?d.angle:0:T==="viewport"?-d.angle:0;if(I){const E=Math.sin(I),z=Math.cos(I);b=[b[0]*z-b[1]*E,b[0]*E+b[1]*z]}return[k?b[0]:Tt(f,b[0],d.zoom),k?b[1]:Tt(f,b[1],d.zoom)]}(m,t,a,h),getCircleRadiusCorrection:m=>1}}class wi{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,h,d,f){const b=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(b,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((T,k)=>T.sortKey-k.sortKey));this._currentPartIndex<b.length;)if(a.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,f())return!0;return!1}}class go{constructor(t,a,h,d,f,b,T,k){this.placement=new Qi(t,As(),a,b,T,k),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=f,this._done=!1}isDone(){return this._done}continuePlacement(t,a,h){const d=L.now(),f=()=>!this._forceFullPlacement&&L.now()-d>2;for(;this._currentPlacementIndex>=0;){const b=a[t[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=T)&&(!b.maxzoom||b.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new wi(b)),this._inProgressLayer.continuePlacement(h[b.source],this.placement,this._showCollisionBoxes,b,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const sr=512/c.X/2;class fi{constructor(t,a,h){this.tileID=t,this.bucketInstanceId=h,this._symbolsByKey={};const d=new Map;for(let f=0;f<a.length;f++){const b=a.get(f),T=b.key,k=d.get(T);k?k.push(b):d.set(T,[b])}for(const[f,b]of d){const T={positions:b.map(k=>({x:Math.floor(k.anchorX*sr),y:Math.floor(k.anchorY*sr)})),crossTileIDs:b.map(k=>k.crossTileID)};if(T.positions.length>128){const k=new c.av(T.positions.length,16,Uint16Array);for(const{x:I,y:E}of T.positions)k.add(I,E);k.finish(),delete T.positions,T.index=k}this._symbolsByKey[f]=T}}getScaledCoordinates(t,a){const{x:h,y:d,z:f}=this.tileID.canonical,{x:b,y:T,z:k}=a.canonical,I=sr/Math.pow(2,k-f),E=(T*c.X+t.anchorY)*I,z=d*c.X*sr;return{x:Math.floor((b*c.X+t.anchorX)*I-h*c.X*sr),y:Math.floor(E-z)}}findMatches(t,a,h){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let f=0;f<t.length;f++){const b=t.get(f);if(b.crossTileID)continue;const T=this._symbolsByKey[b.key];if(!T)continue;const k=this.getScaledCoordinates(b,a);if(T.index){const I=T.index.range(k.x-d,k.y-d,k.x+d,k.y+d).sort();for(const E of I){const z=T.crossTileIDs[E];if(!h[z]){h[z]=!0,b.crossTileID=z;break}}}else if(T.positions)for(let I=0;I<T.positions.length;I++){const E=T.positions[I],z=T.crossTileIDs[I];if(Math.abs(E.x-k.x)<=d&&Math.abs(E.y-k.y)<=d&&!h[z]){h[z]=!0,b.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class ll{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ar{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const h in this.indexes){const d=this.indexes[h],f={};for(const b in d){const T=d[b];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+a),f[T.tileID.key]=T}this.indexes[h]=f}this.lng=t}addBucket(t,a,h){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let f=0;f<a.symbolInstances.length;f++)a.symbolInstances.get(f).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const f in this.indexes){const b=this.indexes[f];if(Number(f)>t.overscaledZ)for(const T in b){const k=b[T];k.tileID.isChildOf(t)&&k.findMatches(a.symbolInstances,t,d)}else{const T=b[t.scaledTo(Number(f)).key];T&&T.findMatches(a.symbolInstances,t,d)}}for(let f=0;f<a.symbolInstances.length;f++){const b=a.symbolInstances.get(f);b.crossTileID||(b.crossTileID=h.generate(),d[b.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new fi(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const h of a.getCrossTileIDsLists())for(const d of h)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let a=!1;for(const h in this.indexes){const d=this.indexes[h];for(const f in d)t[d[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,d[f]),delete d[f],a=!0)}return a}}class Gc{constructor(){this.layerIndexes={},this.crossTileIDs=new ll,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,h){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new ar);let f=!1;const b={};d.handleWrapJump(h);for(const T of a){const k=T.getBucket(t);k&&t.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(T.tileID,k,this.crossTileIDs)&&(f=!0),b[k.bucketInstanceId]=!0)}return d.removeStaleBuckets(b)&&(f=!0),f}pruneUnusedLayers(t){const a={};t.forEach(h=>{a[h]=!0});for(const h in this.layerIndexes)a[h]||delete this.layerIndexes[h]}}const or=(m,t)=>c.t(m,t&&t.filter(a=>a.identifier!=="source.canvas")),Nf=c.aw();class cl extends c.E{constructor(t,a={}){super(),this._rtlPluginLoaded=()=>{for(const h in this.sourceCaches){const d=this.sourceCaches[h].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[h].reload()}},this.map=t,this.dispatcher=new Ps(Cs(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(h,d)=>this.getGlyphs(h,d)),this.dispatcher.registerMessageHandler("GI",(h,d)=>this.getImages(h,d)),this.imageManager=new Xt,this.imageManager.setEventedParent(this),this.glyphManager=new Bt(t._requestManager,a.localIdeographFontFamily),this.lineAtlas=new ir(256,512),this.crossTileSymbolIndex=new Gc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),Tr().on(Re,this._rtlPluginLoaded),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const f=d.getSource();if(f&&f.vectorLayerIds)for(const b in this._layers){const T=this._layers[b];T.source===f.id&&this._validateLayer(T)}})}loadURL(t,a={},h){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const f=this._loadStyleRequest;c.h(d,this._loadStyleRequest).then(b=>{this._loadStyleRequest=null,this._load(b.data,a,h)}).catch(b=>{this._loadStyleRequest=null,b&&!f.signal.aborted&&this.fire(new c.j(b))})}loadJSON(t,a={},h){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,L.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,h)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Nf,{validate:!1})}_load(t,a,h){var d;const f=a.transformStyle?a.transformStyle(h,t):t;if(!a.validate||!or(this,c.u(f))){this._loaded=!0,this.stylesheet=f;for(const b in f.sources)this.addSource(b,f.sources[b],{validate:!1});f.sprite?this._loadSprite(f.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(f.glyphs),this._createLayers(),this.light=new dt(this.stylesheet.light),this.sky=new jt(this.stylesheet.sky),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const t=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of t){const h=c.aA(a);h.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=h}}_loadSprite(t,a=!1,h=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(f,b,T,k){return c._(this,void 0,void 0,function*(){const I=ot(f),E=T>1?"@2x":"",z={},N={};for(const{id:H,url:q}of I){const Q=b.transformRequest(at(q,E,".json"),"SpriteJSON");z[H]=c.h(Q,k);const ie=b.transformRequest(at(q,E,".png"),"SpriteImage");N[H]=W.getImage(ie,k)}return yield Promise.all([...Object.values(z),...Object.values(N)]),function(H,q){return c._(this,void 0,void 0,function*(){const Q={};for(const ie in H){Q[ie]={};const ne=L.getImageCanvasContext((yield q[ie]).data),ae=(yield H[ie]).data;for(const K in ae){const{width:ue,height:de,x:ye,y:Ie,sdf:Le,pixelRatio:$e,stretchX:We,stretchY:je,content:Oe,textFitWidth:Qe,textFitHeight:yt}=ae[K];Q[ie][K]={data:null,pixelRatio:$e,sdf:Le,stretchX:We,stretchY:je,content:Oe,textFitWidth:Qe,textFitHeight:yt,spriteData:{width:ue,height:de,x:ye,y:Ie,context:ne}}}}return Q})}(z,N)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(f=>{if(this._spriteRequest=null,f)for(const b in f){this._spritesImagesIds[b]=[];const T=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(k=>!(k in f)):[];for(const k of T)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in f[b]){const I=b==="default"?k:`${b}:${k}`;this._spritesImagesIds[b].push(I),I in this.imageManager.images?this.imageManager.updateImage(I,f[b][k],!1):this.imageManager.addImage(I,f[b][k]),a&&(this._changedImages[I]=!0)}}}).catch(f=>{this._spriteRequest=null,d=f,this.fire(new c.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),h&&h(d)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(t){const a=this.sourceCaches[t.source];if(!a)return;const h=t.sourceLayer;if(!h)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(h)===-1)&&this.fire(new c.j(new Error(`Source layer "${h}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const h=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?c.aB(h):h);const d=[];for(const f of t)if(h[f]){const b=a?c.aB(h[f]):h[f];d.push(b)}return d}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const h of a){const d=this._layers[h];d.type!=="custom"&&(t[h]=d.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const d=Object.keys(this._updatedLayers),f=Object.keys(this._removedLayers);(d.length||f.length)&&this._updateWorkerLayers(d,f);for(const b in this._updatedSources){const T=this._updatedSources[b];if(T==="reload")this._reloadSource(b);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const h={};for(const d in this.sourceCaches){const f=this.sourceCaches[d];h[d]=f.used,f.used=!1}for(const d of this._order){const f=this._layers[d];f.recalculate(t,this._availableImages),!f.isHidden(t.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}for(const d in h){const f=this.sourceCaches[d];!!h[d]!=!!f.used&&f.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.sky.recalculate(t),this.z=t.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var h;this._checkLoaded();const d=this.serialize();if(t=a.transformStyle?a.transformStyle(d,t):t,((h=a.validate)===null||h===void 0||h)&&or(this,c.u(t)))return!1;(t=c.aB(t)).layers=c.az(t.layers);const f=c.aC(d,t),b=this._getOperationsToPerform(f);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const T of b.operations)T();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const a=[],h=[];for(const d of t)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":a.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":a.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,d.args));break;case"setSky":a.push(()=>this.setSky.apply(this,d.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setTransition":a.push(()=>{});break;default:h.push(d.command)}return{operations:a,unimplemented:h}}addImage(t,a){if(this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,h={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.u.source,`sources.${t}`,a,null,h))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.sourceCaches[t]=new ft(t,a,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t})),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===t)return this.fire(new c.j(new Error(`Source "${t}" cannot be removed while layer "${h}" is using it.`)));const a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const h=this.sourceCaches[t].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(a),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,a,h={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new c.j(new Error(`Layer "${d}" already exists on this map.`)));let f;if(t.type==="custom"){if(or(this,c.aD(t)))return;f=c.aA(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=c.aB(t),t=c.e(t,{source:d})),this._validate(c.u.layer,`layers.${d}`,t,{arrayIndex:-1},h))return;f=c.aA(t),this._validateLayer(f),f.setEventedParent(this,{layer:{id:d}})}const b=a?this._order.indexOf(a):this._order.length;if(a&&b===-1)this.fire(new c.j(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(b,0,d),this._layerOrderChanged=!0,this._layers[d]=f,this._removedLayers[d]&&f.source&&f.type!=="custom"){const T=this._removedLayers[d];delete this._removedLayers[d],T.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const h=this._order.indexOf(t);this._order.splice(h,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new c.j(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const h=this._order.indexOf(t);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,h){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===a&&d.maxzoom===h||(a!=null&&(d.minzoom=a),h!=null&&(d.maxzoom=h),this._updateLayer(d)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,h={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!c.aE(d.filter,a))return a==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(c.u.filter,`layers.${d.id}.filter`,a,null,h)||(d.filter=c.aB(a),this._updateLayer(d)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.aB(this.getLayer(t).filter)}setLayoutProperty(t,a,h,d={}){this._checkLoaded();const f=this.getLayer(t);f?c.aE(f.getLayoutProperty(a),h)||(f.setLayoutProperty(a,h,d),this._updateLayer(f)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const h=this.getLayer(t);if(h)return h.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,h,d={}){this._checkLoaded();const f=this.getLayer(t);f?c.aE(f.getPaintProperty(a),h)||(f.setPaintProperty(a,h,d)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const h=t.source,d=t.sourceLayer,f=this.sourceCaches[h];if(f===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const b=f.getSource().type;b==="geojson"&&d?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||d?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),f.setFeatureState(d,t.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const h=t.source,d=this.sourceCaches[h];if(d===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const f=d.getSource().type,b=f==="vector"?t.sourceLayer:void 0;f!=="vector"||b?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(b,t.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,h=t.sourceLayer,d=this.sourceCaches[a];if(d!==void 0)return d.getSource().type!=="vector"||h?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(h,t.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.aF(this.sourceCaches,f=>f.serialize()),a=this._serializeByIds(this._order,!0),h=this.map.getTerrain()||void 0,d=this.stylesheet;return c.aG({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:t,layers:a,terrain:h},f=>f!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=b=>this._layers[b].type==="fill-extrusion",h={},d=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(a(T)){h[T]=b;for(const k of t){const I=k[T];if(I)for(const E of I)d.push(E)}}}d.sort((b,T)=>T.intersectionZ-b.intersectionZ);const f=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(a(T))for(let k=d.length-1;k>=0;k--){const I=d[k].feature;if(h[I.layer.id]<b)break;f.push(I),d.pop()}else for(const k of t){const I=k[T];if(I)for(const E of I)f.push(E.feature)}}return f}queryRenderedFeatures(t,a,h){a&&a.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const T of a.layers){const k=this._layers[T];if(!k)return this.fire(new c.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];d[k.source]=!0}}const f=[];a.availableImages=this._availableImages;const b=this._serializedAllLayers();for(const T in this.sourceCaches)a.layers&&!d[T]||f.push(ss(this.sourceCaches[T],this._layers,b,t,a,h));return this.placement&&f.push(function(T,k,I,E,z,N,H){const q={},Q=N.queryRenderedSymbols(E),ie=[];for(const ne of Object.keys(Q).map(Number))ie.push(H[ne]);ie.sort(as);for(const ne of ie){const ae=ne.featureIndex.lookupSymbolFeatures(Q[ne.bucketInstanceId],k,ne.bucketIndex,ne.sourceLayerIndex,z.filter,z.layers,z.availableImages,T);for(const K in ae){const ue=q[K]=q[K]||[],de=ae[K];de.sort((ye,Ie)=>{const Le=ne.featureSortOrder;if(Le){const $e=Le.indexOf(ye.featureIndex);return Le.indexOf(Ie.featureIndex)-$e}return Ie.featureIndex-ye.featureIndex});for(const ye of de)ue.push(ye)}}for(const ne in q)q[ne].forEach(ae=>{const K=ae.feature,ue=I[T[ne].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=ue});return q}(this._layers,b,this.sourceCaches,t,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)}querySourceFeatures(t,a){a&&a.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",a.filter,null,a);const h=this.sourceCaches[t];return h?function(d,f){const b=d.getRenderableIds().map(I=>d.getTileByID(I)),T=[],k={};for(let I=0;I<b.length;I++){const E=b[I],z=E.tileID.canonical.key;k[z]||(k[z]=!0,E.querySourceFeatures(T,f))}return T}(h,a):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const h=this.light.getLight();let d=!1;for(const b in t)if(!c.aE(t[b],h[b])){d=!0;break}if(!d)return;const f={now:L.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(f)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){const h=this.getSky();let d=!1;if(!t&&!h)return;if(t&&!h)d=!0;else if(!t&&h)d=!0;else for(const b in t)if(!c.aE(t[b],h[b])){d=!0;break}if(!d)return;const f={now:L.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(f)}_validate(t,a,h,d,f={}){return(!f||f.validate!==!1)&&or(this,t.call(c.u,c.e({key:a,style:this.serialize(),value:h,styleSpec:c.v},d)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Tr().off(Re,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const h=this.sourceCaches[a];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const a in this.sourceCaches)this.sourceCaches[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,a,h,d,f=!1){let b=!1,T=!1;const k={};for(const I of this._order){const E=this._layers[I];if(E.type!=="symbol")continue;if(!k[E.source]){const N=this.sourceCaches[E.source];k[E.source]=N.getRenderableIds(!0).map(H=>N.getTileByID(H)).sort((H,q)=>q.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(q.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(E,k[E.source],t.center.lng);b=b||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((f=f||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(L.now(),t.zoom))&&(this.pauseablePlacement=new go(t,this.map.terrain,this._order,f,a,h,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(L.now()),T=!0),b&&this.pauseablePlacement.placement.setStale()),T||b)for(const I of this._order){const E=this._layers[I];E.type==="symbol"&&this.placement.updateLayerOpacities(E,k[E.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(L.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,a){return c._(this,void 0,void 0,function*(){const h=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),h})}getGlyphs(t,a){return c._(this,void 0,void 0,function*(){const h=yield this.glyphManager.getGlyphs(a.stacks),d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),h})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(c.u.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,a,h={},d){this._checkLoaded();const f=[{id:t,url:a}],b=[...ot(this.stylesheet.sprite),...f];this._validate(c.u.sprite,"sprite",b,null,h)||(this.stylesheet.sprite=b,this._loadSprite(f,!0,d))}removeSprite(t){this._checkLoaded();const a=ot(this.stylesheet.sprite);if(a.find(h=>h.id===t)){if(this._spritesImagesIds[t])for(const h of this._spritesImagesIds[t])this.imageManager.removeImage(h),this._changedImages[h]=!0;a.splice(a.findIndex(h=>h.id===t),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return ot(this.stylesheet.sprite)}setSprite(t,a={},h){this._checkLoaded(),t&&this._validate(c.u.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,h):(this._unloadSprite(),h&&h(null)))}}var Ms=c.Y([{name:"a_pos",type:"Int16",components:2}]);const us={prelude:Rt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Rt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Rt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Rt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Rt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Rt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Rt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Rt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Rt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Rt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Rt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Rt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Rt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Rt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Rt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Rt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Rt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Rt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Rt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Rt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Rt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Rt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Rt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Rt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Rt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Rt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Rt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Rt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Rt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Rt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Rt(m,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=t.match(/attribute ([\w]+) ([\w]+)/g),d=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),f=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=f?f.concat(d):d,T={};return{fragmentSource:m=m.replace(a,(k,I,E,z,N)=>(T[N]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${N}
varying ${E} ${z} ${N};
#else
uniform ${E} ${z} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${E} ${z} ${N} = u_${N};
#endif
`)),vertexSource:t=t.replace(a,(k,I,E,z,N)=>{const H=z==="float"?"vec2":"vec4",q=N.match(/color/)?"color":H;return T[N]?I==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${E} ${H} a_${N};
varying ${E} ${z} ${N};
#else
uniform ${E} ${z} u_${N};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${E} ${z} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${q}(a_${N}, u_${N}_t);
#else
    ${E} ${z} ${N} = u_${N};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${E} ${H} a_${N};
#else
uniform ${E} ${z} u_${N};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${E} ${z} ${N} = a_${N};
#else
    ${E} ${z} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${E} ${z} ${N} = unpack_mix_${q}(a_${N}, u_${N}_t);
#else
    ${E} ${z} ${N} = u_${N};
#endif
`}),staticAttributes:h,staticUniforms:b}}class Hc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,h,d,f,b,T,k,I){this.context=t;let E=this.boundPaintVertexBuffers.length!==d.length;for(let z=0;!E&&z<d.length;z++)this.boundPaintVertexBuffers[z]!==d[z]&&(E=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==h||E||this.boundIndexBuffer!==f||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==I?this.freshBind(a,h,d,f,b,T,k,I):(t.bindVertexArray.set(this.vao),T&&T.bind(),f&&f.dynamicDraw&&f.bind(),k&&k.bind(),I&&I.bind())}freshBind(t,a,h,d,f,b,T,k){const I=t.numAttributes,E=this.context,z=E.gl;this.vao&&this.destroy(),this.vao=E.createVertexArray(),E.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=d,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=k,a.enableAttributes(z,t);for(const N of h)N.enableAttributes(z,t);b&&b.enableAttributes(z,t),T&&T.enableAttributes(z,t),k&&k.enableAttributes(z,t),a.bind(),a.setVertexAttribPointers(z,t,f);for(const N of h)N.bind(),N.setVertexAttribPointers(z,t,f);b&&(b.bind(),b.setVertexAttribPointers(z,t,f)),d&&d.bind(),T&&(T.bind(),T.setVertexAttribPointers(z,t,f)),k&&(k.bind(),k.setVertexAttribPointers(z,t,f)),E.currentNumAttributes=I}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const qc=(m,t,a,h,d)=>({u_matrix:m,u_texture:0,u_ele_delta:t,u_fog_matrix:a,u_fog_color:h?h.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:h?h.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?h.calculateFogBlendOpacity(d):0,u_horizon_color:h?h.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:h?h.properties.get("horizon-fog-blend"):1});function la(m){const t=[];for(let a=0;a<m.length;a++){if(m[a]===null)continue;const h=m[a].split(" ");t.push(h.pop())}return t}class Zc{constructor(t,a,h,d,f,b){const T=t.gl;this.program=T.createProgram();const k=la(a.staticAttributes),I=h?h.getBinderAttributes():[],E=k.concat(I),z=us.prelude.staticUniforms?la(us.prelude.staticUniforms):[],N=a.staticUniforms?la(a.staticUniforms):[],H=h?h.getBinderUniforms():[],q=z.concat(N).concat(H),Q=[];for(const ye of q)Q.indexOf(ye)<0&&Q.push(ye);const ie=h?h.defines():[];f&&ie.push("#define OVERDRAW_INSPECTOR;"),b&&ie.push("#define TERRAIN3D;");const ne=ie.concat(us.prelude.fragmentSource,a.fragmentSource).join(`
`),ae=ie.concat(us.prelude.vertexSource,a.vertexSource).join(`
`),K=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(K,ne),T.compileShader(K),!T.getShaderParameter(K,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(K)}`);T.attachShader(this.program,K);const ue=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ue,ae),T.compileShader(ue),!T.getShaderParameter(ue,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(ue)}`);T.attachShader(this.program,ue),this.attributes={};const de={};this.numAttributes=E.length;for(let ye=0;ye<this.numAttributes;ye++)E[ye]&&(T.bindAttribLocation(this.program,ye,E[ye]),this.attributes[E[ye]]=ye);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(ue),T.deleteShader(K);for(let ye=0;ye<Q.length;ye++){const Ie=Q[ye];if(Ie&&!de[Ie]){const Le=T.getUniformLocation(this.program,Ie);Le&&(de[Ie]=Le)}}this.fixedUniforms=d(t,de),this.terrainUniforms=((ye,Ie)=>({u_depth:new c.aH(ye,Ie.u_depth),u_terrain:new c.aH(ye,Ie.u_terrain),u_terrain_dim:new c.aI(ye,Ie.u_terrain_dim),u_terrain_matrix:new c.aJ(ye,Ie.u_terrain_matrix),u_terrain_unpack:new c.aK(ye,Ie.u_terrain_unpack),u_terrain_exaggeration:new c.aI(ye,Ie.u_terrain_exaggeration)}))(t,de),this.binderUniforms=h?h.getUniforms(t,de):[]}draw(t,a,h,d,f,b,T,k,I,E,z,N,H,q,Q,ie,ne,ae){const K=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(h),t.setStencilMode(d),t.setColorMode(f),t.setCullFace(b),k){t.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,k.depthTexture),t.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,k.texture);for(const de in this.terrainUniforms)this.terrainUniforms[de].set(k[de])}for(const de in this.fixedUniforms)this.fixedUniforms[de].set(T[de]);Q&&Q.setUniforms(t,this.binderUniforms,H,{zoom:q});let ue=0;switch(a){case K.LINES:ue=2;break;case K.TRIANGLES:ue=3;break;case K.LINE_STRIP:ue=1}for(const de of N.get()){const ye=de.vaos||(de.vaos={});(ye[I]||(ye[I]=new Hc)).bind(t,this,E,Q?Q.getPaintVertexBuffers():[],z,de.vertexOffset,ie,ne,ae),K.drawElements(a,de.primitiveLength*ue,K.UNSIGNED_SHORT,de.primitiveOffset*ue*2)}}}function ul(m,t,a){const h=1/Tt(a,1,t.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),f=a.tileSize*Math.pow(2,t.transform.tileZoom)/d,b=f*(a.tileID.canonical.x+a.tileID.wrap*d),T=f*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[h,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[b>>16,T>>16],u_pixel_coord_lower:[65535&b,65535&T]}}const yo=(m,t,a,h)=>{const d=t.style.light,f=d.properties.get("position"),b=[f.x,f.y,f.z],T=function(){var I=new c.A(9);return c.A!=Float32Array&&(I[1]=0,I[2]=0,I[3]=0,I[5]=0,I[6]=0,I[7]=0),I[0]=1,I[4]=1,I[8]=1,I}();d.properties.get("anchor")==="viewport"&&function(I,E){var z=Math.sin(E),N=Math.cos(E);I[0]=N,I[1]=z,I[2]=0,I[3]=-z,I[4]=N,I[5]=0,I[6]=0,I[7]=0,I[8]=1}(T,-t.transform.angle),function(I,E,z){var N=E[0],H=E[1],q=E[2];I[0]=N*z[0]+H*z[3]+q*z[6],I[1]=N*z[1]+H*z[4]+q*z[7],I[2]=N*z[2]+H*z[5]+q*z[8]}(b,b,T);const k=d.properties.get("color");return{u_matrix:m,u_lightpos:b,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+a,u_opacity:h}},hl=(m,t,a,h,d,f,b)=>c.e(yo(m,t,a,h),ul(f,t,b),{u_height_factor:-Math.pow(2,d.overscaledZ)/b.tileSize/8}),ca=m=>({u_matrix:m}),td=(m,t,a,h)=>c.e(ca(m),ul(a,t,h)),Uf=(m,t)=>({u_matrix:m,u_world:t}),id=(m,t,a,h,d)=>c.e(td(m,t,a,h),{u_world:d}),$f=(m,t,a,h)=>{const d=m.transform;let f,b;if(h.paint.get("circle-pitch-alignment")==="map"){const T=Tt(a,1,d.zoom);f=!0,b=[T,T]}else f=!1,b=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(h.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(t.posMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:b}},Es=(m,t,a)=>({u_matrix:m,u_inv_matrix:t,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),_o=(m,t,a=1)=>({u_matrix:m,u_color:t,u_overlay:0,u_overlay_scale:a}),pn=m=>({u_matrix:m}),fn=(m,t,a,h)=>({u_matrix:m,u_extrude_scale:Tt(t,1,a),u_intensity:h}),dl=(m,t,a,h)=>{const d=c.H();c.aP(d,0,m.width,m.height,0,0,1);const f=m.context.gl;return{u_matrix:d,u_world:[f.drawingBufferWidth,f.drawingBufferHeight],u_image:a,u_color_ramp:h,u_opacity:t.paint.get("heatmap-opacity")}};function pl(m,t){const a=Math.pow(2,t.canonical.z),h=t.canonical.y;return[new c.Z(0,h/a).toLngLat().lat,new c.Z(0,(h+1)/a).toLngLat().lat]}const fl=(m,t,a,h)=>{const d=m.transform;return{u_matrix:sd(m,t,a,h),u_ratio:1/Tt(t,1,d.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},nd=(m,t,a,h,d)=>c.e(fl(m,t,a,d),{u_image:0,u_image_height:h}),ua=(m,t,a,h,d)=>{const f=m.transform,b=rd(t,f);return{u_matrix:sd(m,t,a,d),u_texsize:t.imageAtlasTexture.size,u_ratio:1/Tt(t,1,f.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[b,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Gf=(m,t,a,h,d,f)=>{const b=m.lineAtlas,T=rd(t,m.transform),k=a.layout.get("line-cap")==="round",I=b.getDash(h.from,k),E=b.getDash(h.to,k),z=I.width*d.fromScale,N=E.width*d.toScale;return c.e(fl(m,t,a,f),{u_patternscale_a:[T/z,-I.height/2],u_patternscale_b:[T/N,-E.height/2],u_sdfgamma:b.width/(256*Math.min(z,N)*m.pixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:E.y,u_mix:d.t})};function rd(m,t){return 1/Tt(m,1,t.tileZoom)}function sd(m,t,a,h){return m.translatePosMatrix(h?h.posMatrix:t.tileID.posMatrix,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Hf=(m,t,a,h,d)=>{return{u_matrix:m,u_tl_parent:t,u_scale_parent:a,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(b=d.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(f=d.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:qf(d.paint.get("raster-hue-rotate"))};var f,b};function qf(m){m*=Math.PI/180;const t=Math.sin(m),a=Math.cos(m);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const ad=(m,t,a,h,d,f,b,T,k,I,E,z,N,H)=>{const q=b.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:q.width/q.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:k,u_coord_matrix:I,u_is_text:+z,u_pitch_with_map:+h,u_is_along_line:d,u_is_variable_anchor:f,u_texsize:N,u_texture:0,u_translation:E,u_pitched_scale:H}},vo=(m,t,a,h,d,f,b,T,k,I,E,z,N,H,q)=>{const Q=b.transform;return c.e(ad(m,t,a,h,d,f,b,T,k,I,E,z,N,q),{u_gamma_scale:h?Math.cos(Q._pitch)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},Wc=(m,t,a,h,d,f,b,T,k,I,E,z,N,H)=>c.e(vo(m,t,a,h,d,f,b,T,k,I,E,!0,z,!0,H),{u_texsize_icon:N,u_texture_icon:1}),ml=(m,t,a)=>({u_matrix:m,u_opacity:t,u_color:a}),Xc=(m,t,a,h,d,f)=>c.e(function(b,T,k,I){const E=k.imageManager.getPattern(b.from.toString()),z=k.imageManager.getPattern(b.to.toString()),{width:N,height:H}=k.imageManager.getPixelSize(),q=Math.pow(2,I.tileID.overscaledZ),Q=I.tileSize*Math.pow(2,k.transform.tileZoom)/q,ie=Q*(I.tileID.canonical.x+I.tileID.wrap*q),ne=Q*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:E.tl,u_pattern_br_a:E.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[N,H],u_mix:T.t,u_pattern_size_a:E.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/Tt(I,1,k.transform.tileZoom),u_pixel_coord_upper:[ie>>16,ne>>16],u_pixel_coord_lower:[65535&ie,65535&ne]}}(h,f,a,d),{u_matrix:m,u_opacity:t}),Kc={fillExtrusion:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_lightpos:new c.aN(m,t.u_lightpos),u_lightintensity:new c.aI(m,t.u_lightintensity),u_lightcolor:new c.aN(m,t.u_lightcolor),u_vertical_gradient:new c.aI(m,t.u_vertical_gradient),u_opacity:new c.aI(m,t.u_opacity)}),fillExtrusionPattern:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_lightpos:new c.aN(m,t.u_lightpos),u_lightintensity:new c.aI(m,t.u_lightintensity),u_lightcolor:new c.aN(m,t.u_lightcolor),u_vertical_gradient:new c.aI(m,t.u_vertical_gradient),u_height_factor:new c.aI(m,t.u_height_factor),u_image:new c.aH(m,t.u_image),u_texsize:new c.aO(m,t.u_texsize),u_pixel_coord_upper:new c.aO(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,t.u_pixel_coord_lower),u_scale:new c.aN(m,t.u_scale),u_fade:new c.aI(m,t.u_fade),u_opacity:new c.aI(m,t.u_opacity)}),fill:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix)}),fillPattern:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_image:new c.aH(m,t.u_image),u_texsize:new c.aO(m,t.u_texsize),u_pixel_coord_upper:new c.aO(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,t.u_pixel_coord_lower),u_scale:new c.aN(m,t.u_scale),u_fade:new c.aI(m,t.u_fade)}),fillOutline:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_world:new c.aO(m,t.u_world)}),fillOutlinePattern:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_world:new c.aO(m,t.u_world),u_image:new c.aH(m,t.u_image),u_texsize:new c.aO(m,t.u_texsize),u_pixel_coord_upper:new c.aO(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,t.u_pixel_coord_lower),u_scale:new c.aN(m,t.u_scale),u_fade:new c.aI(m,t.u_fade)}),circle:(m,t)=>({u_camera_to_center_distance:new c.aI(m,t.u_camera_to_center_distance),u_scale_with_map:new c.aH(m,t.u_scale_with_map),u_pitch_with_map:new c.aH(m,t.u_pitch_with_map),u_extrude_scale:new c.aO(m,t.u_extrude_scale),u_device_pixel_ratio:new c.aI(m,t.u_device_pixel_ratio),u_matrix:new c.aJ(m,t.u_matrix)}),collisionBox:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_pixel_extrude_scale:new c.aO(m,t.u_pixel_extrude_scale)}),collisionCircle:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_inv_matrix:new c.aJ(m,t.u_inv_matrix),u_camera_to_center_distance:new c.aI(m,t.u_camera_to_center_distance),u_viewport_size:new c.aO(m,t.u_viewport_size)}),debug:(m,t)=>({u_color:new c.aL(m,t.u_color),u_matrix:new c.aJ(m,t.u_matrix),u_overlay:new c.aH(m,t.u_overlay),u_overlay_scale:new c.aI(m,t.u_overlay_scale)}),clippingMask:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix)}),heatmap:(m,t)=>({u_extrude_scale:new c.aI(m,t.u_extrude_scale),u_intensity:new c.aI(m,t.u_intensity),u_matrix:new c.aJ(m,t.u_matrix)}),heatmapTexture:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_world:new c.aO(m,t.u_world),u_image:new c.aH(m,t.u_image),u_color_ramp:new c.aH(m,t.u_color_ramp),u_opacity:new c.aI(m,t.u_opacity)}),hillshade:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_image:new c.aH(m,t.u_image),u_latrange:new c.aO(m,t.u_latrange),u_light:new c.aO(m,t.u_light),u_shadow:new c.aL(m,t.u_shadow),u_highlight:new c.aL(m,t.u_highlight),u_accent:new c.aL(m,t.u_accent)}),hillshadePrepare:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_image:new c.aH(m,t.u_image),u_dimension:new c.aO(m,t.u_dimension),u_zoom:new c.aI(m,t.u_zoom),u_unpack:new c.aK(m,t.u_unpack)}),line:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_ratio:new c.aI(m,t.u_ratio),u_device_pixel_ratio:new c.aI(m,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(m,t.u_units_to_pixels)}),lineGradient:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_ratio:new c.aI(m,t.u_ratio),u_device_pixel_ratio:new c.aI(m,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(m,t.u_units_to_pixels),u_image:new c.aH(m,t.u_image),u_image_height:new c.aI(m,t.u_image_height)}),linePattern:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_texsize:new c.aO(m,t.u_texsize),u_ratio:new c.aI(m,t.u_ratio),u_device_pixel_ratio:new c.aI(m,t.u_device_pixel_ratio),u_image:new c.aH(m,t.u_image),u_units_to_pixels:new c.aO(m,t.u_units_to_pixels),u_scale:new c.aN(m,t.u_scale),u_fade:new c.aI(m,t.u_fade)}),lineSDF:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_ratio:new c.aI(m,t.u_ratio),u_device_pixel_ratio:new c.aI(m,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(m,t.u_units_to_pixels),u_patternscale_a:new c.aO(m,t.u_patternscale_a),u_patternscale_b:new c.aO(m,t.u_patternscale_b),u_sdfgamma:new c.aI(m,t.u_sdfgamma),u_image:new c.aH(m,t.u_image),u_tex_y_a:new c.aI(m,t.u_tex_y_a),u_tex_y_b:new c.aI(m,t.u_tex_y_b),u_mix:new c.aI(m,t.u_mix)}),raster:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_tl_parent:new c.aO(m,t.u_tl_parent),u_scale_parent:new c.aI(m,t.u_scale_parent),u_buffer_scale:new c.aI(m,t.u_buffer_scale),u_fade_t:new c.aI(m,t.u_fade_t),u_opacity:new c.aI(m,t.u_opacity),u_image0:new c.aH(m,t.u_image0),u_image1:new c.aH(m,t.u_image1),u_brightness_low:new c.aI(m,t.u_brightness_low),u_brightness_high:new c.aI(m,t.u_brightness_high),u_saturation_factor:new c.aI(m,t.u_saturation_factor),u_contrast_factor:new c.aI(m,t.u_contrast_factor),u_spin_weights:new c.aN(m,t.u_spin_weights)}),symbolIcon:(m,t)=>({u_is_size_zoom_constant:new c.aH(m,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(m,t.u_is_size_feature_constant),u_size_t:new c.aI(m,t.u_size_t),u_size:new c.aI(m,t.u_size),u_camera_to_center_distance:new c.aI(m,t.u_camera_to_center_distance),u_pitch:new c.aI(m,t.u_pitch),u_rotate_symbol:new c.aH(m,t.u_rotate_symbol),u_aspect_ratio:new c.aI(m,t.u_aspect_ratio),u_fade_change:new c.aI(m,t.u_fade_change),u_matrix:new c.aJ(m,t.u_matrix),u_label_plane_matrix:new c.aJ(m,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(m,t.u_coord_matrix),u_is_text:new c.aH(m,t.u_is_text),u_pitch_with_map:new c.aH(m,t.u_pitch_with_map),u_is_along_line:new c.aH(m,t.u_is_along_line),u_is_variable_anchor:new c.aH(m,t.u_is_variable_anchor),u_texsize:new c.aO(m,t.u_texsize),u_texture:new c.aH(m,t.u_texture),u_translation:new c.aO(m,t.u_translation),u_pitched_scale:new c.aI(m,t.u_pitched_scale)}),symbolSDF:(m,t)=>({u_is_size_zoom_constant:new c.aH(m,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(m,t.u_is_size_feature_constant),u_size_t:new c.aI(m,t.u_size_t),u_size:new c.aI(m,t.u_size),u_camera_to_center_distance:new c.aI(m,t.u_camera_to_center_distance),u_pitch:new c.aI(m,t.u_pitch),u_rotate_symbol:new c.aH(m,t.u_rotate_symbol),u_aspect_ratio:new c.aI(m,t.u_aspect_ratio),u_fade_change:new c.aI(m,t.u_fade_change),u_matrix:new c.aJ(m,t.u_matrix),u_label_plane_matrix:new c.aJ(m,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(m,t.u_coord_matrix),u_is_text:new c.aH(m,t.u_is_text),u_pitch_with_map:new c.aH(m,t.u_pitch_with_map),u_is_along_line:new c.aH(m,t.u_is_along_line),u_is_variable_anchor:new c.aH(m,t.u_is_variable_anchor),u_texsize:new c.aO(m,t.u_texsize),u_texture:new c.aH(m,t.u_texture),u_gamma_scale:new c.aI(m,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(m,t.u_device_pixel_ratio),u_is_halo:new c.aH(m,t.u_is_halo),u_translation:new c.aO(m,t.u_translation),u_pitched_scale:new c.aI(m,t.u_pitched_scale)}),symbolTextAndIcon:(m,t)=>({u_is_size_zoom_constant:new c.aH(m,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(m,t.u_is_size_feature_constant),u_size_t:new c.aI(m,t.u_size_t),u_size:new c.aI(m,t.u_size),u_camera_to_center_distance:new c.aI(m,t.u_camera_to_center_distance),u_pitch:new c.aI(m,t.u_pitch),u_rotate_symbol:new c.aH(m,t.u_rotate_symbol),u_aspect_ratio:new c.aI(m,t.u_aspect_ratio),u_fade_change:new c.aI(m,t.u_fade_change),u_matrix:new c.aJ(m,t.u_matrix),u_label_plane_matrix:new c.aJ(m,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(m,t.u_coord_matrix),u_is_text:new c.aH(m,t.u_is_text),u_pitch_with_map:new c.aH(m,t.u_pitch_with_map),u_is_along_line:new c.aH(m,t.u_is_along_line),u_is_variable_anchor:new c.aH(m,t.u_is_variable_anchor),u_texsize:new c.aO(m,t.u_texsize),u_texsize_icon:new c.aO(m,t.u_texsize_icon),u_texture:new c.aH(m,t.u_texture),u_texture_icon:new c.aH(m,t.u_texture_icon),u_gamma_scale:new c.aI(m,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(m,t.u_device_pixel_ratio),u_is_halo:new c.aH(m,t.u_is_halo),u_translation:new c.aO(m,t.u_translation),u_pitched_scale:new c.aI(m,t.u_pitched_scale)}),background:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_opacity:new c.aI(m,t.u_opacity),u_color:new c.aL(m,t.u_color)}),backgroundPattern:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_opacity:new c.aI(m,t.u_opacity),u_image:new c.aH(m,t.u_image),u_pattern_tl_a:new c.aO(m,t.u_pattern_tl_a),u_pattern_br_a:new c.aO(m,t.u_pattern_br_a),u_pattern_tl_b:new c.aO(m,t.u_pattern_tl_b),u_pattern_br_b:new c.aO(m,t.u_pattern_br_b),u_texsize:new c.aO(m,t.u_texsize),u_mix:new c.aI(m,t.u_mix),u_pattern_size_a:new c.aO(m,t.u_pattern_size_a),u_pattern_size_b:new c.aO(m,t.u_pattern_size_b),u_scale_a:new c.aI(m,t.u_scale_a),u_scale_b:new c.aI(m,t.u_scale_b),u_pixel_coord_upper:new c.aO(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(m,t.u_tile_units_to_pixels)}),terrain:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_texture:new c.aH(m,t.u_texture),u_ele_delta:new c.aI(m,t.u_ele_delta),u_fog_matrix:new c.aJ(m,t.u_fog_matrix),u_fog_color:new c.aL(m,t.u_fog_color),u_fog_ground_blend:new c.aI(m,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(m,t.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(m,t.u_horizon_color),u_horizon_fog_blend:new c.aI(m,t.u_horizon_fog_blend)}),terrainDepth:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_ele_delta:new c.aI(m,t.u_ele_delta)}),terrainCoords:(m,t)=>({u_matrix:new c.aJ(m,t.u_matrix),u_texture:new c.aH(m,t.u_texture),u_terrain_coords_id:new c.aI(m,t.u_terrain_coords_id),u_ele_delta:new c.aI(m,t.u_ele_delta)}),sky:(m,t)=>({u_sky_color:new c.aL(m,t.u_sky_color),u_horizon_color:new c.aL(m,t.u_horizon_color),u_horizon:new c.aI(m,t.u_horizon),u_sky_horizon_blend:new c.aI(m,t.u_sky_horizon_blend)})};class Pr{constructor(t,a,h){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Zf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yc{constructor(t,a,h,d){this.length=a.length,this.attributes=h,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=t;const f=t.gl;this.buffer=f.createBuffer(),t.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let h=0;h<this.attributes.length;h++){const d=a.attributes[this.attributes[h].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,a,h){for(let d=0;d<this.attributes.length;d++){const f=this.attributes[d],b=a.attributes[f.name];b!==void 0&&t.vertexAttribPointer(b,f.components,t[Zf[f.type]],!1,this.itemSize,f.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const zs=new WeakMap;function hs(m){var t;if(zs.has(m))return zs.get(m);{const a=(t=m.getParameter(m.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return zs.set(m,a),a}}class Ft{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class gl extends Ft{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Wf extends Ft{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class ha extends Ft{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Xf extends Ft{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class od extends Ft{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Kf extends Ft{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class ld extends Ft{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Jc extends Ft{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class cd extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class ud extends Ft{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class hd extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class dd extends Ft{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Ds extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class pd extends Ft{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Yf extends Ft{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class fd extends Ft{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class xo extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class Jf extends Ft{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class yl extends Ft{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Qf extends Ft{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class em extends Ft{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class md extends Ft{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class gd extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class yd extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Qc extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class _d extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class _l extends Ft{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Hr extends Ft{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const h=this.gl;hs(h)?h.bindVertexArray(t):(a=h.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class eu extends Ft{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class tu extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class iu extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class vl extends Ft{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class nu extends vl{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Ls extends vl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ru extends vl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class tm{constructor(t,a,h,d,f){this.context=t,this.width=a,this.height=h;const b=t.gl,T=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new nu(t,T),d)this.depthAttachment=f?new ru(t,T):new Ls(t,T);else if(f)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const h=this.depthAttachment.get();h&&t.deleteRenderbuffer(h)}t.deleteFramebuffer(this.framebuffer)}}class ci{constructor(t,a,h){this.blendFunction=t,this.blendColor=a,this.mask=h}}ci.Replace=[1,0],ci.disabled=new ci(ci.Replace,c.aM.transparent,[!1,!1,!1,!1]),ci.unblended=new ci(ci.Replace,c.aM.transparent,[!0,!0,!0,!0]),ci.alphaBlended=new ci([1,771],c.aM.transparent,[!0,!0,!0,!0]);class im{constructor(t){var a,h;if(this.gl=t,this.clearColor=new gl(this),this.clearDepth=new Wf(this),this.clearStencil=new ha(this),this.colorMask=new Xf(this),this.depthMask=new od(this),this.stencilMask=new Kf(this),this.stencilFunc=new ld(this),this.stencilOp=new Jc(this),this.stencilTest=new cd(this),this.depthRange=new ud(this),this.depthTest=new hd(this),this.depthFunc=new dd(this),this.blend=new Ds(this),this.blendFunc=new pd(this),this.blendColor=new Yf(this),this.blendEquation=new fd(this),this.cullFace=new xo(this),this.cullFaceSide=new Jf(this),this.frontFace=new yl(this),this.program=new Qf(this),this.activeTexture=new em(this),this.viewport=new md(this),this.bindFramebuffer=new gd(this),this.bindRenderbuffer=new yd(this),this.bindTexture=new Qc(this),this.bindVertexBuffer=new _d(this),this.bindElementBuffer=new _l(this),this.bindVertexArray=new Hr(this),this.pixelStoreUnpack=new eu(this),this.pixelStoreUnpackPremultiplyAlpha=new tu(this),this.pixelStoreUnpackFlipY=new iu(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),hs(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(h=t.RGB16F)!==null&&h!==void 0?h:d==null?void 0:d.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new Pr(this,t,a)}createVertexBuffer(t,a,h){return new Yc(this,t,a,h)}createRenderbuffer(t,a,h){const d=this.gl,f=d.createRenderbuffer();return this.bindRenderbuffer.set(f),d.renderbufferStorage(d.RENDERBUFFER,t,a,h),this.bindRenderbuffer.set(null),f}createFramebuffer(t,a,h,d){return new tm(this,t,a,h,d)}clear({color:t,depth:a,stencil:h}){const d=this.gl;let f=0;t&&(f|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(f|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),h!==void 0&&(f|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),d.clear(f)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.aE(t.blendFunction,ci.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return hs(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return hs(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class St{constructor(t,a,h){this.func=t,this.mask=a,this.range=h}}St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);const xl=7680;class qt{constructor(t,a,h,d,f,b){this.test=t,this.ref=a,this.mask=h,this.fail=d,this.depthFail=f,this.pass=b}}qt.disabled=new qt({func:519,mask:0},0,0,xl,xl,xl);class Ut{constructor(t,a,h){this.enable=t,this.mode=a,this.frontFace=h}}let Rs;function wo(m,t,a,h,d){const f=m.context,b=f.gl,T=m.useProgram("collisionBox"),k=[];let I=0,E=0;for(let ne=0;ne<h.length;ne++){const ae=h[ne],K=t.getTile(ae).getBucket(a);if(!K)continue;const ue=d?K.textCollisionBox:K.iconCollisionBox,de=K.collisionCircleArray;if(de.length>0){const ye=c.H();c.aQ(ye,K.placementInvProjMatrix,m.transform.glCoordMatrix),c.aQ(ye,ye,K.placementViewportMatrix),k.push({circleArray:de,circleOffset:E,transform:ae.posMatrix,invTransform:ye,coord:ae}),I+=de.length/4,E=I}ue&&T.draw(f,b.LINES,St.disabled,qt.disabled,m.colorModeForRenderPass(),Ut.disabled,{u_matrix:ae.posMatrix,u_pixel_extrude_scale:[1/(z=m.transform).width,1/z.height]},m.style.map.terrain&&m.style.map.terrain.getTerrainData(ae),a.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,null,m.transform.zoom,null,null,ue.collisionVertexBuffer)}var z;if(!d||!k.length)return;const N=m.useProgram("collisionCircle"),H=new c.aR;H.resize(4*I),H._trim();let q=0;for(const ne of k)for(let ae=0;ae<ne.circleArray.length/4;ae++){const K=4*ae,ue=ne.circleArray[K+0],de=ne.circleArray[K+1],ye=ne.circleArray[K+2],Ie=ne.circleArray[K+3];H.emplace(q++,ue,de,ye,Ie,0),H.emplace(q++,ue,de,ye,Ie,1),H.emplace(q++,ue,de,ye,Ie,2),H.emplace(q++,ue,de,ye,Ie,3)}(!Rs||Rs.length<2*I)&&(Rs=function(ne){const ae=2*ne,K=new c.aT;K.resize(ae),K._trim();for(let ue=0;ue<ae;ue++){const de=6*ue;K.uint16[de+0]=4*ue+0,K.uint16[de+1]=4*ue+1,K.uint16[de+2]=4*ue+2,K.uint16[de+3]=4*ue+2,K.uint16[de+4]=4*ue+3,K.uint16[de+5]=4*ue+0}return K}(I));const Q=f.createIndexBuffer(Rs,!0),ie=f.createVertexBuffer(H,c.aS.members,!0);for(const ne of k){const ae=Es(ne.transform,ne.invTransform,m.transform);N.draw(f,b.TRIANGLES,St.disabled,qt.disabled,m.colorModeForRenderPass(),Ut.disabled,ae,m.style.map.terrain&&m.style.map.terrain.getTerrainData(ne.coord),a.id,ie,Q,c.a0.simpleSegment(0,2*ne.circleOffset,ne.circleArray.length,ne.circleArray.length/2),null,m.transform.zoom,null,null,null)}ie.destroy(),Q.destroy()}Ut.disabled=new Ut(!1,1029,2305),Ut.backCCW=new Ut(!0,1029,2305);const bo=c.an(new Float32Array(16));function su(m,t,a,h,d,f){const{horizontalAlign:b,verticalAlign:T}=c.au(m);return new c.P((-(b-.5)*t/d+h[0])*f,(-(T-.5)*a/d+h[1])*f)}function Bs(m,t,a,h,d,f){const b=t.tileAnchorPoint.add(new c.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let T=h.mult(f);a||(T=T.rotate(-d));const k=b.add(T);return ee(k.x,k.y,t.labelPlaneMatrix,t.getElevation).point}if(a){const T=Te(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(m),k=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return m.add(h.rotate(k))}return m.add(h)}function da(m,t,a,h,d,f,b,T,k,I,E,z,N,H){const q=m.text.placedSymbolArray,Q=m.text.dynamicLayoutVertexArray,ie=m.icon.dynamicLayoutVertexArray,ne={};Q.clear();for(let ae=0;ae<q.length;ae++){const K=q.get(ae),ue=K.hidden||!K.crossTileID||m.allowVerticalPlacement&&!K.placedOrientation?null:h[K.crossTileID];if(ue){const de=new c.P(K.anchorX,K.anchorY),ye={getElevation:H,width:d.width,height:d.height,labelPlaneMatrix:f,pitchWithMap:a,projection:E,tileAnchorPoint:de,translation:z,unwrappedTileID:N},Ie=a?ee(de.x,de.y,b,H):Te(de.x,de.y,ye),Le=O(d.cameraToCenterDistance,Ie.signedDistanceFromCamera);let $e=c.ai(m.textSizeData,k,K)*Le/c.ap;a&&($e*=m.tilePixelRatio/T);const{width:We,height:je,anchor:Oe,textOffset:Qe,textBoxScale:yt}=ue,Ne=su(Oe,We,je,Qe,yt,$e),qe=E.getPitchedTextCorrection(d,de.add(new c.P(z[0],z[1])),N),mt=Bs(Ie.point,ye,t,Ne,d.angle,qe),Yt=m.allowVerticalPlacement&&K.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let xt=0;xt<K.numGlyphs;xt++)c.aj(Q,mt,Yt);I&&K.associatedIconIndex>=0&&(ne[K.associatedIconIndex]={shiftedAnchor:mt,angle:Yt})}else lt(K.numGlyphs,Q)}if(I){ie.clear();const ae=m.icon.placedSymbolArray;for(let K=0;K<ae.length;K++){const ue=ae.get(K);if(ue.hidden)lt(ue.numGlyphs,ie);else{const de=ne[K];if(de)for(let ye=0;ye<ue.numGlyphs;ye++)c.aj(ie,de.shiftedAnchor,de.angle);else lt(ue.numGlyphs,ie)}}m.icon.dynamicLayoutVertexBuffer.updateData(ie)}m.text.dynamicLayoutVertexBuffer.updateData(Q)}function $n(m,t,a){return a.iconsInText&&t?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function au(m,t,a,h,d,f,b,T,k,I,E,z){const N=m.context,H=N.gl,q=m.transform,Q=As(),ie=T==="map",ne=k==="map",ae=T!=="viewport"&&a.layout.get("symbol-placement")!=="point",K=ie&&!ne&&!ae,ue=!ne&&ae,de=!a.layout.get("symbol-sort-key").isConstant();let ye=!1;const Ie=m.depthModeForSublayer(0,St.ReadOnly),Le=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$e=[],We=Q.getCircleRadiusCorrection(q);for(const je of h){const Oe=t.getTile(je),Qe=Oe.getBucket(a);if(!Qe)continue;const yt=d?Qe.text:Qe.icon;if(!yt||!yt.segments.get().length||!yt.hasVisibleVertices)continue;const Ne=yt.programConfigurations.get(a.id),qe=d||Qe.sdfIcons,mt=d?Qe.textSizeData:Qe.iconSizeData,Yt=ne||q.pitch!==0,xt=m.useProgram($n(qe,d,Qe),Ne),kt=c.ag(mt,q.zoom),Jt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(je);let $i,ur,Qt,mn,en=[0,0],Gi=null;if(d)ur=Oe.glyphAtlasTexture,Qt=H.LINEAR,$i=Oe.glyphAtlasTexture.size,Qe.iconsInText&&(en=Oe.imageAtlasTexture.size,Gi=Oe.imageAtlasTexture,mn=Yt||m.options.rotating||m.options.zooming||mt.kind==="composite"||mt.kind==="camera"?H.LINEAR:H.NEAREST);else{const It=a.layout.get("icon-size").constantOr(0)!==1||Qe.iconsNeedLinear;ur=Oe.imageAtlasTexture,Qt=qe||m.options.rotating||m.options.zooming||It||Yt?H.LINEAR:H.NEAREST,$i=Oe.imageAtlasTexture.size}const tn=Tt(Oe,1,m.transform.zoom),Mr=ue?je.posMatrix:bo,Pa=cs(Mr,ne,ie,m.transform,tn),jl=Cr(Mr,ne,ie,m.transform,tn),Ia=Cr(je.posMatrix,ne,ie,m.transform,tn),qn=Q.translatePosition(m.transform,Oe,f,b),Vl=Le&&Qe.hasTextData(),Eu=a.layout.get("icon-text-fit")!=="none"&&Vl&&Qe.hasIconData();if(ae){const It=m.style.map.terrain?(Aa,Ma)=>m.style.map.terrain.getElevation(je,Aa,Ma):null,Ns=a.layout.get("text-rotation-alignment")==="map";G(Qe,je.posMatrix,m,d,Pa,Ia,ne,I,Ns,Q,je.toUnwrapped(),q.width,q.height,qn,It)}const Zn=je.posMatrix,Wn=d&&Le||Eu,ds=ae||Wn?bo:Pa,hr=jl,Ri=qe&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Hi;Hi=qe?Qe.iconsInText?Wc(mt.kind,kt,K,ne,ae,Wn,m,Zn,ds,hr,qn,$i,en,We):vo(mt.kind,kt,K,ne,ae,Wn,m,Zn,ds,hr,qn,d,$i,!0,We):ad(mt.kind,kt,K,ne,ae,Wn,m,Zn,ds,hr,qn,d,$i,We);const En={program:xt,buffers:yt,uniformValues:Hi,atlasTexture:ur,atlasTextureIcon:Gi,atlasInterpolation:Qt,atlasInterpolationIcon:mn,isSDF:qe,hasHalo:Ri};if(de&&Qe.canOverlap){ye=!0;const It=yt.segments.get();for(const Ns of It)$e.push({segments:new c.a0([Ns]),sortKey:Ns.sortKey,state:En,terrainData:Jt})}else $e.push({segments:yt.segments,sortKey:0,state:En,terrainData:Jt})}ye&&$e.sort((je,Oe)=>je.sortKey-Oe.sortKey);for(const je of $e){const Oe=je.state;if(N.activeTexture.set(H.TEXTURE0),Oe.atlasTexture.bind(Oe.atlasInterpolation,H.CLAMP_TO_EDGE),Oe.atlasTextureIcon&&(N.activeTexture.set(H.TEXTURE1),Oe.atlasTextureIcon&&Oe.atlasTextureIcon.bind(Oe.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),Oe.isSDF){const Qe=Oe.uniformValues;Oe.hasHalo&&(Qe.u_is_halo=1,ou(Oe.buffers,je.segments,a,m,Oe.program,Ie,E,z,Qe,je.terrainData)),Qe.u_is_halo=0}ou(Oe.buffers,je.segments,a,m,Oe.program,Ie,E,z,Oe.uniformValues,je.terrainData)}}function ou(m,t,a,h,d,f,b,T,k,I){const E=h.context;d.draw(E,E.gl.TRIANGLES,f,b,T,Ut.disabled,k,I,a.id,m.layoutVertexBuffer,m.indexBuffer,t,a.paint,h.transform.zoom,m.programConfigurations.get(a.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function lu(m,t,a,h){const d=m.context,f=d.gl,b=qt.disabled,T=new ci([f.ONE,f.ONE],c.aM.transparent,[!0,!0,!0,!0]),k=t.getBucket(a);if(!k)return;const I=h.key;let E=a.heatmapFbos.get(I);E||(E=So(d,t.tileSize,t.tileSize),a.heatmapFbos.set(I,E)),d.bindFramebuffer.set(E.framebuffer),d.viewport.set([0,0,t.tileSize,t.tileSize]),d.clear({color:c.aM.transparent});const z=k.programConfigurations.get(a.id),N=m.useProgram("heatmap",z),H=m.style.map.terrain.getTerrainData(h);N.draw(d,f.TRIANGLES,St.disabled,b,T,Ut.disabled,fn(h.posMatrix,t,m.transform.zoom,a.paint.get("heatmap-intensity")),H,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,m.transform.zoom,z)}function Fs(m,t,a){const h=m.context,d=h.gl;h.setColorMode(m.colorModeForRenderPass());const f=To(h,t),b=a.key,T=t.heatmapFbos.get(b);T&&(h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,T.colorAttachment.get()),h.activeTexture.set(d.TEXTURE1),f.bind(d.LINEAR,d.CLAMP_TO_EDGE),m.useProgram("heatmapTexture").draw(h,d.TRIANGLES,St.disabled,qt.disabled,m.colorModeForRenderPass(),Ut.disabled,dl(m,t,0,1),null,t.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments,t.paint,m.transform.zoom),T.destroy(),t.heatmapFbos.delete(b))}function So(m,t,a){var h,d;const f=m.gl,b=f.createTexture();f.bindTexture(f.TEXTURE_2D,b),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);const T=(h=m.HALF_FLOAT)!==null&&h!==void 0?h:f.UNSIGNED_BYTE,k=(d=m.RGBA16F)!==null&&d!==void 0?d:f.RGBA;f.texImage2D(f.TEXTURE_2D,0,k,t,a,0,f.RGBA,T,null);const I=m.createFramebuffer(t,a,!1,!1);return I.colorAttachment.set(b),I}function To(m,t){return t.colorRampTexture||(t.colorRampTexture=new pt(m,t.colorRamp,m.gl.RGBA)),t.colorRampTexture}function pa(m,t,a,h,d){if(!a||!h||!h.imageAtlas)return;const f=h.imageAtlas.patternPositions;let b=f[a.to.toString()],T=f[a.from.toString()];if(!b&&T&&(b=T),!T&&b&&(T=b),!b||!T){const k=d.getPaintProperty(t);b=f[k],T=f[k]}b&&T&&m.setConstantPatternPositions(b,T)}function ko(m,t,a,h,d,f,b){const T=m.context.gl,k="fill-pattern",I=a.paint.get(k),E=I&&I.constantOr(1),z=a.getCrossfadeParameters();let N,H,q,Q,ie;b?(H=E&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=T.LINES):(H=E?"fillPattern":"fill",N=T.TRIANGLES);const ne=I.constantOr(null);for(const ae of h){const K=t.getTile(ae);if(E&&!K.patternsLoaded())continue;const ue=K.getBucket(a);if(!ue)continue;const de=ue.programConfigurations.get(a.id),ye=m.useProgram(H,de),Ie=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ae);E&&(m.context.activeTexture.set(T.TEXTURE0),K.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),de.updatePaintBuffers(z)),pa(de,k,ne,K,a);const Le=Ie?ae:null,$e=m.translatePosMatrix(Le?Le.posMatrix:ae.posMatrix,K,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(b){Q=ue.indexBuffer2,ie=ue.segments2;const We=[T.drawingBufferWidth,T.drawingBufferHeight];q=H==="fillOutlinePattern"&&E?id($e,m,z,K,We):Uf($e,We)}else Q=ue.indexBuffer,ie=ue.segments,q=E?td($e,m,z,K):ca($e);ye.draw(m.context,N,d,m.stencilModeForClipping(ae),f,Ut.disabled,q,Ie,a.id,ue.layoutVertexBuffer,Q,ie,a.paint,m.transform.zoom,de)}}function wl(m,t,a,h,d,f,b){const T=m.context,k=T.gl,I="fill-extrusion-pattern",E=a.paint.get(I),z=E.constantOr(1),N=a.getCrossfadeParameters(),H=a.paint.get("fill-extrusion-opacity"),q=E.constantOr(null);for(const Q of h){const ie=t.getTile(Q),ne=ie.getBucket(a);if(!ne)continue;const ae=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Q),K=ne.programConfigurations.get(a.id),ue=m.useProgram(z?"fillExtrusionPattern":"fillExtrusion",K);z&&(m.context.activeTexture.set(k.TEXTURE0),ie.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),K.updatePaintBuffers(N)),pa(K,I,q,ie,a);const de=m.translatePosMatrix(Q.posMatrix,ie,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),ye=a.paint.get("fill-extrusion-vertical-gradient"),Ie=z?hl(de,m,ye,H,Q,N,ie):yo(de,m,ye,H);ue.draw(T,T.gl.TRIANGLES,d,f,b,Ut.backCCW,Ie,ae,a.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,a.paint,m.transform.zoom,K,m.style.map.terrain&&ne.centroidVertexBuffer)}}function fa(m,t,a,h,d,f,b){const T=m.context,k=T.gl,I=a.fbo;if(!I)return;const E=m.useProgram("hillshade"),z=m.style.map.terrain&&m.style.map.terrain.getTerrainData(t);T.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,I.colorAttachment.get()),E.draw(T,k.TRIANGLES,d,f,b,Ut.disabled,((N,H,q,Q)=>{const ie=q.paint.get("hillshade-shadow-color"),ne=q.paint.get("hillshade-highlight-color"),ae=q.paint.get("hillshade-accent-color");let K=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);q.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=N.transform.angle);const ue=!N.options.moving;return{u_matrix:Q?Q.posMatrix:N.transform.calculatePosMatrix(H.tileID.toUnwrapped(),ue),u_image:0,u_latrange:pl(0,H.tileID),u_light:[q.paint.get("hillshade-exaggeration"),K],u_shadow:ie,u_highlight:ne,u_accent:ae}})(m,a,h,z?t:null),z,h.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function ma(m,t,a,h,d,f){const b=m.context,T=b.gl,k=t.dem;if(k&&k.data){const I=k.dim,E=k.stride,z=k.getPixels();if(b.activeTexture.set(T.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||m.getTileTexture(E),t.demTexture){const H=t.demTexture;H.update(z,{premultiply:!1}),H.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else t.demTexture=new pt(b,z,T.RGBA,{premultiply:!1}),t.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);b.activeTexture.set(T.TEXTURE0);let N=t.fbo;if(!N){const H=new pt(b,{width:I,height:I,data:null},T.RGBA);H.bind(T.LINEAR,T.CLAMP_TO_EDGE),N=t.fbo=b.createFramebuffer(I,I,!0,!1),N.colorAttachment.set(H.texture)}b.bindFramebuffer.set(N.framebuffer),b.viewport.set([0,0,I,I]),m.useProgram("hillshadePrepare").draw(b,T.TRIANGLES,h,d,f,Ut.disabled,((H,q)=>{const Q=q.stride,ie=c.H();return c.aP(ie,0,c.X,-c.X,0,0,1),c.J(ie,ie,[0,-c.X,0]),{u_matrix:ie,u_image:1,u_dimension:[Q,Q],u_zoom:H.overscaledZ,u_unpack:q.getUnpackVector()}})(t.tileID,k),null,a.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function vd(m,t,a,h,d,f){const b=h.paint.get("raster-fade-duration");if(!f&&b>0){const T=L.now(),k=(T-m.timeAdded)/b,I=t?(T-t.timeAdded)/b:-1,E=a.getSource(),z=d.coveringZoomLevel({tileSize:E.tileSize,roundZoom:E.roundZoom}),N=!t||Math.abs(t.tileID.overscaledZ-z)>Math.abs(m.tileID.overscaledZ-z),H=N&&m.refreshedUponExpiration?1:c.ac(N?k:1-I,0,1);return m.refreshedUponExpiration&&k>=1&&(m.refreshedUponExpiration=!1),t?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const cu=new c.aM(1,0,0,1),zt=new c.aM(0,1,0,1),bl=new c.aM(0,0,1,1),nm=new c.aM(1,0,1,1),xd=new c.aM(0,1,1,1);function ga(m,t,a,h){Sl(m,0,t+a/2,m.transform.width,a,h)}function wd(m,t,a,h){Sl(m,t-a/2,0,a,m.transform.height,h)}function Sl(m,t,a,h,d,f){const b=m.context,T=b.gl;T.enable(T.SCISSOR_TEST),T.scissor(t*m.pixelRatio,a*m.pixelRatio,h*m.pixelRatio,d*m.pixelRatio),b.clear({color:f}),T.disable(T.SCISSOR_TEST)}function bd(m,t,a){const h=m.context,d=h.gl,f=a.posMatrix,b=m.useProgram("debug"),T=St.disabled,k=qt.disabled,I=m.colorModeForRenderPass(),E="$debug",z=m.style.map.terrain&&m.style.map.terrain.getTerrainData(a);h.activeTexture.set(d.TEXTURE0);const N=t.getTileByID(a.key).latestRawTileData,H=Math.floor((N&&N.byteLength||0)/1024),q=t.getTile(a).tileSize,Q=512/Math.min(q,512)*(a.overscaledZ/m.transform.zoom)*.5;let ie=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ie+=` => ${a.overscaledZ}`),function(ne,ae){ne.initDebugOverlayCanvas();const K=ne.debugOverlayCanvas,ue=ne.context.gl,de=ne.debugOverlayCanvas.getContext("2d");de.clearRect(0,0,K.width,K.height),de.shadowColor="white",de.shadowBlur=2,de.lineWidth=1.5,de.strokeStyle="white",de.textBaseline="top",de.font="bold 36px Open Sans, sans-serif",de.fillText(ae,5,5),de.strokeText(ae,5,5),ne.debugOverlayTexture.update(K),ne.debugOverlayTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE)}(m,`${ie} ${H}kB`),b.draw(h,d.TRIANGLES,T,k,ci.alphaBlended,Ut.disabled,_o(f,c.aM.transparent,Q),null,E,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),b.draw(h,d.LINE_STRIP,T,k,I,Ut.disabled,_o(f,c.aM.red),z,E,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function Sd(m,t,a){const h=m.context,d=h.gl,f=m.colorModeForRenderPass(),b=new St(d.LEQUAL,St.ReadWrite,m.depthRangeFor3D),T=m.useProgram("terrain"),k=t.getTerrainMesh();h.bindFramebuffer.set(null),h.viewport.set([0,0,m.width,m.height]);for(const I of a){const E=m.renderToTexture.getTexture(I),z=t.getTerrainData(I.tileID);h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,E.texture);const N=m.transform.calculatePosMatrix(I.tileID.toUnwrapped()),H=t.getMeshFrameDelta(m.transform.zoom),q=m.transform.calculateFogMatrix(I.tileID.toUnwrapped()),Q=qc(N,H,q,m.style.sky,m.transform.pitch);T.draw(h,d.TRIANGLES,b,qt.disabled,f,Ut.backCCW,Q,z,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class Tl{constructor(t,a,h){this.vertexBuffer=t,this.indexBuffer=a,this.segments=h}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class kl{constructor(t,a){this.context=new im(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ft.maxUnderzooming+ft.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gc}resize(t,a,h){if(this.width=Math.floor(t*h),this.height=Math.floor(a*h),this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,a=new c.aX;a.emplaceBack(0,0),a.emplaceBack(c.X,0),a.emplaceBack(0,c.X),a.emplaceBack(c.X,c.X),this.tileExtentBuffer=t.createVertexBuffer(a,Ms.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const h=new c.aX;h.emplaceBack(0,0),h.emplaceBack(c.X,0),h.emplaceBack(0,c.X),h.emplaceBack(c.X,c.X),this.debugBuffer=t.createVertexBuffer(h,Ms.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const d=new c.$;d.emplaceBack(0,0,0,0),d.emplaceBack(c.X,0,c.X,0),d.emplaceBack(0,c.X,0,c.X),d.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=t.createVertexBuffer(d,os.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const f=new c.aX;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(f,Ms.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const b=new c.aZ;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(b);const T=new c.aY;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(T);const k=this.context.gl;this.stencilClearMode=new qt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=c.H();c.aP(h,0,this.width,this.height,0,0,1),c.K(h,h,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,a.TRIANGLES,St.disabled,this.stencilClearMode,ci.disabled,Ut.disabled,pn(h),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source;const h=this.context,d=h.gl;this.nextStencilID+a.length>256&&this.clearStencil(),h.setColorMode(ci.disabled),h.setDepthMode(St.disabled);const f=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of a){const T=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(b);f.draw(h,d.TRIANGLES,St.disabled,new qt({func:d.ALWAYS,mask:0},T,255,d.KEEP,d.KEEP,d.REPLACE),ci.disabled,Ut.disabled,pn(b.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new qt({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new qt({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,h=t.sort((b,T)=>T.overscaledZ-b.overscaledZ),d=h[h.length-1].overscaledZ,f=h[0].overscaledZ-d+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();const b={};for(let T=0;T<f;T++)b[T+d]=new qt({func:a.GEQUAL,mask:255},T+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=f,[b,h]}return[{[d]:qt.disabled},h]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new ci([t.CONSTANT_COLOR,t.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ci.unblended:ci.alphaBlended}depthModeForSublayer(t,a,h){if(!this.opaquePassEnabledForLayer())return St.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new St(h||this.context.gl.LEQUAL,a,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(L.now()),this.imageManager.beginFrame();const h=this.style._order,d=this.style.sourceCaches,f={},b={},T={};for(const k in d){const I=d[k];I.used&&I.prepare(this.context),f[k]=I.getVisibleCoordinates(),b[k]=f[k].slice().reverse(),T[k]=I.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<h.length;k++)if(this.style._layers[h[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of h){const I=this.style._layers[k];if(!I.hasOffscreenPass()||I.isHidden(this.transform.zoom))continue;const E=b[I.source];(I.type==="custom"||E.length)&&this.renderLayer(this,d[I.source],I,E)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,I){const E=k.context,z=E.gl,N=((ne,ae,K)=>({u_sky_color:ne.properties.get("sky-color"),u_horizon_color:ne.properties.get("horizon-color"),u_horizon:(ae.height/2+ae.getHorizon())*K,u_sky_horizon_blend:ne.properties.get("sky-horizon-blend")*ae.height/2*K}))(I,k.style.map.transform,k.pixelRatio),H=new St(z.LEQUAL,St.ReadWrite,[0,1]),q=qt.disabled,Q=k.colorModeForRenderPass(),ie=k.useProgram("sky");if(!I.mesh){const ne=new c.aX;ne.emplaceBack(-1,-1),ne.emplaceBack(1,-1),ne.emplaceBack(1,1),ne.emplaceBack(-1,1);const ae=new c.aY;ae.emplaceBack(0,1,2),ae.emplaceBack(0,2,3),I.mesh=new Tl(E.createVertexBuffer(ne,Ms.members),E.createIndexBuffer(ae),c.a0.simpleSegment(0,0,ne.length,ae.length))}ie.draw(E,z.TRIANGLES,H,q,Q,Ut.disabled,N,void 0,"sky",I.mesh.vertexBuffer,I.mesh.indexBuffer,I.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[h[this.currentLayer]],I=d[k.source],E=f[k.source];this._renderTileClippingMasks(k,E),this.renderLayer(this,I,k,E)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){const k=this.style._layers[h[this.currentLayer]],I=d[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const E=(k.type==="symbol"?T:b)[k.source];this._renderTileClippingMasks(k,f[k.source]),this.renderLayer(this,I,k,E)}if(this.options.showTileBoundaries){const k=function(I,E){let z=null;const N=Object.values(I._layers).flatMap(ie=>ie.source&&!ie.isHidden(E)?[I.sourceCaches[ie.source]]:[]),H=N.filter(ie=>ie.getSource().type==="vector"),q=N.filter(ie=>ie.getSource().type!=="vector"),Q=ie=>{(!z||z.getSource().maxzoom<ie.getSource().maxzoom)&&(z=ie)};return H.forEach(ie=>Q(ie)),z||q.forEach(ie=>Q(ie)),z}(this.style,this.transform.zoom);k&&function(I,E,z){for(let N=0;N<z.length;N++)bd(I,E,z[N])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const I=k.transform.padding;ga(k,k.transform.height-(I.top||0),3,cu),ga(k,I.bottom||0,3,zt),wd(k,I.left||0,3,bl),wd(k,k.transform.width-(I.right||0),3,nm);const E=k.transform.centerPoint;(function(z,N,H,q){Sl(z,N-1,H-10,2,20,q),Sl(z,N-10,H-1,20,2,q)})(k,E.x,k.transform.height-E.y,xd)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,h=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=t?!c.a_(a,h):!c.a$(a,h)),d||(d=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),d&&(c.b0(a,h),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(f,b){const T=f.context,k=T.gl,I=ci.unblended,E=new St(k.LEQUAL,St.ReadWrite,[0,1]),z=b.getTerrainMesh(),N=b.sourceCache.getRenderableTiles(),H=f.useProgram("terrainDepth");T.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),T.clear({color:c.aM.transparent,depth:1});for(const q of N){const Q=b.getTerrainData(q.tileID),ie={u_matrix:f.transform.calculatePosMatrix(q.tileID.toUnwrapped()),u_ele_delta:b.getMeshFrameDelta(f.transform.zoom)};H.draw(T,k.TRIANGLES,E,qt.disabled,I,Ut.backCCW,ie,Q,"terrain",z.vertexBuffer,z.indexBuffer,z.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,f.width,f.height])}(this,this.style.map.terrain),function(f,b){const T=f.context,k=T.gl,I=ci.unblended,E=new St(k.LEQUAL,St.ReadWrite,[0,1]),z=b.getTerrainMesh(),N=b.getCoordsTexture(),H=b.sourceCache.getRenderableTiles(),q=f.useProgram("terrainCoords");T.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),T.clear({color:c.aM.transparent,depth:1}),b.coordsIndex=[];for(const Q of H){const ie=b.getTerrainData(Q.tileID);T.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,N.texture);const ne={u_matrix:f.transform.calculatePosMatrix(Q.tileID.toUnwrapped()),u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(f.transform.zoom)};q.draw(T,k.TRIANGLES,E,qt.disabled,I,Ut.backCCW,ne,ie,"terrain",z.vertexBuffer,z.indexBuffer,z.segments),b.coordsIndex.push(Q.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,f.width,f.height])}(this,this.style.map.terrain))}renderLayer(t,a,h,d){if(!h.isHidden(this.transform.zoom)&&(h.type==="background"||h.type==="custom"||(d||[]).length))switch(this.id=h.id,h.type){case"symbol":(function(f,b,T,k,I){if(f.renderPass!=="translucent")return;const E=qt.disabled,z=f.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(N,H,q,Q,ie,ne,ae,K,ue){const de=H.transform,ye=As(),Ie=ie==="map",Le=ne==="map";for(const $e of N){const We=Q.getTile($e),je=We.getBucket(q);if(!je||!je.text||!je.text.segments.get().length)continue;const Oe=c.ag(je.textSizeData,de.zoom),Qe=Tt(We,1,H.transform.zoom),yt=cs($e.posMatrix,Le,Ie,H.transform,Qe),Ne=q.layout.get("icon-text-fit")!=="none"&&je.hasIconData();if(Oe){const qe=Math.pow(2,de.zoom-We.tileID.overscaledZ),mt=H.style.map.terrain?(xt,kt)=>H.style.map.terrain.getElevation($e,xt,kt):null,Yt=ye.translatePosition(de,We,ae,K);da(je,Ie,Le,ue,de,yt,$e.posMatrix,qe,Oe,Ne,ye,Yt,$e.toUnwrapped(),mt)}}}(k,f,T,b,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),I),T.paint.get("icon-opacity").constantOr(1)!==0&&au(f,b,T,k,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),E,z),T.paint.get("text-opacity").constantOr(1)!==0&&au(f,b,T,k,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),E,z),b.map.showCollisionBoxes&&(wo(f,b,T,k,!0),wo(f,b,T,k,!1))})(t,a,h,d,this.style.placement.variableOffsets);break;case"circle":(function(f,b,T,k){if(f.renderPass!=="translucent")return;const I=T.paint.get("circle-opacity"),E=T.paint.get("circle-stroke-width"),z=T.paint.get("circle-stroke-opacity"),N=!T.layout.get("circle-sort-key").isConstant();if(I.constantOr(1)===0&&(E.constantOr(1)===0||z.constantOr(1)===0))return;const H=f.context,q=H.gl,Q=f.depthModeForSublayer(0,St.ReadOnly),ie=qt.disabled,ne=f.colorModeForRenderPass(),ae=[];for(let K=0;K<k.length;K++){const ue=k[K],de=b.getTile(ue),ye=de.getBucket(T);if(!ye)continue;const Ie=ye.programConfigurations.get(T.id),Le=f.useProgram("circle",Ie),$e=ye.layoutVertexBuffer,We=ye.indexBuffer,je=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ue),Oe={programConfiguration:Ie,program:Le,layoutVertexBuffer:$e,indexBuffer:We,uniformValues:$f(f,ue,de,T),terrainData:je};if(N){const Qe=ye.segments.get();for(const yt of Qe)ae.push({segments:new c.a0([yt]),sortKey:yt.sortKey,state:Oe})}else ae.push({segments:ye.segments,sortKey:0,state:Oe})}N&&ae.sort((K,ue)=>K.sortKey-ue.sortKey);for(const K of ae){const{programConfiguration:ue,program:de,layoutVertexBuffer:ye,indexBuffer:Ie,uniformValues:Le,terrainData:$e}=K.state;de.draw(H,q.TRIANGLES,Q,ie,ne,Ut.disabled,Le,$e,T.id,ye,Ie,K.segments,T.paint,f.transform.zoom,ue)}})(t,a,h,d);break;case"heatmap":(function(f,b,T,k){if(T.paint.get("heatmap-opacity")===0)return;const I=f.context;if(f.style.map.terrain){for(const E of k){const z=b.getTile(E);b.hasRenderableParent(E)||(f.renderPass==="offscreen"?lu(f,z,T,E):f.renderPass==="translucent"&&Fs(f,T,E))}I.viewport.set([0,0,f.width,f.height])}else f.renderPass==="offscreen"?function(E,z,N,H){const q=E.context,Q=q.gl,ie=qt.disabled,ne=new ci([Q.ONE,Q.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(ae,K,ue){const de=ae.gl;ae.activeTexture.set(de.TEXTURE1),ae.viewport.set([0,0,K.width/4,K.height/4]);let ye=ue.heatmapFbos.get(c.aU);ye?(de.bindTexture(de.TEXTURE_2D,ye.colorAttachment.get()),ae.bindFramebuffer.set(ye.framebuffer)):(ye=So(ae,K.width/4,K.height/4),ue.heatmapFbos.set(c.aU,ye))})(q,E,N),q.clear({color:c.aM.transparent});for(let ae=0;ae<H.length;ae++){const K=H[ae];if(z.hasRenderableParent(K))continue;const ue=z.getTile(K),de=ue.getBucket(N);if(!de)continue;const ye=de.programConfigurations.get(N.id),Ie=E.useProgram("heatmap",ye),{zoom:Le}=E.transform;Ie.draw(q,Q.TRIANGLES,St.disabled,ie,ne,Ut.disabled,fn(K.posMatrix,ue,Le,N.paint.get("heatmap-intensity")),null,N.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,N.paint,E.transform.zoom,ye)}q.viewport.set([0,0,E.width,E.height])}(f,b,T,k):f.renderPass==="translucent"&&function(E,z){const N=E.context,H=N.gl;N.setColorMode(E.colorModeForRenderPass());const q=z.heatmapFbos.get(c.aU);q&&(N.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,q.colorAttachment.get()),N.activeTexture.set(H.TEXTURE1),To(N,z).bind(H.LINEAR,H.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(N,H.TRIANGLES,St.disabled,qt.disabled,E.colorModeForRenderPass(),Ut.disabled,dl(E,z,0,1),null,z.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,z.paint,E.transform.zoom))}(f,T)})(t,a,h,d);break;case"line":(function(f,b,T,k){if(f.renderPass!=="translucent")return;const I=T.paint.get("line-opacity"),E=T.paint.get("line-width");if(I.constantOr(1)===0||E.constantOr(1)===0)return;const z=f.depthModeForSublayer(0,St.ReadOnly),N=f.colorModeForRenderPass(),H=T.paint.get("line-dasharray"),q=T.paint.get("line-pattern"),Q=q.constantOr(1),ie=T.paint.get("line-gradient"),ne=T.getCrossfadeParameters(),ae=Q?"linePattern":H?"lineSDF":ie?"lineGradient":"line",K=f.context,ue=K.gl;let de=!0;for(const ye of k){const Ie=b.getTile(ye);if(Q&&!Ie.patternsLoaded())continue;const Le=Ie.getBucket(T);if(!Le)continue;const $e=Le.programConfigurations.get(T.id),We=f.context.program.get(),je=f.useProgram(ae,$e),Oe=de||je.program!==We,Qe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ye),yt=q.constantOr(null);if(yt&&Ie.imageAtlas){const mt=Ie.imageAtlas,Yt=mt.patternPositions[yt.to.toString()],xt=mt.patternPositions[yt.from.toString()];Yt&&xt&&$e.setConstantPatternPositions(Yt,xt)}const Ne=Qe?ye:null,qe=Q?ua(f,Ie,T,ne,Ne):H?Gf(f,Ie,T,H,ne,Ne):ie?nd(f,Ie,T,Le.lineClipsArray.length,Ne):fl(f,Ie,T,Ne);if(Q)K.activeTexture.set(ue.TEXTURE0),Ie.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),$e.updatePaintBuffers(ne);else if(H&&(Oe||f.lineAtlas.dirty))K.activeTexture.set(ue.TEXTURE0),f.lineAtlas.bind(K);else if(ie){const mt=Le.gradients[T.id];let Yt=mt.texture;if(T.gradientVersion!==mt.version){let xt=256;if(T.stepInterpolant){const kt=b.getSource().maxzoom,Jt=ye.canonical.z===kt?Math.ceil(1<<f.transform.maxZoom-ye.canonical.z):1;xt=c.ac(c.aV(Le.maxLineLength/c.X*1024*Jt),256,K.maxTextureSize)}mt.gradient=c.aW({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:xt,image:mt.gradient||void 0,clips:Le.lineClipsArray}),mt.texture?mt.texture.update(mt.gradient):mt.texture=new pt(K,mt.gradient,ue.RGBA),mt.version=T.gradientVersion,Yt=mt.texture}K.activeTexture.set(ue.TEXTURE0),Yt.bind(T.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}je.draw(K,ue.TRIANGLES,z,f.stencilModeForClipping(ye),N,Ut.disabled,qe,Qe,T.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,T.paint,f.transform.zoom,$e,Le.layoutVertexBuffer2),de=!1}})(t,a,h,d);break;case"fill":(function(f,b,T,k){const I=T.paint.get("fill-color"),E=T.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const z=f.colorModeForRenderPass(),N=T.paint.get("fill-pattern"),H=f.opaquePassEnabledForLayer()&&!N.constantOr(1)&&I.constantOr(c.aM.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===H){const q=f.depthModeForSublayer(1,f.renderPass==="opaque"?St.ReadWrite:St.ReadOnly);ko(f,b,T,k,q,z,!1)}if(f.renderPass==="translucent"&&T.paint.get("fill-antialias")){const q=f.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);ko(f,b,T,k,q,z,!0)}})(t,a,h,d);break;case"fill-extrusion":(function(f,b,T,k){const I=T.paint.get("fill-extrusion-opacity");if(I!==0&&f.renderPass==="translucent"){const E=new St(f.context.gl.LEQUAL,St.ReadWrite,f.depthRangeFor3D);if(I!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))wl(f,b,T,k,E,qt.disabled,ci.disabled),wl(f,b,T,k,E,f.stencilModeFor3D(),f.colorModeForRenderPass());else{const z=f.colorModeForRenderPass();wl(f,b,T,k,E,qt.disabled,z)}}})(t,a,h,d);break;case"hillshade":(function(f,b,T,k){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const I=f.context,E=f.depthModeForSublayer(0,St.ReadOnly),z=f.colorModeForRenderPass(),[N,H]=f.renderPass==="translucent"?f.stencilConfigForOverlap(k):[{},k];for(const q of H){const Q=b.getTile(q);Q.needsHillshadePrepare!==void 0&&Q.needsHillshadePrepare&&f.renderPass==="offscreen"?ma(f,Q,T,E,qt.disabled,z):f.renderPass==="translucent"&&fa(f,q,Q,T,E,N[q.overscaledZ],z)}I.viewport.set([0,0,f.width,f.height])})(t,a,h,d);break;case"raster":(function(f,b,T,k){if(f.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!k.length)return;const I=f.context,E=I.gl,z=b.getSource(),N=f.useProgram("raster"),H=f.colorModeForRenderPass(),[q,Q]=z instanceof $r?[{},k]:f.stencilConfigForOverlap(k),ie=Q[Q.length-1].overscaledZ,ne=!f.options.moving;for(const ae of Q){const K=f.depthModeForSublayer(ae.overscaledZ-ie,T.paint.get("raster-opacity")===1?St.ReadWrite:St.ReadOnly,E.LESS),ue=b.getTile(ae);ue.registerFadeDuration(T.paint.get("raster-fade-duration"));const de=b.findLoadedParent(ae,0),ye=b.findLoadedSibling(ae),Ie=vd(ue,de||ye||null,b,T,f.transform,f.style.map.terrain);let Le,$e;const We=T.paint.get("raster-resampling")==="nearest"?E.NEAREST:E.LINEAR;I.activeTexture.set(E.TEXTURE0),ue.texture.bind(We,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),I.activeTexture.set(E.TEXTURE1),de?(de.texture.bind(We,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),Le=Math.pow(2,de.tileID.overscaledZ-ue.tileID.overscaledZ),$e=[ue.tileID.canonical.x*Le%1,ue.tileID.canonical.y*Le%1]):ue.texture.bind(We,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),ue.texture.useMipmap&&I.extTextureFilterAnisotropic&&f.transform.pitch>20&&E.texParameterf(E.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const je=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ae),Oe=je?ae:null,Qe=Oe?Oe.posMatrix:f.transform.calculatePosMatrix(ae.toUnwrapped(),ne),yt=Hf(Qe,$e||[0,0],Le||1,Ie,T);z instanceof $r?N.draw(I,E.TRIANGLES,K,qt.disabled,H,Ut.disabled,yt,je,T.id,z.boundsBuffer,f.quadTriangleIndexBuffer,z.boundsSegments):N.draw(I,E.TRIANGLES,K,q[ae.overscaledZ],H,Ut.disabled,yt,je,T.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}})(t,a,h,d);break;case"background":(function(f,b,T,k){const I=T.paint.get("background-color"),E=T.paint.get("background-opacity");if(E===0)return;const z=f.context,N=z.gl,H=f.transform,q=H.tileSize,Q=T.paint.get("background-pattern");if(f.isPatternMissing(Q))return;const ie=!Q&&I.a===1&&E===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==ie)return;const ne=qt.disabled,ae=f.depthModeForSublayer(0,ie==="opaque"?St.ReadWrite:St.ReadOnly),K=f.colorModeForRenderPass(),ue=f.useProgram(Q?"backgroundPattern":"background"),de=k||H.coveringTiles({tileSize:q,terrain:f.style.map.terrain});Q&&(z.activeTexture.set(N.TEXTURE0),f.imageManager.bind(f.context));const ye=T.getCrossfadeParameters();for(const Ie of de){const Le=k?Ie.posMatrix:f.transform.calculatePosMatrix(Ie.toUnwrapped()),$e=Q?Xc(Le,E,f,Q,{tileID:Ie,tileSize:q},ye):ml(Le,E,I),We=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Ie);ue.draw(z,N.TRIANGLES,ae,ne,K,Ut.disabled,$e,We,T.id,f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}})(t,0,h,d);break;case"custom":(function(f,b,T){const k=f.context,I=T.implementation;if(f.renderPass==="offscreen"){const E=I.prerender;E&&(f.setCustomLayerDefaults(),k.setColorMode(f.colorModeForRenderPass()),E.call(I,k.gl,f.transform.customLayerMatrix()),k.setDirty(),f.setBaseState())}else if(f.renderPass==="translucent"){f.setCustomLayerDefaults(),k.setColorMode(f.colorModeForRenderPass()),k.setStencilMode(qt.disabled);const E=I.renderingMode==="3d"?new St(f.context.gl.LEQUAL,St.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,St.ReadOnly);k.setDepthMode(E),I.render(k.gl,f.transform.customLayerMatrix(),{farZ:f.transform.farZ,nearZ:f.transform.nearZ,fov:f.transform._fov,modelViewProjectionMatrix:f.transform.modelViewProjectionMatrix,projectionMatrix:f.transform.projectionMatrix}),k.setDirty(),f.setBaseState(),k.bindFramebuffer.set(null)}})(t,0,h)}}translatePosMatrix(t,a,h,d,f){if(!h[0]&&!h[1])return t;const b=f?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(b){const I=Math.sin(b),E=Math.cos(b);h=[h[0]*E-h[1]*I,h[0]*I+h[1]*E]}const T=[f?h[0]:Tt(a,h[0],this.transform.zoom),f?h[1]:Tt(a,h[1],this.transform.zoom),0],k=new Float32Array(16);return c.J(k,t,T),k}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),h=this.imageManager.getPattern(t.to.toString());return!a||!h}useProgram(t,a){this.cache=this.cache||{};const h=t+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[h]||(this.cache[h]=new Zc(this.context,us[t],a,Kc[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[h]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new pt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}class ya{constructor(t,a){this.points=t,this.planes=a}static fromInvProjectionMatrix(t,a,h){const d=Math.pow(2,h),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const k=1/(T=c.af([],T,t))[3]/a*d;return c.b1(T,T,[k,k,1/T[3],k])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const k=function(N,H){var q=H[0],Q=H[1],ie=H[2],ne=q*q+Q*Q+ie*ie;return ne>0&&(ne=1/Math.sqrt(ne)),N[0]=H[0]*ne,N[1]=H[1]*ne,N[2]=H[2]*ne,N}([],function(N,H,q){var Q=H[0],ie=H[1],ne=H[2],ae=q[0],K=q[1],ue=q[2];return N[0]=ie*ue-ne*K,N[1]=ne*ae-Q*ue,N[2]=Q*K-ie*ae,N}([],Ae([],f[T[0]],f[T[1]]),Ae([],f[T[2]],f[T[1]]))),I=-((E=k)[0]*(z=f[T[1]])[0]+E[1]*z[1]+E[2]*z[2]);var E,z;return k.concat(I)});return new ya(f,b)}}class _a{constructor(t,a){this.min=t,this.max=a,this.center=function(h,d,f){return h[0]=.5*d[0],h[1]=.5*d[1],h[2]=.5*d[2],h}([],function(h,d,f){return h[0]=d[0]+f[0],h[1]=d[1]+f[1],h[2]=d[2]+f[2],h}([],this.min,this.max))}quadrant(t){const a=[t%2==0,t<2],h=Se(this.min),d=Se(this.max);for(let f=0;f<a.length;f++)h[f]=a[f]?this.min[f]:this.center[f],d[f]=a[f]?this.center[f]:this.max[f];return d[2]=this.max[2],new _a(h,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let h=!0;for(let d=0;d<t.planes.length;d++){const f=t.planes[d];let b=0;for(let T=0;T<a.length;T++)c.b2(f,a[T])>=0&&b++;if(b===0)return 0;b!==a.length&&(h=!1)}if(h)return 2;for(let d=0;d<3;d++){let f=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let T=0;T<t.points.length;T++){const k=t.points[T][d]-this.min[d];f=Math.min(f,k),b=Math.max(b,k)}if(b<0||f>this.max[d]-this.min[d])return 0}return 1}}class va{constructor(t=0,a=0,h=0,d=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(h)||h<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=h,this.right=d}interpolate(t,a,h){return a.top!=null&&t.top!=null&&(this.top=c.y.number(t.top,a.top,h)),a.bottom!=null&&t.bottom!=null&&(this.bottom=c.y.number(t.bottom,a.bottom,h)),a.left!=null&&t.left!=null&&(this.left=c.y.number(t.left,a.left,h)),a.right!=null&&t.right!=null&&(this.right=c.y.number(t.right,a.right,h)),this}getCenter(t,a){const h=c.ac((this.left+t-this.right)/2,0,t),d=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(h,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new va(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const uu=85.051129;class xa{constructor(t,a,h,d,f){this.tileSize=512,this._renderWorldCopies=f===void 0||!!f,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=h??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new va,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new xa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.lngRange=t.lngRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const a=-c.b3(t,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var h=new c.A(4);return c.A!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h}(),function(h,d,f){var b=d[0],T=d[1],k=d[2],I=d[3],E=Math.sin(f),z=Math.cos(f);h[0]=b*z+k*E,h[1]=T*z+I*E,h[2]=b*-E+k*z,h[3]=T*-E+I*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=c.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,h){this._unmodified=!1,this._edgeInsets.interpolate(t,a,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new c.b4(0,t)];if(this._renderWorldCopies){const h=this.pointCoordinate(new c.P(0,0)),d=this.pointCoordinate(new c.P(this.width,0)),f=this.pointCoordinate(new c.P(this.width,this.height)),b=this.pointCoordinate(new c.P(0,this.height)),T=Math.floor(Math.min(h.x,d.x,f.x,b.x)),k=Math.floor(Math.max(h.x,d.x,f.x,b.x)),I=1;for(let E=T-I;E<=k+I;E++)E!==0&&a.push(new c.b4(E,t))}return a}coveringTiles(t){var a,h;let d=this.coveringZoomLevel(t);const f=d;if(t.minzoom!==void 0&&d<t.minzoom)return[];t.maxzoom!==void 0&&d>t.maxzoom&&(d=t.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),T=c.Z.fromLngLat(this.center),k=Math.pow(2,d),I=[k*b.x,k*b.y,0],E=[k*T.x,k*T.y,0],z=ya.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,d);let N=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(N=d);const H=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,q=K=>({aabb:new _a([K*k,0,0],[(K+1)*k,k,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),Q=[],ie=[],ne=d,ae=t.reparseOverscaled?f:d;if(this._renderWorldCopies)for(let K=1;K<=3;K++)Q.push(q(-K)),Q.push(q(K));for(Q.push(q(0));Q.length>0;){const K=Q.pop(),ue=K.x,de=K.y;let ye=K.fullyVisible;if(!ye){const je=K.aabb.intersects(z);if(je===0)continue;ye=je===2}const Ie=t.terrain?I:E,Le=K.aabb.distanceX(Ie),$e=K.aabb.distanceY(Ie),We=Math.max(Math.abs(Le),Math.abs($e));if(K.zoom===ne||We>H+(1<<ne-K.zoom)-2&&K.zoom>=N){const je=ne-K.zoom,Oe=I[0]-.5-(ue<<je),Qe=I[1]-.5-(de<<je);ie.push({tileID:new c.S(K.zoom===ne?ae:K.zoom,K.wrap,K.zoom,ue,de),distanceSq:Me([E[0]-.5-ue,E[1]-.5-de]),tileDistanceToCamera:Math.sqrt(Oe*Oe+Qe*Qe)})}else for(let je=0;je<4;je++){const Oe=(ue<<1)+je%2,Qe=(de<<1)+(je>>1),yt=K.zoom+1;let Ne=K.aabb.quadrant(je);if(t.terrain){const qe=new c.S(yt,K.wrap,yt,Oe,Qe),mt=t.terrain.getMinMaxElevation(qe),Yt=(a=mt.minElevation)!==null&&a!==void 0?a:this.elevation,xt=(h=mt.maxElevation)!==null&&h!==void 0?h:this.elevation;Ne=new _a([Ne.min[0],Ne.min[1],Yt],[Ne.max[0],Ne.max[1],xt])}Q.push({aabb:Ne,zoom:yt,x:Oe,y:Qe,wrap:K.wrap,fullyVisible:ye})}}return ie.sort((K,ue)=>K.distanceSq-ue.distanceSq).map(K=>K.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=c.ac(t.lat,-85.051129,uu);return new c.P(c.O(t.lng)*this.worldSize,c.Q(a)*this.worldSize)}unproject(t){return new c.Z(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const a=this.elevation,h=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,d=this.pointLocation(this.centerPoint,t),f=t.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-f))return;const b=h+a-f,T=Math.cos(this._pitch)*this.cameraToCenterDistance/b/c.b5(1,d.lat),k=this.scaleZoom(T/this.tileSize);this._elevation=f,this._center=d,this.zoom=k}setLocationAtPoint(t,a){const h=this.pointCoordinate(a),d=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(t),b=new c.Z(f.x-(h.x-d.x),f.y-(h.y-d.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,a){return a?this.coordinatePoint(this.locationCoordinate(t),a.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,a){return this.coordinateLocation(this.pointCoordinate(t,a))}locationCoordinate(t){return c.Z.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,a){if(a){const N=a.pointCoordinate(t);if(N!=null)return N}const h=[t.x,t.y,0,1],d=[t.x,t.y,1,1];c.af(h,h,this.pixelMatrixInverse),c.af(d,d,this.pixelMatrixInverse);const f=h[3],b=d[3],T=h[1]/f,k=d[1]/b,I=h[2]/f,E=d[2]/b,z=I===E?0:(0-I)/(E-I);return new c.Z(c.y.number(h[0]/f,d[0]/b,z)/this.worldSize,c.y.number(T,k,z)/this.worldSize)}coordinatePoint(t,a=0,h=this.pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,a,1];return c.af(d,d,h),new c.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new we().extend(this.pointLocation(new c.P(0,t))).extend(this.pointLocation(new c.P(this.width,t))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new we([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,uu])}calculateTileMatrix(t){const a=t.canonical,h=this.worldSize/this.zoomScale(a.z),d=a.x+Math.pow(2,a.z)*t.wrap,f=c.an(new Float64Array(16));return c.J(f,f,[d*h,a.y*h,0]),c.K(f,f,[h/c.X,h/c.X,1]),f}calculatePosMatrix(t,a=!1){const h=t.key,d=a?this._alignedPosMatrixCache:this._posMatrixCache;if(d[h])return d[h];const f=this.calculateTileMatrix(t);return c.L(f,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,f),d[h]=new Float32Array(f),d[h]}calculateFogMatrix(t){const a=t.key,h=this._fogMatrixCache;if(h[a])return h[a];const d=this.calculateTileMatrix(t);return c.L(d,this.fogMatrix,d),h[a]=new Float32Array(d),h[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,a){a=c.ac(+a,this.minZoom,this.maxZoom);const h={center:new c.N(t.lng,t.lat),zoom:a};let d=this.lngRange;if(!this._renderWorldCopies&&d===null){const K=179.9999999999;d=[-K,K]}const f=this.tileSize*this.zoomScale(h.zoom);let b=0,T=f,k=0,I=f,E=0,z=0;const{x:N,y:H}=this.size;if(this.latRange){const K=this.latRange;b=c.Q(K[1])*f,T=c.Q(K[0])*f,T-b<H&&(E=H/(T-b))}d&&(k=c.b3(c.O(d[0])*f,0,f),I=c.b3(c.O(d[1])*f,0,f),I<k&&(I+=f),I-k<N&&(z=N/(I-k)));const{x:q,y:Q}=this.project.call({worldSize:f},t);let ie,ne;const ae=Math.max(z||0,E||0);if(ae){const K=new c.P(z?(I+k)/2:q,E?(T+b)/2:Q);return h.center=this.unproject.call({worldSize:f},K).wrap(),h.zoom+=this.scaleZoom(ae),h}if(this.latRange){const K=H/2;Q-K<b&&(ne=b+K),Q+K>T&&(ne=T-K)}if(d){const K=(k+I)/2;let ue=q;this._renderWorldCopies&&(ue=c.b3(q,K-f/2,K+f/2));const de=N/2;ue-de<k&&(ie=k+de),ue+de>I&&(ie=I-de)}if(ie!==void 0||ne!==void 0){const K=new c.P(ie??q,ne??Q);h.center=this.unproject.call({worldSize:f},K).wrap()}return h}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:h}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=h,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.point.x,h=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let d=c.an(new Float64Array(16));c.K(d,d,[this.width/2,-this.height/2,1]),c.J(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=c.an(new Float64Array(16)),c.K(d,d,[1,-1,1]),c.J(d,d,[-1,-1,0]),c.K(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const f=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),b=Math.min(this.elevation,this.minElevationForCurrentTile),T=f-b*this._pixelPerMeter/Math.cos(this._pitch),k=b<0?T:f,I=Math.PI/2+this._pitch,E=this._fov*(.5+t.y/this.height),z=Math.sin(E)*k/Math.sin(c.ac(Math.PI-I-E,.01,Math.PI-.01)),N=this.getHorizon(),H=2*Math.atan(N/this.cameraToCenterDistance)*(.5+t.y/(2*N)),q=Math.sin(H)*k/Math.sin(c.ac(Math.PI-I-H,.01,Math.PI-.01)),Q=Math.min(z,q);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Q+k),this.nearZ=this.height/50,d=new Float64Array(16),c.b6(d,this._fov,this.width/this.height,this.nearZ,this.farZ),d[8]=2*-t.x/this.width,d[9]=2*t.y/this.height,this.projectionMatrix=c.ae(d),c.K(d,d,[1,-1,1]),c.J(d,d,[0,0,-this.cameraToCenterDistance]),c.b7(d,d,this._pitch),c.ad(d,d,this.angle),c.J(d,d,[-a,-h,0]),this.mercatorMatrix=c.K([],d,[this.worldSize,this.worldSize,this.worldSize]),c.K(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,d),c.J(d,d,[0,0,-this.elevation]),this.modelViewProjectionMatrix=d,this.invModelViewProjectionMatrix=c.as([],d),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,f,this.farZ),this.fogMatrix[8]=2*-t.x/this.width,this.fogMatrix[9]=2*t.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-a,-h,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,d);const ie=this.width%2/2,ne=this.height%2/2,ae=Math.cos(this.angle),K=Math.sin(this.angle),ue=a-Math.round(a)+ae*ie+K*ne,de=h-Math.round(h)+ae*ne+K*ie,ye=new Float64Array(d);if(c.J(ye,ye,[ue>.5?ue-1:ue,de>.5?de-1:de,0]),this.alignedModelViewProjectionMatrix=ye,d=c.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new c.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,t))}getCameraQueryGeometry(t){const a=this.getCameraPoint();if(t.length===1)return[t[0],a];{let h=a.x,d=a.y,f=a.x,b=a.y;for(const T of t)h=Math.min(h,T.x),d=Math.min(d,T.y),f=Math.max(f,T.x),b=Math.max(b,T.y);return[new c.P(h,d),new c.P(f,d),new c.P(f,b),new c.P(h,b),new c.P(h,d)]}}lngLatToCameraDepth(t,a){const h=this.locationCoordinate(t),d=[h.x*this.worldSize,h.y*this.worldSize,a,1];return c.af(d,d,this.modelViewProjectionMatrix),d[2]/d[3]}}function Co(m,t){let a,h=!1,d=null,f=null;const b=()=>{d=null,h&&(m.apply(f,a),d=setTimeout(b,t),h=!1)};return(...T)=>(h=!0,f=this,a=T,d||b(),d)}class Cl{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let h;return a.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(h=d)}),(h&&h[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:h,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const h=a.join("/");let d=h;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${h}`);let f=window.location.hash.replace(d,"");f.startsWith("#&")?f=f.slice(0,1)+f.slice(2):f==="#"&&(f="");let b=window.location.href.replace(/(#.+)?$/,f);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=Co(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,d=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,d),b=Math.round(a.lng*f)/f,T=Math.round(a.lat*f)/f,k=this._map.getBearing(),I=this._map.getPitch();let E="";if(E+=t?`/${b}/${T}/${h}`:`${h}/${T}/${b}`,(k||I)&&(E+="/"+Math.round(10*k)/10),I&&(E+=`/${Math.round(I)}`),this._hashName){const z=this._hashName;let N=!1;const H=window.location.hash.slice(1).split("&").map(q=>{const Q=q.split("=")[0];return Q===z?(N=!0,`${Q}=${E}`):q}).filter(q=>q);return N||H.push(`${z}=${E}`),`#${H.join("&")}`}return`#${E}`}}const Pl={linearity:.3,easing:c.b8(0,0,.3,1)},hu=c.e({deceleration:2500,maxSpeed:1400},Pl),rm=c.e({deceleration:20,maxSpeed:1400},Pl),Td=c.e({deceleration:1e3,maxSpeed:360},Pl),Il=c.e({deceleration:1e3,maxSpeed:90},Pl);class du{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:L.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=L.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:f}of this._inertiaBuffer)a.zoom+=f.zoomDelta||0,a.bearing+=f.bearingDelta||0,a.pitch+=f.pitchDelta||0,f.panDelta&&a.pan._add(f.panDelta),f.around&&(a.around=f.around),f.pinchAround&&(a.pinchAround=f.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const f=Io(a.pan.mag(),h,c.e({},hu,t||{}));d.offset=a.pan.mult(f.amount/a.pan.mag()),d.center=this._map.transform.center,Po(d,f)}if(a.zoom){const f=Io(a.zoom,h,rm);d.zoom=this._map.transform.zoom+f.amount,Po(d,f)}if(a.bearing){const f=Io(a.bearing,h,Td);d.bearing=this._map.transform.bearing+c.ac(f.amount,-179,179),Po(d,f)}if(a.pitch){const f=Io(a.pitch,h,Il);d.pitch=this._map.transform.pitch+f.amount,Po(d,f)}if(d.zoom||d.bearing){const f=a.pinchAround===void 0?a.around:a.pinchAround;d.around=f?this._map.unproject(f):this._map.getCenter()}return this.clear(),c.e(d,{noMoveStart:!0})}}function Po(m,t){(!m.duration||m.duration<t.duration)&&(m.duration=t.duration,m.easing=t.easing)}function Io(m,t,a){const{maxSpeed:h,linearity:d,deceleration:f}=a,b=c.ac(m*d/(t/1e3),-h,h),T=Math.abs(b)/(f*d);return{easing:a.easing,duration:1e3*T,amount:b*(T/2)}}class Ui extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,h,d={}){const f=B.mousePos(a.getCanvas(),h),b=a.unproject(f);super(t,c.e({point:f,lngLat:b,originalEvent:h},d)),this._defaultPrevented=!1,this.target=a}}class Os extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,h){const d=t==="touchend"?h.changedTouches:h.touches,f=B.touchPos(a.getCanvasContainer(),d),b=f.map(k=>a.unproject(k)),T=f.reduce((k,I,E,z)=>k.add(I.div(z.length)),new c.P(0,0));super(t,{points:f,point:T,lngLats:b,lngLat:a.unproject(T),originalEvent:h}),this._defaultPrevented=!1}}class kd extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,h){super(t,{originalEvent:h}),this._defaultPrevented=!1}}class Cd{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new kd(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new Ui(t.type,this._map,t))}mouseup(t){this._map.fire(new Ui(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Ui(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Ui(t.type,this._map,t))}mouseover(t){this._map.fire(new Ui(t.type,this._map,t))}mouseout(t){this._map.fire(new Ui(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Os(t.type,this._map,t))}touchmove(t){this._map.fire(new Os(t.type,this._map,t))}touchend(t){this._map.fire(new Os(t.type,this._map,t))}touchcancel(t){this._map.fire(new Os(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ui{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Ui(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ui("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Ui(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lr{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(c.P.convert(t),this._map.terrain)}}class An{constructor(t,a){this._map=t,this._tr=new lr(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(B.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const h=a;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=h,this._box||(this._box=B.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const f=Math.min(d.x,h.x),b=Math.max(d.x,h.x),T=Math.min(d.y,h.y),k=Math.max(d.y,h.y);B.setTransform(this._box,`translate(${f}px,${T}px)`),this._box.style.width=b-f+"px",this._box.style.height=k-T+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const h=this._startPos,d=a;if(this.reset(),B.suppressClick(),h.x!==d.x||h.y!==d.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:t})),{cameraAnimation:f=>f.fitScreenCoordinates(h,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(B.remove(this._box),this._box=null),B.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new c.k(t,{originalEvent:a}))}}function Ao(m,t){if(m.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${t.length}`);const a={};for(let h=0;h<m.length;h++)a[m[h].identifier]=t[h];return a}class pu{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),h.length===this.numTouches&&(this.centroid=function(d){const f=new c.P(0,0);for(const b of d)f._add(b);return f.div(d.length)}(a),this.touches=Ao(h,a)))}touchmove(t,a,h){if(this.aborted||!this.centroid)return;const d=Ao(h,a);for(const f in this.touches){const b=d[f];(!b||b.dist(this.touches[f])>30)&&(this.aborted=!0)}}touchend(t,a,h){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Al{constructor(t){this.singleTap=new pu(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,h){this.singleTap.touchstart(t,a,h)}touchmove(t,a,h){this.singleTap.touchmove(t,a,h)}touchend(t,a,h){const d=this.singleTap.touchend(t,a,h);if(d){const f=t.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(d)<30;if(f&&b||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class wa{constructor(t){this._tr=new lr(t),this._zoomIn=new Al({numTouches:1,numTaps:2}),this._zoomOut=new Al({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,h){this._zoomIn.touchstart(t,a,h),this._zoomOut.touchstart(t,a,h)}touchmove(t,a,h){this._zoomIn.touchmove(t,a,h),this._zoomOut.touchmove(t,a,h)}touchend(t,a,h){const d=this._zoomIn.touchend(t,a,h),f=this._zoomOut.touchend(t,a,h),b=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(d)},{originalEvent:t})}):f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(f)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qr{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const h=this._lastPoint;if(!h)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=a.length?a[0]:a;return!this._moved&&d.dist(h)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(h,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&B.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const fu={0:1,2:2};class Ml{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=B.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(a,h){const d=fu[h];return a.buttons===void 0||(a.buttons&d)!==d}(t,this._eventButton)}isValidEndEvent(t){return B.mouseButton(t)===this._eventButton}}class mu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const El=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=t=>{t.preventDefault()}},gu=({enable:m,clickTolerance:t,bearingDegreesPerPixelMoved:a=.8})=>{const h=new Ml({checkCorrectEvent:d=>B.mouseButton(d)===0&&d.ctrlKey||B.mouseButton(d)===2});return new qr({clickTolerance:t,move:(d,f)=>({bearingDelta:(f.x-d.x)*a}),moveStateManager:h,enable:m,assignEvents:El})},yu=({enable:m,clickTolerance:t,pitchDegreesPerPixelMoved:a=-.5})=>{const h=new Ml({checkCorrectEvent:d=>B.mouseButton(d)===0&&d.ctrlKey||B.mouseButton(d)===2});return new qr({clickTolerance:t,move:(d,f)=>({pitchDelta:(f.y-d.y)*a}),moveStateManager:h,enable:m,assignEvents:El})};class js{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,h){return this._calculateTransform(t,a,h)}touchmove(t,a,h){if(this._active){if(!this._shouldBePrevented(h.length))return t.preventDefault(),this._calculateTransform(t,a,h);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,h){this._calculateTransform(t,a,h),this._active&&this._shouldBePrevented(h.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,h){h.length>0&&(this._active=!0);const d=Ao(h,a),f=new c.P(0,0),b=new c.P(0,0);let T=0;for(const I in d){const E=d[I],z=this._touches[I];z&&(f._add(E),b._add(E.sub(z)),T++,d[I]=E)}if(this._touches=d,this._shouldBePrevented(T)||!b.mag())return;const k=b.div(T);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:f.div(T),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,h){if(!this._firstTwoTouches)return;t.preventDefault();const[d,f]=this._firstTwoTouches,b=Mo(h,a,d),T=Mo(h,a,f);if(!b||!T)return;const k=this._aroundCenter?null:b.add(T).div(2);return this._move([b,T],k,t)}touchend(t,a,h){if(!this._firstTwoTouches)return;const[d,f]=this._firstTwoTouches,b=Mo(h,a,d),T=Mo(h,a,f);b&&T||(this._active&&B.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Mo(m,t,a){for(let h=0;h<m.length;h++)if(m[h].identifier===a)return t[h]}function _u(m,t){return Math.log(m/t)/Math.LN2}class vu extends zl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const h=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(_u(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_u(this._distance,h),pinchAround:a}}}function xu(m,t){return 180*m.angleWith(t)/Math.PI}class wu extends zl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,h){const d=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xu(this._vector,d),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,h=xu(t,this._startVector);return Math.abs(h)<a}}function Dl(m){return Math.abs(m.y)>Math.abs(m.x)}class Eo extends zl{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,h){super.touchstart(t,a,h),this._currentTouchCount=h.length}_start(t){this._lastPoints=t,Dl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,h){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),f=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,f,h.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+f.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,h){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,f=a.mag()>=2;if(!d&&!f)return;if(!d||!f)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const b=t.y>0==a.y>0;return Dl(t)&&Dl(a)&&b}}const Pd={panStep:100,bearingStep:15,pitchStep:10};class Gn{constructor(t){this._tr=new lr(t);const a=Pd;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,h=0,d=0,f=0,b=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?h=-1:(t.preventDefault(),f=-1);break;case 39:t.shiftKey?h=1:(t.preventDefault(),f=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),b=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(h=0,d=0),{cameraAnimation:T=>{const k=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Ir,zoom:a?Math.round(k.zoom)+a*(t.shiftKey?2:1):k.zoom,bearing:k.bearing+h*this._bearingStep,pitch:k.pitch+d*this._pitchStep,offset:[-f*this._panStep,-b*this._panStep],center:k.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ir(m){return m*(2-m)}const bu=4.000244140625;class cr{constructor(t,a){this._onTimeout=h=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},this._map=t,this._tr=new lr(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const h=L.now(),d=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,a!==0&&a%bu==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=B.mousePos(this._map.getCanvas(),t),h=this._tr;this._around=a.y>h.transform.height/2-h.transform.getHorizon()?c.N.convert(this._aroundCenter?h.center:h.unproject(a)):c.N.convert(h.center),this._aroundPoint=h.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>bu?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&I!==0&&(I=1/I);const E=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(E*I))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,h=this._startZoom,d=this._easing;let f,b=!1;const T=L.now()-this._lastWheelEventTime;if(this._type==="wheel"&&h&&d&&T){const k=Math.min(T/200,1),I=d(k);f=c.y.number(h,a,I),k<1?this._frameId||(this._frameId=!0):b=!0}else f=a,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:f-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=c.b9;if(this._prevEase){const h=this._prevEase,d=(L.now()-h.start)/h.duration,f=h.easing(d+.01)-h.easing(d),b=.27/Math.sqrt(f*f+1e-4)*.01,T=Math.sqrt(.0729-b*b);a=c.b8(b,T,.25,1)}return this._prevEase={start:L.now(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Vs{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class sm{constructor(t){this._tr=new lr(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class am{constructor(){this._tap=new Al({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,h){if(!this._swipePoint)if(this._tapTime){const d=a[0],f=t.timeStamp-this._tapTime<500,b=this._tapPoint.dist(d)<30;f&&b?h.length>0&&(this._swipePoint=d,this._swipeTouch=h[0].identifier):this.reset()}else this._tap.touchstart(t,a,h)}touchmove(t,a,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const d=a[0],f=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(t,a,h)}touchend(t,a,h){if(this._tapTime)this._swipePoint&&h.length===0&&this.reset();else{const d=this._tap.touchend(t,a,h);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Id{constructor(t,a,h){this._el=t,this._mousePan=a,this._touchPan=h}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ad{constructor(t,a,h){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Su{constructor(t,a,h,d){this._el=t,this._touchZoom=a,this._touchRotate=h,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ba{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=B.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const h=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const f=document.createElement("div");f.className="maplibregl-mobile-message",f.textContent=h,this._container.appendChild(f),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(B.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Hn=m=>m.zoom||m.drag||m.pitch||m.rotate;class Ke extends c.k{}function Ll(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Tu{constructor(t,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,f)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=d.type==="renderFrame"?void 0:d,T={needsRenderFrame:!1},k={},I={},E=d.touches,z=E?this._getMapTouches(E):void 0,N=z?B.touchPos(this._map.getCanvas(),z):B.mousePos(this._map.getCanvas(),d);for(const{handlerName:Q,handler:ie,allowed:ne}of this._handlers){if(!ie.isEnabled())continue;let ae;this._blockedByActive(I,ne,Q)?ie.reset():ie[f||d.type]&&(ae=ie[f||d.type](d,N,z),this.mergeHandlerResult(T,k,ae,Q,b),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()),(ae||ie.isActive())&&(I[Q]=ie)}const H={};for(const Q in this._previousActiveHandlers)I[Q]||(H[Q]=b);this._previousActiveHandlers=I,(Object.keys(H).length||Ll(T))&&(this._changes.push([T,k,H]),this._triggerRenderFrame()),(Object.keys(I).length||Ll(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=T;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new du(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,f,b]of this._listeners)B.addEventListener(d,f,d===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[t,a,h]of this._listeners)B.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(t){const a=this._map,h=a.getCanvasContainer();this._add("mapEvent",new Cd(a,t));const d=a.boxZoom=new An(a,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const f=a.cooperativeGestures=new ba(a,t.cooperativeGestures);this._add("cooperativeGestures",f),t.cooperativeGestures&&f.enable();const b=new wa(a),T=new sm(a);a.doubleClickZoom=new Vs(T,b),this._add("tapZoom",b),this._add("clickZoom",T),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const k=new am;this._add("tapDragZoom",k);const I=a.touchPitch=new Eo(a);this._add("touchPitch",I),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const E=gu(t),z=yu(t);a.dragRotate=new Ad(t,E,z),this._add("mouseRotate",E,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const N=(({enable:ae,clickTolerance:K})=>{const ue=new Ml({checkCorrectEvent:de=>B.mouseButton(de)===0&&!de.ctrlKey});return new qr({clickTolerance:K,move:(de,ye)=>({around:ye,panDelta:ye.sub(de)}),activateOnStart:!0,moveStateManager:ue,enable:ae,assignEvents:El})})(t),H=new js(t,a);a.dragPan=new Id(h,N,H),this._add("mousePan",N),this._add("touchPan",H,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const q=new wu,Q=new vu;a.touchZoomRotate=new Su(h,Q,q,k),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate);const ie=a.scrollZoom=new cr(a,()=>this._triggerRenderFrame());this._add("scrollZoom",ie,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const ne=a.keyboard=new Gn(a);this._add("keyboard",ne),t.interactive&&t.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new ui(a))}_add(t,a,h){this._handlers.push({handlerName:t,handler:a,allowed:h}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hn(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,h){for(const d in t)if(d!==h&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const h of t)this._el.contains(h.target)&&a.push(h);return a}mergeHandlerResult(t,a,h,d,f){if(!h)return;c.e(t,h);const b={handlerName:d,originalEvent:h.originalEvent||f};h.zoomDelta!==void 0&&(a.zoom=b),h.panDelta!==void 0&&(a.drag=b),h.pitchDelta!==void 0&&(a.pitch=b),h.bearingDelta!==void 0&&(a.rotate=b)}_applyChanges(){const t={},a={},h={};for(const[d,f,b]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),c.e(a,f),c.e(h,b);this._updateMapTransform(t,a,h),this._changes=[]}_updateMapTransform(t,a,h){const d=this._map,f=d._getTransformForUpdate(),b=d.terrain;if(!(Ll(t)||b&&this._terrainMovement))return this._fireEvents(a,h,!0);let{panDelta:T,zoomDelta:k,bearingDelta:I,pitchDelta:E,around:z,pinchAround:N}=t;N!==void 0&&(z=N),d._stop(!0),z=z||d.transform.centerPoint;const H=f.pointLocation(T?z.sub(T):z);I&&(f.bearing+=I),E&&(f.pitch+=E),k&&(f.zoom+=k),b?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?f.center=f.pointLocation(f.centerPoint.sub(T)):f.setLocationAtPoint(H,z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,f.setLocationAtPoint(H,z)):f.setLocationAtPoint(H,z),d._applyUpdatedTransform(f),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,h,!0)}_fireEvents(t,a,h){const d=Hn(this._eventsInProgress),f=Hn(t),b={};for(const z in t){const{originalEvent:N}=t[z];this._eventsInProgress[z]||(b[`${z}start`]=N),this._eventsInProgress[z]=t[z]}!d&&f&&this._fireEvent("movestart",f.originalEvent);for(const z in b)this._fireEvent(z,b[z]);f&&this._fireEvent("move",f.originalEvent);for(const z in t){const{originalEvent:N}=t[z];this._fireEvent(z,N)}const T={};let k;for(const z in this._eventsInProgress){const{handlerName:N,originalEvent:H}=this._eventsInProgress[z];this._handlersById[N].isActive()||(delete this._eventsInProgress[z],k=a[N]||H,T[`${z}end`]=k)}for(const z in T)this._fireEvent(z,T[z]);const I=Hn(this._eventsInProgress),E=(d||f)&&!I;if(E&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const z=this._map._getTransformForUpdate();z.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(z)}if(h&&E){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!z||!z.essential&&L.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:k})),N(this._map.getBearing())&&this._map.resetNorth()):(N(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new c.k(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new Ke("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Md extends c.E{constructor(t,a){super(),this._renderFrameCallback=()=>{const h=Math.min((L.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,h){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},a),h)}panTo(t,a,h){return this.easeTo(c.e({center:t},a),h)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,h){return this.easeTo(c.e({zoom:t},a),h)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,h){return this.easeTo(c.e({bearing:t},a),h)}resetNorth(t,a){return this.rotateTo(0,c.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){t=we.convert(t).adjustAntiMeridian();const h=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),h,a)}_cameraForBoxAndBearing(t,a,h,d){const f={top:0,bottom:0,right:0,left:0};if(typeof(d=c.e({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const je=d.padding;d.padding={top:je,bottom:je,right:je,left:je}}d.padding=c.e(f,d.padding);const b=this.transform,T=b.padding,k=new we(t,a),I=b.project(k.getNorthWest()),E=b.project(k.getNorthEast()),z=b.project(k.getSouthEast()),N=b.project(k.getSouthWest()),H=c.ba(-h),q=I.rotate(H),Q=E.rotate(H),ie=z.rotate(H),ne=N.rotate(H),ae=new c.P(Math.max(q.x,Q.x,ne.x,ie.x),Math.max(q.y,Q.y,ne.y,ie.y)),K=new c.P(Math.min(q.x,Q.x,ne.x,ie.x),Math.min(q.y,Q.y,ne.y,ie.y)),ue=ae.sub(K),de=(b.width-(T.left+T.right+d.padding.left+d.padding.right))/ue.x,ye=(b.height-(T.top+T.bottom+d.padding.top+d.padding.bottom))/ue.y;if(ye<0||de<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ie=Math.min(b.scaleZoom(b.scale*Math.min(de,ye)),d.maxZoom),Le=c.P.convert(d.offset),$e=new c.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c.ba(h)),We=Le.add($e).mult(b.scale/b.zoomScale(Ie));return{center:b.unproject(I.add(z).div(2).sub(We)),zoom:Ie,bearing:h}}fitBounds(t,a,h){return this._fitInternal(this.cameraForBounds(t,a),a,h)}fitScreenCoordinates(t,a,h,d,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(t)),this.transform.pointLocation(c.P.convert(a)),h,d),d,f)}_fitInternal(t,a,h){return t?(delete(a=c.e(t,a)).padding,a.linear?this.easeTo(a,h):this.flyTo(a,h)):this}jumpTo(t,a){this.stop();const h=this._getTransformForUpdate();let d=!1,f=!1,b=!1;return"zoom"in t&&h.zoom!==+t.zoom&&(d=!0,h.zoom=+t.zoom),t.center!==void 0&&(h.center=c.N.convert(t.center)),"bearing"in t&&h.bearing!==+t.bearing&&(f=!0,h.bearing=+t.bearing),"pitch"in t&&h.pitch!==+t.pitch&&(b=!0,h.pitch=+t.pitch),t.padding==null||h.isPaddingEqual(t.padding)||(h.padding=t.padding),this._applyUpdatedTransform(h),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),d&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),f&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),b&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(t,a,h,d=0){const f=c.Z.fromLngLat(t,a),b=c.Z.fromLngLat(h,d),T=b.x-f.x,k=b.y-f.y,I=b.z-f.z,E=Math.hypot(T,k,I);if(E===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(T,k),N=this.transform.scaleZoom(this.transform.cameraToCenterDistance/E/this.transform.tileSize),H=180*Math.atan2(T,-k)/Math.PI;let q=180*Math.acos(z/E)/Math.PI;return q=I<0?90-q:90+q,{center:b.toLngLat(),zoom:N,pitch:q,bearing:H}}easeTo(t,a){var h;this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.b9},t)).animate===!1||!t.essential&&L.prefersReducedMotion)&&(t.duration=0);const d=this._getTransformForUpdate(),f=d.zoom,b=d.bearing,T=d.pitch,k=d.padding,I="bearing"in t?this._normalizeBearing(t.bearing,b):b,E="pitch"in t?+t.pitch:T,z="padding"in t?t.padding:d.padding,N=c.P.convert(t.offset);let H=d.centerPoint.add(N);const q=d.pointLocation(H),{center:Q,zoom:ie}=d.getConstrained(c.N.convert(t.center||q),(h=t.zoom)!==null&&h!==void 0?h:f);this._normalizeCenter(Q,d);const ne=d.project(q),ae=d.project(Q).sub(ne),K=d.zoomScale(ie-f);let ue,de;t.around&&(ue=c.N.convert(t.around),de=d.locationPoint(ue));const ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ie!==f,this._rotating=this._rotating||b!==I,this._pitching=this._pitching||E!==T,this._padding=!d.isPaddingEqual(z),this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,ye),this.terrain&&this._prepareElevation(Q),this._ease(Ie=>{if(this._zooming&&(d.zoom=c.y.number(f,ie,Ie)),this._rotating&&(d.bearing=c.y.number(b,I,Ie)),this._pitching&&(d.pitch=c.y.number(T,E,Ie)),this._padding&&(d.interpolatePadding(k,z,Ie),H=d.centerPoint.add(N)),this.terrain&&!t.freezeElevation&&this._updateElevation(Ie),ue)d.setLocationAtPoint(ue,de);else{const Le=d.zoomScale(d.zoom-f),$e=ie>f?Math.min(2,K):Math.max(.5,K),We=Math.pow($e,1-Ie),je=d.unproject(ne.add(ae.mult(Ie*We)).mult(Le));d.setLocationAtPoint(d.renderWorldCopies?je.wrap():je,H)}this._applyUpdatedTransform(d),this._fireMoveEvents(a)},Ie=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,Ie)},t),this}_prepareEase(t,a,h={}){this._moving=!0,a||h.moving||this.fire(new c.k("movestart",t)),this._zooming&&!h.zooming&&this.fire(new c.k("zoomstart",t)),this._rotating&&!h.rotating&&this.fire(new c.k("rotatestart",t)),this._pitching&&!h.pitching&&this.fire(new c.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const h=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(h-(a-(h*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){const a=t.getCameraPosition(),h=this.terrain.getElevationForLngLatZoom(a.lngLat,t.zoom);if(a.altitude<h){const d=this.calculateCameraOptionsFromTo(a.lngLat,h,t.center,t.elevation);return{pitch:d.pitch,zoom:d.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(this.terrain&&a.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&a.push(d=>this.transformCameraUpdate(d)),!a.length)return;const h=t.clone();for(const d of a){const f=h.clone(),{center:b,zoom:T,pitch:k,bearing:I,elevation:E}=d(f);b&&(f.center=b),T!==void 0&&(f.zoom=T),k!==void 0&&(f.pitch=k),I!==void 0&&(f.bearing=I),E!==void 0&&(f.elevation=E),h.apply(f)}this.transform.apply(h)}_fireMoveEvents(t){this.fire(new c.k("move",t)),this._zooming&&this.fire(new c.k("zoom",t)),this._rotating&&this.fire(new c.k("rotate",t)),this._pitching&&this.fire(new c.k("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const h=this._zooming,d=this._rotating,f=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new c.k("zoomend",t)),d&&this.fire(new c.k("rotateend",t)),f&&this.fire(new c.k("pitchend",t)),this.fire(new c.k("moveend",t))}flyTo(t,a){var h;if(!t.essential&&L.prefersReducedMotion){const qe=c.M(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(qe,a)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},t);const d=this._getTransformForUpdate(),f=d.zoom,b=d.bearing,T=d.pitch,k=d.padding,I="bearing"in t?this._normalizeBearing(t.bearing,b):b,E="pitch"in t?+t.pitch:T,z="padding"in t?t.padding:d.padding,N=c.P.convert(t.offset);let H=d.centerPoint.add(N);const q=d.pointLocation(H),{center:Q,zoom:ie}=d.getConstrained(c.N.convert(t.center||q),(h=t.zoom)!==null&&h!==void 0?h:f);this._normalizeCenter(Q,d);const ne=d.zoomScale(ie-f),ae=d.project(q),K=d.project(Q).sub(ae);let ue=t.curve;const de=Math.max(d.width,d.height),ye=de/ne,Ie=K.mag();if("minZoom"in t){const qe=c.ac(Math.min(t.minZoom,f,ie),d.minZoom,d.maxZoom),mt=de/d.zoomScale(qe-f);ue=Math.sqrt(mt/Ie*2)}const Le=ue*ue;function $e(qe){const mt=(ye*ye-de*de+(qe?-1:1)*Le*Le*Ie*Ie)/(2*(qe?ye:de)*Le*Ie);return Math.log(Math.sqrt(mt*mt+1)-mt)}function We(qe){return(Math.exp(qe)-Math.exp(-qe))/2}function je(qe){return(Math.exp(qe)+Math.exp(-qe))/2}const Oe=$e(!1);let Qe=function(qe){return je(Oe)/je(Oe+ue*qe)},yt=function(qe){return de*((je(Oe)*(We(mt=Oe+ue*qe)/je(mt))-We(Oe))/Le)/Ie;var mt},Ne=($e(!0)-Oe)/ue;if(Math.abs(Ie)<1e-6||!isFinite(Ne)){if(Math.abs(de-ye)<1e-6)return this.easeTo(t,a);const qe=ye<de?-1:1;Ne=Math.abs(Math.log(ye/de))/ue,yt=()=>0,Qe=mt=>Math.exp(qe*ue*mt)}return t.duration="duration"in t?+t.duration:1e3*Ne/("screenSpeed"in t?+t.screenSpeed/ue:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=b!==I,this._pitching=E!==T,this._padding=!d.isPaddingEqual(z),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(Q),this._ease(qe=>{const mt=qe*Ne,Yt=1/Qe(mt);d.zoom=qe===1?ie:f+d.scaleZoom(Yt),this._rotating&&(d.bearing=c.y.number(b,I,qe)),this._pitching&&(d.pitch=c.y.number(T,E,qe)),this._padding&&(d.interpolatePadding(k,z,qe),H=d.centerPoint.add(N)),this.terrain&&!t.freezeElevation&&this._updateElevation(qe);const xt=qe===1?Q:d.unproject(ae.add(K.mult(yt(mt))).mult(Yt));d.setLocationAtPoint(d.renderWorldCopies?xt.wrap():xt,H),this._applyUpdatedTransform(d),this._fireMoveEvents(a)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var h;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,a)}return t||(h=this.handlers)===null||h===void 0||h.stop(!1),this}_ease(t,a,h){h.animate===!1||h.duration===0?(t(1),a()):(this._easeStart=L.now(),this._easeOptions=h,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=c.b3(t,-180,180);const h=Math.abs(t-a);return Math.abs(t-360-a)<h&&(t-=360),Math.abs(t+360-a)<h&&(t+=360),t}_normalizeCenter(t,a){if(!a.renderWorldCopies||a.lngRange)return;const h=t.lng-a.center.lng;t.lng+=h>180?-360:h<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const Sa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ta{constructor(t=Sa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=B.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=B.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=B.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){B.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const h=this._map._getUIString(`AttributionControl.${a}`);t.title=h,t.setAttribute("aria-label",h)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.sourceCaches;for(const d in a){const f=a[d];if(f.used||f.usedForTerrain){const b=f.getSource();b.attribution&&t.indexOf(b.attribution)<0&&t.push(b.attribution)}}t=t.filter(d=>String(d).trim()),t.sort((d,f)=>d.length-f.length),t=t.filter((d,f)=>{for(let b=f+1;b<t.length;b++)if(t[b].indexOf(d)>=0)return!1;return!0});const h=t.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,t.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ku{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const h=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact"):h.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=B.create("div","maplibregl-ctrl");const a=B.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){B.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Pt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,h=a?this._queue.concat(a):this._queue;for(const d of h)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const h of a)if(!h.cancelled&&(h.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Cu=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class om extends c.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,a){this.sourceCache.update(t,a),this._renderableTilesKeys=[];const h={};for(const d of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))h[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),c.aP(d.posMatrix,0,c.X,0,c.X,0,1),this._tiles[d.key]=new ls(d,this.tileSize));for(const d in this._tiles)h[d]||delete this._tiles[d]}freeRtt(t){for(const a in this._tiles){const h=this._tiles[a];(!t||h.tileID.equals(t)||h.tileID.isChildOf(t)||t.isChildOf(h.tileID))&&(h.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const a={};for(const h of this._renderableTilesKeys){const d=this._tiles[h].tileID;if(d.canonical.equals(t.canonical)){const f=t.clone();f.posMatrix=new Float64Array(16),c.aP(f.posMatrix,0,c.X,0,c.X,0,1),a[h]=f}else if(d.canonical.isChildOf(t.canonical)){const f=t.clone();f.posMatrix=new Float64Array(16);const b=d.canonical.z-t.canonical.z,T=d.canonical.x-(d.canonical.x>>b<<b),k=d.canonical.y-(d.canonical.y>>b<<b),I=c.X>>b;c.aP(f.posMatrix,0,I,0,I,0,1),c.J(f.posMatrix,f.posMatrix,[-T*I,-k*I,0]),a[h]=f}else if(t.canonical.isChildOf(d.canonical)){const f=t.clone();f.posMatrix=new Float64Array(16);const b=t.canonical.z-d.canonical.z,T=t.canonical.x-(t.canonical.x>>b<<b),k=t.canonical.y-(t.canonical.y>>b<<b),I=c.X>>b;c.aP(f.posMatrix,0,c.X,0,c.X,0,1),c.J(f.posMatrix,f.posMatrix,[T*I,k*I,0]),c.K(f.posMatrix,f.posMatrix,[1/2**b,1/2**b,0]),a[h]=f}}return a}getSourceTile(t,a){const h=this.sourceCache._source;let d=t.overscaledZ-this.deltaZoom;if(d>h.maxzoom&&(d=h.maxzoom),d<h.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let f=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!f||!f.dem)&&a)for(;d>=h.minzoom&&(!f||!f.dem);)f=this.sourceCache.getTileByID(t.scaledTo(d--).key);return f}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=t)}}class Pu{constructor(t,a,h){this.painter=t,this.sourceCache=new om(a),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,h,d=c.X){var f;if(!(a>=0&&a<d&&h>=0&&h<d))return 0;const b=this.getTerrainData(t),T=(f=b.tile)===null||f===void 0?void 0:f.dem;if(!T)return 0;const k=function(q,Q,ie){var ne=Q[0],ae=Q[1];return q[0]=ie[0]*ne+ie[4]*ae+ie[12],q[1]=ie[1]*ne+ie[5]*ae+ie[13],q}([],[a/d*c.X,h/d*c.X],b.u_terrain_matrix),I=[k[0]*T.dim,k[1]*T.dim],E=Math.floor(I[0]),z=Math.floor(I[1]),N=I[0]-E,H=I[1]-z;return T.get(E,z)*(1-N)*(1-H)+T.get(E+1,z)*N*(1-H)+T.get(E,z+1)*(1-N)*H+T.get(E+1,z+1)*N*H}getElevationForLngLatZoom(t,a){if(!c.bb(a,t.wrap()))return 0;const{tileID:h,mercatorX:d,mercatorY:f}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(h,d%c.X,f%c.X,c.X)}getElevation(t,a,h,d=c.X){return this.getDEMElevation(t,a,h,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,f=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new pt(d,f,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new pt(d,new c.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new pt(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const h=a&&a+a.tileID.key+t.key;if(h&&!this._demMatrixCache[h]){const d=this.sourceCache.sourceCache._source.maxzoom;let f=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?f=t.canonical.z-d:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=t.canonical.x-(t.canonical.x>>f<<f),T=t.canonical.y-(t.canonical.y>>f<<f),k=c.bc(new Float64Array(16),[1/(c.X<<f),1/(c.X<<f),0]);c.J(k,k,[b*c.X,T*c.X,0]),this._demMatrixCache[t.key]={matrix:k,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,h=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new pt(a.context,{width:h,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new pt(a.context,{width:h,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(h,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,h,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let f=0,b=0;f<this._coordsTextureSize;f++)for(let T=0;T<this._coordsTextureSize;T++,b+=4)a[b+0]=255&T,a[b+1]=255&f,a[b+2]=T>>8<<4|f>>8,a[b+3]=0;const h=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new pt(t,h,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),h=this.painter.context,d=h.gl,f=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(f,T-b-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),h.bindFramebuffer.set(null);const k=a[0]+(a[2]>>4<<8),I=a[1]+((15&a[2])<<8),E=this.coordsIndex[255-a[3]],z=E&&this.sourceCache.getTileByID(E);if(!z)return null;const N=this._coordsTextureSize,H=(1<<z.tileID.canonical.z)*N;return new c.Z((z.tileID.canonical.x*N+k)/H+z.tileID.wrap,(z.tileID.canonical.y*N+I)/H,this.getElevation(z.tileID,k,I,N))}depthAtPoint(t){const a=new Uint8Array(4),h=this.painter.context,d=h.gl;return h.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),h.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,a=new c.bd,h=new c.aY,d=this.meshSize,f=c.X/d,b=d*d;for(let z=0;z<=d;z++)for(let N=0;N<=d;N++)a.emplaceBack(N*f,z*f,0);for(let z=0;z<b;z+=d+1)for(let N=0;N<d;N++)h.emplaceBack(N+z,d+N+z+1,d+N+z+2),h.emplaceBack(N+z,d+N+z+2,N+z+1);const T=a.length,k=T+2*(d+1);for(const z of[0,1])for(let N=0;N<=d;N++)for(const H of[0,1])a.emplaceBack(N*f,z*c.X,H);for(let z=0;z<2*d;z+=2)h.emplaceBack(k+z,k+z+1,k+z+3),h.emplaceBack(k+z,k+z+3,k+z+2),h.emplaceBack(T+z,T+z+3,T+z+1),h.emplaceBack(T+z,T+z+2,T+z+3);const I=a.length,E=I+2*(d+1);for(const z of[0,1])for(let N=0;N<=d;N++)for(const H of[0,1])a.emplaceBack(z*c.X,N*f,H);for(let z=0;z<2*d;z+=2)h.emplaceBack(I+z,I+z+1,I+z+3),h.emplaceBack(I+z,I+z+3,I+z+2),h.emplaceBack(E+z,E+z+3,E+z+1),h.emplaceBack(E+z,E+z+2,E+z+3);return this._mesh=new Tl(t.createVertexBuffer(a,Cu.members),t.createIndexBuffer(h),c.a0.simpleSegment(0,0,a.length,h.length)),this._mesh}getMeshFrameDelta(t){return 2*Math.PI*c.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,a){var h;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(h=this.getMinMaxElevation(d).minElevation)!==null&&h!==void 0?h:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,h={minElevation:null,maxElevation:null};return a&&a.dem&&(h.minElevation=a.dem.min*this.exaggeration,h.maxElevation=a.dem.max*this.exaggeration),h}_getOverscaledTileIDFromLngLatZoom(t,a){const h=c.Z.fromLngLat(t.wrap()),d=(1<<a)*c.X,f=h.x*d,b=h.y*d,T=Math.floor(f/c.X),k=Math.floor(b/c.X);return{tileID:new c.S(a,0,a,T,k),mercatorX:f,mercatorY:b}}}class lm{constructor(t,a,h){this._context=t,this._size=a,this._tileSize=h,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),h=new pt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return h.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(h.texture),{id:t,fbo:a,texture:h,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>t.id!==a),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const ka={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ed{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new lm(t.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(h=>!t._layers[h].isHidden(a)),this._coordsDescendingInv={};for(const h in t.sourceCaches){this._coordsDescendingInv[h]={};const d=t.sourceCaches[h].getVisibleCoordinates();for(const f of d){const b=this.terrain.sourceCache.getTerrainCoords(f);for(const T in b)this._coordsDescendingInv[h][T]||(this._coordsDescendingInv[h][T]=[]),this._coordsDescendingInv[h][T].push(b[T])}}this._coordsDescendingInvStr={};for(const h of t._order){const d=t._layers[h],f=d.source;if(ka[d.type]&&!this._coordsDescendingInvStr[f]){this._coordsDescendingInvStr[f]={};for(const b in this._coordsDescendingInv[f])this._coordsDescendingInvStr[f][b]=this._coordsDescendingInv[f][b].map(T=>T.key).sort().join()}}for(const h of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const f=this._coordsDescendingInvStr[d][h.tileID.key];f&&f!==h.rttCoords[d]&&(h.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const a=t.type,h=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(ka[a]&&(this._prevType&&ka[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(t.id),!d))return!0;if(ka[this._prevType]||ka[a]&&d){this._prevType=a;const f=this._stacks.length-1,b=this._stacks[f]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(Sd(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[f]){const I=this.pool.getObjectForId(T.rtt[f].id);if(I.stamp===T.rtt[f].stamp){this.pool.useObject(I);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),T.rtt[f]={id:k.id,stamp:k.stamp},h.context.bindFramebuffer.set(k.fbo.framebuffer),h.context.clear({color:c.aM.transparent,stencil:0}),h.currentStencilSource=void 0;for(let I=0;I<b.length;I++){const E=h.style._layers[b[I]],z=E.source?this._coordsDescendingInv[E.source][T.tileID.key]:[T.tileID];h.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),h._renderTileClippingMasks(E,z),h.renderLayer(h,h.style.sourceCaches[E.source],E,z),E.source&&(T.rttCoords[E.source]=this._coordsDescendingInvStr[E.source][T.tileID.key])}}return Sd(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ka[a]}return!1}}const Iu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},zd=A,cm={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Sa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Au=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},um={showCompass:!0,showZoom:!0,visualizePitch:!1};class hm{constructor(t,a,h=!1){this.mousedown=b=>{this.startMouse(c.e({},b,{ctrlKey:!0,preventDefault:()=>b.preventDefault()}),B.mousePos(this.element,b)),B.addEventListener(window,"mousemove",this.mousemove),B.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.moveMouse(b,B.mousePos(this.element,b))},this.mouseup=b=>{this.mouseRotate.dragEnd(b),this.mousePitch&&this.mousePitch.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=B.touchPos(this.element,b.targetTouches)[0],this.startTouch(b,this._startPos),B.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=B.touchPos(this.element,b.targetTouches)[0],this.moveTouch(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=t.dragRotate._mouseRotate.getClickTolerance(),f=t.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=gu({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:b,clickTolerance:T,bearingDegreesPerPixelMoved:k=.8})=>{const I=new mu;return new qr({clickTolerance:T,move:(E,z)=>({bearingDelta:(z.x-E.x)*k}),moveStateManager:I,enable:b,assignEvents:Au})})({clickTolerance:d,enable:!0}),this.map=t,h&&(this.mousePitch=yu({clickTolerance:f,enable:!0}),this.touchPitch=(({enable:b,clickTolerance:T,pitchDegreesPerPixelMoved:k=-.5})=>{const I=new mu;return new qr({clickTolerance:T,move:(E,z)=>({pitchDelta:(z.y-E.y)*k}),moveStateManager:I,enable:b,assignEvents:Au})})({clickTolerance:f,enable:!0})),B.addEventListener(a,"mousedown",this.mousedown),B.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),B.addEventListener(a,"touchcancel",this.reset)}startMouse(t,a){this.mouseRotate.dragStart(t,a),this.mousePitch&&this.mousePitch.dragStart(t,a),B.disableDrag()}startTouch(t,a){this.touchRotate.dragStart(t,a),this.touchPitch&&this.touchPitch.dragStart(t,a),B.disableDrag()}moveMouse(t,a){const h=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(t,a)||{};if(d&&h.setBearing(h.getBearing()+d),this.mousePitch){const{pitchDelta:f}=this.mousePitch.dragMove(t,a)||{};f&&h.setPitch(h.getPitch()+f)}}moveTouch(t,a){const h=this.map,{bearingDelta:d}=this.touchRotate.dragMove(t,a)||{};if(d&&h.setBearing(h.getBearing()+d),this.touchPitch){const{pitchDelta:f}=this.touchPitch.dragMove(t,a)||{};f&&h.setPitch(h.getPitch()+f)}}off(){const t=this.element;B.removeEventListener(t,"mousedown",this.mousedown),B.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),B.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.removeEventListener(window,"touchend",this.touchend),B.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){B.enableDrag(),B.removeEventListener(window,"mousemove",this.mousemove),B.removeEventListener(window,"mouseup",this.mouseup),B.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),B.removeEventListener(window,"touchend",this.touchend)}}let Mn;function Kt(m,t,a){const h=new c.N(m.lng,m.lat);if(m=new c.N(m.lng,m.lat),t){const d=new c.N(m.lng-360,m.lat),f=new c.N(m.lng+360,m.lat),b=a.locationPoint(m).distSqr(t);a.locationPoint(d).distSqr(t)<b?m=d:a.locationPoint(f).distSqr(t)<b&&(m=f)}for(;Math.abs(m.lng-a.center.lng)>180;){const d=a.locationPoint(m);if(d.x>=0&&d.y>=0&&d.x<=a.width&&d.y<=a.height)break;m.lng>a.center.lng?m.lng-=360:m.lng+=360}return m.lng!==h.lng&&a.locationPoint(m).y>a.height/2-a.getHorizon()?m:h}const Ca={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Rl(m,t,a){const h=m.classList;for(const d in Ca)h.remove(`maplibregl-${a}-anchor-${d}`);h.add(`maplibregl-${a}-anchor-${t}`)}class Bl extends c.E{constructor(t){if(super(),this._onKeyPress=a=>{const h=a.code,d=a.charCode||a.keyCode;h!=="Space"&&h!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const h=a.originalEvent.target,d=this._element;this._popup&&(h===d||d.contains(h))&&this.togglePopup()},this._update=a=>{var h;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Kt(this._lngLat,this._flatPos,this._map.transform):(h=this._lngLat)===null||h===void 0?void 0:h.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),B.setTransform(this._element,`${Ca[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${f}`),L.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=B.create("div");const a=B.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${h}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const f=B.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");const b=B.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const T=B.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ne of k){const ae=B.createNS("http://www.w3.org/2000/svg","ellipse");ae.setAttributeNS(null,"opacity","0.04"),ae.setAttributeNS(null,"cx","10.5"),ae.setAttributeNS(null,"cy","5.80029008"),ae.setAttributeNS(null,"rx",ne.rx),ae.setAttributeNS(null,"ry",ne.ry),T.appendChild(ae)}const I=B.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill",this._color);const E=B.createNS("http://www.w3.org/2000/svg","path");E.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),I.appendChild(E);const z=B.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const N=B.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild(N);const H=B.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const q=B.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Q=B.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#000000"),Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962");const ie=B.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#FFFFFF"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962"),q.appendChild(Q),q.appendChild(ie),b.appendChild(T),b.appendChild(I),b.appendChild(z),b.appendChild(H),b.appendChild(q),a.appendChild(b),a.setAttributeNS(null,"height",h*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),Rl(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),B.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,h;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,f=d.terrain.depthAtPoint(this._pos),b=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,b)-f<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/d.transform._pixelPerMeter,k=Math.sin(d.getPitch()*Math.PI/180)*T,I=d.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),E=d.transform.lngLatToCameraDepth(this._lngLat,b+k)-I>.006;!((h=this._popup)===null||h===void 0)&&h.isOpen()&&E&&this._popup.remove(),this._element.style.opacity=E?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return t===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Dd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let zo=0,Do=!1;const Ar={maxWidth:100,unit:"metric"};function Lo(m,t,a){const h=a&&a.maxWidth||100,d=m._container.clientHeight/2,f=m.unproject([0,d]),b=m.unproject([h,d]),T=f.distanceTo(b);if(a&&a.unit==="imperial"){const k=3.2808*T;k>5280?Je(t,h,k/5280,m._getUIString("ScaleControl.Miles")):Je(t,h,k,m._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Je(t,h,T/1852,m._getUIString("ScaleControl.NauticalMiles")):T>=1e3?Je(t,h,T/1e3,m._getUIString("ScaleControl.Kilometers")):Je(t,h,T,m._getUIString("ScaleControl.Meters"))}function Je(m,t,a,h){const d=function(f){const b=Math.pow(10,`${Math.floor(f)}`.length-1);let T=f/b;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(k){const I=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*I)/I}(T),b*T}(a);m.style.width=t*(d/a)+"px",m.innerHTML=`${d}&nbsp;${h}`}const ht={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Fl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ol(m){if(m){if(typeof m=="number"){const t=Math.round(Math.abs(m)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,m),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-m),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(m,0),right:new c.P(-m,0)}}if(m instanceof c.P||Array.isArray(m)){const t=c.P.convert(m);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(m.center||[0,0]),top:c.P.convert(m.top||[0,0]),"top-left":c.P.convert(m["top-left"]||[0,0]),"top-right":c.P.convert(m["top-right"]||[0,0]),bottom:c.P.convert(m.bottom||[0,0]),"bottom-left":c.P.convert(m["bottom-left"]||[0,0]),"bottom-right":c.P.convert(m["bottom-right"]||[0,0]),left:c.P.convert(m.left||[0,0]),right:c.P.convert(m.right||[0,0])}}return Ol(new c.P(0,0))}const Mu=A;v.AJAXError=c.bh,v.Evented=c.E,v.LngLat=c.N,v.MercatorCoordinate=c.Z,v.Point=c.P,v.addProtocol=c.bi,v.config=c.a,v.removeProtocol=c.bj,v.AttributionControl=Ta,v.BoxZoomHandler=An,v.CanvasSource=Nn,v.CooperativeGesturesHandler=ba,v.DoubleClickZoomHandler=Vs,v.DragPanHandler=Id,v.DragRotateHandler=Ad,v.EdgeInsets=va,v.FullscreenControl=class extends c.E{constructor(m={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a==null?void 0:a.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){B.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=B.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);B.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=po,v.GeolocateControl=class extends c.E{constructor(m){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new c.N(t.coords.longitude,t.coords.latitude),h=t.coords.accuracy,d=this._map.getBearing(),f=c.e({bearing:d},this.options.fitBoundsOptions),b=we.fromLngLat(a,h);this._map.fitBounds(b,f,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new c.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Do)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=B.create("button","maplibregl-ctrl-geolocate",this._container),B.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Bl({element:this._dotElement}),this._circleElement=B.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Dd,m)}onAdd(m){return this._map=m,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(t=!1){if(Mn!==void 0&&!t)return Mn;if(window.navigator.permissions===void 0)return Mn=!!window.navigator.geolocation,Mn;try{Mn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Mn=!!window.navigator.geolocation}return Mn})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),B.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zo=0,Do=!1}_isOutOfMapMaxBounds(m){const t=this._map.getMaxBounds(),a=m.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const m=this._map.getBounds(),t=m.getSouthEast(),a=m.getNorthEast(),h=t.distanceTo(a),d=Math.ceil(this._accuracy/(h/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zo--,Do=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),zo++,zo>1?(m={maximumAge:6e5,timeout:0},Do=!0):(m=this.options.positionOptions,Do=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.Hash=Cl,v.ImageSource=$r,v.KeyboardHandler=Gn,v.LngLatBounds=we,v.LogoControl=ku,v.Map=class extends Md{constructor(m){c.bf.mark(c.bg.create);const t=Object.assign(Object.assign({},cm),m);if(t.minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(t.minPitch!=null&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(t.maxPitch!=null&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new xa(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Pt,this._controls=[],this._mapId=c.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=t.preserveDrawingBuffer===!0,this._antialias=t.antialias===!0,this._trackResize=t.trackResize===!0,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles===!0,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions===!0,this._collectResourceTiming=t.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Iu),t.locale),this._clickTolerance=t.clickTolerance,this._overridePixelRatio=t.pixelRatio,this._maxCanvasSize=t.maxCanvasSize,this.transformCameraUpdate=t.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=t.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new ve(t.transformRequest),typeof t.container=="string"){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const h=Co(d=>{this._trackResize&&!this._removed&&(this.resize(d),this.redraw())},50);this._resizeObserver=new ResizeObserver(d=>{a?h(d):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Tu(this,t),this._hash=t.hash&&new Cl(typeof t.hash=="string"&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,c.e({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new Ta(typeof t.attributionControl=="boolean"?void 0:t.attributionControl)),t.maplibreLogo&&this.addControl(new ku,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(m,t){if(t===void 0&&(t=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=m.onAdd(this);this._controls.push(m);const h=this._controlPositions[t];return t.indexOf("bottom")!==-1?h.insertBefore(a,h.firstChild):h.appendChild(a),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(m);return t>-1&&this._controls.splice(t,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,t,a,h){return h==null&&this.terrain&&(h=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,t,a,h)}resize(m){var t;const a=this._containerDimensions(),h=a[0],d=a[1],f=this._getClampedPixelRatio(h,d);if(this._resizeCanvas(h,d,f),this.painter.resize(h,d,f),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const k=this._getClampedPixelRatio(h,d);this._resizeCanvas(h,d,k),this.painter.resize(h,d,k)}this.transform.resize(h,d),(t=this._requestedCameraState)===null||t===void 0||t.resize(h,d);const b=!this._moving;return b&&(this.stop(),this.fire(new c.k("movestart",m)).fire(new c.k("move",m))),this.fire(new c.k("resize",m)),b&&this.fire(new c.k("moveend",m)),this}_getClampedPixelRatio(m,t){const{0:a,1:h}=this._maxCanvasSize,d=this.getPixelRatio(),f=m*d,b=t*d;return Math.min(f>a?a/f:1,b>h?h/b:1)*d}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(we.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}project(m){return this.transform.locationPoint(c.N.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(c.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,t,a){if(m==="mouseenter"||m==="mouseover"){let h=!1;return{layers:t,listener:a,delegates:{mousemove:f=>{const b=t.filter(k=>this.getLayer(k)),T=b.length!==0?this.queryRenderedFeatures(f.point,{layers:b}):[];T.length?h||(h=!0,a.call(this,new Ui(m,this,f.originalEvent,{features:T}))):h=!1},mouseout:()=>{h=!1}}}}if(m==="mouseleave"||m==="mouseout"){let h=!1;return{layers:t,listener:a,delegates:{mousemove:b=>{const T=t.filter(k=>this.getLayer(k));(T.length!==0?this.queryRenderedFeatures(b.point,{layers:T}):[]).length?h=!0:h&&(h=!1,a.call(this,new Ui(m,this,b.originalEvent)))},mouseout:b=>{h&&(h=!1,a.call(this,new Ui(m,this,b.originalEvent)))}}}}{const h=d=>{const f=t.filter(T=>this.getLayer(T)),b=f.length!==0?this.queryRenderedFeatures(d.point,{layers:f}):[];b.length&&(d.features=b,a.call(this,d),delete d.features)};return{layers:t,listener:a,delegates:{[m]:h}}}}_saveDelegatedListener(m,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(t)}_removeDelegatedListener(m,t,a){if(!this._delegatedListeners||!this._delegatedListeners[m])return;const h=this._delegatedListeners[m];for(let d=0;d<h.length;d++){const f=h[d];if(f.listener===a&&f.layers.length===t.length&&f.layers.every(b=>t.includes(b))){for(const b in f.delegates)this.off(b,f.delegates[b]);return void h.splice(d,1)}}}on(m,t,a){if(a===void 0)return super.on(m,t);const h=this._createDelegatedListener(m,typeof t=="string"?[t]:t,a);this._saveDelegatedListener(m,h);for(const d in h.delegates)this.on(d,h.delegates[d]);return this}once(m,t,a){if(a===void 0)return super.once(m,t);const h=typeof t=="string"?[t]:t,d=this._createDelegatedListener(m,h,a);for(const f in d.delegates){const b=d.delegates[f];d.delegates[f]=(...T)=>{this._removeDelegatedListener(m,h,a),b(...T)}}this._saveDelegatedListener(m,d);for(const f in d.delegates)this.once(f,d.delegates[f]);return this}off(m,t,a){return a===void 0?super.off(m,t):(this._removeDelegatedListener(m,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(m,t){if(!this.style)return[];let a;const h=m instanceof c.P||Array.isArray(m),d=h?m:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(h?{}:m)||{},d instanceof c.P||typeof d[0]=="number")a=[c.P.convert(d)];else{const f=c.P.convert(d[0]),b=c.P.convert(d[1]);a=[f,new c.P(b.x,f.y),b,new c.P(f.x,b.y),f]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(m,t){return this.style.querySourceFeatures(m,t)}setStyle(m,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(m,t))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const t=this._locale[m];if(t==null)throw new Error(`Missing UI string '${m}'`);return t}_updateStyle(m,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,t));const a=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new cl(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,t,a):this.style.loadJSON(m,t,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new cl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,t){if(typeof m=="string"){const a=this._requestManager.transformRequest(m,"Style");c.h(a,new AbortController).then(h=>{this._updateDiff(h.data,t)}).catch(h=>{h&&this.fire(new c.j(h))})}else typeof m=="object"&&this._updateDiff(m,t)}_updateDiff(m,t){try{this.style.setState(m,t)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(m,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(m,t){return this._lazyInitEmptyStyle(),this.style.addSource(m,t),this._update(!0)}isSourceLoaded(m){const t=this.style&&this.style.sourceCaches[m];if(t!==void 0)return t.loaded();this.fire(new c.j(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const t=this.style.sourceCaches[m.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const h=this.style._layers[a];h.type==="hillshade"&&h.source===m.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Pu(this.painter,t,m),this.painter.renderToTexture=new Ed(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==m.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:m})),this}getTerrain(){var m,t;return(t=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const t in m){const a=m[t]._tiles;for(const h in a){const d=a[h];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,t,a={}){const{pixelRatio:h=1,sdf:d=!1,stretchX:f,stretchY:b,content:T,textFitWidth:k,textFitHeight:I}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:z,data:N}=t,H=t;return this.style.addImage(m,{data:new c.R({width:E,height:z},new Uint8Array(N)),pixelRatio:h,stretchX:f,stretchY:b,content:T,textFitWidth:k,textFitHeight:I,sdf:d,version:0,userImage:H}),H.onAdd&&H.onAdd(this,m),this}}{const{width:E,height:z,data:N}=L.getImageData(t);this.style.addImage(m,{data:new c.R({width:E,height:z},N),pixelRatio:h,stretchX:f,stretchY:b,content:T,textFitWidth:k,textFitHeight:I,sdf:d,version:0})}}updateImage(m,t){const a=this.style.getImage(m);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=t instanceof HTMLImageElement||c.b(t)?L.getImageData(t):t,{width:d,height:f,data:b}=h;if(d===void 0||f===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||f!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(t instanceof HTMLImageElement||c.b(t));return a.data.replace(b,T),this.style.updateImage(m,a),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return W.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,t){return this._lazyInitEmptyStyle(),this.style.addLayer(m,t),this._update(!0)}moveLayer(m,t){return this.style.moveLayer(m,t),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,t,a){return this.style.setLayerZoomRange(m,t,a),this._update(!0)}setFilter(m,t,a={}){return this.style.setFilter(m,t,a),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,t,a,h={}){return this.style.setPaintProperty(m,t,a,h),this._update(!0)}getPaintProperty(m,t){return this.style.getPaintProperty(m,t)}setLayoutProperty(m,t,a,h={}){return this.style.setLayoutProperty(m,t,a,h),this._update(!0)}getLayoutProperty(m,t){return this.style.getLayoutProperty(m,t)}setGlyphs(m,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,t,a,h=>{h||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,t,a=>{a||this._update(!0)}),this}setLight(m,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(m){return this._lazyInitEmptyStyle(),this.style.setSky(m),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,t){return this.style.setFeatureState(m,t),this._update()}removeFeatureState(m,t){return this.style.removeFeatureState(m,t),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,t=0;return this._container&&(m=this._container.clientWidth||400,t=this._container.clientHeight||300),[m,t]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const t=this._canvasContainer=B.create("div","maplibregl-canvas-container",m);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=B.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),h=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],h);const d=this._controlContainer=B.create("div","maplibregl-control-container",m),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{f[b]=B.create("div",`maplibregl-ctrl-${b} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,t,a){this._canvas.width=Math.floor(a*m),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",h=>{t={requestedAttributes:m},h&&(t.statusMessage=h.statusMessage,t.type=h.type)},{once:!0});const a=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!a){const h="Failed to initialize WebGL";throw t?(t.message=h,new Error(JSON.stringify(t))):new Error(h)}this.painter=new kl(a,this.transform),se.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,f=L.now();this.style.zoomHistory.update(d,f);const b=new c.z(d,{now:f,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=b.crossFadingFactor();T===1&&T===this._crossFadingFactor||(a=!0,this._crossFadingFactor=T),this.style.update(b)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),B.remove(this._canvasContainer),B.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,L.frameAsync(this._frameRequest).then(m=>{c.bf.frame(m),this._frameRequest=null,this._render(m)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return zd}getCameraTargetElevation(){return this.transform.elevation}},v.MapMouseEvent=Ui,v.MapTouchEvent=Os,v.MapWheelEvent=kd,v.Marker=Bl,v.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),h=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,a)=>{const h=this._map._getUIString(`NavigationControl.${a}`);t.title=h,t.setAttribute("aria-label",h)},this.options=c.e({},um,m),this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),B.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),B.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=B.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new hm(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){B.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,t){const a=B.create("button",m,this._container);return a.type="button",a.addEventListener("click",t),a}},v.Popup=class extends c.E{constructor(m){super(),this.remove=()=>(this._content&&B.remove(this._content),this._container&&(B.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=B.create("div","maplibregl-popup",this._map.getContainer()),this._tip=B.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Kt(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!t)return;const h=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let d=this.options.anchor;const f=Ol(this.options.offset);if(!d){const T=this._container.offsetWidth,k=this._container.offsetHeight;let I;I=h.y+f.bottom.y<k?["top"]:h.y>this._map.transform.height-k?["bottom"]:[],h.x<T/2?I.push("left"):h.x>this._map.transform.width-T/2&&I.push("right"),d=I.length===0?"bottom":I.join("-")}let b=h.add(f[d]);this.options.subpixelPositioning||(b=b.round()),B.setTransform(this._container,`${Ca[d]} translate(${b.x}px,${b.y}px)`),Rl(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(ht),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=c.N.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const t=document.createDocumentFragment(),a=document.createElement("body");let h;for(a.innerHTML=m;h=a.firstChild,h;)t.appendChild(h);return this.setDOMContent(t)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=B.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}_createCloseButton(){this.options.closeButton&&(this._closeButton=B.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Fl);m&&m.focus()}},v.RasterDEMTileSource=ni,v.RasterTileSource=Lt,v.ScaleControl=class{constructor(m){this._onMove=()=>{Lo(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Lo(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ar),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){B.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=cr,v.Style=cl,v.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=B.create("button","maplibregl-ctrl-terrain",this._container),B.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){B.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=Eo,v.TwoFingersTouchRotateHandler=wu,v.TwoFingersTouchZoomHandler=vu,v.TwoFingersTouchZoomRotateHandler=Su,v.VectorTileSource=ho,v.VideoSource=sa,v.addSourceType=(m,t)=>c._(void 0,void 0,void 0,function*(){if(mo(m))throw new Error(`A source type called "${m}" already exists.`);((a,h)=>{fo[a]=h})(m,t)}),v.clearPrewarmedResources=function(){const m=Pi;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Ni),Pi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return Tr().getRTLTextPluginStatus()},v.getVersion=function(){return Mu},v.getWorkerCount=function(){return un.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(m){return uo().broadcast("IS",m)},v.prewarm=function(){Cs().acquire(Ni)},v.setMaxParallelImageRequests=function(m){c.a.MAX_PARALLEL_IMAGE_REQUESTS=m},v.setRTLTextPlugin=function(m,t){return Tr().setRTLTextPlugin(m,t)},v.setWorkerCount=function(m){un.workerCount=m},v.setWorkerUrl=function(m){c.a.WORKER_URL=m}});var x=o;return x})})(ET);var zD=ET.exports;const Tp=CC(zD),Rn={initialZoom:16.5,startCenter:[72.8322,18.927],style:"https://api.maptiler.com/maps/019b6fe6-78c4-7dcb-b6eb-fed1b18171df/style.json?key=f0f0aibL2C05fTzSrqHq",colors:{"Art Deco":"#2a9d8f",Victorian:"#e76f51",Modern:"#00cec9","Indo-Saracenic":"#b33939",Neoclassical:"#8e44ad","Public Space":"#27ae60",Lettering:"#e84393","Ghost Site":"#95a5a6","Street Furniture":"#57606f","Living Heritage":"#f39c12","Street Sign":"#3742fa",Vernacular:"#d35400","Urban Texture":"#8d6e63"},icons:{"Art Deco":"fa-building",Victorian:"fa-landmark",Modern:"fa-square","Indo-Saracenic":"fa-gopuram",Neoclassical:"fa-columns","Public Space":"fa-tree",Lettering:"fa-font","Ghost Site":"fa-ghost","Street Furniture":"fa-road","Living Heritage":"fa-users","Street Sign":"fa-sign-hanging",Vernacular:"fa-home","Urban Texture":"fa-cubes"}},$g=[{id:"wellington",category:"Neoclassical",title:"Wellington Fountain",image:"https://upload.wikimedia.org/wikipedia/commons/0/0b/Wellington_fountain_with_the_MH_Police_HQ_in_background%2C_Mumbai.jpg",description:"Built to commemorate the Duke of Wellingtons visits to Bombay. It is the only fountain in the city built in the Neoclassical style.",year:"1865",architect:"Gen. Barr / Sir George Gilbert Scott",builder:"Public Subscription",location:{center:[72.832344,18.925439]}},{id:"ins-vikrant",category:"Street Furniture",title:"INS Vikrant Memorial",image:"./images/ins-vikrant.jpg",description:"A detailed scale model of India's first aircraft carrier, INS Vikrant (R11), installed at Regal Circle as a tribute to the Indian Navy.",year:"2022",architect:"Indian Navy",builder:"Public Installation",location:{center:[72.832673,18.9258]}},{id:"vbgandhi-sign",category:"Street Sign",title:"V.B. Gandhi Marg Sign",image:"./images/vb-gandhi-marg.jpg",description:"A classic blue enamel hanging street sign marking the entrance to V.B. Gandhi Marg (formerly Forbes Street).",year:"1990",architect:"BMC",builder:"Municipal Corp",location:{center:[72.831972,18.92825]}},{id:"forbes-sign",category:"Street Sign",title:"Forbes Street Sign",image:"./images/forbes-street.jpg",description:'A rare bilingual street sign bearing the colonial name "Forbes Street" (now V.B. Gandhi Marg).',year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.832056,18.92825]}},{id:"regal",category:"Art Deco",title:"Regal Cinema",image:"./images/regal.jpg",description:"One of the earliest Art Deco cinemas in India.",year:"1933",architect:"Charles Stevens",builder:"Framji Sidhwa",location:{center:[72.83245,18.92455]}},{id:"police-hq",category:"Victorian",title:"Police Headquarters",image:"https://upload.wikimedia.org/wikipedia/commons/0/0e/Maharashtra_Police_Headquarters.jpg",description:"Formerly the Royal Alfred Sailors Home. A masterpiece of Gothic architecture.",year:"1876",architect:"F.W. Stevens",builder:"Govt. of Bombay",location:{center:[72.83334037487425,18.92524244911638]}},{id:"majestic",category:"Indo-Saracenic",title:"Majestic Aamdar Niwas",image:"https://upload.wikimedia.org/wikipedia/commons/c/cb/Majestic_MLA_Hostel_Mumbai_by_Dr._Raju_Kasambe_DSCN0428_(28).jpg",description:"Formerly the Majestic Hotel. An Indo-Saracenic gem now used as a hostel for legislators.",year:"1909",architect:"W.A. Chambers",builder:"Private",location:{center:[72.8318474719337,18.9246768777787]}},{id:"mercantile",category:"Indo-Saracenic",title:"Indian Mercantile Mansion",image:"https://upload.wikimedia.org/wikipedia/commons/4/48/Indian_Mercantile_Mansion%2C_Colaba%2C_Mumbai_as_seen_from_Madame_Cama_Road.jpg",description:"Also known as Waterloo Mansions. A grand residential building with Gothic arches.",year:"1900",architect:"Unknown",builder:"Private",location:{center:[72.83188959451451,18.924916574206417]}},{id:"science",category:"Indo-Saracenic",title:"Institute of Science",image:"https://upload.wikimedia.org/wikipedia/commons/b/bb/Entrance_of_the_Institute_of_Science%2C_Fort%2C_Mumbai.jpg",description:"A majestic Indo-Saracenic building built using yellow Kharodi basalt.",year:"1920",architect:"George Wittet",builder:"Govt. of Bombay",location:{center:[72.83025908124948,18.926175121968605]}},{id:"ngma",category:"Indo-Saracenic",title:"NGMA (Cowasji Jehangir Hall)",image:"https://upload.wikimedia.org/wikipedia/commons/6/6c/Sir_Cowasji_Jehangir_Hall_Front.jpg",description:"Originally the Cowasji Jehangir Public Hall, now the National Gallery of Modern Art.",year:"1911",architect:"George Wittet",builder:"Sir Cowasji Jehangir",location:{center:[72.83156173339212,18.925786832066194]}},{id:"museum",category:"Indo-Saracenic",title:"CSMVS Museum",image:"./images/csmvs.jpg",description:"Indo Saracenic landmark constructed using grey Kurla basalt. Formerly the Prince of Wales Museum.",year:"1914",architect:"George Wittet",builder:"Govt. of Bombay",location:{center:[72.83222,18.92666]}},{id:"buddha-sculpture",category:"Street Furniture",title:"The Buddhas Within",image:"./images/buddha-head.jpg",description:"A monumental copper sculpture by Satish Gupta. The serene head reveals a hollow cave-like interior housing a sleeping Buddha and 1,500 miniature figures.",year:"2016",architect:"Satish Gupta",builder:"CSMVS/Private",location:{center:[72.831722,18.926611]}},{id:"cama",categories:["Indo-Saracenic","Lettering"],title:"K.R. Cama Oriental Institute",images:["https://upload.wikimedia.org/wikipedia/commons/b/b8/The_K.R._Cama_Oriental_Institute_in_Fort%2C_Mumbai.jpg","./images/camal.jpg"],description:"A premier institute for Indology and Persian studies, inaugurated in 1916. The building features elegant Indo-Saracenic arches and a distinctive stone-carved nameplate above the entrance.",year:"1916",architect:"Unknown",builder:"Sukhadwala Family",location:{center:[72.833709,18.927298]}},{id:"lions-gate",category:"Victorian",title:"Lions Gate",image:"https://upload.wikimedia.org/wikipedia/commons/5/5d/Naval_Dockyard_Mumbai.jpg",description:"The main entrance to the Naval Dockyard, guarded by two stone lions.",year:"1890",architect:"Royal Navy",builder:"Bombay Dockyard",location:{center:[72.83421608761844,18.926268371527307]}},{id:"dockyard-vane",category:"Urban Texture",title:"Naval Weather Vane",image:"./images/dockyard-weather-vane.png",description:"A classic rooster weather vane perched atop a red-domed cupola within the Naval Dockyard complex, a functional and decorative maritime detail.",year:"Unknown",architect:"Royal Navy",builder:"Bombay Dockyard",location:{center:[72.833861,18.927833]}},{id:"vikrant-sculpture",category:"Street Furniture",title:"INS Vikrant Sculpture",image:"./images/naval-artifact.jpg",description:"A modern sculpture created from the metal scraps of the dismantled INS Vikrant (1961), serving as a memorial to Indias first aircraft carrier.",year:"2016",architect:"Arzan Khambatta",builder:"Indian Navy",location:{center:[72.83355,18.92666]}},{id:"bnhs",category:"Lettering",title:"BNHS (Hornbill House)",image:"https://upload.wikimedia.org/wikipedia/commons/7/73/BNHS_Office_by_Raju_KasambeDSCN7078_(7)_05.jpg",description:"Headquarters of the Bombay Natural History Society.",year:"1965",architect:"Unknown",builder:"BNHS",location:{center:[72.8332718521053,18.92623514458551]}},{id:"standrews",category:"Neoclassical",title:"St. Andrews Cathedral",image:"https://upload.wikimedia.org/wikipedia/commons/8/81/A_heritage_structure_of_early_19th_century.jpg",description:"A Scottish Presbyterian church with a classic steeple.",year:"1819",architect:"Thomas Dadford",builder:"Scottish Community",location:{center:[72.83370123061556,18.92693820553702]}},{id:"elphinstone",category:"Victorian",title:"Elphinstone College",image:"./images/elphinstone.jpg",description:"Victorian Gothic Revival building with pointed arches.",year:"1871",architect:"James Trubshawe",builder:"Sir Cowasji Jehangir",location:{center:[72.83083411935105,18.92497448499293]}},{id:"rhythm",categories:["Ghost Site","Lettering"],title:"Rhythm House",images:["https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Rhythm_House_(14427838921).jpg/1024px-Rhythm_House_(14427838921).jpg","./images/rhythm-house-lettering.jpg"],description:"Formerly the city's premier music store. The iconic Art Deco typography was synonymous with Mumbai's music culture for decades.",year:"1940s",architect:"Unknown",builder:"Mehmood Curmally",location:{center:[72.832123,18.928066]}},{id:"jehangir",category:"Modern",title:"Jehangir Art Gallery",image:"./images/jehangir.jpg",description:"Modernist concrete structure with a distinctive cantilevered entrance.",year:"1952",architect:"G. M. Bhuta",builder:"Sir Cowasji Jehangir",location:{center:[72.83185,18.92745]}},{id:"ador",categories:["Art Deco","Lettering"],title:"Ador House",images:["./images/ador-house-building.jpg","./images/ador-house-lettering.jpg"],description:'A mid-20th century structure blending commercial utility with Art Deco, featuring a stone facade and bracketed wooden eaves. The "ADOR HOUSE" lettering is rendered in clean, sans-serif metal relief above the entrance arcade.',year:"1940",architect:"Unknown",builder:"JB Advani Group",location:{center:[72.833167,18.927]}},{id:"mmb",category:"Modern",title:"Max Mueller Bhavan",image:"./images/placeholder.jpg",description:"The Goethe-Institut hub for Indo-German cultural exchange.",year:"1970",architect:"N/A",builder:"Goethe Institut",location:{center:[72.8325,18.92725]}},{id:"pavement",category:"Living Heritage",title:"The Pavement Gallery",image:"./images/pavement-gallery.jpg",description:"An informal exhibition space where aspiring artists display their work.",year:"2025",architect:"The People",builder:"Informal Usage",location:{center:[72.8315,18.927028]}},{id:"sassoon",category:"Victorian",title:"David Sassoon Library",image:"./images/sassoon.jpg",description:"Victorian Gothic architecture defined by pointed arches and a tranquil garden.",year:"1870",architect:"Campbell & Gosling",builder:"Scott McClelland",location:{center:[72.83116,18.92772]}},{id:"bhogilal",category:"Victorian",title:"Bhogilal Hargovindas",image:"./images/bhogilal-lettering.jpg",description:'A heritage commercial building on K. Dubash Marg featuring colonial stonework, clear signage, and an ornate wrought iron entrance grille with the monogram "FSP".',year:"1890",architect:"Unknown",builder:"Merchant Family",location:{center:[72.8319,18.9276]}},{id:"statue",category:"Street Furniture",title:"Kala Ghoda Statue",image:"./images/placeholder.jpg",description:"Bronze statue installed to mark the historic site.",year:"2017",architect:"Commissioned artwork",builder:"Kala Ghoda Association",location:{center:[72.8318,18.9278]}},{id:"ropewalk-paving",category:"Urban Texture",title:"Rope Walk Lane Paving",image:"./images/ropewalk-paving.jpg",description:"New basalt stone paving installed in 2025, transforming Rope Walk Lane into a dedicated pedestrian path on weekends.",year:"2025",architect:"Unknown",builder:"BMC",location:{center:[72.832306,18.928583]}},{id:"heritage-paving",category:"Urban Texture",title:"Historic Basalt Paving",image:"./images/stone-paving.jpg",description:"Remnants of the original heavy rectangular basalt stone paving that once lined many of the Fort precinct's streets, providing a durable surface for carriages and trams.",year:"Unknown",architect:"City Engineers",builder:"Public Works",location:{center:[72.832333,18.928806]}},{id:"synagogue",categories:["Victorian","Lettering"],title:"Keneseth Eliyahoo",images:["./images/synagogue.jpg","./images/synagogue-lettering.jpg"],description:'Victorian era synagogue with a distinctive blue facade. The Hebrew inscription above the entrance reads: "This is the gate of the Lord; the righteous shall enter through it" (Psalm 118:20).',year:"1884",architect:"Gostling & Morris",builder:"Jacob Elias Sassoon",location:{center:[72.83257,18.92811]}},{id:"numbered-sign",category:"Lettering",title:"52-54-56 Signage",image:"./images/numbered-sign.jpg",description:'A distinctive metal building number sign "52-54-56" mounted against a backdrop of contemporary street art featuring a stylized bird.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832556,18.928222]}},{id:"homji-street",category:"Street Sign",title:"Homji Street Sign",image:"./images/homji-street-sign.jpg",description:"Weathered bilingual street sign in English and Hindi, mounted on stone steps. A classic example of Mumbai's historic street signage.",year:"Unknown",architect:"BMC",builder:"BMC",location:{center:[72.835056,18.932722]}},{id:"rk-laxman",category:"Street Furniture",title:"R.K. Laxman's Common Man Sculpture",image:"./images/rk-laxman-sculpture.jpg",description:`Bronze sculpture depicting cartoonist R.K. Laxman's iconic "Common Man" character facing a bull, installed as a tribute to the legendary artist and his satirical commentary on Indian society.`,year:"2014",architect:"Ram V. Sutar",builder:"Kala Ghoda Association",location:{center:[72.834194,18.931778]}},{id:"oricon",category:"Modern",title:"Oricon House",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Mumbai_Skyline_at_Night.jpg/800px-Mumbai_Skyline_at_Night.jpg",description:"A mid-century modern commercial high-rise.",year:"1960",architect:"Unknown",builder:"Oricon Enterprises",location:{center:[72.8322,18.9279]}},{id:"civil-court",category:"Victorian",title:"Old Secretariat (City Court)",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Mumbai_City_Civil_and_Sessions_Court_as_seen_from_Oval_Maidan.jpg/1280px-Mumbai_City_Civil_and_Sessions_Court_as_seen_from_Oval_Maidan.jpg",description:"One of the earliest Venetian Gothic buildings in the city.",year:"1874",architect:"Col. H. St. Clair Wilkins",builder:"Public Works Dept",location:{center:[72.8302,18.9275]}},{id:"university",category:"Victorian",title:"University of Mumbai",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/University_of_Mumbai_Fort_Campus.jpg/800px-University_of_Mumbai_Fort_Campus.jpg",description:"The Fort campus features Venetian Gothic architecture including the Convocation Hall.",year:"1874",architect:"Sir Gilbert Scott",builder:"Cowasji Jehangir",location:{center:[72.8305,18.9284]}},{id:"university-facade",category:"Victorian",title:"University Library Turret",image:"./images/university-turret.jpg",description:"A close-up view of the Venetian Gothic stonework on the University Library. Designed by Sir George Gilbert Scott, the structure uses local Kurla basalt and Malad stone.",year:"1878",architect:"Sir Gilbert Scott",builder:"Premchand Roychand",location:{center:[72.831194,18.928833]}},{id:"jehangir-building",categories:["Victorian","Lettering"],title:"Jehangir Building",images:["./images/jehangir-building.jpg","./images/jehangir-lettering.jpg"],description:'A handsome stone facade building on Mahatma Gandhi Road featuring arched windows and decorative iron balconies. The name "JEHANGIR BUILDING" is rendered in bold relief lettering across the facade.',year:"1890",architect:"Unknown",builder:"Private",location:{center:[72.83125,18.928833]}},{id:"rajabai",category:"Victorian",title:"Rajabai Clock Tower",image:"./images/rajabai.jpg",description:"Modeled on Big Ben, this 85m tower dominates the skyline.",year:"1878",architect:"Sir Gilbert Scott",builder:"Premchand Roychand",location:{center:[72.8302,18.9288]}},{id:"new-india",category:"Art Deco",title:"New India Assurance Building",image:"./images/new-india-assurance.jpg",description:'A monumental Art Deco structure designed by Master, Sathe & Bhuta. The facade features colossal relief sculptures by N.G. Pansare representing "Protection" and "Prosperity".',year:"1937",architect:"Master, Sathe & Bhuta",builder:"Sir Dorabji Tata",location:{center:[72.831167,18.930111]}},{id:"oval",category:"Public Space",title:"Oval Maidan",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Oval_Maidan%2C_Mumbai.jpg/1024px-Oval_Maidan%2C_Mumbai.jpg",description:"A Grade I heritage open precinct.",year:"1860",architect:"N/A",builder:"City Planner",location:{center:[72.8295,18.928]}},{id:"army",categories:["Victorian","Lettering"],title:"Army and Navy Building",images:["./images/army-navy.jpg","./images/army-lettering.jpg"],description:'Late nineteenth century Neo-Classical/Victorian commercial building. The iconic "ARMY & NAVY BUILDING" serif lettering is rendered in silver against the dark stone facade.',year:"1890",architect:"Frederick William Stevens",builder:"British Military",location:{center:[72.8313,18.9282]}},{id:"esplanade",category:"Victorian",title:"Esplanade Mansion",image:"./images/esplanade.jpg",description:"Formerly Watson's Hotel. Cast iron framed building.",year:"1865",architect:"Rowland Mason Ordish",builder:"British Engineers",location:{center:[72.8316,18.9283]}},{id:"lumiere",category:"Ghost Site",title:"Lumire Film Screening",image:"https://upload.wikimedia.org/wikipedia/commons/2/25/Watson%27s_Hotel_1880s.jpg",description:"On July 7, 1896, the Lumire Brothers showcased the first-ever motion pictures in India here at the former Watsons Hotel.",year:"1896",architect:"N/A",builder:"Marius Sestier",location:{center:[72.83165,18.92835]}},{id:"sassoon-bldg",category:"Lettering",title:"Sassoon Building No. 3",image:"./images/sassoon-bldg.jpg",description:"Classic hand-painted building signage located at 27 Burjorji Bharucha Marg. Currently houses the Government of Maharashtra Gazetteers Department.",year:"Unknown",architect:"Unknown",builder:"David Sassoon & Co.",location:{center:[72.831778,18.928638]}},{id:"gazetteer-sign",category:"Lettering",title:"Gazetteer Dept Sign",image:"./images/gazetteer-sign.jpg",description:'A weathered black and white wooden signboard for the "Gazetteers Department of Govt. of Maharashtra", located at the entrance of the historic Sassoon Building.',year:"Unknown",architect:"Govt of Maharashtra",builder:"PWD",location:{center:[72.831795,18.928655]}},{id:"best-sign",category:"Street Sign",title:"BEST Sub-Station Sign",image:"./images/best-sign.jpg",description:"A standard red enamel sign marking the local electrical sub-station for B. Bharucha Marg (formerly Dean Lane).",year:"Unknown",architect:"BEST Undertaking",builder:"Municipal Corp",location:{center:[72.831833,18.928611]}},{id:"heritage-corner",category:"Vernacular",title:"Heritage Corner Facade",image:"./images/bombay-shirt-co.jpg",description:"A striking corner building with a weathered grey facade, recurrent arched windows, and wooden shutters. A classic example of the precinct's unpolished heritage texture.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832306,18.928583]}},{id:"vardhan-chowk",category:"Street Sign",title:"Shri. Kishorchandra M. Vardhan Chowk",image:"./images/vardhan-chowk.jpg",description:'A municipal street sign designating the junction as "Shri. Kishorchandra M. Vardhan Chowk", honoring a local figure.',year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.832972,18.928361]}},{id:"alkesh-mody",category:"Street Sign",title:"Alkesh Dinesh Mody Marg",image:"./images/alkesh-mody.jpg",description:"A prominent street sign named after the dynamic stockbroker Alkesh Dinesh Mody. The street was historically a key business lane in the Fort area.",year:"1994",architect:"BMC",builder:"Municipal Corp",location:{center:[72.834139,18.929611]}},{id:"techno-heritage",category:"Vernacular",title:"Techno Heritage",image:"./images/techno-heritage.jpg",description:"A distinctively geometric building with Art Deco influences, featuring symmetrical bays, louvred shutters, and patterned balcony railings. Originally a residential structure adapted for commercial use.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832167,18.929778]}},{id:"cercle-litteraire",category:"Ghost Site",title:"Cercle Littraire (Jatia Chambers)",image:"./images/jatia-chambers.jpg",description:'Housed the French library "Cercle Littraire" on the third floor, opened in 1886 by Sir Dinshaw Petit. A cultural landmark for over a century, it closed around 2022/23.',year:"1886",architect:"Unknown",builder:"Sir Dinshaw Petit",location:{center:[72.832194,18.928278]}},{id:"botawala-sign",category:"Lettering",title:"Botawala Building Sign",image:"./images/botawala-bldg.jpg",description:"Old hand-painted wooden signage for 71/73 Botawala Building.",year:"Unknown",architect:"Unknown",builder:"HIMS Botawala Charities Trust",location:{center:[72.834194,18.929556]}},{id:"rural-relief",category:"Urban Texture",title:"Stone Relief of Rural Life",image:"./images/rural-relief-pillar.jpg",description:"A detailed stone relief carving on a building pillar depicting stylized figures engaged in rural agricultural tasks.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.831417,18.930917]}},{id:"wayside",category:"Ghost Site",title:"Wayside Inn",image:"./images/wayside.jpg",description:"Now the Khyber restaurant. Famous quaint tea room.",year:"1920",architect:"N/A",builder:"Historic Site",location:{center:[72.8317,18.9286]}},{id:"kgc",category:"Living Heritage",title:"Kala Ghoda Caf",image:"./images/kgcafe.png",description:"A modern institution in a heritage shell, known for its sustainable architecture.",year:"2009",architect:"N/A",builder:"Private",location:{center:[72.8327318856248,18.92716499313838]}},{id:"horse-mural",category:"Living Heritage",title:"Street Art Mural",image:"./images/horse-mural.jpg",description:'A contemporary street art mural featuring a galloping horse and the word "HEAL", painted on a compound wall.',year:"Unknown",architect:"Unknown",builder:"Street Artist",location:{center:[72.833083,18.927639]}},{id:"commerce-house",category:"Lettering",title:"Commerce House Gate",image:"./images/commerce-house.jpg",description:"Art Deco style lettering integrated directly into the wrought iron gate design.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832833,18.928472]}},{id:"british-engg",category:"Lettering",title:"British Engineering Co.",image:"./images/british-engg.jpg",description:`Faded signage for "British Engineering Co.", distributors for Bharat Bijlee, NGEF, and other industrial giants. A reminder of the area's engineering trading roots.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833917,18.928472]}},{id:"sibambai-mural",category:"Living Heritage",title:"Si Bambai Mural",image:"./images/sibambai-mural.jpg",description:"A large mural on the facade of Si Bambai, a visual and performance art space supporting independent and emerging artists.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833944,18.9285]}},{id:"great-western",category:"Neoclassical",title:"Great Western Building",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/Great_Western_Building%2C_Mumbai.jpg/640px-Great_Western_Building%2C_Mumbai.jpg",description:"Originally the Admiralty House (1770s).",year:"1770",architect:"Unknown",builder:"British Admiralty",location:{center:[72.8329,18.9285]}},{id:"new-era",category:"Lettering",title:"New Era Engineering Co.",image:"./images/new-era.jpg",description:"A specialized engineering supply store established in 1981, known for its distinctive red block lettering signage featuring heritage industrial logos.",year:"1981",architect:"N/A",builder:"New Era Engineering Co.",location:{center:[72.83262,18.9289]}},{id:"sheraton-co",category:"Lettering",title:"Sheraton & Co.",image:"./images/sheraton-co.jpg",description:'Faded vintage signage for "Sheraton & Co. - The Accepted Name for Quality Furniture Fittings". A relic of the old made-to-order furniture trade.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832667,18.928833]}},{id:"modern-machines",category:"Lettering",title:"Modern Machines (India)",image:"./images/modern-machines.jpg",description:"Hand-painted commercial signage at 129 Nagindas Master Road, featuring detailed technical illustrations of industrial lathe machines, drills, and presses.",year:"Unknown",architect:"N/A",builder:"Private",location:{center:[72.83271,18.92876]}},{id:"jaydeep-engg",category:"Lettering",title:"Jaydeep Engg. Co.",image:"./images/jaydeep-engg.jpg",description:"Hand-painted industrial signage featuring detailed technical illustrations of pumps, motors, and generators, reflecting the engineering trade history of the street.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832528,18.929056]}},{id:"other-horse",category:"Street Furniture",title:'The "Other" Black Horse',image:"./images/black-horse-small.jpg",description:'A lesser-known, smaller black horse statue located in a garden patch near the British Engineering Company buildings. Distinct from the famous "Spirit of Kala Ghoda" in the main precinct.',year:"Unknown",architect:"Unknown",builder:"Private Installation",location:{center:[72.833944,18.928361]}},{id:"bandukwala",category:"Vernacular",title:"Bandukwala Building",image:"./images/bandukwala.jpg",description:'A handsome heritage building featuring arched windows with decorative keystones and intricate pilasters, now housing legal chambers. Home to the "CS Legal" offices.',year:"Unknown",architect:"Unknown",builder:"Bandukwala Family",location:{center:[72.833583,18.928917]}},{id:"sewing-mural",category:"Living Heritage",title:"Sewing Machine Mural",image:"./images/sewing-mural.jpg",description:"A whimsical large-scale mural by artist Shashi, depicting a vintage sewing machine intertwining with nature (#stitchinglivestogether). Located above a fashion boutique.",year:"Unknown",architect:"Shashi",builder:"Private",location:{center:[72.833861,18.928972]}},{id:"ice-cream-mural",category:"Living Heritage",title:"Ice Cream Mural",image:"./images/ice-cream-mural.jpg",description:"A vibrant, retro-styled street art mural featuring a pin-up figure and colorful ice cream motifs, located near Valliyan. A popular backdrop that adds to the artistic pulse of the Kala Ghoda precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832389,18.92825]}},{id:"artisans-mural",category:"Living Heritage",title:"Artisans Gallery Facade",image:"./images/artisans-mural.jpg",description:"A striking monochromatic mural with yellow accents covering the facade of Artisans Gallery. The artwork celebrates craftsmanship, depicting hands engaged in pottery, painting, and other traditional arts.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.83242,18.92828]}},{id:"jatin-malik-mural",category:"Living Heritage",title:"Spirit of Kala Ghoda Mural",image:"./images/jatin-malik-mural.jpg",description:'A vibrant mural on the yellow facade of the Jatin Malik store, featuring a stylized, colorful horse in motiona direct artistic homage to the "Kala Ghoda" (Black Horse) identity of the precinct.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832139,18.928278]}},{id:"sopara-mural",category:"Living Heritage",title:"Ancient Trade Route Mural",image:"./images/sopara-mural.jpg",description:'A detailed vertical tile mural titled "Berenike - Anchored in Ancient Trade - Sopara", illustrating the historic maritime connection between Egypt (Berenike) and the ancient port of Sopara near Mumbai.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.8338,18.927283]}},{id:"mehta-house",category:"Lettering",title:"Mehta House Signage",image:"./images/mehta-house.jpg",description:"Features striking 3D shadow-effect lettering typical of the mid-20th century commercial art style.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833833,18.929194]}},{id:"east-west",category:"Lettering",title:"East & West Building",image:"./images/east-west.jpg",description:"Heritage stone inscription on the facade of the East & West Insurance Building.",year:"Unknown",architect:"Unknown",builder:"East & West Insurance Co.",location:{center:[72.833583,18.929972]}},{id:"ring-co",categories:["Lettering","Ghost Site"],title:"Ghost Signage (Ring Co.)",image:"./images/ring-co.jpg",description:'A fragmented sign reading "...RING CO." visible above the Bhaveshwar Copy Center, hinting at a former industrial or engineering tenant.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.8339,18.9303]}},{id:"vernacular-facade",category:"Vernacular",title:"Late 19th Century Vernacular Facade",image:"./images/wooden-facade.jpg",description:"A rare partially-preserved example of the vernacular architectural style once common in Fort. Features intricate wooden jali balconies and corbelled brackets.",year:"Unknown",architect:"Unknown",builder:"Local Craftsmen",location:{center:[72.8325,18.929194]}},{id:"wooden-terraces",category:"Vernacular",title:"Vernacular Wooden Terraces",image:"./images/wooden-terraces.jpg",description:"A striking multi-story wooden facade featuring deep cantilevered balconies, decorative railings, and support brackets, housing the Kalamkari Design Studio.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.834,18.931278]}},{id:"ornate-window",category:"Urban Texture",title:"Ornate Window Grille",image:"./images/ornate-window.jpg",description:"A beautifully preserved window featuring complex geometric metal or wood work, representing the residential architectural fabric of the precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833111,18.928417]}},{id:"marine-diesel",category:"Lettering",title:"Marine Diesel Signage",image:"./images/marine-diesel.jpg",description:'Comprehensive hand-painted trade signage for "Marine Diesel Engines & Spares" at Kirti Building, listing heritage mechanical brands like Lister, Ruston, and Kirloskar.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833194,18.928417]}},{id:"gujerat-mill",category:"Lettering",title:"The Gujerat Mill Store",image:"./images/gujerat-mill.jpg",description:'Distinctive mid-century corporate signage featuring a stylized "G" logo and metal lettering on a textured plaster facade.',year:"Unknown",architect:"N/A",builder:"Private",location:{center:[72.833139,18.928389]}},{id:"rampart-chowky",category:"Victorian",title:"Rampart Beat Chowky",image:"./images/rampart-chowky.jpg",description:"A small stone police outpost with heritage architectural details, including a cornice and stone brackets, guarding the entrance to Rampart Row.",year:"Unknown",architect:"Public Works Dept",builder:"Govt. of Bombay",location:{center:[72.832361,18.9275]}},{id:"allahabad-bank",category:"Neoclassical",title:"Allahabad Bank Building",image:"./images/allahabad-bank.jpg",description:"A grand Neo-Classical banking hall (now Indian Bank) featuring a prominent corner entrance, Corinthian pilasters, and heavy stone detailing.",year:"Unknown",architect:"Unknown",builder:"Allahabad Bank",location:{center:[72.834,18.93125]}},{id:"sbi-fort",category:"Neoclassical",title:"SBI Main Branch (Fort)",image:"./images/sbi-fort-branch.jpg",description:"A massive colonial-era banking structure with colossal Ionic columns and a pedimented entrance, originally the Imperial Bank of India.",year:"1924",architect:"Unknown",builder:"Imperial Bank",location:{center:[72.834,18.931306]}},{id:"sbi-roman",category:"Lettering",title:"MCMXXIV Date Plaque",image:"./images/sbi-mcmxxiv.jpg",description:"The Roman numeral MCMXXIV (1924) carved in bold relief gold-painted serif lettering on the stone entablature, marking the buildings completion year.",year:"1924",architect:"Unknown",builder:"Imperial Bank",location:{center:[72.834028,18.931333]}},{id:"a-doshi",categories:["Lettering"],title:"A. Doshi & Co.",images:["./images/a-doshi-sign.jpg"],description:'Classic commercial signage with bold relief lettering, accompanied by a diamond-shaped plaque reading "ESTD 1940".',year:"1940",architect:"Unknown",builder:"Private",location:{center:[72.83375,18.931333]}},{id:"ewart-house",categories:["Lettering","Ghost Site"],title:"Ewart House Lettering",image:"./images/ewart-house.jpg",description:`Carved "EWART HOUSE" lettering on the stone facade above the Central Bank of India. A subtle reminder of the building's identity.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833083,18.931361]}},{id:"bruce-street",categories:["Street Sign","Ghost Site"],title:"Old Bruce Street Sign",images:["./images/bruce-street-sign.jpg"],description:'A rare painted sign for "10, BRUCE STREET" (now Homi Modi Street) preserved on a building facade, a tangible reminder of the areas colonial nomenclature.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833556,18.931417]}},{id:"bse",category:"Modern",title:"Bombay Stock Exchange",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/BSE_-_Bombay_Stock_Exchange_Building.jpg/960px-BSE_-_Bombay_Stock_Exchange_Building.jpg",description:"The Phiroze Jeejeebhoy Towers.",year:"1980",architect:"Chandrakant Patel",builder:"BSE",location:{center:[72.8336,18.9297]}},{id:"dalal-sign-black",category:"Street Sign",title:"Dalal Street Sign (Black)",image:"./images/dalal-street-black.jpg",description:"A classic black cast-iron street sign marking Dalal Street, the financial heart of Mumbai.",year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.833722,18.929722]}},{id:"darda-statue",category:"Street Furniture",title:"Jawaharlal Darda Statue",image:"./images/jawaharlal-darda.jpg",description:'A bronze bust honoring the freedom fighter and journalist Jawaharlal Darda, affectionately known as "Babuji".',year:"Unknown",architect:"Unknown",builder:"Public",location:{center:[72.833778,18.929889]}},{id:"carved-balconies",category:"Vernacular",title:"Ornate Stone Facade",image:"./images/carved-balconies.jpg",description:"A fine example of vernacular architecture featuring intricate stone jaali (lattice) work, heavy masonry brackets, and projecting balconies, characteristic of the mixed-use buildings in old Fort.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833778,18.929972]}},{id:"stone-arches",category:"Vernacular",title:"Stone Arched Facade",image:"./images/islamic-stone-arches.jpg",description:"Distinctive vernacular building featuring scalloped (cusped) stone arches and geometric perforated stone railings.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833833,18.93025]}},{id:"dalal-sign-blue",category:"Street Sign",title:"Dalal Street Sign (Blue)",image:"./images/dalal-street-blue.jpg",description:"A vintage blue enamel street sign for Dalal Street, likely an earlier municipal design.",year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.83375,18.92975]}},{id:"flora",category:"Street Furniture",title:"Flora Fountain",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/dd/Mumbai_03-2016_72_Flora_Fountain.jpg/960px-Mumbai_03-2016_72_Flora_Fountain.jpg",description:"An ornamental fountain at Hutatma Chowk.",year:"1864",architect:"R. Norman Shaw",builder:"Agri-Horticultural Soc",location:{center:[72.8317,18.9323]}},{id:"hutatma",category:"Public Space",title:"Hutatma Smarak (Martyrs Memorial)",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/62/Hutatma_Chowk%2C_Mumbai_-_panoramio_(2).jpg/1280px-Hutatma_Chowk%2C_Mumbai_-_panoramio_(2).jpg",description:"A memorial with a bronze statue of a laborer and a farmer, honoring the 106 martyrs of the Samyukta Maharashtra Samiti who died for the creation of the state.",year:"1961",architect:"Harish Talim",builder:"Govt. of Maharashtra",location:{center:[72.8316,18.93245]}},{id:"tram-tracks",category:"Ghost Site",title:"Tram Tracks",image:"./images/tram-tracks.jpg",description:"The tram tracks, hidden for more than six decades, were discovered during excavation in 2018. Mumbai's tram service began in 1874 and stopped in 1964. While horses were used to pull the trams earlier, they were replaced by electric engines in 1907. The network functioned from Colaba to Pydhonie via Crawford Market. The original tracks have been preserved at their original position.",year:"1874",architect:"BEC",builder:"Bombay Tramway Co.",location:{center:[72.831667,18.932583]}},{id:"central-bank",categories:["Neoclassical","Lettering"],title:"Central Bank of India",images:["./images/central-bank.jpg","./images/central-bank-lettering.jpg"],description:'A grand heritage building established in 1911 as one of the first truly Indian owned banks. The facade features prominent "CENTRAL BANK BUILDING" carved lettering curving around the corner.',year:"1911",architect:"Unknown",builder:"Sir Sorabji Pochkhanawala",location:{center:[72.83175,18.931722]}},{id:"bombay-house",categories:["Neoclassical","Lettering"],title:"Bombay House",images:["./images/bombay-house.jpg","./images/bombay-house-lettering.jpg"],description:'The global headquarters of the Tata Group since 1924. This colonial-era stone building is renowned for its understated elegance and the "BOMBAY HOUSE" gold lettering above the entrance arcade.',year:"1924",architect:"George Wittet",builder:"Tata Group",location:{center:[72.83268,18.931847]}},{id:"fire-hydrant",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/british-fire-hydrant.jpg",description:"A rare cast-iron fire hydrant from the British colonial era, painted bright red. These sturdy relics of civic infrastructure are disappearing but occasionally found on Forts sidewalks.",year:"Unknown",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.832944,18.9315]}},{id:"siddharth-college",category:"Victorian",title:"Siddharth College (Anand Bhavan)",image:"./images/siddharth-college.jpg",description:"A Grade II heritage structure (formerly Albert Building), acquired by Dr. B.R. Ambedkar in 1951 to house the first college of the People's Education Society.",year:"1900",architect:"Unknown",builder:"People's Education Society",location:{center:[72.832389,18.933889]}},{id:"davar-building",category:"Lettering",title:"Davar Building Lettering",image:"./images/davar-building.jpg",description:"Carved stone lettering above an arched entrance passage, exemplifying the bold typography of early 20th century commercial buildings in the Fort area.",year:"1900",architect:"Unknown",builder:"Private",location:{center:[72.831694,18.932222]}},{id:"sunder-woodwork",category:"Lettering",title:"Sunder Woodwork Signage",image:"./images/sunder-woodwork.jpg",description:'Art Deco style signage reading "WOOD SUNDER WORK" with dimensional lettering and a distinctive red outline, located above an arched stone entrance.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.831667,18.93225]}},{id:"cip-building",category:"Neoclassical",title:"ICP Fort Heritage (CIP Building)",image:"./images/cip-building.jpg",description:'A grand heritage building on Nagindas Master Road, originally constructed in 1913. The facade features a prominent pediment with the year "1913" carved in relief, along with decorative cornices and Corinthian-style pilasters. It currently houses the flagship store of fashion designer Sabyasachi.',year:"1913",architect:"Unknown",builder:"Private",location:{center:[72.833428,18.932456]}},{id:"standard-building",category:"Neoclassical",title:"Standard Building",image:"./images/standard-building.jpg",description:"Designed by F.W. Stevens and completed by his son Charles Stevens. A prime example of the Neo-Classical style on D.N. Road, featuring buff-coloured basalt and intricate carvings.",year:"1902",architect:"F.W. Stevens / Charles Stevens",builder:"Standard Life Assurance",location:{center:[72.8321,18.9339]}},{id:"un-pursram",category:"Living Heritage",title:"U.N. Pursram",image:"./images/un-pursram.jpg",description:"A historic department store housed within the Standard Building arcade, serving Mumbai since the mid-20th century.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832556,18.934111]}},{id:"un-pursram-lettering",category:"Lettering",title:"U.N. Pursram Signage",image:"./images/un-pursram.jpg",description:"The distinctive oval signage of U.N. Pursram, a classic example of commercial typography on D.N. Road.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.83258,18.93414]}},{id:"thomas-cook",category:"Neoclassical",title:"Thomas Cook Building",image:"./images/thomas-cook-building.jpg",description:"A distinguished Grade II-A heritage structure featuring Classical elements like Corinthian columns and arched windows. Originally the Indian headquarters for Eastman Kodak.",year:"1900",architect:"Unknown",builder:"Eastman Kodak",location:{center:[72.832611,18.934167]}},{id:"jn-petit",category:"Victorian",title:"J.N. Petit Institute",image:"./images/jn-petit.jpg",description:"A magnificent Neo-Gothic library and reading room built in 1898. Its facade features polychromatic stone, stained glass, and pointed arches. Recipient of a UNESCO Heritage Award.",year:"1898",architect:"Merwanjee Bana",builder:"Petit Family",location:{center:[72.832639,18.934194]}},{id:"fort-gate",category:"Victorian",title:"Fort Gate Remnant",image:"./images/fort-gate-remnant.jpg",description:"A surviving basalt stone archway, likely a remnant from the original Fort walls demolished in the 1860s. Now integrated into the urban fabric near DN Road.",year:"1860",architect:"British Military Engineers",builder:"Public Works",location:{center:[72.832361,18.933667]}},{id:"booksellers",category:"Living Heritage",title:"Secondhand Book Sellers",image:"./images/books.jpg",description:"The lineage of street book vendors near Flora Fountain.",year:"1950",architect:"N/A",builder:"Vendor Collective",location:{center:[72.8315,18.9325]}},{id:"rbi-rupee",category:"Street Furniture",title:"RBI Rupee Installation",image:"./images/rbi-rupee.jpg",description:"A large golden installation of the Indian Rupee symbol () accompanied by coin motifs, located outside the Reserve Bank of India.",year:"2010",architect:"RBI",builder:"RBI",location:{center:[72.83709,18.932943]}},{id:"rbi-building",categories:["Modern","Street Furniture"],title:"Reserve Bank of India (Main Building)",images:["./images/rbi-building.jpg","./images/rbi-tiger.jpg"],description:"The headquarters of India's central bank. Completed in 1939, the building is a transition between Art Deco and Modernism. A prominent golden statue of the RBI tiger under a palm tree (based on the East India Company's Mohur) stands at the entrance.",year:"1939",architect:"J.A. Ritchie",builder:"Shapoorji Pallonji",location:{center:[72.83685,18.93285]}},{id:"mumbai-mint",category:"Neoclassical",title:"India Government Mint",image:"./images/mumbai-mint.jpg",description:"Established in 1829, the Mumbai Mint is one of the oldest in India. The building is a fine example of Neoclassical architecture, featuring a grand basalt stone facade.",year:"1829",architect:"Major John Hawkins",builder:"British Government",location:{center:[72.836556,18.933361]}},{id:"bhagatsingh-road-sign",category:"Street Sign",title:"Shahid Bhagat Singh Road Sign",image:"./images/bhagatsingh-road-sign.jpg",description:"A classic blue municipal street sign marking Shahid Bhagat Singh Road (formerly Colaba Causeway). The decorative ironwork scroll on the post is a characteristic feature of Mumbai's heritage street signage.",year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.836139,18.932889]}},{id:"fire-hydrant-sbs",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/hydrant-sbs.jpg",description:"A weathered cast-iron fire hydrant from the British colonial era, located along Shahid Bhagat Singh Road. These hexagonal pillars remain as silent sentinels of the city's 19th-century water infrastructure.",year:"1890",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.835806,18.932583]}},{id:"fire-hydrant-dn",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/hydrant-dn-road.jpg",description:"A tall, cylindrical cast-iron fire hydrant with a rounded cap, located within the heritage arcade on Dadabhai Naoroji Road. This red-oxide painted relic is part of Mumbai's historic fire-fighting infrastructure.",year:"1890",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.834306,18.93225]}},{id:"standard-monograms",category:"Lettering",title:"Heritage Monograms",images:["./images/monogram-hb.jpg","./images/monogram-mb.jpg"],description:'Intricate monograms carved into the stone balconies of the Standard Building on D.N. Road. These stylized "HB" and "MB" initials are a testament to the craftsmanship and personal branding of the early 20th-century architects and builders.',year:"1902",architect:"F.W. Stevens",builder:"Standard Life Assurance",location:{center:[72.834417,18.932056]}},{id:"gungadass-piyav",categories:["Street Furniture","Lettering"],title:"Gungadass Vizbhoocundass Piyav",images:["./images/gungadass-piyav.jpg","./images/gungadass-plaque-1841.jpg","./images/gungadass-plaque-1873.jpg"],description:"A historic water fountain (piyav) decorated with red jaali work. The inscriptions in multiple scripts (English, Gujarati, Marathi, Urdu) commemorate its erection in 1841 by Gungadass Vizbhoocundass and a subsequent addition in 1873 by his widow, Bai Manchooverbai.",year:"1841",architect:"Unknown",builder:"Gungadass Vizbhoocundass",location:{center:[72.834389,18.932028]}},{id:"ryrie-building",categories:["Neoclassical","Lettering"],title:"Ryrie's Building (Galeries Lafayette)",images:["./images/ryrie-building.jpg","./images/ryrie-monogram.jpg"],description:`A grand heritage building on D.N. Road, recently restored to house Galeries Lafayette. The stone facade features intricate Neoclassical details, including the original "RY" monogram carved into the masonry, signifying its history as the Ryrie's building.`,year:"1900",architect:"Unknown",builder:"Ryrie & Co.",location:{center:[72.834693,18.930883]}},{id:"sbi-directory",category:"Lettering",title:"State Bank Building Directory",image:"./images/crawford-bayley-board.jpg",description:"A classic black directory board located at the entrance of the State Bank Building (formerly State Bank of India Commercial Branch). It features the names of historic tenants like Crawford Bayley & Co. and The Oriental Fire & General Insurance, rendered in crisp white lettering.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.834972,18.931083]}},{id:"keystone-heads",category:"Urban Texture",title:"Keystone Sculptures",image:"./images/keystone-heads.jpg",description:"Intricate sculpted heads (mascarons) adorning the keystones of the arches on this heritage faade. These bearded faces, possibly depicting European or mythological figures, watch over the street from above the shopfronts (currently Bademiya).",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835194,18.931444]}},{id:"oriental-building",category:"Victorian",title:"Oriental Building",image:"./images/oriental-building.jpg",description:`A magnificent Venetian Gothic structure completed in 1885. Its facade is a masterpiece of stone carving, featuring prominent arches, decorative balconies, and the signature "mascaron" heads on its keystones. Originally built for the Oriental Life Assurance Company, it is now an iconic part of the Fort district's architectural fabric.`,year:"1885",architect:"Frederick William Stevens",builder:"Oriental Life Assurance",location:{center:[72.835194,18.931444]}},{id:"bmc-plaque-horniman",category:"Street Sign",title:"BMC Garden Plaque",image:"./images/bmc-plaque-horniman.jpg",description:"The official colorful seal of the Brihanmumbai Municipal Corporation (BMC) mounted on the historic iron railings of Horniman Circle Garden. The seal features iconic Mumbai landmarks like the Gateway of India and a factory, representing the citys heritage and industry.",year:"Unknown",architect:"BMC",builder:"Municipal Corp",location:{center:[72.835556,18.932167]}},{id:"asiatic-society",category:"Neoclassical",title:"Asiatic Society of Mumbai (Town Hall)",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/9/94/The_Asiatic_Society_of_Mumbai_in_May_2025.jpg/1024px-The_Asiatic_Society_of_Mumbai_in_May_2025.jpg",description:"Completed in 1833, the Town Hall is one of the most magnificent Neoclassical buildings in Mumbai. Inspired by Greek and Roman architecture, it features a grand portico with eight Doric columns and a famous flight of steps that serves as a popular public space.",year:"1833",architect:"Colonel Thomas Cowper",builder:"Government of Bombay",location:{center:[72.836155,18.931813]}},{id:"horniman-garden",category:"Public Space",title:"Horniman Circle Garden",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Mumbai%2C_giardini_di_horniman_circle%2C_03.jpg/1024px-Mumbai%2C_giardini_di_horniman_circle%2C_03.jpg",description:"A historic park at the center of Horniman Circle, originally known as Elphinstone Circle. Laid out in 1872, the garden is a rare example of circular urban planning in Mumbai, surrounded by palm trees and grand Victorian buildings. It remains a tranquil green lung in the heart of the business district.",year:"1872",architect:"Unknown",builder:"Govt. of Bombay",location:{center:[72.835007,18.931907]}},{id:"bharat-insurance",categories:["Neoclassical","Lettering"],title:"Bharat Insurance Building",images:["./images/bharat-insurance.jpg","./images/bharat-insurance-lettering.jpg"],description:'A stately Neoclassical building on Horniman Circle. The facade features a graceful curve, recurring arched windows with decorative "mascaron" keystone heads, and prominent raised lettering for the "BHARAT INSURANCE BUILDING". It currently houses the flagship Hermes store, blending historic grandeur with modern luxury.',year:"Unknown",architect:"Unknown",builder:"Bharat Insurance Co.",location:{center:[72.835815,18.933329]}},{id:"hc-dinshaw-building",categories:["Neoclassical","Lettering"],title:"Sir H.C. Dinshaw Building",images:["./images/hc-dinshaw-building.jpg","./images/hc-dinshaw-lettering.jpg"],description:`A grand heritage building on Horniman Circle, part of the precinct's iconic curved architecture. The facade is adorned with intricate stone carvings, including "mascaron" heads on the window keystones. Notable gold-engraved lettering above the entrance and within the archways bears the name "SIR H. C. DINSHAW BUILDING".`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835373,18.932915]}},{id:"mumbai-samachar",categories:["Victorian","Lettering","Living Heritage"],title:"Mumbai Samachar Building",images:["./images/mumbai-samachar.jpg","./images/mumbai-samachar-lettering.jpg"],description:"The home of Asia's oldest continuously published newspaper (est. 1822). This striking red-brick building is a landmark of Mumbai's journalism history. The facade is a fine example of Victorian commercial architecture, featuring multilingual signage and elegant arched windows.",year:"1822",architect:"Unknown",builder:"Cama Family",location:{center:[72.834456,18.93282]}},{id:"elphinstone-building",categories:["Victorian","Lettering"],title:"Elphinstone Building",images:["./images/elphinstone-building.jpg","./images/elphinstone-lettering.jpg"],description:'A stately Victorian Gothic building with prominent arched windows and intricate stone ornamentation. The facade features the "ELPHINSTONE BUILDING" nameplate carved into the masonry. Today, it stands as a prime example of the 19th-century commercial grandness of the Fort district, housing modern retail like Starbucks.',year:"1870",architect:"James Trubshawe",builder:"Unknown",location:{center:[72.834229,18.933358]}},{id:"brady-house",categories:["Neoclassical","Lettering"],title:"Brady House",images:["./images/brady-house.jpg","./images/brady-house-lettering.jpg"],description:`An elegant heritage building featuring a distinctive shield-shaped pediment with the "BRADY HOUSE" nameplate. The structure displays refined architectural detailing with arched windows and a symmetrical facade, characteristic of early 20th-century commercial buildings in Mumbai's business district.`,year:"Unknown",architect:"Unknown",builder:"W.H. Brady & Co.",location:{center:[72.833778,18.932474]}},{id:"pardiwala-sign",categories:["Lettering","Ghost Site"],title:"Pardiwala Paper Mart Sign",image:"./images/pardiwala-paper.jpg",description:`A weathered wooden sign with bold relief lettering for "PARDIWALA PAPER MART", hanging under a stone Gothic arch. A classic example of Mumbai's historic commercial signage and a "ghost site" of a former paper trading business.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.834335,18.932354]}},{id:"1923-lettering",category:"Lettering",title:"1923 Lettering",image:"./images/lettering-north-fort.jpg",description:'Carved stone lettering displaying the year "1923" adorned with decorative floral motifs.',year:"1923",architect:"Unknown",builder:"Private",location:{center:[72.833889,18.935944]}},{id:"readymoney-mansion",categories:["Vernacular","Lettering"],title:"Readymoney Mansion",images:["./images/readymoney-mansion-building.jpg","./images/readymoney-mansion-lettering.jpg"],description:'A striking heritage building featuring a stone facade and intricate wooden balconies. The name "READYMONEY MANSION" is carved in bold relief above the entrance.',year:"Unknown",architect:"Unknown",builder:"Readymoney Family",location:{center:[72.830534,18.931944]}},{id:"churchgate-house",categories:["Lettering","Victorian"],title:"Churchgate House Lettering",image:"./images/churchgate-house-lettering.jpg",description:'Classic serif lettering for "CHURCHGATE HOUSE" mounted on the stone facade of a heritage building, now housing a modern bank branch.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832911,18.932546]}},{id:"elite-shopping-centre",category:"Lettering",title:"Elite Shopping Centre Signage",image:"./images/elite-shopping-centre-lettering.jpg",description:'A vibrant arched blue sign for the "ELITE SHOPPING CENTRE" marking a busy commercial passage on Nariman Road.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.832917,18.93225]}},{id:"rustom-building",categories:["Lettering","Victorian"],title:"Rustom Building Lettering",image:"./images/rustom-building-lettering.jpg",description:`Bold relief lettering for "RUSTOM BUILDING" set against a stone facade. The building features decorative iron balconies and classic stone detailing, characteristic of the district's commercial heritage.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833245,18.932614]}},{id:"st-thomas-cathedral",categories:["Victorian","Lettering"],title:"St. Thomas Cathedral",images:["./images/st-thomas-building.jpg","./images/st-thomas-lettering.jpg"],description:"The first Anglican church in Mumbai, consecrated in 1718. A landmark of colonial architecture, it gave its name to the nearby Churchgate station. The cathedral features a blend of Gothic and Neoclassical styles with a distinctive white tower.",year:"1718",architect:"Unknown",builder:"East India Company",location:{center:[72.833599,18.932995]}},{id:"fish-relief-wall",category:"Urban Texture",title:"Fish & Star Reliefs",image:"./images/fish-relief-wall.jpg",description:"A unique vernacular detail featuring red-painted relief sculptures of stars and two fish meeting head-to-head on the gable wall of a building in the Fort precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.8335,18.932972]}},{id:"heritage-balconies-fort",category:"Vernacular",title:"Heritage Balconies",image:"./images/heritage-balconies-fort.jpg",description:"A striking example of early 20th-century residential architecture in Fort, featuring ornate wrought-iron balconies, a Greek-key pattern frieze, and classic stone facing.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.833389,18.932889]}},{id:"fire-hydrant-mcgb",category:"Street Furniture",title:"MCGB Fire Hydrant",image:"./images/fire-hydrant-mcgb.jpg",description:`A classic cylindrical cast-iron fire hydrant with the inscription "MCGB" (Municipal Corporation of Greater Bombay) and "IS 908", reflecting the city's municipal infrastructure history.`,year:"Unknown",architect:"Unknown",builder:"Municipal Corp",location:{center:[72.833333,18.932694]}},{id:"yazdani-bakery",categories:["Living Heritage","Lettering","Vernacular"],title:"Yazdani Restaurant & Bakery",images:["./images/yazdani-bakery-facade.jpg","./images/yazdani-bakery-sign.jpg","./images/yazdani-la-boulangerie.jpg"],description:"An iconic Iranian bakery and restaurant established in 1953, housed in a charming colonial-era structure with a distinctive red-trim gabled roof. Famous for its ginger biscuits, brun maska, and wood-fired ovens.",year:"1953",architect:"Unknown",builder:"Zend Meherwan Abadan",location:{center:[72.833699,18.933451]}},{id:"french-bank-building",categories:["Lettering","Ghost Site"],title:"French Bank Building Signage",image:"./images/french-bank-building.jpg",description:`Prominent sans-serif lettering for the "FRENCH BANK BUILDING" above the entrance. To the right, a faint "BNP" ghost sign is visible on the facade, a relic of the building's former life as the Mumbai headquarters for the French bank BNP Paribas.`,year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835043,18.933314]}},{id:"gool-mansion",category:"Lettering",title:"Gool Mansion Lettering",image:"./images/gool-mansion-lettering.jpg",description:'Art Deco style gold lettering on a red granite plaque marking "GOOL MANSION", integrated into the facade of this heritage residential building on Nariman Road.',year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.835087,18.934023]}},{id:"fluted-facade-plant",categories:["Neoclassical","Urban Texture"],title:"Fluted Heritage Facade",image:"./images/baroda-facade-plant.jpg",description:"A grand heritage facade featuring monumental fluted pilasters. A young Ficus tree has taken root in the decorative iron balcony, a common sight where nature reclaims the masonry joints of the Fort precinct.",year:"Unknown",architect:"Unknown",builder:"Private",location:{center:[72.83525,18.933417]}},{id:"hydrant",category:"Street Furniture",title:"British Fire Hydrant",image:"./images/hydrant.jpg",description:"A hexagonal cast-iron fire hydrant, a sturdy relic of the colonial municipal water infrastructure.",year:"1895",architect:"BMC",builder:"Foundry Cast",location:{center:[72.831917,18.928139]}},{id:"kerbstones",category:"Urban Texture",title:"Kurla Basalt Kerbstones",image:"./images/kurla-basalt.jpg",description:"Original massive blocks of grey Kurla basalt lining the pavement.",year:"1880",architect:"City Engineers",builder:"Public Works",location:{center:[72.832,18.9275]}}];function Gg(e){if(!e)return 2025;e=e.toString().toLowerCase();const n=e.match(/(\d{4})/);return n?parseInt(n[0]):e.includes("late 19th")?1890:e.includes("mid 19th")?1850:e.includes("early 19th")?1810:e.includes("19th century")?1850:e.includes("early 20th")?1910:e.includes("mid 20th")?1950:e.includes("late 20th")?1990:e.includes("20th century")?1950:2025}function kp(e){return e.categories&&Array.isArray(e.categories)?e.categories:e.category?[e.category]:[]}const Cp=16,DD=De.forwardRef(({selectedRecord:e,onSelectRecord:n,currentYear:o,disabledCategories:u,is1883Mode:g,isFortWallVisible:x,is3DBuildingsVisible:v},c)=>{const A=De.useRef(null),D=De.useRef(null),V=De.useRef({}),[L,B]=De.useState(!1);De.useImperativeHandle(c,()=>({zoomIn:()=>{var ce;return(ce=D.current)==null?void 0:ce.zoomIn()},zoomOut:()=>{var ce;return(ce=D.current)==null?void 0:ce.zoomOut()},resetNorth:()=>{var ce;return(ce=D.current)==null?void 0:ce.resetNorth()},resetView:()=>{var ce;(ce=D.current)==null||ce.flyTo({center:Rn.startCenter,zoom:Rn.initialZoom,pitch:45,bearing:-15,duration:1e3})},flyTo:(ce,ge)=>{var Ce;return(Ce=D.current)==null?void 0:Ce.flyTo({center:ce,zoom:ge||D.current.getZoom(),duration:1e3})},locate:()=>{navigator.geolocation.getCurrentPosition(ce=>{var ge;(ge=D.current)==null||ge.flyTo({center:[ce.coords.longitude,ce.coords.latitude],zoom:17,duration:1e3})})}})),De.useEffect(()=>{if(D.current)return;const ge={top:0,bottom:window.innerWidth<768?0:300,left:0,right:0};return D.current=new Tp.Map({container:A.current,style:Rn.style,center:Rn.startCenter,zoom:Rn.initialZoom,minZoom:14.5,maxBounds:[[72.81,18.91],[72.85,18.945]],pitch:45,bearing:-15,antialias:!0,attributionControl:!1,padding:ge}),D.current.addControl(new Tp.AttributionControl({compact:!0}),"bottom-right"),D.current.addControl(new Tp.ScaleControl({maxWidth:100,unit:"metric"}),"bottom-left"),D.current.on("load",()=>{D.current.addSource("source-1883",{type:"image",url:"/images/fort-1883.jpg",coordinates:[[72.8228,18.9435],[72.8492,18.9435],[72.8492,18.9235],[72.8228,18.9235]]}),D.current.addLayer({id:"layer-1883",type:"raster",source:"source-1883",paint:{"raster-fade-duration":0},layout:{visibility:"none"}}),D.current.addLayer({id:"3d-buildings",source:"openmaptiles","source-layer":"building",type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#f0f0f0","fill-extrusion-height":["get","render_height"],"fill-extrusion-base":["get","render_min_height"],"fill-extrusion-opacity":.9}});const Ce={type:"Feature",geometry:{type:"LineString",coordinates:[[72.8312,18.9278],[72.8318,18.9276],[72.8325,18.9273],[72.8335,18.9268],[72.8342,18.9265]]}};D.current.addSource("fort-wall",{type:"geojson",data:Ce}),D.current.addLayer({id:"fort-wall-layer",type:"line",source:"fort-wall",layout:{"line-join":"round","line-cap":"round",visibility:"none"},paint:{"line-color":"#c0392b","line-width":4,"line-dasharray":[2,4]}});const X=$g.map(Z=>{const ve=kp(Z)[0];return{type:"Feature",properties:{id:Z.id,title:Z.title,category:ve,color:Rn.colors[ve]||"#333"},geometry:{type:"Point",coordinates:Z.location.center}}});D.current.addSource("heritage-clusters",{type:"geojson",data:{type:"FeatureCollection",features:X},cluster:!0,clusterMaxZoom:17,clusterRadius:50}),D.current.addLayer({id:"clusters",type:"circle",source:"heritage-clusters",filter:["has","point_count"],maxzoom:Cp,paint:{"circle-color":["step",["get","point_count"],"#2980b9",10,"#8e44ad",25,"#c0392b"],"circle-radius":["step",["get","point_count"],18,10,24,25,30],"circle-stroke-width":3,"circle-stroke-color":"#fff"}}),D.current.addLayer({id:"cluster-count",type:"symbol",source:"heritage-clusters",filter:["has","point_count"],maxzoom:Cp,layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#ffffff"}}),D.current.on("click","clusters",async Z=>{const W=D.current.queryRenderedFeatures(Z.point,{layers:["clusters"]}),ve=W[0].properties.cluster_id,Se=W[0].geometry.coordinates.slice(),Ae=await D.current.getSource("heritage-clusters").getClusterExpansionZoom(ve);D.current.flyTo({center:Se,zoom:Math.min(Ae+.5,18),duration:500})}),D.current.on("mouseenter","clusters",()=>{D.current.getCanvas().style.cursor="pointer"}),D.current.on("mouseleave","clusters",()=>{D.current.getCanvas().style.cursor=""}),$g.forEach(Z=>{const W=kp(Z),ve=W[0],Se=Rn.colors[ve]||"#333",ke=Rn.icons[ve]||"fa-location-dot",Ae=document.createElement("div");Ae.className="marker",Ae.style.backgroundColor=Se,Ae.innerHTML=`<i class="fa-solid ${ke}"></i>`,Ae.addEventListener("click",()=>n(Z));const Me=new Tp.Marker({element:Ae}).setLngLat(Z.location.center).addTo(D.current);V.current[Z.id]={marker:Me,element:Ae,record:Z,categories:W}}),B(!0)}),()=>{D.current&&(D.current.remove(),D.current=null)}},[n]),De.useEffect(()=>{if(L){const ce=document.getElementById("loading-screen");ce&&(ce.style.opacity="0",setTimeout(()=>{ce.style.display="none"},500))}},[L]),De.useEffect(()=>{if(!D.current||!L)return;const ge=D.current.getZoom()>=Cp;if(g?Object.values(V.current).forEach(({element:Ce})=>{Ce.style.display="none"}):Object.values(V.current).forEach(({element:Ce,categories:X,record:Z})=>{const W=X.some(ke=>!u.includes(ke)),ve=Gg(Z.year)<=o,Se=(e==null?void 0:e.id)===Z.id;(ge||Se)&&W&&ve?(Ce.style.display="flex",Ce.style.opacity="1"):Ce.style.display="none"}),g){const Ce=D.current.getSource("heritage-clusters");Ce&&Ce.setData({type:"FeatureCollection",features:[]})}else{const Ce=$g.filter(Z=>{const ve=kp(Z).some(ke=>!u.includes(ke)),Se=Gg(Z.year)<=o;return ve&&Se}).map(Z=>{const ve=kp(Z)[0];return{type:"Feature",properties:{id:Z.id,title:Z.title,category:ve,color:Rn.colors[ve]||"#333"},geometry:{type:"Point",coordinates:Z.location.center}}}),X=D.current.getSource("heritage-clusters");X&&X.setData({type:"FeatureCollection",features:Ce})}D.current.getLayer("layer-1883")&&(D.current.setLayoutProperty("layer-1883","visibility",g?"visible":"none"),g&&D.current.moveLayer("layer-1883")),D.current.getLayer("fort-wall-layer")&&D.current.setLayoutProperty("fort-wall-layer","visibility",x?"visible":"none"),D.current.getLayer("3d-buildings")&&D.current.setLayoutProperty("3d-buildings","visibility",v&&!g?"visible":"none"),D.current.getLayer("clusters")&&D.current.setLayoutProperty("clusters","visibility",g?"none":"visible"),D.current.getLayer("cluster-count")&&D.current.setLayoutProperty("cluster-count","visibility",g?"none":"visible")},[o,u,g,x,v,e,L]);const se=De.useRef(g);return De.useEffect(()=>{!D.current||!L||(g&&!se.current&&D.current.fitBounds([[72.8228,18.9235],[72.8492,18.9435]],{padding:{top:100,bottom:100,left:50,right:50},pitch:0,bearing:0}),se.current=g)},[g,L]),De.useEffect(()=>{!D.current||!L||g||(v?D.current.easeTo({pitch:45,duration:1e3}):D.current.easeTo({pitch:0,duration:1e3}))},[v,g,L]),De.useEffect(()=>{if(!D.current||!L)return;const ce=()=>{if(g)return;const Ce=D.current.getZoom()>=Cp;Object.values(V.current).forEach(({element:X,categories:Z,record:W})=>{const ve=Z.some(Ae=>!u.includes(Ae)),Se=Gg(W.year)<=o,ke=(e==null?void 0:e.id)===W.id;(Ce||ke)&&ve&&Se?(X.style.display="flex",X.style.opacity="1"):X.style.display="none"})};return D.current.on("zoom",ce),()=>{D.current&&D.current.off("zoom",ce)}},[L,u,o,e]),_e.jsx("div",{className:"map-wrapper",style:{width:"100%",height:"100vh",position:"fixed",top:0,left:0,zIndex:1},children:_e.jsx("div",{ref:A,id:"map",style:{width:"100%",height:"100%"}})})}),LD=({disabledCategories:e,onToggle:n,onSolo:o,onReset:u,isFortWallVisible:g,onToggleFortWall:x})=>{const v=De.useRef(null),c=Object.keys(Rn.colors),[A,D]=De.useState(!1);De.useEffect(()=>{const L=v.current;if(!L)return;const B=()=>{const se=L.scrollLeft+L.clientWidth>=L.scrollWidth-10;L.parentElement.classList.toggle("scrolled-end",se)};return L.addEventListener("scroll",B),()=>L.removeEventListener("scroll",B)},[]);const V=L=>{const B=e.includes(L),se=Rn.colors[L],ce=Rn.icons[L],ge=!e.includes(L)&&c.every(Ce=>Ce===L||e.includes(Ce));return _e.jsxs("div",{className:`filter-chip ${B?"chip-hidden":""} ${ge?"chip-solo":""}`,onClick:()=>n(L),onContextMenu:Ce=>{Ce.preventDefault(),o(L)},style:{"--chip-color":se},children:[_e.jsx("span",{className:"chip-dot",style:{backgroundColor:se}}),_e.jsx("i",{className:`fa-solid ${ce}`}),L]},L)};return _e.jsxs(_e.Fragment,{children:[_e.jsx("div",{className:"chip-filter-wrapper",children:_e.jsxs("div",{id:"chip-filter-bar",ref:v,children:[_e.jsx("div",{className:"filter-chip chip-reset",onClick:u,children:"All"}),_e.jsxs("div",{className:`filter-chip chip-wall ${g?"chip-solo":""}`,onClick:x,children:[_e.jsx("i",{className:"fa-solid fa-archway"})," Wall"]}),c.map(V)]})}),_e.jsxs("div",{id:"console",children:[_e.jsxs("div",{id:"layers-header",onClick:()=>D(!A),children:[_e.jsxs("span",{children:[_e.jsx("i",{className:"fa-solid fa-layer-group"})," Filter Layers"]}),_e.jsx("i",{id:"layers-arrow",className:`fa-solid fa-chevron-down ${A?"":"rotated"}`})]}),_e.jsx("div",{id:"layers-content",className:A?"collapsed":"",children:_e.jsx(kc,{children:!A&&_e.jsxs(ws.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},style:{overflow:"hidden",display:"flex",flexDirection:"column",gap:"8px"},children:[_e.jsx("button",{className:"filter-btn all-layers-btn",onClick:u,children:"RESET VISIBILITY"}),c.map(L=>{const B=!e.includes(L)&&c.every(se=>se===L||e.includes(se));return _e.jsxs("div",{className:`filter-btn ${e.includes(L)?"layer-hidden":""}`,children:[_e.jsxs("div",{className:"layer-label-group",children:[_e.jsx("span",{className:"dot-indicator",style:{color:Rn.colors[L]}}),_e.jsx("i",{className:`fa-solid ${Rn.icons[L]}`}),L]}),_e.jsxs("div",{className:"layer-actions",children:[_e.jsx("button",{className:`layer-solo-btn ${B?"active":""}`,onClick:()=>o(L),children:"ONLY"}),_e.jsx("button",{className:"layer-eye-btn",onClick:()=>n(L),children:e.includes(L)?"SHOW":"HIDE"})]})]},L)}),_e.jsx("div",{className:"console-separator"}),_e.jsx("div",{className:`filter-btn ${g?"":"layer-hidden"}`,id:"wall-btn",onClick:x,children:_e.jsxs("div",{className:"layer-label-group",children:[_e.jsx("i",{className:"fa-solid fa-archway"}),"Toggle 1860 Fort Wall"]})}),g&&_e.jsxs("div",{id:"wall-info",style:{display:"block"},children:[_e.jsx("strong",{children:"The Invisible Ramparts"}),"This dashed line traces the demolished fortifications of the Bombay Fort (removed 1862)."]})]})})})]})]})},RD=({onSelectRecord:e,disabledCategories:n,onToggle:o,onSolo:u,onReset:g,isFortWallVisible:x,onToggleFortWall:v,onOpenAbout:c})=>_e.jsxs("header",{id:"header",className:"fade-on-move",children:[_e.jsx("button",{className:"info-icon-btn",title:"About This Project",onClick:c,children:_e.jsx("i",{className:"fa-solid fa-circle-info"})}),_e.jsxs("div",{id:"search-container",className:`fade-on-move ${isSearchExpanded?"expanded":""}`,children:[_e.jsxs("div",{className:"mobile-header-pills",children:[_e.jsx(kc,{children:!isSearchExpanded&&_e.jsxs(ws.div,{className:"brand-pill",onClick:c,initial:{width:0,opacity:0,paddingLeft:0,paddingRight:0,marginRight:0},animate:{width:"auto",opacity:1,paddingLeft:20,paddingRight:20,marginRight:10},exit:{width:0,opacity:0,paddingLeft:0,paddingRight:0,marginRight:0},transition:{type:"spring",stiffness:300,damping:30},style:{overflow:"hidden",cursor:"pointer"},children:[_e.jsxs("div",{className:"brand-text",children:[_e.jsx("span",{className:"brand-sub",children:"Visual Audit"}),_e.jsx("span",{className:"brand-main",children:"Kala Ghoda"})]}),_e.jsx("div",{className:"brand-info-btn",children:_e.jsx("i",{className:"fa-solid fa-circle-info"})})]})}),_e.jsxs(ws.div,{className:"search-pill",layout:!0,children:[_e.jsx("i",{className:"fa-solid fa-search"}),_e.jsx("input",{type:"text",id:"search-input",placeholder:"Search...",value:searchTerm,onChange:handleSearch,onFocus:()=>setIsSearchExpanded(!0),onBlur:()=>setTimeout(()=>setIsSearchExpanded(!1),200),autoComplete:"off"})]})]}),_e.jsx(kc,{children:searchResults.length>0&&_e.jsx(ws.div,{id:"search-results",variants:containerVariants,initial:"hidden",animate:"visible",exit:"exit",children:searchResults.map(A=>_e.jsxs(ws.div,{className:"search-result-item",onClick:()=>handleResultClick(A),variants:itemVariants,children:[_e.jsx("div",{className:"result-title",children:A.title}),_e.jsxs("div",{className:"result-meta",children:[A.year,"  ",A.category]})]},A.id))})})]}),_e.jsx(LD,{disabledCategories:n,onToggle:o,onSolo:u,onReset:g,isFortWallVisible:x,onToggleFortWall:v})]}),BD=({currentYear:e,onChange:n,visible:o,onClose:u})=>{if(!o)return null;const g=1850,x=2025;return _e.jsxs(_e.Fragment,{children:[_e.jsx("div",{id:"time-widget-backdrop",className:"active",onClick:u}),_e.jsxs("div",{id:"time-widget",className:"active",children:[_e.jsx("div",{id:"year-display",children:e===x?"Present Day":`Year: ${e}`}),_e.jsx("input",{type:"range",min:g,max:x,value:e,onChange:v=>n(parseInt(v.target.value)),id:"year-slider"}),_e.jsxs("div",{className:"range-labels",children:[_e.jsx("span",{id:"label-min",children:g}),_e.jsx("span",{children:"Present"})]})]})]})},FD=({onZoomIn:e,onZoomOut:n,onResetNorth:o,onToggleTime:u,isTimeActive:g,is1883Mode:x,onToggle1883:v,is3DVisible:c,onToggle3D:A,onResetView:D,onLocate:V})=>{const L={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},B={hidden:{opacity:0,x:20},visible:{opacity:1,x:0}},se=[{id:"zoom-in-btn",onClick:e,icon:"fa-plus",label:"",className:"v-control-btn"},{id:"zoom-out-btn",onClick:n,icon:"fa-minus",label:"",className:"v-control-btn"},{id:"compass-btn",onClick:o,icon:"fa-arrow-up",label:"Reset North",title:"Reset North",className:"v-control-btn"},{id:"time-travel-btn",onClick:u,icon:"fa-clock-rotate-left",label:"Time Travel",className:`v-control-btn ${g?"active-control":""}`,disabled:x},{id:"map-1883-btn",onClick:v,icon:"fa-map-location-dot",label:"1883 Map",className:`v-control-btn ${x?"active-control":""}`},{id:"view-3d-btn",onClick:A,icon:"fa-cube",label:"3D View",className:`v-control-btn ${c?"active-control":""}`,disabled:x},{id:"reset-view-btn",onClick:D,icon:"fa-compress",label:"Reset View",className:"v-control-btn"},{id:"locate-btn",onClick:V,icon:"fa-location-crosshairs",label:"My Location",className:"v-control-btn"}];return _e.jsx(ws.div,{id:"vertical-controls",variants:L,initial:"hidden",animate:"visible",children:se.map(ce=>_e.jsxs(ws.button,{className:ce.className,id:ce.id,onClick:ce.onClick,title:ce.title,disabled:ce.disabled,variants:B,whileHover:{scale:1.05},whileTap:{scale:.95},children:[_e.jsx("i",{className:`fa-solid ${ce.icon}`}),ce.label&&_e.jsx("span",{children:ce.label})]},ce.id))})},OD=({onClose:e})=>{const n={hidden:{opacity:0},visible:{opacity:1},exit:{opacity:0}},o={hidden:{y:"100%",opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:30}},exit:{y:"100%",opacity:0}};return _e.jsx(ws.div,{className:"about-backdrop",variants:n,initial:"hidden",animate:"visible",exit:"exit",onClick:e,children:_e.jsxs(ws.div,{className:"about-modal",variants:o,onClick:u=>u.stopPropagation(),children:[_e.jsx("button",{className:"close-about-btn",onClick:e,children:_e.jsx("i",{className:"fa-solid fa-xmark"})}),_e.jsxs("div",{className:"about-content",children:[_e.jsx("h1",{className:"page-title",children:"Visual Audit: Kala Ghoda"}),_e.jsx("h2",{className:"page-subtitle",children:"A Personal Archive of Micro-Heritage"}),_e.jsx("p",{children:`Kala Ghoda is more than just a heritage precinct; it is a living museum of Mumbai's urban soul. Named after the "Black Horse" statue that once stood here, this crescent-shaped district holds one of the dense concentrations of history in the city.`}),_e.jsx("p",{children:_e.jsx("strong",{children:"But history isn't just in the grand monuments."})}),_e.jsxs("p",{children:["This project was born out of a deep love for urban explorationthe desire to walk a city not just to traverse it, but to understand it. My goal is to slow down and document the ",_e.jsx("em",{children:"micro-heritage"})," that most people walk past every day without noticing."]}),_e.jsx("h3",{children:"What We Document"}),_e.jsx("p",{children:"While the guidebooks show you the museums and libraries, this visual audit looks closer. It captures the invisible details that give the city its texture:"}),_e.jsxs("div",{className:"features-grid",children:[_e.jsxs("div",{className:"feature-card",children:[_e.jsx("i",{className:"feature-icon fa-solid fa-font"}),_e.jsx("div",{className:"feature-title",children:"The Art of Lettering"}),_e.jsx("p",{className:"feature-desc",children:"From Art Deco reliefs to hand-painted street signs, Mumbai has a rich tradition of architectural typography that tells the story of the buildings' identity."})]}),_e.jsxs("div",{className:"feature-card",children:[_e.jsx("i",{className:"feature-icon fa-solid fa-magnifying-glass-location"}),_e.jsx("div",{className:"feature-title",children:"Hidden Details"}),_e.jsx("p",{className:"feature-desc",children:"Weather vanes, date plaques, carved monograms, and vernacular stone railingsthe small design choices that reveal the hands of the original craftsmen."})]}),_e.jsxs("div",{className:"feature-card",children:[_e.jsx("i",{className:"feature-icon fa-solid fa-road"}),_e.jsx("div",{className:"feature-title",children:"Urban Texture"}),_e.jsx("p",{className:"feature-desc",children:"The ground beneath our feet, from 150-year-old basalt paving stones to the tram tracks that once moved the city, recently rediscovered."})]}),_e.jsxs("div",{className:"feature-card",children:[_e.jsx("i",{className:"feature-icon fa-solid fa-ghost"}),_e.jsx("div",{className:"feature-title",children:"Ghost Sites"}),_e.jsx("p",{className:"feature-desc",children:"Mapping places that no longer exist, like the original Fort walls (1862) or the 1883 shoreline, to see how the city has grown over time."})]})]}),_e.jsx("p",{children:"This map is an invitation to explore deeply. To look up at a facade, to notice the curve of a bracket, or the serif on a street name. It is a testament to how much heritage Mumbai holds in every square meter, if only we take the time to see it."}),_e.jsxs("div",{className:"audit-meta",children:[_e.jsx("span",{children:_e.jsx("strong",{children:"Created with love for Mumbai"})}),_e.jsx("span",{children:"2025"})]})]})]})})};function jD(){const e=De.useRef(null),[n,o]=De.useState(null),[u,g]=De.useState(2025),[x,v]=De.useState([]),[c,A]=De.useState(!1),[D,V]=De.useState(!1),[L,B]=De.useState(!0),[se,ce]=De.useState(!1),[ge,Ce]=De.useState(!1);De.useEffect(()=>(c?document.body.classList.add("mode-1883"):document.body.classList.remove("mode-1883"),()=>{document.body.classList.remove("mode-1883")}),[c]);const X=De.useCallback(ke=>{var Ae;o(ke),ke.location&&((Ae=e.current)==null||Ae.flyTo(ke.location.center,18))},[]),Z=De.useCallback(()=>{o(null)},[]),W=De.useCallback(ke=>{v(Ae=>Ae.includes(ke)?Ae.filter(Me=>Me!==ke):[...Ae,ke])},[]),ve=De.useCallback(ke=>{const Me=Object.keys(Rn.colors).filter(ot=>ot!==ke);v(ot=>{const at=!ot.includes(ke),pt=Me.every(Xt=>ot.includes(Xt));return at&&pt?[]:Me})},[]),Se=De.useCallback(()=>{v([])},[]);return _e.jsxs("div",{className:`app-container ${c?"mode-1883":""}`,children:[_e.jsx(DD,{ref:e,selectedRecord:n,onSelectRecord:X,currentYear:u,disabledCategories:x,is1883Mode:c,isFortWallVisible:D,is3DBuildingsVisible:L}),_e.jsx(RD,{onSelectRecord:X,disabledCategories:x,onToggle:W,onSolo:ve,onReset:Se,isFortWallVisible:D,onToggleFortWall:()=>V(!D),onOpenAbout:()=>Ce(!0)}),_e.jsx(kc,{children:se&&_e.jsx(BD,{currentYear:u,onChange:g,onClose:()=>ce(!1)})}),_e.jsx(FD,{onZoomIn:()=>{var ke;return(ke=e.current)==null?void 0:ke.zoomIn()},onZoomOut:()=>{var ke;return(ke=e.current)==null?void 0:ke.zoomOut()},onResetNorth:()=>{var ke;return(ke=e.current)==null?void 0:ke.resetNorth()},onToggleTime:()=>ce(!se),isTimeActive:se,is1883Mode:c,onToggle1883:()=>A(!c),is3DVisible:L,onToggle3D:()=>B(!L),onResetView:()=>{var ke;return(ke=e.current)==null?void 0:ke.resetView()},onLocate:()=>{var ke;return(ke=e.current)==null?void 0:ke.locate()}}),_e.jsx(kc,{children:n&&_e.jsx(ED,{selectedRecord:n,onClose:Z},"side-panel")}),_e.jsx(kc,{children:ge&&_e.jsx(OD,{onClose:()=>Ce(!1)})})]})}K2(document.getElementById("root")).render(_e.jsx(De.StrictMode,{children:_e.jsx(jD,{})}));
